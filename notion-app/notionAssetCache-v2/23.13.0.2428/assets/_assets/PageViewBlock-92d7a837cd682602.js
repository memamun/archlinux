"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9304],{87181:(e,t,o)=>{o.d(t,{Ay:()=>ee,NS:()=>ce,rK:()=>de});o(944114),o(898992),o(672577);var n=o(296540),i=()=>o(662303),r=()=>o(484714),a=()=>o(56366),s=()=>o(721908),l=()=>o(757695),c=()=>o(763884),d=()=>o(519831),u=()=>o(959013),g=()=>o(496603),p=()=>o(534177),m=()=>o(284371),v=()=>o(934839),S=()=>o(473227),f=()=>o(915086),b=()=>o(778417),y=()=>o(725614),k=()=>o(972911),h=()=>o(766081),P=()=>o(175116),C=()=>o(964345),_=()=>o(135552),A=()=>o(886680),B=()=>o(478726),M=()=>o(108944),K=()=>o(747100),x=()=>o(470928),w=()=>o(891078),I=()=>o(696746),R=()=>o(106628),T=()=>o(792415),E=()=>o(351360),D=()=>o(430483),O=()=>o(463830),F=()=>o(353643),V=()=>o(77246),j=()=>o(508496),L=()=>o(150193),H=()=>o(732770),U=()=>o(375447),z=()=>o(205682),N=()=>o(548821),q=()=>o(612587),W=()=>o(77238),Q=()=>o(712505),X=()=>o(93658),G=()=>o(502438),$=o(474848);m().vc(i().locale).sans,m().vc(i().locale).serif,m().vc(i().locale).mono,m().vc(i().locale).comic;const Y={width:"100%",display:"flex",flexDirection:"column",position:"relative",alignItems:"center",flexGrow:1},Z=30;function J(e,t){var i,m;const I=(0,n.useRef)();I.current=performance.now();const{store:L,context:z,disabled:q,onTitleEsc:W,styleOverrides:G,disableTopControls:Z}=e,J=(0,a().K8)((()=>{var e;return null===(e=L.getSpaceStore())||void 0===e?void 0:e.getFreezeSettings()}),[L]),ee=(0,o(973454).p)(J),ue=q||"active"===ee,ge=(0,r().v3)(),pe=(0,r().Y0)(),me=(0,o(792485).S)(),ve=(0,w().bx)(L,ue),Se=(0,w().HX)(L,ue),fe=(0,a().K8)((()=>L.isReady()&&Se&&!L.isNonEditableState()&&!(0,B().sV)(L)&&!(0,B().fc)(L)),[Se,L]),be=(0,a().K8)((()=>L.isCollectionView()),[L]),ye=(0,a().K8)((()=>Boolean((0,o(851941).X2)(L.id))?"v8":"v4"),[L]),ke=(0,a().K8)((()=>L.isCollectionViewPageWithContent()),[L]),he=(0,a().K8)((()=>"workflow"===L.getType()),[L]),Pe=(0,a().K8)((()=>{const e=L.getAssociatedCollectionStore(),t=null==e?void 0:e.getLayoutStore();return Boolean(t)}),[L]),Ce=(0,o(551619).no)(L),_e=(0,a().K8)((()=>({layout:{translateX:-1*Ce},layoutFull:{translateX:Ce}})),[Ce]),Ae=(0,a().K8)((()=>l().default.createValue(!1,{name:"headerFocusStore"})),[]),Be=(0,a().O$)(Ae),{isInPeek:Me,isInsideSidePeek:Ke}=(0,a().K8)((()=>({isInPeek:(0,K().cq)(L),isInsideSidePeek:(0,B().mb)(L)})),[L]),xe=(0,n.useMemo)((()=>new(N().Ay)),[]),we=(0,n.useMemo)((()=>new(O().A)),[]),Ie=(0,n.useMemo)((()=>new(O().A)),[]),Re=(0,n.useMemo)((()=>new(o(970585).A)),[]),Te=(0,a().K8)((()=>l().default.createValue(!1,{name:"forceControlHoverVisibleStore"})),[]),Ee=(0,a().O$)(Te),De=(0,n.useMemo)((()=>({headerFocusStore:Ae,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Re,forceControlHoverVisibleStore:Te})),[Ae,xe,we,Ie,Re,Te]),[Oe,Fe]=(0,n.useState)(!1),[Ve,je]=(0,n.useState)(!1),[Le,He]=(0,n.useState)(""),Ue=(0,n.useCallback)((()=>{we.setState({open:!0}),xe.setState({...xe.state,forceDiscussionOpen:!0})}),[xe,we]),ze=(0,n.useCallback)((()=>{const e=qe.current;if(e){if(function(e){if(!e.isIOS)return!1;return!0}(pe))return{paddingLeft:0,paddingRight:0};const t=getComputedStyle(e),o=parseFloat(t.getPropertyValue("padding-left")),n=parseFloat(t.getPropertyValue("padding-left"));return{paddingLeft:g().yr(o)?0:o,paddingRight:g().yr(n)?0:n}}}),[pe]),Ne=(0,n.useCallback)((()=>{const e=qe.current;if(e){const t=e.getBoundingClientRect().width,o=ze()??{paddingLeft:0,paddingRight:0};return t-o.paddingLeft-o.paddingRight}}),[ze]),qe=(0,n.useRef)(null),We=(0,n.useRef)(null),Qe=(0,n.useRef)(null),Xe=(0,n.useCallback)((()=>qe.current),[]),Ge=(0,n.useCallback)((()=>We.current),[]),$e=(0,n.useMemo)((()=>new(o(441307).A)(ge)),[]);(0,o(790748).b)(o(489348).A,(()=>({store:L,blockContext:z,openResolvedDiscussionPopup:Ue,getContentInnerWidth:Ne,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:$e,headerFocusStore:Ae,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Re,forceControlHoverVisibleStore:Te,headerMouseStore:void 0,detailsFocusStore:void 0,detailsMouseStore:void 0,renderedType:"page",getBlockStore:()=>L,getNode:()=>Qe.current})),[L,z,Ue,Ne,ze,Xe,Ge,$e,De]);const Ye=(0,n.useRef)(!1),Ze=(0,a().K8)((()=>L.getTitleStore()),[L]),Je=(0,a().K8)((()=>L.isInsideFactoryOrDuplicateBlocksAction()),[L]),et=(0,a().K8)((()=>{const e=T().A.state.publicPageData;return Boolean(null==e?void 0:e.isDLSViewer)}),[]),tt=(0,n.useCallback)((()=>!!Ze&&(!!e.forceSelectTitleOnMount||!be&&(!(pe.isMobile&&pe.isPhone&&o(210737).A.hasOpenMobileSlideUps())&&(!o(919709).q4_(Ze.getValue())||(0,B().In)(L)&&!pe.isMobile)))),[pe.isMobile,pe.isPhone,be,e.forceSelectTitleOnMount,L,Ze]);(0,n.useEffect)((()=>{if(j().default.checkGate({gateName:"dont_load_users"})||async function(e){const{environment:t}=e;U().A.state.emptyQueryUserRequestStore.setState({...U().A.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0});const o=await R().T.searchActions.load();await E().default.waitUntil((()=>Boolean(E().default.state.currentSpaceStore&&E().default.state.mainEditorCurrentBlockStore)));const n=await o.searchVisibleSpaceUsers({environment:t,query:"",membersOnly:!1,minFuzzyScore:25,placeSelfFirst:!1});U().A.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:n})}({environment:ge}),(0,o(63467).y)(),pe.isPhone){const{PageScroller:e}=o(347199).A;if(e){const t=e.getNode();if(t&&ve&&!Ot){const e=function(e,t){return 28+(0,B().XD)(e,t)}(z,ge);t.scrollTo({top:e})}}}if(Ze&&tt()&&(b().hc({environment:ge,store:L}),y().setSelectionAtEnd({store:Ze})),f().updateMetricDataWithIsPushTag(ge),z!==N().Rr.Frame||be||ot||(I.current&&o(606932).A.markPageViewBlockRender(I.current),f().measurePageRenderMetrics({environment:ge,isEditable:fe,isHomePage:!1,isWikiHome:!1,isPageWithCustomLayout:Pe,idSchema:ye}),function(e,t){var o;le(e,t)&&(null===(o=t.mobileNative)||void 0===o||o.markTransitionReady({type:"new_page",id:e.id,sendImmediately:!0}))}(L,ge)),$e){const e=(0,o(476492).kz)($e);o(406792).default.DO_NOT_USE_measureLegacy("collections.open_item_page_lag",{environment:ge,data:{...e,peek_mode:Q().default.getPeekMode()}})}!function(e,t){if("space_for_ai"!==(0,k().V7)())return;const o=e.getContentStores()[0],n=k().nO.state;if(!o||o.id!==n)return;b().hc({environment:t,store:o}),y().setSelectionAtEnd({store:o.getBlockTitleStore()})}(L,ge)}),[]);const ot=(0,a().K8)((()=>L.isFormBlock()),[L]),nt=(0,a().K8)((()=>L.getFormat()),[L]),it=(0,a().K8)((()=>{var e;return null===(e=V().Uv.getStateForBlock(L.id))||void 0===e?void 0:e.mode}),[L.id]),rt=(0,a().K8)((()=>{var e;const t=C().ei.state,n=(0,p().O9)(t)&&(null===(e=M().Nq(t))||void 0===e?void 0:e.id)===L.id;return C().gZ.state&&n&&"disconnected"===o(165121).A.state}),[L.id]),{isVisible:at}=(0,a().O$)(o(865241).A),st=(0,a().K8)((()=>{const e=(0,D().hV)(),t=e?c().A.get({userId:ge.currentUser.id,key:"ai_co_editing_always_on"}):void 0;return at&&e&&t&&!pe.isMobile&&(L.isNavigableBlock()||L.getNavigableBlockStore())&&L.canEdit()&&!L.isLocked()&&(!be||ke)&&!L.isFormBlock()&&("ai_co_editing"===V().Uv.getMode(L)||"default"===V().Uv.getMode(L))}),[ge.currentUser.id,pe.isMobile,L,be,ke,at]),lt=(0,a().K8)((()=>{var e;return M().ze(L)||Boolean(null===(e=T().A.state.publicPageData)||void 0===e?void 0:e.isDeleted)&&ie(z)}),[L,z]),ct=(0,a().K8)((()=>me&&me.publicEditModeStore.state),[me]),dt=(0,a().K8)((()=>L.isTemplate()),[L]),ut=(0,a().K8)((()=>L.isPost()&&!L.isPublishedPost()),[L]),gt=(0,a().K8)((()=>de(ge)),[ge]);(0,n.useEffect)((()=>{if(z===N().Rr.Frame){const e=ae(z);null==ct||!ct.hasPublicPermission||"edit"!==ct.permission||dt||(0,o(326589).g)()?v().zA({bannerStore:e,id:"EditingPageBanner"}):v().HQ({bannerStore:e,id:"EditingPageBanner",contentKey:"editing_page",styleKey:_().q.White});o(864260).A.state.pageMap[L.id]?v().HQ({bannerStore:e,id:"ImportingEvernotePage",contentKey:"importing_evernote",styleKey:_().q.Blue,blockStore:L}):v().zA({bannerStore:e,id:"ImportingEvernotePage"})}if(se(z)){const e=ae(z),t=M().Gg(L),n=M().Cf(L);if((0,o(322769).vW)(t))v().HQ({bannerStore:e,id:"SpaceContentDuplicationPage",contentKey:"space_content_duplication",styleKey:_().q.Red,blockStore:L});else if(!lt||ot||le(L,ge))if(n)v().HQ({bannerStore:e,id:"ArchivedTeamPage",contentKey:"page_in_archived_team",styleKey:_().q.Red});else for(const o of["SpaceContentDuplicationPage","DeletedPage","ArchivedTeamPage"])v().zA({bannerStore:e,id:o});else v().HQ({bannerStore:e,id:"DeletedPage",contentKey:"deleted_or_moved_page",blockStore:L,styleKey:_().q.Red});ut&&gt?v().HQ({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner",contentKey:"draft_post_in_expanded_feed_composer",styleKey:_().q.Blue,blockStore:L}):v().zA({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner"}),rt?v().HQ({bannerStore:e,id:"DictationConnectionBanner",styleKey:_().q.Yellow,contentKey:"dictation_connection",blockStore:L}):v().zA({bannerStore:e,id:"DictationConnectionBanner"}),it&&(0,V().Or)(it)?v().HQ({bannerStore:e,id:"TranslateBanner",styleKey:_().q.Blue,contentKey:"translate",blockStore:L}):v().zA({bannerStore:e,id:"TranslateBanner"}),et&&!(0,K().cq)(L)?v().HQ({bannerStore:e,id:"TrustedDomainPageBanner",styleKey:_().q.LightGray,contentKey:"trusted_domain_page",blockStore:L}):v().zA({bannerStore:e,id:"TrustedDomainPageBanner"}),dt?v().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_page",styleKey:_().q.Beige,blockStore:L,context:z,disabled:ue}):Je?v().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_button",styleKey:_().q.Beige,blockStore:L,context:z,disabled:ue}):v().zA({bannerStore:e,id:"CollectionTemplatePage"}),(null!=nt&&nt.is_asana_imported_project||null!=nt&&nt.is_asana_imported_task)&&(null!=nt&&nt.dismissed_asana_import_banner?v().zA({bannerStore:e,id:"AsanaImporterBanner"}):v().HQ({bannerStore:e,id:"AsanaImporterBanner",contentKey:"asana_importer_banner",blockStore:L,styleKey:_().q.ImportNotification}))}return()=>{se(z)&&(v().zA({bannerStore:ae(z),id:"DeletedPage"}),v().zA({bannerStore:ae(z),id:"CollectionTemplatePage"}),v().zA({bannerStore:ae(z),id:"Site"}),v().zA({bannerStore:ae(z),id:"CrdtPage"}),v().zA({bannerStore:ae(z),id:"TrustedDomainPageBanner"}),v().zA({bannerStore:ae(z),id:"TranslateBanner"}),v().zA({bannerStore:ae(z),id:"AsanaImporterBanner"}),v().zA({bannerStore:ae(z),id:"DraftPostInExpandedFeedComposerBanner"}))}}),[ge,ct,z,ue,L,lt,ot,Je,null==nt?void 0:nt.is_asana_imported_project,null==nt?void 0:nt.is_asana_imported_task,null==nt?void 0:nt.dismissed_asana_import_banner,it,rt,et,dt,ut,gt]),(0,o(852507).l)((()=>{"suggest"===V().Uv.getMode(L,!0)?S().Nz({environment:ge,location:"page_navigation",navigableBlockStore:L}):pe.isMobile||L.canEdit()||!L.canComment()||L.isLocked()||be&&!ke||V().Uv.hasModeSet(L)||L.useCrdt()||L.isFormBlock()||L.isPost()||(0,o(142748).ot)(M().E(L))||S().PD({environment:ge,navigableBlockStore:L,mode:"suggest",location:"default_on_for_comment_only_user"})})),(0,o(892008).Bs)({pageId:L.id,isFrameContext:ie(z)}),(0,n.useEffect)((()=>()=>{"suggest"===V().Uv.getMode(L,!0)&&S().eB({environment:ge,location:"page_navigation",navigableBlockStore:L})}),[ge,L]),(0,n.useEffect)((()=>{if(st)S().PD({environment:ge,navigableBlockStore:L,mode:"ai_co_editing",location:"co_editing_default_on"});else{const e=(0,D().hV)(),t=e?c().A.get({userId:ge.currentUser.id,key:"ai_co_editing_always_on"}):void 0;e&&!t&&(L.isNavigableBlock()||L.getNavigableBlockStore())&&V().Uv.hasModeSet(L)&&"ai_co_editing"===V().Uv.getMode(L,!0)&&S().PD({environment:ge,navigableBlockStore:L,mode:"default",location:"co_editing_default_off"})}}),[st,ge,L,at]);const pt=(0,a().K8)((()=>ne(L)),[L]),mt=(0,a().K8)((()=>null==pt?void 0:pt.getParentBlockStore()),[pt]),vt=(0,a().K8)((()=>null==$e?void 0:$e.collectionStore()),[$e]);pt&&pt!==vt&&$e.setContext({type:"collectionPage",collectionViewBlockStore:mt,collectionStore:pt});const St=(0,a().K8)((()=>{const e=(0,o(110750).Xz)(ge.TabbedRouterStore.state);if("web"===e.type){var t,n;if("page"===(null===(t=e.redirectedTo)||void 0===t?void 0:t.route.name))return null===(n=e.redirectedTo)||void 0===n?void 0:n.route.blockId;if("page"===e.route.name)return e.route.blockId}}),[ge]);(0,n.useEffect)((()=>{var e;ge.mobileNative&&Le===St&&(null===(e=ge.mobileNative)||void 0===e||e.markTransitionReady({type:"page",id:L.id,sendImmediately:!0}))}),[ge.mobileNative,St,Le,L.id]),(0,n.useEffect)((()=>{He(L.id)}),[L]);const ft=(0,n.useCallback)((()=>{Me||F().A.state.isDragging||X().default.state.isActive||Fe(!0)}),[Me]),bt=(0,n.useCallback)((()=>{Me||F().A.state.isDragging||X().default.state.isActive||Fe(!1)}),[Me]),yt=(0,n.useCallback)((()=>{F().A.state.isDragging||X().default.state.isActive||je(!0)}),[]),kt=(0,n.useCallback)((()=>{F().A.state.isDragging||X().default.state.isActive||je(!1)}),[]),ht=(0,s().d)(yt,100),Pt=(0,s().d)(kt,100),Ct=(0,n.useCallback)((e=>{Ze&&(b().hc({environment:ge,store:L}),e.isAtStartOfLine?y().setSelectionAtStart({store:Ze}):y().setSelectionAtEnd({store:Ze}))}),[ge,L,Ze]),_t=(0,n.useCallback)((e=>{y().clear({environment:ge}),b().IU({environment:ge}),W&&W(e)}),[ge,W]),At=(0,n.useCallback)((e=>{if(be)return!0;if(e.preventDefault(),function(e){return Boolean(ne(e))}(L)){const e=(0,B().gV)(L);if(e&&e.collection_page_properties){const t=e.collection_page_properties.find(((e,t)=>function(e,t){const o=ne(t);if(!o)return!1;const n=function(e){return e.getSchema()}(t);return(0,A().B2)(n[e])}(e.property,L)));t&&o(908006).default.afterNextFlush((()=>{o(522986).ho({environment:ge,blockPropertyValueOverlayStore:re(z),collectionContextStore:$e,store:L,property:t.property,format:o(41459).j.Page})}))}}}),[$e,z,ge,be,L]),Bt=(0,n.useCallback)((e=>{if(be)return!0;_t(e)}),[_t,be]),Mt=(0,n.useCallback)((()=>{Re.reset()}),[Re]),Kt=(0,n.useCallback)((e=>{e.target===Qe.current&&null===e.relatedTarget&&document.hasFocus()&&b().IU({environment:ge})}),[ge]),xt=(0,a().K8)((()=>ce((0,o(835066).dC)(ge,L),L,z,ge)),[ge,z,L]),wt=(0,a().K8)((()=>{const e=L.isPost(),t=e&&!L.isPublishedPost();return z===N().Rr.DraftPostInInlineComposer?N().Rr.DraftPostInInlineComposer:e&&!t?N().Rr.PostInFullPageOrPeek:e&&t?N().Rr.DraftPostInFullPageComposer:void 0}),[L,z]),It=(0,o(933951).s)({pageStore:L,postContext:wt,collectionStore:pt,pageViewBlockStore:De.pageViewBlockStore}),Rt=(0,a().K8)((()=>Q().default.state.topHoverAreaEntered),[]),Tt=(0,n.useCallback)((e=>{const{isBottomControl:t,forceVisible:o}=e??{},n=Me?Rt:Oe;let i;return i=!!pe.isMobile||(!!o||(!!Ee||(t?Ve&&!H().A.state.isKeyboardMode:n&&!H().A.state.isKeyboardMode||Be))),function(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}(i)}),[Ve,pe.isMobile,Be,Oe,Me,Rt,Ee]),Et=(0,a().K8)((()=>Tt({isBottomControl:!1})),[Tt]),[Dt,Ot]=(0,a().K8)((()=>[L.hasIcon(),L.hasCover()]),[L]),Ft=(0,a().K8)((()=>"suggest"===V().Uv.getMode(L)),[L]),Vt=(0,a().K8)((()=>(0,x().$3)({environment:ge,collectionStore:L.getAssociatedCollectionStore()})),[ge,L]),jt=(0,a().K8)((()=>(0,x().xE)(ge)),[ge]),Lt=(0,a().K8)((()=>(0,x().Wk)({environment:ge,blockStore:L,showUpsell:Vt})),[ge,L,Vt]),Ht=(0,o(400851).X)({environment:ge,blockStore:L,from:"topControls",blockContext:z}),Ut=(0,n.useCallback)((e=>{let{from:t}=e;const n=be?L.getCollectionStore():ne(L);n&&(0,o(447934).nh)({environment:ge,blockStore:L,collectionStore:n,from:t})}),[ge,be,L]),zt=(0,n.useMemo)((()=>{if(Z)return[];const e=[];return!fe||Dt||Ft||e.push((0,$.jsx)(n.Fragment,{children:(0,$.jsx)(o(790324).A,{store:L,afterOnClick:()=>{Ye.current=!0},style:Et,label:pe.isSmallPhone?(0,$.jsx)(u().sA,{id:"PageViewBlock.icon.pageIconMobile",defaultMessage:"Icon"}):(0,$.jsx)(u().sA,{id:"PageViewBlock.icon.pageIcon",defaultMessage:"Add icon"})})},"add-icon")),!fe||Ot||Ft||wt||e.push((0,$.jsx)(n.Fragment,{children:(0,$.jsx)(o(78942).A,{store:L,style:Et,label:pe.isSmallPhone?(0,$.jsx)(u().sA,{id:"PageViewBlock.cover.pageCoverMobile",defaultMessage:"Cover"}):(0,$.jsx)(u().sA,{id:"PageViewBlock.cover.pageCover",defaultMessage:"Add cover"})})},"add-cover")),Lt&&e.push((0,$.jsx)(n.Fragment,{children:(0,$.jsx)(o(527580).ui,{store:L,style:Et,showUpsell:Vt,showNewBadge:jt})},"verify-page")),Ht&&!wt&&e.push((0,$.jsx)(o(291144).E,{blockStore:L,onClick:()=>Ut({from:"customize_page_button_above_title"}),style:Et},"customize-layout")),fe&&!pe.isMobile&&e.push((0,$.jsx)(n.Fragment,{children:(0,$.jsx)(o(538776).l,{store:L})},"generate-preview-image")),e}),[Z,fe,Dt,Ft,Ot,Lt,Ht,pe.isMobile,pe.isSmallPhone,L,Et,Ut,Vt,wt,jt]),Nt=(0,a().K8)((()=>{const{WindowSizeStore:e}=ge,t=be?"20vh":(null==G?void 0:G.pageCoverHeight)??te(ge),n=(null==G?void 0:G.paddingX)??(0,B().OU)(z,ge);return(0,$.jsx)(o(155004).s,{allowSelectionWithin:!1,style:(0,o(601726).E)(L,ge),children:(0,$.jsx)(o(943647).A,{height:t,store:L,disabled:!fe,paddingLeft:e.getSafePaddingLeftCSS(n),paddingRight:e.getSafePaddingRightCSS(n),proxyWidth:e.state.width})})}),[ge,be,fe,G,L,z]),qt=(0,a().K8)((()=>{const e=ge.currentUser.isLoggedIn(),t=me&&me.publicEditModeStore.state;let n;return z===N().Rr.Frame?n=E().default.state.currentLoadingContainerStore:z===N().Rr.PeekView&&Q().default.state.open&&(n=Q().default.state.loadingContainerStore),Boolean(L&&n&&L.isDefined()&&!L.isNonEditableState()&&L.canEdit()&&!L.hasContent()&&e&&(!(null!=t&&t.hasPublicPermission)||"edit"===(null==t?void 0:t.permission))&&!(Boolean(o(302022).A.state.pageMap[L.id])||o(66496).A.state.pages.has(L.id))&&n.state.ready&&!(0,B().sV)(L)&&!(0,B().fc)(L)&&(!(0,o(68465).ZE)(t)||"completionPopup"!==o(525569).default.state.type))}),[ge.currentUser,me,L,z]),Wt=(0,n.useMemo)((()=>({store:L,isEditable:fe,hasCover:Ot,isInSidePeek:Ke,openMenuOnMountCallback:()=>{Ye.current=!1}})),[Ot,fe,Ke,L]),Qt=(0,a().K8)((()=>function(e){return Boolean(e.getAssociatedCollectionStore())}(L)),[L]),Xt=(0,a().K8)((()=>pe.isMobile&&!pe.isTablet&&pe.isIOS&&!Qt&&"on"===j().default.getEligibleGroup({experimentId:"mobile_lightweight_editor_prompt",defaultGroup:"control"})),[pe.isMobile,pe.isTablet,pe.isIOS,Qt]),Gt=(0,a().K8)((()=>{var t;const o=(null===(t=e.styleOverrides)||void 0===t?void 0:t.paddingX)??(0,B().OU)(z,ge);let n=e.titlePlaceholder;return Xt&&(n=""),{store:L,disabled:!ve,isInSidePeek:Ke,paddingLeft:o,paddingRight:o,extraStyles:e.titleStyle,titlePlaceholder:n,collectionContextStore:$e,shouldShowTemplatePicker:qt,onTitleChange:Mt,onTitleEditText:Ct,onTitleEsc:_t,onTitleUntab:Bt,onTitleTab:At}}),[null===(i=e.styleOverrides)||void 0===i?void 0:i.paddingX,e.titleStyle,e.titlePlaceholder,z,ge,L,ve,$e,qt,Mt,Ct,_t,Bt,At,Ke,Xt]),$t=(0,n.useCallback)((e=>{"page"===e&&f().measurePageRenderMetrics({environment:ge,isEditable:fe,isHomePage:!1,isWikiHome:!0,isPageWithCustomLayout:!1,idSchema:ye})}),[ge,fe,ye]),Yt=(0,a().K8)((()=>{var t,n;const i=(0,$.jsx)(o(155129).X.Provider,{value:Ce,children:(0,$.jsx)(o(145214).A,{tag:o(817942).Mx,animate:_e.layout,type:xt,withBottomPadding:z!==N().Rr.DraftPostInInlineComposer&&z!==N().Rr.Presentation,ref:We,children:(0,$.jsx)(o(259140).A,{context:z,postContext:wt,onHeaderMouseEnter:ft,onHeaderMouseLeave:bt,onDetailMouseEnter:ht,onDetailMouseLeave:Pt,pageCoverHeight:(null===(t=e.styleOverrides)||void 0===t?void 0:t.pageCoverHeight)??te(ge),modules:(null===(n=e.layoutModulesByArea)||void 0===n?void 0:n.page_main)??It.page_main,styleOverrides:e.styleOverrides,templatePickerMenuListStore:De.templatePickerMenuListStore,topControls:zt,getControlHoverStyle:Tt,pageViewBlockStores:De,...Wt,openMenuOnMount:Ye.current,...Gt,disabled:ue,pageViewBlockAccessor:Ge,editorContentContainerRef:qe,layoutRef:We})})});return $e&&$e.contextType?(0,$.jsx)(P().RI,{value:$e,children:i}):i}),[Ce,_e.layout,xt,z,ft,bt,ht,Pt,e.styleOverrides,null===(m=e.layoutModulesByArea)||void 0===m?void 0:m.page_main,ge,It.page_main,De,zt,Tt,Wt,Gt,ue,Ge,$e,wt]),Zt=(0,a().K8)((()=>L.getType()===o(700500).xd.copyIndicator&&(L.getParentTable()!==d().Vl||L.getParentTable()===d().Vl&&0===Object.keys(L.getProperties()).length)?(0,$.jsx)(o(388139).F,{}):o(777932).A.state.isDuplicating?(0,$.jsx)(h().R,{store:L,peekMode:void 0,forceShowIcon:!0}):be?(0,$.jsx)(P().RI,{value:$e,children:(0,$.jsx)(o(372915).O,{canEdit:ve,context:N().Rr.CollectionViewBlockFullScreen,controlHoverStyle:Et,handleHeaderMouseEnter:ft,handleHeaderMouseLeave:bt,headerFocusStore:De.headerFocusStore,pageCover:Nt,topControls:zt,...Wt,openMenuOnMount:Ye.current,...Gt,store:L,onCollectionViewBlockMount:$t,editorContentContainerRef:qe})}):ot?(0,$.jsx)(o(620137).e,{renderLoading:()=>(0,$.jsx)(h().R,{store:L,peekMode:void 0}),innerRenderLoading:()=>(0,$.jsx)(h().R,{store:L,peekMode:void 0}),store:L}):he?(0,$.jsx)(o(563615).eN,{store:L}):(0,$.jsx)(o(261237).c,{displayName:"PageContent",style:{...Y,...e.style},disabled:!ve||L.isNonEditableState(),onBlur:Kt,shouldSelectOnEnter:oe,ref:Qe,children:Yt})),[ve,$e,Et,Kt,ft,bt,be,ot,$t,Yt,Wt,Gt,e.style,Nt,L,De.headerFocusStore,zt,he]);return(0,w().NW)(L,t,(0,n.useMemo)((()=>({store:L,blockContext:z,openResolvedDiscussionPopup:Ue,getContentInnerWidth:Ne,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:$e,...De,renderedType:"page",getBlockStore:()=>L,getNode:()=>Qe.current})),[L,z,$e,Ne,Xe,Ge,Ue,De]),Zt)}const ee=n.memo(n.forwardRef(J),o(821062).A);function te(e){return e.device.isMobile?200:`${Z}vh`}function oe(){return 0===G().default.state.stores.length}function ne(e){return e.getAssociatedCollectionStore()}function ie(e){return e===N().Rr.Frame}function re(e){return(0,B().L5)(e)?W().A:z().A}function ae(e){return(0,B().L5)(e)?q().A:ie(e)?L().A:(0,p().HB)(e)}function se(e){return ie(e)||(0,B().L5)(e)}function le(e,t){const{device:o,RouterStore:n}=t,{route:i}=n.state,r=e;return o.isMobileNative&&"page"===i.name&&i.showMoveTo&&r.isEmptyTitle()&&r.isEmptyPage()}function ce(e,t,o,n){return o===N().Rr.DraftPostInInlineComposer?"create-post":o===N().Rr.Presentation?"presentation-mode":n.device.isPhone?"phone":n.device.isTablet?(0,B().Ck)(t,o,n)?"wide":"tablet":(0,B().L5)(o)?(0,B().mb)(t)?"side-peek":"center-peek":function(e){return e===N().Rr.InAppTemplatePreview}(o)||function(e){return e===N().Rr.InPageSnapShot}(o)?"template-preview":(0,B().Ck)(t,o,n)?e?"wide-right-margin-expanded":"wide":"default"}function de(e){if(!Q().default.isSidePeekOpen()&&!Q().default.isCenterPeekOpen())return!1;const t=E().default.state.mainEditorCurrentBlockStore;return(0,I().lU)(t)}},299772:(e,t,o)=>{o.d(t,{AP:()=>l,Ay:()=>y,By:()=>m,DX:()=>d,JK:()=>c,Mi:()=>h,Qs:()=>b,T1:()=>g,Wj:()=>k,Y4:()=>u,dp:()=>p,g1:()=>C,nu:()=>P,uD:()=>S,y_:()=>v,zs:()=>s});var n=()=>o(662303),i=()=>o(284371),r=()=>o(478726),a=()=>o(548821);const s=i().vc(n().locale).sans,l={serif:i().vc(n().locale).serif,mono:i().vc(n().locale).mono,comic:i().vc(n().locale).comic},c={serif:1.6,mono:1.6},d={serif:0,mono:.055},u={serif:15,mono:14},g={serif:17,mono:15},p=14,m=17,v=16,S=16,f=30;function b(e){return e.device.isMobile?200:`${f}vh`}const y=o(87181).Ay;function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{device:o}=e;return o.isTablet?380:o.isIOS?Math.max(350,t):o.isMobile?400:"30vh"}function h(e){return!!e&&(e===a().Rr.PostInFullPageOrPeek||e===a().Rr.DraftPostInFullPageComposer)}function P(e,t){return 28+(0,r().XD)(e,t)}function C(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}}}]);