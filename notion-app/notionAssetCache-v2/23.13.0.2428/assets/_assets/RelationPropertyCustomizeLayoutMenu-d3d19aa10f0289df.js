"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[92222],{50651:(e,t,r)=>{r.d(t,{default:()=>_});r(898992),r(354520),r(672577),r(581454);var o=r(296540),i=()=>r(484714),n=()=>r(56366),l=()=>r(401497),s=()=>r(743176),p=()=>r(851979),a=()=>r(987555),d=()=>r(959013),c=()=>r(496603),y=()=>r(284371),u=()=>r(989423);var h=()=>r(27732),m=()=>r(896628),g=()=>r(317909),x=()=>r(722872),b=()=>r(685889),f=()=>r(962730),v=()=>r(736767),j=()=>r(41459),S=()=>r(760217),A=()=>r(439264),C=()=>r(285790),T=()=>r(928600),k=()=>r(939740),w=()=>r(89924),P=r(474848);const _=function(e){let{collectionStore:t,targetCollectionStore:s,property:p,disabled:a,rowType:c}=e;const y=(0,l().DP)(),h=(0,i().v3)(),m=(0,n().uB)(void 0,r(970585).A),{format:g}=(0,o.useContext)(r(655424).t),x=(0,n().K8)((()=>{const e=b().B7({collectionStore:t,property:p}),r=Object.keys(s.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),o=e.map((e=>e.property)),i=e=>{const t=o.indexOf(e);return-1!==t?t:1/0};return r.sort(((e,t)=>i(e.property)-i(t.property))),r}),[t,s,p]),v=(0,o.useCallback)((e=>(0,P.jsx)(B,{parent:e,collectionStore:t,property:p,disabled:a,targetCollectionStore:s,menuListStore:m,allRelatedTargetProperties:x})),[t,p,a,s,m,x]);return(0,i().WS)()&&"section"!==c||g===j().j.FormEditor||g===j().j.FormViewer?null:(0,P.jsx)(r(859428).A,{renderTooltip:()=>(0,P.jsx)(d().sA,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===c?f().W.Top:f().W.Right,render:e=>(0,P.jsx)(r(406699).Ay,{popupType:r(14235).nl.Popup,alignmentToOrigin:f().C.Start,...e,renderOrigin:t=>(0,P.jsx)(C().A,{icon:r(30626)._,iconStyle:{width:16,color:y.mediumIconColor,fill:y.mediumIconColor},...t,...e}),onClick:()=>{!function(e,t){u().vd(e,"relation_customize_displayed_properties",t)}(h,{from:"section"===c?"relation_section":"configure_relation_modal"})},originGap:16,render:v})})};function M(e){const{props:t,children:r}=e;return(0,P.jsx)(w().A,{...t,noTextOverflow:!0,title:(0,P.jsx)(d().sA,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:r,disableDesktopPadding:!0})}function R(e,t,r,o,i,n,l){const{properties:d,visibility:u}=e;return c().oE(d.map((e=>function(e,t,r,o,i,n,l){const{propertyFormat:d,visibility:c}=e,u=!c,m=i.getSchema();if(!m)return;const g=m[d.property];return g?{key:d.property,render:e=>(0,P.jsx)(S().A,{...e,showDragHandle:!l,title:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,P.jsx)(s().Ay,{icon:g.icon,type:g.type,size:16,theme:r,style:{fill:r.regularIconColor}}),(0,P.jsx)("span",{style:{marginLeft:8,...y().RC},children:g.name})]}),right:(0,P.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,P.jsx)(C().A,{icon:u?a().T:p().h,iconStyle:{width:16,height:16},isDarkIconColor:!u,onClick:()=>{h().xI({propertyFormat:d,visibility:c,collectionStore:o,property:n,environment:t})},disabled:l||"title"===d.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:u},t,r,o,i,n,l))))}function z(e){const t=(0,i().v3)(),{collectionStore:r,property:o,menuListStore:n,disabled:l,visibleProperties:s,hiddenProperties:p,children:a}=e,d=c().oE([...s.map((e=>e.property)),s.length>0&&p.length>0&&{key:"group-header-hidden-property",draggable:!1},...p.map((e=>e.property))]);return(0,P.jsx)(A().Ay,{direction:"vertical",keys:d,renderKey:(e,t)=>a[t],onDrop:e=>{!function(e,t,r,o,i){const{newPropertyKeys:n}=e,l=b().B7({collectionStore:r,property:o}),s=n.indexOf("group-header-hidden-property"),p=c().oE(n.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const r=l.find((t=>t.property===e));return r?s>0?"title"===e&&t>=s?r:{...r,visible:Boolean(t<s)}:r:{property:e,visible:!(s>0)||Boolean(t<s)}}))),a=l.filter((e=>!n.includes(e.property))),d={...b().TA(r)};d[o]||(d[o]={}),d[o].related_properties=[...p,...a],g().createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{m().zA({stores:[r],update:{collection_relation_options:d},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,r,o,n)},disabled:l})}function B(e){let{parent:t,collectionStore:r,property:o,disabled:s,targetCollectionStore:p,menuListStore:a,allRelatedTargetProperties:y}=e;const u=(0,l().DP)(),h=(0,i().v3)(),m=y.filter((e=>e.visible)),g=y.filter((e=>!e.visible)),b=(0,n().K8)((()=>R({properties:m,visibility:!0},h,u,r,p,o,s)),[m,h,u,r,p,o,s]),f=(0,n().K8)((()=>R({properties:g,visibility:!1},h,u,r,p,o,s)),[g,h,u,r,p,o,s]);return y?(0,P.jsxs)(T().A,{menuType:x().gu.Popup,maxWidth:240,maxHeight:500,children:[0===y.length&&(0,P.jsx)(w().A,{children:(0,P.jsx)(v().A,{caption:(0,P.jsx)(d().sA,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),y.length>0&&(0,P.jsx)(k().Ay,{type:k().Oh.Vertical,store:a,initialFocus:void 0,sections:c().oE([m.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,P.jsx)(w().A,{...e,noTextOverflow:!0,title:(0,P.jsx)(d().sA,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,P.jsx)(z,{collectionStore:r,property:o,disabled:s,menuListStore:a,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:c().oE([...b,g.length>0&&{key:"group-header-hidden-property",render:e=>(0,P.jsx)(M,{props:e,children:(0,P.jsx)(P.Fragment,{})}),action:()=>{}},...f])},0===m.length&&g.length>0&&{key:"hidden_properties",render:e=>(0,P.jsx)(M,{props:e,children:(0,P.jsx)(z,{collectionStore:r,property:o,disabled:s,menuListStore:a,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:f}])})]}):null}},736767:(e,t,r)=>{r.d(t,{A:()=>l});var o=r(296540),i=r(474848);function n(e,t){return(0,i.jsx)(r(678553).A,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const l=(0,o.forwardRef)(n)},851979:(e,t,r)=>{r.d(t,{h:()=>i});r(296540);var o=r(474848);const i=(0,r(340498).wt)("eye",{viewBox:"0 0 32 32",svg:(0,o.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);