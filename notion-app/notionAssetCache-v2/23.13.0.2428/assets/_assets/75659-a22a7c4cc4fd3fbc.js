"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[75659],{104636:(e,t,r)=>{r.d(t,{Is:()=>u,LS:()=>m,NH:()=>p,QA:()=>h,_b:()=>d});r(944114);var a=()=>r(244641),n=(r(296540),()=>r(390527)),o=()=>r(604995),i=()=>r(959013),s=()=>r(534177),l=()=>r(108944),c=r(474848);function u(e){const t=l().g7(e)??[],r=[];for(const a of t){if(!("block"===a.table&&!0===a.isTemplate()&&a.getFormat().automation_id&&a.id!==e.id))continue;const t=a.getAutomationStore();if(t){if(!t.isReady())return{automationStoresReady:!1};void 0!==t.getRecurrence()&&t.isDefined()&&r.push(t.getModel())}}return{automationStoresReady:!0,...(0,n().templateAncestorsViolateRecurrenceNesting)(r)}}function d(e){switch(e){case"day":return(0,c.jsx)(i().sA,{defaultMessage:"Repeat daily",id:"database.templatePickerItem.recurrenceFrequency.daily"});case"week":return(0,c.jsx)(i().sA,{defaultMessage:"Repeat weekly",id:"database.templatePickerItem.recurrenceFrequency.weekly"});case"month":return(0,c.jsx)(i().sA,{defaultMessage:"Repeat monthly",id:"database.templatePickerItem.recurrenceFrequency.monthly"});case"year":return(0,c.jsx)(i().sA,{defaultMessage:"Repeat yearly",id:"database.templatePickerItem.recurrenceFrequency.yearly"});default:(0,s().HB)(e)}}function h(){return{start_date:a().c9.local().plus({days:1}).set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,o().dB)(),hour:0,minute:0,frequency:"day",interval:1}}function m(e){const{recurrence:t,intl:r,leadingPhrase:a}=e;return(0,n().rruleFromRecurrence)({..."month"===t.frequency?{...t,monthly_restriction:void 0}:t,weekdays:void 0,hour:0,minute:0,end_condition:void 0}).toText((e=>{switch(e){case"every":if(void 0===a)return"";if("every"===a)return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.every",defaultMessage:"every"});if("repeat every"===a)return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.repeatEvery",defaultMessage:"repeat every"});(0,s().HB)(a);break;case"day":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.day",defaultMessage:"day"});case"days":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.days",defaultMessage:"days"});case"week":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.week",defaultMessage:"week"});case"weeks":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weeks",defaultMessage:"weeks"});case"month":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.month",defaultMessage:"month"});case"months":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.months",defaultMessage:"months"});case"year":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.year",defaultMessage:"year"});case"years":return r.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.years",defaultMessage:"years"});default:return e.toString()}})).trim()}function p(e){const t=e.getRecurrence();return Boolean(e.isTriggerType("recurrence")&&t&&"disabled_recurrence_ended"===e.getStatus())}},194373:(e,t,r)=>{r.d(t,{_:()=>$});r(16280),r(944114),r(898992),r(354520),r(581454);var a=r(296540),n=()=>r(484714),o=()=>r(56366),i=()=>r(401497),s=()=>r(700500),l=()=>r(247331),c=()=>r(977345),u=()=>r(467730),d=()=>r(187174),h=()=>r(328347),m=()=>r(206267),p=()=>r(179034),g=()=>r(519831),y=()=>r(959013),f=()=>r(496603),k=()=>r(534177),b=()=>r(736767),v=()=>r(760217),x=()=>r(419357),A=()=>r(928600),C=()=>r(678553),w=()=>r(939740),S=()=>r(305390),M=()=>r(89924),I=()=>r(859428),j=()=>r(996027),B=()=>r(320865),T=()=>r(175116),L=()=>r(186445),_=()=>r(156988),P=()=>r(553965),R=()=>r(645873),q=()=>r(106628),F=()=>r(361330),V=()=>r(962730),Q=()=>r(351360),N=()=>r(970585),H=()=>r(630116),E=()=>r(546461),W=()=>r(781697),O=r(474848);const K=(0,y().YK)({searchInputPlaceholder:{defaultMessage:"Type to search…",id:"automations.AutomationTargetPickerMenu.search.placeholder"},searchInputPlaceholderUrlsAllowed:{defaultMessage:"Type to search or paste a link…",id:"automations.AutomationTargetPickerMenu.search.placeholderUrlsAllowed"}}),D=5,Y=20,U=20;function $(e){const t=(0,W().e)({maxWidth:360,width:280}),r=(0,a.useMemo)((()=>m().JW()),[]);return(0,O.jsx)(A().A,{...t,children:(0,O.jsx)(Z,{...e,searchSessionId:r})})}const z=Object.values(s().xd).filter((e=>e!==s().xd.form)),G=[s().xd.form];function Z(e){const{formulaTypecheckContextValues:t,includeThisPage:r,onChange:i,onClose:s,parentRecordStore:m,selectedTarget:p,skipCollections:x,skipPages:A,skipVariables:W,spaceId:K,urlBehavior:Y}=e,$=(0,o().uB)(void 0,N().A),Z=(0,E().YC)(),ne=(0,o().K8)((()=>{if(W)return[];if((0,k().O9)(t)&&t.length>0){return Object.values(t).filter((e=>{if(!(0,c().o5)(e.type,{type:"block"}))return!1;if(!r&&"event"===(null==Z?void 0:Z.contextType)&&e.kind===l().FormulaContextValueKind.ContextValue){const t=(0,c().y5)(e.id);return!("global"===t.source&&"button_page"===t.global)}return!0}))}return[]}),[r,W,t,null==Z?void 0:Z.contextType],{useDeepEqual:!0}),[oe]=(0,a.useState)((()=>"url"===(null==p?void 0:p.type)?p.url:"")),[ie,se]=(0,a.useReducer)(ee,{automationVariables:[],collectionQueryLimit:D,pageQueryLimit:D,formQueryLimit:D,searchTerm:oe});(0,a.useEffect)((()=>{if(ie.searchTerm){const e=(0,u().Ay)(ie.searchTerm,ne,(e=>e.kind===l().FormulaContextValueKind.ContextValue?e.name:""));se({type:"set_variables",variables:e})}else se({type:"set_variables",variables:ne})}),[ie.searchTerm,ne]);const le=function(e){const{limit:t,searchTerm:r,skip:i}=e,s=(0,n().v3)(),l=(0,o().K8)((()=>(0,L().ao)()),[]),c=(0,o().K8)((()=>Q().default.state.currentSpaceStore),[]),u=(0,T().Ks)(),h=(0,o().K8)((()=>null==u?void 0:u.collectionViewBlockStore()),[u]),[m,p]=(0,a.useReducer)(te,{error:void 0,isLoading:Boolean(i),results:void 0,total:void 0}),g=(0,R().fJ)(q().T.searchActions),[y]=(0,d().Yb)((async()=>{if(i||!l||"resolved"!==g.status)return;const e=g.value,a=await e.searchCollectionsWithRecents({collectionViewBlockStore:h,environment:s,spaceStore:c,limit:t,parentStore:l,query:r,requireEditPermissions:!0,searchSessionId:void 0});return{results:a.results,total:a.total}}),[i,l,g.status,g.value,h,s,c,t,r],{debounce:F().tu});return(0,a.useEffect)((()=>{if("pending"===y.status||"idle"===y.status)p({type:"query_loadstart"});else if("resolved"===y.status){var e,t;p({results:null===(e=y.value)||void 0===e?void 0:e.results,total:null===(t=y.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===y.status?p({error:y.error,type:"query_error"}):(0,k().HB)(y)}),[y]),m}({limit:ie.collectionQueryLimit,searchTerm:ie.searchTerm,skip:x}),ce=re({limit:ie.pageQueryLimit,searchTerm:ie.searchTerm,skip:A,spaceId:K,blockTypes:z}),ue=re({limit:ie.pageQueryLimit,searchTerm:ie.searchTerm,skip:A,spaceId:K,blockTypes:G}),de=(0,k().O9)(Y)?(0,_().KX)(ie.searchTerm):void 0,he=(0,a.useCallback)((e=>{p&&!f().n4(p,e)?i(e):p?s():i(e)}),[p,i,s]),me=(0,a.useCallback)((e=>{const t=e.target.value;se({searchTerm:t,type:"set_search_term"}),$.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[$]),pe=(0,a.useCallback)((()=>{se({queryLimit:ie.collectionQueryLimit+U,type:"set_collection_query_limit"})}),[ie.collectionQueryLimit]),ge=(0,a.useCallback)((()=>{se({queryLimit:ie.pageQueryLimit+U,type:"set_page_query_limit"})}),[ie.pageQueryLimit]),ye=(0,a.useCallback)((()=>{se({queryLimit:ie.formQueryLimit+U,type:"set_form_query_limit"})}),[ie.formQueryLimit]),fe="variable"===(null==p?void 0:p.type)?p.id:void 0,ke="collection"===(null==p?void 0:p.type)?p.collection.id:void 0,be="page"===(null==p?void 0:p.type)?p.page.id:void 0,ve=[],xe=function(e){const{automationVariables:t,onClick:r,selectedVariableId:a,parentRecordStore:n}=e,o=t.map((e=>{if(e.kind!==l().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");return{action:()=>r({id:e.id,type:"variable"}),key:e.id,render:t=>(0,O.jsx)(j().A,{contextValue:e,checkState:e.id===a,menuArgs:t,parentRecordStore:n})}}));if(0===o.length)return;return{key:"variable_results",items:o,render:e=>(0,O.jsx)(M().A,{...e,title:(0,O.jsx)(y().sA,{defaultMessage:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})})}}({automationVariables:ie.automationVariables,onClick:he,selectedVariableId:fe,parentRecordStore:m});xe&&ve.push(xe);const Ae=function(e){const{urlResult:t,urlBehavior:r,onMenuItemClick:a}=e;if(!t||!r)return;if("notion"===t.type);else{if("web"===t.type||"other"===t.type){const e=[],n={title:t.url,icon:(0,h().h)({width:16,paddingTop:4})};return"allow"===r?e.push({action:()=>{a({type:"url",url:t.url})},key:"url",render:e=>(0,O.jsx)(v().A,{...e,...n})}):"disallow_with_message"===r?e.push({action:()=>{},key:"url",render:e=>(0,O.jsx)(I().A,{placement:V().W.Right,render:t=>(0,O.jsx)(v().A,{...(0,P().A)(t,e),disabled:!0,disabledFeedback:!0,...n}),renderTooltip:()=>(0,O.jsx)(y().sA,{defaultMessage:"Linking to a URL is only allowed if it is the first action in an automation.",id:"automations.AutomationTargetPickerMenu.urlSection.disabledMessage"})})}):(0,k().HB)(r),{key:"url_results",items:e,render:e=>(0,O.jsx)(M().A,{...e,title:(0,O.jsx)(y().sA,{defaultMessage:"Link",id:"automations.AutomationTargetPickerMenu.urlSection.sectionTitle"})})}}(0,k().HB)(t.type)}}({urlResult:de,urlBehavior:Y,onMenuItemClick:he});Ae&&ve.push(Ae);const Ce=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:r,onShowMoreItemClick:a,parentRecordStore:n,selectedCollectionId:o}=e;if(t.isLoading)return;let i=[];if(t.error)i.push({action:a,key:"show_more_collection_results",render:e=>(0,O.jsx)(b().A,{...e,caption:(0,O.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0})});else{const e=t.results??[],s=e.length;i=e.map((e=>{const t=H().md.createChildStore(n,{table:g().Vl,id:e});return{action:()=>r({collection:t.getSpaceShardedPointer(),type:"collection"}),key:e,render:r=>(0,O.jsx)(S().A,{...r,checkState:e===o,store:t})}}));const l=t.total??0,c=Math.max(0,l-s);c>0&&i.push({action:a,key:"show_more_collection_results",render:e=>(0,O.jsx)(X,{...e,showMoreCount:c})})}if(0===i.length)return;return{key:"collection_results",items:i,render:e=>(0,O.jsx)(M().A,{...e,title:(0,O.jsx)(y().sA,{defaultMessage:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})})}}({collectionQueryResult:le,onCollectionMenuItemClick:he,onShowMoreItemClick:pe,parentRecordStore:m,selectedCollectionId:ke});Ce&&ve.push(Ce);const we=ae({type:"page",onPageMenuItemClick:he,onShowMoreItemClick:ge,queryResult:ce,parentRecordStore:m,selectedPageId:be});we&&ve.push(we);const Se=ae({type:"form",onPageMenuItemClick:he,onShowMoreItemClick:ye,queryResult:ue,parentRecordStore:m,selectedPageId:be});Se&&ve.push(Se);const Me=le.isLoading||ce.isLoading||ue.isLoading;let Ie;if(ve.length>0)Ie=(0,O.jsx)(w().Ay,{initialFocus:0,sections:ve,store:$,type:w().Oh.Vertical});else if(Me){const e=D+2;Ie=(0,O.jsxs)(M().A,{children:[(0,O.jsx)(B().A,{}),[...Array(e)].map(((e,t)=>(0,O.jsx)(C().A,{},t)))]})}else Ie=(0,O.jsx)(b().A,{caption:(0,O.jsx)(y().sA,{defaultMessage:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})});return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(J,{onChange:me,value:ie.searchTerm,urlsAllowed:"allow"===Y}),Ie]})}function J(e){const{onChange:t,value:r,urlsAllowed:a}=e,{isMobile:o}=(0,n().Y0)(),s=(0,y().tz)(),l=(0,i().IS)((()=>({section:{paddingBlockStart:0,marginTop:12}})),[]);return(0,O.jsx)(M().A,{style:l.section,children:(0,O.jsx)(x().Ay,{focusInitial:!o||void 0,onChange:t,placeholder:s.formatMessage(a?K.searchInputPlaceholderUrlsAllowed:K.searchInputPlaceholder),showClearButton:!0,value:r??""})})}const X=(0,a.forwardRef)((function(e,t){const{showMoreCount:a}=e,n=(0,i().IS)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]);return(0,O.jsx)(v().A,{...e,icon:(0,r(30626)._)({width:16,height:16}),ref:t,style:n.showMoreButton,title:(0,O.jsx)(y().sA,{defaultMessage:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(a,U)}})})}));function ee(e,t){if("set_variables"===t.type)return{...e,automationVariables:t.variables.slice(0)};if("set_search_term"===t.type){const r=t.searchTerm?Y:D;return{...e,collectionQueryLimit:r,pageQueryLimit:r,searchTerm:t.searchTerm}}if("set_collection_query_limit"===t.type){if(e.collectionQueryLimit!==t.queryLimit)return{...e,collectionQueryLimit:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e.pageQueryLimit!==t.queryLimit)return{...e,pageQueryLimit:t.queryLimit}}else if("set_form_query_limit"===t.type){if(e.formQueryLimit!==t.queryLimit)return{...e,formQueryLimit:t.queryLimit}}else(0,k().HB)(t);return e}function te(e,t){if("query_loadstart"===t.type){if(!e.isLoading)return{...e,isLoading:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,isLoading:!1,results:t.results,total:t.total};if("query_error"===t.type)return{...e,error:t.error,isLoading:!1,results:void 0,total:void 0};(0,k().HB)(t)}return e}function re(e){const{limit:t,searchTerm:r,skip:o,spaceId:i,blockTypes:s}=e,l=(0,n().v3)(),[c,u]=(0,a.useReducer)(te,{error:void 0,isLoading:Boolean(o),results:void 0,total:void 0}),[h]=(0,d().Yb)((async()=>{if(o||!i)return;const e=await q().T.searchActions.load(),a=await e.searchPagesInSpace({boostRecentlyViewedPages:!0,environment:l,excludeTemplates:!0,limit:t,query:r,requireEditPermissions:!1,source:"automation_page_picker",spaceId:i,filterOverrides:{blockTypes:s}});return{results:a.results.map((e=>e.id)),total:a.total}}),[s,l,t,r,o,i],{debounce:F().tu});return(0,a.useEffect)((()=>{if("pending"===h.status||"idle"===h.status)u({type:"query_loadstart"});else if("resolved"===h.status){var e,t;u({results:null===(e=h.value)||void 0===e?void 0:e.results,total:null===(t=h.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===h.status?u({error:h.error,type:"query_error"}):(0,k().HB)(h)}),[h]),c}function ae(e){const{type:t,queryResult:r,onPageMenuItemClick:a,onShowMoreItemClick:n,selectedPageId:o,parentRecordStore:i}=e;if(r.isLoading)return;const s=[];if(r.error)s.push({action:n,key:"show_more_page_results",render:e=>(0,O.jsx)(b().A,{...e,caption:(0,O.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0})});else{const e=(r.results??[]).length;for(const n of r.results??[]){const e=H().Bv.createChildStore(i,{table:p().ev,id:n}),t={key:n,render:t=>(0,O.jsx)(S().A,{...t,checkState:n===o,store:e}),action:()=>a({page:e.getSpaceShardedPointer(),type:"page"})};s.push(t)}const t=r.total??0,l=Math.max(0,t-e);l>0&&s.push({action:n,key:"show_more_page_results",render:e=>(0,O.jsx)(X,{...e,showMoreCount:l})})}return 0!==s.length?{key:"page"===t?"page_results":"form_results",items:s,render:e=>(0,O.jsx)(M().A,{...e,title:"page"===t?(0,O.jsx)(y().sA,{defaultMessage:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"}):(0,O.jsx)(y().sA,{defaultMessage:"Forms",id:"automations.AutomationTargetPickerMenu.formsSection.title"})})}:void 0}},239633:(e,t,r)=>{r.d(t,{O:()=>a});const a=(0,r(959013).YK)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}})},548526:(e,t,r)=>{r.d(t,{x:()=>l});var a=r(296540),n=()=>r(546806),o=()=>r(284371),i=r(474848);const s={height:"auto",maxWidth:"auto",paddingInline:4},l=(0,a.forwardRef)((function(e,t){const{children:l,disabled:u,hasActionRequired:d,errorIcon:h,icon:m,isCompact:p,isError:g,isSecondary:y,onClick:f,style:k,tooltipMessage:b,dropdownButtonType:v}=e,x=(0,r(484714).v3)(),A="dropdown"===v,C=(0,r(401497).IS)((e=>({button:{...c(e,{isError:g,hasActionRequired:d,isSecondary:y,dropdownButtonType:v}),gap:2,padding:"0 6px",...p?s:void 0,...A&&{alignItems:"center",height:20,paddingBlock:0,marginBlock:0},...k},children:{...o().RC,lineHeight:"20px",flex:"1 1 auto",display:"grid",gridTemplateColumns:"auto auto",gap:2,...A&&{padding:"0 2px"}},icon:{width:16,height:16,marginRight:2,...g?{fill:e.lightErrorText}:void 0},warningIcon:{color:e.errorText,fill:e.errorText,height:12,flex:"0 0 auto",marginRight:2,width:12},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",...p?{height:12,width:12}:{height:14,width:14},...A&&{fill:"unset"}}})),[g,d,y,v,p,A,k]),w=(0,a.useMemo)((()=>m?()=>m(C.icon):void 0),[m,C.icon]),S=(0,a.useCallback)((()=>b??null),[b]),M=(0,a.useCallback)((e=>{r(725614).clear({environment:x}),r(778417).IU({environment:x}),null==f||f(e),e.stopPropagation()}),[x,f]),I=h||r(693954).Q,j=g?()=>I(C.warningIcon):w;return(0,i.jsx)(r(859428).A,{delayThreshold:0,disableTooltip:!Boolean(b),placement:r(962730).W.Bottom,render:e=>"dropdown"===v?(0,i.jsxs)(r(890824).A,{...e,variant:g?"secondary":"lightGray",disabled:u,disabledFeedback:u,onClick:M,ref:t,style:C.button,children:[j&&j(),(0,i.jsx)("div",{style:C.children,children:l}),p?(0,r(346615).p)(C.chevronIcon):(0,n().e)(C.chevronIcon)]}):(0,i.jsxs)(r(493823).p,{...e,icon:g?j:w,disabled:u,disabledFeedback:u,onClick:M,ref:t,shouldShrink:!0,style:C.button,isRed:g,children:[(0,i.jsx)("div",{style:C.children,children:l}),(0,n().e)(C.chevronIcon)]}),renderTooltip:S})}));function c(e,t){const{isError:r,hasActionRequired:a,isSecondary:n,dropdownButtonType:i}=t;return r?{color:e.errorText,..."dropdown"===i&&{boxShadow:"none"}}:a?{fontWeight:o().Wy.regular,color:e.text.secondary}:n?{color:e.text.secondary}:{fontWeight:o().Wy.regular,color:e.text.primary}}},617640:(e,t,r)=>{r.d(t,{m:()=>n});r(296540);var a=r(474848);const n=(0,r(340498).wt)("mention",{viewBox:"0 0 16 16",svg:(0,a.jsx)("path",{d:"M0.870117 8.40625C0.870117 4.01758 3.86426 1.09863 8.14355 1.09863C12.2109 1.09863 15.123 3.68945 15.123 7.6543C15.123 10.293 13.9131 12.1318 11.9443 12.1318C10.8506 12.1318 10.0439 11.5645 9.87988 10.6279H9.79785C9.4082 11.5781 8.62207 12.1318 7.57617 12.1318C5.77148 12.1318 4.53418 10.6143 4.53418 8.42676C4.53418 6.2666 5.76465 4.77637 7.52148 4.77637C8.52637 4.77637 9.36035 5.28906 9.70215 6.12305H9.79102V5.4668C9.79102 5.03613 10.0371 4.77637 10.4473 4.77637C10.8574 4.77637 11.0967 5.03613 11.0967 5.4668V9.85547C11.0967 10.5801 11.4932 11.0039 12.1904 11.0039C13.2363 11.0039 13.8926 9.69141 13.8926 7.74316C13.8926 4.26367 11.3223 2.28125 8.12988 2.28125C4.56836 2.28125 2.18262 4.81055 2.18262 8.44727C2.18262 12.2207 4.69141 14.4629 8.42383 14.4629C9.29883 14.4629 9.94141 14.3398 10.6797 14.1689C10.8164 14.1416 10.9326 14.1279 11.0283 14.1279C11.3428 14.1279 11.5547 14.3398 11.5547 14.6338C11.5547 14.9141 11.3975 15.1533 10.9463 15.3037C10.3242 15.5088 9.31934 15.6523 8.19824 15.6523C3.93262 15.6523 0.870117 12.8975 0.870117 8.40625ZM7.84277 10.9014C8.99805 10.9014 9.73633 9.93066 9.73633 8.41309C9.73633 6.92285 9.00488 5.98633 7.84961 5.98633C6.71484 5.98633 5.99707 6.93652 5.99707 8.44043C5.99707 9.95117 6.70801 10.9014 7.84277 10.9014Z"})})},628864:(e,t,r)=>{r.d(t,{Hn:()=>Q,XN:()=>V,pj:()=>_,qj:()=>N});r(944114),r(898992),r(354520),r(672577),r(581454),r(737550);var a=r(296540),n=()=>r(484714),o=()=>r(56366),i=()=>r(401497),s=()=>r(148307),l=()=>r(617871),c=()=>r(353147),u=()=>r(831310),d=()=>r(315564),h=()=>r(381138),m=()=>r(966098),p=()=>r(959013),g=()=>r(496603),y=()=>r(973647),f=()=>r(534177),k=()=>r(449506),b=()=>r(510683),v=()=>r(972435),x=()=>r(881707),A=()=>r(62856),C=()=>r(351360),w=()=>r(53137),S=()=>r(829e3),M=()=>r(760217),I=()=>r(419357),j=()=>r(331542),B=()=>r(89924),T=r(474848);const L=(0,p().YK)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Search…"}});function _(e){const{currentNotificationChannels:t,onNotificationChannelSelect:r,onNotificationChannelSelectAll:i,onClose:c,onNewSlackAccountAdded:d,renderMenu:m,channelFilter:k,workflowExternalAuthenticationPointer:S,isMultiSelectMode:_,shouldHideSlackAccountSection:F,shouldShowSelectAllChannels:N}=e,H=(0,n().v3)(),{isMobile:E}=(0,n().Y0)(),W=(0,o().O$)(w().A.completeSlackAuthentications),O=e.currentExternalAuthentication??g().$1(W),K=(0,a.useMemo)((()=>S?{type:"workflow",workflowExternalAuthenticationId:S.id}:O?{type:"external",botId:O.id}:void 0),[S,O]);a.useEffect((()=>{const e=S?null==S?void 0:S.spaceId:null==O?void 0:O.space_id;K&&e&&Q({environment:H,spaceId:e,externalAuthConfig:K})}),[H,K,O,S]);const D=(null==S?void 0:S.id)??(null==O?void 0:O.id),[Y,U]=a.useState(""),{loadedChannelsForAccount:$,isLoading:z}=V(K),G=(0,o().K8)((()=>w().A.integrations.state.find((e=>e.id===l().zG))),[]),Z=(0,o().K8)((()=>{var e;return null===(e=C().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),J=a.useCallback((e=>{O?r(e,O.parent_id):S&&r(e,S.id),_||c()}),[r,O,S,c,_]),X=a.useCallback((()=>{const e=O?O.parent_id:null==S?void 0:S.id;e&&i&&i(e),_&&N||c()}),[O,S,_,N,i,c]),ee=P(),te=a.useCallback((e=>{const{channel:r}=e;return{key:r.id,render:e=>(0,T.jsx)(M().A,{...e,icon:q({channel:r,styles:ee.icon}),desktopIconStyle:{width:8},title:r.name,right:(null==t?void 0:t.some((e=>e.id===r.id)))&&(0,u().o)(ee.icon)}),action:()=>{J(r)}}}),[J,ee.icon,t]),{publicChannels:re,privateChannels:ae,personalChannels:ne}=a.useMemo((()=>function(e,t){const r=[],a=[],n=[];for(const o of e)t&&!t(o)||("public"===o.type?r.push(o):"private"===o.type?a.push(o):"me"===o.type?n.push(o):(0,f().HB)(o.type));return{publicChannels:r,privateChannels:a,personalChannels:n}}($,k)),[k,$]),oe=a.useCallback((()=>re.map((e=>({menuListItem:te({channel:e}),channelName:e.name})))),[re,te]),ie=a.useCallback((()=>ae.map((e=>({menuListItem:te({channel:e}),channelName:e.name})))),[ae,te]),se=a.useCallback((()=>ne.map((e=>({menuListItem:te({channel:e}),channelName:e.name})))),[ne,te]),le=a.useCallback((()=>oe().map((e=>{let{menuListItem:t,channelName:r}=e;if(R({channelName:r,query:Y}))return t})).filter(f().O9)),[oe,Y]),ce=a.useCallback((()=>ie().map((e=>{let{menuListItem:t,channelName:r}=e;if(R({channelName:r,query:Y}))return t})).filter(f().O9)),[ie,Y]),ue=a.useCallback((()=>se().map((e=>{let{menuListItem:t,channelName:r}=e;if(R({channelName:r,query:Y}))return t})).filter(f().O9)),[se,Y]),de=a.useCallback((()=>O?(0,x().qO)(O).organizationName:"Workflows organization"),[O]),he=a.useCallback((()=>{if(!D)return[];const e=[],r=le(),a=ce(),n=ue(),o=N&&_;return o&&e.push({key:"select-all-channels",render:e=>(0,T.jsx)(B().A,{...e}),items:[{key:"all-channels",render:e=>(0,T.jsx)(M().A,{...e,title:(0,T.jsx)(p().sA,{id:"notificationRuleSettings.selectChannelView.selectAllChannels.label",defaultMessage:"All channels"}),right:$.length===(t||[]).length&&(0,u().o)(ee.icon)}),action:X}]}),n.length>0&&e.push({key:"personal-channels",render:e=>(0,T.jsx)(B().A,{...e,title:de(),topBorder:o}),items:n}),r.length>0&&e.push({key:"public-channels",render:e=>(0,T.jsx)(B().A,{...e,topBorder:n.length>0||o,title:0===n.length&&de()}),items:r}),a.length>0&&e.push({key:"private-channels",render:e=>(0,T.jsx)(B().A,{...e,topBorder:r.length>0||o,title:0===n.length&&r.length>0&&de()}),items:a}),e}),[D,le,ce,ue,N,_,X,$,t,ee.icon,de]),me=(0,A().A)(z,500,300);if(!D)return null;const pe=[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,T.jsx)("div",{children:(0,T.jsx)(I().Ay,{...e,inputLeft:(0,T.jsx)(I().Zf,{icon:h().q}),inputRight:me&&(0,T.jsx)(j().A,{style:{marginRight:2}}),showClearButton:!0,placeholder:v().A.formatMessage(L.channelSearchPlaceholder),focusInitial:!E,value:Y,onChange:e=>{U(e.target.value)}})})}],render:e=>(0,T.jsx)(B().A,{...e})},...he()];return t||F||!G||pe.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!Z)return;const e=await b().Jq({environment:H,integration:G,spaceId:Z,from:"collection_view_settings"});y().Q.isFail(e)||d()},render:e=>(0,T.jsx)(M().A,{...e,icon:(0,T.jsx)("img",{src:s().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,T.jsx)(p().sA,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,T.jsx)(B().A,{...e,topBorder:!0})}),(0,T.jsx)(T.Fragment,{children:m(pe)})}function P(){return(0,i().IS)((e=>({icon:{marginLeft:8,width:12,height:12,color:e.lightTextColor},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor}})),[])}function R(e){const{channelName:t,query:r}=e;return 0===r.length||t.toLocaleLowerCase().indexOf(r.trim().toLocaleLowerCase())>=0}function q(e){const{channel:t,styles:r}=e;return"private"===t.type?(0,d().S)(r):"me"===t.type?(0,c().b)(r):(0,m().E)(r)}const F=15e3;function V(e){return(0,o().K8)((()=>{if(!e)return{loadedChannelsForAccount:[],isLoading:!1};const t=S().c.getStateForBot(e);return{loadedChannelsForAccount:Object.values(t.channels),isLoading:t.fetching}}),[e])}async function Q(e){const{environment:t,externalAuthConfig:r,spaceId:a}=e,n=S().c.getStateForBot(r);if(n.fetching||Date.now()-n.lastRefreshed<F)return;let o;for(S().c.updateStateForBot(r,{fetching:!0,lastRefreshed:Date.now()});;){const e=await k().callApi({eventName:"getExternalNotificationChannels",environment:t,data:{spaceId:a,cursor:o,...r}});if("success"!==e.type){console.error(e.error);break}{const t={};for(const r of e.data.channels)t[r.id]=r;if(S().c.addChannelsForBot(r,t),o=e.data.cursor,!o)break}await new Promise((e=>setTimeout(e,0)))}S().c.updateStateForBot(r,{fetching:!1})}const N=a.forwardRef(((e,t)=>{const{channel:r,currentNotificationChannels:a,...n}=e,o=P();return(0,T.jsx)(M().A,{ref:t,...n,icon:q({channel:r,styles:o.icon}),desktopIconStyle:{width:8},title:r.name,right:(null==a?void 0:a.some((e=>e.id===r.id)))&&(0,u().o)(o.icon)})}));N.displayName="SlackChannelMenuItem"},629203:(e,t,r)=>{r.d(t,{U:()=>n});var a=()=>r(401497);function n(){return(0,a().IS)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[])}},656134:(e,t,r)=>{r.d(t,{j:()=>i});var a=()=>r(484714),n=()=>r(56366),o=()=>r(14235);function i(e){const t=(0,a().Y0)();return(0,n().K8)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?o().nl.SlideUp:o().nl.Popup),[t,null==e?void 0:e.tabletBehavior])}},829e3:(e,t,r)=>{r.d(t,{c:()=>i,m:()=>n});function a(e){switch(e.type){case"external":return`external-${e.botId}`;case"workflow":return`workflow-${e.workflowExternalAuthenticationId}`;case"universal":return`universal-${e.app}-${e.spaceId}`;default:throw(0,r(534177).HB)(e)}}const n={channels:{},fetching:!1,lastRefreshed:0};class o extends(()=>r(757695))().default{getStateForBot(e){const t=a(e);return this.state[t]??n}updateStateForBot(e,t){this.setState({...this.state,[a(e)]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const r=this.getStateForBot(e);this.setState({...this.state,[a(e)]:{...r,channels:{...r.channels,...t}}})}}const i=new o;(0,r(604341).exposeDebugValue)("ExternalNotificationChannelsStore",i)},890824:(e,t,r)=>{r.d(t,{A:()=>d});var a=r(296540),n=()=>r(100622),o=()=>r(534177),i=r(474848);function s(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonBackground,boxShadow:t.buttonBoxShadow,color:"white"};case"secondary":return{background:n().Ay.frontSecondaryButtonBackground,boxShadow:`\n\t\t\t\t\t0 1px 2px rgba(15, 15, 15, 0.1),\n\t\t\t\t\tinset 0 0 0 1px ${n().Ay.redWithAlpha(.3)}`,color:n().Ay.red};case"tertiary":case"aiTertiary":return{background:n().Ay.white,color:n().Ay.frontTextDark,border:"1px solid rgba(15, 15, 15, 0.15)",width:"100%",boxShadow:"0 1px 2px rgba(15, 15, 15, 0.05)"};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackground,border:`1px solid ${n().Ay.frontQuaternaryButtonBorder}`,boxShadow:"0 1px 2px rgba(15, 15, 15, 0.1)",color:"white"};case"aiPrimary":return{background:"#CA59FF",color:"white"};case"lightGray":return{background:t.tint.regular,color:t.text.secondary};default:(0,o().HB)(e)}}function l(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonHoveredBackground};case"secondary":return{background:n().Ay.frontSecondaryButtonBackgroundHovered};case"tertiary":return{background:"light"===t.mode?t.buttonHoveredBackground:n().Ay.whiteWithAlpha(.8)};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackgroundHovered};case"aiPrimary":case"aiTertiary":return{background:"#C592DD"};case"lightGray":return{background:t.tint.regular,color:t.text.primary};default:(0,o().HB)(e)}}function c(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonPressedBackground};case"secondary":return{background:t.buttonPressedBackground};case"tertiary":return{background:"light"===t.mode?t.buttonPressedBackground:n().Ay.whiteWithAlpha(.85)};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackgroundPressed};case"aiPrimary":case"aiTertiary":return{background:"#946EA6"};case"lightGray":return{background:t.state.pressed,color:t.text.primary};default:(0,o().HB)(e)}}function u(e,t){const{id:a,children:n,disabledFeedback:o,isFullWidth:u,isLoading:d,onClick:h,style:m,variant:p,...g}=e,y=(0,r(401497).DP)(),f={display:"inline-grid",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:4,fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:r(284371).Wy.medium,...d&&{gridTemplateColumns:"1fr auto 1fr"},transition:"background-color color 150ms ease"};return(0,i.jsx)(r(704152).A,{ref:t,id:a,onClick:h,style:{...f,...s(p,y),...m,...u&&{width:"100%",justifyContent:"center"}},hoveredStyle:l(p,y),pressedStyle:c(p,y),loadingSpinnerStyle:{marginLeft:"auto"},isLoading:d,disabledFeedback:o,...g,children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center"},children:n})})}const d=a.memo(a.forwardRef(u),r(821062).A)},918676:(e,t,r)=>{r.d(t,{y:()=>n});r(296540);var a=r(474848);const n=(0,r(340498).wt)("clock",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M6.541 10.919a.53.53 0 0 1-.39-.157.53.53 0 0 1-.157-.39c0-.155.053-.283.157-.383a.53.53 0 0 1 .39-.157h2.905V5.895c0-.15.053-.278.158-.383a.521.521 0 0 1 .382-.158.53.53 0 0 1 .39.158.521.521 0 0 1 .157.383v4.477a.53.53 0 0 1-.157.39.53.53 0 0 1-.39.157H6.541Zm3.452 6.207a6.789 6.789 0 0 1-2.727-.554 7.124 7.124 0 0 1-2.256-1.524 7.277 7.277 0 0 1-1.525-2.256 6.788 6.788 0 0 1-.553-2.727c0-.967.184-1.876.553-2.728a7.241 7.241 0 0 1 3.773-3.78 6.788 6.788 0 0 1 2.728-.554c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 0 1 1.53 2.25c.37.852.554 1.761.554 2.728 0 .966-.184 1.875-.553 2.727a7.218 7.218 0 0 1-3.787 3.78 6.789 6.789 0 0 1-2.728.554Zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 0 0 1.805-1.217 5.68 5.68 0 0 0 1.217-1.804c.291-.684.437-1.42.437-2.208a5.55 5.55 0 0 0-.437-2.202 5.66 5.66 0 0 0-3.029-3.028 5.567 5.567 0 0 0-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 0 0 5.98 6.052a5.715 5.715 0 0 0-1.21 1.811 5.55 5.55 0 0 0-.437 2.202c0 .788.146 1.524.438 2.208a5.735 5.735 0 0 0 1.21 1.804 5.598 5.598 0 0 0 4.013 1.654Z"})})},996027:(e,t,r)=>{r.d(t,{A:()=>b});r(296540);var a=()=>r(484714),n=()=>r(494379),o=()=>r(977345),i=()=>r(919709),s=()=>r(959013),l=()=>r(534177),c=()=>r(931077),u=()=>r(553965),d=()=>r(962730),h=()=>r(630116),m=()=>r(760217),p=()=>r(16006),g=()=>r(859428),y=()=>r(239633),f=()=>r(629203),k=r(474848);function b(e){var t;const{checkState:r=!1,disabled:b,menuArgs:v,parentRecordStore:x}=e,{isMobile:A}=(0,a().Y0)(),C=(0,f().U)();let w;if("annotation"in e){const{annotation:t,formulaTypecheckContextValues:r}=e,a=(0,i().iVq)(t).id;w=(0,l().O9)(r)?(0,o().IV)(r,a):void 0}else w=e.contextValue;const S=(null===(t=w)||void 0===t?void 0:t.associatedCollectionForDisplay)&&h().md.createChildStore(x,w.associatedCollectionForDisplay),M=w&&(0,o().Ix)(w.type),I=A?24:20;return w?(0,k.jsx)(g().A,{renderTooltip:()=>b?(0,k.jsx)(s().sA,{...y().O.maximumPeopleSelectedTooltip}):(0,o().E9)(w),placement:d().W.Right,render:e=>(0,k.jsx)(m().A,{checkState:r,title:(0,k.jsx)("div",{style:{display:"flex"},children:w.name}),disabled:b,style:b?C.disabledMenuItem:void 0,icon:(0,l().O9)(w.stepNumberForDisplay)?(0,k.jsx)(c().Q,{number:w.stepNumberForDisplay,size:n().H.Medium}):M?M({width:I,height:I,padding:2}):void 0,caption:S&&(0,k.jsx)(s().sA,{defaultMessage:"to {database}",id:"automations.AutomationTargetPickerMenu.VariableMenuItem.databaseCaption",values:{database:(0,k.jsx)(p().A,{store:S,style:{display:"inline"}})}}),...(0,u().A)(v,e)})}):null}}}]);