"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[47779],{79024:(e,t,o)=>{o.r(t),o.d(t,{TableHeaderCellMenu:()=>B});o(944114),o(898992),o(354520),o(672577),o(581454);var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(401497),l=()=>o(970013),s=()=>o(713998),c=o(474848);const p={viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M6.653 2.375A.625.625 0 0 0 6.028 3v.474A3.62 3.62 0 0 0 7.24 6.179l.289.258-.157 1.603a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08H15c.345 0 .625-.28.625-.625v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625zm1.42 2.871c-.468-.417-.75-1-.79-1.621h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.293 3.197v.006h-8.75v-.006c0-1.447.922-2.733 2.293-3.197l.237-.08a.63.63 0 0 0 .422-.531l.227-2.318a.63.63 0 0 0-.206-.528z"})},d=(0,o(340498).wt)("pin",p);var u=()=>o(206267),m=()=>o(798880),f=()=>o(959013),y=()=>o(496603),g=()=>o(901952),h=()=>o(436696),S=()=>o(187899),v=()=>o(235191),A=()=>o(686526),x=()=>o(4319),b=()=>o(317909),C=()=>o(673964),I=()=>o(419167),_=()=>o(760217),w=()=>o(939740),k=()=>o(8980),j=()=>o(859428),P=()=>o(673730),T=()=>o(68465),M=()=>o(722872),F=()=>o(553965),O=()=>o(962730);const B=n.memo((function(e){const{allowHidingTitle:t,collectionContextStore:p,columnIndex:B,format:W,formatKey:H,parent:z,property:E,schema:V}=e,L=(0,f().tz)(),U=(0,r().v3)(),{isPhone:K,isMobile:q}=(0,r().Y0)(),$=(0,a().DP)(),{collectionStore:G,collectionViewStore:Y,collectionSettingsStore:X,isNonEditableState:J,collectionStoreFormat:Q}=(0,i().K8)((()=>{const e=p.collectionStore(),t=p.collectionViewStore(),o=p.settingsStore,n=null==e?void 0:e.isNonEditableState(),r=null==e?void 0:e.getFormat();return{collectionStore:e,collectionViewStore:t,collectionSettingsStore:o,isNonEditableState:n,collectionStoreFormat:r}}),[p]),Z=(0,i().O$)(p.permissionScopesStore),ee=(0,i().O$)(p.isInHomeWidgetStore),te=(0,i().K8)((()=>null==Y?void 0:Y.getType()),[Y]),oe=(0,i().K8)((()=>"collectionTypedView"===p.contextType),[p]),ne=(0,i().K8)((()=>{const{frozenIndex:e}=p.frozoneStore.state;return Boolean(B===e)}),[p,B]),re=(0,i().K8)((()=>{const{frozenIndex:e,scrollerWidth:t}=p.frozoneStore.state;if(void 0===e)return!1;const o=(null==Y?void 0:Y.getTableMaxFrozenColumnIndex(t,p.normalizedFormatStore.state))??-1;return B>o}),[p,Y,B]),ie=(0,i().K8)((()=>{var e;return!(!Y||"timeline"===te)&&Boolean(Y.getFormat().table_wrap||(null===(e=R({format:W,formatKey:H,property:E}))||void 0===e?void 0:e.wrap))}),[Y,W,H,E,te]),ae=(0,n.useMemo)((()=>Q?o(651124).Ts(Q,E):null),[Q,E]),le=(0,i().K8)((()=>(null==ae?void 0:ae.isRunning)||!G||!(0,T().jq)(U,o(411671).A.getMode(U,G),G)),[G,U,ae]),se=(0,i().K8)((()=>(0,T().O0)(U)),[U]),{isTypedProperty:ce,databaseType:pe}=(0,i().K8)((()=>G?{isTypedProperty:G.isTypedProperty(E),databaseType:G.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[G,E]),de=(0,i().uB)(void 0,o(463830).A),ue=(0,i().K8)((()=>{const e=V[E];return o(685889).pg(p,e)}),[p,E,V]),[me,fe]=(0,n.useState)(!1),[ye,ge]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=V[E];e&&ge(e.name||"")}),[E,V]),(0,n.useEffect)((()=>{const e=V[E];e&&"relation"===e.type&&(null==ue||ue.load())}),[E,V,ue]);const he=(0,n.useCallback)((e=>{!function(e){const{collectionContextStore:t,environment:o,inputValue:n,name:r,property:i,schema:a}=e;if(N({property:i,schema:a,inputValue:n}))return;const l=t.collectionStore();if(!l)return;const s=l.getSchema(),c=s[i];if((null==c?void 0:c.name)===r)return;b().createAndCommit({userAction:"TableHeaderCell.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{v().YO({collectionStore:l,property:i,name:r,transaction:e})}}),(0,g().V)({environment:o,collectionContextStore:t,property:i,from:"view_settings",action:"rename"})}({collectionContextStore:p,environment:U,inputValue:ye,name:e,property:E,schema:V})}),[p,U,ye,E,V]),Se=(0,n.useCallback)((e=>{ge(e)}),[]),ve=(0,a().IS)((e=>({rightStyle:{display:"flex",alignItems:"center",color:e.lightTextColor,fill:e.lightIconColor,flexShrink:0},rightIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"},rightIconRotatedStyle:{transform:"rotate(90deg)"}})),[]),Ae=(0,i().K8)((()=>{const e=V[E];if(!Y||!e)return[];const n=(0,o(443239).u)(E),r="title"===e.type,i=[];if(n&&"person"===e.type){const t=[];i.push(t),t.push({key:"synced_person",render:t=>(0,c.jsx)(o(678553).A,{...t,title:e.name||"",icon:(0,c.jsx)(k().I,{icon:o(525884).A}),caption:(0,c.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minWidth:300,maxWidth:350},children:(0,c.jsx)(f().sA,{defaultMessage:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.jsx)(o(719147).A,{href:(0,o(836251).xS)("guides.syncedContent"),children:t})}}})})}),action:()=>{}})}const a=[];i.push(a),!Z.canConfigureCollection||n||Z.isExternallyImportedAndSyncedCollection||(a.push({key:"rename",render:t=>(0,c.jsx)("div",{style:q?{}:{paddingTop:4},children:(0,c.jsx)(o(755735).B,{...t,initialValue:e.name||"",placeholder:o(972435).A.formatMessage(o(913687).A.inputPlaceholder),focusInitial:!q,onChange:Se,onBlur:he,onSubmit:he,iconButton:{icon:t=>(0,c.jsx)(o(743176).Ay,{type:e.type,icon:e.icon,size:16,theme:$,style:t}),iconStyle:{fill:o(278238).l8[$.mode].gray},enforceIconColor:"gray",onSubmit:(e,t)=>function(e,t,o,n,r){const i=t.collectionStore();if(!i)return;b().createAndCommit({userAction:"TableHeaderCell.handlePropertyIconSubmit",environment:o,canUndo:!0,perform:t=>{v().yC({collectionStore:i,property:e,icon:n,transaction:t})}}),(0,g().V)({environment:o,collectionContextStore:t,property:e,icon:n,from:"table",action:"change_icon"})}(E,p,U,e)},inputRightButton:(0,c.jsx)(o(539148).S,{description:e.description,showTooltip:!me,onClick:()=>fe(!me),addDescriptionText:L.formatMessage(P().Mo.addPropertyDescriptionTooltip),editDescriptionText:L.formatMessage(P().Mo.editPropertyDescriptionTooltip)})})}),action:()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_rename"}),(0,C().j)({collectionContextStore:p}),z.close()}}),me&&a.push({key:"description",render:t=>(0,c.jsx)(o(705602).y,{...t,initialDescription:e.description,handleSaveDescription:e=>function(e){var t;const{collectionContextStore:n,description:r,environment:i,property:a}=e,l=n.collectionStore(),s=null==l||null===(t=l.getSchema())||void 0===t?void 0:t[a];if(!l||void 0===s||r===s.description)return;b().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:i,canUndo:!0,perform:e=>{(0,o(312296).F)({environment:i,collectionStore:l,update:{[a]:{...s,description:r}},transaction:e})}}),(0,g().V)({environment:i,collectionContextStore:n,property:a,from:"view_properties",action:"set_description"})}({collectionContextStore:p,description:e,environment:U,property:E}),disableAutoSection:!0}),action:y().lQ}),N({property:E,schema:V,inputValue:ye})&&a.push({key:"duplicate_error",render:e=>(0,c.jsx)(o(653259).A,{...e,propertyName:ye,styles:q?{paddingBottom:5,paddingLeft:16,paddingRight:16,margin:0,boxShadow:`inset 0 -1px 0 ${$.regularDividerColor}`}:{}}),action:y().lQ}));const w=[];if(i.push(w),Z.canConfigureBlock&&!n&&!J&&!Z.isExternallyImportedAndSyncedCollection)if((0,l().nu)(e)){const t=oe||(0,s().Jf)({property:E,propertySchema:e,isTypedProperty:ce});w.push({key:"button_property_change_type",render:e=>(0,c.jsx)(j().A,{placement:O().W.Left,render:n=>(0,c.jsx)("div",{...(0,F().A)(e,n),role:"button",children:(0,c.jsx)(o(59400).Dy,{disabled:t,isTypedProperty:ce,collectionUri:pe,collectionContextStore:p,formatKey:H,propertyTypeButtonPopupStore:de,property:E})}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,c.jsx)(f().sA,{defaultMessage:"Change property type",id:"database.tableHeaderCell.buttonPropertyChangeTypeTooltip"})}),action:()=>{z.close()}}),w.push({key:"button_property_edit_automation",render:e=>(0,c.jsx)(j().A,{placement:O().W.Left,render:t=>(0,c.jsx)(_().A,{title:(0,c.jsx)(f().sA,{defaultMessage:"Edit automation",id:"database.tableHeaderCell.buttonPropertyEditAutomationLeft"}),right:(0,c.jsx)("div",{style:ve.rightStyle,children:(0,o(742117).V)(ve.rightIconStyle)}),...(0,F().A)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,c.jsx)(f().sA,{defaultMessage:"Edit button automation",id:"database.tableHeaderCell.buttonPropertyTooltip"})}),action:()=>{z.close(),o(837570).h({environment:U,mode:"edit_button_property",collectionSettingsStore:X,collectionContextStore:p,propertyId:E,propertySchema:e})}})}else{const e=!Z.canConfigureCollection;w.push({key:"edit_property",render:t=>(0,c.jsx)(j().A,{placement:O().W.Left,render:n=>(0,c.jsx)(_().A,{buttonStyle:{opacity:e?.5:1},disabled:e,title:(0,c.jsx)(f().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:e?(0,c.jsx)(k().I,{icon:o(90907).h}):(0,c.jsx)(k().I,{icon:o(735790).M}),...(0,F().A)(t,n)}),style:{whiteSpace:"normal"},renderTooltip:()=>e?(0,c.jsx)(f().sA,{defaultMessage:"You don't have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"}):(0,c.jsx)(f().sA,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"})}),action:()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_edit"}),(0,C().j)({collectionContextStore:p}),z.close(),A().Ow({collectionContextStore:p,collectionSettingsStore:X,initialStack:[{type:"properties",timelineViewTab:"table"},{type:"property",formatKey:H,property:E}]})}})}if(Z.canConfigureCollection&&!n&&!Z.isExternallyImportedAndSyncedCollection&&G&&ae&&se&&(0,l().$M)(e)){(0,l().om)(e)?w.push({key:"fill_all_pages",render:t=>(0,c.jsx)(j().A,{placement:O().W.Left,renderTooltip:()=>(0,c.jsx)(I().GI,{collectionStore:G,propertySchema:e}),render:e=>(0,c.jsx)(_().A,{titleStyle:{color:le?$.lightTextColor:void 0},disabled:le,icon:(0,c.jsx)(I().am,{updateAiInferencesTaskStatus:ae,progressIconStyle:{marginTop:1,marginLeft:0,marginRight:-3}}),title:(0,c.jsx)(I().Ay,{updateAiInferencesTaskStatus:ae}),caption:void 0!==ae.numPagesFilled&&void 0!==ae.numPagesRequested&&(0,c.jsx)(I().jD,{updateAiInferencesTaskStatus:ae}),...(0,F().A)(t,e)})}),action:async()=>{await o(179070).autofillPropertyForCollection({environment:U,collectionStore:G,propertySchema:e,property:E})}}):w.push({key:"autofill_with_ai",render:e=>(0,c.jsx)(_().A,{disabled:void 0===G,title:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)(f().sA,{defaultMessage:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"}),(0,c.jsx)(o(515918).A,{style:{display:"inline-block"}})]}),icon:(0,c.jsx)(k().I,{icon:o(116089).x,size:"sm",color:"purplePrimary"}),...e}),action:()=>{G&&(z.close(),A().Ow({collectionContextStore:p,collectionSettingsStore:X}),A().a2({collectionSettingsStore:X,item:{type:"properties",timelineViewTab:"table"}}),A().a2({collectionSettingsStore:X,item:{type:"property",formatKey:H,property:E}}),"text"===e.type&&A().a2({collectionSettingsStore:X,item:{type:"propertyAiAutofill",propertySchema:e,property:E}}))}})}if(Z.canConfigureBlock&&((0,s().oH)(e)||(0,s().ah)(e))){const t=[];i.push(t),(0,s().oH)(e)&&(t.push({key:"sort_asc",render:e=>(0,c.jsx)(_().A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:(0,c.jsx)(k().I,{icon:o(112282).s})}),action:()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_sort_asc"}),z.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;D({collectionContextStore:o,environment:r,isAscending:!0,property:t,schema:n})}({collectionContextStore:p,environment:U,property:E,schema:V})}}),t.push({key:"sort_desc",render:e=>(0,c.jsx)(_().A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:(0,c.jsx)(k().I,{icon:o(655923).v})}),action:()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_sort_desc"}),z.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;D({collectionContextStore:o,environment:r,isAscending:!1,property:t,schema:n})}({collectionContextStore:p,environment:U,property:E,schema:V})}})),(0,s().ah)(e)&&t.push({key:"filter",render:e=>(0,c.jsx)(_().A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Filter",id:"database.tableHeaderCell.filter"}),icon:(0,c.jsx)(k().I,{icon:o(170350).S})}),action:()=>{"collectionSystemView"!==p.contextType&&((0,h().X)({environment:U,collectionContextStore:p,action:"table_header_filter"}),z.close(),function(e){const{collectionContextStore:t,environment:n,property:r,schema:i}=e,a=t.currentPropertyFiltersStore.state,l=t.collectionViewBlockStore(),s=(null==l?void 0:l.getRecordModel)??o(792071).b4_.constant(void 0);let c=a.find((e=>{let{filter:t}=e;return t.property===r}));if(!c){const e=(0,o(873050).SO)({property:r,schema:i,getRecordModel:s});if(!e)return;const l={id:u().JW(),filter:e};t.filtersBarOpenStore.setState(!0),S().IU({environment:n,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,propertyFilters:{value:[...a,l]}}}),c=l}if(!c)return;const p=t.isInHomeWidgetStore.state;if(p)return void A().R8({collectionSettingsStore:t.settingsStore,item:{type:"filters"}});t.filtersBarOpenStore.setState(!0);const d=t.getFilterBarItemSettingsStore(c);A().R8({collectionSettingsStore:d,item:{type:"filter"}}),(0,C().j)({collectionContextStore:t})}({collectionContextStore:p,environment:U,property:E,schema:V}))}})}const T=[];if(i.push(T),(t||"title"!==e.type)&&Z.canConfigureBlock&&T.push({key:"hide",render:e=>(0,c.jsx)(_().A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:(0,c.jsx)(k().I,{icon:o(566910).e})}),action:()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_hide"}),z.close(),function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:a,property:l}=e,s=t.collectionViewStore();if(!s)return;const c=i[a]||[],p=c.map((e=>e.property===l?{...e,visible:!1}:e)),d={...i,[a]:p};b().createAndCommit({userAction:"TableHeaderCell.updatePropertyFormat",environment:r,canUndo:!0,perform:e=>{(0,o(654062).F)({collectionViewStore:s,update:{format:d},transaction:e}),x().sp({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"hide"})}})}({collectionContextStore:p,columnIndex:B,environment:U,format:W,formatKey:H,property:E})}}),!Z.canConfigureBlock||ee||K||T.push({key:"freeze_column",render:e=>(0,c.jsx)(j().A,{placement:O().W.Left,disableTooltip:!re,renderTooltip:e=>(0,c.jsx)(f().sA,{...e,defaultMessage:"Insufficient space to freeze columns",id:"database.tableHeaderCell.freezePropertyTooltip",description:"If the width of the frozen columns is wider than the screen, show the user this tooltip warning."}),render:t=>(0,c.jsx)(_().A,{...e,...t,disabled:re,buttonStyle:{color:re?$.text.quaternary:void 0},title:ne?(0,c.jsx)(f().sA,{defaultMessage:"{numberFrozenColumns, plural, one {Unfreeze column} other {Unfreeze columns}}",values:{numberFrozenColumns:B+1},id:"database.tableHeaderCell.unfreezeColumns"}):(0,c.jsx)(f().sA,{defaultMessage:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:ne?(0,c.jsx)(k().I,{icon:o(573812)._}):(0,c.jsx)(k().I,{icon:d})})}),action:()=>{!function(e){const{collectionContextStore:t,columnIndex:o,environment:n}=e;b().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:n,canUndo:!0,perform:e=>{x().sp({environment:n,collectionContextStore:t,currentIndex:o,transaction:e,entrypoint:"TableHeaderCell",propertyAction:"toggle"})}})}({collectionContextStore:p,columnIndex:B,environment:U})}}),!(0,l().vB)(e)||!Z.canConfigureCollection||n||r||Z.isExternallyImportedAndSyncedCollection||T.push({key:"duplicate",render:e=>(0,c.jsx)(_().A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:(0,c.jsx)(k().I,{icon:o(764781).V})}),action:async()=>{(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_duplicate"}),z.close(),await async function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:a,property:l}=e,s=R({format:i,formatKey:a,property:l}),c=t.collectionStore(),p=t.collectionViewStore(),d=t.normalizedFormatStore.state[a]||[],u=null==c?void 0:c.getSpaceId();if(!(c&&p&&u&&s))return;const f=c.getSchema(),y=f[l];if(!y)return;const g=c.getNormalizedPropertyGroups(),S=await(0,o(519839).W4)({environment:r,schema:f,property:l,properties:d,propertyGroups:g,parentStore:c,spaceId:u});if(!S)return;const v=r.currentUser.id,A=v?{id:v,table:m().oo}:void 0,{automationActions:C}=await o(813297).QV.automations.load(),I={...f,[S.newProperty]:S.newPropertySchema},_=c.getFormat(),w={..._,collection_page_properties:S.newProperties,property_groups:S.newPropertyGroups};b().createAndCommit({userAction:"TableHeaderCell.handleDuplicate",environment:r,canUndo:!0,perform:e=>{(0,o(797535).I)({environment:r,collectionStore:c,update:{schema:I,format:w},transaction:e}),x().sp({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"duplicate"}),(0,o(534177).O9)(S.automationUpdate)&&C.duplicateAutomation({actorPointer:A,environment:r,sourceAutomationStore:S.automationUpdate.sourceAutomationStore,targetAutomationId:S.automationUpdate.targetAutomationId,transaction:e}),a&&o(896628).zA({stores:[p],update:{[a]:S.newProperties},transaction:e})}}),(0,h().X)({environment:r,collectionContextStore:t,action:"duplicate_property",original_view_type:null==p?void 0:p.getType(),property_type:y.type})}({collectionContextStore:p,columnIndex:B,environment:U,format:W,formatKey:H,property:E})}}),!l().cN.includes(e.type)||!Z.canConfigureCollection||n||r||Z.isExternallyImportedAndSyncedCollection||T.push({key:"delete",render:e=>(0,c.jsx)(o(437426).$,{...e,property:E,collectionContextStore:p}),action:async()=>{z.close(),await(0,o(358354).I)({collectionContextStore:p,columnIndex:B,updateFrozenColumnEntrypoint:"TableHeaderCell",updateFrozenColumn:!0,environment:U,property:E,schema:V,theme:$,from:"table_column"})}}),Z.canConfigureBlock&&"timeline"!==te){const e=[];i.push(e),e.push({key:"wrap_cell",render:e=>(0,c.jsx)(o(574036).A,{...e,title:(0,c.jsx)(f().sA,{defaultMessage:"Wrap column",id:"database.tableHeaderCell.wrapColumn"}),on:ie}),action:()=>{x().Nv({currentValue:ie,environment:U,property:E,collectionViewStore:Y,format:W,formatKey:H}),(0,h().X)({environment:U,collectionContextStore:p,action:"table_header_wrap_column"})}})}return i}),[t,de,re,p,X,G,Y,B,pe,U,W,H,Se,he,ye,L,le,se,ee,q,oe,J,K,ne,ce,z,Z.canConfigureBlock,Z.canConfigureCollection,Z.isExternallyImportedAndSyncedCollection,E,V,me,ve.rightIconStyle,ve.rightStyle,ae,$,te,ie]),xe=(0,n.useMemo)((()=>y().oE(Ae.map(((e,t)=>{if(e.length>0)return{key:t,render:e=>(0,c.jsx)(o(89924).A,{...e,topBorder:0!==t&&1!==t,style:0===t?{paddingBottom:0}:{}}),items:e}})))),[Ae]),be=q?{menuType:M().gu.Modal,minWidth:void 0,title:(0,c.jsx)(f().sA,{id:"database.tableHeaderCell.title",defaultMessage:"Edit property"})}:{menuType:M().gu.Popup,minWidth:220};return(0,c.jsx)(o(928600).A,{...be,children:(0,c.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:void 0,sections:xe})})}));function D(e){const{collectionContextStore:t,environment:o,isAscending:n,property:r,schema:i}=e;if(!i[r])return;const a=[{property:r,direction:n?"ascending":"descending"}];t.filtersBarOpenStore.setState(!0),S().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:a}}}),(0,C().j)({collectionContextStore:t})}function R(e){var t;const{format:o,formatKey:n,property:r}=e;return null===(t=o[n])||void 0===t?void 0:t.find((e=>e.property===r))}function N(e){const{inputValue:t,property:o,schema:n}=e,r=Object.keys(n).find((e=>{var r;return e!==o&&(null===(r=n[e])||void 0===r?void 0:r.name)===t}));return Boolean(r)}},90907:(e,t,o)=>{o.d(t,{h:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.55 12.808a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"}),(0,n.jsx)("path",{d:"M10 1.95a4 4 0 0 0-4 4v1.433a2.426 2.426 0 0 0-2.025 2.392v5.4A2.425 2.425 0 0 0 6.4 17.6h7.2a2.425 2.425 0 0 0 2.425-2.425v-5.4A2.426 2.426 0 0 0 14 7.383V5.95a4 4 0 0 0-4-4m2.75 5.4h-5.5v-1.4a2.75 2.75 0 0 1 5.5 0zM5.225 9.775c0-.649.526-1.175 1.175-1.175h7.2c.649 0 1.175.526 1.175 1.175v5.4c0 .649-.526 1.175-1.175 1.175H6.4a1.175 1.175 0 0 1-1.175-1.175z"})]})},i=(0,o(340498).wt)("lock",r)},112282:(e,t,o)=>{o.d(t,{s:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M9.791 2.41a.6.6 0 0 0-.233.148l-5.4 5.4a.625.625 0 0 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 0 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},r=(0,o(340498).wt)("arrowStraightUp",n)},116089:(e,t,o)=>{o.d(t,{x:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M10.55 3a.55.55 0 0 0-1.1 0v2a.55.55 0 0 0 1.1 0zM8.47 8.47a.75.75 0 0 1 1.06 0l.897.896-1.06 1.06-.897-.896a.75.75 0 0 1 0-1.06m1.603 2.664 6.647 6.646a.75.75 0 1 0 1.06-1.06l-6.646-6.647zM10.55 15a.55.55 0 0 0-1.1 0v2a.55.55 0 0 0 1.1 0zm-3.697-1.853a.55.55 0 0 1 0 .777L5.44 15.34a.55.55 0 1 1-.778-.778l1.415-1.415a.55.55 0 0 1 .777 0m8.485-8.486a.55.55 0 0 1 0 .778l-1.415 1.414a.55.55 0 1 1-.777-.777L14.56 4.66a.55.55 0 0 1 .777 0M5.55 10a.55.55 0 0 1-.55.55H3a.55.55 0 1 1 0-1.1h2a.55.55 0 0 1 .55.55m12 0a.55.55 0 0 1-.55.55h-2a.55.55 0 1 1 0-1.1h2a.55.55 0 0 1 .55.55M6.853 6.853a.55.55 0 0 1-.778 0L4.661 5.44a.55.55 0 1 1 .778-.778l1.414 1.415a.55.55 0 0 1 0 .777"})},r=(0,o(340498).wt)("magicWand",n)},179070:(e,t,o)=>{o.r(t),o.d(t,{autofillPropertyForBlocks:()=>G,autofillPropertyForCollection:()=>X,fillAllPagesMessages:()=>H,getDefaultAiInference:()=>Z,getPropertyCompletionForBlock:()=>Q,saveOrRemovePropertyAiInference:()=>J,submitFeedbackForAiAutofill:()=>Y,triggerAiAutofillUpsell:()=>q});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(803949),o(581454);var n=o(296540),r=()=>o(221844),i=()=>o(970013),a=()=>o(713998),l=()=>o(206267),s=()=>o(134025),c=()=>o(441738),p=()=>o(959013),d=()=>o(532659),u=()=>o(534177),m=()=>o(937075),f=()=>o(299709),y=()=>o(449506),g=()=>o(884107),h=()=>o(583289),S=()=>o(901389),v=()=>o(896628),A=()=>o(436572),x=()=>o(606952),b=()=>o(317909),C=()=>o(831566),I=()=>o(289190),_=()=>o(364280),w=()=>o(104012),k=o(474848);const j=function(e){let{environment:t,inferenceIds:r,aiInference:i}=e;const a=(0,o(56366).K8)((()=>{const{state:e}=I().m;return"uninitialized"===e.type?null:{numBlocksToAutofill:e.numBlocksToAutofill,numBlocksAutofilled:e.numBlocksAutofilled,propertySchema:e.propertySchema,collectionId:e.collectionId,sessionId:e.sessionId,haveAllBlocksCompletedAutofill:e.haveAllBlocksCompletedAutofill}}),[]),l=(0,n.useCallback)((()=>{a&&(r.forEach((e=>{m().oe(t,{ai_inference_type:i.type,type:"undo_from_snackbar",inference_id:e,collection_id:a.collectionId,session_id:a.sessionId})})),o(495262).tN({environment:t,preventSelectText:!0}),A().N2(),I().m.setState({type:"filling",...a,didInterruptStreaming:!0}))}),[a,t,i,r]);if(!a)return null;const{numBlocksToAutofill:s,numBlocksAutofilled:c,propertySchema:{name:d}}=a;return c===s?(0,k.jsxs)(_().fI,{gap:4,alignItems:"center",children:[(0,o(413267).b)({width:16}),(0,k.jsx)(p().sA,{defaultMessage:'AI updated "{propertyName}" on {numPages, plural, one {1 page} other {# pages}}',id:"snackbar.aiAutofill.autofillInProgress",values:{propertyName:d,numPages:s}}),(0,k.jsx)(w().Ag,{onClick:l,children:(0,k.jsx)(p().sA,{defaultMessage:"Undo",id:"snackbar.aiAutofill.undo"})}),(0,k.jsx)(w().Ag,{onClick:()=>{A().N2()},children:(0,k.jsx)(p().sA,{defaultMessage:"Close",id:"snackbar.aiAutofill.close"})})]}):(0,k.jsxs)(_().fI,{gap:4,alignItems:"center",children:[(0,k.jsx)(o(331542).A,{}),0===c?(0,k.jsx)(p().sA,{defaultMessage:'AI updating "{propertyName}" on {numPages, plural, one {1 page} other {# pages}}',id:"snackbar.aiAutofill.autofillStarting",values:{propertyName:d,numPages:s}}):(0,k.jsx)(p().sA,{defaultMessage:'AI updated "{propertyName}" on {numFilledPages} of {numTotalPages} pages',id:"snackbar.aiAutofill.completedAutofill",values:{propertyName:d,numFilledPages:c,numTotalPages:s}}),(0,k.jsx)(w().Ag,{onClick:l,children:(0,k.jsx)(p().sA,{defaultMessage:"Stop & undo",id:"snackbar.aiAutofill.undoAndStop"})})]})};var P=()=>o(659602),T=()=>o(335722),M=()=>o(972435),F=()=>o(71304),O=()=>o(351360),B=()=>o(630116),D=()=>o(666429),R=()=>o(991249),N=()=>o(749240),W=()=>o(108184);const H=(0,p().YK)({fillAllPagesTooltip:{defaultMessage:"{hasNames, select, true {Autofill {propertyName} for all pages in {collectionName}} other {Autofill this property for all pages in the database}}",id:"aiAutofill.fillAllPages.buttonTooltip"},fillAllPagesAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"aiAutofill.fillAllPages.onlyWithAiAddOnMessageInTooltip"}});function z(e){const{environment:t,propertyId:o,propertySchema:n,storesWithCompletions:r,blockIdToInferenceId:i,useTemporaryStore:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:s,clipboardActions:c,doneStreaming:p,aiInferenceOverride:d}=e;b().createAndCommit({userAction:"BlockPropertyValue.handleActionButtonClick.aiAutofill",environment:t,canUndo:!Boolean(a),undoCheckpoint:!0,perform:e=>{E({environment:t,propertyId:o,propertySchema:n,storesWithCompletions:r,blockIdToInferenceId:i,useTemporaryStore:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:s,clipboardActions:c,doneStreaming:p,aiInferenceOverride:d,transaction:e})}})}function E(e){var t;const{environment:o,propertyId:n,propertySchema:r,storesWithCompletions:l,blockIdToInferenceId:s,useTemporaryStore:c,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:d,clipboardActions:m,doneStreaming:f,aiInferenceOverride:y,transaction:g}=e;for(const{store:h,temporaryStore:S,completion:A}of l){const e=c?S:h;let l;switch(r.type){case"text":l=m.getInlineTitleValueFromClipboardTextHtml({text:A.trim(),stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:d});break;case"multi_select":case"select":const e=c?null===(t=h.getAssociatedCollectionStore())||void 0===t?void 0:t.clone(S.inMemoryRecordCache):h.getAssociatedCollectionStore(),o=y??r.select_ai_inference;let s=A.trim().split(",").map((e=>e.trim()));if(f||(s=s.slice(0,-1)),e&&null!=o&&o.add_options){const t=(0,i().nP)({newTokenValues:s.length>0&&"select"===r.type?[[s[0]]]:[s],property:n,propertySchema:r,collectionId:e.id});if(t)for(const o of t)b().applyOperation({store:e,operation:o,transaction:g})}null!=o&&o.add_options||(s=s.filter((e=>{var t;return null===(t=r.options)||void 0===t?void 0:t.find((t=>t.value===e))}))),l=(0,a().rK)(s);break;default:(0,u().HB)(r)}x().KY({environment:o,store:e.getPropertyStore(n),value:l,transaction:g});const C=e.getFormat().ai_property_inference_map??{},I=s[h.id]??"";v().zA({stores:[e],update:{ai_property_inference_map:{...C,[n]:{inference_id:I,created_time:Date.now()}}},transaction:g})}}const V=(0,p().YK)({FAILED_TO_AUTOFILL:{defaultMessage:"Something went wrong. Please try again later",id:"propertyCompletionActions.error.unableToAutofill"},INVALID_PROPERTY_FOR_AUTOFILL:{defaultMessage:"Invalid property configuration for AI autofill",id:"propertyCompletionActions.error.invalidPropertyForAutofill"},NO_BLOCKS_TO_AUTOFILL:{defaultMessage:"Nothing to update with AI",id:"propertyCompletionActions.error.noBlocksToAutofill"}}),L=(0,p().YK)({featureUnavailable:{id:"completionActions.featureNotEnabledError",defaultMessage:"This feature is not currently enabled"}});function U(e){let{autofillPropertyResult:t}=e;const o=M().A.formatMessage(V[t]);A().N2(),S().c1(o)}const K={ai_limit_property_autofill:(0,k.jsx)(p().sA,{defaultMessage:"This workspace has used all of its free AI responses. Contact your workspace owner to add Notion AI.",id:"aiAutofill.outOfAiUpsellDialogMessage"}),ai_autofill_on_page_edit:(0,k.jsx)(p().sA,{defaultMessage:"Auto-update requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.autoUpdateOnPageEditUpsellDialogMessage"}),ai_autofill_fill_all_pages:(0,k.jsx)(p().sA,{defaultMessage:"Updating all pages requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.fillAllPagesUpsellDialogMessage"}),ai_autofill_bulk_fill:(0,k.jsx)(p().sA,{defaultMessage:"Filling more pages at once requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.bulkFillUpsellDialogMessage"})};function q(e){var t;let{environment:o,from:n}=e;null!==(t=O().default.state.currentSpaceStore)&&void 0!==t&&t.canAdmin()||S().c1(K[n]),R().K(o,{from:n,upsell:{type:"product",product:"ai",limit:{type:"none"}}})}function $(e){let{errorCode:t,environment:o}=e;return 405===t?A().D6({label:M().A.formatMessage(L.featureUnavailable)}):(402===t&&(A().N2(),q({environment:o,from:"ai_limit_property_autofill"})),W().showCompletionErrorWithCode(t))}async function G(e){var t;let{environment:o,stores:n,property:a,propertySchema:s,userEventForAnalytics:c,sessionIdForAnalytics:p,collectionContextStore:h,from:S,isBulkAction:v,aiInferenceOverride:x,transaction:b}=e;const C=p||l().JW(),_=a,w=n.map((e=>({spaceId:e.getSpaceId(),...e.pointer,propertyId:_,inferenceId:l().JW()}))),M=n[0].getAssociatedCollectionId()??(null===(t=n[0].getCollectionStore())||void 0===t?void 0:t.id),F=new(r().A)({name:"propertyCompletionActions.autofillPropertyForBlocks"});if(I().m.setIsWriting({stores:n,propertySchema:s,sessionIdForAnalytics:p}),"uninitialized"!==I().m.state.type&&(0,i().$M)(s)&&M){A().D6({label:(0,k.jsx)(j,{environment:o,inferenceIds:w.map((e=>e.inferenceId)),aiInference:(0,i().om)(s)}),durationMs:D().LX});try{var B;if(o.defaultRecordCache.inMemoryRecordCache.addCacheOverride(F),!(0,u().EI)(w))return U({autofillPropertyResult:"NO_BLOCKS_TO_AUTOFILL"});const e=x||(0,i().om)(s);if(!e)return U({autofillPropertyResult:"INVALID_PROPERTY_FOR_AUTOFILL"});w.forEach((t=>{m().oe(o,{type:c,inference_id:t.inferenceId,ai_inference_type:e.type,collection_id:M,session_id:C})})),null!==(B=O().default.state.currentSpaceStore)&&void 0!==B&&B.id&&y().callApi({eventName:"publishAiSession",environment:o,data:{inference_type:"autofill",id:C,spaceId:O().default.state.currentSpaceStore.id,metadata:{blockPropertyPointers:w,aiInference:e,collection_id:M}}});const t=await y().callStreamApi({eventName:"getCompletionForProperty",environment:o,data:{blockPropertyPointers:w,aiInference:e,aiSessionId:C,model:"default"}});if("success"!==t.type)return U({autofillPropertyResult:"FAILED_TO_AUTOFILL"});h&&(0,f().E)({block_id:n[0].pointer.id,property:_,property_type:s.type,from:S,environment:o,collectionContextStore:h,isFromBulkActionsToolbar:v});const r=Object.fromEntries(n.map((e=>[e.pointer.id,{store:e,temporaryStore:e.clone(F),completion:""}]))),a=Object.fromEntries(w.map((e=>[e.id,e.inferenceId]))),l=new Set,[p,A,k]=await Promise.all([P().g.load(),T().S.load(),g().R.clipboardActions.load()]);if(d().hS.is(t.data)){for await(const e of t.data){if("error"===e.type)return I().m.setState({...I().m.state,didInterruptStreaming:!0}),$({errorCode:e.errorCode,environment:o});if(I().m.state.didInterruptStreaming)return;const t=r[e.blockPropertyPointer.id],n=t.completion+e.completion;r[e.blockPropertyPointer.id]={...t,completion:n},l.add(e.blockPropertyPointer.id),b?E({environment:o,propertyId:_,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:a,useTemporaryStore:!0,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:A,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x,transaction:b}):z({environment:o,propertyId:_,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:a,useTemporaryStore:!0,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:A,clipboardActions:k,aiInferenceOverride:x}),I().m.setState({...I().m.state,numBlocksAutofilled:l.size})}I().m.setState({...I().m.state,haveAllBlocksCompletedAutofill:!0})}o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(F),b?E({environment:o,propertyId:_,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:a,useTemporaryStore:!1,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:A,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x,transaction:b}):z({environment:o,propertyId:_,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:a,useTemporaryStore:!1,markdownLinkifyIt:p,tinyMceMicrosoftWordPasteFilter:A,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x})}finally{o.defaultRecordCache.inMemoryRecordCache.hasCacheOverride(F)&&o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(F)}}}function Y(e){const{environment:t,inferenceId:o,feedbackType:n,userContent:r,shareWithNotion:i}=e;m().I5(t,{type:"property_autofill",inference_id:o,feedback_type:n,timestamp:(new Date).toUTCString(),user_comment:r,share_with_notion:i})}async function X(e){var t;let{environment:o,collectionStore:n,propertySchema:r,property:a,sessionIdForAnalytics:p}=e;if(!(0,i().$M)(r))return;const d=(0,i().om)(r);if(!n||!r||!d)return;const u=(null===(t=N().subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[];if(!(0,c().GI)(u))return void q({environment:o,from:"ai_autofill_fill_all_pages"});const f=M().A.getIntl(),y=(0,F().tS)({environment:o,intl:f,store:n});if(!(await h().U({sourceAction:"fill_all_pages",propertyName:r.name,collectionName:y})))return;m().oe(o,{type:"generate_from_fill_all_pages",inference_id:l().JW(),ai_inference_type:d.type,collection_id:n.id,session_id:p??l().JW()});const g=[];g.push(s().op.update({pointer:n.pointer,path:["format","update_ai_inferences_status"],args:{[a]:{type:"requested",created_time:Date.now()}}})),(0,C().p)({environment:o,collectionStore:n,performTransaction:e=>{for(const t of g)b().applyOperation({store:(0,B().Oo)(n,t.pointer),operation:t,transaction:e})}})}function J(e){const{environment:t,propertySchema:o,collectionStore:n,property:r,draftAiInference:a}=e;let l="";switch(o.type){case"text":l="ai_inference";break;case"select":case"multi_select":l="select_ai_inference";break;default:return}const s=[];if(s.push({pointer:n.pointer,command:"set",path:["schema",r,l],args:a}),a)m().Nj(t,{type:"set_ai_inference",ai_inference_type:a.type,collection_id:n.id});else{const e=(0,i().om)(o);m().Nj(t,{type:"remove_ai_inference",ai_inference_type:null==e?void 0:e.type,collection_id:n.id})}(0,C().p)({environment:t,collectionStore:n,performTransaction:e=>{for(const t of s)b().applyOperation({store:(0,B().Oo)(n,t.pointer),operation:t,transaction:e})}})}async function Q(e){var t;let{environment:o,store:n,property:r,propertySchema:i,userEventForAnalytics:a,sessionIdForAnalytics:s}=e;const c=s||l().JW(),p=r,u={spaceId:n.getSpaceId(),...n.pointer,propertyId:p,inferenceId:l().JW()},f=n.getAssociatedCollectionId()??(null===(t=n.getCollectionStore())||void 0===t?void 0:t.id),g=Z(i,!1);if(!g)return"";m().oe(o,{type:a,inference_id:u.inferenceId,ai_inference_type:g.type,collection_id:f,session_id:c});const h=l().JW();y().callApi({eventName:"publishAiSession",environment:o,data:{inference_type:"autofill",id:h,metadata:{blockPropertyPointers:[u],aiInference:g,collection_id:f}}});const S=await y().callStreamApi({eventName:"getCompletionForProperty",environment:o,data:{blockPropertyPointers:[u],aiInference:g,aiSessionId:h,model:"default"}});if("success"!==S.type)return"";let v="";if(d().hS.is(S.data))for await(const l of S.data)"error"!==l.type&&(v+=l.completion);return v}function Z(e,t){if(!(0,i().$M)(e))return;const o=(0,i().om)(e);return!o&&(0,i().lx)(e)?{type:e.type,auto_update_on_edit:t,add_options:!1}:o}},290966:(e,t,o)=>{o.d(t,{E_:()=>P,HQ:()=>F,I5:()=>T,ZQ:()=>j});o(16280),o(898992),o(823215),o(354520),o(581454),o(296540);var n=()=>o(662303),r=()=>o(428045),i=()=>o(134025),a=()=>o(912720),l=()=>o(179034),s=()=>o(519831),c=()=>o(869558),p=()=>o(144081),d=()=>o(921515),u=()=>o(959013),m=()=>o(496603),f=()=>o(534177),y=()=>o(284371),g=()=>o(966759),h=()=>o(235191),S=()=>o(901389),v=()=>o(317909),A=()=>o(67103),x=()=>o(16006),b=()=>o(972435),C=()=>o(470928),I=()=>o(630116),_=()=>o(913454),w=()=>o(204067),k=o(474848);function j(e){let{transaction:t,collectionStore:o,templateId:n,instance:r,logger:u}=e;u.debug(`Creating/updating ${d().rM} record for "${n}".`);const m=o.getSpaceId(),y=r.id;if("automation"===r.type){const e={table:a().yB,id:y,spaceId:m};v().applyOperation({store:I().dn.createChildStore(o,e),operation:i().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("block"===r.type){const e={table:l().ev,id:y,spaceId:m};v().applyOperation({store:I().Bv.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection"===r.type){const e={table:s().Vl,id:y,spaceId:m};v().applyOperation({store:o,operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection_view"===r.type){const e={table:c().Gy,id:y,spaceId:m};v().applyOperation({store:I().pS.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("layout"===r.type){const e={table:p().zx,id:y,spaceId:m};v().applyOperation({store:I().K_.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("compound"===r.type){if(r.instancePointers.length<2)throw new Error(`Compound template instance ${r.id} must contain 2 or more instances`);const e=r.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,f().HB)(e)}));v().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:n,id:r.id,instance_pointers:e}}},transaction:t})}else"property"===r.type?v().applyOperation({store:o,operation:i().op.update({pointer:o.pointer,path:["schema",r.id],args:{workflow_template_instance:{template_id:n}}}),transaction:t}):(0,f().HB)(r)}function P(e){let{environment:t,collectionStore:o,propertyId:n,compoundTemplateInstancesToDelete:i,collectionContextStore:a,from:l}=e;if(!i.every((e=>e.templateId===r().z$)))return!1;if(!(0,C().Io)())return!1;const s=(0,w().aL)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:i}),c=m().sb(s.filter((e=>"property"===e.type)).map((e=>e.id))),p=o.getSchema(),d=c.map((e=>{var t;if(e===n)return;const o=p[e];if(!o)throw new Error(`Property ${e} not found`);if(o.name)return o.name;const r=null===(t=o.workflow_template_instance)||void 0===t?void 0:t.template_id;if(!r)throw new Error(`Property ${e} has no workflow template id`);const i=_().globalWorkflowTemplates.fromId(r);return(0,_().getWorkflowTemplateName)(i)})).filter(f().O9);return M({environment:t,collectionStore:o,propertyIds:c,otherPropertyNames:d,collectionContextStore:a,from:l}),!0}function T(e){let{environment:t,collectionStore:o,propertyId:n,collectionContextStore:r,from:i}=e;const a=o.getSchema(),l=Object.keys(a).filter((e=>(0,C().Do)({collectionStore:o,propertyId:e})||(0,C().k$)(e))),s=l.map((e=>{var t;if(e===n)return;const r=null===(t=a[e])||void 0===t?void 0:t.name;if(r)return r;if((0,C().Do)({collectionStore:o,propertyId:e}))return b().A.formatMessage(A().Gl.verificationPropertyName);if((0,C().k$)(e))return b().A.formatMessage(A().Gl.ownerPropertyName);throw new Error(`Property ${e} must be a verification or owner property`)})).filter(f().O9);return M({environment:t,collectionStore:o,propertyIds:l,otherPropertyNames:s,collectionContextStore:r,from:i}),!0}function M(e){let{environment:t,collectionStore:o,propertyIds:r,otherPropertyNames:i,collectionContextStore:a,from:l}=e;const s=[{label:(0,k.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:r.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:n,propertyIds:r,from:i}=e;v().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const a=o.getSchema();for(const l of r){h().BJ({environment:t,collectionStore:o,schema:a,property:l,transaction:e});const r=a[l];r&&(0,g().i)({environment:t,collectionContextStore:n,property_type:r.type,from:i,property:l})}}})}({environment:t,collectionStore:o,collectionContextStore:a,propertyIds:r,from:l})}],c=new Intl.ListFormat(n().locale,{style:"long",type:"conjunction"}),p=(0,k.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"Delete this property from <bold>{databaseName}</bold>? {otherPropertyNames} will also be deleted",values:{bold:e=>(0,k.jsx)("span",{style:{fontWeight:y().Wy.bold},children:e}),databaseName:(0,k.jsx)(x().A,{style:{display:"inline",fontWeight:y().Wy.bold},shouldWrap:!0,store:o}),otherPropertyNames:c.format(i)}});S().ui({message:(0,k.jsx)("span",{children:p}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:s})}function F(e){const{environment:t,transaction:o,collectionStore:n,instance:r}=e;(0,w().aI)({environment:t,instancePointer:r,inMemoryRecordCache:n.inMemoryRecordCache})||v().applyOperation({store:n,operation:{pointer:n.pointer,command:"keyedObjectListRemove",path:["format","compound_workflow_template_instances"],args:{remove:{id:r.id}}},transaction:o})}},358354:(e,t,o)=>{o.d(t,{B:()=>c,I:()=>s});var n=()=>o(966759),r=()=>o(235191),i=()=>o(854593),a=()=>o(4319),l=()=>o(317909);async function s(e){let{theme:t,collectionContextStore:o,environment:n,property:r,from:a,schema:l,onDeleteCompleted:s,...p}=e;await i().q({environment:n,collectionContextStore:o,property:r,handleDeleteAccept:async()=>{await c({collectionContextStore:o,environment:n,property:r,schema:l,from:a,...p}),null==s||s()},theme:t,from:a})}async function c(e){const{collectionContextStore:t,environment:o,property:i,schema:s,from:c,...p}=e,d=t.collectionStore();if(!d)return;const u=d.getSchema()[i];await l().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await r().PF({environment:o,collectionStore:d,schema:s,property:i,transaction:e}),p.updateFrozenColumn&&a().sp({environment:o,collectionContextStore:t,currentIndex:p.columnIndex,entrypoint:p.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),u&&(0,n().i)({environment:o,collectionContextStore:t,property_type:u.type,from:c,property:i})}},388182:(e,t,o)=>{o.d(t,{A:()=>n});const n=o(757695).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},419167:(e,t,o)=>{o.d(t,{Ay:()=>b,GI:()=>A,Ve:()=>I,am:()=>x,jD:()=>C});var n=o(296540),r=()=>o(56366),i=()=>o(401497),a=()=>o(651124),l=()=>o(116089),s=()=>o(340498),c=()=>o(72135),p=()=>o(441738),d=()=>o(959013),u=()=>o(179070),m=()=>o(497222),f=()=>o(921855),y=()=>o(749240),g=()=>o(135221),h=()=>o(8980),S=()=>o(859428),v=o(474848);function A(e){let{collectionStore:t,propertySchema:o}=e;const n=(0,r().K8)((()=>(0,f().r4)(t.getName(),t)),[t]),i=(0,r().K8)((()=>{var e;const t=(null===(e=y().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,p().GI)(t)}),[]);return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,v.jsx)(d().sA,{...u().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(n)&&Boolean(o.name),collectionName:n,propertyName:o.name}})}),!i&&(0,v.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,v.jsx)(d().sA,{...u().fillAllPagesMessages.fillAllPagesAddOnMessage})})]})}function x(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;return t.isRunning?(0,v.jsx)("div",{style:n,children:(0,v.jsx)(g().A,{})}):(0,v.jsx)(h().I,{icon:l().x,color:"purplePrimary",style:o})}function b(e){let{updateAiInferencesTaskStatus:t,style:o}=e;const n=(0,d().tz)();return(0,v.jsx)("div",{style:o,children:t.isRunning?(0,v.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:void 0===t.numPagesFilled||void 0===t.numPagesRequested?(0,v.jsx)(d().sA,{defaultMessage:"Autofilling all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):(0,v.jsx)(d().sA,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,c().ZV)(t.numPagesFilled,"compact",n),numPagesRequested:(0,c().ZV)(t.numPagesRequested,"compact",n)}})}):(0,v.jsx)(d().sA,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})})}function C(e){let{updateAiInferencesTaskStatus:t}=e;const{numPagesFilled:o,numPagesRequested:n}={numPagesFilled:void 0,numPagesRequested:void 0,...t},r=(0,i().IS)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===o||void 0===n?null:(0,v.jsx)("div",{style:r.outer,role:"progressbar",children:(0,v.jsx)("div",{style:{...r.inner,width:100*Math.min(o/n,1)+"%"}})})}function I(e){const{environment:t,collectionContextStore:o,collectionStore:i,property:l,propertySchema:c,doesUserHaveAIAddOn:p,isAutofillSetupEnabled:d}=e,f=(0,r().K8)((()=>{const e=o.collectionStore();return e?(0,a().Ts)(e.getFormat(),l):{isRunning:!1,numPagesFilled:void 0,numPagesRequested:void 0}}),[o,l]),y=(0,n.useCallback)((async()=>{const e=o.collectionStore();e&&c&&await u().autofillPropertyForCollection({environment:t,collectionStore:e,propertySchema:c,property:l})}),[t,c,l,o]);return(0,v.jsx)(S().A,{disableTooltip:p,renderTooltip:()=>(0,v.jsx)(A,{collectionStore:i,propertySchema:c}),render:e=>(0,v.jsx)(m().A,{icon:e=>(0,v.jsx)(x,{updateAiInferencesTaskStatus:f,iconStyle:e,progressIconStyle:{width:s().Ev.sm,marginTop:4,marginLeft:4,marginRight:2}}),title:(0,v.jsx)(b,{updateAiInferencesTaskStatus:f}),caption:void 0!==f.numPagesFilled&&void 0!==f.numPagesRequested&&(0,v.jsx)(C,{updateAiInferencesTaskStatus:f}),focused:!1,onClick:y,disabled:f.isRunning||!d,...e})})}},437426:(e,t,o)=>{o.d(t,{$:()=>s});var n=o(296540),r=()=>o(56366),i=()=>o(895876),a=()=>o(8980),l=o(474848);const s=n.memo(n.forwardRef((function(e,t){let{collectionContextStore:s,property:c,iconTransformer:p=(e=>e),getTitleOverride:d,...u}=e;const{isMobile:m}=(0,o(484714).Y0)(),f=(0,r().K8)((()=>s.collectionStore()),[s]),y=(0,r().K8)((()=>null==f?void 0:f.getDatabaseType()),[f]),g=(0,r().K8)((()=>Boolean(f&&y&&o(313892).jP((0,o(617254).appConfigs)(),y,c,f))),[f,y,c]),h=(0,n.useCallback)((e=>(0,i().eF)(y,e)),[y]),S=(0,n.useCallback)((e=>(0,l.jsx)(o(760217).A,{...u,...e,disabled:g,disabledFeedback:g,title:(null==d?void 0:d({isRequiredProperty:g}))??(0,l.jsx)(o(959013).sA,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:m&&g?(0,i().eF)(y):null,icon:p(g?(0,l.jsx)("div",{...e,children:(0,l.jsx)(a().I,{icon:o(471095).i})}):(0,l.jsx)(a().I,{icon:o(236262).I})),isRedOnHover:!0})),[y,d,p,m,g,u]);return(0,l.jsx)(o(859428).A,{placement:o(962730).W.Left,disableTooltip:!g,renderTooltip:h,render:S})})))},471095:(e,t,o)=>{o.d(t,{i:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},r=(0,o(340498).wt)("lockFill",n)},525884:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8.65 8.25a.625.625 0 1 0 0 1.25h.725v3.25H8.65a.625.625 0 1 0 0 1.25h2.7a.625.625 0 1 0 0-1.25h-.725V8.875A.625.625 0 0 0 10 8.25zM10.7 6.3a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,o(340498).wt)("infoCircle",r)},539148:(e,t,o)=>{o.d(t,{S:()=>f});o(296540);var n=()=>o(484714),r=()=>o(401497),i=()=>o(734410),a=()=>o(959013),l=()=>o(704152),s=()=>o(859428),c=()=>o(673730),p=()=>o(554283),d=()=>o(962730),u=o(474848);const m=(0,a().YK)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function f(e){let{onClick:t,description:o,showTooltip:f,addDescriptionText:y,editDescriptionText:g,disabled:h}=e;const{isMobile:S}=(0,n().Y0)(),[v,A]=(0,p().B)(),x=(0,a().tz)(),b=(0,r().IS)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:S?24:20,marginLeft:4},info:{width:S?18:16,height:S?18:16,fill:A&&!h?e.regularIconColor:e.mediumIconColor}})),[A,S,h]);return(0,u.jsx)(s().A,{renderTooltip:e=>(0,u.jsx)("div",{...e,children:null!=o&&o.length?o:y??x.formatMessage(m.addDescriptionTooltip)}),disableTooltip:!f||h,style:c().Q$,placement:d().W.Top,render:e=>(0,u.jsx)(l().A,{...e,ref:v,onClick:t,"aria-label":null!=o&&o.length?y:g??x.formatMessage(m.editDescriptionTooltip),style:b.button,disabled:h,disabledFeedback:h,children:(0,i().q)(b.info)})})}},583289:(e,t,o)=>{o.d(t,{U:()=>r});var n=()=>o(388182);async function r(e){return new Promise((t=>{n().A.setState({open:!0,onClose:()=>{n().A.setState({open:!1}),t(!1)},onConfirm:()=>{n().A.setState({open:!1}),t(!0)},...e})}))}},653259:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(959013),r=()=>o(100622),i=()=>o(125565),a=o(474848);function l(e){return(0,a.jsx)(i().A,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:r().Ay.red,...e.styles},children:(0,a.jsx)(n().sA,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},655923:(e,t,o)=>{o.d(t,{v:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M10.625 3a.625.625 0 1 0-1.25 0v12.491l-4.333-4.333a.625.625 0 1 0-.884.884l5.4 5.4a.62.62 0 0 0 .884 0l5.4-5.4a.625.625 0 0 0-.884-.884l-4.333 4.333z"})},r=(0,o(340498).wt)("arrowStraightDown",n)},673964:(e,t,o)=>{o.d(t,{j:()=>i});var n=()=>o(953418),r=()=>o(129522);function i(e){const{collectionContextStore:t}=e,o=t.collectionViewBlockStore();if(o){const e=r().K.findCollectionViewBlockFromStore(o);if(e){const t=e.getNode();t&&(0,n().vq)(t,{edgeDist:0,animate:!1})}}}},705602:(e,t,o)=>{o.d(t,{s:()=>d,y:()=>m});var n=o(296540),r=()=>o(484714),i=()=>o(401497),a=()=>o(959013),l=()=>o(419357),s=()=>o(89924),c=()=>o(673730),p=o(474848);const d=(0,a().YK)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),u=60;function m(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:m}=e;const[f,y]=(0,n.useState)(t??""),g=(0,n.useRef)(f),{isMobile:h}=(0,r().Y0)(),S=(0,a().tz)(),v=(0,i().IS)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},descriptionInput:{lineHeight:"20px",fontSize:h?14:13}})),[h]),A=(0,n.useCallback)((()=>o(g.current)),[o]);(0,n.useEffect)((()=>()=>A()),[A]);const x=(0,n.useMemo)((()=>(0,p.jsx)(l().Ay,{value:f,onChange:e=>{y(e.target.value),g.current=e.target.value},onBlur:A,onSubmit:A,placeholder:S.formatMessage(d.addDescription),focusInitial:!0,disabled:!1,inputOuterStyle:v.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c().fy,autosize:!0,autosizeMaxHeight:u,showClearButton:!1})),[f,S,A,v.descriptionInput]);return h&&!m?(0,p.jsx)(s().A,{topBorder:!0,isInput:!0,title:(0,p.jsx)("span",{style:v.title,children:S.formatMessage(d.descriptionHeader)}),children:x}):x}},755735:(e,t,o)=>{o.d(t,{B:()=>p});var n=o(296540),r=()=>o(56366),i=()=>o(383594),a=()=>o(419357),l=()=>o(486666),s=o(474848);const c=o(757695).default.createClass("",{name:"InputStore"}),p=n.forwardRef((function(e,t){const{placeholder:p,focusInitial:d,selectAll:u,disabled:m,inputOuterStyle:f,iconButton:y,inputRightButton:g,initialValue:h,onBlur:S,onSubmit:v,onChange:A,maxLength:x,textWrapperStyle:b,textarea:C}=e,I=(0,o(484714).v3)(),[_,w]=(0,n.useState)(h||""),k=(0,r().uB)(e.inputStore,c),j=(0,r().O$)(k)||_,P=(0,n.useCallback)((()=>{S(j)}),[j,S]),T=(0,n.useCallback)((()=>{v(j)}),[j,v]),M=(0,n.useCallback)((e=>{const t=e.target.value;w(t),k&&k.setState(t),A&&A(t)}),[k,A]),F=(0,o(336811).O)();return(0,n.useEffect)((()=>{e.inputStore&&k.setState(h)}),[]),(0,n.useEffect)((()=>()=>{F.current&&h!==j&&S(j)}),[h,j,F,S]),(0,s.jsx)(a().Ay,{ref:t,focusInitial:d,selectAll:u,value:j,onChange:M,onBlur:P,onSubmit:T,placeholder:p,disabled:m,textWrapperStyle:{opacity:m?.4:void 0,...b},maxlength:x,inputOuterStyle:f,left:y&&(0,s.jsx)(a().KF,{icon:y.icon,iconStyle:y.iconStyle,onClick:e=>function(e,t,n){if(!(n&&e.target instanceof Element))return;const r=o(972435).A.getIntl(),{onSubmit:a,enforceIconColor:s,includeEmojiTab:c}=n;i().W(t,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:l().GF,popupWidth:l().jv,showArrow:!0,title:r.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:c?[{type:"emoji",onChange:(e,t)=>{a(e),t&&t.keepVisible||i().I()}},{type:"icon",enforceIconColor:s,onChange:(e,t)=>{a(e),t&&t.keepVisible||i().I()}}]:[{type:"icon",enforceIconColor:s,onChange:(e,t)=>{a(e),t&&t.keepVisible||i().I()}}],onDelete:()=>{a(),i().I()}})}(e,I,y),disabled:m,style:{opacity:m?.4:void 0},backgroundColor:y.backgroundColor}),showClearButton:!1,inputRight:g,textarea:C,style:{paddingLeft:6}})}))},854593:(e,t,o)=>{o.d(t,{q:()=>y});o(944114),o(296540);var n=()=>o(959013),r=()=>o(284371),i=()=>o(521358),a=()=>o(16006),l=()=>o(685889),s=()=>o(470928),c=()=>o(290966),p=()=>o(204067),d=()=>o(27732),u=()=>o(901389),m=()=>o(317909),f=o(474848);async function y(e){const{environment:t,collectionContextStore:o,property:y,handleDeleteAccept:g}=e,h=o.collectionStore();if(!h)return;if(h.isTypedProperty(y)){if(await i().nD({environment:t,property:y,collectionContextStore:o,theme:e.theme,from:e.from}))return}const S=(0,p().R5)({environment:t,collectionStore:h,propertyId:y});if(S.length>0){if((0,c().E_)({environment:t,collectionStore:h,propertyId:y,compoundTemplateInstancesToDelete:S,collectionContextStore:o,from:e.from}))return}else if(((0,s().k$)(y)||(0,s().Do)({collectionStore:h,propertyId:y}))&&(0,s().aF)(h)&&(0,s().Io)()){if((0,c().I5)({environment:t,collectionStore:h,propertyId:y,collectionContextStore:o,from:e.from}))return}const v=o.normalizedSchemaStore.state,A=v[y],x=l().pg(o,A);await(null==x?void 0:x.load());const b=x&&l().D5(o,y,x),C=x&&l().uf(x),I=x&&h.id===x.id,_=[{label:(0,f.jsx)(n().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let w;if(b&&h&&C&&!I&&_.push({label:(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{m().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(A&&"relation"===A.type&&A.property&&x){const o=A.property,n=x.getSchema();d().C4({environment:t,collectionStore:x,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:h.isSyncedCollection()&&!x.isSyncedCollection()?{enabled:!1}:A.autoRelate,transaction:e})}d().t$({environment:t,collectionStore:h,property:y,transaction:e})}})}}),"auto_increment_id"===(null==A?void 0:A.type))w=l().me(v)?(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==A?void 0:A.type)){const e=l().AX(v);if(e){const t=e.connectedRelation.automation;t&&t[y]&&(w=(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else x&&C&&!I&&b&&(w=(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,f.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.medium},store:x})}}));u().ui({message:(0,f.jsx)("span",{children:(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,f.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.bold},shouldWrap:!0,store:h})}})}),description:w,showCancel:!0,keepFocus:!0,items:_,mode:"wide"})}}}]);