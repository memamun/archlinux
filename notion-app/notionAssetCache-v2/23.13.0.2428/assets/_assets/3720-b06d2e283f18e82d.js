"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[3720],{34423:(e,t,r)=>{r.d(t,{T:()=>y});var o=r(296540),a=()=>r(484714),n=()=>r(56366),i=()=>r(921598),s=()=>r(748054),l=()=>r(959013),u=()=>r(896628),c=()=>r(317909),d=()=>r(175116),p=()=>r(828973),g=r(474848);function y(e){let{groupBy:t}=e;const r=(0,a().v3)(),y=(0,d().ET)(),{viewType:m,startWeekOn:h}=(0,n().K8)((()=>{const e=y.normalizedFormatStore.state;return{viewType:y.getViewType(),startWeekOn:(null==e?void 0:e.start_week_on)??0}}),[y]),f=(0,o.useCallback)((e=>{c().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStartWeekOnChange",environment:r,canUndo:!0,perform:t=>{const r=y.collectionViewStore();r&&u().zA({stores:[r],update:{start_week_on:e},transaction:t})}})}),[r,y]);if(!(0,i().Ik)(t)&&"formula"!==t.type)return null;if((0,i().Ik)(t)&&"week"!==t.groupBy)return null;if("formula"===t.type){const e=t.groupBy;if(!(0,i().Ik)(e))return null;if("week"!==e.groupBy)return null}return(0,g.jsx)(p().A,{title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn",defaultMessage:"Start week on"}),popupStyle:{minWidth:190},selectedKey:h,onChange:f,icon:"chart"===m?s().M:void 0,options:[{key:0,type:"button",title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.sunday",defaultMessage:"Sunday"})},{key:1,type:"button",title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.monday",defaultMessage:"Monday"})}]})}},95441:(e,t,r)=>{r.d(t,{A:()=>a});r(296540);var o=r(474848);const a=function(e){const{title:t,href:a,analyticsFrom:n}=e,i=(0,r(484714).v3)();return(0,o.jsx)(r(187485).A,{href:a,onClick:()=>r(148024).FH(i,{from:n}),external:!0,children:(0,o.jsx)(r(497222).A,{icon:r(406533).T,title:t,isGray:!0})})}},100594:(e,t,r)=>{r.d(t,{CN:()=>M,D0:()=>S,D5:()=>K,GL:()=>m,I9:()=>y,JQ:()=>f,JW:()=>T,PC:()=>v,Rb:()=>B,SK:()=>w,UK:()=>j,VY:()=>c,YU:()=>C,Yp:()=>x,_x:()=>_,bg:()=>p,fn:()=>F,i8:()=>G,kq:()=>d,q_:()=>P,sh:()=>g,tG:()=>h,xS:()=>A,zn:()=>k});var o=()=>r(534177),a=()=>r(708685),n=()=>r(921598),i=()=>r(970013),s=()=>r(713998),l=()=>r(499755),u=()=>r(901610);const c=["gray","blue","yellow","green","purple","teal","orange","pink","red"],d=["auto","colorful"];let p=function(e){return e.small="small",e.medium="medium",e.large="large",e.extra_large="extra_large",e}({});function g(e){switch(e){case p.small:return 300;case p.medium:return 400;case p.large:return 600;case p.extra_large:return 800;default:(0,o().HB)(e)}}function y(e){switch(e){case p.small:return 150;case p.medium:return 250;case p.large:return 300;case p.extra_large:return 400;default:(0,o().HB)(e)}}let m=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),h=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),f=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),v=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({}),S=function(e){return e.none="none",e.value="value",e.name="name",e.name_and_value="name_and_value",e}({});function b(e){if(!e)return!1;return n().BI.includes(e)}function x(e){const t=(0,a().getFormulaPropertySchemaBaseResultType)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function C(e,t){var r,a;let i,u=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var c;const{chartFormat:r,chartGroupByFormat:o}=function(e,t,r,o){const a=(0,s()._g)({schema:o,property:e.property});if(a&&"donut"===r&&(0,l().e0)(a)){const r=(0,n().MP)(e);return{chartFormat:{...t,mainSort:l().S0.yDescending},chartGroupByFormat:r}}return{chartFormat:t,chartGroupByFormat:e}}(null==e||null===(c=e.dataConfig)||void 0===c?void 0:c.groupBy,null==e?void 0:e.chartFormat,"donut",t);u=r,i={...e.dataConfig,groupBy:o,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?(i=e.dataConfig,u={...u,mainSort:l().S0.yDescending}):(0,o().HB)(e.dataConfig);P(e)&&u&&(void 0===(null===(r=u)||void 0===r?void 0:r.donutDataLabels)||(null===(a=u)||void 0===a?void 0:a.donutDataLabels)===S.none)?u.donutDataLabels=S.value:!P(e)&&u&&(u.donutDataLabels=S.none);const d={...e,type:"donut",dataConfig:i};return u&&(d.chartFormat=u),d}function _(e,t){let r;"groups_reducer"===e.dataConfig.type?r={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o().HB)(e.dataConfig);const a=e.chartFormat;return a&&a.donutDataLabels&&a.donutDataLabels!==S.none?a.axisShowDataLabels=!0:!a||a.donutDataLabels!==S.none&&void 0!==a.donutDataLabels||(a.axisShowDataLabels=!1),{...e,type:t,dataConfig:r}}function w(e,t){let r;if("groups_reducer"===e.dataConfig.type){var a;const o=null==e||null===(a=e.dataConfig)||void 0===a?void 0:a.groupBy;r={...e.dataConfig,groupBy:o,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o().HB)(e.dataConfig);return{...e,type:t,dataConfig:r}}const B={main:l().S0.xAscending,stacked:l().S0.manual};function M(e){let{chartConfig:t,xAxisPropertyId:r,newDataConfigType:a,groupBy:n,aggregation:i,valueProperty:s}=e;const u="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.seriesFormat:t.dataConfig.valueSeriesFormat;"groups_reducer"===a?t.dataConfig={type:"groups_reducer",groupBy:n,aggregationConfig:{aggregation:i,seriesFormat:u,stackOptions:"groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===a?t.dataConfig={type:"results_reducer",nameProperty:r,valueProperty:s,valueSeriesFormat:u}:(0,o().HB)(a);const c="formula"===n.type?n.groupBy.sort:n.sort;return t.chartFormat={...t.chartFormat,mainSort:(0,l().gN)(c)},t}function A(e){let{property:t,propertySchema:r,groupByOption:o,hideEmptyGroups:i}=e;const s=r.type;if((0,n().Eg)(r)){if((0,n()._o)(s)){if(o&&b(o))return{type:s,property:t,groupBy:o,sort:{type:"ascending"}}}else{if((0,n().KI)(s)||"select"===s||"multi_select"===s)return{type:s,property:t,sort:{type:"ascending"}};if((0,n().iF)(s)){if(o&&((l=o)&&n().PC.includes(l)))return{type:s,property:t,groupBy:o,sort:{type:"ascending"}}}else{if("number"===s)return{type:s,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===s){const e=(0,a().getFormulaPropertySchemaResultType)(r);if("number"===e)return{type:"formula",property:t,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===e&&b(o))return{type:"formula",property:t,groupBy:{type:"date",groupBy:o,sort:{type:"ascending"}}}}else if("person"===s)return{type:s,property:t,sort:{type:"manual"}}}}var l;return(0,n().V0)({property:t,propertySchema:r,hideEmptyGroups:i})}}function T(e){const t="formula"===e.type?(0,a().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().AM)(e)||"number"===t}function k(e){const t="formula"===e.type?(0,a().getFormulaPropertySchemaResultType)(e):void 0;return(0,n()._o)(e.type)||"date"===t}function F(e){const t="formula"===e.type?(0,a().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().JY)(e)||"person"===t}function G(e){if("formula"===e.type){const t=(0,a().getFormulaPropertySchemaResultType)(e);return(0,n()._o)(t)}return(0,n()._o)(e.type)}function j(e){return"text"===e||"number"===e||"person"===e||"date"===e}function K(e){var t;return!(!e||!(0,u().m)(e))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function P(e){return!!K(e)&&(!(!e||!(0,u().m)(e))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(r=e.chartFormat)||void 0===r?void 0:r.axisShowDataLabels)));var t,r}},252051:(e,t,r)=>{r.d(t,{AI:()=>d,PB:()=>y,XC:()=>c,Yp:()=>a,Zz:()=>n,eq:()=>p,ev:()=>f,iq:()=>u,j2:()=>m,jQ:()=>g,jV:()=>o,kC:()=>h,o0:()=>i,p0:()=>s});const o=(0,r(959013).YK)({chart:{defaultMessage:"chart",id:"chartExport.chart"},exportChart:{defaultMessage:"Save chart as...",id:"chartExport.exportChart"},exportChartPreview:{defaultMessage:"Preview",id:"chartExport.exportChartPreview"},exportChartBackground:{defaultMessage:"Background",id:"chartExport.exportChartBackground"},copyPng:{defaultMessage:"Copy as PNG",id:"chartExport.copyAsPng"},downloadPng:{defaultMessage:"Download PNG",id:"chartExport.downloadPng"},downloadSvg:{defaultMessage:"Download SVG",id:"chartExport.downloadSVG"},madeWithNotion:{defaultMessage:"Made with Notion",id:"chartExport.madeWithNotion"}}),a=200,n=2,i=800,s=500,l=240,u=120,c=96,d=64,p=2*u,g=2*c,y=2*d;function m(e){let t={width:i,height:s};return"none"===e&&(t={width:i+p,height:s+g}),{chart:t,plotOptions:{pie:{size:l}}}}const h=20,f=8},282339:(e,t,r)=>{r.d(t,{QW:()=>m,dG:()=>g,ic:()=>y,lc:()=>p,xG:()=>h,ye:()=>d});r(517642),r(658004),r(733853),r(845876),r(432475),r(515024),r(731698);var o=()=>r(67657),a=()=>r(708685),n=()=>r(921598),i=()=>r(713998),s=()=>r(594013),l=()=>r(100594),u=()=>r(901610);const c=new Set(["groupBy_property_not_configured","groupBy_property_deleted","groupBy_property_not_groupable","groupBy_formula_not_groupable","aggregation_property_not_configured","aggregation_invalid","aggregation_deleted","stackBy_property_not_groupable","stackBy_formula_not_groupable","stackBy_property_deleted","name_property_not_configured","name_property_deleted","name_property_invalid","property_value_property_not_configured","property_value_property_deleted","property_value_property_invalid"]);function d(e){let{chartConfig:t,collectionSchema:r}=e;if(!t||"placeholder"===t.type)return"chart_config_not_found";if(void 0===t.dataConfig)return"data_model_invalid";if("groups_reducer"===t.dataConfig.type){const e=t.dataConfig.groupBy;if(!e)return"groupBy_property_not_configured";const s=(0,i()._g)({schema:r,property:e.property});if(!s)return"groupBy_property_deleted";const d=(0,n().Eg)(s);if("formula"===s.type&&!d)return"groupBy_formula_not_groupable";if(!d)return"groupBy_property_not_groupable";const p=t.dataConfig.aggregationConfig;if(!p)return"aggregation_property_not_configured";if("count"!==p.aggregation.aggregator){const e=p.aggregation.property,t=(0,i()._g)({schema:r,property:e});if(!t)return"aggregation_deleted";if((0,o().FM)(p.aggregation)&&t&&!(0,l().JW)(t))return"aggregation_invalid";if("formula"===(null==t?void 0:t.type)&&"unique"===p.aggregation.aggregator){const e=(0,a().getFormulaPropertySchemaResultType)(t);if(!(0,l().UK)(e))return"aggregation_invalid"}}if((0,u().m)(t)){var c;const e=null===(c=t.dataConfig.aggregationConfig.stackOptions)||void 0===c?void 0:c.groupBy.property;if(e){const t=(0,i()._g)({schema:r,property:e});if(!t)return"stackBy_property_deleted";const o=(0,n().Eg)(t);if("formula"===t.type&&!o)return"stackBy_formula_not_groupable";if(!o)return"stackBy_property_not_groupable"}}}else{if("results_reducer"!==t.dataConfig.type)return"data_model_invalid";{const e=t.dataConfig.nameProperty;if(!e)return"name_property_not_configured";const o=(0,i()._g)({schema:r,property:e});if(!o)return"name_property_deleted";if(!(0,s().tH)(o))return"name_property_invalid";const a=t.dataConfig.valueProperty;if(!a)return"property_value_property_not_configured";const n=(0,i()._g)({schema:r,property:a});if(!n)return"property_value_property_deleted";if(!(0,s().Iw)(n))return"property_value_property_invalid"}}}function p(e){return"groupBy_property_not_configured"===e||"groupBy_property_deleted"===e||"groupBy_property_not_groupable"===e||"groupBy_formula_not_groupable"===e||"name_property_not_configured"===e||"name_property_deleted"===e||"name_property_invalid"===e}function g(e){return"aggregation_property_not_configured"===e||"aggregation_deleted"===e||"aggregation_invalid"===e||"property_value_property_not_configured"===e||"property_value_property_deleted"===e||"property_value_property_invalid"===e}function y(e){return"stackBy_property_deleted"===e||"stackBy_property_not_groupable"===e||"stackBy_formula_not_groupable"===e||"stackBy_property_no_values"===e}function m(e){return c.has(e)}function h(e){return"stackBy_property_no_values"===e}},288739:(e,t,r)=>{r.d(t,{M:()=>a});r(296540);const o={viewBox:"0 0 16 16",svg:(0,r(474848).jsx)("path",{d:"m4.148 2.661-.23-.269a.55.55 0 1 0-.836.716L4.1 4.294C2.727 5.017 1.61 6.113.914 7.44a1.21 1.21 0 0 0 0 1.128c1.282 2.443 3.987 4.1 7.086 4.1a8.4 8.4 0 0 0 2.854-.493l1.228 1.433a.55.55 0 0 0 .84-.71L4.152 2.666zm1.227 5.34c0-.598.2-1.15.537-1.591l.963 1.123q-.092.218-.094.469a1.22 1.22 0 0 0 1.511 1.184l.963 1.123a2.626 2.626 0 0 1-3.88-2.307m7.475 3.122a7.4 7.4 0 0 0 2.236-2.556 1.21 1.21 0 0 0 0-1.128C13.804 4.997 11.099 3.34 8 3.34a8.5 8.5 0 0 0-1.68.166l1.605 1.87H8a2.626 2.626 0 0 1 2.582 3.101z"})},a=(0,r(340498).wt)("eyeSlashFillSmall",o)},322638:(e,t,r)=>{r.d(t,{FE:()=>P,FZ:()=>F,G_:()=>_,Iq:()=>V,Le:()=>M,QJ:()=>K,Qn:()=>z,RO:()=>B,TP:()=>A,TQ:()=>G,WG:()=>T,Zr:()=>C,Zv:()=>R,bg:()=>x,k1:()=>L,p7:()=>j,pP:()=>w,uB:()=>D,zH:()=>k});r(16280),r(944114);var o=()=>r(484714),a=()=>r(56366),n=()=>r(401497),i=()=>r(100594),s=()=>r(901610),l=()=>r(67657),u=()=>r(708685),c=()=>r(713998),d=()=>r(959013),p=()=>r(496603),g=()=>r(534177),y=()=>r(436696),m=()=>r(187899),h=()=>r(246826),f=()=>r(317909),v=()=>r(895876),S=()=>r(722372),b=()=>r(476492);const x=(0,d().YK)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateByValues:{defaultMessage:"Values",id:"database.viewSettings.mainTab.axisChart.aggregateByValues"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartYAxisRange:{defaultMessage:"Range",id:"database.viewSettings.mainTab.axisChart.yAxisRange"},chartYAxisRangeMenu:{defaultMessage:"Set custom range",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMenu"},chartYAxisRangeAuto:{defaultMessage:"Auto",id:"database.viewSettings.mainTab.axisChart.yAxisRangeAuto"},chartYAxisRangeCustom:{defaultMessage:"Custom",id:"database.viewSettings.mainTab.axisChart.yAxisRangeCustom"},chartYAxisRangeReset:{defaultMessage:"Reset",id:"database.viewSettings.mainTab.axisChart.yAxisRangeReset"},chartYAxisRangeMinPlaceholder:{defaultMessage:"Min",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMinPlaceholder"},chartYAxisRangeMaxPlaceholder:{defaultMessage:"Max",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMaxPlaceholder"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"},chartIncludeSubitems:{defaultMessage:"Include sub-items",id:"database.viewSettings.mainTab.charts.includeSubitems"}}),C=(0,d().YK)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartHeight:{defaultMessage:"Height",id:"database.viewSettings.chartStyleTab.chartHeight"},chartSmoothLine:{defaultMessage:"Smooth line",id:"database.viewSettings.chartStyleTab.chartSmoothLine"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartCaptionPlaceholder:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaptionPlaceholder"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"},chartValueLabelPlaceholder:{defaultMessage:"Value label",id:"database.viewSettings.chartStyleTab.chartValueLabelPlaceholder"}}),_=(0,d().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),w=(0,d().YK)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),B=(0,d().YK)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),M=(0,d().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),A=(0,d().YK)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),T=(0,d().YK)({small:{defaultMessage:"Small",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.extra_large"}}),k=(0,d().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.donutDataLabels.none"},value:{defaultMessage:"Value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.value"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.donutDataLabels.name"},name_and_value:{defaultMessage:"Name and value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.nameAndValue"}}),F=(0,d().YK)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}});function G(e){let{aggregation:t,databaseType:r,intl:o}=e;if((0,l().Iq)(t)&&r){const e=(0,p().ZH)((0,v().$O)(r));return o.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,l().Iq)(t))return o.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===t.aggregator)return o.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const e=(0,l().V1)(t);return S().SE[e]}}function j(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}function K(e,t,r,o,a,n){if("placeholder"===t.type||t.type===e)return;let l;if("donut"===e){if("donut"===t.type)return;(0,s().m)(t)?l=(0,i().YU)(t,n):(0,g().HB)(t)}else(0,s().I)(e)?(0,s().m)(t)?l=(0,i().SK)(t,e):"donut"===t.type?l=(0,i()._x)(t,e):(0,g().HB)(t):(0,g().HB)(e);f().createAndCommit({userAction:"chartSettings.setChartType",environment:r,canUndo:!0,perform:e=>{h().zv({store:o.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e})}}),(0,y().X)({environment:r,collectionContextStore:a,action:"charts_update_chart_type",charts_analytics_context:(0,b().nL)(a)})}function P(e){return{fill:e.accentColors.orange[400]}}function V(e){const t=e.type;if("formula"===t){const t=(0,u().getFormulaPropertySchemaResultType)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function D(e,t){const r=(0,a().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,a().K8)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.groupBy.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.nameProperty),e&&t)return(0,c()._g)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function R(e,t){const r=(0,a().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,a().K8)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.aggregationConfig.aggregation.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.valueProperty),e)return(0,c()._g)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function z(e){let{environment:t,collectionContextStore:r,chartConfig:o,sort:a}=e;const n=[];"results_reducer"===o.dataConfig.type&&("x-ascending"===a?n.push({property:o.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===a&&n.push({property:o.dataConfig.nameProperty,direction:"descending"})),m().IU({environment:t,collectionContextStore:r,temporaryState:{...r.temporaryStateStore.state,sorts:{value:n}}})}function L(){const e=250,t=(0,o().Y0)();return(0,n().IS)((()=>({whatToShowRightText:{maxWidth:t.isMobile?e:125},sortByRightText:{maxWidth:t.isMobile?e:163},groupByRightText:{maxWidth:t.isMobile?e:151},donutSliceRightText:{maxWidth:t.isMobile?e:124},donutSliceValueRightText:{maxWidth:t.isMobile?e:95},avatarStyle:{maxWidth:t.isMobile?e:110},donutDataLabelsRightText:{maxWidth:t.isMobile?e:90}})),[t.isMobile])}},352377:(e,t,r)=>{r.d(t,{L:()=>S});r(581454);var o=r(296540),a=()=>r(484714),n=()=>r(56366),i=()=>r(452706),s=()=>r(851979),l=()=>r(987555),u=()=>r(959013),c=()=>r(939466),d=()=>r(285790),p=()=>r(678553),g=()=>r(89924),y=()=>r(859428),m=()=>r(10594),h=()=>r(553965),f=r(474848);function v(e){const t=(0,a().Y0)(),o=(0,r(401497).IS)((r=>{let o,a=t.isMobile?r.popoverBackground:r.surface.wash;return"yellow"===e.color&&(a=r.fill.yellowSecondary,o=r.text.uiYellowPrimary),{container:{display:"flex",width:"100%",position:"relative",borderRadius:6,padding:t.isPhone?16:12,backgroundColor:a},icon:{width:14,height:14,marginTop:2},messageContainer:{display:"flex",flexDirection:"column",fontSize:t.isPhone?14:12},title:{fontWeight:500,color:e.color?o:void 0},caption:{color:e.color?o:r.text.secondary}}}),[t,e.color]);return(0,f.jsx)(g().A,{topBorder:!0,shouldShowBottomDivider:t.isMobile,style:{padding:12},children:(0,f.jsxs)("div",{style:o.container,children:[e.icon&&(0,f.jsxs)(f.Fragment,{children:[!t.isPhone&&e.icon(o.icon),(0,f.jsx)(r(132389).A,{size:8})]}),(0,f.jsxs)("div",{style:o.messageContainer,children:[(0,f.jsx)("div",{style:o.title,children:e.title}),(0,f.jsx)("div",{style:o.caption,children:e.caption})]})]})})}const S=o.memo((function(e){let{groupBy:t,groupByKey:s,groupsFormatKey:l,collectionContextStore:c,groupsDisplayState:d,disableReorder:y}=e;const h=(0,a().v3)(),S=(0,n().O$)(c.normalizedSchemaStore),x=(0,n().O$)(c.normalizedFormatStore),C=(0,n().O$)(c.permissionScopesStore).canConfigureBlock,_=(0,n().K8)((()=>(0,m().Z3)({disableReorder:Boolean(y),groupByKey:s,format:x,canConfigureBlock:C,isMobile:h.device.isMobile})),[y,h.device.isMobile,s,C,x]),w=(0,n().K8)((()=>!(!d||"v2"!==d.version)&&(d.currentGroups.length>i().O3&&d.hasMore)),[d]),B=(0,o.useCallback)((()=>{if(!C)return;const e=(null==d?void 0:d.currentGroups.map((e=>({...e,hidden:!0}))))??[];c.groupsLimitStore.setState(m()._9),r(317909).createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:h,canUndo:!0,perform:t=>{(0,r(916260).o)({collectionContextStore:c,newGroups:e,groupsFormatKey:l,transaction:t})}}),(0,r(436696).X)({environment:h,collectionContextStore:c,action:"click_groups_hide_all"})}),[c,C,h,d,l]),M={topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,title:(0,f.jsx)(u().sA,{...m().K0.groups}),desktopTitleStyle:{paddingTop:4,marginBottom:8}};if(!d||"v2"!==d.version)return(0,f.jsx)(g().A,{...M,children:(0,f.jsx)(r(331542).A,{style:{alignSelf:"center",marginBottom:12}})});if(0===d.currentGroups.length)return(0,f.jsx)(g().A,{...M,children:(0,f.jsx)(p().A,{title:(0,f.jsx)(u().sA,{...m().K0.noGroups})})});const A=d.currentGroups.map((e=>(0,r(921598).Ix)(e)));return(0,f.jsxs)(f.Fragment,{children:[w&&(0,f.jsx)(v,{title:(0,f.jsx)(u().sA,{...m().K0.groupLimitReachedTitle}),caption:(0,f.jsx)(u().sA,{...m().K0.groupLimitReachedCaption}),color:"yellow"}),(0,f.jsx)(g().A,{topBorder:!w,title:(0,f.jsx)(u().sA,{...m().K0.groups}),desktopStyle:w?{position:"relative",top:-12}:void 0,right:(0,f.jsx)(r(493823).p,{size:"sm",shouldShrink:!0,isBlue:!0,disabled:!C,onClick:B,style:{fontSize:12},children:(0,f.jsx)(u().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:(0,f.jsx)(r(2143).H,{type:r(756279).A.Y,style:{maxHeight:400},children:(0,f.jsx)(r(439264).Ay,{direction:"vertical",keys:A,disabled:!_,renderKey:(e,r)=>{const o=d.currentGroups[r];return(0,f.jsx)(b,{collectionContextStore:c,schema:S,groupsDisplayState:d,groupBy:t,groupFormat:o,groupsFormatKey:l,canReorder:_})},onDrop:e=>{d&&(0,r(607517).V)({environment:h,collectionContextStore:c,groupsFormatKey:l,groupByKey:s,currentGroups:d.currentGroups,newGroupIds:e})}})})})]})}),r(821062).A);function b(e){const{collectionContextStore:t,schema:g,groupsDisplayState:v,groupBy:S,groupFormat:b,groupsFormatKey:x,canReorder:C}=e,_=(0,a().v3)(),w=(0,a().Y0)(),B=(0,u().tz)(),[M,A]=(0,o.useState)(!1),[T,k]=(0,o.useState)(!1),F=(0,n().O$)(t.permissionScopesStore).canConfigureBlock,G=(0,o.useCallback)((()=>{(0,c().m)({environment:_,collectionContextStore:t,currentGroups:v.currentGroups,groupsFormatKey:x,groupFormat:b,action:"toggle_group_pin"})}),[x,_,t,v.currentGroups,b]),j=(0,o.useCallback)((()=>{(0,c().m)({environment:_,collectionContextStore:t,currentGroups:v.currentGroups,groupsFormatKey:x,groupFormat:b,action:"toggle_group_visibility"})}),[_,t,v.currentGroups,x,b]),K=(0,o.useCallback)((()=>{k(!0)}),[]),P=(0,o.useCallback)((()=>{k(!1)}),[]),V=(0,o.useCallback)((()=>{A(!0)}),[]),D=(0,o.useCallback)((()=>{A(!1)}),[]),R={onMouseEnter:K,onMouseLeave:P},z={onMouseEnter:V,onMouseLeave:D},L=(0,o.useMemo)((()=>w.isMobile?{width:18,height:18}:{width:16,height:16}),[w.isMobile]);return(0,f.jsx)(p().A,{left:C&&(0,f.jsx)(r(57232).A,{iconSize:12}),title:(0,f.jsx)(r(632537).A,{groupBy:S,groupFormat:b,currentGroups:v.currentGroups,schema:g,disabled:!0,isHiddenGroup:!1,collectionContextStore:t}),titleStyle:{marginLeft:-2,opacity:b.hidden?.4:1},right:(0,f.jsxs)(f.Fragment,{children:["board_columns"===x&&(0,f.jsx)(y().A,{renderTooltip:e=>(0,f.jsx)(u().sA,{...e,...b.pinned?m().K0.unpinGroup:m().K0.pinGroup}),render:e=>{const t=M&&F;return b.pinned?t?(0,f.jsx)(d().A,{...(0,h().A)(e,z),icon:r(573812)._,iconStyle:L,isDarkIconColor:!0,ariaLabel:B.formatMessage(m().K0.unpinGroup),onClick:G,disabled:!F}):(0,f.jsx)(d().A,{...(0,h().A)(e,z),icon:r(68207).S,iconStyle:L,isDarkIconColor:!0,ariaLabel:B.formatMessage(m().K0.unpinGroup),onClick:G,disabled:!F}):F?(0,f.jsx)(d().A,{...(0,h().A)(e,z),icon:r(552445).N,iconStyle:L,ariaLabel:B.formatMessage(m().K0.pinGroup),onClick:G,disabled:v.pinnedGroups.length>=i().U5}):null}}),(0,f.jsx)(y().A,{renderTooltip:e=>(0,f.jsx)(u().sA,{...e,...b.hidden?m().K0.showGroup:m().K0.hideGroup}),render:e=>{const t=T&&F;return b.hidden?(0,f.jsx)(d().A,{...(0,h().A)(e,R),icon:t?s().h:l().T,iconStyle:L,isDarkIconColor:t,ariaLabel:B.formatMessage(m().K0.showGroup),onClick:j,disabled:!F}):(0,f.jsx)(d().A,{...(0,h().A)(e,R),icon:t?l().T:s().h,iconStyle:L,isDarkIconColor:!t,ariaLabel:B.formatMessage(m().K0.hideGroup),onClick:j,disabled:!F})}})]})})}},374136:(e,t,r)=>{r.d(t,{_G:()=>H,$k:()=>G,w$:()=>O,H$:()=>D,l9:()=>Y,NH:()=>L,jY:()=>V,JI:()=>R,ck:()=>P,i5:()=>z,EN:()=>W,gc:()=>j,wK:()=>K});var o=()=>r(244641),a=r(296540),n=()=>r(401497),i=()=>r(764880),s=()=>r(100594),l=()=>r(901610),u=()=>r(921598),c=()=>r(713998),d=()=>r(534177),p=()=>r(825237),g=()=>r(651124),y=()=>r(792071),m=r(474848);function h(e){let{size:t,style:r,icon:o,baseUrl:a,getRecordModel:n}=e;return(0,m.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...r},children:(0,m.jsx)(b,{icon:o,size:t,baseUrl:a,getRecordModel:n})})}const f=a.memo(h);function v(e){return.9*e}function S(e){return.888*e}function b(e){let{icon:t,size:r,baseUrl:o,getRecordModel:a}=e;if(!t)return null;const n=(e,t)=>{const a=p().wY({url:e,baseUrl:o,fullyQualified:!0,permissionRecord:t,width:S(r),userId:void 0});return(0,m.jsx)("img",{alt:"icon",src:a,style:{width:S(r),height:S(r),objectFit:"cover",borderRadius:4,marginTop:1}})},i=(0,g().WO)(t.icon);switch(i.type){case"unicode_emoji":return(0,m.jsx)("div",{style:{fontSize:v(r)},children:i.emoji.unicode});case"custom_emoji":const e=y().xm7.resolveCustomEmojiIcon(t,a);return e?n(e.icon,e.pointer):null;case"app_package_asset":case"notion_icon":case"url":return n(t.icon,t.pointer);default:(0,d().HB)(i)}}var x=()=>r(216519);const C=function(e){const{botValue:t,avatarSize:o,baseUrl:a,theme:n,style:i}=e;if(null!=t&&t.icon){const s=r(522419).GM(t.icon)?p().x8({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:a,userId:void 0}):t.icon;return(0,m.jsx)("div",{style:{...(0,x().fo)({theme:n,avatarSize:o}),...i},children:(0,m.jsx)("img",{src:s,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,m.jsx)("div",{children:(0,m.jsx)("div",{style:{...(0,x().ws)({theme:n,avatarSize:o}),...i},children:(0,m.jsx)("div",{children:e})})})}return(0,m.jsx)("span",{children:"🤖"})};var _=()=>r(597777),w=()=>r(869190),B=()=>r(72135),M=()=>r(379632),A=()=>r(100622),T=()=>r(284371),k=()=>r(780054),F=()=>r(10594);const G=(0,r(959013).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function j(e,t,r){const o=(0,n().IS)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor,fontSize:r?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...T().RC}})),[r]);return(0,a.useCallback)(((a,n)=>{var s,l;if(!n)return a.toString();let u,c,d;if(n.actorPointer&&e){var p;const r=(0,i().xC)({pointer:n.actorPointer,getRecordModel:e});c=null==r?void 0:r.asActor,d=null===(p=c)||void 0===p?void 0:p.getDisplayName(t)}return d||(d=a||t.formatMessage(y().Fvx.messages.anonymousPlaceholder)),u=null!==(s=c)&&void 0!==s&&s.isUser()?(0,m.jsx)(x().Ay,{userValue:c,avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,A().x0)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}):null!==(l=c)&&void 0!==l&&l.isBot()?(0,m.jsx)(C,{botValue:c,avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,A().x0)(),style:o.botStyle}):(0,m.jsx)(x().Ay,{userValue:{name:"?"},avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,A().x0)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}),M().A.renderToStaticMarkup((0,m.jsxs)("div",{style:o.wrapper,children:[(0,m.jsx)("div",{style:o.avatarWrapper,children:u}),r?(0,m.jsx)("div",{style:o.nameWrapper,children:d}):null]}))}),[e,t,r,o])}function K(e,t,r){const o=(0,n().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...T().RC}})),[]),i=t.formatMessage(G.titlePlaceholder);return(0,a.useCallback)(((a,n)=>{if(!n||!e)return a.toString()||i;let s;if(n.pagePointer&&e&&(s=e(n.pagePointer)),!s)return a.toString()||i;const l=s.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:r,intl:t}),u=s.getRenderIcon({getRecordModel:e});return M().A.renderToStaticMarkup((0,m.jsxs)("div",{style:o.wrapper,children:[u&&(0,m.jsx)("div",{style:o.avatarWrapper,children:(0,m.jsx)(f,{getRecordModel:e,icon:u,size:16,baseUrl:k().A.domainBaseUrl})}),(0,m.jsx)("div",{style:o.titleWrapper,children:l})]}))}),[e,r,t,i,o.wrapper,o.avatarWrapper,o.titleWrapper])}function P(e){var t,r,o,a;const n="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)?"number":R(e.propertySchema);let i;return i="count"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)||"unique"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?z(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,B().ZV)(t,n,e.intl,"compact",i):(0,B().ZV)(W(t,2),n,e.intl,"compact",void 0)}function V(e){let{groupBy:t,dateFormat:r,intl:o}=e;return(e,a)=>{let n;return n=a?a.name:"string"==typeof e?e:e.toString(),D({dateString:n,dateFormat:r,groupBy:t,intl:o})}}function D(e){let{dateString:t,dateFormat:r,groupBy:a,intl:n}=e;const i=parseInt(t,10);if(isNaN(i))return t;switch(a){case"relative":default:return t;case"day":return(0,w().ZF)({value:{type:"date",start_date:o().c9.fromMillis(i).toISODate()},date_format:r||_().vz,allowRelativeDates:!0,intl:n});case"week":case"month":case"year":const e=o().c9.fromMillis(i),s={type:a,range:{type:"daterange",start_date:e.toISODate(),end_date:e.plus({[`${a}s`]:1}).minus({days:1}).toISODate()}};return(0,F().nc)({value:s,intl:n})}}function R(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function z(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function L(e){let{chartConfig:t,schema:r,highChartsLabel:o,highChartsValue:a,isMultiSeries:n,intl:i,numberPrecisionOverride:u}=e,d=o,p=a;if(!t)return{label:d,value:p};const g=t.dataConfig;let y,m,h,f;if(n){if((0,l().m)(t)&&"groups_reducer"===t.dataConfig.type){var v;const e=t.dataConfig;if(y=null===(v=e.aggregationConfig.stackOptions)||void 0===v?void 0:v.groupBy,y){const e=(0,c()._g)({schema:r,property:y.property});e&&(0,s().zn)(e)&&(m=e)}f=e.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,c()._g)({schema:r,property:f.property}))}}else"groups_reducer"===g.type?(y=g.groupBy,m=(0,c()._g)({schema:r,property:g.groupBy.property}),f=g.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,c()._g)({schema:r,property:f.property}))):h=(0,c()._g)({schema:r,property:g.valueProperty});if(d=m?O({propertySchema:m,groupByFormat:y,aggregation:void 0,highChartsLabel:o,intl:i}):d,p&&"number"==typeof p&&h&&(0,s().JW)(h)){var S,b,x,C;const e="count"===(null===(S=f)||void 0===S?void 0:S.aggregator)||"unique"===(null===(b=f)||void 0===b?void 0:b.aggregator)?"number":R(h),t="count"===(null===(x=f)||void 0===x?void 0:x.aggregator)||"unique"===(null===(C=f)||void 0===C?void 0:C.aggregator)?"precision_0":u??z(h);p=t&&"precision_uncapped"!==t?(0,B().ZV)(p,e,i,"compact",t):(0,B().ZV)(W(p,2),e,i,"compact")}return{label:d,value:p}}function O(e){const{propertySchema:t,groupByFormat:r,aggregation:o,highChartsLabel:a,intl:n}=e;if(t&&(0,s().JW)(t)){const e="count"===(null==o?void 0:o.aggregator)||"unique"===(null==o?void 0:o.aggregator)?"number":R(t),r=parseInt(a,10);return isNaN(r)||"percent"===e?a:(0,B().ZV)(r,e,n,"compact")}const i="formula"===(null==r?void 0:r.type)?r.groupBy:r;return t&&(0,s().i8)(t)&&i&&(0,u().Ik)(i)?D({dateString:a,dateFormat:t.date_format,groupBy:i.groupBy,intl:n}):a}const I=1.2,E=2;function H(e){var t,r,o,a;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator))return!1;return"percent"===R(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<E||(!!(null!==(o=e.userYAxisMax)&&void 0!==o&&o.toString().includes(".")||null!==(a=e.userYAxisMin)&&void 0!==a&&a.toString().includes("."))||Math.abs(e.dataYAxisMax)<I&&Math.abs(e.dataYAxisMin)<I))}function Y(e){return e%1==0?e:e.toFixed(1)}function W(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}},417591:(e,t,r)=>{r.d(t,{Y:()=>u});r(581454);var o=()=>r(56366),a=()=>r(282339),n=()=>r(901610),i=()=>r(322638),s=()=>r(10594),l=()=>r(941814);function u(e){let{chartConfig:t,chartError:r,collectionContextStore:u}=e;const c=(0,o().O$)(u.normalizedFormatStore),d=(0,o().K8)((()=>(0,l().hk)()),[]),p=(0,o().K8)((()=>(0,l().H4)()),[]);return(0,o().K8)((()=>{if((!r||(0,a().xG)(r))&&t)return function(e){var t,r,o;let{chartConfig:a,format:l,groupsLimit:u,subGroupsLimit:c}=e;if("placeholder"===a.type||"groups_reducer"!==(null===(t=a.dataConfig)||void 0===t?void 0:t.type))return;const d=null===(r=a.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups,p=l.collection_groups||[],g=p.map((e=>e.value)),y=a.dataConfig.groupBy,m=(0,n().m)(a)?null===(o=a.dataConfig.aggregationConfig.stackOptions)||void 0===o?void 0:o.groupBy:void 0,h=(0,i().p7)(a);if(!h)return;const f=(0,s().w9)(y,l);if(m){const e=(l.chart_subgroups||[]).map((e=>e.value));return{type:"groups",groupBy:f,limit:u,groupSortPreference:g,subGroup:{groupBy:(0,s().w9)(m,l),limit:c,groupSortPreference:e},aggregation:{type:"intersection_and_independent",intersectionAggregation:h,groupAggregation:h,subGroupAggregation:h},hideEmptyAggregationGroups:Boolean(d)}}const v={type:"groups",limit:u,groupBy:f,groupSortPreference:g??[],aggregation:{type:"independent",groupAggregation:h},hideEmptyAggregationGroups:Boolean(d)};return v}({chartConfig:t,format:c,groupsLimit:d,subGroupsLimit:p})}),[r,t,d,c,p],{useDeepEqual:!0})}},514608:(e,t,r)=>{r.d(t,{J:()=>n});r(296540);var o=r(474848);const a={viewBox:"0 0 16 16",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M9.219 8.002a1.22 1.22 0 1 1-2.439 0 1.22 1.22 0 0 1 2.439 0"}),(0,o.jsx)("path",{d:"M.914 7.44a1.21 1.21 0 0 0 0 1.128c1.282 2.442 3.987 4.1 7.086 4.1s5.804-1.658 7.086-4.1a1.21 1.21 0 0 0 0-1.128C13.804 4.997 11.099 3.34 8 3.34S2.196 4.997.914 7.44M8 10.628a2.626 2.626 0 1 1 .001-5.251A2.626 2.626 0 0 1 8 10.627"})]})},n=(0,r(340498).wt)("eyeFillSmall",a)},552445:(e,t,r)=>{r.d(t,{N:()=>a});r(296540);var o=r(474848);const a=(0,r(340498).wt)("pin",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M1.25 12.875h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.304-3.359-4.109L8.617 4c.992-.648 1.93-1.383 2.328-1.914.211-.266.305-.531.305-.758 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .227.093.492.297.758.398.531 1.343 1.266 2.328 1.914L3.46 7.664C1.42 8.47.1 10.125.1 11.774c0 .664.446 1.101 1.149 1.101zm4.922-5.719c-.5 0-.984.047-1.438.14l.235-3.874c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102 0-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.969.867-2.14 1.468-.071.04-.095.079-.079.188l.234 3.875a7.177 7.177 0 00-1.437-.14zm-4.61 4.54c-.18 0-.257-.102-.226-.313.172-1.406 1.969-3.086 4.836-3.086 2.86 0 4.656 1.68 4.828 3.086.031.21-.047.312-.227.312h-9.21z"})})},620586:(e,t,r)=>{r.d(t,{BV:()=>c,HH:()=>g,LF:()=>u,NF:()=>v,Pi:()=>d,Q1:()=>m,nH:()=>f,tm:()=>y,wW:()=>p});var o=()=>r(100594),a=()=>r(970013),n=()=>r(751735),i=()=>r(100622),s=()=>r(534177),l=()=>r(10594);function u(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function c(e,t){if("auto"!==e){if("colorful"===e)return i().OK.colorful.slice(0,6);if(d(e)){const r="gray"===e?"dark"===t.mode?"white":"black":e;return i().OK[r]}(0,s().HB)(e)}}function d(e){return o().VY.includes(e)}function p(e,t,r){const o=function(e,t,r){if("auto"===e)return;let o;if(o="gray"===e?"dark"===r.mode?"white":"black":e,t&&d(e)){const e=i().OK[o];return[e[0],e[3]]}return i().OK[o]}(e,t,r);if(o)return d(e)&&t?{colorAxis:{minColor:o[1],maxColor:o[0],showInLegend:!1},colors:o}:{colorAxis:void 0,colors:o}}function g(e){var t,r;let{collectionContextStore:o,groupValue:n,index:s,groupBy:u,theme:c,environment:d}=e;const g=o.normalizedSchemaStore.state,y=o.normalizedFormatStore.state;if("placeholder"===(null===(t=y.chart_config)||void 0===t?void 0:t.type)||void 0===n.value)return"light"===c.mode?i().OK.translucentGray[0]:i().OK.translucentGray[1];const m=g[u.property],h=m&&((0,a().lx)(m)||(0,a().DD)(m)),f=(null===(r=y.chart_config)||void 0===r||null===(r=r.chartFormat)||void 0===r?void 0:r.colorTheme)||"auto";if("auto"===f&&h){const e=(0,l().$e)({environment:d,groupFormat:{property:u.property,value:n},schema:g,format:y,theme:c,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const v=p("auto"===f?"colorful":f,!1,c),S=(null==v?void 0:v.colors)||i().OK.colorful;return S[s%S.length]}function y(e,t){return t?{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(0, 0, 0, 0)"],[1,"rgba(0, 0, 0, 0)"]]}:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,n().X4)(e,.1)],[1,(0,n().X4)(e,0)]]}}const m=["gradient","blue","red","yellow","grey","none"],h=(0,r(959013).YK)({gradient:{defaultMessage:"Gradient",id:"chart.export.background.gradient"},blue:{defaultMessage:"Blue",id:"chart.export.background.blue"},red:{defaultMessage:"Red",id:"chart.export.background.red"},yellow:{defaultMessage:"Yellow",id:"chart.export.background.yellow"},grey:{defaultMessage:"Grey",id:"chart.export.background.grey"},none:{defaultMessage:"None",id:"chart.export.background.none"}});function f(e){return h[e]}function v(e,t,r){const o="light"===e.mode?r?100:50:r?600:500;switch(t){case"blue":return e.accentColors.blue[o];case"red":return e.accentColors.red[o];case"yellow":return e.accentColors.yellow[o];case"grey":return e.accentColors.gray[o];case"none":const a=r?e.buttonHoveredBackground:e.popoverBackground;return`linear-gradient(to top right, ${a} calc(50% - 1px), ${e.regularDividerColor}, ${a} calc(50% + 1px) )`;case"gradient":return`${r?`linear-gradient(${e.buttonHoveredBackground}, ${e.buttonHoveredBackground}), `:""}${"dark"===e.mode?"linear-gradient(123deg, #3C3F41 40.15%, #4A2F27 89.33%)":"linear-gradient(123deg, #FEF5E9 40.15%, #FEE9E9 89.33%)"}`;default:(0,s().HB)(t)}}},622281:(e,t,r)=>{r.d(t,{AY:()=>R,CL:()=>U,CS:()=>Y,UX:()=>D,cN:()=>K,hu:()=>H,p4:()=>z,w7:()=>j});r(944114),r(898992),r(803949),r(581454);var o=()=>r(244641),a=()=>r(764880),n=()=>r(66689),i=()=>r(100594),s=()=>r(499755),l=()=>r(901610),u=()=>r(708685),c=()=>r(921598),d=()=>r(970013),p=()=>r(713998),g=()=>r(254947),y=()=>r(80979),m=()=>r(799829),h=()=>r(450648),f=()=>r(179034),v=()=>r(100622),S=()=>r(496603),b=()=>r(534177),x=()=>r(895876),C=()=>r(508496),_=()=>r(148832),w=()=>r(10594),B=()=>r(972435),M=()=>r(71304),A=()=>r(685889),T=()=>r(909470),k=()=>r(23815),F=()=>r(620586),G=()=>r(374136);function j(e){var t,r,o;let{collectionContextStore:a,groupedDataConfig:n,xAxisType:s,groupResults:l,aggregationResults:u,subGroupResults:d,timezone:g,theme:y,environment:m,intl:h,groupTotals:f}=e;const b=n.groupBy,x=n.aggregationConfig,C=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!C||"placeholder"===C.type)return;const _=null==C?void 0:C.chartFormat,w=null==_?void 0:_.weightColorValue,B=null==_?void 0:_.mainSort,M=null==_?void 0:_.smoothLine;if(!u||!b||!x)return;if(!(0,c().rj)(b.type))return;const A=a.normalizedSchemaStore.state,T=(0,p()._g)({schema:A,property:b.property});if(!T)return;const k=Boolean(null===(r=C.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),G="datetime"===s||"linear"===s;"formula"!==b.type&&"descending"===b.sort.type&&G&&(l=l.reverse());const j=!G,K=G;let D=0,R=0,z=[],I=[];const E=null===(o=x.stackOptions)||void 0===o?void 0:o.groupBy,H=x.seriesFormat.displayType;if(d&&E){if(!(0,p()._g)({schema:A,property:E.property}))return;const e=new Map,t=null==_?void 0:_.axisCumulative;let r=0;d.forEach((e=>{const o=e.value,n=L({collectionContextStore:a,groupBy:E,groupValue:o,removeUncategorizedDateOrNumber:!1,environment:m,intl:h,timezone:g});if(!n)return;const s=(0,c().AC)(o),d=u[s],p=d?O(d):void 0;if(k&&!p)return;const v=P(n.stringValue,H,M),{maxGroupValue:S,minGroupValue:x,dataPoints:B}=V({collectionContextStore:a,subGroupKey:s,groupBy:b,hideEmptyGroups:k,groupResults:l,aggregationResults:u,groupTotals:f,timezone:g,environment:m,shouldSetDataPointColor:"line"!==H&&!w,theme:y,intl:h,useIndexAsX:j,removeUncategorizedDateOrNumber:K,seriesDisplayType:H});var A;(v.color=(0,F().HH)({collectionContextStore:a,groupValue:o,index:r,groupBy:E,theme:y,environment:m}),"line"===H)&&(v.fillColor=(0,F().tm)(v.color,Boolean(null===(A=C.chartFormat)||void 0===A?void 0:A.hideLineFillArea)));if(t&&Y(C)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=W(B);v.data=r,"line"===H&&_.axisGroupStyle===i().PC.side_by_side?(e>D&&(D=e),t<R&&(R=t)):(D+=e,R+=t)}else v.data=B,S>D&&(D=S),x<R&&(R=x);z.push(v),r+=1})),"y-ascending"!==B&&"y-descending"!==B||(z=function(e,t){const r=(0,S().mg)(e);return r.forEach((e=>{const r=e.data.sort(((e,r)=>"y-ascending"===t?(e.total?e.total:0)-(r.total?r.total:0):(r.total?r.total:0)-(e.total?e.total:0)));r.forEach(((e,t)=>{e.x=t})),e.data=r})),r}(z,B));for(const o of z)for(const t of o.data)e.set(t.x,t);I=Array.from(e).sort(((e,t)=>e[0]-t[0])).map((e=>{let[t,r]=e;return r}))}else{const e=T.name,{maxGroupValue:t,minGroupValue:r,dataPoints:o}=V({collectionContextStore:a,subGroupKey:void 0,groupBy:b,hideEmptyGroups:k,groupResults:l,aggregationResults:u,groupTotals:f,timezone:g,environment:m,shouldSetDataPointColor:"line"!==H&&!(0,F().LF)(null==_?void 0:_.colorTheme)&&!w,theme:y,intl:h,useIndexAsX:j,removeUncategorizedDateOrNumber:K,seriesDisplayType:H}),n=P(e.toString(),H,M);if("line"===H){var U,N,$;const e=(null===(U=(0,F().wW)((null===(N=C.chartFormat)||void 0===N?void 0:N.colorTheme)||"colorful",!1,y))||void 0===U||null===(U=U.colors)||void 0===U?void 0:U[0])||v().OK.colorful[0];n.fillColor=(0,F().tm)(e,Boolean(null===($=C.chartFormat)||void 0===$?void 0:$.hideLineFillArea))}if((null==_?void 0:_.axisCumulative)&&Y(C)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=W(o);n.data=r,D+=e,R+=t}else n.data=o,t>D&&(D=t),r<R&&(R=r);z.push(n),I=n.data}return{seriesData:z,maxValue:D,minValue:R,dataPointsForXAxisLabels:I}}function K(e){var t;const r=[],{groupedDataConfig:o,collectionContextStore:a,groupResults:n,aggregationResults:i,timezone:s,environment:l,theme:u,intl:c,groupTotals:d}=e,g=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const y=null==g?void 0:g.chartFormat,m=null==y?void 0:y.weightColorValue,h=o.groupBy,f=a.normalizedSchemaStore.state,v=(0,p()._g)({schema:f,property:h.property});if(!v)return;const{dataPoints:S}=V({collectionContextStore:a,subGroupKey:void 0,groupBy:h,groupResults:n,aggregationResults:i,groupTotals:d,timezone:s,environment:l,shouldSetDataPointColor:!m,theme:u,intl:c,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1});return r.push({name:v.name,data:S}),r}function P(e,t,r){let o;return o="line"===t?r?"areaspline":"area":t,{name:e,type:o,data:[]}}function V(e){var t;let{collectionContextStore:r,subGroupKey:o,groupBy:a,hideEmptyGroups:n,groupResults:s,aggregationResults:l,groupTotals:u,timezone:d,environment:p,shouldSetDataPointColor:g,theme:y,intl:m,useIndexAsX:h,removeUncategorizedDateOrNumber:f,seriesDisplayType:v}=e,S=0,b=0;const x=[],C=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!C||"placeholder"===C.type)return{maxGroupValue:S,minGroupValue:b,dataPoints:x};let _=0;return s.forEach(((e,t)=>{var s,w,B,M,A;const T=e.value,k=(0,c().AC)(T),G=o?(0,c().A)([o,k]):k,j=l[G],K=l[k];if(!j||!K)return;const P=L({collectionContextStore:r,groupBy:a,removeUncategorizedDateOrNumber:f,groupValue:T,environment:p,intl:m,timezone:d}),V=O(j),D=(null===(s=u.get(k))||void 0===s?void 0:s.max)||0,R=(null===(w=u.get(k))||void 0===w?void 0:w.min)||0,z=(null===(B=u.get(k))||void 0===B?void 0:B.total)||0,I=g&&!o?(0,F().HH)({collectionContextStore:r,groupValue:T,index:_,groupBy:a,theme:y,environment:p}):void 0;if(void 0===P||void 0===V||void 0===D||void 0===R)return;if(n&&0===z)return;if(n&&"side_by_side"===(null===(M=C.chartFormat)||void 0===M?void 0:M.axisGroupStyle)&&0===V)return;const E=null===(A=C.chartFormat)||void 0===A?void 0:A.axisGroupStyle;let H;E===i().PC.side_by_side?(V>S&&(S=V),V<b&&(b=V)):"line"===v&&E===i().PC.normal?(z>S&&(S=z),z<b&&(b=z)):(D>S&&(S=D),R<b&&(b=R)),h?(H={x:o?t:_,y:V,name:P.stringValue,total:z},P.actorPointer&&(H.actorPointer=P.actorPointer)):H={x:P.numberValue,y:V,name:P.stringValue,total:z},I&&(H.color=I),H.groupFormat=e,x.push(H),_+=1})),{maxGroupValue:S,minGroupValue:b,dataPoints:x}}function D(e){var t,r;let{collectionContextStore:o,resultsDataConfig:a,resultsChartReducerResults:n,chartType:i,timezone:l,theme:c,intl:d}=e;const g=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const m=null==g?void 0:g.chartFormat,f=null==m?void 0:m.weightColorValue,S=null==m?void 0:m.smoothLine,b=o.normalizedSchemaStore.state,x=(0,p()._g)({schema:b,property:a.valueProperty});if(!x)return;const w=Boolean(null===(r=g.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),B=[],M=x.name,A="axis"===i?a.valueSeriesFormat.displayType:"column",{maxDataPoint:k,minDataPoint:j,dataPoints:K}=function(e){var t,r,o;let{collectionContextStore:a,hideEmptyGroups:n,resultsDataConfig:i,resultsChartReducerResults:l,shouldSetDataPointColor:c,theme:d,useIndexAsX:g,timezone:m,intl:f}=e,v=0,S=0;const b=[],x=a.normalizedFormatStore.state.chart_config,w=a.collectionStore();if(!w||!x||"placeholder"===x.type||!l)return{maxDataPoint:v,minDataPoint:S,dataPoints:b};let B=0;const M=(null===(t=x.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",A=(0,F().wW)("auto"===M?"colorful":M,!1,d),k=a.normalizedSchemaStore.state,j=(0,p()._g)({schema:k,property:i.nameProperty}),K=(0,p()._g)({schema:k,property:i.valueProperty}),P=new Map,V=new Map;if(l.blockIds.forEach((e=>{const t=_().B.createChildStore(w,{table:"block",id:e,spaceId:w.getSpaceId()}),r=t.getModel(),o=(()=>{if("formula"===(null==j?void 0:j.type)){if("text"!==(0,u().getFormulaPropertySchemaResultType)(j)||!r)return;return(0,y().primitiveFormulaValueFromPropertySchema)({schema:k,property:i.nameProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:P,regExpCache:V,experimentService:C().default,collectionFeatureGates:(0,T().i)()})??""}const e=t.getPropertyValue(i.nameProperty),o=(0,h().r4)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:m,intl:f});return"title"===(null==j?void 0:j.type)?o||f.formatMessage(G().$k.titlePlaceholder):o})(),a=(()=>{if("formula"===(null==K?void 0:K.type)){if("number"!==(0,u().getFormulaPropertySchemaResultType)(K)||!r)return;const e=(0,y().primitiveFormulaValueFromPropertySchema)({schema:k,property:i.valueProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:P,regExpCache:V,experimentService:C().default,collectionFeatureGates:(0,T().i)()});if("number"!=typeof e)return;return e}const e=t.getPropertyValue(i.valueProperty);return(0,p().Me)(e)})();if(n&&void 0===a)return;let s;a&&a>v&&(v=a),a&&a<S&&(S=a);const l=null==A?void 0:A.colors;if(l&&c&&(s=l[B%l.length]),g){const e={x:B,y:a,name:o,color:s};"title"===(null==j?void 0:j.type)&&r&&(e.pagePointer=r.pointer),b.push(e)}B+=1})),(null==x||null===(r=x.chartFormat)||void 0===r?void 0:r.axisCumulative)&&Y(x)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=W(b);return{maxDataPoint:e,minDataPoint:t,dataPoints:r}}const D=null===(o=x.chartFormat)||void 0===o?void 0:o.mainSort;if(D===s().S0.yAscending||D===s().S0.yDescending){const e=b.sort(((e,t)=>{const r=void 0===e.y?-1/0:e.y,o=void 0===t.y?-1/0:t.y;return D===s().S0.yDescending?o-r:r-o}));return e.forEach(((e,t)=>{e.x=t})),{maxDataPoint:v,minDataPoint:S,dataPoints:e}}return{maxDataPoint:v,minDataPoint:S,dataPoints:b}}({collectionContextStore:o,hideEmptyGroups:w,resultsDataConfig:a,resultsChartReducerResults:n,shouldSetDataPointColor:"line"!==A&&!f,theme:c,useIndexAsX:!0,timezone:l,intl:d}),V=P(M.toString(),A,S);if("line"===A){var D,R,z;const e=(null===(D=(0,F().wW)((null===(R=g.chartFormat)||void 0===R?void 0:R.colorTheme)||"colorful",!1,c))||void 0===D||null===(D=D.colors)||void 0===D?void 0:D[0])||v().OK.colorful[0];V.fillColor=(0,F().tm)(e,Boolean(null===(z=g.chartFormat)||void 0===z?void 0:z.hideLineFillArea))}return V.data=K,B.push(V),{maxValue:k,minValue:j,seriesData:B}}function R(e){let{groupedDataConfig:t,hideEmptyGroups:r,mainSort:o}=e;if(r||"y-ascending"===o||"y-descending"===o)return"category";const{type:a}=t.groupBy;return(0,c().Ik)(t.groupBy)&&"relative"!==t.groupBy.groupBy?"datetime":"number"===a?"linear":"category"}function z(e){let{mainSort:t,xAxisType:r}=e;return"datetime"===r&&"x-descending"===t||"linear"===r&&"x-descending"===t}function L(e){let{collectionContextStore:t,groupBy:r,groupValue:n,removeUncategorizedDateOrNumber:i,environment:s,intl:u,timezone:y}=e;const h=t.collectionViewBlockStore();if(!h)return;const v=t.normalizedSchemaStore.state,S=(0,p()._g)({schema:v,property:r.property});if(!S)return;const x=S.name;if(!n.value){if(i&&("number"===n.type&&"number"===(null==S?void 0:S.type)||(0,c().DH)(n)))return;if((0,c().D1)(n)&&(0,d().nC)(S)){const e=h.getAssociatedCollectionStore();return{stringValue:E(x,!!e&&(0,k().Vu)({collectionStore:e,property:r.property,propertySchema:S,parentStore:e}))}}return{stringValue:E(x)}}if((0,c().DH)(n)){const e=(0,w().nc)({intl:u,value:n.value}),t="formula"===r.type?r.groupBy:r;if((0,c().Ik)(t)&&"relative"===t.groupBy)return{stringValue:e};if("day"===n.value.type||"month"===n.value.type||"week"===n.value.type||"year"===n.value.type){const e=o().c9.fromISO(n.value.range.start_date,{zone:y}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e}}return{stringValue:e}}if((0,c().D1)(n)&&(0,d().nC)(S)){const e=n.value;if((0,c().WO)(e)){const t=e.id,r=_().B.createChildStore(h,{id:t,table:f().ev});return{stringValue:(0,M().tS)({environment:s,intl:u,store:r})}}if((0,c().zx)(e)){var C;const t=(0,A().LQ)(S,h);if(!t)return;const r=null===(C=m().n$[t])||void 0===C||null===(C=C[e.value.variable])||void 0===C?void 0:C.messageDescriptor;return r?{stringValue:u.formatMessage(r)}:void 0}}else if((0,c().rM)(n)){const e=n.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return(0,g().wC)(e.group)?{stringValue:u.formatMessage((0,g().gh)(e.group))}:{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===n.type||"multi_select"===n.type)return{stringValue:n.value};if("number"===n.type){var B;const e=n.value,r=e.type;let o;const a=null===(B=t.collectionViewStore())||void 0===B?void 0:B.getChartConfig();var T;if(a&&(0,l().m)(a))o=null===(T=a.chartFormat)||void 0===T?void 0:T.numberPrecisionOverride;const i=(0,G().ck)({propertySchema:S,aggregation:void 0,intl:u,numberPrecisionOverride:o});if(!i)return;if("range"===r)return{stringValue:i(e.start),numberValue:e.start};if("unique"===r)return{stringValue:i(e.value),numberValue:e.value};if("out_of_range"===r)return;(0,b().HB)(r)}else{if((0,c().GG)(n)){const e=n.value,t=(0,a().xC)({pointer:e,getRecordModel:h.getRecordModel});if(!t)return;return{stringValue:(0,a().lR)(u,t),actorPointer:e}}if("checkbox"===n.type)return{stringValue:S.name};if("title"===n.type){if("exact"===n.value.type)return{stringValue:n.value.value||u.formatMessage(G().$k.titlePlaceholder)}}else if((0,c().kO)(n)){if("exact"===n.value.type)return{stringValue:n.value.value}}else if("formula"===n.type&&"formula"===r.type){return L({collectionContextStore:t,groupBy:r,groupValue:n.value,removeUncategorizedDateOrNumber:i,environment:s,intl:u,timezone:y})}}}}function O(e){if(!e)return;const t=e.aggregationResult;return"number"===t.type?t.value:void 0}const I=(0,r(959013).YK)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function E(e,t){return t?B().A.formatMessage(k().zX.sprintUncategorizedGroup,{name:e??B().A.formatMessage(n().TZ.sprint_plural)}):B().A.formatMessage(I.chartUncategorizedGroup,{name:e??(0,x().oj)(void 0)})}function H(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const r=e.dataConfig.type;var t;if("groups_reducer"===r)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===r)return!0;(0,b().HB)(r)}}function Y(e){var t;const r=(0,l().m)(e),o="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",a="count"===o||"sum"===o,n=null===(t=e.chartFormat)||void 0===t?void 0:t.mainSort;return r&&a&&"x-ascending"===n}function W(e){let t=0,r=0;const o=[];let a=0;for(const n of e){const e=n.y||0,i={...n,y:e+a};o.push(i),a+=e,a>r&&(r=a),a<t&&(t=a)}return{maxDataPoint:r,minDataPoint:t,cumulatedDataPoints:o}}function U(e){let{groupedChartReducerResults:t,chartConfig:r,sortType:o}=e;const a=null==t?void 0:t.aggregationResults;if(!a)return;const n=r.chartFormat,i=null==n?void 0:n.mainSort;let s;"main"!==o||"y-ascending"!==i&&"y-descending"!==i||(s="y-ascending"===i?"asc":"desc");const l=null==n?void 0:n.axisHideEmptyGroups,u=function(e){const{groupResults:t,aggregationResults:r,subGroupResults:o}=e,a=new Map;return t.forEach((e=>{const t=e.value,n=(0,c().AC)(t);let i=0,s=0;if(o)o.forEach((e=>{const t=e.value,o=(0,c().AC)(t),a=(0,c().A)([o,n]),l=O(r[a])||0;l>0&&(i+=l),l<0&&(s+=l)}));else{const e=O(r[n])||0;e>i&&(i=e),e<s&&(s=e)}a.set(n,{min:s,max:i,total:s+i})})),a}({aggregationResults:a,groupResults:t.results,subGroupResults:t.subGroupResults});return{aggregationResults:a,yAxisSortOrder:s,hideZeroAggregations:l||"donut"===r.type,groupTotals:u}}},656881:(e,t,r)=>{r.d(t,{b:()=>a,y:()=>n});var o=()=>r(972435);const a=(0,r(959013).YK)({noData:{defaultMessage:"No data",id:"chartError.noData"},badYAxisRange:{defaultMessage:"No data due to axis range",id:"chartError.badYAxisRange"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function n(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return o().A.formatMessage(a.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return o().A.formatMessage(a.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return o().A.formatMessage(a.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return o().A.formatMessage(a.deletedProperty);case"aggregation_invalid":return o().A.formatMessage(a.invalidAggregation);case"stackBy_property_no_values":return o().A.formatMessage(a.noValues);case"name_property_invalid":case"property_value_property_invalid":return o().A.formatMessage(a.invalidPropertyValueChart);default:return}}},714185:(e,t,r)=>{r.d(t,{f:()=>y});var o=()=>r(484714),a=()=>r(56366),n=()=>r(187174),i=()=>r(869558),s=()=>r(96689),l=()=>r(58293),u=()=>r(792415);const c=new(r(848776).U)((e=>{let{spaceId:t,collectionViewId:r}=e;return`${t}|${r}`}),(async(e,t)=>{let{spaceId:o,collectionViewId:a}=t;if(!o||!a)return{canViewChart:!1,canViewChartError:"paywall_error"};const n=await Promise.resolve().then(r.bind(r,449506)),i=await n.callApi({eventName:"canViewChart",environment:e,data:{spaceId:o,collectionViewId:a}});return"success"!==i.type?{canViewChart:!1,canViewChartError:"paywall_error"}:{canViewChart:i.data.can_view_chart,canViewChartError:void 0}}));r(604341).exposeDebugValue("CollectionViewCanViewChartStore",c);const d=c;var p=()=>r(589994),g=()=>r(597898);function y(e){let{collectionContextStore:t}=e;const r=(0,o().v3)(),c=(0,l().r)(),y=r.currentUser.id,m=null==c?void 0:c.id,h=(0,a().K8)((()=>{var e;return(null==c?void 0:c.id)===s().Zz||(null===(e=u().A.state.publicPageData)||void 0===e?void 0:e.spaceId)===s().Zz}),[c]),{collectionViewStore:f,collectionViewBlockStore:v}=(0,a().K8)((()=>({collectionViewStore:t.collectionViewStore(),collectionViewBlockStore:t.collectionViewBlockStore()})),[t]),S=(0,a().K8)((()=>{const e=null==f?void 0:f.id,r=t.updateFreeChartsResultStore.state;if(e&&r&&r.has(e))return r.get(e)}),[t.updateFreeChartsResultStore,f]),b=(0,g().P9)({name:"view_chart",spaceId:m,userId:y,amount:"unknown"}),[{value:x}]=(0,n().Yb)((async()=>{const e=null==f?void 0:f.id,t=null==f?void 0:f.getSpaceId();if(!e||!t)return{canViewChart:!1,canViewChartError:"paywall_error"};if(b||h)return{canViewChart:!0,canViewChartError:void 0};if(await p().transactionQueue.awaitRecordTransaction({table:i().Gy,id:e}),null!=S&&S.isPending)return{canViewChart:void 0,canViewChartError:void 0};if(null==v?void 0:v.pathIsAccessibleAndAlive())return void 0!==(null==S?void 0:S.value)?{canViewChart:S.value,canViewChartError:void 0}:await d.awaitData(r,{spaceId:t,collectionViewId:e});{const o=await d.awaitData(r,{spaceId:t,collectionViewId:e});return await d.awaitData(r,{spaceId:t,collectionViewId:e},Boolean(o))}}),[f,v,r,b,S,h]),{canViewChart:C,canViewChartError:_}=x??{canViewChart:void 0,canViewChartError:void 0};return{canViewChart:C,canViewChartError:_}}},812480:(e,t,r)=>{r.d(t,{Ay:()=>ie,Rb:()=>fe,WK:()=>re,bO:()=>Q,cS:()=>oe,eD:()=>te,hC:()=>X,hU:()=>N,rq:()=>$});r(16280),r(581454);var o=r(296540),a=()=>r(484714),n=()=>r(56366),i=()=>r(401497),s=()=>r(757695),l=()=>r(708685),u=()=>r(921598),c=()=>r(452706),d=()=>r(30626),p=()=>r(514608),g=()=>r(288739),y=()=>r(340498),m=()=>r(959013),h=()=>r(496603),f=()=>r(534177),v=()=>r(436696),S=()=>r(607517),b=()=>r(786452),x=()=>r(916260),C=()=>r(686526),_=()=>r(896628),w=()=>r(317909),B=()=>r(101981),M=()=>r(632537),A=()=>r(493823),T=()=>r(760217),k=()=>r(439264),F=()=>r(57232),G=()=>r(285790),j=()=>r(331542),K=()=>r(678553),P=()=>r(89924),V=()=>r(574036),D=()=>r(717402),R=()=>r(10594),z=()=>r(972435),L=()=>r(963589),O=()=>r(940371),I=()=>r(352377),E=()=>r(497222),H=()=>r(828973),Y=r(474848);const W=s().default.createClass(void 0,{name:"ReducerResultStore"}),U=s().default.createClass(R()._9,{name:"GroupsLimitStore"});function N(e){return e?(0,Y.jsx)(D().Ay,{propertySchema:e,showIcon:!1}):(0,Y.jsx)(m().sA,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function $(e,t){return"collection_group_by"===e&&"board"===t?(0,Y.jsx)(m().sA,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,Y.jsx)(m().sA,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function q(e){const{groupBy:t,schema:r}=e,o=r[t.property];if(!o||!(0,u().Eg)(o))return;let a;if("formula"===o.type){const e=(0,l().getFormulaPropertySchemaResultType)(o);if("unknown"===e||"array"===e)return;a="block"===e?"relation":e}else a=o.type;return(0,u()._o)(a)||(0,u().Vs)(a)||"number"===a||"status"===a?a:void 0}function X(e){const t=q(e);if(t)return(0,u()._o)(t)?(0,Y.jsx)(m().sA,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,u().Vs)(t)?(0,Y.jsx)(m().sA,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,Y.jsx)(m().sA,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,Y.jsx)(m().sA,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function Z(e){return(0,u().Ik)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function J(e){return(0,u().Vh)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function Q(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function ee(e){const{groupBy:t}=e,r=q(e);if(r)if((0,u()._o)(r)){const e=Z(t);if(e)return ae(e.groupBy)}else if((0,u().Vs)(r)){const e=J(t);if(e)return ne(e.groupBy)}else if("number"===r){const e=Q(t);if(e)return(0,Y.jsx)(m().sA,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const te=(0,m().YK)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});const re=(0,m().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),oe=(0,m().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function ae(e){return"relative"===e?(0,Y.jsx)(m().sA,{...re.relative}):"day"===e?(0,Y.jsx)(m().sA,{...re.day}):"week"===e?(0,Y.jsx)(m().sA,{...re.week}):"month"===e?(0,Y.jsx)(m().sA,{...re.month}):"year"===e?(0,Y.jsx)(m().sA,{...re.year}):void(0,f().HB)(e)}function ne(e){return"exact"===e?(0,Y.jsx)(m().sA,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,Y.jsx)(m().sA,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,f().HB)(e)}const ie=function(e){const{collectionContextStore:t,groupsFormatKey:o,groupByKey:i,collectionSettingsStore:s}=e,l=(0,a().v3)(),c=(0,n().uB)(void 0,U),d=(0,n().uB)(void 0,W),p=(0,n().O$)(d),g=(0,n().O$)(c),y=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,i,o)),[t,i,o]),[h,f]=(0,r(396671).d)({collectionContextStore:t,groupBy:y,groupsFormatKey:o,reducerResult:p,groupsLimit:g}),S=(0,n().O$)(t.normalizedSchemaStore),b=(0,n().K8)((()=>function(e,t){return le(e)&&(0,R().Qt)({viewType:se(e),groupByKey:t})}(t,i)),[t,i]);return(0,Y.jsxs)(r(735695).Ay,{collectionSettingsStore:s,title:(0,Y.jsx)(ue,{collectionSettingsStore:s,collectionContextStore:t}),children:[(0,Y.jsxs)(P().A,{children:[(0,Y.jsx)(ce,{collectionContextStore:t,collectionSettingsStore:s,groupByKey:i,groupsFormatKey:o,groupBy:y}),y&&q({groupBy:y,schema:S})&&(0,Y.jsx)(pe,{collectionContextStore:t,collectionSettingsStore:s,groupByKey:i,groupsFormatKey:o,groupBy:y}),y&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(r(34423).T,{groupBy:y}),(0,Y.jsx)(ge,{collectionContextStore:t,groupByKey:i,groupBy:y,groupsFormatKey:o}),(0,Y.jsx)(ye,{groupByKey:i,collectionContextStore:t,groupsFormatKey:o,groupsDisplayState:h,groupBy:y})]}),y&&"board_columns_by"===i&&(0,Y.jsx)(de,{collectionContextStore:t})]}),y&&(0,Y.jsx)(ve,{groupsFormatKey:o,collectionContextStore:t,groupByKey:i,reducerResultStore:d,groupsLimitStore:c,groupsDisplayState:h}),(0,Y.jsxs)(P().A,{topBorder:!0,children:[y&&b&&(0,Y.jsx)(E().A,{isGray:!0,icon:r(236262).I,title:(0,Y.jsx)(m().sA,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,r,o){const a=t.collectionViewStore();if(!a)return;w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,canUndo:!0,perform:e=>{_().zA({stores:[a],update:{[r]:void 0,[o]:void 0},transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(l,t,i,o),isRed:!0}),(0,Y.jsx)(r(95441).A,{href:(0,r(836251).xS)("guides.databaseGroup"),title:(0,Y.jsx)(m().sA,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})};function se(e){var t;const r=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!r)throw new Error("View type was not defined.");return r}function le(e){return e.permissionScopesStore.state.canConfigureBlock}function ue(e){let{collectionSettingsStore:t,collectionContextStore:r}=e;const o=(0,n().K8)((()=>(0,O().S)(t)),[t]),a=(0,n().K8)((()=>se(r)),[r]);return o&&"group"===o.type?"collection_group_by"===o.groupByKey&&"board"===a?(0,Y.jsx)(m().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,Y.jsx)(m().sA,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ce(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:o,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a().v3)(),u=(0,n().O$)(r.normalizedSchemaStore),c=t?u[t.property]:void 0,d=(0,n().K8)((()=>le(r)),[r]),p=(0,n().K8)((()=>se(r)),[r]);return(0,Y.jsx)(E().A,{title:$(i,p),showChevron:!0,right:N(c),onClick:()=>{(0,v().X)({environment:l,collectionContextStore:r,action:"click_group_by_property",original_view_type:void 0,property_type:null==c?void 0:c.type}),C().a2({collectionSettingsStore:o,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:s}})},disabled:!d})}function de(e){let{collectionContextStore:t}=e;const r=(0,a().v3)(),o=(0,n().K8)((()=>(0,R().FS)(t.normalizedFormatStore.state)),[t]),i=(0,n().K8)((()=>le(t)),[t]);return(0,Y.jsx)(V().A,{title:(0,Y.jsx)(m().sA,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!o,focused:!1,onClick:()=>{C().ut({environment:r,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function pe(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:o,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a().v3)(),c=(0,n().O$)(r.normalizedSchemaStore),d=(0,n().K8)((()=>le(r)),[r]),p="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,u().Ik)(p)?(0,Y.jsx)(H().A,{title:X({groupBy:p,schema:c}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().BI.map((e=>({key:e,type:"button",title:ae(e)}))),onChange:e=>function(e,t,r,o,a){const n=(0,u().H2)(r.normalizedFormatStore.state,o,a),i=r.collectionViewStore();if(!n||!i)return;const s=Z(n);if(s){if((0,u().Ik)(n))w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{_().zA({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t}),"week"===e&&_().Jo(i,t)}});else if("formula"===n.type){const r={...h().cJ(s,"property"),type:"date",groupBy:e},l={...n,groupBy:r};w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{_().zA({stores:[i],update:{[o]:l,[a]:void 0},transaction:t}),"week"===e&&_().Jo(i,t)}})}(0,v().X)({environment:t,collectionContextStore:r,action:"update_date_group_by"})}}(e,l,r,i,s),disabled:!d}):(0,u().Vh)(p)?(0,Y.jsx)(H().A,{title:X({groupBy:p,schema:c}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().ah.map((e=>({key:e,type:"button",title:ne(e)}))),onChange:e=>function(e,t,r,o,a){const n=(0,u().H2)(r.normalizedFormatStore.state,o,a),i=r.collectionViewStore();if(!n||!i)return;const s=J(n);if(s){if((0,u().Vh)(n))w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{_().zA({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t})}});else if("formula"===n.type){const r={...h().cJ(s,"property"),groupBy:e},l={...n,groupBy:r};w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:e=>{_().zA({stores:[i],update:{[o]:l,[a]:void 0},transaction:e})}})}(0,v().X)({environment:t,collectionContextStore:r,action:"update_text_group_by"})}}(e,l,r,i,s),disabled:!d}):"number"===p.type?(0,Y.jsx)(E().A,{title:X({groupBy:p,schema:c}),showChevron:!0,right:ee({groupBy:p,schema:c}),onClick:()=>{C().a2({collectionSettingsStore:o,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:s}})},disabled:!d}):"status"===p.type?(0,Y.jsx)(H().A,{title:X({groupBy:p,schema:c}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().PC.map((e=>{return{key:e,type:"button",title:(t=e,"group"===t?(0,Y.jsx)(m().sA,{...te.group}):"option"===t?(0,Y.jsx)(m().sA,{...te.option}):void(0,f().HB)(t))};var t})),onChange:e=>function(e,t,r,o,a){const n=(0,u().H2)(r.normalizedFormatStore.state,o,a),i=r.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{_().zA({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t})}}),(0,v().X)({environment:t,collectionContextStore:r,action:"update_status_group_by"}))}(e,l,r,i,s),disabled:!d}):null}function ge(e){let{groupBy:t,collectionContextStore:r,groupByKey:o,groupsFormatKey:i}=e;const s=(0,a().v3)(),l=(0,n().K8)((()=>(0,u().Nf)(t)),[t]),c=(0,n().K8)((()=>le(r)),[r]);if(l.length<=1)return null;const d=(0,u().Kq)(t);return(0,Y.jsx)(H().A,{title:(0,Y.jsx)(m().sA,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:d.type,options:l.map((e=>({key:e,type:"button",title:z().A.formatMessage((0,R().rA)(t,e))}))),onChange:e=>{w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:s,canUndo:!0,perform:t=>{(0,b().y)({sortType:e,environment:s,collectionContextStore:r,groupByKey:o,groupsFormatKey:i,transaction:t})}})},disabled:!c})}function ye(e){let{groupBy:t,groupByKey:r,collectionContextStore:i,groupsFormatKey:s,groupsDisplayState:l}=e;const c=(0,a().v3)(),d=(0,o.useCallback)((()=>function(e,t,r,o,a){const n=(0,u().H2)(r.normalizedFormatStore.state,t,o);if(!a)return;const{currentGroups:i}=a,s=r.collectionViewStore();if(!n||!s)return;const l=!n.hideEmptyGroups;w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,canUndo:!0,perform:e=>{if(l){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));(0,x().o)({collectionContextStore:r,newGroups:t,groupsFormatKey:o,transaction:e})}_().zA({stores:[s],update:{[t]:{...n,hideEmptyGroups:l}},transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:r,action:"toggle_hide_empty_groups"})}(c,r,i,s,l)),[c,r,i,s,l]),p=(0,n().K8)((()=>le(i)),[i]);return(0,Y.jsx)(V().A,{title:(0,Y.jsx)(m().sA,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(t.hideEmptyGroups),focused:!1,onClick:d,disabled:!p,textWrapperStyle:{opacity:1}})}function me(e){const t=(0,a().v3)(),{groupFormat:r,canReorder:o,collectionContextStore:i,groupByKey:s,groupsFormatKey:l,groupsDisplayState:c,isLastGroup:d}=e,m=(0,n().O$)(i.normalizedSchemaStore),h=(0,u().tx)(r),f=(0,n().K8)((()=>(0,u().H2)(i.normalizedFormatStore.state,s,l)),[i,s,l]),S=(0,n().K8)((()=>le(i)),[i]);if(!f)return null;const b=d&&!h;return(0,Y.jsx)(K().A,{disabled:!S,title:(0,Y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[o&&(0,Y.jsx)(F().A,{iconSize:12,style:{marginRight:3}}),(0,Y.jsx)(M().A,{groupBy:f,groupFormat:r,currentGroups:(null==c?void 0:c.currentGroups)??[],schema:m,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:i})]}),right:b?null:(0,Y.jsx)(G().A,{icon:h?g().M:p().J,iconStyle:{width:y().Ev.sm,height:y().Ev.sm},isDarkIconColor:!h,onClick:()=>{!function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((t=>(0,u().Mn)(t,e)?{...e,hidden:!(0,u().tx)(e)}:t));w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:t,canUndo:!0,perform:e=>{(0,x().o)({collectionContextStore:r,newGroups:i,groupsFormatKey:o,transaction:e})}}),(0,v().X)({environment:t,collectionContextStore:r,action:"toggle_group_visibility"})}(r,t,i,l,c)},disabled:!S}),textWrapperStyle:{opacity:1}})}function he(e){const t=(0,a().v3)(),{groups:r,canReorder:i,isHidden:s,collectionContextStore:l,groupByKey:c,groupsFormatKey:d,groupsDisplayState:p,disableHideAll:g}=e,y=(0,n().K8)((()=>le(l)),[l]),m=g&&1===r.length,h=r.map((e=>(0,u().Ix)(e)));return i?(0,Y.jsx)(k().Ay,{direction:"vertical",keys:h,renderKey:(e,t)=>{const o=r[t];return(0,Y.jsx)(me,{collectionContextStore:l,groupByKey:c,groupsFormatKey:d,groupsDisplayState:p,groupFormat:o,canReorder:i,isLastGroup:m})},onDrop:e=>{p&&(0,S().r)({newGroupIds:e,isHidden:s,environment:t,collectionContextStore:l,groupByKey:c,groupsFormatKey:d,currentGroups:p.currentGroups})},disabled:!y}):(0,Y.jsx)(Y.Fragment,{children:r.map((e=>(0,Y.jsx)(o.Fragment,{children:(0,Y.jsx)(me,{collectionContextStore:l,groupByKey:c,groupsFormatKey:d,groupsDisplayState:p,groupFormat:e,canReorder:i,isLastGroup:m})},(0,u().Ix)(e))))})}function fe(e){let{collectionContextStore:t,groupsFormatKey:r,groupByKey:s,groupsLimitStore:l,groupsDisplayState:c,disableHideAll:p,disableLoadMore:g,disableReorder:y}=e;const h=(0,i().DP)(),f=(0,a().v3)(),S=(0,o.useCallback)((()=>function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!1})));o.setState(R()._9),w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:e,canUndo:!0,perform:e=>{(0,x().o)({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:t,action:"click_groups_show_all"})}(f,t,r,l,c)),[f,t,r,l,c]),b=(0,o.useCallback)((()=>function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!0})));o.setState(R()._9),w().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:e,canUndo:!0,perform:e=>{(0,x().o)({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:t,action:"click_groups_hide_all"})}(f,t,r,l,c)),[f,t,r,l,c]),C=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,s,r)),[t,s,r]),_=(0,n().K8)((()=>le(t)),[t]),B=(0,n().K8)((()=>(0,R().Z3)({disableReorder:Boolean(y),groupByKey:s,format:t.normalizedFormatStore.state,canConfigureBlock:_,isMobile:f.device.isMobile})),[y,s,t.normalizedFormatStore,_,f.device.isMobile]),M=(0,n().O$)(l);if(!C)return null;if(!c)return(0,Y.jsx)(P().A,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,Y.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,Y.jsx)(j().A,{})})});const k="v2"===c.version?void 0:Math.min(R().B2,c.total-c.hiddenGroups.length-c.visibleGroups.length),F=void 0!==k&&k>0&&!Boolean(g)?(0,Y.jsx)(T().A,{disabled:!1,focused:!1,style:{color:h.mediumTextColor},icon:(0,d()._)({width:14,height:14}),title:(0,Y.jsx)(m().sA,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:k}}),onClick:()=>{t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),l.setState(M+R().B2)}}):void 0;return(0,Y.jsxs)(Y.Fragment,{children:[c.visibleGroups.length>0&&(0,Y.jsxs)(P().A,{topBorder:!0,noTextOverflow:!0,title:(0,Y.jsx)("span",{style:{alignSelf:"center"},children:(0,Y.jsx)(m().sA,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:p?null:(0,Y.jsx)(A().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:b,disabled:!_,children:(0,Y.jsx)(m().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[(0,Y.jsx)(he,{collectionContextStore:t,groupByKey:s,groupsFormatKey:r,groupsDisplayState:c,groups:c.visibleGroups,canReorder:B,isHidden:!1,disableHideAll:p}),F]}),c.hiddenGroups.length>0&&(0,Y.jsx)(P().A,{topBorder:!0,noTextOverflow:!0,title:(0,Y.jsx)(m().sA,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:p?null:(0,Y.jsx)(A().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:S,disabled:!_,children:(0,Y.jsx)(m().sA,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:(0,Y.jsx)(he,{collectionContextStore:t,groupByKey:s,groupsFormatKey:r,groupsDisplayState:c,groups:c.hiddenGroups,canReorder:B,isHidden:!0,disableHideAll:p})})]})}function ve(e){let{groupsFormatKey:t,collectionContextStore:r,groupByKey:o,reducerResultStore:a,groupsLimitStore:i,groupsDisplayState:s}=e;const l=(0,n().O$)(r.normalizedSchemaStore),d=(0,L().X)("collection_group_reducer_visible"),p=(0,n().K8)((()=>(0,u().H2)(r.normalizedFormatStore.state,o,t)),[r,o,t]),g=(0,n().K8)((()=>{if(!p)return;const e=r.normalizedFormatStore.state;return(0,R().p_)({groupBy:p,schema:l,format:e,groupsFormatKey:t,limit:"v2"===(null==s?void 0:s.version)?c().O3:i.state,returnHiddenGroups:!0,aggregation:void 0})}),[p,r.normalizedFormatStore,l,t,s,i]);return p?g?(0,Y.jsx)(B().A,{id:`${u().RO}_${t}`,reducer:g,collectionContextStore:r,resultStore:a,render:()=>d?(0,Y.jsx)(I().L,{collectionContextStore:r,groupBy:p,groupByKey:o,groupsFormatKey:t,groupsDisplayState:s}):(0,Y.jsx)(fe,{collectionContextStore:r,groupsFormatKey:t,groupByKey:o,groupsLimitStore:i,groupsDisplayState:s})}):"v2"===(null==s?void 0:s.version)?(0,Y.jsx)(I().L,{collectionContextStore:r,groupBy:p,groupByKey:o,groupsFormatKey:t,groupsDisplayState:s}):(0,Y.jsx)(fe,{collectionContextStore:r,groupsFormatKey:t,groupByKey:o,groupsLimitStore:i,groupsDisplayState:s}):null}},818367:(e,t,r)=>{r.d(t,{x:()=>a});var o=()=>r(508496);function a(){return o().default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},828973:(e,t,r)=>{r.d(t,{A:()=>p});r(898992),r(672577),r(581454);var o=r(296540),a=()=>r(56366),n=()=>r(496603),i=()=>r(406699),s=()=>r(939740),l=()=>r(14235),u=()=>r(89924),c=()=>r(722872),d=r(474848);const p=function(e){let{icon:t,iconStyle:p,title:g,selectedKey:y,onChange:m,onClick:h,popupStyle:f,menuItemOptionsStyle:v,menuStyle:S,disabled:b,collectionContextStore:x,openButtonPopup:C,hideCheck:_,children:w,disableParentClose:B,inputPlaceholder:M,...A}=e;const T=(0,r(484714).Y0)(),k="options"in A?A.options:n().Bq(A.sections),F=k.find((e=>n().n4(e.key,y))),G=(0,a().uB)(void 0,r(463830).A),j=(0,a().O$)(G);return(0,o.useEffect)((()=>{x&&C&&(G.setState({...G.state,open:C}),x.settingsStore.setState({...x.settingsStore.state,openButtonPopup:void 0})),F||r(857639).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,r(229833).n6)("Selected key is invalid.")})})),(0,d.jsx)(i().Ay,{popupType:T.isMobile?l().nl.SlideUp:l().nl.Popup,alignmentToOrigin:i().yP.End,placementToOrigin:i().sx.Bottom,style:f,originGap:0,buttonPopupStore:G,disabled:b,onClick:h,renderOrigin:e=>(0,d.jsx)(r(497222).A,{title:g,showChevron:!0,right:(0,d.jsx)("span",{style:r(284371).RC,children:"input"===(null==F?void 0:F.type)?F.inputValue:null==F?void 0:F.title}),rotateChevron:j.open,disabled:b,icon:t,iconStyle:p,...(0,r(553965).A)(e,A)}),render:e=>{let t;t=T.isMobile?{menuType:c().gu.ActionSheet}:{menuType:c().gu.Popup,width:250,...S};const o=(t,o)=>{if(t.hideOption)return null;let a;return a="input"===t.type?{key:o,render:o=>(0,d.jsx)(r(419357).Ay,{...o,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var r;null===(r=t.onChange)||void 0===r||r.call(t,e.target.value)},onSubmit:r=>{var o;null===(o=t.onSubmit)||void 0===o||o.call(t,t.key,e,t.inputValue),e.close()},placeholder:M,checkState:!_&&n().n4(t.key,y)}),action:()=>{}}:{key:o,render:e=>(0,d.jsx)(r(760217).A,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:v,checkState:!_&&n().n4(t.key,y)}),action:()=>{m(t.key,e),B||e.close()}},a},a="sections"in A?A.sections.map(((e,t)=>({key:t,render:e=>(0,d.jsx)(u().A,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:n().oE(e.map(o))}))):[{key:0,render:e=>(0,d.jsx)(u().A,{enableActionSheetTitle:!0,...e}),items:n().oE(k.map(o))}];return(0,d.jsxs)(r(928600).A,{...t,children:[(0,d.jsx)(s().Ay,{type:s().Oh.Vertical,sections:a,initialFocus:0,resetFocusOnMouseOut:!0}),w||null]})}})}},844698:(e,t,r)=>{r.d(t,{jJ:()=>a,nb:()=>n,wh:()=>o});const o="ungrouped_chart_results",a="grouped_chart_results",n="aggregation_chart_results"},941814:(e,t,r)=>{r.d(t,{H4:()=>i,dP:()=>n,hk:()=>s});var o=()=>r(452706),a=()=>r(508496);function n(){const e=a().default.getConfigKey("charts_query_collection_limits","max_results_reducer_limit");return e||o().aF}function i(){const e=a().default.getConfigKey("charts_query_collection_limits","max_subgroups_reducer_limit");return e||o().i$}function s(){const e=a().default.getConfigKey("charts_query_collection_limits","max_groups_reducer_limit");return e||o().O3}}}]);