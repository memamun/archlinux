"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5396],{72645:(e,t,o)=>{o.d(t,{b:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("plusMedium",{viewBox:"0 0 16 16",svg:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M2 8a.77.77 0 01.237-.566.762.762 0 01.566-.244h4.394V2.803a.77.77 0 01.237-.566A.773.773 0 018 2c.225 0 .416.079.573.237a.773.773 0 01.237.566V7.19h4.387c.22 0 .409.081.566.244A.773.773 0 0114 8a.781.781 0 01-.237.573.785.785 0 01-.566.23H8.81v4.401a.764.764 0 01-.237.56A.781.781 0 018 14a.773.773 0 01-.566-.237.764.764 0 01-.237-.559V8.803H2.803a.785.785 0 01-.566-.23A.781.781 0 012 8z"})})})},173215:(e,t,o)=>{o.d(t,{x:()=>l});var n=()=>o(484714),r=()=>o(56366),i=()=>o(401497),a=()=>o(712030),s=()=>o(921855);function l(e){let{textStore:t,parentStore:o,spaceId:l,disabled:d=!1}=e;const c=(0,n().v3)(),u=(0,i().DP)(),p=(0,a().Ol)(),m=(0,r().K8)((()=>c.KatexStore.getKatex()),[c.KatexStore]);return(0,r().K8)((()=>{const e=null==t?void 0:t.getValue();return e&&l&&o?s().S5({environment:c,textValue:{value:e,spaceId:l},parentStore:o,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:!0,disabled:d,theme:u,disableLinks:d,emojiType:p,katex:m,formulaValueTypes:[]}):null}),[d,p,c,m,o,l,t,u])}},343168:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().default{getInitialState(){return{openTooltip:void 0}}}const r=new n},435930:(e,t,o)=>{o.d(t,{s:()=>a});const n={id:"pageLayoutEditor.property",defaultMessage:"Property",description:"Label for the property section in the page layout editor"},r={id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Heading",description:"Label for the titleWithIcon section in the page layout editor"},i={id:"pageLayoutEditor.collectionView",defaultMessage:"Database View",description:"Label for the form submit button section in the form page layout editor"},a=(0,o(959013).YK)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Property group"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Content"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"},views:{id:"pageLayoutEditor.views",defaultMessage:"Views"},viewsMain:{id:"pageLayoutEditor.views",defaultMessage:"Views"},relationsGroup:{id:"pageLayoutEditor.relationsGroup",defaultMessage:"Relations group"},formTitle:{id:"pageLayoutEditor.formTitle",defaultMessage:"Form Title"},formQuestion:{id:"pageLayoutEditor.formQuestion",defaultMessage:"Form Question"},formSubmit:{id:"pageLayoutEditor.formSubmit",defaultMessage:"Form Submit"},placeholder:{id:"pageLayoutEditor.placeholder",defaultMessage:"New"},normalizedTitleWithIcon:r,titleWithIcon:r,deleted_property:n,property_number:n,property_title:n,property_person:n,property_file:n,property_text:n,property_checkbox:n,property_url:n,property_email:n,property_phone_number:n,property_created_by:n,property_last_edited_by:n,property_button:n,property_select:n,property_multi_select:n,property_status:n,property_date:n,property_created_time:n,property_last_edited_time:n,property_last_visited_time:n,property_relation:n,property_rollup:n,property_formula:n,property_auto_increment_id:n,property_location:n,property_verification:n,property_geo_point:n,property:n,collectionView:i,collectionViewV2:i})},471095:(e,t,o)=>{o.d(t,{i:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},r=(0,o(340498).wt)("lockFill",n)},524060:(e,t,o)=>{o.d(t,{O:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("parentChildRelation",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{fillRule:"evenodd",d:"M6 6.75a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5m.625 1.171a2.501 2.501 0 1 0-1.25 0V11A3.625 3.625 0 0 0 9 14.625h3.079a2.5 2.5 0 1 0 0-1.25H9A2.375 2.375 0 0 1 6.625 11zM14.5 15.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})})},590856:(e,t,o)=>{o.d(t,{y:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("collectionForm",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M5.50195 4.75635C5.37435 4.75635 5.26953 4.71305 5.1875 4.62646C5.10547 4.53988 5.06445 4.43734 5.06445 4.31885C5.06445 4.1958 5.10547 4.09326 5.1875 4.01123C5.26953 3.9292 5.37435 3.88818 5.50195 3.88818H10.5059C10.6289 3.88818 10.7314 3.9292 10.8135 4.01123C10.8955 4.09326 10.9365 4.1958 10.9365 4.31885C10.9365 4.43734 10.8955 4.53988 10.8135 4.62646C10.7314 4.71305 10.6289 4.75635 10.5059 4.75635H5.50195ZM5.50195 7.0874C5.37435 7.0874 5.26953 7.04639 5.1875 6.96436C5.10547 6.87777 5.06445 6.77295 5.06445 6.6499C5.06445 6.53141 5.10547 6.43115 5.1875 6.34912C5.26953 6.26709 5.37435 6.22607 5.50195 6.22607H10.5059C10.6289 6.22607 10.7314 6.26709 10.8135 6.34912C10.8955 6.43115 10.9365 6.53141 10.9365 6.6499C10.9365 6.77295 10.8955 6.87777 10.8135 6.96436C10.7314 7.04639 10.6289 7.0874 10.5059 7.0874H5.50195ZM5.50195 9.42529C5.37435 9.42529 5.26953 9.38428 5.1875 9.30225C5.10547 9.22021 5.06445 9.11995 5.06445 9.00146C5.06445 8.87842 5.10547 8.77588 5.1875 8.69385C5.26953 8.60726 5.37435 8.56396 5.50195 8.56396H7.92188C8.04948 8.56396 8.1543 8.60726 8.23633 8.69385C8.31836 8.77588 8.35938 8.87842 8.35938 9.00146C8.35938 9.11995 8.31836 9.22021 8.23633 9.30225C8.1543 9.38428 8.04948 9.42529 7.92188 9.42529H5.50195ZM2.13867 13.1577V2.84229C2.13867 2.10856 2.32552 1.55257 2.69922 1.17432C3.07292 0.791504 3.62663 0.600098 4.36035 0.600098H11.6406C12.3743 0.600098 12.9281 0.791504 13.3018 1.17432C13.6755 1.55257 13.8623 2.10856 13.8623 2.84229V13.1577C13.8623 13.896 13.6755 14.4543 13.3018 14.8325C12.9281 15.2108 12.3743 15.3999 11.6406 15.3999H4.36035C3.62663 15.3999 3.07292 15.2108 2.69922 14.8325C2.32552 14.4543 2.13867 13.896 2.13867 13.1577ZM3.48535 13.0757C3.48535 13.3901 3.56738 13.6317 3.73145 13.8003C3.89551 13.9689 4.14388 14.0532 4.47656 14.0532H11.5312C11.8639 14.0532 12.1123 13.9689 12.2764 13.8003C12.4404 13.6317 12.5225 13.3901 12.5225 13.0757V2.93115C12.5225 2.61214 12.4404 2.36833 12.2764 2.19971C12.1123 2.02653 11.8639 1.93994 11.5312 1.93994H4.47656C4.14388 1.93994 3.89551 2.02653 3.73145 2.19971C3.56738 2.36833 3.48535 2.61214 3.48535 2.93115V13.0757Z"})})},630960:(e,t,o)=>{o.d(t,{i:()=>s,y:()=>a});o(898992),o(354520),o(581454);var n=()=>o(56366),r=()=>o(31503),i=()=>o(534177);const a=(0,o(959013).YK)({unsupportedPublicQuestionType:{defaultMessage:"This question type cannot be used in public forms.",id:"useNewQuestionPropertyMenuItems.invalidPublicQuestionType"},relatedCollectionNotPublic:{defaultMessage:"Only relations to public databases are supported in public forms.",id:"formEditorQuestion.relatedCollectionNotPublic"},editorPlaceholder:{defaultMessage:"Respondent's answer",id:"formEditorQuestion.editorPlaceholder"},viewerEmptyPlaceholder:{defaultMessage:"Your answer",id:"formEditorQuestion.viewerEmptyPlaceholder"}});function s(e){let{layoutStore:t,collectionStore:o}=e;const a=(0,n().K8)((()=>o?t.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:o.getSchema()})??[]:[]),[t,o]),s=(0,n().K8)((()=>a.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(i().O9)),[a]);return(0,n().K8)((()=>{if(!o)return[];const e=o.getSchema();if(!t.getModel())return[];return(0,i().WP)(e).map((e=>{let[t,o]=e;if(o&&(0,r().Sg)(o)&&!s.includes(t))return t})).filter(i().O9)}),[o,t,s])}},854593:(e,t,o)=>{o.d(t,{q:()=>y});o(944114),o(296540);var n=()=>o(959013),r=()=>o(284371),i=()=>o(521358),a=()=>o(16006),s=()=>o(685889),l=()=>o(470928),d=()=>o(290966),c=()=>o(204067),u=()=>o(27732),p=()=>o(901389),m=()=>o(317909),f=o(474848);async function y(e){const{environment:t,collectionContextStore:o,property:y,handleDeleteAccept:g}=e,v=o.collectionStore();if(!v)return;if(v.isTypedProperty(y)){if(await i().nD({environment:t,property:y,collectionContextStore:o,theme:e.theme,from:e.from}))return}const h=(0,c().R5)({environment:t,collectionStore:v,propertyId:y});if(h.length>0){if((0,d().E_)({environment:t,collectionStore:v,propertyId:y,compoundTemplateInstancesToDelete:h,collectionContextStore:o,from:e.from}))return}else if(((0,l().k$)(y)||(0,l().Do)({collectionStore:v,propertyId:y}))&&(0,l().aF)(v)&&(0,l().Io)()){if((0,d().I5)({environment:t,collectionStore:v,propertyId:y,collectionContextStore:o,from:e.from}))return}const S=o.normalizedSchemaStore.state,C=S[y],b=s().pg(o,C);await(null==b?void 0:b.load());const _=b&&s().D5(o,y,b),I=b&&s().uf(b),A=b&&v.id===b.id,w=[{label:(0,f.jsx)(n().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let x;if(_&&v&&I&&!A&&w.push({label:(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{m().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(C&&"relation"===C.type&&C.property&&b){const o=C.property,n=b.getSchema();u().C4({environment:t,collectionStore:b,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:v.isSyncedCollection()&&!b.isSyncedCollection()?{enabled:!1}:C.autoRelate,transaction:e})}u().t$({environment:t,collectionStore:v,property:y,transaction:e})}})}}),"auto_increment_id"===(null==C?void 0:C.type))x=s().me(S)?(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==C?void 0:C.type)){const e=s().AX(S);if(e){const t=e.connectedRelation.automation;t&&t[y]&&(x=(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else b&&I&&!A&&_&&(x=(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,f.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.medium},store:b})}}));p().ui({message:(0,f.jsx)("span",{children:(0,f.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,f.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.bold},shouldWrap:!0,store:v})}})}),description:x,showCancel:!0,keepFocus:!0,items:w,mode:"wide"})}},894995:(e,t,o)=>{o.r(t),o.d(t,{FORMS_SHARE_CALLOUT_KEY:()=>J,changeFormClosedState:()=>ce,changeFormSubmissionPermissions:()=>ue,createAndFocusCollectionFormEditorView:()=>ne,createCollectionFormEditorView:()=>re,createDummyFormPage:()=>ye,createFormInPrivate:()=>ie,createFormQuestion:()=>se,createFormQuestionAndModuleForNewlyDuplicatedProperty:()=>le,createFormQuestionAndUpdateOrCreateModule:()=>de,createResponsesCollectionView:()=>ae,handleUpdateFormQuestionName:()=>ee,incrementAndTrackUserFormsCreated:()=>X,maybeAlertAboutUnsupportedPublicQuestions:()=>ge,maybeSyncQuestionNameToPropertyName:()=>te,remapQuestionToNewProperty:()=>fe,toggleAnonymousFormSubmissionState:()=>pe,toggleNotionBrandingState:()=>me});o(16280),o(944114),o(898992),o(354520),o(672577),o(803949),o(296540);var n=()=>o(401497),r=()=>o(584262),i=()=>o(700500),a=()=>o(31503),s=()=>o(970013),l=()=>o(713998),d=()=>o(110192),c=()=>o(416504),u=()=>o(261164),p=()=>o(590856),m=()=>o(29118),f=()=>o(235692),y=()=>o(388821),g=()=>o(450648),v=()=>o(179034),h=()=>o(869558),S=()=>o(37165),C=()=>o(144081),b=()=>o(919709),_=()=>o(959013),I=()=>o(498212),A=()=>o(183558),w=()=>o(284371),x=()=>o(235191),M=()=>o(669548),T=()=>o(901389),P=()=>o(896628),Q=()=>o(246826),F=()=>o(857783),E=()=>o(185544),N=()=>o(317909),k=()=>o(755199),V=()=>o(478251),R=()=>o(180762),D=()=>o(989423),L=()=>o(389658),B=()=>o(682146),j=()=>o(594794),H=()=>o(972435),z=()=>o(465425),U=()=>o(978846),q=()=>o(33218),W=()=>o(351360),O=()=>o(508496),K=()=>o(343168),G=()=>o(611371),Z=()=>o(465741),Y=o(474848);const $=(0,_().YK)({responsesViewName:{id:"formEditorActions.responsesViewName",defaultMessage:"Responses"},newFormViewName:{id:"formEditorActions.newFormViewName",defaultMessage:"Form builder"},formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}}),J="forms_share_form_tooltip";function X(e,t){const{currentUserSettingsStore:o}=W().default.state;if(!o)return;const n=function(){const{currentUserSettingsStore:e}=W().default.state;if(!e)return;return e.getSettingsStore().getKeyStore("user_forms_created_count").getValue()??0}();void 0!==n&&(k().mJ({userSettingsStore:o,transaction:t,data:{user_forms_created_count:n+1}}),function(e,t){(0,D().u4)({environment:e,event:{eventName:"form_created",eventProperties:{user_total_form_count:t.userFormsCreatedCount}}})}(e,{userFormsCreatedCount:n+1})),O().default.logEvent("form_created")}function ee(e){var t;const{questionStore:o,newName:n,environment:r,collectionStore:i,collectionSchema:a,collectionContextStore:s}=e,l=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!l)throw new Error("No property ID found for question");N().createAndCommit({userAction:"formQuestion.changeName",environment:r,canUndo:!0,perform:e=>{var t,r;const d=null===(t=o.getConfig())||void 0===t?void 0:t.name;if(!d)return;const u=(0,g().r4)({textValue:d,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:H().A.getIntl()})===(null===(r=a[l])||void 0===r?void 0:r.name);N().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","name"],command:"set",args:[[n]]},transaction:e}),o.shouldSyncQuestionNameToPropertyName()&&(u&&!(0,B().fE)({property:l,collectionContextStore:s,newValue:n})?x().YO({collectionStore:i,property:l,name:n,transaction:e}):N().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!1},transaction:e}))}})}function te(e){var t;const{questionStore:o,environment:n,collectionStore:r,collectionContextStore:i}=e,a=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!a)throw new Error("No property ID found for question");N().createAndCommit({userAction:"formQuestion.changeName",environment:n,canUndo:!0,perform:e=>{if(!o.shouldSyncQuestionNameToPropertyName())return;const t=o.getNameStore().getValue();if(!t)return;const n=(0,g().r4)({textValue:t,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:H().A.getIntl()}),s=(0,B().fE)({property:a,collectionContextStore:i,newValue:n})?(0,d().Q)(n):n;x().YO({collectionStore:r,property:a,name:s,transaction:e})}})}function oe(){const e=(0,n().IS)((e=>({container:{display:"flex",flexDirection:"column"},iconGroup:{display:"flex",flexDirection:"row",justifyContent:"center",color:e.icon.secondary,alignItems:"center"},dialogTitle:{fontSize:16,fontWeight:w().Wy.semibold,lineHeight:"22px",marginTop:12,marginBottom:12},dialogDescription:{color:e.text.secondary,fontSize:14,lineHeight:"20px"}})),[]);return(0,Y.jsxs)("div",{style:e.container,children:[(0,Y.jsxs)("div",{style:e.iconGroup,children:[(0,m().K)({width:24}),(0,u().o)({width:16,marginLeft:16,marginRight:14}),(0,p().y)({width:24})]}),(0,Y.jsx)("span",{style:e.dialogTitle,children:(0,Y.jsx)(_().sA,{defaultMessage:"Auto-create form questions based on existing properties?",id:"NewFormOnExistingCollectionDialogTitle.message"})}),(0,Y.jsx)("span",{style:e.dialogDescription,children:(0,Y.jsx)(_().sA,{defaultMessage:"Only supported property types will create new questions.",id:"NewFormOnExistingCollectionDialogTitle.description"})})]})}function ne(e){const{environment:t,collectionContextStore:o,transaction:n}=e,r=o.collectionViewBlockStore(),i=o.collectionStore();if(!r||!i)return;const s=o.normalizedSchemaStore.state,l=re({environment:t,collectionViewBlockStore:r,schema:s,transaction:n,initializeWithAllDefaultQuestions:!1});if(!l)return;(0,R().t)({environment:t,collectionContextStore:o,collectionViewId:l.newViewId,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state});const d=l.layoutStore,c=Object.keys(s).filter((e=>{const t=s[e];return"title"!==e&&t&&(0,a().Sg)(t)}));c.length>0&&c.length<=Z().eb&&T().ui({showCancel:!1,keepFocus:!1,message:(0,Y.jsx)(oe,{}),mode:"wide",items:[{label:(0,Y.jsx)(_().sA,{defaultMessage:"Create {numQuestions, plural, one {1 question} other {{numQuestions} questions}}",id:"formEditorActions.createQuestions.primaryAction",values:{numQuestions:c.length}}),color:"blue",buttonType:"solid",onAccept(){N().createAndCommit({environment:t,userAction:"formActions.autoCreateFormQuestionsForExistingDatabase",canUndo:!0,perform:e=>{for(const n of c)le({environment:t,transaction:e,layoutStore:d,collectionStore:i,propertyId:n,position:{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},addLayoutModule:o=>{(0,U().UQ)({environment:t,sessionId:(0,I().Ay)(),layoutStore:d,position:o.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},module:o.layoutModule,transaction:e,isPropertyCreation:!1})},collectionContextStore:o,shouldLogEvent:!0,autoCreatedFromExistingDatabase:!0})}})}},{label:(0,Y.jsx)(_().sA,{defaultMessage:"Start from scratch",id:"formEditorActions.createQuestions.secondary"}),color:"gray",buttonType:"plain",onAccept(){}}]})}function re(e){const{environment:t,collectionViewBlockStore:o,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}=e;if(!o)return;const l=o.getSpaceId(),{formBlockStore:d,layoutStore:c}=function(e){var t;const{environment:o,spaceId:n,inMemoryRecordCache:r,transaction:i,schema:l,initializeWithAllDefaultQuestions:d}=e,c=Object.keys(l).find((e=>{var t;return"multi_select"===(null===(t=l[e])||void 0===t?void 0:t.type)})),u=Boolean(d&&void 0!==c),p=(0,j().Z1)({environment:o,table:v().ev,spaceId:n}),m=(0,j().Z1)({environment:o,table:S().lo,spaceId:n}),y=u?(0,j().Z1)({environment:o,table:S().lo,spaceId:n}):void 0,g=Q().Wv({id:p,environment:o,type:"form",permissions:(0,a().eb)(),inMemoryRecordCache:r,transaction:i}),h=Q().eC({environment:o,table:C().zx,value:{space_id:n,parent_table:v().ev,parent_id:g.id,modules:(0,f().oP)(m,y)},inMemoryRecordCache:r,transaction:i});var b,_;P().zA({stores:[g],update:{form_layout_pointer:{id:h.id,spaceId:n,table:C().zx}},transaction:i}),se({environment:o,questionId:m,spaceId:n,layoutId:h.id,propertyId:s().rn,initialQuestionTitle:(null===(t=l[s().rn])||void 0===t?void 0:t.name)??"",inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1}),u&&y&&c&&se({environment:o,questionId:y,spaceId:n,layoutId:h.id,propertyId:c,initialQuestionTitle:(null===(b=l[c])||void 0===b?void 0:b.name)??"",existingFormQuestionConfig:{propertyId:c,name:[[(null===(_=l[c])||void 0===_?void 0:_.name)??""]],propertyTypeSpecificConfig:{multi_select:{maxSelectionCount:1}}},inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1});return{formBlockStore:g,layoutStore:h}}({environment:t,spaceId:l,inMemoryRecordCache:o.inMemoryRecordCache,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}),u=(0,V().i)({environment:t,collectionViewBlockStore:o,collectionView:{type:"form_editor",parent_id:o.id,parent_table:v().ev,alive:!0,space_id:l,name:H().A.formatMessage($.newFormViewName),format:{form_block_pointer:{id:d.id,spaceId:l,table:v().ev}}},transaction:n});return Q().zv({store:d,data:{parent_id:u.id,parent_table:h().Gy,alive:!0},transaction:n}),K().A.setState({openTooltip:u.id}),z().HH(t,J),X(t,n),{newViewId:u.id,layoutStore:c,formId:d.id}}function ie(e){const{environment:t,navigateToFormBuilder:o}=e,{currentSpaceStore:n,currentSpaceViewStore:i}=W().default.state;if(!n||!i)return;if(!(0,G().EF)(t))return void(0,G().QY)(t);if(!(n&&n.canEdit()&&i))return;const a=n.id,s=t.idCreator.getSpaceIdCreatorSync(a);N().createAndCommit({environment:t,userAction:"formActions.createAndNavigateToFormInPrivate",canUndo:!0,perform:e=>{var l;const{targetBlockStore:d}=M().j({environment:t,sourceBlockId:"root",targetBlockPointer:(0,j().zP)({environment:t,table:v().ev,spaceId:a}),sourceBlockSubtree:(0,y().partialRecordMapToRecordMap)(L().mT({isInline:!0,name:(0,b().x9d)(H().A.formatMessage($.formDatabaseTitle))})),targetRecordCache:n.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:s}),c=d.getCollectionStore(),u=null==c||null===(l=c.getModel())||void 0===l?void 0:l.getNormalizedSchema(),p=d;if(!u)throw new Error("Schema not found");re({environment:t,transaction:e,collectionViewBlockStore:p,schema:u,initializeWithAllDefaultQuestions:!0}),ae({environment:t,transaction:e,collectionViewBlockStore:p,schema:u}),E().yM({environment:t,spaceStore:n,spaceViewStore:i,pageStore:d,isPrivate:!0,transaction:e,location:{type:"prepend"}}),o&&F().uK({environment:t,store:d,pageVisitSource:r().y8.CreateFormDeepLink})}})}function ae(e){const{environment:t,collectionViewBlockStore:o,transaction:n}=e,r=o.getSpaceId(),i=Object.keys(e.schema).find((t=>{var o;return"created_by"===(null===(o=e.schema[t])||void 0===o?void 0:o.type)}));(0,V().i)({environment:t,collectionViewBlockStore:o,collectionView:{type:"table",parent_id:o.id,parent_table:v().ev,alive:!0,name:H().A.formatMessage($.responsesViewName),space_id:r,format:{table_properties:[{property:"title",visible:!0},...i?[{property:i,visible:!0}]:[]],table_wrap:!0,collection_pointer:o.getCollectionPointer()}},transaction:n})}function se(e){const{environment:t,questionId:o,spaceId:n,layoutId:r,propertyId:i,initialQuestionTitle:a,inMemoryRecordCache:s,transaction:l,shouldSyncQuestionNameToPropertyName:d,collectionContextStore:c,shouldLogEvent:u=!0,autofocusTitle:p,existingFormQuestionConfig:m,autoCreatedFromExistingDatabase:f}=e;Q().eC({environment:t,table:S().lo,value:{id:o,space_id:n,parent_table:C().zx,parent_id:r,alive:!0,config:{...m,propertyId:i,name:[[a]],shouldSyncQuestionNameToPropertyName:d}},inMemoryRecordCache:s,transaction:l}),u&&(0,D().u4)({environment:t,event:{eventName:"add_form_question",eventProperties:{...(0,Z().YA)({collectionContextStore:c,propertyId:i,questionId:o}),auto_created_from_existing_database:Boolean(f)}}}),p&&p.autofocusedQuestionTextStore.autofocusQuestionTitle({questionId:o})}function le(e){const{environment:t,transaction:o,layoutStore:n,collectionStore:r,propertyId:i,position:a,addLayoutModule:s,collectionContextStore:l,shouldLogEvent:d=!0,autofocusTitle:c,existingFormQuestionConfig:u,autoCreatedFromExistingDatabase:p}=e,m=r.getSchema()[i];if(!m)throw new Error(`No schema found for property ${i}`);const f=u?(0,b().q4_)(null==u?void 0:u.name):m.name,y=n.getSpaceId(),g=(0,j().Z1)({environment:t,table:S().lo,spaceId:y});return se({environment:t,questionId:g,spaceId:y,layoutId:n.id,propertyId:i,initialQuestionTitle:f,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:d,collectionContextStore:l,autofocusTitle:c,existingFormQuestionConfig:u,autoCreatedFromExistingDatabase:p}),s({layoutModule:{type:"formQuestion",id:(0,A().Ay)(),formQuestionId:g},position:a,transaction:o}),{questionId:g}}function de(e){const{environment:t,transaction:o,layoutStore:n,propertyId:r,initialQuestionTitle:i,moduleId:a,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d,area:c,sessionId:u}=e,p=n.getModel();if(!p)throw new Error("Layout model cannot be undefined");const m=n.getSpaceId(),f=(0,j().Z1)({environment:t,table:S().lo,spaceId:m});se({environment:t,questionId:f,spaceId:m,layoutId:p.id,propertyId:r,initialQuestionTitle:i,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d});const y={type:"formQuestion",id:a??(0,A().Ay)(),formQuestionId:f,..."form_conditional_modules"===c?{parentModuleId:e.parentModuleId,parentConditionalGroupId:e.parentConditionalGroupId}:{}};return a?(0,q().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:c,moduleId:a},updatedModule:y}):"form_conditional_modules"===c&&(0,U().UQ)({environment:t,transaction:o,layoutStore:n,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e.parentConditionalGroupId,parentModuleId:e.parentModuleId},module:y,sessionId:u,isPropertyCreation:!1}),{updatedModuleId:y.id,formQuestionId:f}}function ce(e){let{environment:t,formBlockStore:o,isClosed:n}=e;o.getIsFormClosed()!==n&&N().createAndCommit({userAction:"formActions.changeFormClosedState",environment:t,canUndo:!0,perform:e=>{P().zA({stores:[o],update:{form_config:{...o.getFormConfig(),is_form_closed:n}},transaction:e})}})}function ue(e){let{environment:t,formBlockStore:o,permissions:n}=e;o.getFormSubmissionPermissions()!==n&&N().createAndCommit({userAction:"formActions.changeFormSubmissionPermissions",environment:t,canUndo:!0,perform:e=>{P().zA({stores:[o],update:{form_config:{...o.getFormConfig(),submission_permissions:n}},transaction:e})}})}function pe(e){let{environment:t,formBlockStore:o}=e;const n=o.getIsFormAnonymousSubmissionEnabled();N().createAndCommit({userAction:"formActions.changeAnonymousFormSubmissionState",environment:t,canUndo:!0,perform:e=>{P().zA({stores:[o],update:{form_config:{...o.getFormConfig(),anonymous_submissions:!n}},transaction:e})}})}function me(e){var t;let{environment:o,formBlockStore:n}=e;const r=n.getSiteStore();if(!r)return;const i=(null===(t=r.getHeader())||void 0===t?void 0:t.hideWatermark)??!1;N().createAndCommit({userAction:"formBlockStore.publicForm.toggleNotionBranding",environment:o,canUndo:!0,perform:e=>{N().applyOperation({store:r,operation:{pointer:r.pointer,path:["header","hideWatermark"],command:"set",args:!i},transaction:e})}})}function fe(e){let{environment:t,newPropertyId:o,formQuestionStore:n}=e;N().createAndCommit({userAction:"formQuestion.remapQuestionToNewProperty",environment:t,canUndo:!0,perform:e=>{N().applyOperation({store:n,operation:{pointer:n.pointer,path:["config","propertyId"],command:"set",args:o},transaction:e})}})}function ye(e){const{environment:t,collectionSchema:o,temporaryRecordCache:n,spaceId:r,collectionId:a,formMode:s}=e,l={};Object.keys(o).forEach((e=>{l[e]=(0,b().x9d)("")}));const{performResult:d}=N().createAndCommit({environment:t,userAction:"formActions.createDummyFormPage",perform:e=>{const o=Q().Wv({environment:t,type:i().xd.page,inMemoryRecordCache:n,transaction:e,spaceId:r,properties:{...l}});return Q().zv({store:o,data:{alive:"viewer"===s,parent_id:a,parent_table:"collection"},transaction:e}),o},canUndo:!1});return d}async function ge(e){const{environment:t,formBlockStore:o,collectionSchema:n,theme:r,onAccept:i}=e;if(!n)return;const a=(0,Z().Dx)(o),s=(null==a?void 0:a.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:n}))??[],d=[];if(s.forEach((e=>{const o=e.getPropertyId();if(!o)return;const r=(0,l()._g)({schema:n,property:o}),i=null==r?void 0:r.type;if(!i)return;(0,Z().CK)({environment:t,propertyType:i,propertySchema:r,isPublicForm:!0})&&d.push(e)})),0===d.length)return void i();const u=d.map(((e,t)=>{const o=(0,g().r4)({textValue:e.getNameStore().getValue(),getRecordModel:e.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:H().A.getIntl()}),n=t===d.length-1;return(0,Y.jsx)("div",{style:{fontSize:14,textAlign:"start",padding:"8px 12px",borderBottom:n?void 0:`1px solid ${r.lightDividerColor}`},children:o},e.id)})),{accept:p}=await T().Gh({message:(0,Y.jsx)(_().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.message",defaultMessage:"These questions are not supported in public forms and will not be shown to respondents:"}),description:(0,Y.jsx)("div",{style:{borderRadius:6,border:`1px solid ${r.lightDividerColor}`,width:"calc(100% + 24px)",marginLeft:-12,marginTop:12,maxHeight:210,overflow:"auto"},children:u}),acceptLabel:(0,Y.jsx)(_().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.acceptLabel",defaultMessage:"Got it"}),acceptColor:"blue",cancelButtonType:"plain",mode:"wide"});p&&i()}}}]);