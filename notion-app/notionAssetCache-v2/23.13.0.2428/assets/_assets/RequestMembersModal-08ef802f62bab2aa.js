"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5053,35599,43647,77282,78984],{346:(e,t,n)=>{n.d(t,{MG:()=>m,T1:()=>g,a1:()=>S,dt:()=>h,kg:()=>f,lC:()=>b,n_:()=>v});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(187174),a=()=>n(645873),l=()=>n(941463),c=()=>n(441199),d=()=>n(749687),u=()=>n(737230),p=()=>n(756114);const g=new(a().O2)("PerformanceToolbar",(()=>Promise.all([n.e(23806),n.e(16471),n.e(47123),n.e(17989),n.e(56985),n.e(48680),n.e(45624)]).then(n.bind(n,140401)))),m=(0,a()._h)(g,(e=>e.PerformanceToolbar)),h=(0,a()._h)(g,(e=>e.PerformanceToolbarSettings));function f(){const e=(0,i().v3)();return(0,s().K8)((()=>(0,p().D)(e,e.RouterStore.state)),[e])}function v(){const e=(0,i().v3)(),t=y("PerformanceToolbarStore"),n=y("isPerformanceToolbarVisible");return(0,s().K8)((()=>!(!t||!n)&&n(e,e.RouterStore.state,t.state)),[n,e,t])}function b(){const e=y("PerformanceToolbarStore");return(0,s().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function S(){const e=(0,i().v3)(),t=y("createPerformanceToolbarMouseListeners"),n=y("PerformanceToolbarStore"),{sidebarExpanded:r,sidebarWidth:a,secondarySidebarExpanded:p,secondarySidebarWidth:g,updateSidebarExpanded:m,updateSidebarWidth:h}=(0,s().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,o.useEffect)((()=>{if(n&&t)return t(e,(e=>n.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),r,a,p,g,m,h)}),[t,e,n,r,a,p,g,m,h])}function y(e){const t=f(),[{value:n}]=(0,r().Yb)((()=>t?g.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return n}},43972:(e,t,n)=>{n.d(t,{w:()=>l});n(296540);var o=()=>n(764880),i=()=>n(534177),s=()=>n(256863),r=()=>n(453697),a=n(474848);function l(e){const{actor:t}=e,n={size:e.size??14,style:{marginRight:2,...e.style}};return(0,o().H3)(t)?(0,a.jsx)(s().A,{botValue:t.asActor,...n}):(0,o().ps)(t)?(0,a.jsx)(r().A,{userValue:t.asActor,...n}):(0,o().h2)(t)?(0,a.jsx)(r().A,{userValue:void 0,...n}):void(0,i().HB)(t)}},51367:(e,t,n)=>{n.d(t,{DL:()=>r,Sq:()=>l,Y5:()=>a,gc:()=>d,wo:()=>c});var o=()=>n(917629),i=()=>n(989423),s=()=>n(508496);function r(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,i().u4)({environment:e,event:{eventName:"callout_show",eventProperties:t}}),s().default.logEvent("callout_show",t.callout_key)}function a(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,i().u4)({environment:e,event:{eventName:"callout_click",eventProperties:t}}),s().default.logEvent("callout_click",t.callout_key)}function l(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,i().u4)({environment:e,event:{eventName:"callout_dismiss",eventProperties:t}}),s().default.logEvent("callout_dismiss",t.callout_key)}function c(e,t){const{eligible_callouts:n,required_arg_timeout:o,required_args_run_duration:s,eligibility_timeouts:r,blocklist:a}=t;(0,i().u4)({environment:e,event:{eventName:"callout_coordinator_resolved",eventProperties:{eligible_callouts:n,required_arg_timeout:o,required_args_run_duration:s,eligibility_timeouts:r,blocklist:a}}})}function d(e,t){(0,i().u4)({environment:e,event:{eventName:"callout_feature_interaction",eventProperties:t}})}},58293:(e,t,n)=>{n.d(t,{r:()=>s});var o=()=>n(56366),i=()=>n(351360);function s(){return(0,o().K8)((()=>i().default.state.currentSpaceStore),[])}},63467:(e,t,n)=>{n.d(t,{y:()=>d});var o=()=>n(637997),i=()=>n(267419);const s={ko:()=>n.e(2268).then(n.bind(n,224434)),es:()=>n.e(95264).then(n.bind(n,196425)),de:()=>n.e(35390).then(n.bind(n,653703)),fr:()=>n.e(3272).then(n.bind(n,94677)),pt:()=>n.e(27315).then(n.bind(n,766869)),zh:()=>n.e(69945).then(n.bind(n,516814)),ja:()=>n.e(77757).then(n.bind(n,824432)),da:()=>n.e(9423).then(n.bind(n,440761)),fi:()=>n.e(59337).then(n.bind(n,462135)),nb:()=>n.e(2040).then(n.bind(n,937314)),nl:()=>n.e(51106).then(n.bind(n,530897)),sv:()=>n.e(53631).then(n.bind(n,895222))};let r=!1,a=!1;async function l(e){for(const[n,i]of Object.entries(e.emojiLocaleKeywords)){var t;o().fB[n]={...o().fB[n],keywords:[...i,...(null===(t=o().fB[n])||void 0===t?void 0:t.keywords)||[]]}}await i().A.waitUntilLoaded(),i().A.update((t=>{let{emojiByName:n,...o}=t;return{...o,emojiByName:{...n,...e.emojiByName}}}))}async function c(){if(r)return;const[e]=n(662303).locale.split("-");e in s&&(await l(await s[e]()),r=!0)}const d=(0,n(279900).A)((async()=>{await async function(){a||(await l(await n.e(51872).then(n.bind(n,443716))),a=!0)}(),await c()}))},72307:(e,t,n)=>{n.d(t,{A:()=>o});const o={appCursorListener:{sidebar:1,secondarySidebar:2,editor:3,aiChat:3,marketplace:3,teamHome:3}}},73223:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>g,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var o=()=>n(541235),i=()=>n(317909),s=()=>n(755199),r=()=>n(739135),a=()=>n(351360);function l(e,t){var n;const{currentUserSettingsStore:o}=a().default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;m({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{s().mJ({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,r().i9)(o,t)}}})},userId:o.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=a().default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;m({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{s().mJ({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,r().KD)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:i}=a().default.state;if(!i)return;const r=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;m({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{s().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...r,[t]:o().YD}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=a().default.state;t&&m({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{s().mJ({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var i;const{currentUserSettingsStore:l}=a().default.state;if(!l||(0,r().x$)(l,t))return;const c=(0,r().gt)(l,t);o().c$[t].steps.findIndex((e=>e.id===c))>=o().c$[t].steps.findIndex((e=>e.id===n))||s().mJ({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:n}}})}function g(e,t,n){if((0,r().ll)(n))return;const o=(0,r().tb)(t,n);o&&p(e,t,o)}function m(e){return i().createAndCommit({...e,canUndo:!1})}},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new o},84161:(e,t,n)=>{n.d(t,{S:()=>u});n(944114),n(296540);var o=()=>n(675910),i=()=>n(926401),s=()=>n(441977),r=()=>n(654601),a=()=>n(959013),l=()=>n(37433),c=()=>n(430483),d=n(474848);function u(){const e=(0,l().nk)(),t=c().zD.isFullPageAssistantInStartOptions(),n=[];return e&&n.push({key:"personal_home",label:(0,d.jsx)(a().sA,{id:"pageOnAppStoreSetting.home.label",defaultMessage:"Home"}),renderIcon:e=>(0,s().J)({width:20,height:20,...e})}),n.push({key:"last_visited_page",label:(0,d.jsx)(a().sA,{id:"pageOnAppStoreSetting.lastVisitedPage.label",defaultMessage:"Last visited page"}),renderIcon:e=>(0,o().M)({width:20,height:20,...e})},{key:"first_page",label:(0,d.jsx)(a().sA,{id:"pageOnAppStoreSetting.firstPage.label",defaultMessage:"Top page in sidebar"}),renderIcon:e=>(0,i().n)({width:20,height:20,padding:2,...e})}),t&&n.push({key:"chat",label:(0,d.jsx)(a().sA,{id:"pageOnAppStoreSetting.chat.label",defaultMessage:"Notion AI"}),renderIcon:e=>(0,r().X)({width:20,height:20,...e})}),n}},101749:(e,t,n)=>{n.d(t,{N:()=>r});n(296540);var o=()=>n(959013),i=()=>n(423657),s=n(474848);function r(e){const t=(0,i().A)(e);return t.isGuestRequestRequired?(0,s.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.guestRequestRequired",defaultMessage:"This guest must be approved by a workspace owner first"}):t.isStoreInTeam?t.teamAllowsGuests?void 0:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:(0,s.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine1",defaultMessage:"This teamspace doesn't allow guests."})}),(0,s.jsx)("div",{children:(0,s.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]}):t.spaceAllowsGuests?void 0:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:(0,s.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine1",defaultMessage:"This workspace doesn't allow guests."})}),(0,s.jsx)("div",{children:(0,s.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]})}},101847:(e,t,n)=>{n.d(t,{T:()=>o});const o=(0,n(340498).xh)("gift",{default:{loader:()=>n.e(23202).then(n.bind(n,723202))},small:{loader:()=>n.e(2264).then(n.bind(n,902264))},mini:{loader:()=>n.e(42668).then(n.bind(n,542668))},large:{loader:()=>n.e(25196).then(n.bind(n,725196))}})},103674:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{permissionsInviteStore:new(n(986229).A),contextualInviteStore:new(n(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},123350:(e,t,n)=>{n.r(t),n.d(t,{RequestMembersModal:()=>_,default:()=>R,messages:()=>j});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(959013),l=()=>n(100622),c=()=>n(284371),d=()=>n(134696),u=()=>n(542056),p=()=>n(436572),g=()=>n(805751),m=()=>n(623580),h=()=>n(928600),f=()=>n(433876),v=()=>n(14235),b=()=>n(204063),S=()=>n(125565),y=()=>n(654856),C=()=>n(263919),x=()=>n(495867),k=()=>n(722872),I=()=>n(743260),A=()=>n(962730),w=()=>n(766343),M=()=>n(103674),T=n(474848);const j=(0,a().YK)({reason_placeholder:{id:"RequestMembersModal.reason.placeholder",defaultMessage:"Add a reason (optional)"}});function _(e){const t=(0,i().v3)(),{store:n,origin:_,analyticsFrom:R}=e,{modalOpen:L,focus:P}=(0,s().K8)((()=>{const{open:e,focus:t}=w().A.state;return{modalOpen:e,focus:t}}),[]),B=(0,o.useCallback)((e=>{L&&w().A.setState({...w().A.state,open:!0,focus:e})}),[L]),E=(0,s().uB)(void 0,M().A),D=(0,a().tz)(),O=(0,r().IS)((()=>({modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:420},container:{padding:20},title:{fontWeight:c().Wy.medium,marginBottom:10},reasonTitle:{color:l().Ay.mediumTextColor,marginTop:10,marginBottom:5},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20}})),[]);(0,o.useEffect)((()=>{B("invites")}),[B]);const W=e=>{e.currentTarget===e.target&&B("none")},q=async()=>{d().RH(t,{...x().nE(t,E.state.contextualInviteStore),from:R}),u().KW({permissionsInviteStore:E.state.permissionsInviteStore,contextualInviteStore:E.state.contextualInviteStore}),E.state.contextualInviteStore.startRequestMembership();const e=E.state.contextualInviteStore.state.invitedUsers;w().A.close();const o=await x().xi({environment:t,spaceStore:n,originId:void 0,originType:R,reasonMessage:E.state.permissionsInviteStore.state.emailMessage,contextualInviteStore:E.state.contextualInviteStore,intl:D});F({success:o,intl:D,users:e}),E.reset()},F=e=>{const{success:t,intl:n,users:o}=e;0!==o.length&&(t?p().D6({label:n.formatMessage({id:"requestMembersModal.requestSuccess.toast",defaultMessage:"Successfully requested membership for {users} to your workspace admins."},{users:x().id(o,n)})}):p().D6({label:n.formatMessage({id:"requestMembersModal.requestFail.toast",defaultMessage:"Failed to invite {users} to the workspace."},{users:x().id(o,n)})}))};return(0,T.jsx)(f().A,{modalStyle:O.modalStyle,open:L,onDismiss:async()=>{if(!(await(0,I().iQ)({environment:t,permissionsInviteStoreState:E.state.permissionsInviteStore.state,from:"space_settings_add_members"})))return w().A.close(),void E.reset();B("none")},renderContent:()=>(0,T.jsxs)("div",{style:O.container,onClick:W,children:[(0,T.jsx)("div",{style:O.title,onClick:W,children:(0,T.jsx)(a().sA,{id:"requestMembersModal.title",defaultMessage:"Request to invite members"})}),(0,T.jsx)(v().Ay,{popupType:v().nl.Popup,alignmentToOrigin:A().C.Start,placementToOrigin:A().W.Bottom,open:"invites"===P,sameWidthAsOrigin:!0,originGap:10,disableMouseCapture:!0,origin:(0,T.jsx)(y().A,{permissionsInviteStore:E.state.permissionsInviteStore,store:n,handleClickRemoveToken:e=>{u().St({targetToRemove:e,permissionsInviteStore:E.state.permissionsInviteStore,defaultRoleForNonBot:"read_and_write"})},handleInputChange:async e=>{B("invites"),await u().Pp({environment:t,event:e,permissionsInviteStore:E.state.permissionsInviteStore})},handleInputSubmit:async()=>{},origin:"add_members",defaultRoleForNonBot:"read_and_write",right:(0,T.jsx)("div",{}),focus:"invites"===P,handleFocus:()=>B("invites")}),onDismiss:()=>B("none"),render:()=>{const e=(0,T.jsx)(C().A,{permissionsInviteStore:E.state.permissionsInviteStore,store:n,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!1,sectionRenderLimit:10,membersOnly:!1}),t={menuType:k().gu.Popup,disableScroller:!1};return(0,T.jsx)("div",{children:(0,T.jsx)(h().A,{...t,width:380,children:e})})},style:{width:"100%"}}),(0,T.jsx)("div",{style:O.reasonTitle,onClick:W,children:(0,T.jsx)(a().sA,{id:"requestMembersModal.reasonForRequest.title",defaultMessage:"Reason for request"})}),(0,T.jsx)(g().A,{debugName:"RequestMembersModal",capture:!0,allowEsc:!0,children:(0,T.jsx)(m().A,{textarea:!0,style:{padding:8},value:E.state.permissionsInviteStore.state.emailMessage,focus:"reason"===P,onFocus:()=>B("reason"),onChange:e=>{E.state.permissionsInviteStore.setState({...E.state.permissionsInviteStore.state,emailMessage:e.target.value})},placeholder:D.formatMessage(j.reason_placeholder)})}),(0,T.jsxs)("div",{style:O.footer,onClick:W,children:[(0,T.jsx)(S().A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,T.jsx)(a().sA,{id:"RequestMembersModal.caption",defaultMessage:"Your admins will approve or decline your request."})}),(0,T.jsx)(b().A,{size:"lg",style:O.requestInvitesButton,onClick:q,children:(0,T.jsx)(a().sA,{id:"requestMembersModal.requestInvitesButton.label",defaultMessage:"Request invites"})})]})]}),origin:(0,T.jsx)("div",{onClick:()=>{w().A.open()},children:_})})}const R=_},132456:(e,t,n)=>{n.d(t,{J4:()=>k,kw:()=>x,lf:()=>I});n(16280),n(816573),n(878100),n(177936),n(748140),n(821903),n(491134),n(128845),n(237467),n(444732),n(979577),n(581454);var o=n.n(n(883503)),i=()=>n(496603),s=()=>n(720665),r=()=>n(416845),a=()=>n(628536),l=()=>n(96689);const c={version:8,notion_version:0,variant:2},d={version:8,notion_version:1,variant:2},u=0,p=1,g=6,m=8,h=10,f=Date.UTC(2024,0,1);function v(e,t){if(e)return t[u]=255,t[u+1]=240|15&t[u+1],t;const n=Math.floor(((new Date).getTime()-f)/s().nD);if(n>=4096||n<0)throw new Error("Invalid offsetInDays.");return t[u]=n>>4,t[u+1]=n<<4&240|15&t[u+1],t}function b(e,t){if(e>=2**36||e<0)throw new Error("Invalid spaceShortId.");t[p]=240&t[p]|e/2**32&15;for(let n=0;n<4;n++)t[p+1+n]=e/2**(24-8*n)&255;return t}function S(e,t){const n=e?1:0;return t[g]=c.version<<4&240|c.notion_version<<1&14|1&n,t[m]=c.variant<<6&192|63&t[m],t}function y(e,t){if("block"===e)return t[h]=(0,a().vi)(e)|63&t[h],t;const n=(0,a().vi)(e);return t[h]=n>>8&127,t[h+1]=255&n,t}function C(e,t){const n=(0,a().TG)(e);return t[h]=127&n|128&t[h],t}function x(e,t,n,o){const i=new Uint8Array(16),s=globalThis.crypto.getRandomValues(i);return n!==l().NX&&v(e,s),b(t,s),S(o,s),y(n,s),M(s)}function k(e,t,n,o){return x(e,t,n,o)}function I(e,t,n){return A(e,t,n)}function A(e,t,n){const s=o()(n),l=i().iv(s,2).map((e=>parseInt(e.join(""),16)));if((0,a().ep)(t)){if(void 0===e)throw new(r().Um)(`Deterministic ID for '${t}' must specify a space short id`)}else if(void 0!==e)throw new(r().Um)(`Deterministic ID for '${t}' should not provide a space short id`);const c=new Uint8Array(l);return e&&b(e,c),C(t,c),function(e){e[g]=240&d.version<<4|14&d.notion_version<<1|1&e[g],e[m]=192&d.variant<<6|63&e[m]}(c),M(c)}const w=new Array(256).fill(0).map(((e,t)=>t.toString(16).padStart(2,"0")));function M(e){let t=0;return w[e[t++]]+w[e[t++]]+w[e[t++]]+w[e[t++]]+"-"+w[e[t++]]+w[e[t++]]+"-"+w[e[t++]]+w[e[t++]]+"-"+w[e[t++]]+w[e[t++]]+"-"+w[e[t++]]+w[e[t++]]+w[e[t++]]+w[e[t++]]+w[e[t++]]+w[e[t++]]}},135599:(e,t,n)=>{n.d(t,{W:()=>G});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454),n(737550);var o=n(296540),i=()=>n(395361),s=()=>n(484714),r=()=>n(56366),a=()=>n(721908),l=()=>n(474424),c=()=>n(591779),d=()=>n(206267),u=()=>n(207289),p=()=>n(519831),g=()=>n(245241),m=()=>n(959013),h=()=>n(496603),f=()=>n(973647),v=()=>n(534177),b=()=>n(720665),S=()=>n(449506),y=()=>n(518362),C=()=>n(989423),x=()=>n(148777),k=()=>n(825972),I=()=>n(71304),A=()=>n(780865),w=()=>n(470928),M=()=>n(722038),T=()=>n(406792),j=()=>n(106628),_=()=>n(361330),R=()=>n(109054),L=()=>n(351360),P=()=>n(227440),B=()=>n(508496),E=()=>n(968172),D=()=>n(20199),O=()=>n(558407),W=()=>n(630116),q=()=>n(645873),F=()=>n(963589),H=()=>n(531770);function K(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,d().JW)(),isResultsLoading:!1}}function G(e){var t;const{searchQuery:n,limit:d,source:G,type:z,ancestorId:U,disable:Y,overrideSpaceStore:$,overrideSearchSessionId:Q,usePrefetch_EXPERIMENTAL:Z,isTitleOnly:J=!0}=e,X=(0,s().v3)(),ee=(0,m().tz)(),te=(0,c().ZC)(n),ne=(0,c().ZC)(e.filters),oe=(0,o.useRef)({number:0,query:""}),ie=(0,o.useCallback)((e=>{const t=oe.current.query.trim(),n=e.trim();""!==n&&t!==n&&(oe.current.number+=1,oe.current.query=n)}),[]),se=(0,i().Y)(ie,_().ab),re=(0,o.useRef)(!0),ae=(0,r().K8)((()=>P().A.state.online),[]),le=(0,r().K8)((()=>e.isLocalOnlyMode||!ae),[ae,e.isLocalOnlyMode]),ce=(0,M().y)(),[de,ue]=(0,o.useState)(K()),pe=(0,r().K8)((()=>Q&&Q!==de.searchSessionId?(ue((e=>({...e,searchSessionId:Q}))),Q):de.searchSessionId),[de,Q]),ge=(0,F().X)("unified_find_cache_query_gen"),me=(0,F().X)("quick_find_highlights_enabled"),{searchLocalResults:he,searchServerResults:fe,isResultsLoading:ve,numTotalLocalResults:be,numTotalServerResults:Se}=(0,r().K8)((()=>({searchLocalResults:de.localResults,searchServerResults:de.serverResults,isResultsLoading:de.isResultsLoading,numTotalLocalResults:de.numTotalLocalResults,numTotalServerResults:de.numTotalServerResults})),[de]),ye=(0,r().K8)((()=>{if(le||ve&&re.current)return he;let e=function(e){const{localResults:t,serverResults:n}=e,o=t.map((e=>e.store.id)),i=new Set(o),s=n.filter((e=>!i.has(e.store.id)));return[...t,...s]}({localResults:he,serverResults:fe});return z===g().Vz.CollectionsInSpace&&(e=V(e)),e}),[le,ve,he,fe,z]),Ce=(0,r().K8)((()=>$||L().default.state.currentSpaceStore),[$]),xe=(0,r().K8)((()=>"on"===B().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),ke=(0,r().K8)((()=>le&&ae&&Boolean(Z)),[le,ae,Z]),Ie=(0,r().K8)((()=>(0,A().Er)(X).hasPublicAccessPermission),[X]),Ae=(0,o.useMemo)((()=>{const t={navigableBlockContentOnly:J,...e.filters};return(0,g().N2)(t)}),[e.filters,J]),we=(0,o.useMemo)((()=>{var t;return function(e){const{blockTypes:t,queryType:n}=e;switch(n){case g().Vz.CollectionsInSpace:return["collection_view","collection_view_page"];case g().Vz.BlocksInCollection:return["page","collection_view_page"];case g().Vz.BlocksInSpace:default:return[...t??[]]}}({blockTypes:null===(t=e.filters)||void 0===t?void 0:t.blockTypes,queryType:z})}),[null===(t=e.filters)||void 0===t?void 0:t.blockTypes,z]),Me=(0,o.useCallback)(((e,t)=>{const{isSuccess:n,totalResultsCount:o,localCacheMetadata:i,query:s}=t;T().default.measure(e,{environment:X,data:{start_time:e.startTime,success:n,surface:G,num_results:o,search_session_id:pe,local_cache_metadata:i,local_cache_readiness_timings:(0,x().Yp)(),query_length:s.length}})}),[X,G,pe]),Te=(0,o.useCallback)(((e,t)=>{const{isSuccess:n,totalResultsCount:o,query:i}=t;T().default.measure(e,{environment:X,data:{start_time:e.startTime,success:n,surface:G,num_results:o,search_session_id:pe,search_session_flow_number:oe.current.number,query_length:i.length}})}),[X,G,pe]),je=(0,r().K8)((()=>D().A.state.localSearchableBlocksCache),[]),_e=(0,q().fJ)(j().T.searchActions),Re=(0,o.useCallback)((e=>{const t=T().default.mark("rum.local_quick_search_query"),{query:n,spaceStore:o}=e,i=ce&&!ae&&(0,v().Xk)(g().Iy,G);if("resolved"!==_e.status)return;const s=z===g().Vz.CollectionsInSpace;let r=[];0===n.length&&s&&(r=function(e){const{spaceStore:t,environment:n}=e,o=(0,y().F)({currentUserId:n.currentUser.id,spaceId:t.id}).map((e=>{const n=W().md.createChildStore(t,{table:p().Vl,id:e}).getParentBlockStore();if(null==n?void 0:n.pathIsAccessibleAndAlive())return n}));return(0,h().oE)(o)}({environment:X,spaceStore:o}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[g().Ni.Local],featureGroups:[],serverEventProperties:void 0}))));const a=(0,x().PE)({environment:X,overrideCurrentUserId:X.currentUser.id,overrideSpaceId:o.id,overrideLocalSearchableBlocksCache:je}),l=(0,H().S6)({environment:X,parentStore:o,isOnline:ae,requestInput:{query:{text:n,filters:{...Ae,blockTypes:we,isOfflineOnly:i},sort:{field:"relevance"}},limit:le?d:Math.min(d,5)},localSearchCache:je,shouldUseNewRerankerDebugOverrideEnabled:xe,shouldLimitLocalResultsWhenOnline:!le,hasPublicAccessPermission:Ie}),c=ke?N({query:n,serverResults:Ve.current}):[],u=l&&f().Q.unwrapOr(l,void 0),m=(null==u?void 0:u.results)??[],b=(null==u?void 0:u.total)??0;let S=h().hS([...r,...m,...c],(e=>e.id));S=s?V(S):S,ue((e=>e.query!==n?e:(Ue.current=S.map((e=>e.id)),Me(t,{query:n,isSuccess:Boolean(u),totalResultsCount:b,localCacheMetadata:a}),se(n),{...e,localResults:S,isResultsLoading:!le&&e.isResultsLoading,numTotalLocalResults:b})))}),[ce,ae,G,_e.status,z,X,Ae,we,le,d,xe,Ie,ke,Me,se,je]),Le="mini_quick_find"===G?40:_().GR,Pe=(0,i().Y)(Re,Le),Be=(0,o.useCallback)((e=>{S().callApi({eventName:"warmSearchQueryCache",environment:X,data:{spaceId:(null==Ce?void 0:Ce.id)??"",query:e.query,searchSessionId:pe}})}),[X,Ce,pe]),Ee=(0,i().Y)(Be,200),De=(0,o.useCallback)((e=>{const{result:t,isMetaClick:o,context:i}=e,s=(0,I().Qe)(t.store,ee,X,!1),r=(0,R().u)({query:n,resultText:s??"",isLastQueryTermPartialMatchOK:!0}),a=L().default.state.currentSpaceStore,l=Boolean(null==a?void 0:a.getSettings().enable_ai_training);(0,C().u4)({environment:X,event:{eventName:"select_search_item",eventProperties:{sources:t.sources,localSources:Array.from(t.localSource||new Set),searchSessionId:pe,aiSessionId:void 0,searchSessionFlowNumber:oe.current.number,context:i,queryStringLength:n.length,isTitleMatch:r,queryIfLeap:l?n:void 0,totalSearchResultCount:be+Se,numLocalResults:he.length,numTotalLocalResults:be,isMobile:X.device.isMobile,isMetaClick:o,hasFilters:Boolean(Ae),originalPosition:t.originalPosition,selectedItemIndex:t.originalPosition,selectedSearchResultMetadata:{blockId:t.id,blockType:t.store.getModel().type},searchSource:G,verificationState:(0,w().i1)(t.store)}}})}),[X,be,Se,he,n,pe,oe,Ae,G,ee]),Oe=te===n,We=h().n4(ne,e.filters),qe=Boolean(te&&!n),Fe=We&&Oe,He=!Y&&Ce&&!Fe,Ke=qe||!We,Ge=(0,o.useRef)(!1),Ne=(0,o.useRef)([]),Ve=(0,o.useRef)([]),ze=(0,o.useRef)([]),Ue=(0,o.useRef)([]),Ye=(0,r().K8)((()=>{if("mention_menu"!==G)return;return O().A.getMentionedIds(X.currentUser.id)}),[X.currentUser.id,G]),$e=(0,o.useCallback)((async e=>{const t=T().default.mark("rum.server_quick_search_query"),{query:n,spaceStore:o,size:i}=e,s=o.id;if(le&&!ke)return;const r=!re.current&&We?Ne.current:[],a=ke?N({query:n,serverResults:Ve.current}):[];if(ke&&(n.length<=1||a.length>=5||ze.current.some((e=>e===n))))return;ze.current.push(n);const c=await S().callApi({eventName:"search",environment:X,data:{...z===g().Vz.BlocksInAncestor?{type:z,ancestorId:U??"",spaceId:s}:{type:z,collectionId:(null==Ae?void 0:Ae.parentId)??"",spaceId:s},query:n,spaceId:s,limit:"mini_quick_find"===G?10:i+1,filters:Ae,sort:{field:"relevance"},source:G,searchSessionId:pe,searchSessionFlowNumber:oe.current.number,recentlyMentionedPageIds:Ye,recentPagesForBoosting:(0,k().cs)(E().A.getWithoutSubscribing(s)),excludedBlockIds:h().sb([...r.map((e=>e.id)),...Ue.current||[],...Ve.current.map((e=>e.id))]),ignoresHighlight:!me||"mini_quick_find"!==G}});if(!c||"failed"===c.type)return;const d=c.data.total,p=(0,b().MU)((0,v().WP)(c.data.trackEventProperties).map((e=>{let[t,n]=e;return[`server-${t}`,n]}))),m=c.data.results.slice(0,i).map(((e,t)=>{const n=W().Bv.createChildStore(o,{id:e.id,spaceId:e.spaceId,table:"block"}),i=ke?function(e){const{result:t,store:n,environment:o}=e;if(t.terms)return t.terms;const i=n.getModel();if(!i)return[];const s=o.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(o.currentUser.id),r=(0,u().KM)((0,l().g)({blockValue:i,getRecordValue:s}).text);if(!r)return[];return(0,R().N)(r)}({environment:X,store:n,result:e}):e.terms;return{store:n,originalPosition:t,...e,serverEventProperties:p,terms:i}}));Ge.current=!(d<=i);const f=[...r,...m];Ne.current=f,Ve.current=h().hS([...ke?m:[],...Ve.current],(e=>e.id)),ke||(ue((e=>e.query!==n?e:(Te(t,{query:n,isSuccess:"success"===c.type,totalResultsCount:d}),{...e,serverResults:f,isResultsLoading:!1,numTotalServerResults:d}))),se(n))}),[le,ke,We,X,z,U,Ae,G,pe,Ye,Ue,se,Te,me]),Qe=(0,o.useCallback)((e=>{!Y&&Ce&&Ge.current&&!ve&&ae&&(ue((e=>({...e,isResultsLoading:!0}))),Ge.current=!1,re.current=!1,$e({query:n,spaceStore:Ce,size:e??20}))}),[Ce,Y,$e,ae,ve,n]),Ze="mini_quick_find"===G?100:_().ab,Je=(0,a().d)(Qe,Ze),Xe=(0,i().Y)($e,ke?0:_().ab);return(0,o.useEffect)((()=>{Ke&&(ue((e=>({...K(),searchSessionId:e.searchSessionId}))),Ve.current=[],ze.current=[]),He&&(re.current=!0,ue((e=>({...e,isResultsLoading:!0,query:n}))),Pe({query:n,spaceStore:Ce}),Xe({query:n,spaceStore:Ce,size:d}),"mini_quick_find"===G&&ge&&Ee({query:n}))}),[Ce,Pe,Xe,Ee,d,n,He,Ke,G,ge]),{results:ye,isResultsLoading:ve,searchSessionId:pe,fetchAdditionalServerResultsOnChange:!Y&&!le&&Ge.current&&Fe?Je:void 0,searchSessionFlowNumber:oe.current.number,hasMoreResults:Ge.current,searchAnalytics:{trackSelectSearchItem:De}}}function N(e){const{query:t,serverResults:n}=e;return t?n.filter((e=>(0,R().u)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function V(e){const t=new Set;return e.filter((e=>{const n=e.store.getCollectionViewSourceCollectionStore();return!(!n||t.has(n.id))&&(t.add(n.id),!0)}))}},162342:(e,t,n)=>{n.d(t,{W$:()=>a,fR:()=>s,iv:()=>r});var o=()=>n(228814),i=()=>n(846199);function s(e){i().A.setState({open:!0,...e})}function r(){i().A.setState({open:!1})}function a(e){o().A.setState({open:!0,...e})}},173019:(e,t,n)=>{n.d(t,{r:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("pencil",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},188799:(e,t,n)=>{n.d(t,{b:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("taskList",{viewBox:"0 0 18 17",svg:(0,o.jsx)("path",{d:"M3.48438 7.29688C5.35938 7.29688 6.92188 5.73438 6.92188 3.85938C6.92188 1.96875 5.35938 0.40625 3.48438 0.40625C1.59375 0.40625 0.0390625 1.96875 0.0390625 3.85938C0.0390625 5.73438 1.60156 7.29688 3.48438 7.29688ZM3.07031 5.70312C2.89844 5.70312 2.77344 5.61719 2.65625 5.47656L1.78125 4.42969C1.69531 4.32812 1.66406 4.23438 1.66406 4.10156C1.66406 3.85938 1.85156 3.67188 2.08594 3.67188C2.24219 3.67188 2.35156 3.73438 2.45312 3.875L3.05469 4.625L4.44531 2.39062C4.54688 2.23438 4.67969 2.15625 4.83594 2.15625C5.07031 2.15625 5.26562 2.33594 5.26562 2.55469C5.26562 2.66406 5.24219 2.76562 5.16406 2.88281L3.5 5.46875C3.39844 5.61719 3.25 5.70312 3.07031 5.70312ZM9.39844 4.54688H17.2578C17.6406 4.54688 17.9531 4.24219 17.9531 3.85938C17.9531 3.47656 17.6406 3.17188 17.2578 3.17188H9.39844C9.01562 3.17188 8.71875 3.47656 8.71875 3.85938C8.71875 4.24219 9.01562 4.54688 9.39844 4.54688ZM3.48438 16.3281C5.35938 16.3281 6.92188 14.7656 6.92188 12.8828C6.92188 10.9922 5.35938 9.4375 3.48438 9.4375C1.59375 9.4375 0.0390625 11 0.0390625 12.8828C0.0390625 14.7656 1.60156 16.3281 3.48438 16.3281ZM3.48438 15C2.32812 15 1.36719 14.0312 1.36719 12.8828C1.36719 11.7344 2.33594 10.7578 3.48438 10.7578C4.625 10.7578 5.60156 11.7344 5.60156 12.8828C5.60156 14.0312 4.625 15 3.48438 15ZM9.39844 13.5859H17.2578C17.6406 13.5859 17.9531 13.2812 17.9531 12.8984C17.9531 12.5156 17.6406 12.2109 17.2578 12.2109H9.39844C9.01562 12.2109 8.71875 12.5156 8.71875 12.8984C8.71875 13.2812 9.01562 13.5859 9.39844 13.5859Z"})})},191197:(e,t,n)=>{n.d(t,{i:()=>i,z:()=>s});var o=()=>n(989423);function i(e,t){const{from:n}=t;o().vd(e,"show_tooltip",{from:n,time:Date.now()})}function s(e,t){const{from:n}=t;o().vd(e,"dismiss_tooltip",{from:n,time:Date.now()})}},204552:(e,t,n)=>{n.d(t,{c:()=>i,x:()=>s});var o=()=>n(645873);const i=(0,o()._h)(new(o().O2)("UniversalQnaModals",(async()=>await Promise.all([n.e(23806),n.e(37353),n.e(55373),n.e(29151),n.e(16908),n.e(48315),n.e(847),n.e(5887),n.e(17989),n.e(56985),n.e(21627),n.e(82472),n.e(96345),n.e(75659),n.e(47858),n.e(51860),n.e(221),n.e(14358)]).then(n.bind(n,457974)))),(e=>e.UniversalQnaModals)),s=(0,o()._h)(new(o().O2)("SlackConnectionOptions",(async()=>await n.e(85873).then(n.bind(n,210230)))),(e=>e.SlackConnectionOptions))},224011:(e,t,n)=>{n.d(t,{A:()=>s});var o=()=>n(705540);class i extends(()=>n(757695))().default{getInitialState(){return{isFullScreen:window.outerWidth===window.screen.width&&window.outerHeight===window.screen.height}}constructor(){super(),this.updateFromElectronState=async()=>{const e=await o().fullscreen.get();void 0!==e&&this.setState({isFullScreen:e})},o().fullscreen.addListener(this.updateFromElectronState),this.updateFromElectronState()}}const s=new i},228814:(e,t,n)=>{n.d(t,{A:()=>o});const o=n(757695).default.createValue({open:!1},{name:"TrialEndModalStore"})},240562:(e,t,n)=>{n.d(t,{p:()=>s});var o=()=>n(645873);const i=new(o().O2)("HelpButtonContent",(async()=>await n.e(42481).then(n.bind(n,667667)))),s=(0,o()._h)(i,(e=>e.HelpButtonContent))},277201:(e,t,n)=>{n.d(t,{I:()=>y,i:()=>x});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(420767),l=()=>n(959013),c=()=>n(186445),d=()=>n(38337),u=()=>n(869562),p=()=>n(749687),g=()=>n(962730),m=()=>n(948914),h=()=>n(145214),f=()=>n(285790),v=()=>n(35392),b=()=>n(859428),S=n(474848);function y(e){const t=(0,i().v3)(),n=(0,i().Y0)(),o=(0,l().tz)(),r=(0,s().O$)(p().sidebarMouseEnteredStore),d=(0,s().K8)((()=>m().A.state.isShowingTabBar||!1),[]),g=(0,s().O$)(c().$o),h=o.formatMessage({defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"}),f=(!n.isElectronMac||!g)&&!d&&r;return(0,S.jsx)(x,{isVisible:f,icon:a().B,caption:h,onClick:()=>{u().closeSidebarFromTopbarUnexpandButton(t)},keyboardShortcutName:"toggleSidebar",style:e.style,hoveredStyle:e.hoveredStyle})}const C={width:16,height:16,fill:"inherit"};function x(e){const t=(0,i().Y0)(),n=(0,r().IS)((t=>({keyboardShortcut:{color:t.text.contrastSecondary},button:{fill:t.mediumIconColor},enterAnimation:{opacity:e.isVisible?0:1},animation:{opacity:e.isVisible?1:0}})),[e.isVisible]),s=(0,o.useMemo)((()=>({position:"relative",marginLeft:10,...t.isMobile&&{height:"100%"},...n.button,...e.style})),[e.style,n.button,t.isMobile]);return(0,S.jsx)(b().A,{renderTooltip:()=>(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:e.caption}),e.keyboardShortcutName&&(0,S.jsx)(v().A,{style:n.keyboardShortcut,name:e.keyboardShortcutName})]}),originGap:6,placement:t.isElectron?g().W.Right:g().W.Bottom,render:n=>(0,S.jsx)(h().A,{tag:f().A,animate:{opacity:e.isVisible?1:0},ariaLabel:e.caption,disabled:!e.isVisible,icon:e.icon,style:s,hoveredStyle:e.hoveredStyle,iconStyle:C,mobileFeedback:t.isMobile,onClick:e.onClick,className:d().P7S,...n})})}},279900:(e,t,n)=>{function o(e){let t,n,o;return async function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t?(o=s,n||(n=t.then((()=>(n=void 0,t=e(...o),t))),n)):(t=e(...s),t)}}n.d(t,{A:()=>o})},305961:(e,t,n)=>{n.d(t,{d:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("eyePadded",{viewBox:"0 0 24 24",svg:(0,o.jsx)("path",{d:"M12 17.9912C17.6055 17.9912 21.3857 13.4727 21.3857 12.0713C21.3857 10.6699 17.5986 6.1582 12 6.1582C6.47656 6.1582 2.60742 10.6699 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.2715 7.63184 7.4707 12 7.4707C16.3613 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 13.0283 16.3613 16.6787 12 16.6787ZM12 15.7559C14.0508 15.7559 15.6914 14.0811 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C9.94238 8.39355 8.29492 10.0137 8.30176 12.0713C8.31543 14.0811 9.94238 15.7559 12 15.7559ZM12 13.2607C11.3369 13.2607 10.7969 12.7275 10.7969 12.0713C10.7969 11.415 11.3369 10.8818 12 10.8818C12.6631 10.8818 13.1963 11.415 13.1963 12.0713C13.1963 12.7275 12.6631 13.2607 12 13.2607Z"})})},323914:(e,t,n)=>{n.d(t,{c:()=>s,y:()=>i});var o=()=>n(463830);const i=new(o().A),s=new(o().A)},324561:(e,t,n)=>{n.d(t,{Gi:()=>g,Q7:()=>p,UU:()=>m,_3:()=>u,a9:()=>d,f_:()=>c});var o=()=>n(484714),i=()=>n(56366),s=()=>n(857639),r=()=>n(762433),a=()=>n(596513),l=()=>n(714300);function c(e){let{spaceId:t}=e;const n=(0,o().v3)();return(0,i().K8)((()=>{if(t)return a().t.getData(n,{spaceId:t})}),[n,t])}function d(e){if("admin"===(null==e?void 0:e.type))return e}function u(e){let{spaceId:t}=e;return d((0,l().l)({spaceId:t}))}function p(e,t,n){if(!t)return 0;const o=(0,r().yB)({spaceId:e,logFunction:s().log.bind(s()),billingData:t});return o?Math.max(o,n):0}function g(e){var t;const n=null===(t=(0,r().KH)(e,"plan"))||void 0===t?void 0:t.price;if(!n)return;const o=n.unitAmount,i="year"===n.billingInterval?12:1;return{amount:o.amount/i,currencyCode:o.currencyCode}}function m(e){return"app_store"===(null==e?void 0:e.provider)||"play_store"===(null==e?void 0:e.provider)||"mixed"===(null==e?void 0:e.provider)}},332390:(e,t,n)=>{n.d(t,{C7:()=>j,Yf:()=>L,k8:()=>_,lN:()=>R,oG:()=>P});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(700500),a=()=>n(130382),l=()=>n(959013),c=()=>n(534177),d=()=>n(191197),u=()=>n(953006),p=()=>n(68465),g=()=>n(231722),m=()=>n(792002),h=()=>n(465425),f=()=>n(51367),v=()=>n(301421),b=()=>n(351360),S=()=>n(411671),y=()=>n(630116),C=()=>n(24157),x=()=>n(576590),k=()=>n(656633),I=()=>n(972911),A=n(474848);const w=1,M=1,T=(0,l().YK)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function j(){const e=(0,i().v3)(),t=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>{var e;return null===(e=b().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),n=(0,s().K8)((()=>{const t=b().default.state.mainEditorCurrentBlockStore;return t&&S().A.getMode(e,t)}),[e]);return(0,s().K8)((()=>{if(e.device.isMobile)return;const{currentUserSettingsStore:o,inAppCalloutStore:i}=b().default.state;if(!i.getCalloutVisibility("ai_onboarding_tooltip").canShow)return;const s=null==o?void 0:o.getSettings();if(!s)return;if((0,c().O9)(s.last_used_ai_writer_at))return;if("tooltip"!==s.ai_assistant_onboarding_phase)return;if((0,k().vp)(e,t)){if(!(0,c().O9)(s.ai_sales_assisted_extra_notification_seen_at)||(0,a().Mn)(s.ai_sales_assisted_extra_notification_seen_at)<M)return}else if((0,c().O9)(s.ai_assistant_onboarding_phase_last_set_at)&&(0,a().Mn)(s.ai_assistant_onboarding_phase_last_set_at)<w)return;if("space_for_ai"!==(0,I().V7)())return;if(!(0,p().ZE)(n))return;const l=C().default.state;if("editing"===l.mode){const e=(0,g().H7)(l.multiSelection);if(e&&(0,m().gE)(e.selection)){const t=e.store,n=v().n.findEditableWithStore(t);if(n){const e="block"===t.pointer.table?y().Bv.createChildStore(t,t.pointer):void 0,o=e&&e.getType(),i=Boolean(o&&(0,r().ZW)(o)),s=t.getValue();if(i&&!s)return n}}}}),[e,n,t])}(),[n,d]=(0,o.useState)(!1),h=(0,o.useCallback)((()=>{d(!0)}),[]),f=!n&&Boolean(t);return(0,o.useEffect)((()=>()=>{f&&(0,I().ZI)(e)}),[e,f]),f&&t?(0,A.jsx)(u().k,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,A.jsx)(l().sA,{...T.spaceForAiHeader}),content:(0,A.jsx)(l().sA,{...T.spaceForAiContent}),onCloseClick:h}):null}function _(e){const{originRef:t,openState:n}=e,r=(0,i().v3)(),a=(0,s().K8)((()=>(0,I().V7)()),[]),[c,d]=(0,o.useState)(!1),p=(0,o.useCallback)((()=>{d(!0)}),[]),g="ask_ai_anything"===a&&"initialPrompt"===n.stage&&!c;return(0,o.useEffect)((()=>()=>{!r.device.isMobile&&g&&(0,I().ZI)(r)}),[r,g]),r.device.isMobile||!g?null:(0,A.jsx)(u().k,{origin:t,placementToOrigin:"top",header:(0,A.jsx)(l().sA,{...T.askAiAnythingHeader}),content:(0,A.jsx)(l().sA,{...T.askAiAnythingContent}),onCloseClick:p})}function R(e){const{originRef:t,openState:n,isInputEmpty:r}=e,a=(0,i().v3)(),c=(0,s().K8)((()=>(0,I().V7)()),[]),[d,p]=(0,o.useState)(!1),g=(0,o.useCallback)((()=>{p(!0)}),[]),m="refine_ai_response"===c&&"results"===n.stage&&!n.loading&&"cursor"===n.context.type&&r&&!d;return(0,o.useEffect)((()=>()=>{!a.device.isMobile&&m&&(0,I().ZI)(a)}),[a,m]),a.device.isMobile?null:(0,A.jsx)(u().k,{origin:m?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,A.jsx)(l().sA,{...T.refineAiResponseHeader}),content:(0,A.jsx)(l().sA,{...T.refineAiResponseContent}),onCloseClick:g})}function L(e){const{origin:t}=e,n=(0,i().v3)();(0,o.useEffect)((()=>{d().i(n,{from:"qna_button"}),f().DL(n,{callout_key:"ai_assistant_origin_element_tooltip",placement_key:"Tooltip"})}),[n]);const s=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e}=b().default.state;e&&(d().z(n,{from:"qna_button"}),f().Sq(n,{callout_key:"ai_assistant_origin_element_tooltip",dismiss_type:"tooltip_dismiss",placement_key:"Tooltip"}),(0,x().setQnaOnboardingPhase)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}),h().a(n,"ai_assistant_origin_element_tooltip"))}),[n]);return(0,A.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,A.jsx)(l().sA,{...T.showAssistantOriginElementLocationHeader}),content:(0,A.jsx)(l().sA,{...T.showAssistantOriginElementLocationContent}),onCloseClick:s})}function P(e){const{origin:t}=e,n=(0,i().v3)();(0,o.useEffect)((()=>{d().i(n,{from:"qna_search"})}),[n]);const s=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e}=b().default.state;e&&(d().z(n,{from:"qna_search"}),(0,x().setQnaOnboardingPhase)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[n]);return(0,A.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,A.jsx)(l().sA,{...T.showAssistantLocationHeader}),content:(0,A.jsx)(l().sA,{...T.showAssistantLocationContent}),onCloseClick:s})}(0,n(466103).exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=b().default.state;t&&n(317909).createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,canUndo:!0,perform:e=>{n(755199).mJ({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},388182:(e,t,n)=>{n.d(t,{A:()=>o});const o=n(757695).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},420767:(e,t,n)=>{n.d(t,{B:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("doubleChevronLeft",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.07031 13.8887C7.2207 14.0391 7.40527 14.1211 7.62402 14.1211C8.06836 14.1211 8.41699 13.7725 8.41699 13.3281C8.41699 13.1094 8.32812 12.9043 8.17773 12.7539L3.37207 8.05762L8.17773 3.375C8.32812 3.21777 8.41699 3.0127 8.41699 2.80078C8.41699 2.35645 8.06836 2.00781 7.62402 2.00781C7.40527 2.00781 7.2207 2.08984 7.07031 2.24023L1.73828 7.44922C1.56055 7.62012 1.46484 7.8252 1.46484 8.06445C1.46484 8.29688 1.55371 8.49512 1.73828 8.67969L7.07031 13.8887ZM13.1748 13.8887C13.3252 14.0391 13.5098 14.1211 13.7354 14.1211C14.1797 14.1211 14.5283 13.7725 14.5283 13.3281C14.5283 13.1094 14.4395 12.9043 14.2891 12.7539L9.4834 8.05762L14.2891 3.375C14.4395 3.21777 14.5283 3.0127 14.5283 2.80078C14.5283 2.35645 14.1797 2.00781 13.7354 2.00781C13.5098 2.00781 13.3252 2.08984 13.1748 2.24023L7.84961 7.44922C7.66504 7.62012 7.57617 7.8252 7.56934 8.06445C7.56934 8.29688 7.66504 8.49512 7.84961 8.67969L13.1748 13.8887Z"})})},423098:(e,t,n)=>{n.r(t),n.d(t,{AiBlockV2:()=>Wt});n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var o=()=>n(153321),i=n(296540),s=()=>n(17022),r=()=>n(662303),a=()=>n(484714),l=()=>n(56366),c=()=>n(401497),d=()=>n(534177),u=()=>n(68263),p=()=>n(179034),g=()=>n(519831),m=()=>n(96689),h=()=>n(189141);function f(e){const{referenceContext:t,getRecordRole:n,getCanReadSlackChannel:o}=e;if(!t)return!0;for(const i of t)if("collection"===i.type){const e=n({id:i.collectionId,table:g().Vl})??"none";if(!(0,u().Tt)(e))return!1}else if("page"===i.type||"currentPage"===i.type){const e=n({id:i.pageId,table:p().ev})??"none";if(!(0,u().Tt)(e))return!1}else if("slack"===i.type){if(!o(i))return!1}else(0,d().HB)(i);return!0}class v{constructor(e){this.permissionLevel=void 0,this.permissionLevel=e}canOpenConfigurationPanel(){switch(this.permissionLevel){case"editor":case"configuration_reader":return!0;case"reader":return!1;default:(0,d().HB)(this.permissionLevel)}}canEditConfigurationPanel(){switch(this.permissionLevel){case"reader":case"configuration_reader":return!1;case"editor":return!0;default:(0,d().HB)(this.permissionLevel)}}canGenerateBlock(){switch(this.permissionLevel){case"editor":return!0;case"configuration_reader":case"reader":return!1;default:(0,d().HB)(this.permissionLevel)}}canDuplicateBlock(){switch(this.permissionLevel){case"reader":return!1;case"configuration_reader":case"editor":return!0;default:(0,d().HB)(this.permissionLevel)}}}var b=()=>n(857639),S=()=>n(513416),y=()=>n(134025),C=()=>n(370085),x=()=>n(439180),k=()=>n(959013),I=()=>n(532659),A=()=>n(496603),w=()=>n(532313),M=()=>n(284371),T=()=>n(449506),j=()=>n(901389),_=()=>n(44729),R=()=>n(863168),L=()=>n(246826),P=()=>n(317909),B=()=>n(859428),E=()=>n(989423),D=()=>n(864145),O=()=>n(972435),W=()=>n(351360),q=()=>n(829e3),F=()=>n(630116),H=()=>n(155004),K=()=>n(406699),G=()=>n(99945),N=()=>n(238365),V=()=>n(285790),z=n(474848);function U(e){const{traceId:t}=e,[o,s]=(0,i.useState)(void 0),r=(0,a().v3)(),c=(0,i.useCallback)((e=>{var o;const i=null===(o=W().default.state.currentSpaceStore)||void 0===o?void 0:o.id;if(!i)return;const a={type:"thumbsdown"===e.type?"ai_block_thumbs_down":"ai_block_thumbs_up",id:t,space_id:i,feedbackNote:e.userContent};s(e),T().callApi({eventName:"saveAssistantFeedback",environment:r,data:a,headers:(0,n(386164).WS)({spaceId:i})})}),[r,t]),d=(0,l().K8)((()=>{var e;const t=W().default.state.currentUserSettingsStore;return(null==t||null===(e=t.getSettings())||void 0===e?void 0:e.ai_data_share_opt_in)??N().Mp}),[]),u=(0,i.useCallback)((e=>{s(void 0)}),[]),p=(0,k().tz)();return(0,z.jsxs)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,z.jsx)(V().A,{onClick:()=>{c({type:"thumbsup",userContent:"",shareWithNotion:!0})},icon:(0,N().gZ)("thumbsup","thumbsup"===(null==o?void 0:o.type)),ariaLabel:p.formatMessage({id:"AiBlockV2.thumbsUp",defaultMessage:"Helpful"})}),(0,z.jsx)(K().Ay,{popupType:K().z7.Popup,ariaLabel:p.formatMessage({id:"completions.CompletionMenuFooter.thumbsUp",defaultMessage:"Submit positive feedback"}),renderOrigin:e=>(0,z.jsx)(V().A,{icon:(0,N().gZ)("thumbsdown","thumbsdown"===(null==o?void 0:o.type)),...e,ariaLabel:p.formatMessage({id:"AiBlockV2.thumbsDown",defaultMessage:"Not helpful"})}),render:e=>(0,z.jsx)(n(545805).A,{debugName:"AiBlockFeedbackButtons",capture:!0,onEsc:u,children:(0,z.jsx)(n(701148)._,{onCancel:u,onSubmit:t=>{c(t),e.close()},onUpdate:e=>{s(e),c(e)},userOptIn:d,state:o&&"thumbsdown"===o.type?o:{type:"thumbsdown",userContent:"",shareWithNotion:!0}})})})]})}var Y=()=>n(936916),$=(n(672577),n(581454),()=>n(908006)),Q=()=>n(395361),Z=()=>n(727706),J=()=>n(831310),X=()=>n(668725),ee=()=>n(54241),te=()=>n(188799),ne=()=>n(919709),oe=()=>n(829300),ie=()=>n(725614),se=()=>n(515692),re=()=>n(220331),ae=()=>n(928600),le=()=>n(38337),ce=()=>n(847743),de=()=>n(792540),ue=()=>n(722872),pe=()=>n(231722),ge=()=>n(24157),me=()=>n(84817),he=()=>n(493823),fe=()=>n(843189),ve=()=>n(760217),be=()=>n(805751),Se=()=>n(939740),ye=()=>n(509657),Ce=()=>n(204063),xe=()=>n(89924),ke=()=>n(628864),Ie=()=>n(246722),Ae=()=>n(946548),we=()=>n(125565);function Me(e){const{store:t,style:n}=e,o=(0,a().v3)(),s=(0,l().K8)((()=>{const e=t.getNavigableBlockStore();return(null==e?void 0:e.isTemplate())??!1}),[t]),r=(0,l().K8)((()=>t.autoGenerateOnTemplateDuplication()),[t]),c=(0,i.useCallback)((()=>{P().createAndCommit({userAction:"AiBlock.updateBlockConfiguration",environment:o,canUndo:!0,perform:e=>{L().zv({store:t.getFormatStore().getKeyStore("ai_block_configuration_menu"),data:{autoGenerateOnTemplateDuplication:!r},transaction:e})}})}),[t,o,r]);return s?(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",...n},children:[(0,z.jsx)(we().A,{children:(0,z.jsx)(k().sA,{id:"AiBlockV2.AutoGenerateOnTemplateDuplicationFieldToggle.Label",defaultMessage:"Autofill when template is duplicated"})}),(0,z.jsx)(Ae().A,{on:r,onClick:c})]}):null}n(944114);var Te=()=>n(148307),je=()=>n(467730),_e=()=>n(149375),Re=()=>n(245241),Le=()=>n(36760),Pe=()=>n(825972),Be=()=>n(135599),Ee=()=>n(962730),De=()=>n(970585),Oe=()=>n(464708),We=()=>n(64e3),qe=()=>n(14235),Fe=()=>n(305390),He=(n(18107),n(967357),()=>n(612740)),Ke=()=>n(784892),Ge=()=>n(416504),Ne=()=>n(614505),Ve=()=>n(16006),ze=()=>n(881690);const Ue=(0,n(340498).xh)("plus",{default:{loader:()=>Promise.resolve().then(n.bind(n,617668))},small:{loader:()=>Promise.resolve().then(n.bind(n,863330))},fill:{loader:()=>Promise.resolve().then(n.bind(n,73822))},fillSmall:{loader:()=>n.e(37376).then(n.bind(n,621837))}},["plus","add","new","create","increase"]);var Ye=()=>n(623580),$e=()=>n(460292);const Qe=(0,k().YK)({addContextPlaceholder:{id:"ContextTokenPlaceholderTypeahead.addContextPlaceholder",defaultMessage:"Add context"}});function Ze(e){const{disabled:t,currentlyFocusedItem:n,items:o,query:s,setQuery:r,isMenuOpen:a,hasContextsAlready:l,inputRef:d}=e,u=(0,k().tz)(),p=(0,i.useMemo)((()=>{var e;if(!s)return;if(n)return n.title.toLowerCase().startsWith(s.toLowerCase())?`${s}${n.title.slice(s.length)}`:s;const t=null===(e=o.find((e=>e.title.toLowerCase().startsWith(s.toLowerCase()))))||void 0===e?void 0:e.title;return t?`${s}${t.slice(s.length)}`:s}),[o,s,n]),g=(0,i.useMemo)((()=>!a&&l),[a,l]),m=(0,i.useMemo)((()=>s?p??"":u.formatMessage(Qe.addContextPlaceholder)),[s,u,p]),h=(0,i.useRef)(null),[f,v]=(0,i.useState)(null);(0,i.useEffect)((()=>{h.current&&v(h.current.offsetWidth)}),[h,m,g]),(0,i.useEffect)((()=>{a||r("")}),[a,r]);const b=(0,c().IS)((e=>({container:{display:"flex",alignItems:"center",background:g?"transparent":e.inputBackground,borderRadius:6,paddingLeft:0,paddingRight:0,height:24,...M().RC},backgroundInput:{height:void 0,position:"absolute",top:0,left:0,display:"flex",alignItems:"center",borderRadius:6,paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,fontSize:14,lineHeight:"20px",width:"fit-content",...M().RC,color:e.text.quaternary},foregroundInput:{boxShadow:"none",background:"transparent",width:null===f?void 0:f,color:e.text.secondary},plusIcon:{fill:e.text.quaternary,width:14,height:14,marginLeft:6,...g&&{marginRight:6}}})),[f,g]);return(0,z.jsx)(B().A,{disableTooltip:!g,textWrap:!0,style:{minWidth:200,padding:"4px 8px"},renderTooltip:()=>(0,z.jsx)(k().sA,{id:"ContextTokenPlaceholderTypeahead.tooltip",defaultMessage:"Add context to help Notion AI generate relevant content"}),render:n=>(0,z.jsxs)(he().p,{...n,style:b.container,onClick:e.onFocus,disabled:t,children:[(0,z.jsx)($e().Q,{iconGroup:Ue,variantName:"default",colorName:"grayPrimary",style:b.plusIcon}),!g&&(0,z.jsxs)("div",{style:{position:"relative"},children:[(0,z.jsx)("div",{ref:h,style:b.backgroundInput,children:m}),(0,z.jsx)(be().A,{capture:!0,debugName:"ContextTokenPlaceholderTypeahead",allowMenuList:!0,children:(0,z.jsx)(Ye().A,{ref:d,disabled:t,style:b.foregroundInput,focus:a,value:s,onChange:e=>{r(e.target.value)},suppressFocusRing:!0,onFocus:()=>{e.onFocus()}})})]})]})})}const Je=(0,k().YK)({slackIconAriaLabel:{id:"AiBlockV2ContextTokenInput.slackIconAriaLabel",defaultMessage:"Slack"}});function Xe(e){const{disabled:t,currentContexts:n,contextInputRef:o,inputRef:s,query:r,setQuery:a,searchResultMenuIsOpen:u,setSearchResultMenuIsOpen:p,handleUpdateContexts:g,searchResultMenuState:m,menuListStore:h}=e,f=(0,Ge().P)(),v=(0,k().tz)(),b=(0,l().K8)((()=>"notion"===m.type?m.results.map((e=>({key:e.blockStore.id,item:e,title:e.blockStore.getRenderTitle({userTimeZone:f,intl:v})??(0,He().L)(v)}))):"slack"===m.type?m.results.map((e=>({key:e.channel.id,title:e.channel.name,item:e}))):"choose"===m.type?[]:void(0,d().HB)(m)),[m,f,v]),S=(0,l().K8)((()=>{const e=h.state.focus.indexGlobal;return void 0!==e?b.at(e):void 0}),[h,b]),y=(0,i.useCallback)((e=>{g(n.filter((t=>!(0,A().n4)(t,e))))}),[n,g]),C=(0,c().IS)((e=>({container:{position:"relative",borderRadius:6,boxShadow:e.inputBoxShadow,backgroundColor:"dark"===e.mode?e.accentColors.translucentGray[100]:"transparent",display:"flex",alignItems:"center",padding:4,gap:4,flexWrap:"wrap",cursor:"pointer"},firstLinePlaceholder:{position:"absolute",top:0,left:0,height:32,width:"100%"}})),[]);return(0,z.jsxs)("div",{style:C.container,onClick:()=>p(!0),children:[(0,z.jsx)("div",{ref:o,style:C.firstLinePlaceholder}),(0,z.jsx)(Ze,{disabled:t,inputRef:s,query:r,setQuery:a,items:b,currentlyFocusedItem:S,onSuggestionSelected:e=>{u&&(g([e.item,...n]),a(""),p(!1))},hasContextsAlready:n.length>0,onFocus:()=>{p(!0)},isMenuOpen:u}),n.map((e=>(0,z.jsx)(et,{contextItem:e,disabled:t,onRemove:t=>{y(e),t.preventDefault(),t.stopPropagation()}},function(e){if("currentPage"===e.type)return`currentPage-${e.blockStore.id}`;if("block"===e.type)return`block-${e.blockStore.id}`;if("slack"===e.type)return`slack-${e.channel.id}`}(e))))]})}function et(e){const{contextItem:t,disabled:n,onRemove:o}=e,i=(0,k().tz)(),s=(0,Ge().P)(),r=(0,l().K8)((()=>"currentPage"===t.type||"block"===t.type?t.blockStore.getRenderTitle({userTimeZone:s,intl:i})??(0,He().L)(i):"slack"===t.type?t.channel.name:void(0,d().HB)(t)),[t,i,s]),a=(0,c().IS)((e=>({tokenWrapper:{backgroundColor:e.lightGrayBannerBackground,cursor:"pointer",paddingLeft:4,paddingRight:4,paddingTop:12,paddingBottom:12,borderRadius:4,maxWidth:150,height:24,color:e.text.secondary}})),[]);return(0,z.jsx)(ze().A,{disabled:n,style:a.tokenWrapper,format:Ke().NY.Small,isSingle:!0,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1,showRemoveButton:!0,onClickRemove:o,value:(0,z.jsx)(it,{contextItem:t}),showTooltip:"overflow",tooltip:r,tooltipPlacement:Ee().W.Bottom,tooltipOriginGap:0})}const tt=16,nt=12;function ot(){return(0,c().IS)((e=>({recordTitleStyle:{display:"flex",alignItems:"center",gap:4}})),[])}function it(e){const{contextItem:t}=e;return"currentPage"===t.type?(0,z.jsx)(st,{blockStore:t.blockStore}):"block"===t.type?(0,z.jsx)(rt,{blockStore:t.blockStore}):"slack"===t.type?(0,z.jsx)(at,{channel:t.channel}):(0,d().HB)(t)}function st(e){const{blockStore:t}=e,n=ot(),o=(0,l().K8)((()=>t.getIcon()),[t]);return(0,z.jsxs)("div",{style:n.recordTitleStyle,children:[(0,z.jsx)(Ne().A,{disabled:!0,icon:o,isEmptyPage:!1,size:tt}),(0,z.jsx)("div",{style:M().RC,children:(0,z.jsx)(k().sA,{defaultMessage:"Current page",id:"ContextTokenInput.currentPage"})})]})}function rt(e){const{blockStore:t}=e,n=ot(),o=(0,l().K8)((()=>t.getIcon()),[t]);return(0,z.jsxs)("div",{style:n.recordTitleStyle,children:[(0,z.jsx)(Ne().A,{disabled:!0,icon:o,isEmptyPage:!1,size:tt}),(0,z.jsx)(Ve().A,{store:t})]})}function at(e){const{channel:t}=e,n=ot(),o=(0,k().tz)();return(0,z.jsxs)("div",{style:n.recordTitleStyle,children:[(0,z.jsx)("img",{width:nt,src:Te().A.images.externalIntegrations.slackIconPng,alt:o.formatMessage(Je.slackIconAriaLabel)}),(0,z.jsx)("div",{children:t.name})]})}const lt=(0,k().YK)({notionIconAriaLabel:{id:"notionIconAriaLabel",defaultMessage:"Notion"},slackIconAriaLabel:{id:"slackIconAriaLabel",defaultMessage:"Slack"},notionContextLabel:{id:"notionContextLabel",defaultMessage:"Notion"},slackContextLabel:{id:"slackContextLabel",defaultMessage:"Slack"}}),ct="notion";function dt(e){var t;const{currentContexts:n,handleUpdateContexts:o,disabled:s}=e,[r,c]=(0,i.useState)(!1),u=(0,l().uB)(void 0,De().A),p=(0,l().K8)((()=>["notion",...(0,Le().wd)().filter(gt)]),[]),[g,m]=(0,i.useState)(""),{searchResultMenuState:h,setCurrentSearchContext:f}=function(e){const{availableSearchContexts:t,currentContexts:n,query:o}=e,s=t.length>1,[r,c]=(0,i.useState)(s?void 0:ct),u=(0,a().v3)(),p=(0,l().K8)((()=>W().default.state.currentSpaceStore),[]),g=null==p?void 0:p.id,m=(0,l().K8)((()=>Pe().NK.state.map((e=>e.store))),[]),{results:h,isResultsLoading:f}=(0,Be().W)({source:"ai_block_v2_page_context_search",searchQuery:o,limit:20,type:Re().Vz.BlocksInSpace,disable:!o||"notion"!==r,excludedBlockIds:n.filter((e=>"slack"!==e.type)).map((e=>e.blockStore.id)),filters:{requireEditPermissions:!1,excludeTemplates:!1}}),v=(0,i.useMemo)((()=>h.map((e=>e.store))),[h]),b=(0,i.useMemo)((()=>o?f?"searching":"loaded":"default"),[o,f]),S=(0,l().K8)((()=>W().default.state.mainEditorCurrentBlockStore),[]),y=(0,l().K8)((()=>{if(o)return v??[];return[...S?[S]:[],...m]}),[o,v,m,S]);(0,i.useEffect)((()=>{g&&(0,ke().Hn)({environment:u,spaceId:g,externalAuthConfig:{type:"universal",app:"slack",spaceId:g}})}),[u,g]);const{channels:C,isFetchingSlack:x}=(0,l().K8)((()=>{if(!g)return{channels:q().m.channels,isFetchingSlack:q().m.fetching};const e=q().c.getStateForBot({type:"universal",app:"slack",spaceId:g});return{channels:e.channels,isFetchingSlack:e.fetching}}),[g]),k=(0,i.useMemo)((()=>Object.values(C).map((e=>({type:"slack",channel:e})))),[C]),[I,A]=(0,i.useState)([]);(0,i.useEffect)((()=>{0===I.length&&k.length>0&&A(k)}),[k,I.length]);const w=function(e,t){const[n,o]=(0,i.useState)(e);return(0,i.useEffect)((()=>{const n=setTimeout((()=>o(e)),t);return()=>clearTimeout(n)}),[e,t]),n}(o,300),[M,T]=(0,i.useState)([]);(0,i.useEffect)((()=>{let e=!1;async function t(){if("slack"===r&&w){const t=await async function(e,t,n,o){const i=100,s=[];for(let r=0;r<t.length;r+=i){const a=t.slice(r,r+i);await new Promise((e=>setTimeout(e,0)));const l=(0,je().Ay)(e,a,n,o);s.push(...l)}return(0,je().Ay)(e,s,n,o)}(w,k,(e=>e.channel.name));e||T(t)}else T(I)}return t(),()=>{e=!0}}),[r,w,k,I]);const j=(0,i.useDeferredValue)(w),_=(0,i.useMemo)((()=>"slack"===r&&j?M:I),[r,j,I,M]),R=(0,i.useMemo)((()=>{if(!r)return{type:"choose"};const e=y.map((e=>({type:e.id===(null==S?void 0:S.id)?"currentPage":"block",blockStore:e})));if("slack"===r){let e="default";return o&&(e=x?"searching":"loaded"),{type:r,status:e,results:_}}if("notion"===r)return{type:r,status:b,results:e};(0,d().HB)(r)}),[r,o,y,_,b,x,S]);return{setCurrentSearchContext:c,searchResultMenuState:ut({currentContexts:n,state:R})}}({availableSearchContexts:p,currentContexts:n,query:g}),v=(0,i.useRef)(null),b=(0,i.useRef)(null);return(0,z.jsx)(qe().Ay,{popupType:qe().nl.Popup,open:r,onDismiss:()=>{c(!1)},placementToOrigin:Ee().W.Bottom,alignmentToOrigin:Ee().C.Start,originRect:null==b||null===(t=b.current)||void 0===t?void 0:t.getBoundingClientRect(),trapFocus:!1,sameWidthAsOrigin:!0,origin:(0,z.jsx)(Xe,{disabled:s,currentContexts:n,inputRef:v,handleUpdateContexts:o,searchResultMenuIsOpen:r,setSearchResultMenuIsOpen:c,menuListStore:u,query:g,setQuery:m,searchResultMenuState:h,contextInputRef:b}),render:()=>(0,z.jsx)(pt,{query:g,setQuery:m,availableSearchContexts:p,onSelectResult:e=>{o([e,...n]),c(!1),m("")},currentContexts:n,setCurrentSearchContext:e=>{var t;f(e),null===(t=v.current)||void 0===t||t.focus()},state:h,menuListStore:u})})}function ut(e){const{currentContexts:t,state:n}=e,o=new Set,i=new Set;for(const s of t)"block"===s.type?o.add(s.blockStore.id):"slack"===s.type?i.add(s.channel.id):"currentPage"===s.type?o.add(s.blockStore.id):(0,d().HB)(s);if("choose"===n.type)return n;if("notion"===n.type){const e=(0,A().hS)(n.results.filter((e=>!o.has(e.blockStore.id))),(e=>e.blockStore.id));return{...n,results:e}}if("slack"===n.type){const e=n.results.filter((e=>!i.has(e.channel.id))).sort(((e,t)=>e.channel.name.localeCompare(t.channel.name)));return{...n,results:e}}(0,d().HB)(n)}function pt(e){const{onSelectResult:t,availableSearchContexts:n,state:o,setCurrentSearchContext:s,menuListStore:r,query:a,setQuery:l}=e,u=(0,k().tz)(),p=(0,c().IS)((e=>({searchBox:{paddingBottom:4},backText:{color:e.lightTextColor,fontSize:12},backContentWrap:{display:"flex",alignItems:"center",cursor:"pointer",marginTop:4,marginLeft:8}})),[]),g=(0,i.useMemo)((()=>(0,je().Ay)(a,n,(e=>"notion"===e?u.formatMessage(lt.notionContextLabel):"slack"===e?u.formatMessage(lt.slackContextLabel):void(0,d().HB)(e)))),[n,a,u]),m=(0,i.useMemo)((()=>{const e={key:"no-results",render:()=>(0,z.jsx)(We().A,{title:(0,z.jsx)(k().sA,{defaultMessage:"No results found.",id:"contextTokenInput.searchResultMenu.noResults.message"})}),action:()=>{}};if("choose"===o.type)return 0===g.length?[e]:g.map((e=>({key:e,render:t=>(0,z.jsx)(mt,{...t,searchContext:e}),action:()=>{s(e),l("")}})));const n=[];return"default"===o.status||"loaded"===o.status||"searching"===o.status?0===o.results.length?"searching"===o.status?(n.push({key:"loading",render:()=>(0,z.jsx)(We().A,{title:(0,z.jsx)(k().sA,{defaultMessage:"Loading…",id:"contextTokenInput.searchResultMenu.loading.message"})}),action:()=>{}}),n):(n.push(e),n):n.concat(o.results.map((e=>"block"===e.type?{key:e.blockStore.id,render:t=>(0,z.jsx)(Fe().A,{...t,store:e.blockStore}),action:()=>{t(e)}}:"slack"===e.type?{key:e.channel.id,render:t=>(0,z.jsx)(ke().qj,{...t,channel:e.channel}),action:()=>{t(e)}}:"currentPage"===e.type?{key:`${e.blockStore.id}-currentPage`,render:t=>(0,z.jsx)(Fe().A,{...t,store:e.blockStore,right:(0,z.jsx)(Oe().A,{content:(0,z.jsx)(k().sA,{id:"ContextTokenInput.currentPage",defaultMessage:"Current page"})})}),action:()=>{t(e)}}:void(0,d().HB)(e)))):(0,d().HB)(o.status)}),[o,g,s,t,l]);return(0,z.jsx)(ae().A,{menuType:ue().gu.Popup,maxHeight:200,header:"choose"!==o.type&&n.length>1&&(0,z.jsx)("div",{style:p.backContentWrap,children:(0,z.jsx)(V().A,{ariaLabel:u.formatMessage({id:"ContextTokenInput.backButton",defaultMessage:"Back"}),icon:_e().v,onClick:()=>{s(void 0)},caption:(0,z.jsx)("div",{style:p.backText,children:(0,z.jsx)(k().sA,{id:"ContextTokenInput.backButton",defaultMessage:"Back"})}),captionStyle:{textTransform:void 0,letterSpacing:void 0}})}),children:(0,z.jsx)(Se().Ay,{type:Se().Oh.Vertical,initialFocus:0,store:r,sections:[{key:"search-results",render:e=>(0,z.jsx)(xe().A,{...e}),items:m}]})})}const gt=(0,d().u0)((e=>"slack"===e?{true:e}:{false:e})),mt=i.forwardRef(((e,t)=>{const{searchContext:n,...o}=e,i=(0,k().tz)();let s,r;return"notion"===n?s=(0,z.jsx)("img",{width:20,src:Te().A.images.notionLogoPng,alt:i.formatMessage(lt.notionIconAriaLabel)}):"slack"===n?s=(0,z.jsx)("img",{width:20,src:Te().A.images.externalIntegrations.slackIconPng,alt:i.formatMessage(lt.slackIconAriaLabel)}):(0,d().HB)(n),"notion"===n?r=i.formatMessage(lt.notionContextLabel):"slack"===n?r=i.formatMessage(lt.slackContextLabel):(0,d().HB)(n),(0,z.jsx)(ve().A,{ref:t,...o,icon:s,title:r})}));mt.displayName="SearchContextMenuItem";var ht=()=>n(792485),ft=()=>n(68465);const vt=(0,k().YK)({disabledAiCredits:{id:"AiBlockV2.disabled.aiCredits",defaultMessage:"AI is currently disabled"},currentlyGenerating:{defaultMessage:"Generation in progress",id:"AiBlockV2.currentlyGenerating"},cannotEditBlock:{defaultMessage:"This block cannot be edited",id:"AiBlockV2.cannotEditBlock"},insufficientPermissions:{defaultMessage:"You do not have permission to generate this block",id:"AiBlockV2.insufficientPermissions"},noInstructions:{defaultMessage:"No instructions provided",id:"AiBlockV2.noInstructions"}});function bt(e){const{store:t,isGenerating:n,permissionLevelCalculator:o}=e,i=(0,ht().S)(),s=(0,k().tz)(),{blockConfiguration:r}=St(t);return(0,l().K8)((()=>{const e=i&&i.publicEditModeStore.state;return(0,ft().ZE)(e)?n?{isDisabled:!0,disabledMessage:s.formatMessage(vt.currentlyGenerating)}:!t.canEdit()||t.isNonEditableState()?{isDisabled:!0,disabledMessage:s.formatMessage(vt.cannotEditBlock)}:o.canGenerateBlock()?"summarizeThisPage"===r.type||"extractKeyPointsFromThisPage"===r.type||r.autofillInstructions?{isDisabled:!1}:{isDisabled:!0,disabledMessage:s.formatMessage(vt.noInstructions)}:{isDisabled:!0,disabledMessage:s.formatMessage(vt.insufficientPermissions)}:{isDisabled:!0,disabledMessage:s.formatMessage(vt.disabledAiCredits)}}),[i,n,t,o,r,s])}function St(e){const t=(0,a().v3)();return{blockConfiguration:(0,l().K8)((()=>yt({model:e.getModel()})),[e]),updateBlockConfiguration:(0,i.useCallback)((n=>{P().createAndCommit({userAction:"AiBlock.updateBlockConfiguration",environment:t,canUndo:!0,perform:t=>{P().applyOperation({store:e,operation:y().op.update({pointer:e.pointer,path:["format"],args:{ai_block_configuration_menu:n}}),transaction:t})}})}),[t,e])}}function yt(e){var t;const{model:n}=e;if(!n)return h().Z0;const o=null===(t=W().default.state.currentSpaceStore)||void 0===t?void 0:t.getRecordModel;if(!o)return h().Z0;if(null==n||!n.getFormatValue("ai_block_configuration_menu")){const e=(0,h().Hx)({model:n,getRecordModel:o});if(e)return e}return(0,h().Lv)({model:n})}function Ct(e){const{store:t,isGenerating:n,permissionLevelCalculator:o}=e,s=bt({store:t,isGenerating:n,permissionLevelCalculator:o}),r=(0,c().IS)((()=>({generatingText:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:4,paddingBottom:4,paddingLeft:6,paddingRight:8,fontSize:14,fontWeight:400}})),[]),a=function(e){const t=(0,k().tz)(),n=(0,l().K8)((()=>{const n=e.getFormat().ai_last_edited;return n?t.formatDate(n,{day:"numeric",month:"long",year:"numeric"}):void 0}),[t,e]);return(0,l().K8)((()=>{var o;const i=e.getLastEditedTime();if(!i)return;const s=t.formatDate(i,{day:"numeric",month:"long",year:"numeric"});if(s===n)return{lastAiEditGenerationTime:n,lastEditedByName:void 0,lastHumanEditedTime:void 0};return{lastEditedByName:(null===(o=e.getLastEditedByStore())||void 0===o?void 0:o.getDisplayName(t,!1))??void 0,lastHumanEditedTime:s,lastAiEditGenerationTime:n}}),[t,n,e])}(t),d=(0,i.useMemo)((()=>n?(0,z.jsx)(k().sA,{id:"aiBlock.generate.loading.label",defaultMessage:"Generating…"}):null!=a&&a.lastAiEditGenerationTime?(0,z.jsx)(k().sA,{id:"aiBlock.configurableTitle.regenerate",defaultMessage:"Regenerate"}):(0,z.jsx)(k().sA,{id:"aiBlock.configurableTitle.editlabel",defaultMessage:"Generate"})),[n,a]);return(0,z.jsx)(B().A,{renderTooltip:()=>(0,z.jsx)(xt,{store:t,disabledResult:s,lastGeneratedProps:a}),disableTooltip:!s.isDisabled&&!a,render:e=>(0,z.jsx)("div",{style:r.generatingText,...e,children:d})})}function xt(e){const{disabledResult:t,lastGeneratedProps:n}=e,o=(0,c().IS)((e=>({disabledText:{opacity:t.isDisabled?.5:1},darkTextColor:{color:"#787774"}})),[t.isDisabled]);return t.isDisabled?(0,z.jsx)("div",{children:t.disabledMessage}):n?(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:4},children:[n.lastEditedByName&&n.lastHumanEditedTime&&(0,z.jsx)("div",{style:o.darkTextColor,children:(0,z.jsx)(k().sA,{defaultMessage:"Edited by <whiteName>{personName}</whiteName> {timestamp}",id:"AiBlockV2.lastGeneratedByHuman",values:{personName:n.lastEditedByName,whiteName:e=>(0,z.jsx)("span",{style:{color:"white"},children:e}),timestamp:n.lastHumanEditedTime}})}),(0,z.jsx)("div",{style:o.darkTextColor,children:(0,z.jsx)(k().sA,{defaultMessage:"Generated by <white>AI</white> {timestamp}",id:"AIBlockV2.LastGeneratedAt",values:{timestamp:n.lastAiEditGenerationTime,white:e=>(0,z.jsx)("span",{style:{color:"white"},children:e})}})})]}):null}const kt=(0,k().YK)({custom:{id:"AiBlockV2.skillSelector.custom",defaultMessage:"Custom"},summarize:{id:"AiBlockV2.skillSelector.summarize",defaultMessage:"Summarize"},extractKeyPoints:{id:"AiBlockV2.skillSelector.extractKeyPoints",defaultMessage:"Extract key points"}});function It(e){const{store:t,handleGenerateClick:n,isGenerating:o,permissionLevelCalculator:i,updateBlockConfiguration:s}=e,r=(0,c().IS)((()=>({popup:{marginTop:4,width:300,padding:12,paddingTop:4,display:"flex",flexDirection:"column",gap:10}})),[]),a=bt({store:t,isGenerating:o,permissionLevelCalculator:i});return(0,z.jsxs)("div",{style:r.popup,children:[(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,z.jsx)("div",{style:{fontSize:14,fontWeight:500,marginLeft:4},children:(0,z.jsx)(k().sA,{id:"aiBlock.configuration.blockSettingsTitle",defaultMessage:"AI block"})}),(0,z.jsx)(Rt,{store:t,permissionCalculator:i})]}),(0,z.jsx)(Me,{style:{marginLeft:4,marginRight:4},store:t}),(0,z.jsx)(wt,{store:t,permissionLevelCalculator:i,updateBlockConfiguration:s}),(0,z.jsx)(At,{store:t}),a.isDisabled?(0,z.jsx)(fe().E,{style:{cursor:"not-allowed"},onClick:n,isLoading:o,disabled:!0,children:(0,z.jsx)(Ct,{isGenerating:o,store:t,permissionLevelCalculator:i})}):(0,z.jsx)(Ce().A,{onClick:n,isLoading:o,children:(0,z.jsx)(Ct,{isGenerating:o,store:t,permissionLevelCalculator:i})})]})}function At(e){const t=(0,c().IS)((e=>({divider:{borderTop:`1px solid ${e.lightDividerColor}`,marginLeft:-12,marginRight:-12}})),[]),n=(0,l().K8)((()=>yt({model:e.store.getModel()})),[e.store]);return n&&"custom"===n.type?(0,z.jsx)("div",{style:t.divider}):null}function wt(e){const{store:t,permissionLevelCalculator:n,updateBlockConfiguration:o}=e,i=(0,l().K8)((()=>yt({model:t.getModel()})),[t]);if(!i)return null;switch(i.type){case"custom":return(0,z.jsx)(Tt,{blockConfiguration:i,permissionLevelCalculator:n,updateBlockConfiguration:e=>{o({...i,...e})}});case"extractKeyPointsFromThisPage":case"summarizeThisPage":return(0,z.jsx)(Mt,{});default:(0,d().HB)(i)}}function Mt(){const e=(0,c().IS)((e=>({textWrapper:{display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:4,marginRight:4},currentPageLabel:{color:e.lightTextColor,fontSize:14},pageLabel:{fontSize:14}})),[]);return(0,z.jsxs)("div",{style:e.textWrapper,children:[(0,z.jsx)("div",{style:e.pageLabel,children:(0,z.jsx)(k().sA,{defaultMessage:"Page",id:"AiBlockV2.extractKeyPointsFromThisPage.contextLabel"})}),(0,z.jsx)("div",{style:e.currentPageLabel,children:(0,z.jsx)(k().sA,{defaultMessage:"Current page",id:"AiBlockV2.extractKeyPointsFromThisPage.currentPageLabel"})})]})}function Tt(e){const{blockConfiguration:t,updateBlockConfiguration:n,permissionLevelCalculator:o}=e,s=(0,i.useCallback)((e=>{"custom"===t.type&&n({autofillInstructions:e})}),[t,n]),{store:r}=(0,ce().AI)({initialValue:"custom"===t.type?t.autofillInstructions:void 0,onChange:s}),a=(0,k().tz)(),l=t.context,d=(0,i.useCallback)((e=>{n({context:e})}),[n]),u=(0,i.useCallback)((()=>{n({dontSearchWorkspaceAndConnectors:!t.dontSearchWorkspaceAndConnectors})}),[t,n]),p=(0,c().IS)((e=>({checkboxSection:{display:"flex",alignItems:"center",paddingLeft:4},textStyle:{display:"flex",alignItems:"center",fontSize:12,paddingLeft:0,paddingRight:0,paddingTop:4,paddingBottom:4,cursor:"pointer",userSelect:"none",fontWeight:400,border:"none"},infoIconStyle:{paddingLeft:3,fill:e.lightIconColor,height:16,width:16},tooltipStyle:{width:200,whiteSpace:"normal",overflowWrap:"break-word"},selectedSourceText:{color:e.text.secondary,marginTop:2},sourcesLabel:{marginTop:4,marginBottom:-2,color:e.mediumTextColor,fontSize:12,fontWeight:500}})),[]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(_t,{store:r,placeholder:a.formatMessage({id:"AiBlockV2.AutofillInstructions.Placeholder",defaultMessage:"Describe the content that should be generated. Use '@' to mention people, pages, or dates"}),minTextHeight:115,showAtMentionMenu:!0,fontSize:14,fontWeight:400,disabled:!o.canEditConfigurationPanel(),context:l,updateContexts:d}),(0,z.jsx)("div",{style:p.sourcesLabel,children:(0,z.jsx)(k().sA,{defaultMessage:"Sources",id:"AiBlockV2ConfigurationMenu.sourcesLabel"})}),(0,z.jsx)(jt,{contexts:l,updateContexts:d,disabled:!o.canEditConfigurationPanel()}),(0,z.jsxs)(me().Y1,{direction:"vertical",gap:0,children:[(0,z.jsx)(ye().a,{selectorSize:"small",style:p.textStyle,label:(0,z.jsx)("div",{style:p.selectedSourceText,children:(0,z.jsx)(k().sA,{defaultMessage:"Use selected sources only",id:"AiBlockV2ConfigurationMenu.selectedSourcesOnly"})}),onChange:()=>{},isSelected:!0===t.dontSearchWorkspaceAndConnectors,onClick:u,value:"selected_sources",selectType:"radio"}),(0,z.jsx)(ye().a,{style:p.textStyle,selectAlignYAxis:"top",label:(0,z.jsx)("div",{style:p.selectedSourceText,children:(0,z.jsx)(k().sA,{defaultMessage:"Use selected sources and search workspace to find related information",id:"AiBlockV2ConfigurationMenu.useAllSources"})}),onChange:()=>{},selectType:"radio",isSelected:!Boolean(t.dontSearchWorkspaceAndConnectors),onClick:u,value:"all_sources",selectorSize:"small"})]})]})}function jt(e){const{contexts:t,updateContexts:n,disabled:o}=e,s=(0,l().K8)((()=>W().default.state.currentSpaceStore),[]),r=(0,a().v3)(),u=(0,l().K8)((()=>(0,d().O9)(t)&&s?t.map((e=>"page"===e.type||"collection"===e.type?{type:"block",blockStore:new(F().Bv)(r,{table:p().ev,id:e.pageId,spaceId:s.id})}:"currentPage"===e.type?{type:"currentPage",blockStore:new(F().Bv)(r,{table:p().ev,id:e.pageId,spaceId:s.id})}:"slack"===e.type?e:void(0,d().HB)(e))):[]),[t,s,r]),g=(0,i.useCallback)((e=>{if(o)return;const t=e.map((e=>{if("block"===e.type){var t;const n=null===(t=e.blockStore.getCollectionPointer())||void 0===t?void 0:t.id;return n?{pageId:e.blockStore.id,collectionId:n,type:"collection"}:{pageId:e.blockStore.id,type:"page"}}return"slack"===e.type?e:"currentPage"===e.type?{type:"currentPage",pageId:e.blockStore.id}:void(0,d().HB)(e)}));return n(t)}),[n,o]),m=(0,c().IS)((e=>({titleStyle:{fontSize:14,fontWeight:500,color:e.lightTextColor,display:"-webkit-box",lineClamp:1,WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden"}})),[]);return s?(0,z.jsx)("div",{style:m.titleStyle,children:(0,z.jsx)(be().A,{debugName:"PromptOrActionInput",capture:!0,allowMenuList:!1,allowEsc:!0,children:(0,z.jsx)(dt,{currentContexts:u,handleUpdateContexts:g,disabled:o})})}):null}function _t(e){const{store:t,minTextHeight:n=50,placeholder:o,showAtMentionMenu:r,fontSize:l=14,fontWeight:d=500,disabled:u,context:p,updateContexts:g}=e,m=(0,c().IS)((e=>({titleStyle:{color:e.lightTextColor,marginRight:4,display:"-webkit-box",lineClamp:1,WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden"},inputWrap:{display:"flex",flexDirection:"column",justifyContent:"space-between",boxShadow:e.inputBoxShadow,minHeight:n,backgroundColor:"dark"===e.mode?e.accentColors.translucentGray[100]:"transparent",borderRadius:6,overflow:"inherit",flexGrow:1,flexShrink:1,paddingLeft:6,paddingRight:6,paddingBottom:6},textContainer:{fontSize:l,fontWeight:d,flexGrow:1,padding:"4px 0",maxHeight:240,overflow:"auto"},placeholder:{color:e.text.quaternary}})),[l,d,n]),h=(0,a().v3)();(0,i.useEffect)((()=>{const e=s().A.withListenerIgnored((()=>{var e;return null===(e=W().default.state.currentSpaceStore)||void 0===e?void 0:e.id}));e&&(0,ke().Hn)({environment:h,spaceId:e,externalAuthConfig:{type:"universal",app:"slack",spaceId:e}})}),[h]);const f=(0,i.useCallback)((async()=>{const e=ge().default.state;"editing"===e.mode&&(0,pe().KP)(e.multiSelection)&&e.multiSelection.start.store===t||(ie().setSelectionAtEnd({store:t}),await $().default.afterNextFlush())}),[t]),v=(0,i.useCallback)((e=>{u||(e.preventDefault(),e.stopPropagation(),async function(){await f(),await $().default.afterNextFlush(),oe().Gf({environment:h,mentionTypes:se().Ap,usePopupOnMobile:!0,mentionSectionOrdering:se().h2})}())}),[u,h,f]),b=(0,i.useMemo)((()=>{const e=new Set;return null==p||p.forEach((t=>{"page"!==t.type&&"currentPage"!==t.type||e.add(t.pageId)})),e}),[p]),S=(0,i.useCallback)((()=>{const e=s().A.withListenerIgnored((()=>t.getValue()));if(e){const t=(0,ne().moK)(e).filter((e=>!b.has(e.id))).map((e=>({type:"page",pageId:e.id})));g([...p??[],...t])}}),[p,b,t,g]),y=(0,Q().Y)(S,200);return(0,i.useEffect)((()=>{!async function(){await $().default.afterNextFlush(),await $().default.afterNextFlush(),ie().setSelectionAtEnd({store:t})}()}),[t]),(0,z.jsxs)("div",{style:m.inputWrap,className:le().CCX,children:[(0,z.jsx)(Ie().A,{onChange:y,placeholder:o,placeholderStyle:m.placeholder,style:m.textContainer,disabled:u,store:t,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableMobileActionBar:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestEdit:!0,inPageFind:de().Os.none}),r&&(0,z.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",alignItems:"flex-end"},children:(0,z.jsx)(re().q,{onClick:v})})]})}function Rt(e){const{store:t,permissionCalculator:n}=e,o=(0,c().IS)((e=>({icon:{marginLeft:4,fill:e.lightIconColor,width:16,height:12,marginTop:2},optionIcon:{marginRight:4,fill:e.lightIconColor,width:16,height:16},dropdownLabel:{fontSize:14,fontWeight:400,display:"flex",alignItems:"center",marginRight:-4},secondaryIconColor:{color:e.lightIconColor},secondaryTextColor:{color:e.lightTextColor}})),[]),s=[{key:"custom",label:(0,z.jsx)(k().sA,{...kt.custom}),icon:e=>(0,ee().l)({...o.optionIcon,...e&&{fill:void 0}})},{key:"summarizeThisPage",label:(0,z.jsx)(k().sA,{...kt.summarize}),icon:e=>(0,Z().G)({...o.optionIcon,...e&&{fill:void 0}})},{key:"extractKeyPointsFromThisPage",label:(0,z.jsx)(k().sA,{...kt.extractKeyPoints}),icon:e=>(0,te().b)({...o.optionIcon,...e&&{fill:void 0}})}],{currentSkillType:r,updateBlockSkillType:a}=function(e){const t=(0,i.useRef)(void 0),{blockConfiguration:n,updateBlockConfiguration:o}=St(e);return{updateBlockSkillType:(0,i.useCallback)((e=>{var i;if(e===n.type)return;if(e===(null===(i=t.current)||void 0===i?void 0:i.type))return o(t.current),void(t.current=n);let s;switch(e){case"custom":s={type:"custom",version:2,title:n.title,autofillInstructions:void 0,placeholderText:void 0,context:void 0};break;case"extractKeyPointsFromThisPage":s={type:"extractKeyPointsFromThisPage",version:2,title:n.title};break;case"summarizeThisPage":s={type:"summarizeThisPage",version:2,title:n.title};break;default:(0,d().HB)(e)}t.current=n,o(s)}),[n,o]),currentSkillType:n.type}}(t),u=s.find((e=>e.key===r))??null,p=(0,i.useCallback)(((e,t)=>{a(e),t()}),[a]),g=(0,l().K8)((()=>!n.canEditConfigurationPanel()),[n]);return(0,z.jsx)(K().Ay,{isWaxPaper:!0,popupType:K().z7.Popup,disabled:g,placementToOrigin:K().sx.Top,trapFocus:!1,renderOrigin:e=>(0,z.jsxs)(he().p,{...e,style:o.dropdownLabel,hoveredStyle:{background:"rgba(0, 0, 0, 0)"},children:[null==u?void 0:u.icon(),(0,z.jsx)("div",{style:o.secondaryTextColor,children:null==u?void 0:u.label}),(0,X().b)(o.icon)]}),render:e=>{const t={menuType:ue().gu.Popup,width:220},n=[{key:"skillSelectorSection",render:e=>(0,z.jsx)(xe().A,{...e}),items:s.map((t=>({key:t.key,action:()=>p(t.key,e.close),render:e=>(0,z.jsx)(ve().A,{...e,title:t.label,shouldWrapCaption:!0,left:t.icon(!0),right:t.key===r?(0,z.jsx)("div",{style:{width:14},children:(0,J().o)()}):void 0})})))}];return(0,z.jsx)(ae().A,{...t,children:(0,z.jsx)(Se().Ay,{initialFocus:void 0,type:Se().Oh.Vertical,sections:n,style:{position:"relative"}})})}})}function Lt(e){const t=e?q().c.getStateForBot({type:"universal",app:"slack",spaceId:e}):void 0;return e=>{if("public"===e.channel.type)return!0;const n=null==t?void 0:t.channels[e.channel.id];return Boolean(n)}}function Pt(e){const{handleGenerateClick:t,store:n,isGenerating:u,permissionLevelCalculator:g,configurationPopupStore:m,traceId:h}=e,{blockConfiguration:f,updateBlockConfiguration:v}=St(n),b=bt({store:n,isGenerating:u,permissionLevelCalculator:g}),S=(0,l().K8)((()=>m.state.open),[m]),y=(0,c().IS)((e=>({openConfigurationMenuStyles:{fontWeight:400,cursor:"pointer"},faceIcon:{paddingRight:4,height:18,width:18,opacity:b.isDisabled?.5:1},divider:{borderRight:`1px solid ${e.regularDividerColor}`},actionbarWrapperStyle:{position:"absolute",zIndex:85,top:-40,right:-2,borderRadius:10,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:M().vc(r().locale).sans,background:e.popoverBackground,boxShadow:e.shadowMD,visibility:S?"hidden":"visible"}})),[b.isDisabled,S]),C=(0,a().v3)();(0,l().K8)((()=>{R().EF.state===n.pointer.id&&(!function(e){var t;const{updateBlockConfiguration:n,blockConfiguration:o,environment:i}=e,r=new Set,a=null===(t=W().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(a&&"context"in o){for(const e of o.context??[])if("collection"===e.type||"page"===e.type||"currentPage"===e.type){const t=new(F().Bv)(i,{table:p().ev,id:e.pageId,spaceId:a});s().A.withListenerIgnored((()=>!t.canRead()))&&r.add(e.pageId)}else"slack"===e.type?Lt(a)(e)||r.add(e.channel.id):(0,d().HB)(e);n({...o,context:(o.context??[]).filter((e=>"slack"===e.type?!r.has(e.channel.id):!r.has(e.pageId)))})}}({environment:C,blockConfiguration:f,updateBlockConfiguration:v}),m.setState({open:!0}),R().EF.setState(void 0))}),[f,C,n,v,m]);const x=(0,i.useCallback)((()=>{m.setState({open:!1})}),[m]),k=(0,l().K8)((()=>m.state.open),[m]),I=(0,l().K8)((()=>C.device.isMobile),[C]),A=g.canOpenConfigurationPanel();return(0,z.jsx)(o().P.div,{animate:{opacity:1},initial:{opacity:0},style:y.actionbarWrapperStyle,children:(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)(Et,{disabledResult:b,onClick:t,isGenerating:u,store:n,permissionLevelCalculator:g,traceId:h}),(0,z.jsx)("div",{style:y.divider}),(0,z.jsx)(K().Ay,{disabled:!A||I,buttonPopupStore:m,open:k,onClick:()=>{(0,E().u4)({environment:C,event:{eventName:"ai_block_settings_panel_opened",eventProperties:{}}})},render:()=>(0,z.jsx)(It,{store:n,updateBlockConfiguration:v,onClosePopup:x,handleGenerateClick:t,isGenerating:u,permissionLevelCalculator:g}),renderOrigin:e=>(0,z.jsx)(Bt,{...e,disabled:!A}),popupType:K().z7.Popup,originGap:8})]})})}const Bt=i.forwardRef((function(e,t){const{onClick:o,...i}=e,s=(0,k().tz)(),r=(0,c().IS)((()=>({wrapper:{display:"flex",alignItems:"center",cursor:"pointer",paddingLeft:10,paddingRight:10,paddingTop:6,paddingBottom:6,...i.disabled&&{cursor:"not-allowed",opacity:.5}}})),[i.disabled]);return(0,z.jsx)(B().A,{renderTooltip:()=>s.formatMessage({defaultMessage:"Insufficient permissions to view",id:"AiBlockV2.insufficientPermissionsTooltip"}),disableTooltip:!i.disabled,render:e=>(0,z.jsx)(n(704152).A,{style:r.wrapper,ignoreLocalHoverState:!0,hovered:!1,onClick:o,ref:t,...(0,n(553965).A)(i,e),children:(0,z.jsx)(k().sA,{id:"AiBlockV2.editConfiguration",defaultMessage:"Settings"})})})})),Et=i.forwardRef((function(e,t){const{onClick:n,disabledResult:o,isGenerating:i,store:s,permissionLevelCalculator:r,traceId:d}=e,u=o.isDisabled,p=(0,c().IS)((e=>({wrapper:{cursor:u?"not-allowed":"pointer",paddingTop:6,paddingBottom:6,paddingRight:6,paddingLeft:6,fontSize:12,opacity:u?.5:1,display:"flex",alignItems:"center"}})),[u]),g=(0,a().v3)(),m=(0,l().K8)((()=>g.device.isMobile),[g]);return(0,z.jsxs)("div",{style:p.wrapper,onClick:u?void 0:n,ref:t,children:[(0,z.jsx)(Ct,{isGenerating:i,store:s,permissionLevelCalculator:r}),d&&!m?(0,z.jsx)(U,{traceId:d}):null]})})),Dt=(0,k().YK)({failedToGenerate:{id:"AIBlockV2.FailedToGenerate",defaultMessage:"Failed to generate. Please try again later."}});function Ot(e){const t=(0,a().v3)(),{spaceId:n,currentUserId:o}=(0,l().K8)((()=>{var e,t;return{spaceId:null===(e=W().default.state.currentSpaceStore)||void 0===e?void 0:e.id,currentUserId:null===(t=W().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),i=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordRoleFn(t.currentUser.id),s=(0,l().K8)((()=>e.getModel()),[e]),r=(0,l().K8)((()=>{var t;return null===(t=e.getNavigableBlockStore())||void 0===t?void 0:t.pointer}),[e]);return(0,l().K8)((()=>function(e){const{model:t,spaceId:n,currentUserId:o,getRecordRole:i,getCanReadSlackChannel:s,currentPagePointer:r}=e;if(!t)return"reader";if(!n||!o)return"reader";const a=i(t.pointer)??"none";if(!(0,u().Tt)(a))return"reader";const l=i({id:n,table:m().NX})??"none";if(!(0,u().Tt)(l))return"reader";if(!(0,u().p2)(a))return"configuration_reader";const c=(0,h().Lv)({model:t});if("custom"===c.type)return f({referenceContext:c.context,getCanReadSlackChannel:s,getRecordRole:i})?"editor":"configuration_reader";if("summarizeThisPage"===c.type||"extractKeyPointsFromThisPage"===c.type)return r?f({referenceContext:[{type:"page",pageId:r.id}],getCanReadSlackChannel:s,getRecordRole:i})?"editor":"configuration_reader":"reader";(0,d().HB)(c)}({spaceId:n,currentUserId:o,getCanReadSlackChannel:Lt(n),getRecordRole:i,model:s,currentPagePointer:r})),[n,o,i,s,r])}function Wt(e){const{store:t,hoveredOrSelectionState:n,setHaloShouldBeVisible:o,showingOverlay:s,disabled:r,disableHoverMenu:c,configurationPopupStore:d}=e,u=(0,a().v3)(),p=(0,k().tz)(),g=new v(Ot(t)),m=(0,i.useCallback)((e=>{j().ui({message:e,showCancel:!1,keepFocus:!1,items:[{label:O().A.formatMessage(j()._0.dismissButtonLabel),onAccept:A().D_}]})}),[]),[h,f]=(0,i.useState)(!1),y=(0,l().K8)((()=>t.isGenerating()),[t]);(0,i.useEffect)((()=>{f(y)}),[y]);const[C,x]=(0,i.useState)(void 0),M=(0,i.useCallback)((async()=>{const e=t.getAIBlockConfig();(0,E().u4)({environment:u,event:{eventName:"ai_block_generate_clicked",eventProperties:{prompt_type:null==e?void 0:e.type,has_search_workspace_enabled:Boolean("custom"===(null==e?void 0:e.type)&&!e.dontSearchWorkspaceAndConnectors)}}}),await async function(e){const{environment:t,setIsGenerating:n,setTraceId:o,onError:i,store:s,intl:r}=e;let a;function l(){i(r.formatMessage(Dt.failedToGenerate))}n(!0);const c=async()=>{var e,n;const o=null===(e=W().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!o)return;const i=null===(n=s.getNavigableBlockStore())||void 0===n?void 0:n.pointer;if(!i)return;const r=await T().callStreamApi({eventName:"generateAiBlock",environment:t,data:{blockPointer:{...s.pointer,spaceId:o},parentPagePointer:{...i,spaceId:o}}});if((0,S().kX)(r)||"success"!==r.type||!I().hS.is(r.data))throw new Error("InvalidServerResponse");{let e=[];for await(const n of r.data){if(!(0,S().PX)(n))throw new Error("InvalidStreamResponse");a=n.traceId,Ft({environment:t,operations:n.operations,blockIds:n.blockIds,aiBlockStore:s}),e=n.operations}if(0===e.length)throw new Error("EmptyGeneration")}};try{return await(0,w().L5)({fn:c,retryAttemptsMS:[50,100,200],retryAttemptRandomOffsetMS:0,initialInput:void 0,handleError:(e,t,n)=>(t&&l(),function(e){const{type:t,aiBlockId:n,spaceId:o,miscDataToConvertToString:i}=e;b().log({from:"generateAiBlockTask",level:"error",type:t,data:{miscDataToConvertToString:{aiBlockId:n,spaceId:o,...i}}})}({aiBlockId:s.id,spaceId:s.getSpaceId(),type:e.name,miscDataToConvertToString:{source:"client",isRetrying:!t,retryAttempt:n}}),t?{status:"throw",error:e}:{status:"retry"})})}finally{n(!1),o(a)}}({environment:u,intl:p,onError:m,store:t,setIsGenerating:f,setTraceId:x})}),[u,p,m,t]),_=(0,i.useCallback)((()=>{d.setState({open:!0})}),[d]),R=(0,l().K8)((()=>!t.hasContent()),[t]),L=(0,l().K8)((()=>t.getContentStore()),[t]),P=(0,a().Y0)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{paddingLeft:8,minHeight:32},onClick:R?_:void 0,children:(0,z.jsx)(G().A,{emptyPlaceholder:(0,z.jsx)(qt,{placeholderText:p.formatMessage({id:"AiBlockV2.EmptyEditingPlaceholder3",defaultMessage:"Your AI content will be generated here - click to setup"})}),disabled:r||h,store:L,disableHoverMenu:c||n!==D().l.SelectedDescendant,disableDrag:P.isMobile})}),s&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Y().gM,{hoveredOrSelectionState:n,setHaloShouldBeVisible:o,colorVariant:"blue",configurationPopupStore:d}),(0,z.jsx)(H().s,{allowSelectionWithin:!1,children:(0,z.jsx)(Pt,{store:t,handleGenerateClick:M,isGenerating:h,permissionLevelCalculator:g,configurationPopupStore:d,traceId:C})})]})]})}function qt(e){const{placeholderText:t}=e,n=(0,c().IS)((e=>({textWrapper:{caretColor:e.lightTextColor,color:e.lightTextColor,marginTop:4,marginBottom:4,cursor:"pointer"}})),[]);return(0,z.jsx)("div",{style:n.textWrapper,children:t})}function Ft(e){const{environment:t,operations:n,blockIds:o,aiBlockStore:i}=e;0!==n.length&&P().createAndCommit({userAction:"aiBlockV2.handleGenerateStreamResponse",environment:t,canUndo:!0,perform:e=>{i.getContentIds().forEach((t=>{P().applyOperation({store:i,operation:(0,C().TQ)({blockParentId:i.id,recordId:t}),transaction:e})}));for(const o of n)if((0,x().ph)(o)){const n=new(F().Bv)(t,o.pointer);P().applyCrdtTextOperation({store:n,operation:o,invertedOperation:void 0,transaction:e})}else if((0,y().$Y)(o)||(0,y().mP)(o))switch(o.pointer.table){case p().ev:{const n=new(F().Bv)(t,o.pointer);if("set"===o.command&&0===o.path.length){const i=n.getParentStore()??(o.args.parent_id&&o.args.parent_table?new(F().pm)({environment:t,pointer:{table:o.args.parent_table,id:o.args.parent_id,spaceId:o.args.space_id??n.getSpaceId()}}):void 0),s=L().Wv({environment:t,id:o.pointer.id,type:o.args.type,properties:o.args.properties,format:o.args.format,permissions:o.args.permissions,inMemoryRecordCache:n.inMemoryRecordCache,spaceId:o.args.space_id??n.getSpaceId(),transaction:e});i&&_().NI({childStore:s,parentStore:i,transaction:e})}else P().applyOperation({store:n,operation:o,transaction:e});break}default:{const n=new(F().pm)({environment:t,pointer:o.pointer,path:o.path});P().applyOperation({store:n,operation:o,transaction:e})}}else(0,d().HB)(o);for(const n of o){const o=new(F().Bv)(t,{table:p().ev,id:n,spaceId:i.getSpaceId()});_().NI({childStore:o,parentStore:i,transaction:e})}L().zv({store:i.getFormatStore(),data:{ai_last_edited:Date.now()},transaction:e})}})}},423657:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(108944),i=()=>n(299545),s=()=>n(437622);function r(e,t){return(0,s().hN)(e)?{isGuestRequestRequired:!0}:t?{isStoreInTeam:!0,teamAllowsGuests:!0,spaceAllowsGuests:!0,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1}}const a=function(e){return(0,n(56366).K8)((()=>{if((0,i().nw)(e))return{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};if(!(0,i()._p)(e))return(0,s().r7)(e)?r(e,void 0):{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};const t=(0,o().Uo)(e),a=(0,o().pp)(e),l=a||n(351360).default.state.currentSpaceStore;if((0,s().r7)(l))return r(l,t);const c=!(null!=a&&a.getDisableGuests());return t?{isStoreInTeam:!0,teamAllowsGuests:!t.getDisableGuests(),spaceAllowsGuests:c,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:c,isGuestRequestRequired:!1}}),[e])}},454531:(e,t,n)=>{n.d(t,{W:()=>p});var o=()=>n(867772),i=()=>n(681810),s=()=>n(901389),r=()=>n(896628),a=()=>n(383594),l=()=>n(317909),c=()=>n(892632);const d=1500,u=(0,n(959013).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image link…",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function p(e){let{environment:t,intl:n,store:o,rect:i}=e;a().W(t,{originGap:3,originRect:i,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:n.formatMessage(u.pageCover),onDelete:()=>{!function(e){let{environment:t,store:n}=e;a().I(),l().createAndCommit({userAction:"PageCover.handleDelete",environment:t,canUndo:!0,perform:e=>{r().PT({store:n,transaction:e})}})}({environment:t,store:o})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:n,position:i}=e;m({environment:t,store:o,url:n,position:i})}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:n.formatMessage(u.fileTypeCaption,{idealImageWidth:d}),onUpload:e=>{a().I(),c().QM({environment:t,file:e[0],bucket:"secure",record:o.pointer,onStart:h,onProgress:f,onComplete:e=>{var n;n={environment:t,store:o,url:e},g({...n,position:.5})},onError:()=>{s().f1(n.formatMessage(u.uploadFailed))}})}},{type:"embed",title:n.formatMessage(u.embedTitle),inputPlaceholder:n.formatMessage(u.embedPlaceholder),caption:n.formatMessage(u.embedCaption),buttonText:n.formatMessage(u.embedSubmit),onChange:e=>{var n;n={environment:t,store:o,url:e},g({...n,position:.5}),a().I()}},{type:"unsplash",onChange:e=>{let{url:n,position:i}=e;m({environment:t,store:o,url:n,position:i})}}]})}async function g(e){const{environment:t,store:n,url:s,position:a}=e,{serverCommitResult:c}=l().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{r().fg({store:n,url:s,position:a||.5,transaction:e})}});await c,i().A.state.loadingMode===o().vS&&i().A.setState({loadingMode:o().Gi,dataURL:i().A.state.dataURL,uploadProgress:100})}function m(e){g(e),e.environment.device.isMobile&&a().I()}function h(e){const{file:t,name:n,size:s}=e;if(a().I(),i().A.setState({loadingMode:o().Wc,file:t,name:n,size:s}),t instanceof File&&t.type.indexOf("image")>=0){const e=new FileReader;e.onload=e=>{i().A.state.loadingMode===o().Wc&&i().A.setState({...i().A.state,uploadProgress:0,loadingMode:o().vS,dataURL:e.target.result})},e.readAsDataURL(t)}}function f(e){const{progressPercent:t}=e;i().A.state.loadingMode===o().vS&&i().A.setState({...i().A.state,uploadProgress:t})}},518598:(e,t,n)=>{n.d(t,{K:()=>d});n(296540);var o=()=>n(426388),i=()=>n(959013),s=()=>n(705540),r=()=>n(285790),a=()=>n(745766),l=n(474848);const c=(0,i().YK)({menu:{defaultMessage:"Menu",id:"topbar.appMenuButton.title"}});function d(){const e=(0,i().tz)();return(0,l.jsx)(r().A,{style:{position:"absolute",top:"10px",left:"14px",width:24,height:24,zIndex:1e5,...(0,a().g)({noDrag:!0})},iconStyle:{width:16,height:16},isDarkIconColor:!0,onClick:()=>{s().openAppMenu()},icon:o().S,ariaLabel:e.formatMessage(c.menu)})}},541235:(e,t,n)=>{n.d(t,{YD:()=>s,c$:()=>o,q_:()=>i});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]}},i="completed",s="dismissed"},555267:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(296540),i=()=>n(401497),s=()=>n(62856),r=()=>n(331542),a=n(474848);function l(e){let{loadingMessage:t}=e;const n=(0,i().DP)(),l=(0,s().A)(!0,400);return(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:l&&(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(r().A,{}),t&&(0,a.jsx)("div",{style:{marginLeft:8,color:n.text.secondary},children:t})]})})}},555555:(e,t,n)=>{n.d(t,{n:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("import",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},567121:(e,t,n)=>{n.d(t,{EG:()=>r,K5:()=>s,RH:()=>i,Yi:()=>a,ls:()=>o});const o=32,i=202,s=1e3,r="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",a="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},578194:(e,t,n)=>{n.d(t,{r:()=>o});const o=(0,n(583835).Dv)("importEvernote")},599500:(e,t,n)=>{n.d(t,{g:()=>b});n(296540);var o=()=>n(484714),i=()=>n(56366),s=()=>n(401497),r=()=>n(101847),a=()=>n(959013),l=()=>n(100622),c=()=>n(704152),d=()=>n(460292),u=()=>n(554509),p=()=>n(859428),g=()=>n(437622),m=()=>n(58293),h=()=>n(962730),f=()=>n(10984),v=n(474848);function b(e){let{onClick:t,showIcon:n=!0}=e;const s=y(n),r=(0,o().v3)(),l=(0,m().r)(),d=(0,i().K8)((()=>l&&(0,g().GK)(r,l)),[r,l]),b=(0,i().K8)((()=>(0,f().AI)()),[]);return void 0===t?(0,v.jsx)("div",{style:{...s.badge,cursor:"default"},children:(0,v.jsx)(S,{showIcon:n})}):(0,v.jsx)(p().A,{placement:h().W.Bottom,style:s.tooltip,render:e=>(0,v.jsx)(c().A,{onClick:t,style:{...s.badge,cursor:"pointer"},hoveredStyle:s.badgeHover,pressedStyle:s.badgePressed,...e,children:(0,v.jsx)(S,{showIcon:n})}),renderTooltip:()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u().D,{styleName:"UISmall-12px/Medium",colorName:"contrastPrimary",children:(0,v.jsx)(a().sA,{id:"trialBadge.tooltip.title",defaultMessage:"{hasSpaceName, select, true {{spaceName}} other {Your workspace}} is on a free {planName, select, plus {Plus} business {Business} enterprise {Enterprise} other {}} trial",values:{hasSpaceName:Boolean(d),spaceName:d,planName:b}})}),(0,v.jsx)(u().D,{styleName:"UISmall-12px/Regular",colorName:"contrastSecondary",children:(0,v.jsx)(a().sA,{id:"trialBadge.tooltip.description",defaultMessage:"Click to learn more"})})]}),textWrap:!0})}function S(e){let{showIcon:t}=e;const n=y(t);return(0,v.jsxs)(v.Fragment,{children:[t?(0,v.jsx)("span",{style:n.giftIcon,children:(0,v.jsx)(d().Q,{iconGroup:r().T,variantName:"mini",colorName:"orangePrimary"})}):null,(0,v.jsx)(u().D,{styleName:"UISmall-12px/Medium",children:(0,v.jsx)(a().sA,{id:"trialBadge.title",defaultMessage:"Free trial"})})]})}function y(e){return(0,s().IS)((t=>({badge:{display:"flex",flexDirection:"row",gap:4,justifyContent:"center",alignItems:"center",color:t.icon.orangePrimary,background:t.fill.orangeSecondary,padding:e?"0px 6px 0px 4px":"0px 6px",height:e?22:20,borderRadius:6,width:"fit-content"},badgeHover:{background:l().XA[t.mode].orange[100]},badgePressed:{background:l().XA[t.mode].orange[200]},tooltip:{maxWidth:"240px",width:"max-content",display:"flex",padding:"4px 6px",flexDirection:"column",alignItems:"flex-start",gap:2,borderRadius:4},giftIcon:{paddingBottom:1}})),[e])}},608581:(e,t,n)=>{n.d(t,{A:()=>d});n(898992),n(354520),n(581454),n(941795);var o=n(296540),i=()=>n(401497),s=()=>n(451306),r=()=>n(284371),a=()=>n(963575),l=n(474848);function c(e){const{button:t,isLast:n}=e,a=(0,i().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return o.cloneElement(t,{...(0,s().AH)(t.props.style,a.button,n&&a.buttonLast),hoveredStyle:(0,s().AH)(a.buttonHovered,n&&a.buttonLast).style,pressedStyle:a.buttonPressed})}const d=function(e){let{children:t,isVisible:d,position:u,style:p}=e;const g=(0,n(484714).v3)(),m=(0,i().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:a().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:g.device.isMobile?"auto":"none",opacity:g.device.isMobile?1:0,fontFamily:r().vc(n(662303).locale).sans,position:"absolute",right:a().A.horizontal.small,bottom:a().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:a().A.vertical.small,bottom:void 0}})),[g]),h=o.Children.toArray(t).filter(n(534177).O9),f=h.length;return(0,l.jsx)(n(145214).A,{animate:{opacity:d?1:0},...(0,s().AH)(m.container,p,d&&m.containerHover,"top"===u&&m.containerTop),children:h.map(((e,t)=>{const i=t===f-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===n(859428).A&&o.isValidElement(e))return o.cloneElement(e,{render:(t,n)=>{const o=e.props.render(t,n);return(0,l.jsx)(c,{isLast:i,button:o},e.key)}});if(e.type===n(704152).A&&o.isValidElement(e))return(0,l.jsx)(c,{isLast:i,button:e},e.key)}}))})}},643381:(e,t,n)=>{n.d(t,{l:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("repeat",{viewBox:"0 0 16 14",svg:(0,o.jsx)("path",{d:"M1.185 7.317a.689.689 0 00.697-.704v-.601c0-1.19.806-1.942 2.064-1.942H9.23v1.573c0 .328.199.52.527.52a.66.66 0 00.403-.144l2.68-2.236c.253-.212.26-.547 0-.765L10.16.782A.62.62 0 009.757.64c-.328 0-.527.184-.527.52v1.53H4.05C1.875 2.69.48 3.9.48 5.875v.738c0 .397.308.704.705.704zm13.624-.649a.689.689 0 00-.698.704v.608c0 1.19-.806 1.942-2.064 1.942H6.763V8.35c0-.329-.199-.52-.527-.52a.66.66 0 00-.403.144l-2.68 2.242c-.26.212-.26.547 0 .759l2.68 2.242a.66.66 0 00.403.143c.328 0 .527-.191.527-.52v-1.544h5.181c2.174 0 3.569-1.21 3.569-3.179v-.745a.695.695 0 00-.704-.704z"})})},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var o=n(296540),i=()=>n(56366),s=()=>n(959013),r=()=>n(743260),a=()=>n(299545),l=()=>n(417555),c=()=>n(856952),d=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:g,handleInputChange:m,handleInputSubmit:h,defaultRoleForNonBot:f,right:v,focus:b,handleFocus:S}=e,y=(0,i().K8)((()=>0!==(0,n(731320).Qo)()),[]),C="share_menu"===t||"add_members"===t,x="add_members"===t,[k,I]=(0,i().$y)(u),A=(0,n(484714).v3)(),{device:w}=A,M=(0,s().tz)(),{tokenQuery:T}=k,j=(0,n(101749).N)(p),_=k.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,r().yi)(e),a="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,c=i?j:void 0,u={key:t,target:e,onClickRemove:g,role:k.inviteRole,shouldWrap:C,showInfoIcon:Boolean(c)};return C&&a?(0,d.jsx)(n(859428).A,{placement:n(962730).W.Top,disableTooltip:x,renderTooltip:()=>i?c||(0,d.jsx)(s().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:a}}):a,render:n=>(0,o.createElement)("span",{...n,key:t},(0,d.jsx)(l().A,{...u,backgroundColor:(0,r().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})}));return(0,d.jsx)(c().Ay,{focus:w.isMobile?void 0:b,focusInitial:w.isMobile,focusAfterAnimation:!0,onClick:()=>{w.isMobile||null==S||S()},format:c().le.Share,value:T,onChange:m,type:"email",tokens:_,disabled:!1,autoComplete:"off",placeholder:C?y?M.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):M.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,a().Yu)(p)||(0,a().nw)(p)?M.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):M.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...k};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=f),I(k)},right:v,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:A.device.isMobile?0:k.isInviteTargetsEmpty?7:6,paddingBottom:A.device.isMobile||C?0:4},onEmptySubmit:()=>h(),dontShowBorderBottom:w.isAndroid,showBorder:C,...!C&&{style:{padding:"10px  9px 4px 9px"}},...C&&{style:{borderRadius:4,paddingTop:k.isInviteTargetsEmpty?3:0,paddingBottom:0,...b&&{background:"none"}}}})}},675910:(e,t,n)=>{n.d(t,{M:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("clockAlternate",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M10.417 6.09961C10.5811 6.09961 10.7201 6.15885 10.834 6.27734C10.9525 6.39128 11.0117 6.53027 11.0117 6.69434V11.2949L10.376 9.34668L12.5977 12.3408C12.7116 12.4867 12.7617 12.6416 12.748 12.8057C12.7344 12.9697 12.6592 13.0996 12.5225 13.1953C12.3721 13.3001 12.2148 13.3389 12.0508 13.3115C11.8913 13.2842 11.75 13.1908 11.627 13.0312L9.99316 10.8779C9.93392 10.8005 9.89062 10.7253 9.86328 10.6523C9.83594 10.5749 9.82227 10.4928 9.82227 10.4062V6.69434C9.82227 6.53027 9.87923 6.39128 9.99316 6.27734C10.1117 6.15885 10.2529 6.09961 10.417 6.09961ZM10.6768 17.126C9.93848 17.126 9.22298 17.0098 8.53027 16.7773C7.84212 16.5495 7.20638 16.2259 6.62305 15.8066C6.04427 15.3919 5.54297 14.9111 5.11914 14.3643C4.96875 14.182 4.90495 13.9928 4.92773 13.7969C4.95052 13.6009 5.03939 13.446 5.19434 13.332C5.36296 13.2135 5.53841 13.1748 5.7207 13.2158C5.90299 13.2568 6.06478 13.3571 6.20605 13.5166C6.54785 13.9678 6.94889 14.3597 7.40918 14.6924C7.87402 15.0205 8.37988 15.2734 8.92676 15.4512C9.47819 15.6335 10.0615 15.7269 10.6768 15.7314C11.4606 15.736 12.1943 15.5902 12.8779 15.2939C13.5661 15.0023 14.1676 14.599 14.6826 14.084C15.2021 13.5645 15.6077 12.9629 15.8994 12.2793C16.1956 11.5911 16.3438 10.8529 16.3438 10.0645C16.3438 9.2806 16.1956 8.54688 15.8994 7.86328C15.6077 7.17513 15.2021 6.57357 14.6826 6.05859C14.1676 5.53906 13.5661 5.13346 12.8779 4.8418C12.1943 4.55013 11.4606 4.4043 10.6768 4.4043C9.88835 4.4043 9.15234 4.55013 8.46875 4.8418C7.78971 5.12891 7.19043 5.52995 6.6709 6.04492C6.15137 6.5599 5.74349 7.15918 5.44727 7.84277C5.1556 8.52181 5.00749 9.25326 5.00293 10.0371H3.6084C3.61296 9.07096 3.7998 8.16406 4.16895 7.31641C4.53809 6.46875 5.0485 5.72135 5.7002 5.07422C6.35189 4.42708 7.10156 3.92122 7.94922 3.55664C8.80143 3.1875 9.71061 3.00293 10.6768 3.00293C11.6429 3.00293 12.5521 3.1875 13.4043 3.55664C14.2565 3.92578 15.0062 4.4362 15.6533 5.08789C16.305 5.73503 16.8154 6.4847 17.1846 7.33691C17.5537 8.18913 17.7383 9.09831 17.7383 10.0645C17.7383 11.0306 17.5537 11.9398 17.1846 12.792C16.8154 13.6442 16.305 14.3962 15.6533 15.0479C15.0062 15.6995 14.2565 16.2077 13.4043 16.5723C12.5521 16.9414 11.6429 17.126 10.6768 17.126ZM2.78809 8.66992H6.16504C6.33822 8.66992 6.4681 8.71094 6.55469 8.79297C6.64583 8.87044 6.68913 8.9707 6.68457 9.09375C6.68001 9.21224 6.63216 9.33984 6.54102 9.47656L4.87988 11.7803C4.76595 11.9352 4.63151 12.015 4.47656 12.0195C4.32161 12.0195 4.1849 11.9398 4.06641 11.7803L2.40527 9.47656C2.31413 9.3444 2.26628 9.2168 2.26172 9.09375C2.25716 8.9707 2.29818 8.87044 2.38477 8.79297C2.47591 8.71094 2.61035 8.66992 2.78809 8.66992Z"})})},681810:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(867772).Ay)},710857:(e,t,n)=>{n.d(t,{x:()=>i});const o={greeting:!0,tasks:!1,tips:!1,templates:!1,calendar:!1,custom_db:!1};function i(e){const t=(null==e?void 0:e.getHomeEnabledFeatures())??{};return{...o,...t}}},714300:(e,t,n)=>{n.d(t,{l:()=>l});var o=()=>n(484714),i=()=>n(56366),s=()=>n(176983),r=()=>n(596513),a=()=>n(324561);function l(e){let{spaceId:t}=e;const n=(0,o().v3)(),l=(0,s().J)();return(0,i().K8)((()=>{if(!t||!l)return;const e=r().t.getData(n,{spaceId:t});return(0,a().a9)(e)}),[n,t,l],{useDeepEqual:!0})}},739135:(e,t,n)=>{n.d(t,{KD:()=>c,gt:()=>d,i9:()=>l,ll:()=>r,tb:()=>a,x$:()=>s});var o=()=>n(541235),i=()=>n(496603);function s(e,t){return r(d(e,t))}function r(e){return void 0!==e&&(e===o().q_||e===o().YD)}function a(e,t){if(r(t))return;const n=o().c$[e],i=n.steps.findIndex((e=>e.id===t));return-1===i?n.steps[0].id:i===n.steps.length-1?o().q_:n.steps[i+1].id}function l(e,t){const n=d(e,t);if(n&&!r(n))return a(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=o().c$[e];var s;if(r(t))return null===(s=(0,i().HV)(n.steps))||void 0===s?void 0:s.id;const a=n.steps.findIndex((e=>e.id===t));return-1!==a&&0!==a?n.steps[a-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const i=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===i?o().c$[t].steps[0].id:i}},748539:(e,t,n)=>{n.d(t,{f:()=>o});const o=new(n(645873).O2)("pageCovers",(async()=>n.e(40198).then(n.bind(n,193645))))},756114:(e,t,n)=>{n.d(t,{D:()=>o});function o(e,t){t.route.name;return!1}},765974:(e,t,n)=>{n.d(t,{b:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M11.84 3.563c-.817-1.417-2.862-1.417-3.68 0L2.314 13.688c-.818 1.416.205 3.187 1.84 3.187h11.692c1.636 0 2.658-1.77 1.84-3.187zM9.876 6.75c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5"})},i=(0,n(340498).wt)("exclamationMarkTriangleFill",o)},777092:(e,t,n)=>{n.d(t,{JQ:()=>d,d5:()=>u,vt:()=>c});var o=()=>n(764880),i=()=>n(310442),s=()=>n(824862),r=()=>n(798880),a=()=>n(534177),l=()=>n(630116);function c(e){const{parentStore:t,pointer:n}=e,i=(0,l().Oo)(t,n).getValue();if(i)return(0,o().D3)({table:n.table,value:i})}function d(e){const{parentStore:t,pointer:n}=e;return n.table===s().GP?l().vK.createChildStore(t,n):n.table===r().oo?l().LU.createChildStore(t,n):n.table===i().yj?l().pH.createChildStore(t,n):void(0,a().HB)(n)}function u(e){return e.table===s().GP?(0,o().oC)(e.getValue()):e.table===r().oo?(0,o().MR)(e.getValue()):e.table===i().yj?(0,o().w2)(e.getValue()):void(0,a().HB)(e)}},801678:(e,t,n)=>{n.d(t,{A:()=>f});var o=n(296540),i=()=>n(662303),s=()=>n(484714),r=()=>n(56366),a=()=>n(451306),l=()=>n(959013),c=()=>n(100622),d=()=>n(496603),u=()=>n(284371),p=()=>n(720665),g=()=>n(145214),m=n(474848);const h={isRepositioning:!1};const f=function(e){const t=(0,o.useRef)(null),i=(0,s().v3)(),{isMobile:l}=(0,s().Y0)(),[c,u]=(0,o.useState)(h),g=(0,o.useCallback)((()=>{u(h)}),[]),{renderControl:f,onFlushTemporaryPosition:b,style:S,source:y,store:C}=e,{isRepositioning:x,image:k,startDragRenderedPosition:I,startDragImageScreenHeight:A}=c,w=(0,r().K8)((()=>0===n(502438).default.state.stores.length),[]),[M,T]=(0,o.useState)(!1),j=(0,r().uB)(e.mouseStore,n(454305).A),_=(0,r().K8)((()=>j.state.mouseEntered),[j]),R=(0,n(401497).IS)((()=>({dragContainer:{width:"100%",cursor:x?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[x]),L=(0,r().K8)((()=>function(e,t,n){return(0,d().Et)(n)?n:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,d().Et)(e))return e}const n=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,p().pN)(t)?n:t}}const o=t.getFormat(),i=o.page_cover_position;if((0,d().Et)(i))return i;return n}(e,t)}(y,C,c.temporaryPosition)),[c.temporaryPosition,y,C]);(0,o.useEffect)((()=>{const e=e=>{const n=t.current;n&&!n.contains(e.target)&&x&&b({imagePosition:L,reset:()=>{j.reset(),g()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[L,x,j,b,g]),x&&!w&&g();const P=(0,o.useMemo)((()=>(0,d().nF)((e=>{j.setState({...j.state,mouseEntered:!0})}),100)),[j]),B=(0,o.useMemo)((()=>(0,d().sg)((e=>{j.setState({...j.state,mouseEntered:!1})}),100)),[j]),E=(0,o.useCallback)(((e,t)=>{n(778417).IU({environment:i});const o=new Image;o.onload=()=>{u((e=>({...e,isRepositioning:!0,image:o})))},t&&(o.src=t)}),[i]),D=(0,o.useCallback)((e=>{b({imagePosition:L,reset:()=>{g()}})}),[L,b,g]),O=(0,o.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,n(819121).p)(t)&&T(!0)}),[]),W=(0,o.useCallback)((()=>{T(!0)}),[]),q=(0,o.useCallback)((e=>{if(k&&x){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/k.width*k.height;u((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:L})))}}}),[k,L,x]),F=(0,o.useCallback)((e=>{if(x){const t=e.diffY/(A||0)+(I||0);u((e=>({...e,temporaryPosition:(0,d().LI)((0,n(40845).A)(t,0,1),4)})))}}),[x,A,I]),H=(0,o.useCallback)((()=>{u((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),K=(0,r().K8)((()=>f({handleRepositionClick:E,handleSavePositionClick:D,handleCancelClick:g,isVisible:l||_||M||x,isRepositioning:x})),[E,D,M,l,x,_,f,g]);return(0,m.jsxs)("div",{ref:t,onFocus:O,onBlur:W,onMouseEnter:P,onMouseMove:P,onMouseLeave:B,...(0,a().AH)(R.container,S),children:[(0,m.jsx)(n(603820).A,{onDraggableDragStart:q,onDraggableDragMove:F,onDraggableDragEnd:H,onDraggableDragCancel:H,disabled:!x,render:t=>(0,m.jsx)("div",{...(0,a().AH)(R.dragContainer),...t,children:e.render({imagePosition:L,isRepositioning:x})})}),(0,m.jsx)(v,{small:e.small,isRepositioning:x}),K]})};function v(e){let{small:t,isRepositioning:n}=e;if(t)return null;const o={background:c().Ay.blackWithAlpha(.4),borderRadius:4,color:c().Ay.white,fontSize:12,fontFamily:u().vc(i().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,m.jsx)(g().A,{visible:n,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:o,children:(0,m.jsx)(l().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},846199:(e,t,n)=>{n.d(t,{A:()=>o});const o=n(757695).default.createValue({open:!1},{name:"TrialInfoModalStore"})},867772:(e,t,n)=>{n.d(t,{Ay:()=>l,Gi:()=>s,Wc:()=>o,pF:()=>r,vS:()=>i});const o="loadingLocalImage",i="uploading",s="downloading",r="loaded";class a extends(()=>n(757695))().default{getInitialState(){return{loadingMode:r}}}const l=a},893627:(e,t,n)=>{n.d(t,{K:()=>r});var o=n.n(n(440537)),i=()=>n(132456),s=()=>n(206267);class r{constructor(e){this.environmentName=void 0,this.mainShortId=void 0,this.getSettings=void 0,this.isServerOriginated=void 0,this.mapSpaceIdToShortId=void 0,this.idCreatorLogger=void 0,this.environmentName=e.environmentName,this.mainShortId=n(851941).Yf[this.environmentName],this.getSettings=e.getSettings,this.isServerOriginated=e.isServerOriginated,this.mapSpaceIdToShortId=e.mapSpaceIdToShortId,this.idCreatorLogger=e.idCreatorLogger??(()=>{})}idInMain(e){const{enableTestDateOffset:t,enableIdSchema:o}=this.getSettings();return o&&e!==n(867178).wI?(this.idCreatorLogger(void 0,e,t?"id_schema_test":"id_schema"),(0,i().J4)(t,this.mainShortId,e,this.isServerOriginated)):this.legacyId(e,"disabled")}pointerInMain(e){return{table:e,id:this.idInMain(e)}}async idWithSpaceId(e,t){const{enableTestDateOffset:n,enableIdSchema:s}=this.getSettings();if(!s||"space"===t)return this.legacyId(t,"disabled");const r=this.mapSpaceIdToShortId(e),a=o().types.isPromise(r)?await r:r;return a?(this.idCreatorLogger(e,t,n?"id_schema_test":"id_schema"),(0,i().kw)(n,a,t,this.isServerOriginated)):this.legacyId(t,"missing_short_id")}async pointerWithSpaceId(e,t){return{table:t,spaceId:e,id:await this.idWithSpaceId(e,t)}}idWithSpaceShortId(e,t){const{enableTestDateOffset:n,enableIdSchema:o}=this.getSettings();return o&&"space"!==t?(this.idCreatorLogger(void 0,t,n?"id_schema_test":"id_schema"),(0,i().kw)(n,e,t,this.isServerOriginated)):this.legacyId(t,"disabled")}legacyId(e,t){return this.idCreatorLogger(void 0,e,t),s().JW()}async deterministicIdWithSpaceId(e,t,n){const{enableTestDateOffset:r,enableIdSchema:a}=this.getSettings();if(!a)return this.idCreatorLogger(e,t,"disabled"),s().gB(n);const l=this.mapSpaceIdToShortId(e),c=o().types.isPromise(l)?await l:l;return c?(this.idCreatorLogger(e,t,r?"id_schema_test":"id_schema"),(0,i().lf)(c,t,n)):(this.idCreatorLogger(e,t,"missing_short_id"),s().gB(n))}deterministicIdWithSpaceShortId(e,t,n){const{enableTestDateOffset:o,enableIdSchema:r}=this.getSettings();return r?(this.idCreatorLogger(void 0,t,o?"id_schema_test":"id_schema"),(0,i().lf)(e,t,n)):(this.idCreatorLogger(void 0,t,"disabled"),s().gB(n))}async getSpaceIdCreator(e){if(!e)return new a(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new a(e,this.idCreatorLogger);const n=this.mapSpaceIdToShortId(e),i=o().types.isPromise(n)?await n:n;return this.getSpaceShortIdCreator(e,i)}getSpaceIdCreatorSync(e){if(!e)return new a(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new a(e,this.idCreatorLogger);const n=this.mapSpaceIdToShortId(e),i=o().types.isPromise(n)?void 0:n;return this.getSpaceShortIdCreator(e,i)}getSpaceShortIdCreator(e,t){const{enableIdSchema:n}=this.getSettings();return n&&t?new l(e,this,t):new a(e,this.idCreatorLogger)}async getSpaceIdCreatorFromModel(e){return e.getShortIdStr()?this.getSpaceShortIdCreator(e.id,Number(e.getShortIdStr())):await this.getSpaceIdCreator(e.id)}}class a{constructor(e,t){this.spaceId=void 0,this.idCreatorLogger=void 0,this.spaceId=e,this.idCreatorLogger=t}idInSavedSpace(e){return this.idCreatorLogger(void 0,e,"disabled"),s().JW()}idInMain(e){return this.idCreatorLogger(void 0,e,"disabled"),s().JW()}deterministicIdInSavedSpace(e,t){return this.idCreatorLogger(void 0,e,"disabled"),s().gB(t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}class l{constructor(e,t,n){this.spaceId=void 0,this.idCreator=void 0,this.spaceShortId=void 0,this.spaceId=e,this.idCreator=t,this.spaceShortId=n}idInSavedSpace(e){return this.idCreator.idWithSpaceShortId(this.spaceShortId,e)}idInMain(e){return this.idCreator.idInMain(e)}deterministicIdInSavedSpace(e,t){return this.idCreator.deterministicIdWithSpaceShortId(this.spaceShortId,e,t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}},943647:(e,t,n)=>{n.d(t,{A:()=>b});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(959013),a=()=>n(896628),l=()=>n(454531),c=()=>n(317909),d=()=>n(478726),u=()=>n(867772),p=()=>n(681810),g=()=>n(608581),m=()=>n(145214),h=()=>n(704152),f=()=>n(24611),v=n(474848);const b=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:d,height:g,proxyWidth:m}=e;const h=(0,i().v3)(),f=(0,s().uB)(void 0,n(454305).A),b=(0,s().K8)((()=>r||"suggest"===n(77246).Uv.getMode(t)),[r,t]),C=(0,s().K8)((()=>t.getCover()),[t]),x=(0,s().O$)(p().A),[k,I]=(0,o.useState)(void 0);if(!C)return null;const A=x.loadingMode!==u().pF&&x.loadingMode!==u().Wc;return(0,v.jsx)(n(801678).A,{mouseStore:f,onFlushTemporaryPosition:e=>function(e,t,n){const{imagePosition:o,reset:i}=e;c().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:n,canUndo:!0,perform:e=>{a().yY({store:t,coverPosition:o,transaction:e}),i()}})}(e,t,h),renderControl:e=>{let{handleRepositionClick:n,handleSavePositionClick:o,handleCancelClick:i,isVisible:s,isRepositioning:r}=e;return(0,v.jsx)(y,{handleRepositionClick:n,handleSavePositionClick:o,handleCancelClick:i,isVisible:s,isRepositioning:r,lastProxiedUrl:k,store:t,disabled:b,paddingRight:l,paddingLeft:d,mouseStore:f})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:g,maxHeight:280,cursor:"default"},render:e=>(0,v.jsxs)(o.Fragment,{children:[(0,v.jsx)(n(360083).A,{url:C.cover,isAuthenticated:!0,permissionRecord:C.pointer,width:m,onFinishedLoadingProxyUrl:I,render:(t,o)=>{const i={width:"100%",height:g,maxHeight:280,objectFit:"cover",opacity:A?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:g,maxHeight:280};return(0,v.jsx)(n(307440).E,{src:o,placeholderSrc:A?x.dataURL:void 0,placeholderBehavior:A?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:i,onLoadComplete:S,testId:"pageCover"})}}),A&&(0,v.jsxs)("div",{style:n(816559).fd,children:[(0,v.jsx)(n(331542).A,{size:"md",style:{marginRight:4}}),(0,v.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,v.jsx)(n(773382).A,{percentage:x.uploadProgress})})]})]})})};function S(){p().A.reset()}function y(e){let{isVisible:t,isRepositioning:n,handleCancelClick:a,handleRepositionClick:c,handleSavePositionClick:b,lastProxiedUrl:S,store:y,disabled:C,paddingRight:x,paddingLeft:k,mouseStore:I}=e;const A=(0,i().v3)(),w=(0,r().tz)(),M=(0,o.useCallback)((e=>function(e,t,n,o,i){i.reset();const s=e.target.getBoundingClientRect();l().W({environment:t,intl:n,store:o,rect:s})}(e,A,w,y,I)),[A,w,y,I]),T=(0,s().K8)((()=>p().A.state.loadingMode),[]),j=(0,s().K8)((()=>function(e){let t;return t=e.isFullWidth()?"100%":d().x6,t}(y)),[y]);if(C||T!==u().pF)return null;const{device:_}=A,{isMobile:R}=_;return(0,v.jsx)(m().A,{animate:{width:j,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,v.jsxs)(g().A,{isVisible:t,position:"bottom",style:{marginRight:x,marginLeft:k},children:[!n&&(0,v.jsx)(h().A,{style:{borderRight:R?"none":void 0,...f().k},onClick:M,children:(0,v.jsx)(r().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!n&&!R&&(0,v.jsx)(h().A,{style:{...f().k,borderRight:"none"},onClick:e=>c(e,S),children:(0,v.jsx)(r().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),n&&!R&&(0,v.jsx)(h().A,{style:f().k,onClick:b,children:(0,v.jsx)(r().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),n&&!R&&(0,v.jsx)(h().A,{style:{...f().k,borderRight:"none"},onClick:a,children:(0,v.jsx)(r().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}},969339:(e,t,n)=>{n.d(t,{C6:()=>r,HQ:()=>s,Yo:()=>a});var o=()=>n(645873);const i=new(o().O2)("login",(async()=>{const{default:e}=await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(96966)]).then(n.bind(n,465209)),{default:t}=await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(96966)]).then(n.bind(n,406370)),{default:o}=await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(96966)]).then(n.bind(n,737515)),{default:i}=await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(96966)]).then(n.bind(n,465833)),{default:s}=await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(96966)]).then(n.bind(n,52542));return{LoginPage:e,LoginDesktop:t,LoginMobileNative:o,FrontLoginPage:i,LoginModalContent:s}})),s=(0,o()._h)(i,(e=>e.LoginPage)),r=(0,o()._h)(i,(e=>e.FrontLoginPage)),a=(0,o()._h)(i,(e=>e.LoginModalContent))},980151:(e,t,n)=>{n.d(t,{WO:()=>u,_V:()=>p,hK:()=>g});var o=()=>n(869558),i=()=>n(854150),s=()=>n(317909),r=()=>n(559102),a=()=>n(100875),l=()=>n(162674),c=()=>n(710857),d=()=>n(351360);function u(e){const{environment:t,currentSpaceViewStore:n,...o}=e;if(!n.getModel())return;const i=!(0,c().x)(n)[e.feature];s().createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,canUndo:!0,perform:t=>{s().applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:i}},transaction:t})}}),(0,l().f_)({environment:t,show:i,...o})}function p(e){let{environment:t,option:n,from:o,userAction:i}=e;const r=d().default.state.currentSpaceViewStore;if(!r)return!1;const c=r.getOnAppStartStore().getValue();return s().createAndCommit({userAction:i,environment:t,canUndo:!0,perform:e=>{s().applyOperation({store:r,operation:{pointer:r.pointer,path:["settings","on_app_start"],command:"set",args:n},transaction:e})}}),(0,a().cq)({spaceView:r.getModel(),preference:n}),(0,l().lr)({environment:t,oldValue:c,newValue:n,from:o}),!0}function g(e){const{environment:t,selectedStore:n,currentSpaceViewStore:a,collectionContextStore:c}=e,d=c.collectionViewStore(),u=c.collectionStore(),p=c.collectionViewBlockStore();if(!(u&&d&&p&&a))return;const g=a.getTeamsStores(),m=n.table===i().yK?g.indexOf(n)+1:0,h=n.table===i().yK?n.id:void 0;s().createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",canUndo:!0,perform:e=>{s().applyOperation({store:d,operation:{pointer:{id:d.id,table:o().Gy},path:["format","collection_view_source","teamId"],command:"set",args:h},transaction:e}),(0,r().d)({environment:t,collectionViewBlockStore:p,collectionViewStore:d,collectionStore:u,collectionContextStore:c,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1,viewsModuleContext:void 0})}}),(0,l().AP)({environment:t,teamId:h,index:m})}},997513:(e,t,n)=>{n.d(t,{z:()=>g});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(959013),l=()=>n(107683),c=()=>n(2143),d=()=>n(969339),u=()=>n(756279),p=n(474848);function g(e){let{loginModalStore:t,loginStore:n,title:r,description:a,isSignup:c,disableLoginLink:u,redirectURL:g,className:v,onDismiss:b,trustedDomain:S}=e;const y=(0,i().v3)(),C=(0,s().K8)((()=>t.state.open),[t]),x=(0,o.useId)(),k=(0,o.useId)(),I={loginStore:n,title:r,description:a,isSignup:c,redirectURL:g,disableLoginLink:u,titleAriaId:x,descriptionAriaId:k,trustedDomain:S};return(0,p.jsx)(l().s,{ariaLabelledBy:x,ariaDescribedBy:k,isOpen:C,onDismiss:()=>{f({loginModalStore:t,loginStore:n,onDismiss:b})},areaConstraint:{width:{type:"fixed",length:480},height:{type:"unlimited",scroll:"allow"}},deprecatedCompatibilityOverrides:{tabletsUsePhoneDisplayMode:!0},render:()=>(0,p.jsx)(m,{children:(0,p.jsxs)("div",{className:v,children:[!y.device.isMobile&&(0,p.jsx)(h,{loginModalStore:t,loginStore:n,onDismiss:b}),(0,p.jsx)(d().Yo,{...I})]})})})}function m(e){let{children:t}=e;return(0,i().v3)().device.isMobile?(0,p.jsx)(c().H,{type:u().A.Y,children:t}):t}function h(e){let{loginModalStore:t,loginStore:n,onDismiss:o}=e;const i=(0,r().DP)();return(0,p.jsx)("div",{style:{fontSize:14,color:i.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer",zIndex:1},onClick:()=>{f({loginModalStore:t,loginStore:n,onDismiss:o})},children:(0,p.jsx)(a().sA,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})})}function f(e){const{loginModalStore:t,loginStore:n,onDismiss:o}=e;n.reset(),t.setState({open:!1}),o&&o()}}}]);