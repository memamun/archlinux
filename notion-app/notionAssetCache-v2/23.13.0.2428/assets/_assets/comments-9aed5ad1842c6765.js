"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[37125,43647],{346:(e,t,o)=>{o.d(t,{MG:()=>g,T1:()=>p,a1:()=>S,dt:()=>h,kg:()=>f,lC:()=>x,n_:()=>v});var n=o(296540),i=()=>o(484714),s=()=>o(56366),r=()=>o(187174),a=()=>o(645873),l=()=>o(941463),c=()=>o(441199),d=()=>o(749687),u=()=>o(737230),m=()=>o(756114);const p=new(a().O2)("PerformanceToolbar",(()=>Promise.all([o.e(23806),o.e(16471),o.e(47123),o.e(17989),o.e(56985),o.e(48680),o.e(45624)]).then(o.bind(o,140401)))),g=(0,a()._h)(p,(e=>e.PerformanceToolbar)),h=(0,a()._h)(p,(e=>e.PerformanceToolbarSettings));function f(){const e=(0,i().v3)();return(0,s().K8)((()=>(0,m().D)(e,e.RouterStore.state)),[e])}function v(){const e=(0,i().v3)(),t=b("PerformanceToolbarStore"),o=b("isPerformanceToolbarVisible");return(0,s().K8)((()=>!(!t||!o)&&o(e,e.RouterStore.state,t.state)),[o,e,t])}function x(){const e=b("PerformanceToolbarStore");return(0,s().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function S(){const e=(0,i().v3)(),t=b("createPerformanceToolbarMouseListeners"),o=b("PerformanceToolbarStore"),{sidebarExpanded:r,sidebarWidth:a,secondarySidebarExpanded:m,secondarySidebarWidth:p,updateSidebarExpanded:g,updateSidebarWidth:h}=(0,s().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,n.useEffect)((()=>{if(o&&t)return t(e,(e=>o.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),r,a,m,p,g,h)}),[t,e,o,r,a,m,p,g,h])}function b(e){const t=f(),[{value:o}]=(0,r().Yb)((()=>t?p.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return o}},51367:(e,t,o)=>{o.d(t,{DL:()=>r,Sq:()=>l,Y5:()=>a,gc:()=>d,wo:()=>c});var n=()=>o(917629),i=()=>o(989423),s=()=>o(508496);function r(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,i().u4)({environment:e,event:{eventName:"callout_show",eventProperties:t}}),s().default.logEvent("callout_show",t.callout_key)}function a(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,i().u4)({environment:e,event:{eventName:"callout_click",eventProperties:t}}),s().default.logEvent("callout_click",t.callout_key)}function l(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,i().u4)({environment:e,event:{eventName:"callout_dismiss",eventProperties:t}}),s().default.logEvent("callout_dismiss",t.callout_key)}function c(e,t){const{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:s,eligibility_timeouts:r,blocklist:a}=t;(0,i().u4)({environment:e,event:{eventName:"callout_coordinator_resolved",eventProperties:{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:s,eligibility_timeouts:r,blocklist:a}}})}function d(e,t){(0,i().u4)({environment:e,event:{eventName:"callout_feature_interaction",eventProperties:t}})}},63467:(e,t,o)=>{o.d(t,{y:()=>d});var n=()=>o(637997),i=()=>o(267419);const s={ko:()=>o.e(2268).then(o.bind(o,224434)),es:()=>o.e(95264).then(o.bind(o,196425)),de:()=>o.e(35390).then(o.bind(o,653703)),fr:()=>o.e(3272).then(o.bind(o,94677)),pt:()=>o.e(27315).then(o.bind(o,766869)),zh:()=>o.e(69945).then(o.bind(o,516814)),ja:()=>o.e(77757).then(o.bind(o,824432)),da:()=>o.e(9423).then(o.bind(o,440761)),fi:()=>o.e(59337).then(o.bind(o,462135)),nb:()=>o.e(2040).then(o.bind(o,937314)),nl:()=>o.e(51106).then(o.bind(o,530897)),sv:()=>o.e(53631).then(o.bind(o,895222))};let r=!1,a=!1;async function l(e){for(const[o,i]of Object.entries(e.emojiLocaleKeywords)){var t;n().fB[o]={...n().fB[o],keywords:[...i,...(null===(t=n().fB[o])||void 0===t?void 0:t.keywords)||[]]}}await i().A.waitUntilLoaded(),i().A.update((t=>{let{emojiByName:o,...n}=t;return{...n,emojiByName:{...o,...e.emojiByName}}}))}async function c(){if(r)return;const[e]=o(662303).locale.split("-");e in s&&(await l(await s[e]()),r=!0)}const d=(0,o(279900).A)((async()=>{await async function(){a||(await l(await o.e(51872).then(o.bind(o,443716))),a=!0)}(),await c()}))},72307:(e,t,o)=>{o.d(t,{A:()=>n});const n={appCursorListener:{sidebar:1,secondarySidebar:2,editor:3,aiChat:3,marketplace:3,teamHome:3}}},73223:(e,t,o)=>{o.r(t),o.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>m,tutorialAdvanceToStepAfter:()=>p,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var n=()=>o(541235),i=()=>o(317909),s=()=>o(755199),r=()=>o(739135),a=()=>o(351360);function l(e,t){var o;const{currentUserSettingsStore:n}=a().default.state;if(!n)return;const i=null===(o=n.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{tutorials:{...i,[t]:(0,r().i9)(n,t)}}})},userId:n.id})}function c(e,t){var o;const{currentUserSettingsStore:n}=a().default.state;if(!n)return;const i=null===(o=n.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{tutorials:{...i,[t]:(0,r().KD)(n,t)}}})},userId:n.id})}function d(e,t){var o;const{currentUserSettingsStore:i}=a().default.state;if(!i)return;const r=null===(o=i.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{s().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...r,[t]:n().YD}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=a().default.state;t&&g({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{s().mJ({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function m(e,t,o){var i;const{currentUserSettingsStore:l}=a().default.state;if(!l||(0,r().x$)(l,t))return;const c=(0,r().gt)(l,t);n().c$[t].steps.findIndex((e=>e.id===c))>=n().c$[t].steps.findIndex((e=>e.id===o))||s().mJ({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:o}}})}function p(e,t,o){if((0,r().ll)(o))return;const n=(0,r().tb)(t,o);n&&m(e,t,n)}function g(e){return i().createAndCommit({...e,canUndo:!1})}},77279:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});class n extends(()=>o(757695))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new n},132456:(e,t,o)=>{o.d(t,{J4:()=>A,kw:()=>y,lf:()=>j});o(16280),o(816573),o(878100),o(177936),o(748140),o(821903),o(491134),o(128845),o(237467),o(444732),o(979577),o(581454);var n=o.n(o(883503)),i=()=>o(496603),s=()=>o(720665),r=()=>o(416845),a=()=>o(628536),l=()=>o(96689);const c={version:8,notion_version:0,variant:2},d={version:8,notion_version:1,variant:2},u=0,m=1,p=6,g=8,h=10,f=Date.UTC(2024,0,1);function v(e,t){if(e)return t[u]=255,t[u+1]=240|15&t[u+1],t;const o=Math.floor(((new Date).getTime()-f)/s().nD);if(o>=4096||o<0)throw new Error("Invalid offsetInDays.");return t[u]=o>>4,t[u+1]=o<<4&240|15&t[u+1],t}function x(e,t){if(e>=2**36||e<0)throw new Error("Invalid spaceShortId.");t[m]=240&t[m]|e/2**32&15;for(let o=0;o<4;o++)t[m+1+o]=e/2**(24-8*o)&255;return t}function S(e,t){const o=e?1:0;return t[p]=c.version<<4&240|c.notion_version<<1&14|1&o,t[g]=c.variant<<6&192|63&t[g],t}function b(e,t){if("block"===e)return t[h]=(0,a().vi)(e)|63&t[h],t;const o=(0,a().vi)(e);return t[h]=o>>8&127,t[h+1]=255&o,t}function C(e,t){const o=(0,a().TG)(e);return t[h]=127&o|128&t[h],t}function y(e,t,o,n){const i=new Uint8Array(16),s=globalThis.crypto.getRandomValues(i);return o!==l().NX&&v(e,s),x(t,s),S(n,s),b(o,s),I(s)}function A(e,t,o,n){return y(e,t,o,n)}function j(e,t,o){return w(e,t,o)}function w(e,t,o){const s=n()(o),l=i().iv(s,2).map((e=>parseInt(e.join(""),16)));if((0,a().ep)(t)){if(void 0===e)throw new(r().Um)(`Deterministic ID for '${t}' must specify a space short id`)}else if(void 0!==e)throw new(r().Um)(`Deterministic ID for '${t}' should not provide a space short id`);const c=new Uint8Array(l);return e&&x(e,c),C(t,c),function(e){e[p]=240&d.version<<4|14&d.notion_version<<1|1&e[p],e[g]=192&d.variant<<6|63&e[g]}(c),I(c)}const k=new Array(256).fill(0).map(((e,t)=>t.toString(16).padStart(2,"0")));function I(e){let t=0;return k[e[t++]]+k[e[t++]]+k[e[t++]]+k[e[t++]]+"-"+k[e[t++]]+k[e[t++]]+"-"+k[e[t++]]+k[e[t++]]+"-"+k[e[t++]]+k[e[t++]]+"-"+k[e[t++]]+k[e[t++]]+k[e[t++]]+k[e[t++]]+k[e[t++]]+k[e[t++]]}},173019:(e,t,o)=>{o.d(t,{r:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("pencil",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},191197:(e,t,o)=>{o.d(t,{i:()=>i,z:()=>s});var n=()=>o(989423);function i(e,t){const{from:o}=t;n().vd(e,"show_tooltip",{from:o,time:Date.now()})}function s(e,t){const{from:o}=t;n().vd(e,"dismiss_tooltip",{from:o,time:Date.now()})}},204552:(e,t,o)=>{o.d(t,{c:()=>i,x:()=>s});var n=()=>o(645873);const i=(0,n()._h)(new(n().O2)("UniversalQnaModals",(async()=>await Promise.all([o.e(23806),o.e(37353),o.e(55373),o.e(29151),o.e(16908),o.e(48315),o.e(847),o.e(5887),o.e(17989),o.e(56985),o.e(21627),o.e(82472),o.e(96345),o.e(75659),o.e(47858),o.e(51860),o.e(221),o.e(14358)]).then(o.bind(o,457974)))),(e=>e.UniversalQnaModals)),s=(0,n()._h)(new(n().O2)("SlackConnectionOptions",(async()=>await o.e(85873).then(o.bind(o,210230)))),(e=>e.SlackConnectionOptions))},279900:(e,t,o)=>{function n(e){let t,o,n;return async function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t?(n=s,o||(o=t.then((()=>(o=void 0,t=e(...n),t))),o)):(t=e(...s),t)}}o.d(t,{A:()=>n})},285176:(e,t,o)=>{o.d(t,{o:()=>a});o(296540);var n=()=>o(401497),i=()=>o(133033),s=()=>o(959013),r=o(474848);function a(e){const{href:t,style:o}=e,a=(0,n().IS)((e=>({default:{display:"flex",marginTop:7,marginBottom:7,alignItems:"center",cursor:"pointer",textDecoration:"none",pointerEvents:"auto",width:"fit-content",color:e.mediumTextColor}})),[]);return(0,r.jsxs)("a",{href:t,target:"_blank",style:{...a.default,...o},children:[(0,i().$)({width:14,marginRight:4}),(0,r.jsx)(s().sA,{id:"LearnMoreLink.learnMore",defaultMessage:"Learn more"})]})}},332390:(e,t,o)=>{o.d(t,{C7:()=>M,Yf:()=>D,k8:()=>R,lN:()=>B,oG:()=>T});var n=o(296540),i=()=>o(484714),s=()=>o(56366),r=()=>o(700500),a=()=>o(130382),l=()=>o(959013),c=()=>o(534177),d=()=>o(191197),u=()=>o(953006),m=()=>o(68465),p=()=>o(231722),g=()=>o(792002),h=()=>o(465425),f=()=>o(51367),v=()=>o(301421),x=()=>o(351360),S=()=>o(411671),b=()=>o(630116),C=()=>o(24157),y=()=>o(576590),A=()=>o(656633),j=()=>o(972911),w=o(474848);const k=1,I=1,L=(0,l().YK)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function M(){const e=(0,i().v3)(),t=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>{var e;return null===(e=x().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),o=(0,s().K8)((()=>{const t=x().default.state.mainEditorCurrentBlockStore;return t&&S().A.getMode(e,t)}),[e]);return(0,s().K8)((()=>{if(e.device.isMobile)return;const{currentUserSettingsStore:n,inAppCalloutStore:i}=x().default.state;if(!i.getCalloutVisibility("ai_onboarding_tooltip").canShow)return;const s=null==n?void 0:n.getSettings();if(!s)return;if((0,c().O9)(s.last_used_ai_writer_at))return;if("tooltip"!==s.ai_assistant_onboarding_phase)return;if((0,A().vp)(e,t)){if(!(0,c().O9)(s.ai_sales_assisted_extra_notification_seen_at)||(0,a().Mn)(s.ai_sales_assisted_extra_notification_seen_at)<I)return}else if((0,c().O9)(s.ai_assistant_onboarding_phase_last_set_at)&&(0,a().Mn)(s.ai_assistant_onboarding_phase_last_set_at)<k)return;if("space_for_ai"!==(0,j().V7)())return;if(!(0,m().ZE)(o))return;const l=C().default.state;if("editing"===l.mode){const e=(0,p().H7)(l.multiSelection);if(e&&(0,g().gE)(e.selection)){const t=e.store,o=v().n.findEditableWithStore(t);if(o){const e="block"===t.pointer.table?b().Bv.createChildStore(t,t.pointer):void 0,n=e&&e.getType(),i=Boolean(n&&(0,r().ZW)(n)),s=t.getValue();if(i&&!s)return o}}}}),[e,o,t])}(),[o,d]=(0,n.useState)(!1),h=(0,n.useCallback)((()=>{d(!0)}),[]),f=!o&&Boolean(t);return(0,n.useEffect)((()=>()=>{f&&(0,j().ZI)(e)}),[e,f]),f&&t?(0,w.jsx)(u().k,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,w.jsx)(l().sA,{...L.spaceForAiHeader}),content:(0,w.jsx)(l().sA,{...L.spaceForAiContent}),onCloseClick:h}):null}function R(e){const{originRef:t,openState:o}=e,r=(0,i().v3)(),a=(0,s().K8)((()=>(0,j().V7)()),[]),[c,d]=(0,n.useState)(!1),m=(0,n.useCallback)((()=>{d(!0)}),[]),p="ask_ai_anything"===a&&"initialPrompt"===o.stage&&!c;return(0,n.useEffect)((()=>()=>{!r.device.isMobile&&p&&(0,j().ZI)(r)}),[r,p]),r.device.isMobile||!p?null:(0,w.jsx)(u().k,{origin:t,placementToOrigin:"top",header:(0,w.jsx)(l().sA,{...L.askAiAnythingHeader}),content:(0,w.jsx)(l().sA,{...L.askAiAnythingContent}),onCloseClick:m})}function B(e){const{originRef:t,openState:o,isInputEmpty:r}=e,a=(0,i().v3)(),c=(0,s().K8)((()=>(0,j().V7)()),[]),[d,m]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{m(!0)}),[]),g="refine_ai_response"===c&&"results"===o.stage&&!o.loading&&"cursor"===o.context.type&&r&&!d;return(0,n.useEffect)((()=>()=>{!a.device.isMobile&&g&&(0,j().ZI)(a)}),[a,g]),a.device.isMobile?null:(0,w.jsx)(u().k,{origin:g?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,w.jsx)(l().sA,{...L.refineAiResponseHeader}),content:(0,w.jsx)(l().sA,{...L.refineAiResponseContent}),onCloseClick:p})}function D(e){const{origin:t}=e,o=(0,i().v3)();(0,n.useEffect)((()=>{d().i(o,{from:"qna_button"}),f().DL(o,{callout_key:"ai_assistant_origin_element_tooltip",placement_key:"Tooltip"})}),[o]);const s=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=x().default.state;e&&(d().z(o,{from:"qna_button"}),f().Sq(o,{callout_key:"ai_assistant_origin_element_tooltip",dismiss_type:"tooltip_dismiss",placement_key:"Tooltip"}),(0,y().setQnaOnboardingPhase)(o,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}),h().a(o,"ai_assistant_origin_element_tooltip"))}),[o]);return(0,w.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,w.jsx)(l().sA,{...L.showAssistantOriginElementLocationHeader}),content:(0,w.jsx)(l().sA,{...L.showAssistantOriginElementLocationContent}),onCloseClick:s})}function T(e){const{origin:t}=e,o=(0,i().v3)();(0,n.useEffect)((()=>{d().i(o,{from:"qna_search"})}),[o]);const s=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=x().default.state;e&&(d().z(o,{from:"qna_search"}),(0,y().setQnaOnboardingPhase)(o,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[o]);return(0,w.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,w.jsx)(l().sA,{...L.showAssistantLocationHeader}),content:(0,w.jsx)(l().sA,{...L.showAssistantLocationContent}),onCloseClick:s})}(0,o(466103).exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=x().default.state;t&&o(317909).createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,canUndo:!0,perform:e=>{o(755199).mJ({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},350124:(e,t,o)=>{o.d(t,{s:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("reactionAdd",{viewBox:"0 0 20 20",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M12 14.3516C12 14.1875 12.0573 14.0482 12.1719 13.9336C12.2891 13.8164 12.4297 13.7578 12.5938 13.7578H14.7617V11.5938C14.7617 11.4297 14.819 11.2904 14.9336 11.1758C15.0482 11.0586 15.1875 11 15.3516 11C15.5156 11 15.6549 11.0586 15.7695 11.1758C15.8867 11.2904 15.9453 11.4297 15.9453 11.5938V13.7578H18.1133C18.2747 13.7578 18.4128 13.8164 18.5273 13.9336C18.6445 14.0482 18.7031 14.1875 18.7031 14.3516C18.7031 14.5156 18.6445 14.6562 18.5273 14.7734C18.4128 14.888 18.2747 14.9453 18.1133 14.9453H15.9453V17.1133C15.9453 17.2747 15.8867 17.4128 15.7695 17.5273C15.6549 17.6445 15.5156 17.7031 15.3516 17.7031C15.1875 17.7031 15.0482 17.6445 14.9336 17.5273C14.819 17.4128 14.7617 17.2747 14.7617 17.1133V14.9453H12.5938C12.4297 14.9453 12.2891 14.888 12.1719 14.7734C12.0573 14.6562 12 14.5156 12 14.3516Z"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0615 17.123C9.09538 17.123 8.1862 16.9385 7.33398 16.5693C6.48177 16.2048 5.72982 15.6966 5.07812 15.0449C4.43099 14.3932 3.92285 13.6413 3.55371 12.7891C3.18457 11.9368 3 11.0277 3 10.0615C3 9.09538 3.18457 8.1862 3.55371 7.33398C3.92285 6.48177 4.43099 5.7321 5.07812 5.08496C5.72982 4.43327 6.47949 3.92285 7.32715 3.55371C8.17936 3.18457 9.08854 3 10.0547 3C11.0254 3 11.9368 3.18457 12.7891 3.55371C13.6413 3.92285 14.3932 4.43327 15.0449 5.08496C15.6966 5.7321 16.207 6.48177 16.5762 7.33398C16.9453 8.1862 17.1299 9.09538 17.1299 10.0615C17.1299 10.6193 17.0684 11.1581 16.9453 11.678V11.5938C16.9453 11.1646 16.7813 10.7706 16.4767 10.4687C16.2657 10.2558 16.0099 10.1116 15.7285 10.0441C15.7263 9.26677 15.5805 8.53887 15.291 7.86035C14.9993 7.1722 14.5938 6.56836 14.0742 6.04883C13.5547 5.5293 12.9508 5.1237 12.2627 4.83203C11.5791 4.54036 10.8431 4.39453 10.0547 4.39453C9.27083 4.39453 8.53483 4.54036 7.84668 4.83203C7.16309 5.1237 6.5638 5.5293 6.04883 6.04883C5.53385 6.56836 5.13053 7.1722 4.83887 7.86035C4.5472 8.54395 4.40137 9.27767 4.40137 10.0615C4.40137 10.8499 4.5472 11.5859 4.83887 12.2695C5.13053 12.9531 5.53385 13.5547 6.04883 14.0742C6.56836 14.5938 7.16992 14.9993 7.85352 15.291C8.54167 15.5827 9.27767 15.7285 10.0615 15.7285C10.5739 15.7285 11.0641 15.6669 11.5321 15.5438C11.8272 15.8056 12.1958 15.9453 12.5938 15.9453H13.7617V16.0641C13.4535 16.2554 13.1293 16.4238 12.7891 16.5693C11.9368 16.9385 11.0277 17.123 10.0615 17.123ZM10.0547 13.4248C9.58073 13.4248 9.16146 13.3405 8.79688 13.1719C8.43685 12.9987 8.15658 12.8005 7.95605 12.5771C7.76009 12.3538 7.66211 12.167 7.66211 12.0166C7.66211 11.9346 7.69401 11.8776 7.75781 11.8457C7.82617 11.8092 7.89909 11.8092 7.97656 11.8457C8.22721 11.9779 8.51204 12.1055 8.83105 12.2285C9.15006 12.3516 9.55794 12.4131 10.0547 12.4131C10.5514 12.4131 10.9593 12.3516 11.2783 12.2285C11.6019 12.1055 11.8867 11.9779 12.1328 11.8457C12.2103 11.8092 12.2832 11.8092 12.3516 11.8457C12.4199 11.8776 12.4541 11.9346 12.4541 12.0166C12.4541 12.167 12.3538 12.3538 12.1533 12.5771C11.9528 12.8005 11.6725 12.9987 11.3125 13.1719C10.9525 13.3405 10.5332 13.4248 10.0547 13.4248ZM8.03809 9.44629C7.82389 9.44629 7.63704 9.3597 7.47754 9.18652C7.32259 9.01335 7.24512 8.79004 7.24512 8.5166C7.24512 8.24772 7.32259 8.02669 7.47754 7.85352C7.63704 7.67578 7.82389 7.58691 8.03809 7.58691C8.25228 7.58691 8.44141 7.67578 8.60547 7.85352C8.76953 8.02669 8.85156 8.24772 8.85156 8.5166C8.85156 8.79004 8.76953 9.01335 8.60547 9.18652C8.44141 9.3597 8.25228 9.44629 8.03809 9.44629ZM12.0713 9.44629C11.8571 9.44629 11.6702 9.3597 11.5107 9.18652C11.3558 9.01335 11.2783 8.79004 11.2783 8.5166C11.2783 8.24772 11.3558 8.02669 11.5107 7.85352C11.6702 7.67578 11.8571 7.58691 12.0713 7.58691C12.2855 7.58691 12.4746 7.67578 12.6387 7.85352C12.8027 8.02669 12.8848 8.24772 12.8848 8.5166C12.8848 8.79004 12.8027 9.01335 12.6387 9.18652C12.4746 9.3597 12.2855 9.44629 12.0713 9.44629Z"})]})})},388182:(e,t,o)=>{o.d(t,{A:()=>n});const n=o(757695).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},436683:(e,t,o)=>{o.d(t,{Y:()=>A});var n=o(296540),i=()=>o(56366),s=()=>o(401497),r=()=>o(563884),a=o(474848);const l=(0,o(340498).wt)("suggestionExtraSmall",{viewBox:"0 0 10 9",svg:(0,a.jsxs)("g",{children:[(0,a.jsx)("path",{d:"M5.175 4.745l-.906.339c-.07.027-.14.012-.205-.045-.064-.057-.08-.127-.048-.212l.342-.899L7.492.798l.814.813-3.131 3.134zm3.4-3.397L7.76.53l.359-.352A.617.617 0 018.48.005a.364.364 0 01.33.105l.14.14c.1.105.145.226.134.365a.596.596 0 01-.168.366l-.341.366z"}),(0,a.jsx)("path",{d:"M4.91 1.962L5.969.906H2.704c-.354 0-.66.072-.92.216-.26.14-.46.341-.601.601-.142.26-.212.566-.212.92v2.754c0 .354.074.66.222.92.148.26.345.461.591.605.249.141.524.212.827.212h.25v.694c0 .214.056.382.167.506a.603.603 0 00.465.184.84.84 0 00.383-.092c.125-.06.27-.16.434-.301l1.138-.991h1.846c.353 0 .66-.07.92-.212.26-.144.46-.345.6-.605a1.89 1.89 0 00.213-.92V2.643c0-.114-.007-.223-.022-.327l-.433.443-.601.602V5.32c0 .253-.064.442-.192.567-.125.126-.314.188-.567.188h-1.85a.757.757 0 00-.307.051.962.962 0 00-.256.192L3.743 7.349v-.926c0-.125-.031-.214-.093-.267a.372.372 0 00-.256-.082h-.608c-.251 0-.44-.062-.568-.188-.125-.125-.188-.314-.188-.567V2.72c0-.253.063-.442.188-.567.128-.128.317-.192.568-.192H4.91z"})]})});var c=()=>o(120739),d=()=>o(959013),u=()=>o(284371),m=()=>o(296798),p=()=>o(824160),g=()=>o(125565),h=()=>o(659799),f=()=>o(47373),v=()=>o(907514),x=()=>o(141465),S=()=>o(630116),b=()=>o(898808),C=()=>o(848565),y=()=>o(811879);function A(e){let{lastEditedTime:t,createdTime:o,discussionLocation:r,isResolved:h,isSuggestionComment:v,teamStore:A,authorStore:k}=e;const I=(0,d().tz)(),L=(0,i().K8)((()=>(0,f().J0)()),[]),M=(0,n.useRef)(null),R=(0,i().K8)((()=>k.getDisplayName(I)),[k,I]),B=(0,i().K8)((()=>null==A?void 0:A.getName()),[A]),D=C().eQ,T=function(e){let{discussionLocation:t,avatarSize:o}=e;return(0,s().IS)((e=>({avatar:{marginTop:0,marginRight:2,userSelect:"none"},avatarSuggestionBadgeWrapper:{position:"absolute",right:-2,bottom:-4},avatarSuggestionBadge:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:100,background:"light"===e.mode?"#fff":"#000",width:16,height:16,border:`1px solid ${e.accentColors.uiBlue[200]}`,fill:e.accentColors.uiBlue[600]},avatarSuggestionBadgeBacking:{position:"absolute",width:"100%",height:"100%",borderRadius:100,background:e.accentColors.uiBlue[100]},in:{color:e.text.secondary},timestamp:{whiteSpace:"normal",flexGrow:"updates_sidebar"===t||"comment_unfurl"===t?void 0:1,display:"inline",color:e.text.tertiary},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",fontSize:14,gap:6},user:{display:"flex",alignItems:"center",gap:6},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},commentAuthorPlaceholder:{marginRight:2,marginTop:"comment_unfurl"===t?14:2,height:o,width:o,borderRadius:20,flexShrink:0},teamIconAndName:{display:"flex",alignItems:"center",gap:5},linkBox:{borderRadius:4,padding:4,marginInline:-4},author:{fontWeight:u().Wy.medium,whiteSpace:"normal",flexShrink:0},teamName:{fontWeight:u().Wy.medium,lineHeight:1.3,borderBottom:`1px solid ${e.darkDividerColor}`}})),[o,t])}({discussionLocation:r,avatarSize:D}),_=(0,n.useCallback)((()=>{const e=M.current;e&&k&&k instanceof S().LU&&x().A.setState({type:"user",store:k,domRect:e.getBoundingClientRect()})}),[M,k]),E=(0,n.useCallback)((()=>x().A.setState(void 0)),[]);if(!o)return null;const P=t&&t>o+5e3;return(0,a.jsxs)("div",{style:T.userRow,children:[(0,a.jsxs)("div",{style:T.user,ref:M,onMouseEnter:_,onMouseLeave:E,children:[v?(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsx)(y().E,{authorStore:k,avatarSize:D,avatarStyle:T.avatar,placeholderStyle:T.commentAuthorPlaceholder}),(0,a.jsx)("div",{style:T.avatarSuggestionBadgeWrapper,children:(0,a.jsxs)("div",{style:T.avatarSuggestionBadge,children:[l({height:8.5}),(0,a.jsx)("div",{style:T.avatarSuggestionBadgeBacking})]})})]}):(0,a.jsx)(y().E,{hasTooltip:!L,authorStore:k,avatarSize:D,avatarStyle:T.avatar,placeholderStyle:T.commentAuthorPlaceholder}),(0,a.jsx)("div",{style:T.author,children:R||(0,a.jsx)("span",{style:T.placeholder})})]}),A&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:T.in,children:(0,a.jsx)(d().sA,{id:"posts.post.inPreposition",defaultMessage:" in "})}),(0,a.jsx)(m().A,{style:T.linkBox,href:(0,c().a)({teamId:A.id}),children:(0,a.jsxs)("div",{style:T.teamIconAndName,children:[(0,a.jsx)(b().x,{size:14,store:A,disabled:!1}),(0,a.jsx)("span",{style:T.teamName,children:B})]})})]}),(0,a.jsx)(g().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:T.timestamp,children:P?(0,a.jsx)(w,{createdTime:o,lastEditedTime:t}):(0,a.jsx)(j,{createdTime:o})}),"comment_unfurl"===r&&h&&(0,a.jsx)("div",{style:{display:"inline-flex"},children:(0,a.jsx)(p().A,{children:(0,a.jsx)(d().sA,{id:"comment.unfurl.resolvedStatus",defaultMessage:"Resolved"})})})]})}function j(e){const{createdTime:t}=e;return(0,a.jsx)(h().A,{text:(0,v().nl)(t,{useUltraCompactFormat:!0}),tooltipText:(0,v().x$)(t),icon:r().k})}function w(e){const{createdTime:t,lastEditedTime:o}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h().A,{text:(0,v().nl)(t,{useUltraCompactFormat:!0}),tooltipText:(0,a.jsx)(d().sA,{defaultMessage:"Created {absoluteCreatedTime}",id:"comment.createdAtTime.label",values:{absoluteCreatedTime:(0,v().x$)(t)}}),icon:r().k})," ",(0,a.jsx)(h().A,{text:(0,a.jsx)(d().sA,{defaultMessage:"(edited)",id:"comment.editedAtIndicator"}),tooltipText:(0,a.jsx)(d().sA,{defaultMessage:"Last edited {absoluteLastEditedTime}",id:"comment.editedAtTime.label",values:{absoluteLastEditedTime:(0,v().x$)(o)}}),icon:r().k})]})}},478985:(e,t,o)=>{o.r(t),o.d(t,{Comment:()=>St,CommentFileBlock:()=>Jo().A,Discussion:()=>Xt,DiscussionIndicator:()=>to().Ay,DiscussionInput:()=>xt().A,DiscussionReactionBar:()=>$e,MarginCommentsSection:()=>_o,NewDiscussionMenu:()=>No,PropertyDiscussionIndicator:()=>ao,ReactionBar:()=>Ye,ReplyDiscussionMenu:()=>$o,SuggestionContext:()=>qt,discussionHelpers:()=>D(),discussionViewActions:()=>n,reactionActions:()=>Re()});var n={};o.r(n),o.d(n,{isCommentUnread:()=>kt});o(898992),o(354520);var i=o(296540),s=()=>o(908006),r=()=>o(484714),a=()=>o(792485),l=()=>o(790748),c=()=>o(56366),d=()=>o(401497),u=()=>o(68263),m=()=>o(919709),p=()=>o(959013),g=()=>o(284371),h=()=>o(112873),f=()=>o(901389),v=()=>o(620689),x=()=>o(725614),S=()=>o(317909),b=()=>o(331542),C=()=>o(719147),y=()=>o(447587),A=()=>o(709438),j=()=>o(299545),w=()=>o(424746),k=()=>o(372154),I=()=>o(230062),L=()=>o(630116),M=()=>o(789557),R=()=>o(902731),B=()=>o(848565),D=()=>o(493319);function T(e){return e.isFirstComment&&"comment_unfurl"!==e.discussionLocation&&"post_top_level_discussion"!==e.discussionLocation}var _=()=>o(404783),E=()=>o(555776),P=(o(944114),()=>o(584262)),F=()=>o(700500),U=()=>o(681546),K=()=>o(671089),W=()=>o(66913),O=()=>o(30626),H=()=>o(657222),N=()=>o(340498),z=o(474848);const V={viewBox:"0 0 20 20",svg:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("path",{d:"M16.25 6.25a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"}),(0,z.jsx)("path",{d:"M5.25 3.125h7.302a3.8 3.8 0 0 0 0 1.25H5.25a.875.875 0 0 0-.875.875v9.5c0 .483.392.875.875.875h9.5a.875.875 0 0 0 .875-.875V7.448a3.8 3.8 0 0 0 1.25 0v7.302a2.125 2.125 0 0 1-2.125 2.125h-9.5a2.125 2.125 0 0 1-2.125-2.125v-9.5c0-1.174.951-2.125 2.125-2.125"})]})},$=(0,N().wt)("markUnread",V);var Y=()=>o(173019),J=()=>o(350124);const G=(0,N().wt)("reopen",{viewBox:"0 0 14 14",svg:(0,z.jsx)("path",{d:"M1.64844 7.88477C1.64844 10.791 3.98047 13.1289 6.88086 13.1289C9.78125 13.1289 12.1133 10.791 12.1133 7.88477C12.1133 7.53906 11.873 7.29297 11.5273 7.29297C11.1934 7.29297 10.9707 7.53906 10.9707 7.88477C10.9707 10.1582 9.14844 11.9805 6.88086 11.9805C4.61328 11.9805 2.79688 10.1582 2.79688 7.88477C2.79688 5.59961 4.60156 3.78906 6.86328 3.78906C7.25 3.78906 7.60742 3.81836 7.90625 3.88281L6.3125 5.46484C6.20703 5.57617 6.1543 5.69922 6.1543 5.85156C6.1543 6.17383 6.39453 6.41992 6.71094 6.41992C6.875 6.41992 7.00977 6.36719 7.10938 6.26172L9.51758 3.83594C9.64062 3.71289 9.69922 3.57227 9.69922 3.41406C9.69922 3.26172 9.63477 3.10938 9.51758 2.99219L7.10938 0.548828C7.00977 0.4375 6.875 0.378906 6.71094 0.378906C6.39453 0.378906 6.1543 0.636719 6.1543 0.953125C6.1543 1.10547 6.20703 1.24023 6.30664 1.3457L7.72461 2.74609C7.4668 2.69336 7.16797 2.66406 6.86328 2.66406C3.96875 2.66406 1.64844 4.98438 1.64844 7.88477Z"})}),q=(0,N().wt)("resolve",{viewBox:"0 0 16 16",svg:(0,z.jsx)("path",{d:"M6.6123 14.2646C7.07715 14.2646 7.43945 14.0869 7.68555 13.7109L14.0566 3.96973C14.2344 3.69629 14.3096 3.44336 14.3096 3.2041C14.3096 2.56152 13.8311 2.09668 13.1748 2.09668C12.7236 2.09668 12.4434 2.26074 12.1699 2.69141L6.57812 11.5098L3.74121 7.98926C3.48828 7.68848 3.21484 7.55176 2.83203 7.55176C2.16895 7.55176 1.69043 8.02344 1.69043 8.66602C1.69043 8.95312 1.7793 9.20605 2.02539 9.48633L5.55273 13.7588C5.84668 14.1074 6.1748 14.2646 6.6123 14.2646Z"})});var Q=()=>o(413267),Z=()=>o(735384),X=()=>o(798880),ee=()=>o(496603),te=()=>o(534177),oe=()=>o(884107),ne=()=>o(760217),ie=()=>o(406699),se=()=>o(285790),re=()=>o(928600),ae=()=>o(939740),le=()=>o(89924),ce=()=>o(859428),de=()=>o(962036),ue=()=>o(780054),me=()=>o(38337),pe=()=>o(722872),ge=()=>o(108944),he=()=>o(836251),fe=()=>o(963589),ve=()=>o(351360);o(581454);var xe=()=>o(249349),Se=()=>o(413962),be=(o(737550),()=>o(634201)),Ce=()=>o(100622),ye=()=>o(383594),Ae=()=>o(145214),je=()=>o(704152),we=()=>o(56086),ke=()=>o(508398),Ie=()=>o(87878),Le=()=>o(486666),Me=()=>o(962730),Re=()=>o(528787),Be=()=>o(678553),De=()=>o(987017),Te=()=>o(712030),_e=()=>o(683097),Ee=()=>o(811879);function Pe(e){let{reactionStores:t,initialIndex:o}=e;const[n,s]=i.useState(o),a=(0,p().tz)(),l=(0,r().v3)(),d=(0,c().K8)((()=>(0,Te().FN)(l)),[l]),u=(0,c().K8)((()=>t.map(((e,t)=>{const o=e.getIcon();if(!o)return;const i="raw"!==d||be().qg.isCustomEmojiString(o);return(0,z.jsx)("span",{style:i&&t!==n?{opacity:.5}:{},children:(0,z.jsx)(we().A,{size:14,char:o})},o)})).filter(te().O9)),[t,n,d]),m=(0,c().K8)((()=>t[n].getActorStores().map((e=>({id:e.id,store:e,name:e.getDisplayName(a)}))).filter(te().O9)),[t,n,a]);return(0,z.jsxs)(re().A,{menuType:pe().gu.ActionSheet,children:[(0,z.jsx)(De().Ay,{tabStyle:{flex:1,justifyContent:"center",display:"flex",minWidth:60},tabs:u,selectedIndex:n,onChange:e=>s(e)}),m.map((e=>(0,z.jsx)(Be().A,{title:e.name,dontShrinkIcon:!0,icon:(0,z.jsx)(Ee().E,{authorStore:e.store,avatarSize:20,avatarStyle:{width:20,height:20},placeholderStyle:{width:20,height:20}})},e.id)))]})}function Fe(e){const t=(0,r().Y0)(),o=(0,c().K8)((()=>L().Lk.getUserVisibleReactions(e.store)),[e.store]),n=(0,i.useRef)(null),s=(0,_e().A)({onLongPress:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.setOpen(!0)}});if(!t.isMobile)return(0,z.jsx)(z.Fragment,{children:e.children});const a=o.findIndex((t=>!e.reactionStore||t===e.reactionStore))??0;return(0,z.jsx)(ie().Ay,{ref:n,renderOrigin:()=>(0,z.jsx)("div",{...s,onTouchStart:e=>{e.stopPropagation(),s.onTouchStart()},onTouchMove:e=>{e.stopPropagation(),s.onTouchMove(e)},onTouchEnd:e=>{e.stopPropagation(),s.onTouchEnd()},onTouchCancel:e=>{e.stopPropagation(),s.onTouchCancel()},children:e.children}),popupType:t.isTablet?ie().z7.Popup:ie().z7.SlideUp,render:()=>(0,z.jsx)(Pe,{initialIndex:a,reactionStores:o})},e.store.id)}const Ue=(0,p().YK)({addReaction:{defaultMessage:"Add reaction",id:"ReactionBar.newReaction.ariaLabel"},resolveDiscussion:{defaultMessage:"Resolve",id:"ReactionBar.resolveDiscussion.ariaLabel"},emojiPickerTitle:{defaultMessage:"Reaction",id:"ReactionBar.emojiModalMenu.title"}});function Ke(){const{isMobile:e}=(0,r().Y0)();return(0,d().IS)((t=>({reaction:{display:"flex",margin:"1px",padding:"1px 6px 1px 6px",justifyContent:"center",alignItems:"center",gap:"4px",border:`1px solid ${t.regularDividerColor}`,borderRadius:"100px",fontSize:14,fontVariantNumeric:"tabular-nums",background:t.whiteButtonBackground,height:25},count:{color:t.mediumTextColor,fontSize:e?g().J.UISmall.mobile:g().J.UISmall.desktop},countReacted:{color:t.blueColor},reacted:{background:Ce().Ay.blueWithAlpha(.08),border:`1px solid ${t.filterPillBorder}`,fontWeight:500},reactedHover:{background:Ce().Ay.blueWithAlpha(.18)},emojiStyle:{color:"black",display:"flex"},reactionIcon:{width:18,height:18,fill:t.mediumIconColor,marginTop:-.5,marginRight:1},dropShadow:{boxShadow:t.shadowSM}})),[e])}function We(e){let{store:t,disabled:o,onClick:n,dropShadow:i}=e;const s=(0,c().K8)((()=>t.getActors()),[t]),a=(0,c().K8)((()=>t.getIcon()),[t]),l=Ke(),{currentUser:d}=(0,r().v3)();if(!s||!a)return null;if(0===s.length)return null;const u=s.some((e=>e.id===d.id)),m={...l.reaction,...u&&l.reacted,...i&&l.dropShadow},p={...l.count,...u&&l.countReacted};return(0,z.jsx)(ce().A,{textWrap:!0,style:{maxWidth:250,width:"max-content"},placement:Me().W.Bottom,delayThreshold:300,renderTooltip:()=>(0,z.jsx)(Oe,{store:t,icon:a}),render:e=>(0,z.jsxs)(je().A,{disabled:o,style:m,hoveredStyle:u?l.reactedHover:void 0,onClick:n,...e,children:[(0,z.jsx)("span",{style:l.emojiStyle,children:(0,z.jsx)(we().A,{size:14,char:a})}),(0,z.jsx)("span",{style:p,children:s.length})]})})}function Oe(e){let{store:t,icon:o}=e;const n=(0,p().tz)(),i=(0,c().K8)((()=>t.getActorStores()),[t]),s=(0,c().K8)((()=>i.map((e=>e.getDisplayName(n))).filter(te().O9)),[i,n]),r=be().qg.isCustomEmojiString(o),a=(0,c().K8)((()=>{if(r){const e=be().qg.fromCustomEmojiString(o).pointer;return(0,Ie().nA)({parentStore:void 0,pointer:e})}}),[o,r]),l=(0,c().K8)((()=>{if(null!=a&&a.isDefined())return null==a?void 0:a.getModel().getRenderTitle()}),[a]);return r?a?(0,z.jsx)(ke().A,{type:"custom",customEmojiStore:a,text:(0,z.jsx)(He,{names:s,emojiNameOrIcon:(0,z.jsx)("span",{className:"notranslate",children:l}),isDeletedCustomEmoji:!1}),deletedText:(0,z.jsx)(He,{names:s,emojiNameOrIcon:(0,z.jsx)("span",{className:"notranslate",children:l}),isDeletedCustomEmoji:!0})}):null:(0,z.jsx)(ke().A,{type:"unicode",emoji:o,text:(0,z.jsx)(He,{names:s,emojiNameOrIcon:(0,z.jsx)(we().A,{size:12,char:o}),isDeletedCustomEmoji:!1})})}function He(e){let{names:t,emojiNameOrIcon:o,isDeletedCustomEmoji:n}=e;const i=(0,d().IS)((e=>({text:{color:e.text.contrastSecondary}})),[]);return t.length>50?(0,z.jsx)(p().sA,{defaultMessage:"{additionalNames, plural, one {{names} and {additionalNames} other <medium>reacted with</medium> {icon}} other {{names} and {additionalNames} others <medium>reacted with</medium> {icon}}} {isDeletedCustomEmoji, select, true {<medium>(deleted)</medium>} other {}}",id:"ReactionBar.hoverTooltip.textAbbreviated",values:{additionalNames:t.length-50,names:t.slice(0,50).join(", "),medium:e=>(0,z.jsx)("span",{style:i.text,children:e}),icon:o,isDeletedCustomEmoji:n}}):(0,z.jsx)(p().sA,{defaultMessage:"{nameOrNames} <medium>reacted with</medium> {icon} {isDeletedCustomEmoji, select, true {<medium>(deleted)</medium>} other {}}",id:"ReactionBar.hoverTooltip.text",values:{numberOfNames:t.length,nameOrNames:t.join(", "),medium:e=>(0,z.jsx)("span",{style:i.text,children:e}),icon:o,isDeletedCustomEmoji:n}})}function Ne(e){const{store:t,discussionLocation:o,onEmojiSelection:n,style:s}=e,a=(0,r().v3)(),l=(0,i.useRef)(null),c=(0,r().Y0)(),u=(0,d().IS)((e=>({container:{padding:2,display:"flex",boxShadow:e.shadowSM,backgroundColor:e.buttonGroupBackground,borderRadius:c.isMobile?3:4,...s},addIcon:{width:21,height:21,fill:e.icon.secondary},iconButton:{height:24,width:24,flex:"0 0 auto"}})),[c.isMobile,s]),m=(0,p().tz)();return(0,z.jsx)("div",{style:u.container,children:(0,z.jsx)(se().A,{hasBackground:!0,ariaLabel:m.formatMessage(Ue.addReaction),showShadow:!1,icon:()=>(0,J().s)(u.addIcon),style:u.iconButton,ref:l,onClick:()=>Ve(a,m,t,null==l?void 0:l.current,o,n)})})}function ze(e){let{store:t,discussionLocation:o,onEmojiSelection:n}=e;const s=(0,r().v3)(),a=(0,i.useRef)(null),l=Ke(),c=(0,p().tz)();return(0,z.jsx)(je().A,{style:{...l.reaction,minWidth:"2em"},ref:a,onClick:()=>Ve(s,c,t,null==a?void 0:a.current,o,n),children:(0,J().s)(l.reactionIcon)})}function Ve(e,t,o,n,i,s){if(!(n instanceof Element))return;const r=n.getBoundingClientRect();ye().W(e,{originGap:4,originRect:r,popupWidth:Le().jv,popupHeight:Le().GF,isSmallWidth:!1,title:t.formatMessage(Ue.emojiPickerTitle),currentTab:"emoji",tabs:[{type:"emoji",title:(0,z.jsx)(p().sA,{defaultMessage:"Emoji",id:"recordIcon.emojiTab.title"}),hideRandomButton:!0,onChange:(t,n)=>{s&&s(),S().createAndCommit({environment:e,userAction:"Comment.toggleReactionFromMenu",canUndo:!0,perform:s=>{Re().toggleReaction({environment:e,transaction:s,store:o,icon:t,discussionLocation:i}),n&&n.keepVisible||ye().I()}})}}]})}function $e(e){const{parentStore:t,discussionLocation:o,onReact:n,focused:s}=e,[a,l]=(0,i.useState)(!1),u=(0,d().IS)((e=>({reactionIcon:{height:21,width:21,fill:e.mediumIconColor},resolveIcon:{height:16,width:16,fill:e.mediumIconColor},container:{gap:"4px",marginTop:"post_top_level_discussion"===o?0:12,paddingBottom:"post_top_level_discussion"===o?12:0,display:"flex",flexWrap:"wrap",willChange:"transform",transition:"transform 200ms ease",transformOrigin:"center left",transform:s?"scale3d(1.05)":"scale(1)"},reactionItem:{display:"flex",flexDirection:"row"},actionButton:{borderRadius:"50%",marginLeft:2}})),[s,o]),m=e=>{S().createAndCommit({userAction:"Discussion.handleResolve",environment:g,canUndo:!0,perform:e=>{(0,xe().j)({environment:g,discussionStore:t,transaction:e,discussionLocation:o})}}),h().UP(),null==e||e.stopPropagation()},g=(0,r().v3)(),f=(0,c().K8)((()=>!!g.currentUser.isLoggedIn()&&t.canComment()),[t,g.currentUser]),v=(0,c().K8)((()=>{var e;return!!g.currentUser.isLoggedIn()&&(t.canEdit()&&!(null!==(e=t.getParentStore())&&void 0!==e&&e.isPost()))}),[t,g.currentUser]),x=(0,i.useRef)(null),b=(0,p().tz)(),C=a||e.focused,y=(0,c().K8)((()=>L().Lk.getUserVisibleReactions(t)),[t]),A=e=>()=>{e.isDefined()&&(null==n||n(),S().createAndCommit({environment:g,userAction:"Comment.toggleReaction",canUndo:!0,perform:n=>{Re().toggleReaction({environment:g,transaction:n,store:t,icon:e.getIcon(),discussionLocation:o})}}))},j=()=>{Ve(g,b,t,null==x?void 0:x.current,o,n)};return(0,z.jsx)("div",{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),style:u.container,children:y.map(((o,n)=>(0,z.jsxs)("div",{style:u.reactionItem,children:[(0,z.jsx)(Fe,{reactionStore:o,store:t,children:(0,z.jsx)(We,{dropShadow:e.focused&&!e.disableShadow,disabled:!f,store:o,onClick:A(o)})}),n===y.length-1&&(0,z.jsxs)(Ae().A,{animate:{opacity:C?1:0},style:{display:"flex",alignItems:"center",marginLeft:2},children:[f&&(0,z.jsx)(Fe,{store:t,children:(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Ue.addReaction}),render:e=>(0,z.jsx)(se().A,{style:u.actionButton,hasBackground:!1,showShadow:!1,ref:x,icon:()=>(0,J().s)(u.reactionIcon),onClick:j,...e,ariaLabel:b.formatMessage(Ue.addReaction)})})}),v&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Ue.resolveDiscussion}),render:e=>(0,z.jsx)(se().A,{style:{borderRadius:"50%",marginLeft:4},hasBackground:!1,showShadow:!1,icon:()=>q(u.resolveIcon),onClick:m,...e,ariaLabel:b.formatMessage(Ue.resolveDiscussion)})})]})]},o.id)))})}const Ye=function(e){const{parentStore:t,discussionLocation:n,onReactionToggle:i,newReactionStyle:s}=e,a=(0,r().v3)(),l=(0,c().K8)((()=>!!a.currentUser.isLoggedIn()&&t.canComment()),[t,a.currentUser]),d=(0,c().K8)((()=>L().Lk.getUserVisibleReactions(t)),[t]),u=(0,c().K8)((()=>{if(t.table===o(343666).SN){const e=t.getParentBlockStore();return Boolean(e&&e.pathIsDead())}if(t.table===o(197959).$Y){const e=t.getParentStore();return Boolean(e&&e.pathIsDead())}return!1}),[t]),m=l&&!u&&d.length>0,p=l&&!u&&0===d.length;return(0,z.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[d.map((e=>(0,z.jsx)(Fe,{reactionStore:e,store:t,children:(0,z.jsx)(We,{disabled:!l||u,store:e,onClick:()=>{if(e.isDefined()){const o=S().createAndCommit({environment:a,userAction:"Comment.toggleReaction",canUndo:!0,perform:o=>Re().toggleReaction({environment:a,transaction:o,store:t,icon:e.getIcon(),discussionLocation:n})});void 0!==o.performResult&&i&&i(o.performResult)}}})},e.id))),m&&(0,z.jsx)(Fe,{store:t,children:(0,z.jsx)(ze,{store:t,discussionLocation:n,onEmojiSelection:void 0!==i?()=>i("Added"):void 0})}),p&&(0,z.jsx)(Ne,{store:t,discussionLocation:n,onEmojiSelection:void 0!==i?()=>i("Added"):void 0,style:s})]})},Je=(0,p().YK)({addReaction:{id:"comment.actions.addReaction.label",defaultMessage:"Add reaction"},acceptButton:{id:"comment.actions.acceptButton.label",defaultMessage:"Accept"},rejectButton:{id:"comment.actions.rejectButton.label",defaultMessage:"Reject"},moreActions:{id:"comment.actions.moreActions.label",defaultMessage:"More actions"},reopenButton:{id:"comment.actions.reopenButton.label",defaultMessage:"Re-open"},resolveButton:{id:"comment.actions.resolveButton.label",defaultMessage:"Resolve"}});function Ge(e){const{discussionLocation:t,isFirstComment:o,blockStore:n,discussionStore:s}=e,l=(0,p().tz)(),d=(0,r().v3)(),m=d.device,g=(0,i.useRef)(null),f=(0,a().S)(),v=(0,c().K8)((()=>Boolean(s.getResolved())),[s]),x=(0,c().K8)((()=>e.store.isDefined()),[e.store]),b=(0,c().K8)((()=>{var e;return null===(e=ve().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),C=(0,c().K8)((()=>{const t=e.store.getCreatedById();return e.store.getCreatedByTable()===X().oo&&b===t}),[b,e.store]),y=(0,c().K8)((()=>{var e;const t=null===(e=ve().default.state.currentSpaceStore)||void 0===e?void 0:e.getRole();return t&&u().Km(t)}),[]),A=(0,c().K8)((()=>n.getRole()),[n]),j=(0,c().K8)((()=>{var e;return null==f||null===(e=f.publicEditModeStore.state)||void 0===e?void 0:e.permission}),[null==f?void 0:f.publicEditModeStore]),{isFirstCommentOfSuggestionDiscussion:w,disableAccept:k}=(0,c().K8)((()=>{var t;const o="suggestion"===s.getType()&&s.getCommentPointers()[0].id===e.store.id,i=(null===(t=n.getNavigableBlockStore())||void 0===t?void 0:t.canEdit())??!1;return{isFirstCommentOfSuggestionDiscussion:o,disableAccept:o&&!i}}),[s,n,e.store]),I=(0,c().K8)((()=>n.pathIsDead()),[n]),L=(0,c().K8)((()=>T({isFirstComment:o,discussionLocation:t})),[o,t]),R="comment_only"===A||"comment"===j,B=(0,fe().X)("comment_sidebar_for_you"),D=(0,i.useCallback)((()=>S().createAndCommit({userAction:"Comment.markDiscussionRead",environment:d,canUndo:!0,perform:e=>function(e){const{transaction:t,discussionStore:o}=e,n=o.userId;if(!n)return;const i=o.getUserSeenRecordStore(n);return S().applyOperation({store:i,operation:{pointer:i.pointer,path:[],command:"update",args:{id:i.id,user_id:n,space_id:i.pointer.spaceId,parent_id:o.id,parent_table:o.table,last_seen_at:(new Date).getTime()}},transaction:t}),o}({transaction:e,discussionStore:s})})),[d,s]),_=(0,i.useCallback)((()=>S().createAndCommit({userAction:"Comment.markDiscussionUnread",environment:d,canUndo:!0,perform:e=>function(e){const{transaction:t,discussionStore:o}=e,n=o.userId;if(!n)return;const i=o.getCommentStores().map((e=>e.getCreatedTime())),s=i.length?Math.max(...i):void 0,r=o.getUserSeenRecordStore(n);return S().applyOperation({store:r,operation:{pointer:r.pointer,path:[],command:"update",args:{id:r.id,user_id:n,space_id:r.pointer.spaceId,parent_id:o.id,parent_table:o.table,last_seen_at:s?s-1:void 0}},transaction:t}),o}({transaction:e,discussionStore:s})})),[d,s]);if(!x||!b)return null;const E=()=>{S().createAndCommit({userAction:"Comment.handleReopen",environment:d,canUndo:!0,perform:t=>{M().E3({environment:d,commentStore:e.store,discussionStore:s,transaction:t,discussionLocation:e.discussionLocation})}})},W=t=>{S().createAndCommit({userAction:"Comment.handleResolve",environment:d,canUndo:!0,perform:t=>{(0,xe().j)({environment:d,commentStore:e.store,discussionStore:s,transaction:t,discussionLocation:e.discussionLocation})}}),h().UP(),null==t||t.stopPropagation()},O=()=>{S().createAndCommit({userAction:"Suggestion.handleAccept",environment:d,canUndo:!0,perform:t=>{Se().HG({action:"accept",environment:d,commentStore:e.store,discussionStore:s,transaction:t,discussionLocation:e.discussionLocation,currentPageStore:ge().fA(s)})}}),h().UP()},N=()=>{S().createAndCommit({userAction:"Suggestion.handleReject",environment:d,canUndo:!0,perform:t=>{Se().HG({action:"reject",environment:d,commentStore:e.store,discussionStore:s,transaction:t,discussionLocation:e.discussionLocation,currentPageStore:ge().fA(s)})}}),h().UP()},V=async()=>{var t,o;const n=e.store.getParentStore();if(!n||null==n||!n.isDefined())return null;let i=n.getParentStore();if(null===(t=i)||void 0===t||!t.isDefined())return null;var s;i.getType()===F().xd.tableRow&&(i=null===(s=i)||void 0===s?void 0:s.getParentBlockStore());if(null===(o=i)||void 0===o||!o.isDefined())return null;const r=i.getModel().getRenderUrl({baseUrl:ue().A.domainBaseUrl,getRecordModel:e.store.getRecordModel,discussionId:n.id,pageVisitSource:P().y8.CopyLink}),a=await oe().R.clipboardActions.load();a.copyString({environment:d,stringValue:r,copiedMessage:a.clipboardMessages.copiedLinkToClipboard})};if(!d.currentUser.isLoggedIn())return null;const J=A&&u().h9(A)||I;if(J)return null;const G=L&&!m.isMobile&&!R&&!J,q=[];m.isMobile&&!R&&!J&&e.isFirstComment&&(v?q.push("reopen"):q.push("resolve")),!w&&C&&q.push("edit"),o&&(q.push("copyLink"),B&&(q.push("markDiscussionRead"),q.push("markDiscussionUnread"))),w||!C&&!y||q.push("delete");const se=q.length>0;return se||G||e.canShowReactions?(0,z.jsx)(ie().Ay,{ref:g,popupType:m.isMobile?ie().z7.BottomSheet:ie().z7.Popup,bottomSheetInitialState:"half",buttonPopupStore:e.buttonPopupStore,placementToOrigin:ie().sx.Right,stopClickPropagation:!0,renderOrigin:o=>(0,z.jsx)(Ze,{buttonConfig:{resolve:{visible:G&&!w,resolved:v,onResolve:W,onReopen:E},react:{visible:e.canShowReactions,onReact:()=>{var o;Ve(d,l,e.store,(null===(o=g.current)||void 0===o?void 0:o.getAnchor())??null,t,e.handleReaction)}},accept:{visible:w&&!k&&!v,onAccept:O},reject:{visible:w&&!v&&(!R||C),onReject:N},moreActions:{visible:se}},visible:e.visible,buttonPopupEvents:o,discussionLocation:e.discussionLocation,store:e.store}),render:t=>{let o;o=m.isMobile?{menuType:pe().gu.Modal,title:(0,z.jsx)(p().sA,{id:"comment.mobileCommentMenu.title",defaultMessage:"Comment"})}:{menuType:pe().gu.Popup};const n=q.map((t=>"reopen"===t?{key:"reopen",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,U().i)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.reopenDiscussion.button",defaultMessage:"Re-open discussion"})}),action:E}:"resolve"===t?{key:"resolve",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,Q().b)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.resolveDiscussion.button",defaultMessage:"Resolve comments"})}),action:()=>W()}:"edit"===t?{key:"edit",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,Y().r)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.editComment.button",defaultMessage:"Edit comment"})}),action:e.handleEditComment}:"delete"===t?{key:"delete",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,Z().I)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.deleteComment.button",defaultMessage:"Delete comment"})}),action:e.handleDeleteComment}:"copyLink"===t?{key:"copyLink",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,H().w)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.copyLinkToDiscussion.button",defaultMessage:"Copy link to discussion"})}),action:V}:"markDiscussionRead"===t?{key:"markDiscussionRead",render:e=>(0,z.jsx)(ne().A,{...e,icon:(0,K().x)({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.markDiscussionRead.button",defaultMessage:"Mark as read"})}),action:D}:"markDiscussionUnread"===t?{key:"markDiscussionUnread",render:e=>(0,z.jsx)(ne().A,{...e,icon:$({height:16,width:16}),title:(0,z.jsx)(p().sA,{id:"comment.markDiscussionUnread.button",defaultMessage:"Mark as unread"})}),action:_}:void(0,te().HB)(t)));return(0,z.jsx)("div",{className:me().Jb,children:(0,z.jsxs)(re().A,{...o,children:[(0,z.jsx)(ae().Ay,{type:ae().Oh.Vertical,initialFocus:void 0,onAccept:t.close,sections:ee().oE([n.length&&{key:0,render:e=>(0,z.jsx)(le().A,{...e}),items:n}])}),!m.isMobile&&(0,z.jsx)(le().A,{topBorder:!0,disableDesktopPadding:!1,children:(0,z.jsx)(de().A,{title:(0,z.jsx)(p().sA,{defaultMessage:"Learn about comments",id:"comments.learn"}),href:(0,he().xS)("guides.comments"),analyticsFrom:"comments"})})]})})}}):null}function qe(e){return"accept"in e}function Qe(e){return"resolve"in e}function Ze(e){const{buttonPopupEvents:t,buttonConfig:o}=e,n=(0,r().v3)().device,i=(0,p().tz)(),s=(0,d().IS)((t=>({addIcon:{height:21,width:21,fill:t.mediumIconColor},container:{display:"flex",boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)",borderWidth:1,borderStyle:"solid",borderColor:t.stroke.secondary,position:"absolute",flexShrink:0,padding:"2px",backgroundColor:t.buttonGroupBackground,right:0,...n.isMobile?{borderRadius:6,top:-3}:{marginRight:0,marginTop:"updates_sidebar"===e.discussionLocation?6:0,opacity:e.visible?1:0,gap:1,borderRadius:6,transition:"opacity 100ms ease-out",zIndex:1,top:-4}}})),[n.isMobile,e.discussionLocation,e.visible]);return(0,z.jsxs)("div",{style:s.container,children:[qe(o)&&o.accept.visible&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Je.acceptButton}),render:e=>(0,z.jsx)(se().A,{hasBackground:!1,showShadow:!1,icon:q,onClick:o.accept.onAccept,ariaLabel:i.formatMessage(Je.acceptButton),...e})}),qe(o)&&o.reject.visible&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Je.rejectButton}),render:e=>(0,z.jsx)(se().A,{hasBackground:!1,showShadow:!1,icon:W().V,onClick:o.reject.onReject,iconStyle:{height:18,width:18},ariaLabel:i.formatMessage(Je.rejectButton),...e})}),o.react.visible&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Je.addReaction}),render:e=>(0,z.jsx)(se().A,{ariaLabel:i.formatMessage(Je.addReaction),hasBackground:!1,showShadow:!1,icon:()=>(0,J().s)(s.addIcon),onClick:o.react.onReact,...e})}),Qe(o)&&o.resolve.visible&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...o.resolve.resolved?Je.reopenButton:Je.resolveButton}),render:e=>(0,z.jsx)(se().A,{hasBackground:!1,showShadow:!1,icon:o.resolve.resolved?G:q,onClick:o.resolve.resolved?o.resolve.onReopen:o.resolve.onResolve,...e,ariaLabel:i.formatMessage(o.resolve.resolved?Je.reopenButton:Je.resolveButton)})}),o.moreActions.visible&&(0,z.jsx)(ce().A,{renderTooltip:()=>(0,z.jsx)(p().sA,{...Je.moreActions}),render:e=>(0,z.jsx)(se().A,{...t,...e,hasBackground:!1,showShadow:!1,icon:O()._,ariaLabel:i.formatMessage(Je.moreActions)})})]})}var Xe=()=>o(675074),et=()=>o(24611),tt=()=>o(518888),ot=()=>o(489436),nt=()=>o(973753);const it=3;function st(e){let{stores:t,collapsed:o,shouldShowGrayFogInScroller:n,onRemoveBlockFromComment:i}=e;return 0===t.length?null:t.length<=it?(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:t.map((e=>(0,z.jsx)(ot().A,{store:e,disabled:!1,commentProps:{shouldHideBlockActionMenu:o,onRemoveBlockFromComment:i}},e.id)))}):(0,z.jsx)(nt().A,{shouldShowGrayFog:n,children:t.map((e=>(0,z.jsx)(ot().A,{store:e,disabled:!1,commentProps:{shouldHideBlockActionMenu:o,onRemoveBlockFromComment:i}},e.id)))})}var rt=()=>o(797265);const at=3,lt=4;function ct(e){let{stores:t,embedBlockLocation:o,onRemoveContent:n}=e;const i=(0,r().v3)();if(0===t.length)return null;if(t.length<=at)return(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:t.map((e=>(0,z.jsx)(dt,{store:e,embedBlockLocation:o,onRemoveContent:n,isLarge:!0},e.id)))});if(t.length<=lt)return(0,z.jsx)("div",{style:{display:"flex",gap:4},children:t.map((e=>(0,z.jsx)(dt,{store:e,embedBlockLocation:o,onRemoveContent:n,isLarge:!1},e.id)))});const s=t.slice(0,lt-1),a=t[lt-1],l=t.length-lt+1,c=t.slice(lt);return(0,z.jsxs)("div",{style:{display:"flex",gap:4},children:[s.map((e=>(0,z.jsx)(dt,{store:e,embedBlockLocation:o,onRemoveContent:n,isLarge:!1},e.id))),(0,z.jsxs)("div",{children:[(0,z.jsx)(je().A,{style:{position:"absolute",zIndex:1,width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.4)",borderRadius:8,color:"white",fontWeight:g().Wy.bold},hoveredStyle:{background:"rgba(0, 0, 0, 0.4)"},pressedStyle:{background:"rgba(0, 0, 0, 0.4)"},onClick:()=>{rt().iy({environment:i,blockStore:a})},children:`+${l}`}),(0,z.jsx)(dt,{store:a,embedBlockLocation:o,onRemoveContent:n,isLarge:!1},a.id)]}),(0,z.jsx)("div",{style:{display:"none"},children:c.map((e=>(0,z.jsx)(dt,{store:e,embedBlockLocation:o,onRemoveContent:n,isLarge:!1},e.id)))})]})}function dt(e){let{store:t,isLarge:o,embedBlockLocation:n,onRemoveContent:i}=e;const s=(0,d().IS)((e=>({imageShared:{border:`1px solid ${e.stroke.secondary}`,borderRadius:8,cursor:"zoom-in"}})),[]);return(0,z.jsx)(et().Ay,{store:t,blockLocation:n,disabled:!1,disableDrag:!0,disableResizers:!0,preserveScale:!0,inlineContentStyle:{...s.imageShared,...o?ut:mt},disableActions:!o,onRemoveBlockFromComment:o?i:void 0},t.id)}const ut={objectFit:"contain",width:"auto",height:"auto",maxWidth:240,maxHeight:240,minWidth:48,minHeight:48},mt={width:48,height:48,minWidth:48,minHeight:48};var pt=()=>o(773382);function gt(e){let{store:t}=e;const o=(0,c().K8)((()=>tt().default.getKeyState(tt().default.getBlockKey(t.id))),[t.id]),n=(0,p().tz)(),i=(0,d().IS)((e=>({wrapper:{height:48,width:214,display:"flex",alignItems:"center",background:"white",border:`1px solid ${e.regularDividerColor}`,borderRadius:12,padding:"8px 10px 8px 8px",gap:8},icon:{background:e.tint.regular,borderRadius:6,width:32,minWidth:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},fileDetails:{display:"flex",flexDirection:"column"},fileName:{fontSize:14,fontWeight:g().Wy.medium,lineHeight:"18px",color:e.text.primary,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},fileSizeText:{color:e.text.secondary},progressText:{color:e.text.tertiary},sizeAndProgressContainer:{display:"flex",alignItems:"center",gap:4,fontSize:12,lineHeight:"15px"}})),[]);if(!o)return(0,z.jsxs)("div",{style:i.wrapper,children:[(0,z.jsx)("div",{style:i.icon,children:(0,z.jsx)(b().A,{})}),(0,z.jsx)("div",{style:i.fileDetails,children:(0,z.jsx)("div",{style:i.fileName,children:n.formatMessage({id:"commentFilePlaceholder.loading",defaultMessage:"Loading..."})})})]});const{name:s,size:r,progressPercent:a}=o;return(0,z.jsxs)("div",{style:i.wrapper,children:[(0,z.jsx)("div",{style:i.icon,children:(0,z.jsx)(b().A,{})}),(0,z.jsx)("div",{style:{overflow:"hidden"},children:(0,z.jsxs)("div",{style:i.fileDetails,children:[(0,z.jsx)("div",{style:i.fileName,children:s}),(0,z.jsxs)("div",{style:i.sizeAndProgressContainer,children:[(0,z.jsx)("span",{style:i.fileSizeText,children:(0,D().formatFileSize)(r)}),(0,z.jsx)("span",{style:i.progressText,children:"—"}),(0,z.jsx)(b().A,{}),(0,z.jsx)(pt().A,{percentage:a,style:i.progressText})]})]})})]})}function ht(e){let{stores:t}=e;return 0===t.length?null:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:t.map((e=>(0,z.jsx)(gt,{store:e},e.id)))})}function ft(e){const t=e.discussionFormat===D().DiscussionFormat.Sidebar?Xe().ZO.SidebarComment:Xe().ZO.PageComment,{uploading:o,images:n,embeds:i,files:s}=(0,c().K8)((()=>{const[t,o]=ee().jB(e.contentStores,(e=>{const t=Boolean(tt().default.getKeyState(tt().default.getBlockKey(e.id))),o=(0,et().x7)(e);return t||!o})),[n,i]=ee().jB(o,(e=>e.getType()===F().xd.image)),[s,r]=ee().jB(i,(e=>"video"===e.getType()));return{uploading:t,images:n,embeds:s,files:r}}),[e.contentStores]);return 0===o.length&&0===n.length&&0===i.length&&0===s.length?null:(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:8},children:[(0,z.jsx)(ht,{stores:o}),(0,z.jsx)(ct,{stores:n,embedBlockLocation:t,onRemoveContent:e.onRemoveContent}),i.length>0&&(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:i.map((o=>(0,z.jsx)(et().Ay,{store:o,blockLocation:t,disabled:!1,disableDrag:!0,disableResizers:!0,preserveScale:!0,inlineContentStyle:{},onRemoveBlockFromComment:e.onRemoveContent},o.id)))}),(0,z.jsx)(st,{stores:s,collapsed:e.collapsed,shouldShowGrayFogInScroller:e.discussionHovered&&(e.discussionFormat===D().DiscussionFormat.Margin||e.discussionFormat===D().DiscussionFormat.Sidebar),onRemoveBlockFromComment:e.onRemoveContent})]})}function vt(){const e=(0,fe().X)("inbox_page_grouping"),t=(0,d().IS)((e=>({newBarLine:{height:"0px",borderBottom:`1px solid ${e.darkDividerColor}`,width:"100%",marginLeft:0},newBarWrapper:{color:e.mediumTextColor,textTransform:"uppercase",fontSize:10.5,letterSpacing:.5,fontWeight:g().Wy.semibold,display:"flex",alignItems:"center",margin:0,paddingTop:10,paddingBottom:10,paddingLeft:B().FB},newBarText:{padding:"0 10px",whiteSpace:"nowrap"},threadLine:{position:"absolute",backgroundColor:e.stroke.secondary,width:B().jw,height:"100%",borderRadius:2,left:B().im,top:-6}})),[]),o=(0,d().IS)((e=>({newBarLine:{height:"0px",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.tint.uiBlue,width:"100%",marginLeft:0},newBarWrapper:{color:e.mediumTextColor,fontSize:10,fontWeight:g().Wy.regular,display:"flex",alignItems:"center",paddingTop:10,paddingBottom:10,paddingLeft:B().FB},newBarText:{paddingLeft:4,paddingRight:4,whiteSpace:"nowrap",borderRadius:4,backgroundColor:e.tint.uiBlue,color:e.text.uiBluePrimary,marginLeft:12,marginRight:12},threadLine:{position:"absolute",backgroundColor:e.stroke.secondary,width:B().jw,height:"100%",borderRadius:2,left:B().im,top:-6}})),[]),n=e?o:t;return(0,z.jsxs)("div",{style:{position:"relative"},children:[(0,z.jsx)("div",{style:n.threadLine}),(0,z.jsxs)("div",{style:n.newBarWrapper,children:[(0,z.jsx)("div",{style:n.newBarLine}),(0,z.jsx)("div",{style:n.newBarText,children:e?(0,z.jsx)(p().sA,{id:"comment.newBar.label",defaultMessage:"New"}):(0,z.jsx)(p().sA,{id:"comment.newIndicator.label",defaultMessage:"New comments"})}),(0,z.jsx)("div",{style:n.newBarLine})]})]})}var xt=()=>o(898495);const St=function(e){const{store:t,discussionContext:n,discussionLocation:P,shouldShowThreadLine:F,discussionStore:U,blockStore:K,collapsed:W}=e,O=(0,r().v3)(),[H,N]=(0,i.useState)(!1),[V,$]=(0,i.useState)(!1),[Y,J]=(0,i.useState)(!1),[G,q]=(0,i.useState)(!1),[Q,Z]=(0,i.useState)("post_top_level_discussion"===P&&W),X=(0,c().K8)((()=>e.store.isDefined()?new(_().A)(O,e.store.getSpaceId()):void 0),[O,e.store]),ee=(0,c().K8)((()=>j().dd(e.store).filter((e=>(0,L().G_)(e,{table:o(179034).ev,id:e.id},"alive").getValue()))),[e.store]),te=(0,c().K8)((()=>U.getResolved()),[U]),oe=(0,c().K8)((()=>null==X?void 0:X.state.files),[X]),ne=(0,c().K8)((()=>null==X?void 0:X.state.textStore),[X]),ie=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,o(819121).p)(t)&&$(!0)}),[]),se=(0,i.useCallback)((()=>{$(!1)}),[]),re=(0,i.useCallback)((()=>{I().A.state||J(!0)}),[]),ae=(0,i.useCallback)((()=>{J(!1)}),[]),le=(0,a().S)(),ce=(0,c().uB)(void 0,o(463830).A),de=(0,c().K8)((()=>ce.state.open),[ce]),ue=(0,o(551619).Sm)(K),me=(0,c().K8)((()=>(0,o(252833).o7)(e.store.id)),[e.store.id]),pe=(0,c().K8)((()=>{const t=e.discussionStore.getComments();return Boolean(t&&t[0]===e.store.id)}),[e.discussionStore,e.store.id]),ge=(0,c().K8)((()=>{var t;const o=K.getRole(),n=T({isFirstComment:pe,discussionLocation:P}),i=K.pathIsDead(),s=o&&u().h9(o)||i,{device:r}=O,a="comment_only"===o||le&&"comment"===(null===(t=le.publicEditModeStore.state)||void 0===t?void 0:t.permission),l=n&&!r.isMobile&&!a&&!s;return Y||V||e.hoveringDiscussion&&n||de||r.isMobile||e.showResolveButtonByDefaultIfPossible&&l}),[K,e.hoveringDiscussion,e.showResolveButtonByDefaultIfPossible,pe,P,O,le,Y,V,de]),he=(0,i.useContext)(o(789550).R),fe=(0,c().K8)((()=>{const e=t.getCreatedByPointer();return e?{createdByPointer:e,lastEditedTime:t.getLastEditedTime(),createdTime:t.getCreatedTime(),text:t.getText(),reactions:L().Lk.getUserVisibleReactions(t)}:null}),[t]),ve=(0,c().K8)((()=>fe?L().sk.createChildStore(t,fe.createdByPointer):null),[fe,t]),xe=function(e){const{discussionLocation:t,isCommentCollapsed:o,isDiscussionCollapsed:n,maxLines:i}=e;if("post_top_level_discussion"===t)return o?i:void 0;return n?i:void 0}({discussionLocation:P,isCommentCollapsed:Q,isDiscussionCollapsed:W,maxLines:e.maxLines}),Se=(0,i.useCallback)((()=>{S().createAndCommit({userAction:"Comment.deleteComment",environment:O,canUndo:!0,perform:t=>{M().Tu({environment:O,commentStore:e.store,transaction:t,discussionLocation:P})},skipUpdatingEditedMetadata:!0})}),[O,e.store,P]),be=(0,i.useCallback)((async()=>{const{accept:e}=await f().Gh({message:(0,z.jsx)(p().sA,{defaultMessage:"Would you like to delete this comment?",id:"comment.confirmDialog.deleteComment.prompt"}),acceptLabel:(0,z.jsx)(p().sA,{defaultMessage:"Delete",id:"comment.confirmDialog.deleteComment.deleteButton.label"})});e&&(Se(),h().UP(),E().A.state.overlapsExistingDiscussionMenu&&!k().A.state.open&&E().A.setState({...E().A.state,overlapsExistingDiscussionMenu:!1}),R().jS(O))}),[Se,O]),Ce=(0,i.useCallback)((async t=>{const o=j().gp(e.store).getValue(),n=j().dd(e.store).filter((e=>e.id!==t.id)),i=o&&o.length>0,s=0===n.length;!i&&s?(await be(),N(!1)):S().createAndCommit({userAction:"Comment.handleRemoveFileFromActions",environment:O,canUndo:!0,perform:o=>{M().L6({commentStore:e.store,fileBlocks:[t],transaction:o})}})}),[O,be,e.store]),ye=(0,i.useCallback)((()=>{q(!0)}),[]),Ae=(0,i.useCallback)((async()=>{if(!X)return;const t=j().gp(e.store).getValue()||[],n=X.state.textStore;S().createAndCommit({userAction:"Comment.handleEditComment",environment:O,canUndo:!0,perform:e=>{o(606952).KY({environment:O,store:n,value:t,transaction:e})}}),N(!0),await s().default.afterNextFlush(),await s().default.afterNextFlush(),x().setSelectionAtEnd({store:n})}),[X,O,e.store]),je=(0,i.useCallback)((async()=>{if(!X)return!1;if(!(0,D().hasCommentChanged)(X,e.store))return N(!1),!0;{const{accept:e}=await f().Gh({message:(0,z.jsx)(p().sA,{defaultMessage:"Do you want to discard this edit?",id:"comment.confirmDialog.discardEdit.prompt"}),acceptLabel:(0,z.jsx)(p().sA,{defaultMessage:"Discard",id:"comment.confirmDialog.discardEdit.discardButton.label"})});if(e)return N(!1),!0}return!1}),[X,e.store]),we=(0,i.useCallback)((async()=>{const t=null==ne?void 0:ne.getValue();t&&t.length>0||oe&&oe.length>0?S().createAndCommit({userAction:"Comment.handleSubmitEdit",environment:O,canUndo:!0,perform:o=>{M().QA({environment:O,store:e.store,text:t||[],transaction:o,discussionLocation:P,files:oe||[],property_id:U.getPropertyId(),blockStore:K})}}):await be(),N(!1)}),[ne,oe,O,e.store,P,U,K,be]),ke=(0,i.useCallback)((()=>{"post_top_level_discussion"===P&&Z(!1)}),[P]),Ie=(0,i.useRef)(null),Le=(0,i.useRef)(null);(0,l().b)(w().A,(()=>({edit:Ae,handleCancelEdit:je,getNode:()=>Ie.current,isEditing:()=>H,discussionLocation:P,commentId:e.store.id})),[Ae,je,H,P,e.store.id]);const Me=null==fe?void 0:fe.text,Re=void 0!==Me&&Me.length>0&&m().AhH(Me)>0,Be=Re&&(0,D().isCommentAllEmojis)(Me),De=function(e){let{discussionLocation:t,isAllEmojis:o}=e;return(0,d().IS)((e=>({container:{flexGrow:"comment_unfurl"===t?1:void 0,paddingTop:"comment_unfurl"===t?B().ds:B().e4,paddingRight:"margin_comments"===t?12:16,paddingBottom:B().Wv,paddingLeft:B().SM(t)},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:B().FB},discussionInputContainer:{width:"calc(100% + 8px)"},threadLine:{position:"absolute",backgroundColor:e.stroke.secondary,borderRadius:2,width:B().jw,height:B().k2,left:B().im,top:B().uG},unfurlMoreWrapper:{color:e.lightTextColor,fontWeight:"comment_unfurl"===t?g().Wy.medium:void 0,display:"block",marginBottom:-1.5,pointerEvents:"auto"},attachIcon:{width:18,height:18,fill:e.mediumIconColor},text:{cursor:"comment_unfurl"!==t?"text":void 0,lineHeight:"20px",paddingTop:4,...o?{fontSize:32,lineHeight:"32px"}:{}},attachmentContainer:{display:"flex",alignItems:"center"},commentAttachment:{},authorRowContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},unreadStatusDot:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:4}})),[t,o])}({discussionLocation:P,isAllEmojis:Be}),Te=(0,i.useMemo)((()=>({type:"comment_match",commentId:e.store.id})),[e.store.id]),_e="comment_unfurl"!==P,Ee=_e&&fe&&fe.reactions.length>0;if((0,i.useEffect)((()=>{G&&Le.current&&Ee&&(v().hT({element:Le.current,environment:O,scrollerContext:he,vertical:{reveal:"closest"},horizontal:void 0,animate:!0}),q(!1))}),[O,he,G,Ee]),!X)return null;if(!fe||!ve)return null;const Pe=ee.length>0&&(0,z.jsx)("div",{style:De.commentAttachment,children:(0,z.jsx)(ft,{contentStores:ee,onRemoveContent:Ce,discussionFormat:(0,D().discussionLocationToDiscussionFormat)(P),collapsed:W,discussionHovered:e.hoveringDiscussion})});return(0,z.jsxs)("div",{ref:Ie,onClick:e=>H&&e.stopPropagation(),style:De.container,children:[e.showNewBar&&(0,z.jsx)(vt,{}),(0,z.jsxs)("div",{style:De.comment,onFocus:ie,onBlur:se,onMouseMove:re,onMouseLeave:ae,children:[(0,z.jsxs)("div",{style:De.authorRowContainer,children:[(0,z.jsx)(o(436683).Y,{createdTime:fe.createdTime,lastEditedTime:fe.lastEditedTime,discussionLocation:P,isResolved:te,isSuggestionComment:e.isSuggestionComment,authorStore:ve}),e.showUnreadStatusDot&&(0,z.jsx)("div",{style:De.unreadStatusDot,children:(0,z.jsx)(A().m,{size:6})})]}),F&&(0,z.jsx)("div",{style:De.threadLine}),(0,z.jsxs)("div",{style:De.commentElementsBelowUserRow,children:[Boolean(n)&&n,H&&(0,z.jsx)("div",{style:{marginTop:4},children:(0,z.jsx)(xt().A,{containerStyle:De.discussionInputContainer,showAvatar:!1,parentStore:e.store,blockStore:K,onCancel:je,onSubmit:we,discussionInputStore:X,isEditingExistingComment:!0,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,commentStore:e.store,discussionFormat:(0,D().discussionLocationToDiscussionFormat)(P),canDrop:!0})}),Re&&!H&&(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,z.jsx)(y().A,{onMore:"comment_unfurl"===P?void 0:ke,moreElement:(0,z.jsxs)(C().A,{disableUnderline:!0,style:De.unfurlMoreWrapper,hoverColor:"blue",children:["…"," ",(0,z.jsx)("span",{children:(0,z.jsx)(p().sA,{id:"comment.truncated.showMoreLabel",defaultMessage:"more"})})]}),maxLines:xe,children:(0,z.jsx)(o(246722).A,{style:De.text,store:j().gp(e.store),disabled:!0,disabledMentionTypes:{date:!0},disableEquationInteraction:!0,inPageFind:Te})}),ue&&me&&(0,z.jsx)(b().A,{style:{alignSelf:"flex-end",marginRight:8,marginLeft:8}})]}),H||"comment_unfurl"===P?!Re&&(0,z.jsxs)("div",{style:De.attachmentContainer,children:[(0,z.jsx)("div",{style:{marginRight:5},children:(0,o(819713).j)(De.attachIcon)}),(0,z.jsx)(p().sA,{defaultMessage:"{numberOfAttachments, plural, one {{numberOfAttachments} attachment} other {{numberOfAttachments} attachments}}",values:{numberOfAttachments:ee.length},id:"comment.unfurl.attachments.title"})]}):Pe,Ee&&(0,z.jsx)("div",{ref:Le,style:{marginTop:8},children:(0,z.jsx)(Ye,{parentStore:e.store,discussionLocation:P})})]}),"comment_unfurl"!==P&&!H&&!ue&&(0,z.jsx)(Ge,{store:e.store,discussionStore:e.discussionStore,blockStore:K,discussionLocation:P,visible:ge,isFirstComment:pe,buttonPopupStore:ce,canShowReactions:_e,handleEditComment:Ae,handleDeleteComment:be,handleReaction:ye})]})]})};o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(672577);var bt=()=>o(601813),Ct=()=>o(220719),yt=()=>o(478726),At=()=>o(953418),jt=()=>o(695625),wt=()=>o(546574);function kt(e){var t;let{discussionStore:o,commentStore:n}=e;if(!n.isDefined())return!1;const i=null===(t=ve().default.state.currentUserStore)||void 0===t?void 0:t.id;const s=wt().A.state.lastInteractionTimes[o.id];if(n.getCreatedById()===i)return!1;const r=function(){if(!o.isDefined()||!i)return 0;const{pageVisitStore:e}=ve().default.state,{lastViewTime:t,lastExitTime:n}=e.state;return n||t}();if(void 0===r)return!1;const a=(0,D().getAndSortCommentStoresByTime)(o).filter((e=>e.getCreatedById()===i)).reverse()[0],l=n.getCreatedTime();return!l||!(a&&l<a.getCreatedTime())&&(!(s&&l<s)&&l>r)}var It=()=>o(641007),Lt=()=>o(133033),Mt=()=>o(693954),Rt=()=>o(187485),Bt=()=>o(265665);const Dt="https://notion.notion.site/AI-Conflict-Detection-158efdeead058037b57efc2b77ad9c21";function Tt(e){let{origin:t}=e;const n=(0,d().IS)((e=>({learnMoreLink:{color:e.text.contrastPrimary}})),[]);return(0,z.jsx)(o(956363).B,{origin:t,placementToOrigin:"bottom",tutorialId:"ai-comment-onboarding",tutorialStepId:"ai-comment-onboarding-tooltip",hideActions:!0,hideInsteadOfFlip:!0,header:(0,z.jsx)(p().sA,{id:"AiCommentOnboardingTooltip.header",defaultMessage:"Check for conflicts with Notion AI"}),content:(0,z.jsx)(p().sA,{id:"AiCommentOnboardingTooltip.content",defaultMessage:"Notion AI searches across your workspace and connected apps for conflicting information, using only sources that all members can access. {learnMoreLink}",values:{learnMoreLink:(0,z.jsx)(o(285176).o,{href:Dt,style:n.learnMoreLink})}})})}function _t(e){const{discussionLocation:t,commentStore:o}=e,n=(0,c().K8)((()=>{if(!o)return!1;const e=o.getCreatedByPointer();return!!e&&e.id===It().px.id}),[o]),i=(0,r().Y0)(),s=(0,d().IS)((e=>({container:{display:"flex",flexDirection:"row",gap:6,width:"100%",color:e.lightTextColor,fontSize:i.isMobile?g().J.UISmall.mobile:g().J.UISmall.desktop,paddingTop:B().e4,paddingLeft:B().SM(t)+B().eQ-8},warningIcon:{width:10,height:10,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"},helpIcon:{color:e.lightTextColor,flexDirection:"row-reverse",gap:6,width:14,alignItems:"center",cursor:"pointer",textDecoration:"none",pointerEvents:"auto"},text:{maxWidth:200}})),[i,t]);return n?(0,z.jsxs)("div",{style:s.container,children:[(0,Mt().Q)(s.warningIcon),(0,z.jsx)(Bt().j,{style:s.text,children:(0,z.jsx)(p().sA,{id:"aiCommentHeader.conflictingContent.label",defaultMessage:"Notion AI found potential conflicts"})}),(0,z.jsx)(Rt().A,{href:Dt,external:!0,style:s.helpIcon,children:(0,Lt().$)({width:14,marginRight:4})})]}):null}var Et=()=>o(846583),Pt=()=>o(449729),Ft=()=>o(651196),Ut=()=>o(506327),Kt=()=>o(532945);var Wt=()=>o(631611),Ot=()=>o(972435);const Ht=(0,p().YK)({helpful:{id:"assistant.commentFeedback.helpful",defaultMessage:"Helpful"},notHelpful:{id:"assistant.commentFeedback.notHelpful",defaultMessage:"Not helpful"},feedbackPlaceholder:{id:"assistant.commentFeedback.feedbackPlaceholder",defaultMessage:"How can we improve?"},thankYou:{id:"assistant.commentFeedback.thankYou",defaultMessage:"Thank you for your feedback!"}});function Nt(e){const{blockStore:t}=e,n=t.id,i=function(e){const t=(0,r().v3)(),o=(0,c().K8)((()=>{const o=e.getNavigableBlockStore();if(o)return new(L().Gd)(t,{table:Ut().bw,id:o.id,spaceId:o.getSpaceId()})}),[t,e]);return(0,c().K8)((()=>{if(!o)return;const t=e.id,n=o.getRelatedContent().find((e=>e.targetId===t));return n?{feedback:Kt().A.state[n.inferenceId],inferenceId:n.inferenceId}:void 0}),[o,e.id])}(t),s=null==i?void 0:i.feedback,a=null==i?void 0:i.inferenceId,l=(0,r().v3)(),u=(0,o(11978).O)(),m=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:12,width:"100%"},buttonRow:{display:"flex",flexDirection:"row",gap:8}})),[]);return a?(0,z.jsx)(Wt().hP,{surface:Wt().wy.conflictingContentComment,children:(0,z.jsx)("div",{style:m.container,children:(0,z.jsxs)("div",{style:m.buttonRow,children:[(0,z.jsx)(Ft().Ay,{title:Ot().A.formatMessage(Ht.helpful),variant:"tinted",icon:"thumbs_up"===s?o(886903).x:o(72275).x,onClick:()=>{if(!u||!a)return;const e=t.getNavigableBlockStore();e&&(0,Pt().H8)({environment:l,pageId:e.id,blockId:n,spaceId:u,inferenceId:a,thumbsUpOrDown:"up"})}}),(0,z.jsx)(Ft().Ay,{title:Ot().A.formatMessage(Ht.notHelpful),variant:"tinted",icon:"thumbs_down"===s?o(592834).a:o(317658).Q,onClick:()=>{if(!u||!a)return;const e=t.getNavigableBlockStore();e&&(0,Pt().H8)({environment:l,pageId:e.id,blockId:n,spaceId:u,inferenceId:a,thumbsUpOrDown:"down"})}})]})})}):null}const zt={block_menu:"8px 16px 0px",page_discussion:"8px 0px 0px",updates_sidebar:"4px 16px 12px",margin_comments:"8px 12px 6px",comment_unfurl:"0",post_top_level_discussion:"0px -16px 0px",updates_menu_mentions_comments:"4px 16px 12px",updates_menu_all_updates:"4px 16px 12px",updates_menu_archive:"4px 16px 12px",reply_menu_mentions_comments:"8px 16px 0px",reply_menu_all_updates:"8px 16px 0px",reply_menu_archive:"8px 16px 0px",reply_menu_updates_sidebar:"8px 16px 0px",ai_reject_all_suggestions:"0"},Vt=i.forwardRef((function(e,t){const n=(0,r().v3)(),{format:s,role:a,showMoreCommentsButton:l,onMoreCommentsClick:m,inputVisible:p,blockStore:g,store:h}=e,f=(0,o(891078).i0)(g),v=a&&u().h9(a)||f,x=n.currentUser.isLoggedIn(),S=(0,i.useRef)(null),b=(0,d().IS)((t=>({container:{position:"relative",padding:0,...s===D().DiscussionFormat.Page?{marginLeft:16,marginRight:16}:{}},discussionInputContainer:{padding:zt[e.discussionLocation]},aiFeedbackContainer:{display:"flex",flexDirection:"row",gap:8,marginLeft:"page_discussion"===e.discussionLocation?32:24,padding:zt[e.discussionLocation]}})),[s,e.discussionLocation]),C=(0,c().K8)((()=>{const e=h.getCommentStores()[0];if(!e)return!1;const t=e.getCreatedByPointer();return!!t&&t.id===It().px.id}),[h]);return(0,z.jsx)(z.Fragment,{children:x&&!v&&(l||p)&&(0,z.jsxs)("div",{style:b.container,children:[l&&(0,z.jsx)(o(499512).A,{onClick:m}),p&&(C?(0,z.jsxs)("div",{style:b.aiFeedbackContainer,ref:S,children:[(0,z.jsx)(Nt,{blockStore:g,location:e.discussionLocation}),(0,z.jsx)(Tt,{origin:S})]}):(0,z.jsx)(xt().A,{autoFocus:!0,showAvatar:!0,containerStyle:b.discussionInputContainer,parentStore:e.store,onCancel:e.onCancel,onSubmit:e.onSubmit,discussionInputStore:e.discussionInputStore,isMobileSlideUpMenu:!1,shouldSaveUnsentComments:!0,onEditPreviousComment:e.onEditPreviousComment,inReplyToDiscussionId:e.store.id,discussionFormat:e.format,showCtaButtons:e.showCtaButtons,ref:t,onFileUploaded:e.onFileUploaded}))]})})}));var $t=()=>o(493823);function Yt(e){const t=(0,d().IS)((t=>{const o=B().SM(e.discussionLocation)+B().eQ;return{newBarLine:{height:"0px",borderBottom:`1px solid ${t.darkDividerColor}`,marginLeft:0,flex:1},moreCommentsWrapper:{color:t.lightTextColor,fontSize:14,flexGrow:1,display:"flex",alignItems:"center",paddingLeft:8},button:{borderRadius:6,fontSize:14,color:t.mediumTextColor,justifyContent:"space-between",padding:"14px 0",margin:`0 0 0 ${o}px`,width:`calc(100% - ${o}px - 16px)`},buttonHovered:{background:t.focusDiscussionInputBackground},threadLine:{position:"absolute",backgroundColor:t.stroke.secondary,width:B().jw,height:"100%",top:B().e4-B().Yz,left:B().SM(e.discussionLocation)+B().im,borderRadius:2}}}),[e.discussionLocation]);return e.count<=0?null:(0,z.jsxs)("div",{style:{position:"relative"},children:[(0,z.jsx)("div",{style:t.threadLine}),(0,z.jsx)($t().p,{isGray:!0,size:"xs",style:t.button,onClick:e.onClick,hoveredStyle:t.buttonHovered,children:(0,z.jsx)("div",{className:"discussion-show-all-button",style:t.moreCommentsWrapper,children:(0,z.jsx)(p().sA,{defaultMessage:"Show {moreCommentsNumber, plural, one {{moreCommentsNumber} reply} other {{moreCommentsNumber} replies}}",id:"discussion.showMoreCommentsSidebarButton.label",values:{moreCommentsNumber:e.count}})})},"show")]})}var Jt=()=>o(797809),Gt=()=>o(921855);function qt(e){const{discussionStore:t}=e,o=(0,p().tz)(),n=(0,c().K8)((()=>t.isSuggestionDiscussion()),[t]),i=(0,c().K8)((()=>{const t=e.discussionStore.getContext();return(t?(0,bt().Qe)({discussionContextData:t,discussionId:e.discussionStore.id,discussionType:(0,Ct().o9)(e.discussionStore.getType()),intl:o}):[])??[]}),[e.discussionStore,o]),s=(0,d().IS)((e=>({container:{marginTop:2},label:{color:e.text.uiBlueSecondary,fontSize:14,lineHeight:"18px"},labelDeleteColor:{color:e.text.tertiary},text:{color:e.text.uiBluePrimary,fontSize:14,lineHeight:1.29},textDeleteColor:{color:e.text.secondary},suggestionContextItem:{display:"block",marginBottom:4,whiteSpace:"pre-wrap",wordBreak:"break-word"},unfurlMoreWrapper:{color:e.lightTextColor,fontWeight:g().Wy.medium,display:"block",marginBottom:-1.5,pointerEvents:"auto"}})),[]),r=(0,Jt().RX)(o).title;return n&&r&&0!==i.length?(0,z.jsx)("div",{style:s.container,children:(0,z.jsx)(y().A,{maxLines:e.collapsed?1:void 0,clampOverride:{lineHeight:1.29,fontSize:14},moreElement:(0,z.jsxs)(C().A,{disableUnderline:!0,style:s.unfurlMoreWrapper,hoverColor:"blue",children:["…"," ",(0,z.jsx)("span",{children:(0,z.jsx)(p().sA,{id:"suggestion.truncated.showMoreLabel",defaultMessage:"more"})})]}),children:i.map(((e,o)=>{let{label:n,value:i,shouldUseDeleteColor:r,removeQuotationMarks:a}=e;return(0,z.jsxs)("div",{style:s.suggestionContextItem,children:[(0,z.jsxs)("span",{style:{...s.label,...r&&s.labelDeleteColor},children:[n,": "]}),(0,z.jsxs)("span",{style:{...s.text,...r&&s.textDeleteColor},children:[a?null:"“",(0,z.jsx)(Qt,{value:i,discussionStore:t}),a?null:"”"]})]},o)}))})}):null}function Qt(e){let{value:t,discussionStore:o}=e;const n=(0,r().v3)(),i=(0,d().DP)(),s=(0,c().K8)((()=>(0,Gt().S5)({environment:n,textValue:{value:t,spaceId:o.pointer.spaceId},parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!0,disabled:!0,theme:i,emojiType:(0,Te().FN)(n),katex:n.KatexStore.getKatex(),formulaValueTypes:[]})),[n,t,o,i]);return(0,z.jsx)("span",{children:s})}function Zt(e){const{onDismiss:t}=e,n=(0,i.useRef)(null),a=(0,p().tz)(),u=(0,r().v3)(),g=(0,c().K8)((()=>"suggestion"===e.store.getType()),[e.store]),h=(0,c().K8)((()=>j().wc(e.store)),[e.store]),b=(0,c().K8)((()=>h.filter((e=>e.isDefined())).filter((e=>Boolean(e.getAlive())))),[h]),C="page_discussion"===e.discussionLocation?3:5;(0,i.useEffect)((()=>{b.length===C&&U(!0)}),[b,C]);const y=(0,i.useRef)(e.discussionInputStore||new(_().A)(u,e.store.pointer.spaceId)).current,k=(0,c().K8)((()=>(0,D().inputIsEmpty)(y)),[y]),R=(0,c().K8)((()=>(0,yt().fc)(e.blockStore)&&!(0,yt().Cg)(e.blockStore)),[e.blockStore]),T=(0,c().K8)((()=>e.store.getResolved()),[e.store]),[E,P]=(0,i.useState)(!1),[F,U]=(0,i.useState)(void 0!==e.collapsed&&!e.collapsed),[K,W]=(0,i.useState)(!0),O=(0,c().uB)(void 0,o(17090).A),H=(0,c().K8)((()=>O.state.clientRect),[O]),N=e.format===D().DiscussionFormat.Sidebar,V=e.format===D().DiscussionFormat.Margin,$=(0,i.useRef)(null);(0,l().b)(o(143857).A,(()=>({isSidebarFormat:()=>N,isMarginFormat:()=>V,getStore:()=>e.store,getInputStore:()=>y,getNode:()=>$.current,getMarginDiscussionScrollContainer:()=>n.current})),[N,V,e.store,y]);const Y=(0,c().K8)((()=>{if(!N)return;return(0,D().getAndSortCommentStoresByTime)(e.store).find((t=>kt({discussionStore:e.store,commentStore:t})))}),[N,e.store]),J=(0,i.useRef)(Y),G=(0,fe().X)("comment_sidebar_for_you"),q=(0,c().K8)((()=>G&&e.store.isUnread()),[e.store,G]),Q=(0,c().K8)((()=>{if(!G)return void 0===J.current?Y:J.current;if(!e.store.getSpaceId())return;const t=e.store.getUserSeenRecordStore();if(!t)return;const o=t.getLastSeenAt();if(!o)return Y;const n=b.find((e=>e.getCreatedTime()>o));return n||void 0}),[G,Y,J,b,e.store]),Z=(0,i.useCallback)((()=>{var t;if(F||b.length<=C||"block_menu"===e.discussionLocation)return b;if("page_discussion"===e.discussionLocation)return ee().O6(b,1);const o=[e.showAllRepliesAfterTimestamp,null===(t=J.current)||void 0===t?void 0:t.getCreatedTime(),null==Y?void 0:Y.getCreatedTime()].filter(te().O9),n=o.length>0?Math.min(...o):void 0;if(n){const e=b.filter((e=>(e.getCreatedTime()||0)>n)),t=b.filter((e=>(e.getCreatedTime()||0)<=n));return t.length<=5?b:[...ee().O6(t,2),...e]}return ee().O6(b,2)}),[b,Y,C,e.discussionLocation,e.showAllRepliesAfterTimestamp,F]),X=(0,c().K8)((()=>{const t=Z(),o=new Set(t.map((e=>e.id))),n=b.filter((e=>!o.has(e.id)));return{commentStores:b,commentsToShow:t,commentsToCollapse:n,reactionsToShow:L().Lk.getUserVisibleReactions(e.store)}}),[b,Z,e.store],{useDeepEqual:!0}),oe=(0,i.useCallback)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext();if(!t)return;const o=(0,bt().l8)({discussionContextData:t,discussionType:(0,Ct().o9)(e.store.getType()),discussionId:e.store.id,intl:a});return m().JJ$(o,(t=>!m().iQL(t)||m().Orm(t)===e.store.id))}),[e.store,a]),ne=(0,c().K8)((()=>{if(!N)return;return(0,D().getAndSortCommentStoresByTime)(e.store).find((t=>kt({discussionStore:e.store,commentStore:t})))}),[N,e.store]),ie=(0,i.useRef)(null),se=(0,i.useRef)(e.blockStore.clone()).current,re=(0,d().IS)((t=>({discussionWrapper:{...e.format===D().DiscussionFormat.Page&&{margin:`0px ${B().Ql}px 16px`,..."post_top_level_discussion"===e.discussionLocation&&{marginLeft:-16,marginBottom:X.reactionsToShow.length>0?0:12}},...e.format===D().DiscussionFormat.Menu&&{padding:"6px 0 12px",marginLeft:-2,boxShadow:e.isFirst?"none":`0 -1px 0 ${t.regularDividerColor}`,marginTop:e.isFirst?0:1},...e.format===D().DiscussionFormat.Margin&&{padding:"4px 0",borderRadius:8}},reactionBarWrapper:{paddingLeft:16,paddingRight:16,..."post_top_level_discussion"===e.discussionLocation&&{display:"flex",justifyContent:"space-between"}}})),[X.reactionsToShow.length,e.discussionLocation,e.format,e.isFirst]);(0,i.useEffect)((()=>{u.KatexStore.loadIfNeeded(oe)}),[u.KatexStore,oe]);const ae=(0,i.useCallback)((t=>{const{device:n}=u;if(!n.isMobile)return;if(!e.store.isDefined())return;t.stopPropagation(),t.preventDefault(),o(265201).A.setState({open:!1});const i=ee().oE(jt().T.findSelectablesFromIds([e.store.getParentId()])),s=null==i?void 0:i[0];s&&v().pb({environment:u,handle:s,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})}),[e.store,u]),le=(0,i.useCallback)((e=>{V||(e.stopPropagation(),U(!0))}),[V]),ce=(0,i.useMemo)((()=>{const{commentStores:t,commentsToShow:i,commentsToCollapse:s}=X;if(V){const i=(0,D().lineClampForCommentCount)(t.length);if(!e.collapsed)return(0,z.jsx)(o(2143).H,{style:{display:"flex",flexDirection:"column",maxHeight:500,overflowY:"scroll"},ref:n,type:o(756279).A.Y,store:O,children:t.map(((o,n)=>{const s=g&&0===n;return(0,z.jsx)(St,{store:o,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:E,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,shouldShowThreadLine:n!==t.length-1,discussionContext:s?(0,z.jsx)(qt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):void 0,showNewBar:o.id===(null==Q?void 0:Q.id)&&0!==n,isSuggestionComment:s,showUnreadStatusDot:0===n&&q},o.id)}))});const s=t[0]&&(0,z.jsx)(St,{store:t[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:E,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,collapsed:e.collapsed,shouldShowThreadLine:1!==t.length,discussionContext:g?(0,z.jsx)(qt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):void 0,isSuggestionComment:g,showUnreadStatusDot:q},t[0].id),r=t.length>1&&t[t.length-1]&&(0,z.jsx)(St,{store:t[t.length-1],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:E,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,collapsed:e.collapsed,shouldShowThreadLine:!1},t[t.length-1].id),a=t.length-2;return(0,z.jsxs)(z.Fragment,{children:[s,(0,z.jsx)(Yt,{insetButton:!V,count:a,onClick:le,discussionLocation:e.discussionLocation}),r]})}const r=s.length>0,a=i.map(((t,o)=>{const n=g&&0===o,s=0===o&&!r,a=n?(0,z.jsx)(qt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):s&&(e.format===D().DiscussionFormat.Menu||e.format===D().DiscussionFormat.Sidebar)&&(0,z.jsx)(Et().A,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:ae}),l="post_top_level_discussion"===e.discussionLocation?(0,D().lineClampForCommentCount)(i.length):void 0;return(0,z.jsx)(St,{store:t,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:E,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:a,isSuggestionComment:n,showNewBar:t.id===(null==Q?void 0:Q.id)&&0!==o,shouldShowThreadLine:o!==i.length-1,maxLines:l,showUnreadStatusDot:s&&q},t.id)})),l=g,c=l?(0,z.jsx)(qt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):(e.format===D().DiscussionFormat.Menu||e.format===D().DiscussionFormat.Sidebar)&&(0,z.jsx)(Et().A,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:ae});return(0,z.jsxs)("div",{style:{position:"relative"},children:[!G&&N&&ne&&(0,z.jsx)(A().m,{style:eo}),r&&(0,z.jsx)(St,{store:t[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:E,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:c,shouldShowThreadLine:1!==t.length,isSuggestionComment:l,collapsed:e.collapsed,maxLines:"post_top_level_discussion"===e.discussionLocation&&e.collapsed?(0,D().lineClampForCommentCount)(t.length):void 0,showUnreadStatusDot:q},t[0].id),(0,z.jsx)(Yt,{insetButton:!V,count:s.length-1,onClick:le,discussionLocation:e.discussionLocation}),a]})}),[X,V,g,e.store,e.collapsed,e.format,e.discussionLocation,e.blockStore,e.showResolveButtonByDefaultIfPossible,ae,N,ne,E,q,le,O,null==Q?void 0:Q.id,G]),de=(0,c().K8)((()=>e.blockStore.getRole()),[e.blockStore]),[ue,me]=(0,i.useState)(!0);(0,i.useEffect)((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.getNode();if(t){function o(){t&&me(At().wU(t))}return t.addEventListener("scroll",o),()=>t.removeEventListener("scroll",o)}}),[n]);const pe=K&&!e.collapsed&&V&&H&&!ue,ge=(0,i.useCallback)((()=>{const e=jt().T.findSelectableFromStore(se);e&&v().pb({environment:u,handle:e,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})}),[se,u]),he=(0,i.useCallback)((()=>{y.reset()}),[y]),ve=(0,i.useCallback)((()=>{const t=u.currentUser.id;if(!t)return;const o=j().wc(e.store).filter((e=>e.getCreatedById()===t)),n=ee().HV(o);if(!n)return;if(g&&1===o.length)return;const i=w().A.find((t=>t.commentId===n.id&&t.discussionLocation===e.discussionLocation));i&&(x().clear({environment:u}),i.edit())}),[e.discussionLocation,g,e.store,u]),xe=(0,i.useCallback)((async()=>{if((0,D().hasCommentChanged)(y)){const{accept:e}=await f().Gh({message:(0,z.jsx)(p().sA,{defaultMessage:"Do you want to discard this reply?",id:"discussion.confirmDialog.discardReply.prompt"}),acceptLabel:(0,z.jsx)(p().sA,{defaultMessage:"Discard",id:"discussion.confirmDialog.discardReplyButton.label"})});e?(he(),t&&t()):(await s().default.afterNextFlush(),x().setSelectionAtEnd({store:y.state.textStore}))}else he(),t&&t()}),[t,y,he]),Se=(0,i.useCallback)((()=>{s().default.afterNextFlush((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.getNode();t&&At().VG({element:t,environment:u,options:{top:t.scrollHeight,behavior:"smooth"}})}))}),[n,u]),be=ee().sg((()=>{setTimeout((()=>W(!0)),50)}),50),Ce=(0,i.useCallback)((async()=>{W(!1);const{device:t}=u;S().createAndCommit({userAction:"Discussion.handleSubmitReply",environment:u,canUndo:!0,perform:t=>{M().lV({environment:u,discussionStore:e.store,textValue:y.state.textStore.getValue()||[],transaction:t,discussionLocation:e.discussionLocation,files:y.state.files,property_id:e.store.getPropertyId(),blockStore:e.blockStore})}}),he(),x().clear({environment:u}),Se(),be(),t.isMobile||(await s().default.afterNextFlush(),x().setSelectionAtStart({store:y.state.textStore}))}),[y,be,e.blockStore,e.store,e.discussionLocation,Se,u,he]),ye=(0,i.useCallback)((()=>{I().A.state||P(!0)}),[]),Ae=(0,i.useCallback)((()=>{P(!1)}),[]);return 0===X.commentsToShow.length&&X.reactionsToShow.length>0||"post_top_level_discussion"===e.discussionLocation&&0===X.commentsToShow.length&&X.reactionsToShow.length>0?(0,z.jsxs)("div",{ref:$,style:{...re.discussionWrapper,...re.reactionBarWrapper},onMouseMove:ye,onMouseLeave:Ae,children:[(0,z.jsx)($e,{focused:!0,disableShadow:!0,parentStore:e.store,discussionLocation:e.discussionLocation}),"post_top_level_discussion"===e.discussionLocation&&(0,z.jsx)(o(126126).hJ,{pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,rootStore:e.blockStore,maxUsers:5,isShowingInPostFeed:!0})]}):(0,z.jsx)(o(199896).A,{store:se,analyticsName:"discussion",canNativeDropOnto:!0,onNativeDrop:async e=>{let{files:t}=e;ie.current&&await ie.current.uploadFiles(t)},keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:(0,z.jsxs)("div",{ref:$,style:re.discussionWrapper,onMouseMove:ye,onMouseLeave:Ae,children:[!e.collapsed&&(0,z.jsx)(_t,{commentStore:h[0],discussionLocation:e.discussionLocation}),ce,T?(0,z.jsx)("div",{style:{height:8}}):(0,z.jsx)(Vt,{ref:ie,showMoreCommentsButton:!!pe,onMoreCommentsClick:Se,inputVisible:!(R||e.collapsed&&k&&"post_top_level_discussion"!==e.discussionLocation),store:e.store,blockStore:se,format:e.format,discussionInputStore:y,discussionLocation:e.discussionLocation,onCancel:xe,onSubmit:Ce,onEditPreviousComment:ve,showCtaButtons:!!V||void 0,onFileUploaded:ge,role:de})]})})}const Xt=i.memo(Zt),eo={marginRight:4,position:"absolute",right:16,top:14};var to=()=>o(886901),oo=()=>o(21140),no=()=>o(644914),io=()=>o(835066);const so=(0,p().YK)({commentsAriaLabel:{defaultMessage:"{count, plural, one {1 comment} other {{count} comments}}",id:"comments.components.discussionindicator.commentAriaLabel"},suggestionsAriaLabel:{defaultMessage:"{count, plural, one {1 suggestion} other {{count} suggestions}}",id:"comments.components.discussionindicator.suggestionAriaLabel"},reactionsAriaLabel:{defaultMessage:"{count, plural, one {1 reaction} other {{count} reactions}}",id:"comments.components.discussionindicator.reactionsAriaLabel"}});function ro(e){const t=(0,p().tz)(),{store:n,propertyId:i,style:s}=e,{showIndicator:a,formattedReactionCount:l,onlySuggestions:u,icon:m,showReactionsIcon:h,onlyHasDraftIndicator:f,formattedCommentCount:v,handleClick:x,discussionIsSelected:S,commentsCount:b,shouldShowDraftIndicator:C}=(0,o(257120).A)({store:n,recursivelyLoadAllDiscussions:!1,onlyCountBlockLevelDiscussions:!1,propertyId:i}),y=(0,d().IS)((e=>({iconButton:{background:S?e.selectLightGray[100]:void 0,gap:2},icon:{width:14,color:e.lightTextColor},commentCount:{marginLeft:2,color:e.lightTextColor,fontWeight:g().Wy.semibold,marginBottom:1},reactIcon:{width:14,height:14,color:e.lightTextColor},commentCaptionStyle:{fontWeight:g().Wy.semibold,...C?{color:e.icon.tertiary}:{color:e.lightTextColor,marginBottom:1}},reactionCaptionStyle:{fontWeight:g().Wy.semibold,color:e.lightTextColor}})),[S,C]),A=(0,r().v3)(),j=(0,c().K8)((()=>(0,no().me)(A)),[A]),w=(0,c().K8)((()=>(0,io().dC)(A,n)),[A,n]),{isPropertyInPageDetails:k}=(0,o(517223)._1)({store:n,propertyId:i});return!a||!k&&(j||w)?null:(0,z.jsxs)(oo().Ye,{style:s,children:[(b>0||f)&&(0,z.jsxs)(oo().Ye,{style:{position:"relative"},children:[(0,z.jsx)(se().A,{ariaLabel:u?t.formatMessage(so.suggestionsAriaLabel,{count:v}):t.formatMessage(so.commentsAriaLabel,{count:v}),icon:m,style:y.iconButton,iconStyle:y.icon,onClick:x,caption:v,captionStyle:y.commentCaptionStyle}),C&&(0,z.jsx)(o(359848).h,{customTop:3,customLeft:16,onlyShowDraftDot:!0})]}),h&&(0,z.jsx)(se().A,{ariaLabel:t.formatMessage(so.reactionsAriaLabel,{count:l}),icon:o(650225).l,style:y.iconButton,iconStyle:y.icon,onClick:x,captionStyle:y.reactionCaptionStyle,caption:l})]})}const ao=i.memo(ro);var lo=()=>o(519839),co=()=>o(747100),uo=()=>o(496506),mo=()=>o(983650),po=()=>o(94953),go=()=>o(116008),ho=(o(430670),()=>o(563884)),fo=()=>o(715862),vo=()=>o(125565),xo=()=>o(659799),So=()=>o(907514),bo=()=>o(938045);function Co(e){let{discussionData:{groupedDiscussionsData:t,newDiscussionData:o,id:n},onClick:s}=e;const[a,l]=(0,i.useState)(!1),u=(0,r().v3)(),m=u.currentUser.id,h=(0,i.useCallback)((()=>{l(!0)}),[]),f=(0,i.useCallback)((()=>{l(!1)}),[]),v=o,x=(0,i.useCallback)((async e=>{if(v){const e=ve().default.state.mainEditorCurrentBlockStore;E().A.setActiveWithSource("margin_comments"),await(0,bo().x)({currentBlockStore:e,discussionInputStore:o.discussionInputStore,environment:u})}else if(t.length>0){const o=t[0].discussionStore;await s(e,o)}}),[v,t,null==o?void 0:o.discussionInputStore,u,s]),{commentStores:S,reactionStores:b}=(0,c().K8)((()=>{if(t){return{commentStores:t.flatMap((e=>(0,j().wc)(e.discussionStore))),reactionStores:t.flatMap((e=>L().Lk.getUserVisibleReactions(e.discussionStore)))}}return{commentStores:[],reactionStores:[]}}),[t]),C=(0,c().K8)((()=>{let e;if(v&&(e=o.parentBlockStore),t.length>0&&(e=t[0].parentBlockStore),!e)return;const n=S.map((e=>e.getCreatedById())).filter(te().O9),i=b.map((e=>e.getActorPointers().map((e=>e.id)))).flat().filter(te().O9);return Array.from(new Set([...n,...i,...v&&m?[m]:[]])).map((t=>L().LU.createChildStore(e,{table:X().oo,id:t}))).slice(0,5)}),[t,v,S,b,m,null==o?void 0:o.parentBlockStore]),y=(0,c().K8)((()=>{const e=S.map((e=>e.getLastEditedTime())),t=b.map((e=>e.getCreatedTime()));return Math.max(...e,...t)}),[S,b]),w=(0,fe().X)("inbox_page_grouping"),k=(0,c().K8)((()=>{if(!w)return!1;return t.map((e=>e.discussionStore)).some((e=>e.isUnread()))}),[t,w]),I=(0,d().IS)((e=>({discussion:{background:a?e.hoveredMarginDiscussionBackground:e.contentBackground,width:io().JC,display:"flex",cursor:"pointer",border:`1px solid ${e.stroke.secondary}`,borderRadius:10,padding:"12px",alignItems:"center",gap:6},userAvatarsContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"row-reverse",marginRight:8},hiddenUsers:{fontSize:14,color:e.mediumTextColor,marginRight:6},lastEditedTime:{margin:"1px 0px 0px 0px",whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",color:e.text.tertiary,fontSize:12,lineHeight:"15px"},commentAuthorAvatarStyle:{borderRadius:20,position:"relative",userSelect:"none",WebkitUserSelect:"none",width:24,height:24,boxShadow:e.avatarBoxShadow,marginRight:-6},commentAuthorPlaceholderStyle:{width:20,height:20,borderRadius:20,marginRight:-3,position:"relative"},secondaryLabel:{fontSize:g().J.UISmall.desktop,whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",lineHeight:"21px",marginLeft:0,marginTop:0,color:e.text.tertiary},expandIcon:{width:g().J.UISmall.desktop,height:g().J.UISmall.desktop,fill:e.lightTextColor,marginTop:1},expandDiv:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:0},unreadStatusDot:{display:"flex",alignItems:"center",marginRight:4,marginLeft:"auto"}})),[a]),M=(0,z.jsx)("div",{style:I.secondaryLabel,children:(0,z.jsx)(p().sA,{defaultMessage:"Draft",id:"marginComments.collapsed.draft.label"})}),R=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:I.expandDiv,children:(0,fo().e)(I.expandIcon)}),v?M:(0,z.jsx)("div",{style:I.secondaryLabel,children:(0,z.jsx)(p().sA,{defaultMessage:"Expand",id:"marginComments.collapsed.expand.label"})})]}),B=v?M:y&&(0,z.jsx)(vo().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:I.lastEditedTime,children:(0,z.jsx)(xo().A,{text:(0,So().nl)(y,{useUltraCompactFormat:!0}),tooltipText:(0,So().x$)(y),icon:ho().k})});return(0,z.jsxs)("div",{style:I.discussion,onMouseEnter:h,onMouseLeave:f,onClick:x,className:me().OO1,children:[(0,z.jsx)("div",{style:I.userAvatarsContainer,children:null==C?void 0:C.map((e=>(0,z.jsx)(Ee().E,{authorStore:e,avatarSize:24,avatarStyle:I.commentAuthorAvatarStyle,placeholderStyle:I.commentAuthorPlaceholderStyle},e.id)))}),(0,z.jsx)(yo,{reactionCount:b.length,commentCount:S.length+(v?1:0)}),a?R:B,k&&(0,z.jsx)("div",{style:I.unreadStatusDot,children:(0,z.jsx)(A().m,{size:6})})]})}function yo(e){const t=(0,d().IS)((e=>({commentCount:{fontSize:14,whiteSpace:"normal",marginLeft:0,color:e.text.primary,fontWeight:g().Wy.medium,lineHeight:"18px"},textPlaceholder:{background:e.lightDividerColor,height:14,width:81,borderRadius:4,marginLeft:4}})),[]);return e.commentCount>0?(0,z.jsx)("div",{style:t.commentCount,children:(0,z.jsx)(p().sA,{defaultMessage:"{numComments, plural, one {{numComments} comment} other {{numComments} comments}}",id:"marginComments.collapsed.numComments.count",values:{numComments:e.commentCount}})}):e.reactionCount>0?(0,z.jsx)("div",{style:t.commentCount,children:(0,z.jsx)(p().sA,{defaultMessage:"{numReactions, plural, one {{numReactions} reaction} other {{numReactions} reactions}}",id:"marginComments.collapsed.numReactions.count",values:{numReactions:e.reactionCount}})}):(0,z.jsx)("div",{style:t.textPlaceholder})}var Ao=()=>o(833744),jo=()=>o(862292),wo=()=>o(441467);function ko(e){let{discussionData:{parentBlockStore:t,discussionInputStore:o},isVisible:n}=e;const s=(0,i.useRef)(null),a=(0,r().v3)(),l=(0,i.useCallback)((async()=>{const e=await jo().T.formulas.load();wo().i5({environment:a,allowActionsWhileCommenting:!0,formulasModule:e})}),[a]),u=(0,c().K8)((()=>o.isEmpty()),[o]),m=(0,i.useCallback)((()=>{E().A.setActiveWithSource("margin_comments")}),[]),p=(0,i.useCallback)((()=>{E().A.resetActiveSource("margin_comments")}),[]),g=(0,i.useCallback)((()=>{u&&go().A.reset(),E().A.resetEditorActiveSources()}),[u]),h=(0,i.useCallback)((()=>{E().A.setHoverWithSource("margin_comments")}),[]),f=(0,i.useCallback)((()=>{E().A.resetHoverSource("margin_comments")}),[]),v=(0,i.useMemo)((()=>[`.${me().MUV}`]),[]),x=(0,c().K8)((()=>E().A.state.isActivelyComposing),[]),S=(0,c().K8)((()=>E().A.state.isHovered&&!E().A.state.isActivelyComposing),[]),b=Boolean(x||u);(0,Ao().L)({active:n&&b,closeHandler:g,ref:s,excludedSelectors:v,ignoreKeydown:!0});const C=(0,d().IS)((e=>({discussion:{borderRadius:10,...x?{boxShadow:e.shadowSM}:{border:`1px solid ${e.lightDividerColor}`},width:io().JC,background:e.selectedMarginDiscussionBackground,willChange:"transform",transition:"transform 200ms ease",transform:x?"translateX(-20px)":S?"translateX(-5px)":void 0},discussionInputContainer:{borderRadius:6,padding:"8px 0px 4px 12px",backgroundColor:S?e.hoveredMarginDiscussionBackground:void 0}})),[x,S]);return(0,z.jsx)("div",{style:C.discussion,ref:s,className:me().OO1,onMouseEnter:h,onMouseLeave:f,children:(0,z.jsx)(xt().A,{parentStore:t,discussionInputStore:o,shouldSaveUnsentComments:!1,isMobileSlideUpMenu:!1,discussionFormat:D().DiscussionFormat.Margin,onSubmit:l,onCancel:g,isNewComment:!0,blockStore:t,canDrop:!0,showAvatar:!1,containerStyle:C.discussionInputContainer,showCtaButtons:!0,onFocus:m,onBlur:p})})}function Io(e){let{discussionData:{discussionStore:t,parentBlockStore:n},timeMounted:s,onClick:a,isVisible:l,isDiscussionSelected:u,isDiscussionHovered:m}=e;const p=(0,i.useRef)(null),g=(0,r().v3)(),[f,v]=(0,i.useState)((()=>new(_().A)(g,t.pointer.spaceId))),x=(0,fe().X)("block_reactions"),S=t.id,b=(0,c().K8)((()=>t.getCommentStores().length>0),[t]),C=(0,c().K8)((()=>t.getReactionStores().length>0),[t]),y=(0,i.useMemo)((()=>[`.${(0,o(451306).wV)({discussionId:S})}`,`.${me().MUV}`,`.${me().OO1}`]),[S]),A=(0,i.useCallback)((async()=>{const e=w().A.find((e=>e.isEditing()));if(e){if(!(await e.handleCancelEdit()))return}h().xl()}),[]);(0,Ao().L)({active:l&&u,closeHandler:A,ref:p,excludedSelectors:y,ignoreKeydown:!0});const j=(0,d().IS)((e=>({discussion:{border:u?void 0:`1px solid ${e.lightDividerColor}`,borderRadius:10,padding:u?"1px":void 0,background:u?e.selectedMarginDiscussionBackground:m?e.hoveredMarginDiscussionBackground:e.contentBackground,boxShadow:u?e.shadowSM:void 0,width:io().JC,cursor:u?void 0:"pointer"},wrapper:{willChange:"transform",transition:"transform 200ms ease",transform:u?"translateX(-20px)":m?"translateX(-5px)":void 0}})),[m,u]),k=(0,i.useCallback)((async e=>{var n;u||(o(878523).E9(g,{discussion_id:t.id,discussion_type:t.getType(),from:"margin_comments",parent_block_id:t.getParentId(),parent_collection_id:null===(n=t.getParentStore())||void 0===n?void 0:n.getParentCollectionIdUpToTwoLevels()}),await a(e,t))}),[a,t,u,g]);return(0,z.jsxs)("div",{className:me().OO1,ref:p,style:j.wrapper,onClick:k,children:[C&&x&&(0,z.jsx)("div",{style:{width:io().JC},children:(0,z.jsx)($e,{focused:u,parentStore:t,discussionLocation:"margin_comments"})}),b&&(0,z.jsx)("div",{style:j.discussion,children:(0,z.jsx)(Xt,{store:t,blockStore:n,format:D().DiscussionFormat.Margin,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"margin_comments",showAllRepliesAfterTimestamp:s,discussionInputStore:f,collapsed:!u})})]})}const Lo=i.memo(Io);function Mo(e){const{discussionData:t,isLastItem:o,isDiscussionSelected:n,discussionItemElementMap:s}=e,a=(0,d().IS)((()=>({discussionContainer:{transition:t.hide?void 0:"opacity 200ms ease-in-out",top:t.offsetTop,position:"absolute",paddingBottom:o?io().t_:io().kH,zIndex:n?1:void 0,opacity:t.hide?0:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",pointerEvents:"auto"}})),[t.hide,t.offsetTop,n,o]);let l;const u=t.type,m=(0,r().v3)();(0,c().K8)((()=>(0,io().$N)(m,t.parentBlockStore)),[m,t.parentBlockStore])?"existing"===u?l=(0,z.jsx)(Lo,{...e,discussionData:t}):"new"===u?l=(0,z.jsx)(ko,{...e,discussionData:t}):"grouped"===u?l=(0,z.jsx)(Co,{...e,discussionData:t}):(0,te().HB)(u):l=null;const p=(0,i.useCallback)((()=>{po().A.setState({source:"margin_comments",discussionIds:[t.id]})}),[t.id]),g=(0,i.useCallback)((()=>{po().A.setState({discussionIds:[]})}),[]),h=(0,i.useCallback)((e=>{s.set(t.id,e)}),[t.id,s]);return(0,z.jsx)("div",{style:a.discussionContainer,onMouseEnter:p,onMouseLeave:g,ref:h,children:l})}const Ro=i.memo(Mo),Bo=`.${mo().iU}, .${mo().F0}`;function Do(e){let{pageBlockStore:t,timeMounted:n,isVisible:s,animating:a,pageViewBlockAccessor:l,width:u,context:m}=e;const p=(0,r().v3)(),g=(0,i.useRef)(null),h=(0,i.useRef)(new Map),f=(0,i.useRef)(new Map),v=(0,c().K8)((()=>po().A.getFirstSelectedDiscussionId()),[]),x=(0,i.useCallback)((async(e,n)=>{(0,o(592678).Zm)()||e.target instanceof Element&&e.target.closest(Bo)||await M().DZ({discussionStore:n,currentBlockStore:t,environment:p,analyticsFrom:"margin_comments",currentEl:g.current})}),[t,p]),[S,b]=(0,i.useState)({data:[],hasNewDiscussion:!1,selectedDiscussion:void 0}),[C,y]=(0,i.useState)(!1),{WindowSizeStore:A}=p,j=o(175947).ek(p.device.isElectronMac);(0,i.useEffect)((()=>{if(!s)return;const e=new(uo().default)((()=>({selectableRectMap:o(666710).default.state.selectableRectMap,pageContentStores:t.getContentStores(),sidebarIsAnimating:o(737230).Ay.state.isAnimating,windowHeight:A.state.height})),{debugName:"effectDataStore"}),n=new(uo().default)((()=>io().Ob.state),{debugName:"discussionStoresStore"}),i=new(uo().default)((()=>{const e=go().A.state,t=go().A.getBlockStore(),n=go().A.getClosestBlockStore();if(e.open&&e.rect&&"comment"===e.content&&(t||n)&&(!t||o(489348).A.isBlockInFrame(t)&&!e.property_id))return{recomputeFocus:E().A.state.isActivelyComposing,blockStore:t??e.blockStore,discussionInputStore:e.discussionInputStore}}),{debugName:"newMarginDiscussionArgsStore"}),r=new(uo().default)((()=>{if(!E().A.state.isActivelyComposing)return k().A.getFramePageFirstSelectedDiscussionId();k().A.reset()}),{debugName:"selectedDiscussionIdStore"});let c=!1;const d=(0,ee().sg)((()=>{const{selectableRectMap:o,pageContentStores:s,sidebarIsAnimating:d,windowHeight:u}=e.state,v=n.state,x=i.state,A=r.state;if(a||d)return;const w=l();if(!(w&&g.current&&o&&o.size))return;(0,io().cY)({discussionStores:v,pageContentStores:s,marginDiscussionItemRefs:h.current,selectedDiscussionId:A,newMarginDiscussionArgs:x,marginContainerElement:g.current,pageViewBlockElement:w,onComputeComplete:(e,t)=>{c||(f.current=t,C||y(!0),b(e))},computedOnce:C,topbarHeight:j,windowHeight:u,isFullWidth:(0,yt().Ck)(t,m,p),prevSelectedDiscussionId:S.selectedDiscussion,previousDiscussionElements:f.current})}),5);return e.addListener(d),n.addListener(d),r.addListener(d),i.addListener(d),()=>{c=!0,e.removeListener(d),n.removeListener(d),r.removeListener(d),i.removeListener(d)}}),[s,a,l,C,t,S.selectedDiscussion,A,j,p,m]);const w=(0,d().IS)((()=>({marginCommentsContainer:{display:"flex",flexDirection:"column",paddingTop:8,paddingBottom:8,paddingLeft:io().JR,paddingRight:io().JR,width:u-2*io().JR,flexShrink:0,height:"100%",position:"relative",pointerEvents:"none",zIndex:1}})),[u]);return(0,z.jsx)("div",{style:w.marginCommentsContainer,ref:g,children:S.data.map(((e,t)=>(0,z.jsx)(Ro,{discussionData:e,timeMounted:n,onClick:x,isVisible:s,discussionItemElementMap:h.current,isDiscussionSelected:e.selected||"new"===e.type,isDiscussionHovered:e.id===v,isLastItem:t===S.data.length-1},`margin-discussion-${e.id}`)))})}const To=i.memo(Do);function _o(e){let{pageBlockStore:t,isVisible:o,pageViewBlockAccessor:n,context:s,isCollapsedAnchor:a}=e;const[l,u]=(0,i.useState)(!1),m=(0,r().v3)(),p=(0,i.useMemo)((()=>(new Date).getTime()),[]),g=(0,c().K8)((()=>{const e=(0,yt().Ck)(t,s,m);return a?{paddingLeft:e?96:16,height:0}:e?void 0:{position:"absolute",right:(0,io().gg)(m,(0,co().cq)(t),(0,lo().RX)(t))}}),[t,s,m,a]),h=(0,i.useCallback)((()=>{u(!0)}),[]),f=(0,i.useCallback)((()=>{u(!1)}),[]),v=(0,d().IS)((()=>({marginCommentsSection:{display:o||l?"flex":"none",flexShrink:0,pointerEvents:"none",width:o?io().Qb:0,...g}})),[o,l,g]);return(0,z.jsx)(Ae().A,{animate:{opacity:o?1:0},onAnimationStart:h,onAnimationEnd:f,style:v.marginCommentsSection,children:(0,z.jsx)(To,{pageBlockStore:t,timeMounted:p,isVisible:o,animating:l,pageViewBlockAccessor:n,width:io().Qb,context:s})})}var Eo=()=>o(297872),Po=()=>o(14235),Fo=()=>o(13679);const Uo=function(e){const{capture:t,children:n}=e,s=(0,i.useRef)(null);return(0,l().b)(o(536612).A,(()=>({getNode:()=>s.current,isCaptured:()=>t})),[t]),(0,z.jsx)("div",{ref:s,children:i.Children.only(n)})};var Ko=()=>o(691298),Wo=()=>o(377586),Oo=()=>o(574012);function Ho(e){let{blockStore:t,discussionInputStore:o,handleDismiss:n}=e;const s=(0,r().v3)(),{device:a,WindowSizeStore:l}=s,u=(0,i.useCallback)((async()=>{const e=await jo().T.formulas.load();wo().i5({environment:s,allowActionsWhileCommenting:!0,formulasModule:e})}),[s]),m=(0,c().K8)((()=>Oo().A.keyboardHeight()>0),[]),p=(0,c().K8)((()=>{const e=a.isAndroid?12:8;return{paddingLeft:l.getSafePaddingLeftCSS(12),paddingRight:l.getSafePaddingRightCSS(8),paddingBottom:m?e:l.getSafePaddingBottomCSS(e)}}),[l,m,a.isAndroid]),g=(0,d().IS)((()=>({inputWrapper:{width:a.isMobileNative?"100%":470,maxWidth:a.isMobileBrowser?"90vw":"100%",paddingTop:9,paddingLeft:p.paddingLeft,paddingRight:p.paddingRight,paddingBottom:p.paddingBottom}})),[a,p]);return(0,Ko().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,z.jsx)(Eo().A,{capture:!0,allowOpenLinkMenu:!0,render:()=>(0,z.jsx)(Fo().A,{store:t,droppable:!0,render:()=>(0,z.jsx)(Uo,{capture:!0,children:(0,z.jsx)("div",{style:g.inputWrapper,children:(0,z.jsx)(xt().A,{showAvatar:!0,parentStore:t,onCancel:n,onSubmit:u,discussionInputStore:o,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:D().DiscussionFormat.Page,blockStore:t,canDrop:!0})})})},t.id)})}const No=function(){const e=(0,r().v3)(),t=(0,r().WS)(),n=(0,c().K8)((()=>go().A.state.rect),[]),s=(0,c().K8)((()=>{if(go().A.state.open&&"comment"===go().A.state.content){const{discussionInputStore:o}=go().A.state;if((0,no().me)(e))return null;if(go().A.updateRect(),E().A.state.isActivelyComposing){"comments_pane"===E().A.state.clickEntryPoint&&E().A.setActiveWithSource("popover_comments");const n=go().A.getBlockStore();var t;if(n)return{blockStore:n,discussionInputStore:o,canMarginCommentsRender:!(null!==(t=go().A.state)&&void 0!==t&&t.property_id)&&(0,io().$N)(e,n)}}}return null}),[e]),a=(0,i.useCallback)((()=>{const t=null==s?void 0:s.discussionInputStore;t&&(0,o(36088).M)({discussionInputStore:t,environment:e})}),[e,null==s?void 0:s.discussionInputStore]),l=(0,i.useCallback)((()=>{go().A.hasContent()?E().A.resetEditorActiveSources():s&&(0,o(681634).c)(e)}),[e,s]);(0,i.useEffect)((()=>{function t(t){const n=go().A.state,i=n.open&&"comment"===n.content&&n.discussionInputStore||void 0;i&&((0,o(405981).HR)({discussionInputStore:i,environment:e,discussionHelpers:D()}),t.preventDefault())}return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[e]);const d=(0,c().K8)((()=>o(205682).A.state.isOpen),[]);return(0,c().K8)((()=>E().A.state.overlapsExistingDiscussionMenu),[])?null:(0,z.jsx)(Po().Ay,{popupType:t?Wo().n.SlideUp:Wo().n.Popup,keepFocus:!0,open:null!==s&&(!s.canMarginCommentsRender||d),originRect:n,placementToOrigin:Me().W.Bottom,alignmentToOrigin:Me().C.Center,originGap:4,onDismiss:l,render:()=>s?(0,z.jsx)(Ho,{blockStore:s.blockStore,discussionInputStore:s.discussionInputStore,handleDismiss:l}):null,onAnimationEnd:a})};var zo=()=>o(347199),Vo=()=>o(21510);const $o=function(){const e=(0,r().v3)(),{device:t}=e,{open:o,rect:n}=(0,c().K8)((()=>{const{open:e,rect:t}=Vo().A.state;return{open:e,rect:t}}),[]),i=(0,fe().X)("comment_sidebar_for_you");return(0,z.jsx)(Po().Ay,{popupType:t.isMobile?i?Wo().n.BottomSheet:Wo().n.SlideUp:Wo().n.Popup,bottomSheetInitialState:"half",open:o,originRect:n,placementToOrigin:Me().W.Bottom,alignmentToOrigin:Me().C.Center,originGap:4,onDismiss:()=>R().oU(e),render:()=>(0,z.jsx)(Yo,{})})};function Yo(){const e=(0,r().v3)(),{device:t}=e,o=(0,c().O$)(Vo().A),n=(0,c().K8)((()=>Vo().A.state.open?Vo().A.state.discussionInputStore.state.textStore.getValue():null),[]);if((0,i.useEffect)((()=>{var e;const t=null===(e=zo().A.MenuScroller)||void 0===e?void 0:e.getNode();null==t||t.scrollTo({top:t.scrollHeight})}),[n,o]),o.open){const{discussionStore:n,discussionInputStore:i,blockStore:s,discussionLocation:r}=o;let a;return a=t.isMobile?{menuType:pe().gu.Modal,title:(0,z.jsx)(p().sA,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:(0,z.jsx)(p().sA,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>R().oU(e),whiteBackground:!0}:{menuType:pe().gu.Popup,width:420,minHeight:"100px",maxHeight:"50vh",maxWidth:"100%"},(0,z.jsx)(re().A,{className:me()._qG,...a,children:(0,z.jsx)(Eo().A,{capture:!0,allowMobileAutoScroll:!0,render:()=>"post_top_level_discussion"!==r?(0,z.jsx)(Xt,{store:n,discussionInputStore:i,onDismiss:()=>R().oU(e),format:D().DiscussionFormat.Menu,isFirst:!0,isOnly:!0,discussionLocation:r,showResolveButtonByDefaultIfPossible:!0,blockStore:s,collapsed:!1}):null})})}return null}var Jo=()=>o(165492)},499512:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(401497),i=()=>o(126158),s=()=>o(959013),r=()=>o(859428),a=o(474848);function l(e){const{onClick:t}=e,o=(0,n().IS)((e=>({moreCommentsWrapper:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"flex-start",zIndex:1,left:0,right:0,height:30,background:`linear-gradient(to bottom, ${e.contentBackgroundTransparent} 0px, ${e.selectedMarginDiscussionBackground} 30px`,marginTop:-28},tooltip:{...(0,r().n)(e,!1),cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",marginTop:-4,borderRadius:6,padding:"4px 10px 4px 8px"}})),[]),l=(0,n().DP)();return(0,a.jsx)("div",{style:o.moreCommentsWrapper,children:(0,a.jsxs)("div",{style:o.tooltip,onClick:t,children:[(0,a.jsx)("div",{style:{marginRight:5},children:(0,i().m)({fill:l.text.contrastPrimary,height:12,width:12})}),(0,a.jsx)(s().sA,{defaultMessage:"See more",id:"discussion.moreMessageTooltip"})]})})}},518598:(e,t,o)=>{o.d(t,{K:()=>d});o(296540);var n=()=>o(426388),i=()=>o(959013),s=()=>o(705540),r=()=>o(285790),a=()=>o(745766),l=o(474848);const c=(0,i().YK)({menu:{defaultMessage:"Menu",id:"topbar.appMenuButton.title"}});function d(){const e=(0,i().tz)();return(0,l.jsx)(r().A,{style:{position:"absolute",top:"10px",left:"14px",width:24,height:24,zIndex:1e5,...(0,a().g)({noDrag:!0})},iconStyle:{width:16,height:16},isDarkIconColor:!0,onClick:()=>{s().openAppMenu()},icon:n().S,ariaLabel:e.formatMessage(c.menu)})}},536612:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(959180))().A{}const i=new n},541235:(e,t,o)=>{o.d(t,{YD:()=>s,c$:()=>n,q_:()=>i});const n={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]}},i="completed",s="dismissed"},555267:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),i=()=>o(401497),s=()=>o(62856),r=()=>o(331542),a=o(474848);function l(e){let{loadingMessage:t}=e;const o=(0,i().DP)(),l=(0,s().A)(!0,400);return(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:l&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(r().A,{}),t&&(0,a.jsx)("div",{style:{marginLeft:8,color:o.text.secondary},children:t})]})})}},567121:(e,t,o)=>{o.d(t,{EG:()=>r,K5:()=>s,RH:()=>i,Yi:()=>a,ls:()=>n});const n=32,i=202,s=1e3,r="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",a="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},578194:(e,t,o)=>{o.d(t,{r:()=>n});const n=(0,o(583835).Dv)("importEvernote")},608581:(e,t,o)=>{o.d(t,{A:()=>d});o(898992),o(354520),o(581454),o(941795);var n=o(296540),i=()=>o(401497),s=()=>o(451306),r=()=>o(284371),a=()=>o(963575),l=o(474848);function c(e){const{button:t,isLast:o}=e,a=(0,i().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return n.cloneElement(t,{...(0,s().AH)(t.props.style,a.button,o&&a.buttonLast),hoveredStyle:(0,s().AH)(a.buttonHovered,o&&a.buttonLast).style,pressedStyle:a.buttonPressed})}const d=function(e){let{children:t,isVisible:d,position:u,style:m}=e;const p=(0,o(484714).v3)(),g=(0,i().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:a().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:p.device.isMobile?"auto":"none",opacity:p.device.isMobile?1:0,fontFamily:r().vc(o(662303).locale).sans,position:"absolute",right:a().A.horizontal.small,bottom:a().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:a().A.vertical.small,bottom:void 0}})),[p]),h=n.Children.toArray(t).filter(o(534177).O9),f=h.length;return(0,l.jsx)(o(145214).A,{animate:{opacity:d?1:0},...(0,s().AH)(g.container,m,d&&g.containerHover,"top"===u&&g.containerTop),children:h.map(((e,t)=>{const i=t===f-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(859428).A&&n.isValidElement(e))return n.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,l.jsx)(c,{isLast:i,button:n},e.key)}});if(e.type===o(704152).A&&n.isValidElement(e))return(0,l.jsx)(c,{isLast:i,button:e},e.key)}}))})}},659799:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(401497),i=()=>o(284371),s=()=>o(962730),r=()=>o(859428),a=o(474848);function l(e){let{text:t,tooltipText:o,icon:l}=e;const c=(0,n().IS)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.shadowSM},container:{display:"flex",alignItems:"center",fontWeight:i().Wy.regular,color:e.mediumTextColor,fontSize:i().J.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,a.jsx)(r().A,{style:c.tooltip,render:e=>(0,a.jsx)("div",{style:c.text,...e,children:t}),renderTooltip:()=>(0,a.jsxs)("div",{style:c.container,children:[l(c.icon),(0,a.jsx)("div",{children:o})]}),alignment:s().C.Start,placement:s().W.Bottom})}},683097:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(296540),i=()=>o(484714);function s(e){const t=(0,i().v3)(),{onLongPress:o,hapticsEnabled:s=!0,timeout:r=300}=e,a=(0,n.useCallback)((()=>{var e,n,i;s&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(n=(i=window.navigator).vibrate)||void 0===n||n.call(i,20));o()}),[t.mobileNative,s,o]),l=(0,n.useRef)(),c=(0,n.useRef)(0),d=(0,n.useRef)(0),u=(0,n.useCallback)((()=>clearTimeout(l.current)),[]);(0,n.useEffect)((()=>u),[u]);return{onTouchStart:(0,n.useCallback)((()=>{clearTimeout(l.current),l.current=setTimeout(a,r)}),[r,a]),onTouchMove:(0,n.useCallback)((e=>{const t=e.touches[0].clientX,o=e.touches[0].clientY;(Math.abs(t-c.current)>50||Math.abs(o-d.current)>50)&&clearTimeout(l.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},739135:(e,t,o)=>{o.d(t,{KD:()=>c,gt:()=>d,i9:()=>l,ll:()=>r,tb:()=>a,x$:()=>s});var n=()=>o(541235),i=()=>o(496603);function s(e,t){return r(d(e,t))}function r(e){return void 0!==e&&(e===n().q_||e===n().YD)}function a(e,t){if(r(t))return;const o=n().c$[e],i=o.steps.findIndex((e=>e.id===t));return-1===i?o.steps[0].id:i===o.steps.length-1?n().q_:o.steps[i+1].id}function l(e,t){const o=d(e,t);if(o&&!r(o))return a(t,o)}function c(e,t){const o=d(e,t);if(o)return function(e,t){const o=n().c$[e];var s;if(r(t))return null===(s=(0,i().HV)(o.steps))||void 0===s?void 0:s.id;const a=o.steps.findIndex((e=>e.id===t));return-1!==a&&0!==a?o.steps[a-1].id:void 0}(t,o)}function d(e,t){var o;if(!e)return;const i=((null===(o=e.getSettings())||void 0===o?void 0:o.tutorials)||{})[t];return void 0===i?n().c$[t].steps[0].id:i}},756114:(e,t,o)=>{o.d(t,{D:()=>n});function n(e,t){t.route.name;return!1}},765974:(e,t,o)=>{o.d(t,{b:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M11.84 3.563c-.817-1.417-2.862-1.417-3.68 0L2.314 13.688c-.818 1.416.205 3.187 1.84 3.187h11.692c1.636 0 2.658-1.77 1.84-3.187zM9.876 6.75c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5"})},i=(0,o(340498).wt)("exclamationMarkTriangleFill",n)},801678:(e,t,o)=>{o.d(t,{A:()=>f});var n=o(296540),i=()=>o(662303),s=()=>o(484714),r=()=>o(56366),a=()=>o(451306),l=()=>o(959013),c=()=>o(100622),d=()=>o(496603),u=()=>o(284371),m=()=>o(720665),p=()=>o(145214),g=o(474848);const h={isRepositioning:!1};const f=function(e){const t=(0,n.useRef)(null),i=(0,s().v3)(),{isMobile:l}=(0,s().Y0)(),[c,u]=(0,n.useState)(h),p=(0,n.useCallback)((()=>{u(h)}),[]),{renderControl:f,onFlushTemporaryPosition:x,style:S,source:b,store:C}=e,{isRepositioning:y,image:A,startDragRenderedPosition:j,startDragImageScreenHeight:w}=c,k=(0,r().K8)((()=>0===o(502438).default.state.stores.length),[]),[I,L]=(0,n.useState)(!1),M=(0,r().uB)(e.mouseStore,o(454305).A),R=(0,r().K8)((()=>M.state.mouseEntered),[M]),B=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:y?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[y]),D=(0,r().K8)((()=>function(e,t,o){return(0,d().Et)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,d().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,m().pN)(t)?o:t}}const n=t.getFormat(),i=n.page_cover_position;if((0,d().Et)(i))return i;return o}(e,t)}(b,C,c.temporaryPosition)),[c.temporaryPosition,b,C]);(0,n.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&y&&x({imagePosition:D,reset:()=>{M.reset(),p()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[D,y,M,x,p]),y&&!k&&p();const T=(0,n.useMemo)((()=>(0,d().nF)((e=>{M.setState({...M.state,mouseEntered:!0})}),100)),[M]),_=(0,n.useMemo)((()=>(0,d().sg)((e=>{M.setState({...M.state,mouseEntered:!1})}),100)),[M]),E=(0,n.useCallback)(((e,t)=>{o(778417).IU({environment:i});const n=new Image;n.onload=()=>{u((e=>({...e,isRepositioning:!0,image:n})))},t&&(n.src=t)}),[i]),P=(0,n.useCallback)((e=>{x({imagePosition:D,reset:()=>{p()}})}),[D,x,p]),F=(0,n.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&L(!0)}),[]),U=(0,n.useCallback)((()=>{L(!0)}),[]),K=(0,n.useCallback)((e=>{if(A&&y){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/A.width*A.height;u((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:D})))}}}),[A,D,y]),W=(0,n.useCallback)((e=>{if(y){const t=e.diffY/(w||0)+(j||0);u((e=>({...e,temporaryPosition:(0,d().LI)((0,o(40845).A)(t,0,1),4)})))}}),[y,w,j]),O=(0,n.useCallback)((()=>{u((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),H=(0,r().K8)((()=>f({handleRepositionClick:E,handleSavePositionClick:P,handleCancelClick:p,isVisible:l||R||I||y,isRepositioning:y})),[E,P,I,l,y,R,f,p]);return(0,g.jsxs)("div",{ref:t,onFocus:F,onBlur:U,onMouseEnter:T,onMouseMove:T,onMouseLeave:_,...(0,a().AH)(B.container,S),children:[(0,g.jsx)(o(603820).A,{onDraggableDragStart:K,onDraggableDragMove:W,onDraggableDragEnd:O,onDraggableDragCancel:O,disabled:!y,render:t=>(0,g.jsx)("div",{...(0,a().AH)(B.dragContainer),...t,children:e.render({imagePosition:D,isRepositioning:y})})}),(0,g.jsx)(v,{small:e.small,isRepositioning:y}),H]})};function v(e){let{small:t,isRepositioning:o}=e;if(t)return null;const n={background:c().Ay.blackWithAlpha(.4),borderRadius:4,color:c().Ay.white,fontSize:12,fontFamily:u().vc(i().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,g.jsx)(p().A,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:n,children:(0,g.jsx)(l().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},893627:(e,t,o)=>{o.d(t,{K:()=>r});var n=o.n(o(440537)),i=()=>o(132456),s=()=>o(206267);class r{constructor(e){this.environmentName=void 0,this.mainShortId=void 0,this.getSettings=void 0,this.isServerOriginated=void 0,this.mapSpaceIdToShortId=void 0,this.idCreatorLogger=void 0,this.environmentName=e.environmentName,this.mainShortId=o(851941).Yf[this.environmentName],this.getSettings=e.getSettings,this.isServerOriginated=e.isServerOriginated,this.mapSpaceIdToShortId=e.mapSpaceIdToShortId,this.idCreatorLogger=e.idCreatorLogger??(()=>{})}idInMain(e){const{enableTestDateOffset:t,enableIdSchema:n}=this.getSettings();return n&&e!==o(867178).wI?(this.idCreatorLogger(void 0,e,t?"id_schema_test":"id_schema"),(0,i().J4)(t,this.mainShortId,e,this.isServerOriginated)):this.legacyId(e,"disabled")}pointerInMain(e){return{table:e,id:this.idInMain(e)}}async idWithSpaceId(e,t){const{enableTestDateOffset:o,enableIdSchema:s}=this.getSettings();if(!s||"space"===t)return this.legacyId(t,"disabled");const r=this.mapSpaceIdToShortId(e),a=n().types.isPromise(r)?await r:r;return a?(this.idCreatorLogger(e,t,o?"id_schema_test":"id_schema"),(0,i().kw)(o,a,t,this.isServerOriginated)):this.legacyId(t,"missing_short_id")}async pointerWithSpaceId(e,t){return{table:t,spaceId:e,id:await this.idWithSpaceId(e,t)}}idWithSpaceShortId(e,t){const{enableTestDateOffset:o,enableIdSchema:n}=this.getSettings();return n&&"space"!==t?(this.idCreatorLogger(void 0,t,o?"id_schema_test":"id_schema"),(0,i().kw)(o,e,t,this.isServerOriginated)):this.legacyId(t,"disabled")}legacyId(e,t){return this.idCreatorLogger(void 0,e,t),s().JW()}async deterministicIdWithSpaceId(e,t,o){const{enableTestDateOffset:r,enableIdSchema:a}=this.getSettings();if(!a)return this.idCreatorLogger(e,t,"disabled"),s().gB(o);const l=this.mapSpaceIdToShortId(e),c=n().types.isPromise(l)?await l:l;return c?(this.idCreatorLogger(e,t,r?"id_schema_test":"id_schema"),(0,i().lf)(c,t,o)):(this.idCreatorLogger(e,t,"missing_short_id"),s().gB(o))}deterministicIdWithSpaceShortId(e,t,o){const{enableTestDateOffset:n,enableIdSchema:r}=this.getSettings();return r?(this.idCreatorLogger(void 0,t,n?"id_schema_test":"id_schema"),(0,i().lf)(e,t,o)):(this.idCreatorLogger(void 0,t,"disabled"),s().gB(o))}async getSpaceIdCreator(e){if(!e)return new a(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new a(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),i=n().types.isPromise(o)?await o:o;return this.getSpaceShortIdCreator(e,i)}getSpaceIdCreatorSync(e){if(!e)return new a(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new a(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),i=n().types.isPromise(o)?void 0:o;return this.getSpaceShortIdCreator(e,i)}getSpaceShortIdCreator(e,t){const{enableIdSchema:o}=this.getSettings();return o&&t?new l(e,this,t):new a(e,this.idCreatorLogger)}async getSpaceIdCreatorFromModel(e){return e.getShortIdStr()?this.getSpaceShortIdCreator(e.id,Number(e.getShortIdStr())):await this.getSpaceIdCreator(e.id)}}class a{constructor(e,t){this.spaceId=void 0,this.idCreatorLogger=void 0,this.spaceId=e,this.idCreatorLogger=t}idInSavedSpace(e){return this.idCreatorLogger(void 0,e,"disabled"),s().JW()}idInMain(e){return this.idCreatorLogger(void 0,e,"disabled"),s().JW()}deterministicIdInSavedSpace(e,t){return this.idCreatorLogger(void 0,e,"disabled"),s().gB(t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}class l{constructor(e,t,o){this.spaceId=void 0,this.idCreator=void 0,this.spaceShortId=void 0,this.spaceId=e,this.idCreator=t,this.spaceShortId=o}idInSavedSpace(e){return this.idCreator.idWithSpaceShortId(this.spaceShortId,e)}idInMain(e){return this.idCreator.idInMain(e)}deterministicIdInSavedSpace(e,t){return this.idCreator.deterministicIdWithSpaceShortId(this.spaceShortId,e,t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}},920713:(e,t,o)=>{o.d(t,{B:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("codeFile",{viewBox:"0 0 23 24",svg:(0,n.jsx)("path",{d:"M4.195 11.86c0-.266.078-.488.235-.665.156-.182.38-.3.672-.351.494-.089.849-.271 1.062-.547.214-.281.32-.73.32-1.344V6.961c0-1.115.263-1.938.79-2.469.525-.536 1.333-.804 2.421-.804.203 0 .375.023.516.07.177.057.31.146.398.265a.646.646 0 01.141.422c0 .339-.148.558-.445.657a1.14 1.14 0 01-.157.039l-.171.015c-.625.047-1.066.222-1.32.524-.256.302-.384.8-.384 1.492v2.414c0 .672-.182 1.198-.546 1.578-.36.38-.86.604-1.5.672-.032 0-.047.013-.047.039.005.02.02.034.047.04.64.062 1.14.283 1.5.663.364.38.546.906.546 1.578v2.414c0 .693.128 1.19.383 1.492.255.303.696.48 1.32.532.053 0 .1.002.141.008l.133.03c.333.09.5.308.5.657a.68.68 0 01-.14.43.816.816 0 01-.407.273 1.48 1.48 0 01-.437.063c-1.12 0-1.948-.266-2.485-.797-.531-.526-.797-1.352-.797-2.477V14.79c0-.614-.106-1.062-.32-1.344-.213-.28-.568-.463-1.062-.547-.292-.062-.516-.182-.672-.359-.157-.177-.235-.404-.235-.68zm15.602 0c0 .275-.078.502-.235.68-.156.176-.382.296-.68.358-.5.084-.856.266-1.07.547-.208.282-.312.73-.312 1.344v1.992c0 1.125-.266 1.95-.797 2.477-.531.531-1.36.797-2.484.797-.151 0-.297-.021-.438-.063a.757.757 0 01-.414-.265.715.715 0 01-.133-.438c0-.182.042-.328.125-.437a.674.674 0 01.383-.22l.117-.03c.047-.006.097-.008.149-.008.625-.052 1.065-.23 1.32-.532.255-.302.383-.799.383-1.492v-2.414c0-.672.182-1.208.547-1.61.364-.405.864-.616 1.5-.632.026-.005.039-.018.039-.039 0-.026-.013-.04-.04-.04-.635-.015-1.135-.226-1.5-.632-.364-.406-.546-.945-.546-1.617V7.172c0-.693-.128-1.193-.383-1.5-.255-.307-.695-.48-1.32-.516l-.18-.015a1.233 1.233 0 01-.148-.04c-.297-.109-.446-.328-.446-.656 0-.166.045-.307.133-.422a.777.777 0 01.414-.265c.14-.047.31-.07.508-.07 1.089 0 1.896.268 2.422.804.526.531.789 1.354.789 2.469v1.992c0 .615.107 1.06.32 1.336.214.276.568.461 1.063.555.297.052.523.169.68.351a.967.967 0 01.234.664z"})})},943647:(e,t,o)=>{o.d(t,{A:()=>x});var n=o(296540),i=()=>o(484714),s=()=>o(56366),r=()=>o(959013),a=()=>o(896628),l=()=>o(454531),c=()=>o(317909),d=()=>o(478726),u=()=>o(867772),m=()=>o(681810),p=()=>o(608581),g=()=>o(145214),h=()=>o(704152),f=()=>o(24611),v=o(474848);const x=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:d,height:p,proxyWidth:g}=e;const h=(0,i().v3)(),f=(0,s().uB)(void 0,o(454305).A),x=(0,s().K8)((()=>r||"suggest"===o(77246).Uv.getMode(t)),[r,t]),C=(0,s().K8)((()=>t.getCover()),[t]),y=(0,s().O$)(m().A),[A,j]=(0,n.useState)(void 0);if(!C)return null;const w=y.loadingMode!==u().pF&&y.loadingMode!==u().Wc;return(0,v.jsx)(o(801678).A,{mouseStore:f,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:n,reset:i}=e;c().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{a().yY({store:t,coverPosition:n,transaction:e}),i()}})}(e,t,h),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:i,isVisible:s,isRepositioning:r}=e;return(0,v.jsx)(b,{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:i,isVisible:s,isRepositioning:r,lastProxiedUrl:A,store:t,disabled:x,paddingRight:l,paddingLeft:d,mouseStore:f})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:p,maxHeight:280,cursor:"default"},render:e=>(0,v.jsxs)(n.Fragment,{children:[(0,v.jsx)(o(360083).A,{url:C.cover,isAuthenticated:!0,permissionRecord:C.pointer,width:g,onFinishedLoadingProxyUrl:j,render:(t,n)=>{const i={width:"100%",height:p,maxHeight:280,objectFit:"cover",opacity:w?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:p,maxHeight:280};return(0,v.jsx)(o(307440).E,{src:n,placeholderSrc:w?y.dataURL:void 0,placeholderBehavior:w?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:i,onLoadComplete:S,testId:"pageCover"})}}),w&&(0,v.jsxs)("div",{style:o(816559).fd,children:[(0,v.jsx)(o(331542).A,{size:"md",style:{marginRight:4}}),(0,v.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,v.jsx)(o(773382).A,{percentage:y.uploadProgress})})]})]})})};function S(){m().A.reset()}function b(e){let{isVisible:t,isRepositioning:o,handleCancelClick:a,handleRepositionClick:c,handleSavePositionClick:x,lastProxiedUrl:S,store:b,disabled:C,paddingRight:y,paddingLeft:A,mouseStore:j}=e;const w=(0,i().v3)(),k=(0,r().tz)(),I=(0,n.useCallback)((e=>function(e,t,o,n,i){i.reset();const s=e.target.getBoundingClientRect();l().W({environment:t,intl:o,store:n,rect:s})}(e,w,k,b,j)),[w,k,b,j]),L=(0,s().K8)((()=>m().A.state.loadingMode),[]),M=(0,s().K8)((()=>function(e){let t;return t=e.isFullWidth()?"100%":d().x6,t}(b)),[b]);if(C||L!==u().pF)return null;const{device:R}=w,{isMobile:B}=R;return(0,v.jsx)(g().A,{animate:{width:M,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,v.jsxs)(p().A,{isVisible:t,position:"bottom",style:{marginRight:y,marginLeft:A},children:[!o&&(0,v.jsx)(h().A,{style:{borderRight:B?"none":void 0,...f().k},onClick:I,children:(0,v.jsx)(r().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!B&&(0,v.jsx)(h().A,{style:{...f().k,borderRight:"none"},onClick:e=>c(e,S),children:(0,v.jsx)(r().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!B&&(0,v.jsx)(h().A,{style:f().k,onClick:x,children:(0,v.jsx)(r().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!B&&(0,v.jsx)(h().A,{style:{...f().k,borderRight:"none"},onClick:a,children:(0,v.jsx)(r().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}}}]);