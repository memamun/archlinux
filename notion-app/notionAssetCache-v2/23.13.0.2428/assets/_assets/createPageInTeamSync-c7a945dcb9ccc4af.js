"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[4876,5834,63137],{375078:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>T,transformBlocks:()=>y,transformIntoColumnList:()=>C});n(581454);var o=()=>n(908006),r=()=>n(700500),a=()=>n(179034),i=()=>n(496603),c=()=>n(722101),s=()=>n(44729),l=()=>n(863168),d=()=>n(246826),m=()=>n(797265),p=()=>n(778417),S=()=>n(725614),v=()=>n(317909),f=()=>n(62287),u=()=>n(87017),g=()=>n(594794),I=()=>n(299545),b=()=>n(508496),h=()=>n(630116),k=()=>n(65269);function y(e){const{environment:t,blocks:n,blockType:k,transaction:y}=e;if(k!==r().xd.transclusionContainer)if(k===r().xd.callout&&b().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const c=i.getRecordStoreUIParent();if(!c||!(0,I().iU)(c))return;const m=c.getRecordStoreUIParent();if(!(m&&m instanceof h().Bv))return;const v=(0,g().Z1)({environment:t,table:a().ev,spaceId:m.getSpaceId()}),f=d().Wv({environment:t,id:v,type:r().xd.callout,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:m.getSpaceId(),format:{callout_version:2}});s().NI({parentStore:c,childStore:f,after:i.id,transaction:o});w({newParentStore:f.getContentStore(),blocks:n,transaction:o}),l().s4({store:f,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:y});else if(k!==r().xd.columnList)if(k!==r().xd.slide)if((0,r().ZK)(k)){const e=parseInt(k.replace("column","").replace("block","")),r=i().oE(i().Hn(e-1,(()=>u().insertTextBelow({environment:t,blocks:n,transaction:y})))),a=[...n,...r],c=C({environment:t,blocks:a,transaction:y});o().default.afterNextFlush((()=>{S().setSelectionAtStart({store:c[0].getBlockTitleStore()})}))}else for(const r of n)if(r.isCalloutV2()){const e=r.getParentBlockStore();if(e){const a=r.getContentStores();v().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:a.map((e=>e.id)),after:r.id}},transaction:y}),s().zz({parentStore:e.getContentStore(),childStore:r,transaction:y});for(const e of a)f().pd({environment:t,block:e,blockType:k,transaction:y,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{m().dL(t,a.map((e=>e.id)))}))}}else f().pd({environment:t,block:r,blockType:k,transaction:y,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const c=i.getRecordStoreUIParent();if(!c||!(0,I().iU)(c))return;const l=c.getRecordStoreUIParent();if(!(l&&l instanceof h().Bv))return;const m=(0,g().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.slide,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});s().NI({parentStore:c,childStore:v,after:i.id,transaction:o});w({newParentStore:v.getContentStore(),blocks:n,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:y});else C({environment:t,blocks:n,transaction:y});else!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const s=i.getRecordStoreUIParent();if(!s||!(0,I().iU)(s))return;const l=s.getRecordStoreUIParent();if(!l||!(0,I()._p)(l))return;if(!l.isDefined())return;const m=(0,g().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.transclusionContainer,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});c().WH({parentStore:s,insertStore:v,afterStore:i,transaction:o});w({newParentStore:v.getContentStore(),blocks:n,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:y})}function T(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&y({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}function C(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return[];const s=i.recordStoreUIParentStore;if(null==s||!s.valueIs(k()._))return[];const l=(0,g().Z1)({environment:t,table:a().ev,spaceId:i.getSpaceId()}),m=d().Wv({environment:t,id:l,type:r().xd.columnList,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId()}),{childStore:p}=c().nc({parentStore:s,insertStore:m,beforeStore:i,transaction:o});return n.map((e=>{const n=(0,g().Z1)({environment:t,table:a().ev,spaceId:i.getSpaceId()}),l=d().Wv({environment:t,id:n,type:r().xd.column,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId()}),{childStore:m}=c().TF({parentStore:s,childToRemoveStore:e,transaction:o}),{childStore:S}=c().WH({parentStore:p.getContentStore(),insertStore:l,transaction:o}),{childStore:v}=c().WH({parentStore:S.getContentStore(),insertStore:m,transaction:o});return v}))}function w(e){const{newParentStore:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(k()._)&&(c().TF({parentStore:e,childToRemoveStore:r,transaction:o}),c().BC({parentStore:t,appendStore:r,transaction:o}))}}},375215:(e,t,n)=>{n.r(t),n.d(t,{createPageInTeamSyncImpl:()=>d});n(16280);var o=()=>n(854150),r=()=>n(970330),a=()=>n(579627),i=()=>n(185544),c=()=>n(776894),s=()=>n(396301),l=()=>n(450486);function d(e){const{environment:t,spaceStore:n,spaceViewStore:d,teamStore:m,from:p,title:S,loading:v,appendOrPrepend:f,transaction:u}=e;if(!(0,s().dp)({teamStore:m,environment:t}))throw new Error("User is not eligible to create top-level page in team");const g=i().IT({environment:t,spaceStore:n,spaceViewStore:d,isPrivate:!1,prepend:!1,title:S,loading:v,transaction:u});r().X(t,{teamStore:m,from:p,pageId:g.id,transaction:u}),a().wy({store:g,transaction:u});const I=(0,c().sZ)({type:"team",id:m.id});if(I.table!==o().yK)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return(0,l().moveToTeamImpl)({environment:t,transaction:u,action:"add",teamStore:I,currentSpaceViewStore:d,targets:[g],value:{type:"team",id:m.id},location:{type:f}}),g}},450486:(e,t,n)=>{n.r(t),n.d(t,{moveToTeamImpl:()=>s});var o=()=>n(496603),r=()=>n(534177),a=()=>n(44729),i=()=>n(955930),c=()=>n(375078);function s(e){let{transaction:t,currentSpaceViewStore:n,teamStore:s,targets:l,location:d,environment:m}=e;const p=n.getTeamsStores(),S=s.getTeamPagesStore();c().maybeTurnCollectionViewIntoCollectionViewPage({environment:m,blocks:l,transaction:t});for(const c of l){const e=o().I6(p,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(c.id)}));(null==e?void 0:e.id)!==s.id&&("append"===d.type?a().NI({parentStore:S,childStore:c,after:d.after,transaction:t}):"prepend"===d.type?a().Ti({parentStore:S,childStore:c,before:d.before,transaction:t}):(0,r().HB)(d),e&&i().Ex({teamStore:e,store:c,transaction:t}))}return s}}}]);