"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67032],{369:(e,t,s)=>{s.d(t,{R:()=>o});s(296540);var r=s(474848);const o=(0,s(340498).wt)("eyeHide",{viewBox:"0 0 16 12",svg:(0,r.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},140612:(e,t,s)=>{s.d(t,{w:()=>o});var r=()=>s(989423);function o(e,t){const{spaceId:s,pageId:o,joinSpaceMethod:a}=t;(0,r().u4)({environment:e,event:{eventName:"trusted_domain_banner_cta_clicked",eventProperties:{spaceId:s,pageId:o,joinSpaceMethod:a}}})}},167032:(e,t,s)=>{s.d(t,{A:()=>c});s(296540);var r=()=>s(498212),o=()=>s(322114),a=s(474848);const c=function(e){let{targetStore:t,title:c,description:n,hasBorder:i=!1,buttonType:l="outline"}=e;const u=(0,s(56366).K8)((()=>t&&t.getSpaceId()),[t]),d=(0,s(401497).IS)((e=>({requestAccessContainer:{boxShadow:i?e.shadow2XS:void 0,borderRadius:4,padding:32}})),[i]);return(0,a.jsx)("div",{style:d.requestAccessContainer,children:(0,a.jsx)(s(299797).A,{icon:s(369).R,title:c,description:n,cta:t instanceof s(630116).md?(0,a.jsx)(o().A,{flowId:(0,r().Ay)(),type:"current-actor-to-collection",collection:{spaceId:u,id:t.id},buttonType:l}):(0,a.jsx)(o().A,{flowId:(0,r().Ay)(),type:"current-actor-to-block",block:{spaceId:u,id:t.id},buttonType:l})})})}},322114:(e,t,s)=>{s.d(t,{A:()=>B});var r=s(296540),o=()=>s(484714),a=()=>s(56366),c=()=>s(757695),n=()=>s(959013),i=()=>s(100622),l=()=>s(534177),u=()=>s(284371),d=()=>s(452939),p=()=>s(701763),m=()=>s(140612),g=()=>s(449506),f=()=>s(898486),y=()=>s(722872),b=()=>s(351360),v=()=>s(10984),A=()=>s(251126),_=()=>s(805751),q=()=>s(623580),x=()=>s(928600),h=()=>s(864943),I=()=>s(204063),C=s(474848);const k={marginBottom:10},j={...k,width:"100%",height:"100%",padding:10,alignItems:"top",borderRadius:0},S=(0,n().YK)({requestAccessMessagePlaceholder:{defaultMessage:"Message (optional)",id:"requestAccessForm.messageInput.placeholder"},rateLimitError:{defaultMessage:"You have recently requested access to this page.",id:"requestAccessForm.errorMessage.rateLimit"},currentUserNotFound:{defaultMessage:"Current user not found.",id:"requestAccessForm.errorMessage.currentUserNotFound"}});function w(){return(0,C.jsx)(n().sA,{defaultMessage:"Cancel",id:"requestAccessForm.cancelButton.label"})}const M=c().default.createClass(0,{name:"RequestAttemptStore"}),T=c().default.createClass(void 0,{name:"MessageStore"});const B=function(e){const t=(0,o().v3)(),c=(0,o().WS)(),i=(0,a().uB)(e.popupStore,s(463830).A),l=(0,a().uB)(void 0,T),p=(0,a().uB)(void 0,M),g=(0,r.useCallback)((()=>L(i)),[i]),f=(0,r.useCallback)((()=>(0,C.jsx)(P,{...e,requestAttemptStore:p,messageStore:l,buttonPopupStore:i})),[e,p,l,i]),y=(0,a().K8)((()=>p.state>0),[p]),b=(0,a().K8)((()=>i.state.open),[i]);if("current-actor-to-block"===e.type)return(0,C.jsx)(U,{type:"page",block:e.block,flowId:e.flowId,buttonType:e.buttonType});if("current-actor-to-collection"===e.type)return(0,C.jsx)(U,{type:"collection",collection:e.collection,flowId:e.flowId,buttonType:e.buttonType});const v="primary"===e.buttonType?I().A:h().A,A=c?(0,C.jsx)(s(14235).Ay,{popupType:s(377586).n.SlideUp,open:b,render:f}):(0,C.jsx)(s(957986).A,{open:b,onDismiss:g,render:f});return"current-actor-to-space-via-onboarding"===e.type?A:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(v,{size:"lg",disabled:y,onClick:()=>{var s,r;return function(e,t){const{environment:s,flowId:r,type:o,source:a,spaceId:c,pageId:n}=e;"trusted_domain_page"===a&&c&&m().w(s,{spaceId:c,pageId:n,joinSpaceMethod:"request_to_join"});"current-actor-to-block"===o?d().Xx(s,{button_name:"request-access",flow_id:r,request_access_type:"page"}):"current-actor-to-space-via-team"===o&&d().Xx(s,{button_name:"request-access",flow_id:r,request_access_type:"team"});t.setState({open:!0})}({environment:t,flowId:e.flowId,type:e.type,source:e.source,pageId:null===(s=e.block)||void 0===s?void 0:s.id,spaceId:null===(r=e.block)||void 0===r?void 0:r.spaceId},i)},style:"outline"===e.buttonType?{fontWeight:u().Wy.semibold}:{},children:y?(0,C.jsx)(n().sA,{id:"fullPageError.requestAccessButton.requested",defaultMessage:"Requested access"}):K(e.type)}),A]})};function R(e){let{result:t}=e;return t&&t.error?(0,C.jsx)("div",{style:{color:i().Ay.redWithAlpha(1),textAlign:"center",width:"100%",marginBottom:16},children:t.error}):null}function F(e){e.update((e=>e+1))}function L(e){return e.setState({open:!1})}function N(e){let{error:t,result:s,ready:c,requestAttemptStore:i,messageStore:l,type:d}=e;const p=(0,n().tz)(),m=(0,o().WS)(),g=(0,r.useCallback)((()=>F(i)),[i]),f=(0,r.useCallback)((e=>function(e,t){t.setState(e.target.value)}(e,l)),[l]),y=(0,a().K8)((()=>Boolean(0===i.state||c&&s&&s.error)),[i,c,s]),b=(0,a().K8)((()=>l.state||""),[l]);return(0,C.jsxs)(C.Fragment,{children:[!m&&(0,C.jsx)("div",{style:{fontSize:16,fontWeight:u().Wy.semibold,marginBottom:16},children:K(d)}),(0,C.jsx)(q().A,{format:m?q().C.Transparent:void 0,textarea:!0,value:b,onChange:f,disabled:!y,placeholder:p.formatMessage(S.requestAccessMessagePlaceholder),style:{...m?{...j,padding:"16px"}:{...k,marginBottom:16,padding:"8px 12px",alignItems:"flex-start"}}}),!m&&(0,C.jsx)(I().A,{size:"lg",disabled:!y,onClick:g,style:k,children:(0,C.jsx)(n().sA,{defaultMessage:"Send request",id:"requestAccessForm.sendRequestButton.label"})}),(0,C.jsx)(R,{result:s})]})}function P(e){const{requestAttemptStore:t,messageStore:s,buttonPopupStore:c}=e,i=(0,o().v3)(),u=(0,o().WS)(),d=(0,n().tz)(),m=(0,r.useCallback)(((r,o,a)=>(0,C.jsx)(N,{requestAttemptStore:t,messageStore:s,error:r,result:o,ready:a,type:e.type})),[t,s,e.type]),v=(0,a().K8)((()=>{var e;return null===(e=b().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),q=(0,r.useCallback)((t=>async function(e){const{messageStore:t,buttonPopupStore:s,type:r,teamId:o,requestAttempt:a,environment:c,currentUserId:n,intl:i,flowId:u}=e;if(0===a)return;const d=t.state,m=await async function(){if("current-actor-to-block"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-block",block:e.block,message:d}});if("current-actor-to-collection"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-collection",collection:e.collection,message:d}});if("current-actor-to-space-via-team"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-space-via-team",teamId:o,message:d}});if("current-actor-to-space-via-block"===r){if(!n)return;return g().callApi({eventName:"requestAccess",environment:c,data:{type:"actor-to-space",spaceId:e.block.spaceId,message:d,forActorId:n,attributes:{add_permissions_on_approval:!1,origin_type:"trusted_domain_page"}}})}if("current-actor-to-space-via-onboarding"===r){if(!n)return;return g().callApi({eventName:"requestAccess",environment:c,data:{type:"actor-to-space",spaceId:e.spaceId,message:d,forActorId:n,attributes:{add_permissions_on_approval:!1,origin_type:"onboarding"}}})}}();return m?"success"!==m.type?"UserRateLimitResponse"===(null===(y=m.body)||void 0===y?void 0:y.name)?{error:i.formatMessage(S.rateLimitError)}:{error:(0,f().Hu)(i,m)}:("current-actor-to-block"===r?p().T_(c,{request_access_type:"page",flow_id:u,requestId:m.data.requestId}):"current-actor-to-space-via-team"===r?p().T_(c,{request_access_type:"team",flow_id:u}):"current-actor-to-space-via-block"===r?p().T_(c,{request_access_type:"space",flow_id:u,source:"trusted_domain_page"}):"current-actor-to-collection"===r?p().T_(c,{request_access_type:"collection",flow_id:u,requestId:m.data.requestId}):"current-actor-to-space-via-onboarding"===r?p().T_(c,{request_access_type:"space",flow_id:u,source:"onboarding"}):(0,l().HB)(r),s.reset(),{value:!0}):{error:i.formatMessage(S.currentUserNotFound)};var y}({...e,requestAttempt:t,environment:i,intl:d,currentUserId:v})),[i,d,e,v]),I=(0,r.useCallback)((()=>F(t)),[t]),k=(0,r.useCallback)((()=>L(c)),[c]),j=(0,a().O$)(t);return u?(0,C.jsx)(x().A,{menuType:y().gu.Modal,whiteBackground:!0,title:K(e.type),left:w(),onClickLeft:k,right:(0,C.jsx)(n().sA,{id:"requestAccessForm.mobileSend.label",defaultMessage:"Send"}),onClickRight:I,children:(0,C.jsx)(_().A,{debugName:"RequestAccessForm",capture:!0,children:(0,C.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"stretch",alignItems:"stretch",width:"100%",height:"100%"},children:(0,C.jsx)(A().A,{request:j,performRequest:q,render:m})})})}):(0,C.jsx)(_().A,{debugName:"RequestAccessForm",capture:!0,children:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-evently",alignItems:"stretch",padding:"20px 28px 24px",width:"340px"},children:[(0,C.jsx)(A().A,{request:j,performRequest:q,render:m}),(0,C.jsx)(h().A,{size:"lg",onClick:k,children:w()})]})})}function U(e){const{type:t,flowId:s,buttonType:c}=e,i=(0,o().v3)(),u="outline"===c?h().A:I().A,[d,m]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),b={attributes:{add_permissions_on_approval:!1,role:(0,a().K8)((()=>(0,v().dL)()),[])?"reader":"read_and_write"},message:void 0};let A;"page"===t?A={...b,type:"current-actor-to-block",block:{id:e.block.id,spaceId:e.block.spaceId}}:"collection"===t?A={...b,type:"current-actor-to-collection",collection:{id:e.collection.id,spaceId:e.collection.spaceId}}:(0,l().HB)(t);const _=(0,r.useCallback)((async()=>{var e;const r=await g().callApi({eventName:"requestAccess",environment:i,data:A});"success"===r.type&&r.data.request?(m(!0),p().T_(i,{request_access_type:t,previous_access_level:"none",requested_access_level:"read_and_write",flow_id:s,requestId:r.data.requestId})):"failed"===r.type&&"UserRateLimitResponse"===(null===(e=r.body)||void 0===e?void 0:e.name)&&y(!0)}),[i,A,t,s]);return(0,C.jsx)(u,{size:"lg",disabled:d||f,disabledFeedback:d||f,onClick:_,children:d?(0,C.jsx)(n().sA,{id:"fullPageError.requestAccessButton.edit.Requested",defaultMessage:"Requested access"}):f?(0,C.jsx)(n().sA,{id:"fullPageError.requestAccessButton.edit.TryAgain",defaultMessage:"Try again later"}):K("page"===t?"current-actor-to-block":"current-actor-to-collection")})}function K(e){return"current-actor-to-space-via-block"===e||"current-actor-to-space-via-onboarding"===e?(0,C.jsx)(n().sA,{defaultMessage:"Request membership",id:"requestAccessForm.requestAccessToSpaceButton.title"}):(0,C.jsx)(n().sA,{defaultMessage:"Request access",id:"requestAccessForm.requestAccessButton.title"})}}}]);