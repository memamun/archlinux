"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21088,78217],{10289:(e,t,n)=>{n.d(t,{Y:()=>a});var r=()=>n(645873);const o=new(r().O2)("invoice",(async()=>await n.e(60896).then(n.bind(n,430600)))),a=(0,r()._h)(o,(e=>e.Invoice))},75600:(e,t,n)=>{n.d(t,{O:()=>a,t:()=>o});var r=()=>n(645873);const o=(0,r()._h)(new(r().O2)("PeekRenderer",(async()=>{const{default:e}=await Promise.all([n.e(13402),n.e(43151)]).then(n.bind(n,702221));return{PeekRenderer:e}})),(e=>e.PeekRenderer)),a=(0,r()._h)(new(r().O2)("RestrictedAccess",(async()=>{const{RestrictedAccessComponent:e}=await n.e(57314).then(n.bind(n,260775));return{RestrictedAccessComponent:e}})),(e=>e.RestrictedAccessComponent))},137493:(e,t,n)=>{n.d(t,{j:()=>r});const r=new(n(178624).R)({key:"SimulateOffline",namespace:"Offline",important:!0,trackingType:"necessary"})},149257:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(296540),o=()=>n(959013),a=n(474848);const i=(0,o().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:c,isModalOpen:d,onDismiss:l}=e,[u,p]=(0,r.useState)(""),m=(0,n(484714).v3)(),f=(0,o().tz)(),g=async()=>{await n(350648).Ip({environment:m,teamId:c,message:u}),l()},v=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,a.jsx)(n(957986).A,{open:d,onDismiss:l,innerStyle:v.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:v.requestTitle,children:(0,a.jsx)(o().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,a.jsx)(n(898808).x,{style:v.icon,store:t,disabled:!0,size:22})}})}),(0,a.jsx)(n(623580).A,{textarea:!0,style:v.input,value:u,onChange:e=>{p(e.target.value)},placeholder:f.formatMessage(i.message_placeholder)}),(0,a.jsxs)("div",{style:v.footer,children:[(0,a.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,a.jsx)(o().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,a.jsx)(n(204063).A,{size:"lg",style:v.requestInvitesButton,onClick:g,children:(0,a.jsx)(o().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>b});n(898992),n(354520);var r=n(296540),o=()=>n(484714),a=()=>n(56366);const i="initial_handshake";var s=()=>n(798880),c=()=>n(959013),d=()=>n(496603),l=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),f=()=>n(179534),g=()=>n(214006),v=n(474848);const h=1;function b(){const e=(0,o().v3)(),t=(0,c().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,w]=(0,r.useState)(null),[y,A]=(0,r.useState)({value:!1,count:0}),I=(0,a().K8)((()=>f().A.getTotalUnreadMentionsCount()),[]),k=(0,a().K8)((()=>g().A.getAllSpaceViewStores(e)),[e]);(0,r.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(w(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,r.useEffect)((()=>{b&&(y.value||0===y.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:I}))}),[b,y.count,y.value,S,I]);const C=(0,r.useCallback)((async()=>{const e=d().hS(k,"userId"),n=await(0,l().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const r=n.getEmail()??"",o=n.getDisplayName(t)??"";return{id:e.userId,displayName:o,emailAddress:r}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,k]);(0,r.useEffect)((()=>{b&&S&&(y.value||0===y.count)&&C()}),[b,C,y.count,y.value,S]),(0,r.useEffect)((()=>{e.currentUser.id&&(0,u().uj)(e.currentUser.id)&&(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id,type:"mutation"}))}),[e.currentUser.id,S]),(0,r.useEffect)((()=>{b||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"})}),[b,S]);const x=(0,r.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,r.useEffect)((()=>(w((e=>(e&&(e.onmessage=x),e))),()=>{w((e=>(e&&(e.onmessage=null),e)))})),[x,S]),(0,v.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(i,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},245500:(e,t,n)=>{var r=()=>n(645873);const o={WorkflowTemplatesBuilderNotInProd:new(r().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(75134),n.e(63077),n.e(46414),n.e(14518),n.e(39600),n.e(94611)]).then(n.bind(n,213183)))),CollectionItemNameConfigMenuItemNotInProd:new(r().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(12062).then(n.bind(n,120364))))};(0,r()._h)(o.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,r()._h)(o.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},253849:(e,t,n)=>{n.d(t,{S:()=>a});var r=()=>n(645873);const o=new(r().O2)("AppComponents",(async()=>Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,108924)))),a=(0,r()._h)(o,(e=>e.AppComponents))},276324:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>r});n(16280);async function r(e){const{minimalEnvironment:t,mainStartTime:r,prefetchInitiatedTime:o,prefetchCache:a,initializeStatsigResult:i,currentUserId:s}=e,{device:c}=t,[{setupOnBeforeUnload:d},l,{createClientEnvironment:u},{setupTransactionQueue:p},{default:m},f]=await Promise.all([Promise.resolve().then(n.bind(n,840125)),Promise.resolve().then(n.bind(n,857639)),Promise.resolve().then(n.bind(n,316145)),Promise.resolve().then(n.bind(n,589994)),Promise.resolve().then(n.bind(n,518888)),Promise.resolve().then(n.bind(n,907828))]);let g=await u({minimalEnvironment:t,prefetchCache:a,currentUserId:s});const{ElectronSqlite:v}=g;f.setupRecordCacheDebugging(c);const h=await p(g);d({device:c,TransactionQueue:h,AppUpdateStore:g.AppUpdateStore,GlobalFileUploadStore:m});const[b,{default:S}]=await Promise.all([Promise.resolve().then(n.bind(n,652393)),Promise.resolve().then(n.bind(n,406792))]);if(b.initialize(g),c.isMobileNative){const e=S.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,r,o]=await Promise.all([Promise.resolve().then(n.bind(n,324234)),Promise.resolve().then(n.bind(n,475133)),Promise.resolve().then(n.bind(n,79059))]);await t.initializeMobileNativeApp(g),Object.assign(l.clientLogglyEnvironmentData,r.getMobileNativeDeviceInfo(),o.getMobileNativeSessionInfo()),S.DO_NOT_USE_measureLegacy(e,{environment:g,data:{}})}if(c.isElectron){const e=S.mark("desktop.initialize_from_js"),t=await Promise.resolve().then(n.bind(n,705540));await t.initializeElectron({device:c,electronSqlite:v});const r=await Promise.resolve().then(n.bind(n,250182)),o=await r.getDesktopDeviceInfo();Object.assign(l.clientLogglyEnvironmentData,o,{desktopVersion:c.desktopAppVersion}),S.measure(e,{environment:g})}const[w,y,A,I,k,C]=await Promise.all([Promise.resolve().then(n.bind(n,719431)),Promise.resolve().then(n.bind(n,869562)),Promise.resolve().then(n.bind(n,906537)),Promise.resolve().then(n.bind(n,604643)),Promise.resolve().then(n.bind(n,317909)),Promise.resolve().then(n.bind(n,589506))]),{setupTransactionLoadGenerator:x}=await Promise.resolve().then(n.bind(n,993893));x(g);const[{default:_},T,P,U,{CurrentUser:E},{getGhostAdminUserId:L},{default:M}]=await Promise.all([Promise.resolve().then(n.bind(n,773225)),Promise.resolve().then(n.t.bind(n,296540,19)),Promise.resolve().then(n.t.bind(n,440961,19)),Promise.resolve().then(n.t.bind(n,205338,19)),Promise.resolve().then(n.bind(n,590966)),Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,508496))]);A.startListeners(c),g=await w.initialize(g),g.currentUser.id&&g.defaultRecordCache.persistedRecordCache&&C.readAndCacheOfflinePagesMemo({userId:g.currentUser.id,persistedRecordCache:g.defaultRecordCache.persistedRecordCache,tellOtherTabsToUpdate:!1}),g.updateCurrentUserId=async e=>{const t=await L(g),n={...e.environment,currentUser:new E({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};await Y(n),n.idCreator.updateCurrentUserId(e.currentUserId)},I.initialize(g),h.startLoop();const[{maybeClearCookies:j,refreshNotionCookies:R,validateHasPermissionArgs:N,clearNotionCookiesWithNoPermission:D,clearThirdPartyCookiesAndLocalStorageWithNoPermission:O},{clearNotionLocalStorageWithNoPermission:B},q,z,W,V,{default:K},$]=await Promise.all([Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,422920)),Promise.resolve().then(n.bind(n,14307)),Promise.resolve().then(n.bind(n,915086)),Promise.resolve().then(n.bind(n,410690)),Promise.resolve().then(n.bind(n,807054)),Promise.resolve().then(n.bind(n,567417)),Promise.resolve().then(n.bind(n,842677))]);j(),Promise.all([D(g),O(g)]).then((()=>R(g))),B(),N(g);const[{TransactionQueueDependenciesImpl:F},{waitForStatsigInitialization:G},{isPrewarmedTabInitialRender:H}]=await Promise.all([Promise.resolve().then(n.bind(n,866184)),Promise.resolve().then(n.bind(n,546369)),Promise.resolve().then(n.bind(n,807054))]);let J,Z;async function Y(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await G({environment:g,initializeStatsigResult:i});J??=M.checkGate({gateName:"react_18_concurrent_rendering"});const a=performance.now(),s=document.querySelector("#notion-app");if(!s)throw new Error('Could not find element with id "notion-app"');h.updateDependencies(new F(e)),k.updateConnectionState(e),q.updateEnvironment(e),l.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),i=document.getElementById("skeleton");e&&e.remove(),i&&i.remove();const s=performance.now();z.setSubMetricsAtRenderCallback({mainStartTime:r,prefetchInitiatedTime:o,statsigBootupBlockingStartTime:t,renderStartTime:a,renderEndTime:s});const c=W.getAppStartTime();c&&S.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:g,data:{sub_metrics:V.getTimeOriginToAppStartSubMetrics()}}),S.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:o},{environment:g}),K.state&&S.measure({metricName:"client.migrate_sqlite",startTime:K.state.startTime,endTime:K.state.endTime},{environment:g}),S.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:a},{environment:g,data:{timed_out:n,is_prewarmed_tab:H(g)}})},d=T.createElement(_,{environment:e,onMount:J?c:void 0});J?(Z??=U.createRoot(s),Z.render(d)):P.render(d,s,c)}y.initialize(g),await Y(g);const{startFlushing:Q}=await Promise.resolve().then(n.bind(n,459225));return Q(((e,t)=>{S.measure(e,{environment:g,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:h,environment:g}}},309770:(e,t,n)=>{n.d(t,{P:()=>m,U:()=>p});var r=()=>n(56366),o=()=>n(231722),a=()=>n(792002),i=()=>n(301421),s=()=>n(351360),c=()=>n(24157),d=()=>n(317909),l=()=>n(755199);function u(){const e=c().default.state;if("editing"===e.mode){const t=(0,o().H7)(e.multiSelection);if(t&&(0,a().gE)(t.selection)){const e=t.store,n=i().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,r().K8)(u,[])}function m(e){const{currentUserSettingsStore:t}=s().default.state;t&&d().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{l().mJ({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},316145:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>ce});var r=()=>n(221844),o=()=>n(711740),a=()=>n(590966),i=()=>n(396487),s=()=>n(609990),c=()=>n(299972),d=()=>n(110750),l=()=>n(721338),u=()=>n(138418),p=()=>n(628182),m=()=>n(745875),f=()=>n(705540),g=()=>n(851650);class v extends(()=>n(893627))().K{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var h=()=>n(529543),b=()=>n(520348),S=()=>n(245865),w=()=>n(165162),y=(n(16280),n(944114),n(898992),n(430670),n(803949),n(581454),()=>n(857639)),A=()=>n(388821),I=()=>n(179034),k=()=>n(651170),C=()=>n(445120),x=()=>n(330013),_=()=>n(496603),T=()=>n(229833),P=()=>n(989423),U=()=>n(406792),E=()=>n(508496);let L=1;class M{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(293596).B),this.batchReadWorkers=15,this.queuedGetErrors=[],this.pendingWrites=A().RecordMapLegacy.create(),this.getManyFromDisk=async e=>{const t=A().RecordMapLegacy.create();e.forEach(((e,n)=>{let{pointer:r}=e;t.set(r,n)}));const n=await x().tB(this.connection,e),r=A().RecordMapLegacy.create();for(const o of n)this.setCachedRecordMap(r,o);return e.map((e=>{let{pointer:t,userId:n}=e;const o=this.getInMemory(t,n);if(o)return o;const a=r.get(t);return a&&a[n]}))},this.diskReadQueue=new(n(56322).A)({batchSize:Math.floor(n(430476).Zj/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=A().RecordMapLegacy.create();const t=Array.from(e).flatMap((e=>{let{value:t}=e;return t?Object.values(t):[]})),r=U().default.DO_NOT_USE_markLegacy("sqlite_record_cache.flush_writes.duration");try{await x()._D(this.connection,t);const e={status:"success"};P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),U().default.DO_NOT_USE_measureLegacy(r,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}catch(o){y().log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:(0,T().n6)(o),data:(0,k().CS)(o,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),U().default.DO_NOT_USE_measureLegacy(r,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}E().default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const r=await(0,n(97059).w)({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:r})}))},this.debouncedFlushWrites=_().sg(this.flushWrites,500,{maxWait:3e3}),this.throttledLogGetErrorBatched=_().nF(this.logGetErrorBatched,3e3,{leading:!1,trailing:!0}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:r,importance:o,maybeStaleRecordMap:a}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return y().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(449412).Fg(e)}const i=e.userId||C().m,s={pointer:t,userId:i,value:r,timestamp:Date.now(),importance:o};this.removePendingWrite(t,i,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:a})}async get(e){const{pointer:t,skipAccessWrites:n}=e,r=`get ${L}`,o=e.userId||C().m;let a;L++,this.getLatency.start(r);try{const e=this.getInMemory(t,o);if(e)return n||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(r,"memory"),e.value;a=U().default.DO_NOT_USE_markLegacy("sqlite_record_cache.get_record.duration");const i=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:o}):this.getFromDiskUnbatched(t,o));if(i){n||this.enqueueWrite({type:"access",record:i}),this.getLatency.end(r,"disk");const e={status:"success"};return P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),U().default.DO_NOT_USE_measureLegacy(a,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}),i.value}}catch(i){i instanceof k().PW||i instanceof k().lh?(this.queuedGetErrors.push(i),this.throttledLogGetErrorBatched(),this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()):y().log({level:"warning",from:"SqliteRecordCache",type:"getError",error:(0,T().n6)(i),data:(0,k().CS)(i,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};return P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),void(a&&U().default.DO_NOT_USE_measureLegacy(a,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(r,"miss")}}deleteRecord(e,t){t=t||C().m,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}deviceSupportsLoadPageChunk(){return this.connection.deviceSupportsLoadPageChunk()}async loadPageChunk(e){const{loadPageChunk:t}=this.connection;if(!t)throw new Error("Please call `deviceSupportsLoadPageChunk` before invoking this");return t({userId:e.userId||C().m,loadPageChunkArgs:e.loadPageChunkArgs,enableLogging:e.enableLogging})}preloadLoadPageChunkBundle(){const{preloadLoadPageChunkBundle:e}=this.connection;if(!e)throw new Error("Please call `deviceSupportsLoadPageChunk` before invoking this");e()}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||C().m,r=await x().rH(this.connection,{...e,timestamp:t,userId:n}),o=A().RecordMapLegacy.create(),a=_().oE(Array.from(this.pendingWrites).map((r=>{const a=r&&r.value&&n&&r.value[n];if(!a||"set"!==a.type)return;const i=a.record.value?a.record.value.value:void 0;if(!i)return;if(a.record.pointer.table!==I().ev)return;const s=i;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(o.set(a.record.pointer,!0),a.record.timestamp<t&&(a.record.timestamp=t),a.record.value):void 0})));for(const i of r)o.get(i.pointer)||this.getInMemory(i.pointer,i.userId)||a.push(i.value);return a}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||C().m,r=await x().NJ(this.connection,{...e,timestamp:t,userId:n});return r.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),r}async getOfflinePages(e){const{userId:t,orderBy:n}=e;return await x().W9({connection:this.connection,userId:t,orderBy:n})}async getOfflineOriginPages(e){const{userId:t}=e;return await x().Kg({connection:this.connection,userId:t})}async getOfflineAutosyncedOrigins(e){const{userId:t}=e;return await x().M2({connection:this.connection,userId:t})}async isPageAvailableOffline(e){const{pageId:t,userId:n}=e;return await x().gh({connection:this.connection,pageId:t,userId:n})}async getOfflineActions(e){const{impactedPageId:t,userId:n}=e;return await x().Pf({connection:this.connection,impactedPageId:t,userId:n})}async getOfflineLastDownloadedVersion(e){return await x().d6({...e,connection:this.connection})}async addOfflinePage(e){const{userId:t,pageId:n}=e;await x().i4({connection:this.connection,userId:t,pageId:n})}async addOfflineAction(e){const{userId:t,originPageId:n,impactedPageId:r,autosyncTypes:o}=e;await x().Fo({connection:this.connection,userId:t,originPageId:n,impactedPageId:r,autosyncTypes:o})}async deleteOfflineActionsAndCleanUp(e){const{userId:t,impactedPageIds:n,originPageId:r}=e;await x().JP({connection:this.connection,userId:t,originPageId:r,impactedPageIds:n})}async addOfflinePageAndOfflineAction(e){const{userId:t,impactedPageId:n,originPageId:r,autosyncTypes:o,downloadStatus:a}=e;await x().OR({connection:this.connection,userId:t,impactedPageId:n,originPageId:r,autosyncTypes:o,downloadStatus:a})}async updateOfflinePageLastDownloadedMetadata(e){const{pageId:t,userId:n,lastDownloadedAt:r,lastDownloadedVersion:o}=e;await x().qM({connection:this.connection,pageId:t,userId:n,lastDownloadedAt:r,lastDownloadedVersion:o})}async getImpactedPageIdsByOriginPageId(e){const{originPageId:t,userId:n}=e;return await x().Y8({connection:this.connection,originPageId:t,userId:n})}async deleteOfflineActionsWithOriginPageIdAndCleanUp(e){const{originPageId:t,userId:n,autosyncType:r}=e;return await x().Li({connection:this.connection,originPageId:t,userId:n,autosyncType:r})}async removeAllOfflineAutosyncedOrigins(e){const{userId:t}=e;return await x().zv({connection:this.connection,userId:t})}async isPageExplicitlyToggledOffline(e){const{pageId:t,userId:n}=e;return await x().OL({connection:this.connection,pageId:t,userId:n})}async getInlineCollectionsInOfflinePage(e){const{pageId:t,userId:n}=e;return x().ew({connection:this.connection,pageId:t,userId:n})}async getPageDownloadStatus(e){const{pageId:t,userId:n}=e;return await x().sm({connection:this.connection,pageId:t,userId:n})}async setPageDownloadStatus(e){const{pageId:t,userId:n,downloadStatus:r}=e;await x().g8({connection:this.connection,pageId:t,userId:n,downloadStatus:r})}async reset(){this.pendingWrites=A().RecordMapLegacy.create(),await x().tV(this.connection)}async deleteAllRecordTables(){try{await x().ry(this.connection),await x().lg(this.connection)}catch(e){y().log({level:"error",from:"SqliteRecordCache",type:"deleteAllRecordTablesError",error:(0,T().n6)(e)})}}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,r=this.pendingWrites.get(t),o=r&&r[n];if(o){if("set"===o.type&&"access"===e.type){const t={type:"set",record:{...o.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===o.type&&!o.maybeStaleRecord&&o.record.value&&o.record.value.value?o.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),r=n&&n[t];if(r&&"set"===r.type)return r.record}setCacheOperationMap(e,t){const n=t,{pointer:r,userId:o}=n.record,a=e.get(r)||{};e.set(r,{...a,[o]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:r}=t,o=e.get(n)||{};e.set(n,{...o,[r]:t})}removePendingWrite(e,t,n){const r=this.pendingWrites.get(e);r&&r[t]&&r[t].type===n&&this.pendingWrites.delete(e)}logGetErrorBatched(){const e=this.getEnvironment(),t=_().$z(this.queuedGetErrors,(e=>(0,T().n6)(e).message));for(const[n,r]of Object.entries(t)){if(!n)break;y().log({level:"warning",from:"SqliteRecordCache",type:"getErrorBatched",error:(0,T().n6)(r[0]),data:{batchedData:r.map((t=>(0,k().CS)(t,{isBrowser:e.device.isBrowser})))}},{forceSuppressConsoleLog:!0})}this.queuedGetErrors=[]}async getTablesThatNeedEviction(){try{return await x().W3({connection:this.connection,maxSize:this.maxSize})}catch(e){return P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),y().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,T().n6)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await x().$c({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}),P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(r){P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),y().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,T().n6)(r)})}}}var j=()=>n(206267),R=()=>n(866540),N=()=>n(735270);const D=[WebSocket.OPEN,WebSocket.CONNECTING];class O{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){"message-ports"===await this.getConnectionType()?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){var e;const{preferences:t}=await f().electronAppFeatures.get()||{};if("message-ports"===(null==t?void 0:t.sqliteConnectionType))return"message-ports";const n=f().getDesktopVersion();return n&&n[0]>=4?"message-ports":null!==(e=f().electronApi)&&void 0!==e&&e.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();const e={execSqliteBatchV2:async e=>{let{batch:t,precondition:n}=e;return this.execSqliteBatchInnerMessagePort({id:j().JW(),batch:t,precondition:n})},execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:j().JW(),batch:e}),deviceSupportsLoadPageChunk:()=>!1};this.sqliteConnection=new(N().i)({connection:e,type:"v2",migrations:await(0,R().G)(e)})}async initializeWebSocket(){await this.initializeWebSocketConnection();const e={execSqliteBatchV2:async e=>{const t=j().JW(),{batch:n,precondition:r}=e,o=JSON.stringify({id:t,batch:n,precondition:r,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,o)},execSqliteBatch:async e=>{const t=j().JW(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)},deviceSupportsLoadPageChunk:()=>!1};this.sqliteConnection=new(N().i)({connection:e,type:"v2",migrations:await(0,R().G)(e)})}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(o){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const r=await n;if(r.error)throw new Error("Received SQLite error.");return r.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.");return n.value}async initializeMessagePortConnection(){return new Promise((async e=>{var t;if(null===(t=f().electronApi)||void 0===t||!t.getSqliteMeta)return;if(this.messagePort)return;const n=t=>{try{if(!t.ports.length||t.source!==window)return;this.messagePort=t.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=e=>{const{id:t,result:n}=e.data,r=this.requests.get(t);r&&(this.requests.delete(t),r({value:n}))},window.removeEventListener("message",n),e()}catch(r){y().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,T().n6)(r)})}};window.addEventListener("message",n);(await f().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){var e;if(null===(e=f().electronApi)||void 0===e||!e.getSqliteMeta)return;const t=await f().electronApi.getSqliteMeta();if(t.error)return;if(this.ws&&D.includes(this.ws.readyState))return;const{serverProcessPort:n,authToken:r}=t.value;this.authToken=r;const o=`ws://127.0.0.1:${n}`;this.ws=new WebSocket(o),this.ws.onclose=()=>{y().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:r}=JSON.parse(t),o=this.requests.get(n);o&&(this.requests.delete(n),o({value:r}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}n(814603),n(147566),n(198721);var B=()=>n(14590);Error;class q{constructor(e){this.initializePromise=void 0,this.dedicatedWorkerConnection=void 0,this.loadPageChunk=async e=>{const t=await this.initializePromise;return await t.loadPageChunk(e)},this.preloadLoadPageChunkBundle=()=>{this.initializePromise.then((e=>{e.preloadLoadPageChunkBundle()}))},this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}async execSqliteBatch(e){return(await this.initializePromise).execSqliteBatch(e)}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){const{loadWorker:t,loadSharedWorker:r}=e,o=j().JW(),a=t(),i=r(),s=B().LV(i.port);var c;this.dedicatedWorkerConnection=B().LV(a),B().p(this.dedicatedWorkerConnection,i.port),await(c=n(714681).S(o),new Promise(((e,t)=>{navigator.locks.request(c,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),await s.initializeNewTab({tabId:o});const d={execSqliteBatch:e=>s.execSqliteBatch(e),execSqliteBatchV2:e=>s.execSqliteBatchV2(e),deviceSupportsLoadPageChunk:()=>!0,loadPageChunkWithPrecondition:e=>s.loadPageChunkWithPrecondition(e),preloadLoadPageChunkBundle:()=>{s.preloadLoadPageChunkBundle()}},l=new(N().i)({connection:d,type:"v2",migrations:await(0,R().G)(d)});try{await l.ensureMigrated()}catch(u){y().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,T().n6)(u),data:(0,k().CS)(u,{isBrowser:!0})})}return l.optimize().catch((e=>{y().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,T().n6)(e),data:(0,k().CS)(e,{isBrowser:!0})})})),l}deviceSupportsLoadPageChunk(){return!0}}class z{constructor(e){this.sqliteConnection=void 0,this.sqliteConnection=new q({loadWorker:()=>new Worker(new URL(n.p+n.u(75528),n.b)),loadSharedWorker:()=>new SharedWorker(new URL(n.p+n.u(33429),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!(!e.isBrowser||"undefined"==typeof navigator||void 0===(null===(t=navigator.locks)||void 0===t?void 0:t.request)||"undefined"==typeof SharedWorker||"localhost"===window.location.hostname&&"3003"!==window.location.port||e.isAndroid)}(t)){W("loading");const e=new z({currentUserId:n});return e.waitForInitialize().then((()=>{W("success")}),(e=>{W("error"),y().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,T().n6)(e),data:{...(0,k().CS)(e,{isBrowser:!0}),userId:n}})})),e}W("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}}function W(e){n(961581).A.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e})))}var V=()=>n(757695);class K extends V().default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(919709).IcF(t).length)return;const r=n(771467).V.load();this.setState({loading:!0,loaded:!1,result:r}),this.setState({loading:!1,loaded:!0,result:await r})}getKatex(){if(this.state.loaded)return this.state.result}}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(354520),n(908872),n(737550);var $=()=>n(763884),F=()=>n(720665),G=()=>n(449506),H=()=>n(941541),J=()=>n(589994);class Z extends V().default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:r}=e;if(this.instanceState[t.id])return;const o=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});o?this.setState({...this.instanceState,[t.id]:{state:o,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),Y(r,t),this.startMessageListeners(t,r)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const r=this.state[t];return r?r.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:r}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:r});const o=this.state[t];o&&this.setState({...this.state,[t]:{...o,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:r}=e,o=(0,F().qt)(t),a=(0,F().qt)(n),i=o.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=a.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(i),...Object.keys(s)]);return c.forEach((e=>{const t=i[e]||[],n=s[e]||[],o=this.getBacklinkState({blockId:e,currentUserId:r}),a=t.filter((e=>!o.backlinks.some((t=>_().n4(e,t))))),c=[...o.backlinks,...a].filter((e=>!n.some((t=>_().n4(e,t)))));this.setBacklinkState({blockId:e,state:{...o,backlinks:c},currentUserId:r})})),Array.from(c)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const r of t)this.setCachedBacklinkState({blockId:r,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return $().A.get({userId:n,key:Z.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:r}=e;return $().A.set({userId:r,key:Z.getCacheKey(t),value:n})}async startMessageListeners(e,t){const r=n(696706).L3.fromSpaceShardRecordId(e,I().ev);J().transactionQueue.isPendingTransactionForRecord(r)&&await J().transactionQueue.drain();const o=this.instanceState[r.id];if(!o)return;let a,i=!1;const s=_().nF(((n,r)=>{const o=a,s=r||void 0;a=s,i?o!==s&&Y(t,e):i=!0}),1e3),c=(0,n(921997).U)(r.id);o.messageStoreListenerReference=H().Ay.addListener(c,void 0,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(H().Ay.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function Y(e,t){await J().transactionQueue.awaitRecordTransaction({id:t.id,table:I().ev});if(E().default.checkGate({gateName:"multi_cell_backlinks"})){const r=(0,n(851941).dR)(t.id),o=r?{"x-notion-space-short-id":r.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},a=G().callMultiCellApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:o}),i=[];let s=0;for await(const n of a)"failed"!==n.type&&(i.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:i,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}else{const n=await G().callApi({eventName:"getBacklinksForBlock",environment:e,data:{block:t}});"failed"!==n.type&&e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:n.data.backlinks,inaccessibleBacklinkCount:n.data.inaccessibleBacklinkCount},currentUserId:e.currentUser.id})}}class Q extends V().default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenu:void 0,menu:void 0,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1,session:void 0}}clear(e){this.update((t=>({...t,menu:void 0,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){var e;void 0!==(null===(e=this.state.menu)||void 0===e?void 0:e.type)&&(this.clear(!0),await n(763824).wR(10))}}function X(e){return`PageDetailsStore:${e.type}:${e.id}`}class ee extends V().default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(534177).HB)(e)}getToggleState(e){const t=X(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=X(e);this.setState({...this.state,[n]:t})}}var te=()=>n(994310);const ne="spellcheckEnabled";class re{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=te().A.get(ne);this.setEnabled(void 0===e||e)}setEnabled(e){var t,n;(this.enabled=e,te().A.set(ne,e),null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=f().electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=f().electronApi)&&void 0!==t&&t.addToDictionary&&f().electronApi.addToDictionary(e)}setLanguages(e){var t;_().n4(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&f().electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await f().electronApi.getSpellCheckerLanguages();for(const r of e)n.push({code:r,name:t.of(r)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await f().electronApi.getAvailableSpellCheckerLanguages();for(const r of e)n.push({code:r,name:t.of(r)})}return n}}class oe extends(()=>n(496506))().default{}const ae=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","desktopEmailConfirm","root","chat","marketplace","team","gallery","settingsConsoleOrganization"],ie=[...ae,"login","login/calendar","signup","quickSearch"];let se=0;async function ce(e){var t;const{minimalEnvironment:n,prefetchCache:y,currentUserId:A}=e,{device:I,deviceStore:k,mobileNative:C,cookieService:x}=n,_=""+se++,T=I.isElectron&&Boolean(null===(t=f().electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=f().electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new O;return await n.initialize(),n}({device:I}):void 0,P=z.maybeCreateInstance({device:I,currentUserId:A}),U=new(c().A),E=new(d().Bd),L=new(u().A),j=new re,R=(null==C?void 0:C.sqliteConnection)||(null==T?void 0:T.sqliteConnection)||(null==P?void 0:P.sqliteConnection),N=R?new M({connection:R,maxSize:I.isDesktop?1e6:1e5,getEnvironment:function(){return F}}):void 0,D=new(o().L)({inMemoryRecordCache:new(r().A)({name:"default"}),persistedRecordCache:N});P&&P.waitForInitialize().catch((()=>{D.disablePersistedRecordCache()}));const B=function(e){const{device:t,RouterStore:n,ThemeStore:r}=e;let o=ae;return(t.isElectron||t.isElectronCalendar||t.isMobileNative)&&(o=ie),new oe((()=>{const e=n.state.route;return e&&o.includes(e.name)?r.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:I,RouterStore:U,ThemeStore:L}),q=I.isMobile?new Q:void 0,W=await h().getPublicDomainUserId({device:I,deviceStore:k,mobileNative:C,cookieService:x}),V=new(a().CurrentUser),$=new v({environmentName:"production",getSettings:()=>{const e=(0,w().Pr)("id_schema_dynamic_config_v3"),t=(null==e?void 0:e.get("percent",0))??0;return{enableTestDateOffset:!((null==e?void 0:e.get("real_id",!1))??!1),enableIdSchema:(0,m().rQ)(t)}},isServerOriginated:!1,currentUserId:A,mapSpaceIdToShortId:(e,t)=>{const n=(0,b().Jn)({defaultRecordCache:D,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str)}}),F={key:_,AppUpdateStore:new(i().I),device:I,deviceStore:k,WindowSizeStore:new(p().nJ)({device:I},window),KeyboardShortcutStackStore:new(s().X),defaultRecordCache:D,mobileNative:C,RouterStore:U,ThemeStore:L,ThemeModeStore:B,ElectronSqlite:T,KatexStore:new K,LocalBacklinkStore:new Z,PageDetailsStore:new ee,updateCurrentUserId:void 0,currentUser:V,SpellCheckStore:j,NativeMobileActionBarStore:q,TextSelectionCompositionStore:new(l().P),recordSubscriptionActions:S(),prefetchCache:y,TabbedRouterStore:E,cookieService:x,publicDomainUserId:W,idCreator:$};return g().uh(F),F}},316437:(e,t,n)=>{n.d(t,{A:()=>P});var r=n(296540),o=()=>n(484714),a=()=>n(819121),i=()=>n(56366),s=()=>n(401497),c=()=>n(133033),d=()=>n(959013),l=()=>n(662303),u=()=>n(857639),p=()=>n(235280),m=()=>n(994877),f=()=>n(989423),g=()=>n(95286),v=()=>n(875856);var h=()=>n(38337),b=()=>n(553965),S=()=>n(732797),w=()=>n(172079),y=()=>n(665638),A=()=>n(704152),I=()=>n(406699),k=()=>n(859428),C=()=>n(490044),x=n(474848);const _="?";function T(e){const t=(0,o().v3)(),{isMobile:n}=t.device,l=(0,d().tz)(),u=(0,i().K8)((()=>S().A.state.open),[]),p={...(0,y().$)({environment:t,rightEdgeDistance:16,isInPeekRenderer:!1}),zIndex:111},m=(0,s().IS)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),f=(0,r.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,a().p)(t)&&w().A.setState(!0)}),[]),g=(0,r.useCallback)((()=>{w().A.setState(!1)}),[]);if(n)return(0,x.jsx)(A().A,{hovered:u,testId:h().prN,mobileFeedback:n,...e,children:(0,x.jsx)(C().A,{left:(0,c().$)(m.helpIcon),disableMobileBorder:!0,children:(0,x.jsx)(d().sA,{defaultMessage:"Help & support",id:"helpButton.mobileHelpSupportButton.label"})})});const v=l.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),I=(0,b().A)(e,{onFocus:f,onBlur:g});return(0,x.jsx)(k().A,{renderTooltip:()=>(0,x.jsx)("span",{children:(0,x.jsx)(d().sA,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,x.jsx)("br",{})}})}),render:e=>(0,x.jsx)(A().A,{ariaLabel:v,className:h().prN,testId:h().prN,style:p,hoveredStyle:m.hoveredStyle,pressedStyle:m.pressedStyle,...(0,b().A)(I,e),children:_})})}const P=function(){const e=(0,o().v3)(),{isMobile:t}=e.device,a=(0,i().K8)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),s=(0,r.useCallback)((()=>{n(148024).VX(e,{from:"corner"}),async function(e){const t=v().default.state;if((0,f().kb)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:r}=(0,g().N1)(e),o=await m().be({environment:e,isSalesAssistedPlan:r});p().n({type:"decagon",locale:l().locale,analyticsSettings:t,decagonInitializeArgs:o,onError:e=>{u().log({level:"error",from:"decagonHelpers",type:"initializeDecagon",error:{message:e.message}})},userHighestPlanType:n,isSalesAssistedPlan:r,cookieService:e.cookieService})}}(e)}),[e]);return(0,x.jsx)(I().Ay,{popupType:t?I().z7.SlideUp:I().z7.Popup,hidesMobileNativeBottomBar:a,preventSlideUpTransition:a,renderOrigin:e=>(0,x.jsx)(T,{...e}),originGap:t?0:12,placementToOrigin:t?I().sx.Right:I().sx.Top,alignmentToOrigin:t?I().yP.Center:I().yP.End,buttonPopupStore:S().A,onClick:s,render:()=>(0,x.jsx)(n(240562).p,{})})}},350648:(e,t,n)=>{n.d(t,{D2:()=>A,Ip:()=>S,Jk:()=>w,YT:()=>y,e2:()=>h,g:()=>b});n(898992),n(354520);var r=()=>n(584262),o=()=>n(798880),a=()=>n(946141),i=()=>n(449506),s=()=>n(246826),c=()=>n(436572),d=()=>n(426116),l=()=>n(317909),u=()=>n(972435),p=()=>n(437622),m=()=>n(351360),f=()=>n(848237),g=()=>n(263928);const v=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function h(e){let{environment:t,userId:n,teamStore:r,user:o}=e;const i=r.getSpaceId();if(!i)return;await f().rU({environment:t,teamId:r.id,spaceId:i,teamUserInfo:o,isSettingDefaultTeam:!1,inviterId:n})&&(a().vo(t,{store:r,joined_role:"member",from:"team_invite_link"}),await b({environment:t,userId:n,teamStore:r}),c().D6({label:u().A.formatMessage(v.joinTeamSuccessMessage,{teamName:r.getName()})}))}async function b(e){let{environment:t,userId:n,teamStore:o}=e;const a=m().default.state.currentUserRootStore,i=o.getSpaceId();if(!i||!a)return;const s=a.getSpaceViewStores().filter((e=>e.getSpaceId()===i))[0];await d().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:a,pageVisitSource:r().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await g().J({environment:t,spaceId:i,userId:n}),f().L0({environment:t,teamStore:o,shouldScroll:!0})}async function S(e){let{environment:t,teamId:n,message:r}=e;if(!t.currentUser.id)return;"success"===(await i().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:r}})).type?(a().XQ(t,{teamId:n}),await y({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c().D6({label:u().A.formatMessage(v.requestTeamSuccessMessage)})}))):c().D6({label:u().A.formatMessage(v.requestTeamFailureMessage)})}async function w(e){let{environment:t,teamStore:n,accessRequestStore:r,status:i}=e;const c=r.getForActorId();if(!c)return;const d=r.getRecordModel({table:o().oo,id:c});if(d){if("approved"===i){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await f().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}l().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:r,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:o().oo,resolved_by_id:t.currentUser.id,status:i}})}}),a().GW(t,{store:n,resolution:i})}}async function y(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:o,userSettingsStore:a}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await d().tR({environment:t,spaceViewStore:n,userRootStore:o,userSettingsStore:a,pageVisitSource:r().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:o,userSettingsStore:a,pageVisitSource:r().y8.BackForward})}async function A(e){let{environment:t,teamId:n}=e;const r=await i().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===r.type)return r.data}},422920:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>a});var r=()=>n(901801),o=()=>n(948450);function a(){r().A.removeAllIfNoPermission(),o().A.removeAllIfNoPermission()}},517592:(e,t,n)=>{n.d(t,{A:()=>o});n(296540);var r=n(474848);const o=(0,n(340498).wt)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},529649:(e,t,n)=>{n.d(t,{A:()=>r});const r=new(n(463830).A)},532688:(e,t,n)=>{n.d(t,{RK:()=>a,uC:()=>i});var r=()=>n(645873);const o={Toaster:new(r().O2)("Toaster",(()=>Promise.all([n.e(94476),n.e(47381)]).then(n.bind(n,94476)))),PerfmarkTrialIneligibleToast:new(r().O2)("PerfmarkTrialIneligibleToast",(()=>n.e(58790).then(n.bind(n,585731))))},a=(0,r()._h)(o.Toaster,(e=>e.Toaster)),i=(0,r()._h)(o.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},574506:(e,t,n)=>{n.d(t,{t:()=>i});var r=()=>n(351360),o=()=>n(508496),a=()=>n(680074);function i(e){const{currentUserSettingsStore:t}=r().default.state;if(!t)return!1;const n=(0,a().iZ)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===o().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},652393:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>s});var r=()=>n(857639),o=()=>n(780054),a=()=>n(508496),i=()=>n(161132);function s(e){"object"==typeof o().A&&o().A.version&&(r().clientLogglyEnvironmentData.version=o().A.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(r().clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(r().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(r().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(r().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(r().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(r().clientLogglyEnvironmentData.isChromeExtension=!0),r().clientLogglyEnvironmentData.os=t.os,r().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(r().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(r().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(r().clientLogglyEnvironmentData.userId=n.id),r().clientLogglyEnvironmentData.is_experimental_build="clientExperimental"===o().A.buildTarget,r().clientLogglyEnvironmentData.experiments=a().default.getUsedNonControlExperimentsMap(),a().default.addListener((()=>{r().clientLogglyEnvironmentData.experiments=a().default.getUsedNonControlExperimentsMap()})),(0,i().xs)().then((e=>{e&&(r().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,r().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},682497:(e,t,n)=>{n.d(t,{o:()=>a});var r=()=>n(645873);const o=new(r().O2)("PageError",(async()=>Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(50142),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(53289),n.e(66960)]).then(n.bind(n,753289)))),a=(0,r()._h)(o,(e=>e.PageError))},762014:(e,t,n)=>{n.d(t,{A:()=>a,e:()=>r});let r=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class o extends(()=>n(757695))().default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const a=new o},773225:(e,t,n)=>{n.r(t),n.d(t,{default:()=>er});var r=n(296540),o=()=>n(136590),a=()=>n(396010),i=()=>n(662303),s=()=>n(959013),c=()=>n(851650),d=(n(898992),n(354520),()=>n(591779)),l=()=>n(496603),u=()=>n(106959),p=n(474848);function m(e){const t=(0,r.useRef)(new Map),n=(0,r.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),r=n.length-e.maxPreferredIFrames;if(r<=0)return;const o=n.filter((e=>!e.isVisible));o.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of o.slice(0,r))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),o=(0,r.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),a=(0,r.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(o):null);(0,r.useEffect)((()=>()=>{a.current&&(a.current.disconnect(),a.current=null)}),[]);const i=(0,d().ZC)(e.maxPreferredIFrames);(0,r.useEffect)((()=>{i&&e.maxPreferredIFrames<i&&n()}),[n,e.maxPreferredIFrames,i]);const s=(0,r.useMemo)((()=>({track:(e,n)=>{a.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:l().sg(n,50)}),a.current.observe(e)):u().mm.track(e,n)},untrack:e=>{a.current?(a.current.unobserve(e),t.current.delete(e)):u().mm.untrack(e)}})),[]);return(0,p.jsx)(u().jq.Provider,{value:s,children:e.children})}function f(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var g=()=>n(17022),v=()=>n(484714),h=()=>n(785082),b=()=>n(745875),S=()=>n(780054),w=()=>n(989423),y=()=>n(508496);function A(){return 1}function I(e){let{id:t,targetRenderPhase:n="all",samplePercent:o=A(),children:a}=e;const i=(0,v().v3)(),s=(0,r.useCallback)(((e,t,r,a,s,c)=>{(0,b().rQ)(o)&&("all"!==n&&t!==n||w().vd(i,`${h().PX}.${e}`,{time:r,render_phase:t}))}),[i,n,o]),[c]=(0,r.useState)(g().A.withListenerIgnored((()=>y().default.checkGate({gateName:"client-performance-profiler"}))));return c?(0,p.jsx)(r.Profiler,{id:t,onRender:s,children:a}):(0,p.jsx)(p.Fragment,{children:a})}var k=()=>n(112995),C=()=>n(186445),x=()=>n(346);function _(){return(0,x().kg)()?(0,p.jsx)(x().MG,{}):null}var T=()=>n(852507),P=()=>n(799954),U=()=>n(987264),E=()=>n(100622),L=()=>n(705540),M=()=>n(994877),j=()=>n(204063),R=()=>n(719147),N=()=>n(297590);function D(e){let{errorId:t}=e;const n=(0,v().v3)();(0,T().w)((()=>{L().navigationReady(!1)}));const r=()=>{M().SI({environment:n,from:"page_error"})};return(0,p.jsxs)("div",{style:O,children:[(0,U().s)({width:42,height:42}),(0,p.jsxs)("div",{style:B,children:[(0,p.jsx)("div",{children:(0,p.jsx)(s().sA,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,p.jsx)("div",{children:(0,p.jsx)(s().sA,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,p.jsx)(R().A,{onClick:r,children:e})}})}),t&&(0,p.jsx)("div",{style:q,children:(0,p.jsx)(N().L,{errorId:t,showLink:["dev","local"].includes("production")})})]}),(0,p.jsx)(j().A,{size:"lg",onClick:()=>window.location.reload(),children:(0,p.jsx)(s().sA,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]})}const O={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,P().xH)(i().locale)},B={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:E().Ay.uiGray},q={fontSize:10,marginTop:8};var z=()=>n(56366),W=()=>n(401497),V=()=>n(750468),K=()=>n(657924),$=()=>n(575650),F=()=>n(991699),G=()=>n(545206),H=()=>n(331542);const J=function(){const e=(0,z().O$)(F().A);return(0,p.jsx)(n(957986).A,{open:e.open,render:()=>(0,p.jsx)(Q,{}),overlayZIndex:9999})};function Z(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function Y(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor}}function Q(){const e=(0,W().DP)(),t=(0,v().v3)(),n=(0,z().O$)(F().A),{targetRecordId:r}=n,o=(0,z().K8)((()=>function(e){return void 0!==e&&Boolean(G().A.state[e])}(r)),[r]);return n.open?(0,p.jsxs)("div",{style:Z(t),children:[(0,p.jsxs)("div",{style:Y(e),children:[n.message,(0,p.jsx)(H().A,{style:{marginLeft:6}})]}),o&&r&&(0,p.jsx)($().A,{targetRecordId:r,style:{marginTop:10}})]}):null}var X=()=>n(49210),ee=()=>n(38337),te=()=>n(567121),ne=()=>n(948914),re=()=>n(100584),oe=()=>n(661179);function ae(){const e=(0,r.useRef)(null),t=(0,W().DP)().mode,n=(0,W().IS)((()=>({container:{display:"block",position:"fixed",visibility:"hidden",overflowY:"scroll",width:20,height:20}})),[]);return(0,r.useEffect)((()=>{const n=e.current;if(!n)return;const r=new ResizeObserver((e=>{const[n]=e,r=20-n.contentRect.width;r!==oe().A.state&&(oe().A.setState(r),c().u7(t))}));return r.observe(n),()=>{r.unobserve(n)}}),[t]),(0,p.jsx)("div",{style:n.container,ref:e})}function ie(e){let{children:t}=e;const n=(0,v().v3)(),o=(0,W().DP)();(0,r.useEffect)((()=>{const{mobileNative:e}=n;null==e||e.markTransitionReady({type:"mount"})}),[n]);const a="light"===o.mode?ee().fRh:ee().Rsl,s=(0,x().kg)(),c=(0,x().n_)(),d=(0,x().lC)(),l=(0,z().K8)((()=>{var e;return Boolean(null===(e=ne().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)}),[]),u={inert:(0,z().K8)((()=>!n.device.isMobile&&re().A.state.openModals.size>0),[n])?"true":null},m=(0,W().IS)((e=>({root:{...(0,P().xH)(i().locale),color:e.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:l?"rgba(0, 0, 0, 0)":e.contentBackground,transition:"height 0.1s ease",...s&&c&&d&&{height:`calc(100% - ${te().ls}px)`}},content:{height:"100%"}})),[s,c,d,l]);return(0,p.jsxs)("div",{style:m.root,className:["notion-app-inner",a].join(" "),children:[(0,p.jsx)("div",{style:m.content,...u,children:t}),(0,p.jsx)(K().A,{}),(0,p.jsx)(V().A,{}),(0,p.jsx)(J,{}),(0,p.jsx)(X().b,{}),(0,p.jsx)(ae,{})]})}var se=()=>n(951622),ce=()=>n(554279),de=()=>n(172385),le=()=>n(590265),ue=()=>n(861017),pe=()=>n(427704),me=()=>n(854150),fe=()=>n(677338),ge=()=>n(734459),ve=()=>n(183558),he=()=>n(502492),be=()=>n(939768),Se=()=>n(946141),we=()=>n(915086),ye=()=>n(209660),Ae=()=>n(5705),Ie=()=>n(836285),ke=()=>n(435009),Ce=()=>n(877688),xe=()=>n(942906),_e=()=>n(840153),Te=()=>n(755199),Pe=()=>n(555267),Ue=()=>n(534177),Ee=()=>n(449506);var Le=()=>n(217753);function Me(e){let{payload:t}=e;const n=(0,v().v3)(),[o,a]=(0,r.useState)(t?{type:"unconfirmed"}:{type:"error"}),i=(0,r.useCallback)((async()=>{if(!t)return void a({type:"error"});a({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const r=await Ee().callApi({eventName:"unsubscribeFromEmails",environment:t,data:{payload:n}});return"success"===r.type?{type:"success",spaceName:r.data.spaceName}:{type:"error"}}({environment:n,payload:t});a("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),c=(0,W().IS)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(o.type){case"loading":return(0,p.jsx)(Le().A,{children:(0,p.jsx)(s().sA,{defaultMessage:"Loading…",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,p.jsxs)(Le().A,{children:[(0,p.jsx)("div",{style:c.confirmUnsubscribeDescription,children:(0,p.jsx)(s().sA,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,p.jsx)(j().A,{size:"lg",onClick:i,analyticsName:"unsubscribe_confirm",children:(0,p.jsx)(s().sA,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,p.jsx)(Le().A,{children:(0,p.jsx)(s().sA,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,p.jsx)("b",{children:o.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,p.jsx)(Le().A,{children:(0,p.jsx)(s().sA,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,Ue().HB)(o)}}var je=()=>n(645873);const Re=new(je().O2)("desktopEmailConfirmPage",(()=>n.e(32568).then(n.bind(n,822821)))),Ne=(0,je()._h)(Re,(e=>e.default));var De=()=>n(236005),Oe=()=>n(969339),Be=()=>n(404482);function qe(e){const{preventFrontRedirect:t}=e,n=(0,v().v3)(),{pathname:r,search:o,hash:a}=window.location;if(!t&&(0,Be().D8)(n,r)){const e=o.length>0?`${o}&${De().Kr}=1`:`?${De().Kr}=1`;return window.location.href=r+e+a,null}return(0,p.jsx)(Oe().C6,{isSignup:!n.currentUser.isLoggedIn()})}var ze=()=>n(437768);const We=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,v().v3)().currentUser.isLoggedIn()?(0,p.jsx)("div",{style:t,children:(0,p.jsx)(n(378765).A,{style:{width:"100%",height:"100%"},legacySpinnerSize:ze().K,showSpinnerTimeout:500})}):null};var Ve=()=>n(688149),Ke=()=>n(296798);const $e=function(e){let{redirect:t,callbackType:n}=e;const o=(0,W().DP)(),a=(0,v().v3)();return(0,r.useEffect)((()=>{Fe({redirect:t,environment:a,callbackType:n})}),[a,t,n]),(0,p.jsxs)(Le().A,{children:[(0,p.jsx)("div",{style:{color:o.regularTextColor},children:"nativemailredirect"===n?(0,p.jsx)(s().sA,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail app…"}):"nativecalendarredirect"===n?(0,p.jsx)(s().sA,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar app…"}):(0,p.jsx)(s().sA,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,p.jsx)(Ke().A,{onClick:()=>Fe({redirect:t,environment:a,callbackType:n}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:o.lightTextColor},children:(0,p.jsx)(s().sA,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,p.jsx)(Ke().A,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:E().Ay.uiGray},children:(0,p.jsx)(s().sA,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function Fe(e){let{redirect:t,environment:n,callbackType:r}=e;ke().eG({url:t,environment:n,callbackType:r})}var Ge=()=>n(433052),He=()=>n(755636);function Je(){const e=(0,v().v3)();return(0,T().l)((()=>{const t=he().kb({schemeUrl:window.location.href,baseUrl:S().A.domainBaseUrl});He().f({environment:e,url:t}),Ge().Aj(),ke().oo({environment:e,url:pe().JZ.root,redirect:!0})})),null}var Ze=()=>n(903659),Ye=()=>n(696746),Qe=()=>n(665579),Xe=()=>n(351360);function et(e){let{children:t}=e;const n=(0,v().v3)(),r=(0,W().DP)(),o=(0,z().K8)((()=>{var e;const{mainEditorCurrentBlockStore:t}=Xe().default.state,o=(0,Ye().lU)(t),a=n.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=ne().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)?"rgba(0, 0, 0, 0)":o?(0,Qe().Lu)({theme:r,isPhone:a}):r.contentBackground}}),[n,r]);return(0,p.jsx)(Ze().A,{style:o,children:t})}var tt=()=>n(253849),nt=()=>n(901459);function rt(){const e=(0,v().v3)(),t=(0,z().K8)((()=>C().Qr(e)),[e]),n=(0,z().K8)((()=>C().X4(e).shouldShowError),[e]),r=(0,z().O$)(Xe().default),o=C().tR(e);return(0,p.jsxs)(et,{children:[t&&!n&&o&&(0,p.jsx)(nt().Z,{parentStore:t,quickSearchMode:!0}),"rendered"===r.renderPhase&&(0,p.jsx)(tt().S,{})]})}const ot=new(je().O2)("CreatorProfile",(()=>Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(42838),n.e(27634),n.e(74728),n.e(78205),n.e(49353),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(98759),n.e(88372),n.e(40200)]).then(n.bind(n,684749)))),at=(0,je()._h)(ot,(e=>e.CreatorProfile)),it=new(je().O2)("BlankPage",(async()=>Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(50142),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(53289),n.e(51702)]).then(n.bind(n,265134)))),st=(0,je()._h)(it,(e=>e.BlankPage));var ct=()=>n(10289);const dt=new(je().O2)("Onboarding",(async()=>Promise.all([n.e(23806),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(58550),n.e(22900),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(67435),n.e(75355),n.e(70769),n.e(38911),n.e(25426),n.e(89244),n.e(62342),n.e(57869),n.e(98942),n.e(45016)]).then(n.bind(n,220082)))),lt=(0,je()._h)(dt,(e=>e.Onboarding)),ut=new(je().O2)("settingsConsole",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(16471),n.e(90825),n.e(49889),n.e(97727),n.e(90409),n.e(74562),n.e(95794),n.e(4422),n.e(59794),n.e(75355),n.e(47123),n.e(97965),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(50142),n.e(20838),n.e(88860),n.e(26090),n.e(19596)]).then(n.bind(n,794043)))),pt=(0,je()._h)(ut,(e=>e.OrganizationSettingsConsole));var mt=()=>n(682497);const ft=new(je().O2)("githubStudentPack",(()=>Promise.all([n.e(38879),n.e(54564)]).then(n.bind(n,875519)))),gt=(0,je()._h)(ft,(e=>e.default)),vt=new(je().O2)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(23806),n.e(37353),n.e(58550),n.e(74728),n.e(95794),n.e(28271),n.e(24071),n.e(27991),n.e(72597),n.e(98759),n.e(37225),n.e(79239)]).then(n.bind(n,881532));return{LocalizedTemplates:e}})),ht=(0,je()._h)(vt,(e=>e.LocalizedTemplates)),bt={AddAnotherAccountLoginPage:new(je().O2)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(23806),n.e(44711),n.e(35837),n.e(23463),n.e(89244),n.e(25049),n.e(80358),n.e(20488)]).then(n.bind(n,918481))))},St=(0,je()._h)(bt.AddAnotherAccountLoginPage,(e=>e.default));var wt=()=>n(447934),yt=()=>n(171510);const At=new(je().O2)("StartupsApplication",(async()=>Promise.all([n.e(38879),n.e(47057)]).then(n.bind(n,843803)))),It=(0,je()._h)(At,(e=>e.default)),kt={LennyApplication:new(je().O2)("LennyApplication",(()=>Promise.all([n.e(38879),n.e(86279)]).then(n.bind(n,254612))))},Ct=(0,je()._h)(kt.LennyApplication,(e=>e.LennyApplication));var xt=()=>n(630116);const _t=new(je().O2)("StudentGroupSignup",(async()=>Promise.all([n.e(38879),n.e(84969)]).then(n.bind(n,544719)))),Tt=(0,je()._h)(_t,(e=>e.default));var Pt=()=>n(350648),Ut=()=>n(284371),Et=()=>n(802790),Lt=()=>n(864943),Mt=()=>n(125565),jt=()=>n(898808);const Rt=function(e){const{teamStore:t}=e,n=(0,v().v3)(),{teamName:r}=(0,z().K8)((()=>({teamName:t.getName()})),[t]),o=(0,W().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:Ut().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18,padding:12},divider:{maxWidth:280},rightButton:{fontWeight:Ut().Wy.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:o.container,children:[(0,p.jsx)(jt().x,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:o.title,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:r}})}),(0,p.jsx)("div",{style:o.subtitle,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,p.jsxs)("div",{style:o.buttonContainer,children:[(0,p.jsx)(j().A,{size:"lg",onClick:async()=>{const e=n.currentUser.id;if(!e)return;const r={type:"member",entity_type:"user",user_id:e};await Pt().e2({environment:n,userId:e,teamStore:t,user:r}),Se().pi(n,{store:t,selection:"yes"})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,p.jsx)(Lt().A,{size:"lg",style:o.rightButton,onClick:async()=>{Se().pi(n,{store:t,selection:"no"}),await Pt().YT({environment:n})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(Et().A,{size:48,innerStyle:o.divider}),(0,p.jsx)(Mt().A,{isSmall:!0,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};function Nt(e){const{teamStore:t,teamName:n,onRequestClick:r}=e,o=(0,v().v3)(),a=(0,W().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:Ut().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:Ut().Wy.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:a.container,children:[(0,p.jsx)(jt().x,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:a.title,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??Dt()}})}),(0,p.jsx)("div",{style:a.subtitle,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,p.jsxs)("div",{style:a.buttonContainer,children:[(0,p.jsx)(j().A,{size:"lg",onClick:r,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,p.jsx)(Lt().A,{size:"lg",style:a.rightButton,onClick:async()=>{await Pt().YT({environment:o})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(Et().A,{size:48,innerStyle:a.divider}),(0,p.jsx)(Mt().A,{isSmall:!0,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function Dt(){return(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const Ot=function(e){const{teamStore:t}=e,[o,a]=(0,r.useState)(!1),{teamName:i}=(0,z().K8)((()=>({teamName:t.getName()})),[t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Nt,{teamStore:t,teamName:i,onRequestClick:()=>a(!0)}),(0,p.jsx)(n(149257).A,{teamStore:t,teamName:i??Dt(),teamId:t.id,isModalOpen:o,onDismiss:()=>a(!1)})]})};function Bt(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,p.jsx)(Rt,{teamStore:n});case"closed":case"private":return(0,p.jsx)(Ot,{teamStore:n})}}const qt=function(e){const{teamId:t}=e,o=(0,v().v3)(),a=(0,z().K8)((()=>new(xt().h4)(o,{table:me().yK,id:t})),[o,t]),[{value:i}]=(0,n(187174).Yb)((async()=>await Pt().D2({environment:o,teamId:t})),[o,t]);(0,r.useEffect)((()=>{!0===(null==i?void 0:i.isValidTeamRequest)&&null!=i&&i.isTeamMember&&(async()=>{var e;const t=null===(e=o.currentUser)||void 0===e?void 0:e.id;t&&a&&await Pt().g({environment:o,userId:t,teamStore:a})})()}),[o,a,i]);const s=(0,W().IS)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return i?(0,p.jsx)("div",{style:s.container,children:i.isValidTeamRequest?(0,p.jsx)(Bt,{teamStore:a,teamAccessLevel:i.teamAccessLevel}):"nonSpaceMember"===i.invalidRequestReason?(0,p.jsx)(mt().o,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,p.jsx)(mt().o,{route:{name:"notFound"},publicPageData:void 0})}):null};const zt=new(je().O2)("aiInferenceTranscript",(()=>Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(26906),n.e(96700)]).then(n.bind(n,837303)))),Wt=(0,je()._h)(zt,(e=>e.FullPageAI));var Vt=()=>n(650829);const Kt={chatSidebar:new(je().O2)("chatSidebar",(()=>Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(26906),n.e(2703)]).then(n.bind(n,221605)))),chatSidebarActions:new(je().O2)("chatSidebarActions",(async()=>await n.e(87196).then(n.bind(n,118078)))),chatSidebarHelpers:new(je().O2)("chatSidebarHelpers",(async()=>await Promise.resolve().then(n.bind(n,890754))))},$t=(0,je()._h)(Kt.chatSidebar,(e=>e.ChatSidebar));var Ft=()=>n(762014);function Gt(e){return(0,p.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const Ht=function(){const e=(0,v().v3)(),{currentUser:t}=e,n=(0,z().K8)((()=>t.isLoggedIn()),[t]),o=(0,z().K8)((()=>Xe().default.state.inAppCalloutStore),[]),a=(0,z().K8)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,r.useEffect)((()=>{n&&(o.getCalloutVisibility("customer_io").canShow?a?Ft().A.state.suppressReason===Ft().e.IN_APP_CALLOUT_CONFLICT?Ft().A.setState({...Ft().A.state,isVisible:!0,suppressReason:void 0}):Ft().A.setState({...Ft().A.state,suppressReason:void 0}):Ft().A.setState({isVisible:!1,suppressReason:Ft().e.DARK_MODE}):Ft().A.setState({isVisible:!1,suppressReason:Ft().e.IN_APP_CALLOUT_CONFLICT}))}),[o,n,a]);const i=(0,z().K8)((()=>Ft().A.state.isVisible&&o.getCalloutVisibility("customer_io").canShow),[o]);return(0,r.useEffect)((()=>{if(i)return o.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{o.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[o,i]),n?Gt(!!i):null};var Jt=()=>n(309770),Zt=()=>n(953006);const Yt=(0,s().YK)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function Qt(e){return(0,p.jsx)("div",{style:{background:E().Ay.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function Xt(){const e=(0,v().v3)(),t=Jt().U();return(0,z().K8)((()=>{const{currentUserSettingsStore:e}=Xe().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,p.jsx)(Zt().k,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,p.jsx)(s().sA,{...Yt.pressSlashHeader,values:{slashkey:(0,p.jsx)(Qt,{char:"/"})}}),content:null,onCloseClick:()=>Jt().P(e)})}const en=new(je().O2)("InPageFind",(async()=>Promise.all([n.e(75134),n.e(28958)]).then(n.bind(n,872110)))),tn=(0,je()._h)(en,(e=>e.InPageFind));const nn=new(je().O2)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(16471),n.e(49889),n.e(97727),n.e(90409),n.e(74562),n.e(95794),n.e(28271),n.e(4422),n.e(59794),n.e(75355),n.e(47123),n.e(97965),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(50142),n.e(20838),n.e(88860),n.e(73285),n.e(27761)]).then(n.bind(n,448908)))),rn=(0,je()._h)(nn,(e=>e.ForkPageModalWrapper)),on=new(je().O2)("SecondarySidebar",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(33194),n.e(69663),n.e(95281)]).then(n.bind(n,918048)))),an=(0,je()._h)(on,(e=>e.SecondarySidebar)),sn=new(je().O2)("SpaceSettings",(async()=>Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,14243)))),cn=(0,je()._h)(sn,(e=>e.SpaceSettings));var dn=()=>n(549500),ln=()=>n(753035),un=()=>n(731320);const pn=new(je().O2)("Marketplace",(async()=>{const{default:e}=await Promise.all([n.e(23806),n.e(37353),n.e(58550),n.e(74728),n.e(95794),n.e(28271),n.e(24071),n.e(27991),n.e(72597),n.e(98759),n.e(37225),n.e(79239)]).then(n.bind(n,90500));return{Marketplace:e}})),mn=(0,je()._h)(pn,(e=>e.Marketplace));var fn=()=>n(449476),gn=()=>n(869562),vn=()=>n(644914),hn=()=>n(430483),bn=(n(16280),()=>n(244641)),Sn=()=>n(604341);async function wn(e,t){const n=await Ee().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function yn(e){const{environment:t,spaceId:n,advanceTestClockArgument:r}=e;if(r)return"number"==typeof r?r:"function"==typeof r?await async function(e){const{environment:t,spaceId:n,callback:r}=e,o=await wn(n,t);if(o)return r(o)}({environment:t,spaceId:n,callback:r}):"object"==typeof r?await async function(e){const{environment:t,spaceId:n,durationLike:r}=e,o=await wn(n,t);if(!o)return;const a=bn().c9.fromSeconds(o),i=bn().dw.fromDurationLike(r);return a.plus(i).toSeconds()}({environment:t,spaceId:n,durationLike:r}):void 0}var An=()=>n(496506);const In=new(je().O2)("PageLayoutEditor",(async()=>Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,498047)))),kn=(0,je()._h)(In,(e=>e.PageLayoutEditor)),Cn=new(je().O2)("SiteSettingsLayoutEditor",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(2409),n.e(46204)]).then(n.bind(n,993502)))),xn=(0,je()._h)(Cn,(e=>e.SiteSettingsLayoutEditor)),_n={presentationMode:new(je().O2)("PresentationMode",(async()=>await n.e(81330).then(n.bind(n,665647))))},Tn=(0,je()._h)(_n.presentationMode,(e=>e.PresentationMode));function Pn(e){const{mainEditorCurrentBlockStore:t,currentCollectionViewStore:n}=(0,z().O$)(Xe().default),r=(0,z().K8)((()=>{const r=e.routerState,o=r.route;if("team"===o.name)return{store:void 0,collectionViewStore:void 0,routerState:r};if("posts"===o.name)return{store:void 0,collectionViewStore:void 0,routerState:r};return t?{store:t,collectionViewStore:n,routerState:r}:void 0}),[n,t,e.routerState]),o=(0,z().K8)((()=>Un.getState()),[]),a=(0,z().K8)((()=>En.getState()),[]),i=(0,z().K8)((()=>Ln.getState()),[]);return o?(0,p.jsx)(kn,{}):i?(0,p.jsx)(Tn,{}):r?a?(0,p.jsx)(xn,{}):(0,p.jsx)(ze().A,{...r}):null}const Un=new(An().default)((()=>{const e=fn().A.getState();return e.isOpen&&"layout-editor"===e.mode}),{debugName:"isPageLayoutEditorOpenStore"}),En=new(An().default)((()=>{const e=fn().A.getState();return e.isOpen&&"site-settings-editor"===e.mode}),{debugName:"isSiteSettingsLayoutEditorOpenStore"}),Ln=new(An().default)((()=>{const e=fn().A.getState();return e.isOpen&&"presentation"===e.mode}),{debugName:"isPresentationModeOpenStore"});var Mn=()=>n(824622),jn=()=>n(836251),Rn=()=>n(963589),Nn=()=>n(26468),Dn=()=>n(362749),On=()=>n(817411),Bn=()=>n(155959);function qn(){const e=(0,v().v3)(),{isPhone:t,isTablet:n}=(0,v().Y0)(),r=(0,z().K8)((()=>(0,vn().KB)(e)),[e]),o=(0,Bn().T)("supportsNativeHome"),a=(0,Rn().X)("tablet_refresh_gate");return t||n&&!a?o?(0,p.jsx)(Mn().As,{}):(0,p.jsx)(Dn().Nd,{}):(0,p.jsx)(zn,{isExpanded:r})}function zn(e){let{isExpanded:t}=e;const n=(0,v().v3)(),o=n.device.isElectronMac,a=(0,z().K8)((()=>void 0!==C().rp(n).state),[n]),i=(0,z().K8)((()=>(0,jn().w6)(n)),[n]),s=(0,z().K8)((()=>(0,Nn().j)(n)),[n]),c=(0,r.useCallback)((()=>(0,p.jsx)(On().A,{skipFadeinDelay:!0})),[]),{isTablet:d}=(0,v().Y0)();return(0,p.jsx)(Dn().YZ,{isElectronMac:o,isTablet:d,isExpanded:t,renderLoading:c,forceRenderLoading:!a&&!(i||s)})}const Wn=(0,je()._h)(new(je().O2)("NotionBanners",(()=>Promise.all([n.e(23806),n.e(88294),n.e(18724)]).then(n.bind(n,518724)))),(e=>e.default)),Vn=new(je().O2)("NotionModals",(()=>Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(49889),n.e(97727),n.e(58550),n.e(22900),n.e(85128),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(47123),n.e(70769),n.e(97965),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(50142),n.e(20838),n.e(88860),n.e(83210),n.e(26090),n.e(10596),n.e(73285),n.e(27274),n.e(92448),n.e(23463),n.e(25426),n.e(91056),n.e(95810),n.e(24071),n.e(85475),n.e(35299),n.e(68117),n.e(33731),n.e(32106)]).then(n.bind(n,661171)))),Kn=(0,je()._h)(Vn,(e=>e.default));const $n=function(e){let{routerState:t}=e;const o=(0,v().v3)();(0,r.useEffect)((()=>{var e;if(null!==(e=o.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return o.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=o.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&o.mobileNative.api.appComponentMountState(!1)}}),[o]);const{route:a}=t,i=(0,z().K8)((()=>Xe().default.state.mainEditorCurrentBlockStore),[]),s=(0,z().K8)((()=>n(792415).A.state.publicPageData),[]),{shouldShowSidebar:c,shouldShowFrame:d,shouldShowError:l,shouldRedirectFromHome:u}=(0,z().K8)((()=>C().X4(o)),[o]),m=(0,z().K8)((()=>"page"===a.name&&ln().A.state.open&&(0,un().K1)(ln().A.state.blockStore)),[a.name]),f=(0,n(539412).x9)(),g=(0,z().K8)((()=>{const{device:e}=o;return"chat"!==a.name&&("marketplace"!==a.name&&(!Un.state&&(!En.state&&(!Ln.state&&(!f&&hn().zD.shouldShowAssistantInCorner(e))))))}),[o,a.name,f]),h=(0,z().K8)((()=>!o.device.isMobile&&!Un.state),[o.device.isMobile]),b=(0,z().K8)((()=>{if(!o.currentUser.isLoggedIn())return!1;if(o.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=Xe().default.state;return!(!e||!t)&&(!(0,un().qb)(o,e)&&(!g&&(!Un.state&&(!En.state&&!Ln.state))))}),[o,g]),S=(0,z().K8)((()=>hn().zD.isFullPageAssistantChatEnabled(o.device)),[o]),w=(0,z().K8)((()=>{const{device:e}=o;return!!e.isMobileNative&&("page"===a.name?hn().zD.isXMLAssistantEnabled():void 0)}),[o,a.name]),y=S&&"chat"===a.name,A=(0,z().K8)((()=>c&&!(0,vn().tv)(o)&&n(749687).sidebarOpenStore.state),[o,c]),I=(0,z().K8)((()=>(0,n(574506).t)(o)),[o]),k=(0,z().K8)((()=>(0,n(68465).ZE)(void 0)),[]),x=(0,z().K8)((()=>Xe().default.state.renderPhase),[]),_=(0,z().K8)((()=>fn().A.state.isOpen&&"layout-editor"===fn().A.state.mode),[]),T=(0,n(877051).V)();return function(){const e=["local","staging","development"].includes("production"),t=(0,v().v3)();(0,r.useEffect)((()=>{e&&((0,Sn().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=Xe().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await wn(n,t);if(e){const t=bn().c9.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Sn().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const r=null===(n=Xe().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!r)return;const o=await yn({environment:t,spaceId:r,advanceTestClockArgument:e});o&&await Ee().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:r,epochSeconds:o}})})))}),[e,t])}(),(0,p.jsxs)(et,{children:[c&&(0,p.jsx)(qn,{}),d&&(i||_||"team"===a.name||"posts"===a.name)&&(0,p.jsx)(Pn,{routerState:t}),y&&"chat"===a.name&&!_&&(0,p.jsx)(Vt().LazyAssistantFullPageChat,{}),"marketplace"===a.name&&(0,p.jsx)(mn,{}),"aiInferenceTranscript"===a.name&&(0,p.jsx)(Wt,{threadId:a.threadId,configType:a.configType,defaultUserMessage:a.defaultUserMessage}),!T&&c&&(0,p.jsx)(an,{}),!T&&(0,p.jsx)($t,{}),m&&(0,p.jsx)(rn,{}),(l||u)&&!m&&"aiInferenceTranscript"!==t.route.name&&(0,p.jsx)(mt().o,{route:t.route,publicPageData:s,shouldRedirectFromHome:u}),A&&(0,p.jsx)(Gn,{}),(0,p.jsx)(Ht,{}),b&&(0,p.jsx)(n(316437).A,{}),!T&&g&&(0,p.jsx)(Vt().LazyAssistantMenuPopup,{}),!T&&o.device.isMobile&&(0,p.jsx)(dn().IM,{}),!T&&w&&(0,p.jsx)(Vt().LazyMobileAssistantPendingOperationsCollapsedElement,{}),!T&&g&&(0,p.jsx)(Vt().LazyAssistantOriginElement,{}),!T&&(0,p.jsx)(tn,{}),!T&&k&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n(332390).C7,{}),(0,p.jsx)(n(662453).ZT,{})]}),I&&(0,p.jsx)(Xt,{}),!o.device.isMobile&&"nativeTab"!==t.route.name&&(0,p.jsx)(n(75600).t,{}),"rendered"!==x||o.device.isMobile?null:(0,p.jsx)(n(532688).RK,{}),!T&&h&&i&&(0,p.jsx)(n(577009).Sx,{currentBlockStore:i,isElectronMac:o.device.isElectronMac}),!T&&(0,p.jsx)(dn().i6,{}),!T&&(0,p.jsx)(Wn,{}),!T&&(0,p.jsx)(Kn,{}),!1,(0,p.jsx)(Hn,{})]})};function Fn(){gn().close()}function Gn(){const e=(0,v().v3)(),t=(0,z().K8)((()=>function(e){return{position:"absolute",top:0,left:(0,vn().r6)(e),right:0,bottom:0,zIndex:2}}(e)),[e]);return(0,p.jsx)("div",{style:t,onClick:Fn})}function Hn(){const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=(0,z().K8)((()=>{const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=Xe().default.state;return{currentSpaceStore:e,currentUserStore:t,renderPhase:n}}),[]);return e&&t&&"rendered"===n?(0,p.jsx)(cn,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function Jn(){const e=(0,v().v3)();(0,r.useEffect)((()=>{!S().A.isAdminMode&&e.currentUser.isLoggedIn()&&Xe().default.waitUntil((()=>{const t=Xe().default.state.currentUserSettingsStore,n=(null==t?void 0:t.isDefined())??!1;if(t&&n){const n=t.getSettings(),r=null==n?void 0:n.disable_auto_set_timezone;n&&!r&&xe().xw({environment:e,userSettingsStore:t})}return n}))}),[e]),(0,r.useEffect)((()=>{function t(){const{RouterStore:t,currentUser:n}=e,r=n.id;Ae().zd({historyId:t.state.id,currentUserId:r}),L().navigationReady(!1)}return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)}),[e]),(0,r.useEffect)((()=>{async function t(t){const{RouterStore:n}=e,r=window.location.href,o=t.state?t.state.currentUserId:void 0;let a=e;(0,wt().w8)({environment:e}),o&&o!==e.currentUser.id&&(a=await _e().T({environment:a,newCurrentUserId:o}));const i=n.state.route,s=ue().parseRoute({url:r,isMobile:a.device.isMobile,baseUrl:S().A.domainBaseUrl,publicDomainName:S().A.publicDomainName,protocol:S().A.protocol,currentUrl:window.location.href}),c="page"===i.name&&"page"===s.name&&i.blockId===s.blockId,d="onboarding"!==i.name&&"onboarding"===s.name;Ae().zd({historyId:n.state.id,currentUserId:o}),await Ce().Yw({environment:a,id:t.state&&t.state.id||(0,ve().Ay)(),action:"pop",href:r}),d&&!e.device.isMobileNative&&ke().oo({environment:a,url:pe().JZ.root}),c&&ke().qf(a)}return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}),[e]),(0,T().l)((()=>{L().subscribeToProtocolUrl((t=>function(e,t){Qn("string"==typeof e?e:e.url,!1,!1,t)}(t,e))),L().subscribeToSettingsMenuItem(Yn),L().navigationReady(!0),L().onNewWindow(((t,n)=>{ke().oo({environment:e,url:n,openInNew:"tab"})}))})),(0,r.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((t,n,r)=>Qn(t,n,r,e)))}),[e]);const t=(0,z().O$)(e.RouterStore);(0,r.useEffect)((()=>{var e;"root"===t.route.name||"page"===t.route.name||"space"===t.route.name||"blank"===t.route.name&&0===(null===(e=t.historyState)||void 0===e?void 0:e.index)||(we().setInitialRenderCompleted(),Xe().default.setState({...Xe().default.state,renderPhase:"rendered"}))}),[t]),(0,r.useEffect)((()=>{e.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||ce().u4({device:e.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:e.cookieService})}),[e.cookieService,e.currentUser,e.device,t.route.name]),(0,r.useEffect)((()=>{const t=Xe().default.state.currentUserSettingsStore;e.currentUser.isLoggedIn()&&t&&Te().Sz(e,t)}),[e]);const{device:o}=e;if(o.isNative&&ue().L7[t.route.name])return(0,p.jsx)(Je,{});if("front"===t.route.name)return(0,p.jsx)(qe,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,p.jsx)(We,{route:t.route});if("nativeRedirect"===t.route.name||"nativeMailRedirect"===t.route.name||"nativeCalendarRedirect"===t.route.name)return(0,p.jsx)($e,{redirect:t.route.redirect,callbackType:"nativeMailRedirect"===t.route.name?"nativemailredirect":"nativeCalendarRedirect"===t.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===t.route.name||"login/calendar"===t.route.name||"login/mail"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(yt().AuthSyncListener,{}),(0,p.jsx)(Oe().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL})]});if("addAnotherAccount"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(yt().AuthSyncListener,{}),(0,p.jsx)(St,{redirectURL:t.route.redirectURL})]});if("desktopEmailConfirm"===t.route.name)return(0,p.jsx)(Ne,{});if("teamsInvite"===t.route.name){const{teamId:n}=t.route;return Se().WO(e,{teamId:n}),(0,p.jsx)(Ve().A,{fetch:async()=>{const t=new(xt().h4)(e,{table:me().yK,id:n});await t.load()},render:()=>(0,p.jsx)(qt,{teamId:n})})}if("signup"===t.route.name||"signup/calendar"===t.route.name||"signup/mail"===t.route.name)return(0,p.jsx)(Oe().HQ,{isSignup:!0,email:t.route.email});if("unsubscribe"===t.route.name)return(0,p.jsx)(Me,{payload:t.route.payload});if("make"===t.route.name)return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(96346),n.e(36192),n.e(90409),n.e(63077),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28387)]).then(n.bind(n,754606)),render:e=>{let{PublicAIBuilder:t}=e;return(0,p.jsx)(t,{})}});if("onboarding"===t.route.name)return(0,p.jsx)(lt,{});if("upcomingInvoice"===t.route.name)return(0,p.jsx)(ct().Y,{route:t.route});if("invoiceById"===t.route.name)return(0,p.jsx)(ct().Y,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(pt,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=(0,ge().re)({organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,queryParams:t.route.params}),n=be().Gm({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(Zn,{url:n})}}if(t.route.name,t.route.name,"admin"===t.route.name&&S().A.isAdminMode)return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(23806),n.e(64038),n.e(4422),n.e(3965),n.e(30670),n.e(55916),n.e(19884)]).then(n.bind(n,472008)),render:e=>{let{default:t}=e;return(0,p.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(S().A.isAdminMode)return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(23806),n.e(64038),n.e(4422),n.e(3965),n.e(30670),n.e(55916),n.e(19884)]).then(n.bind(n,844923)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&S().A.isAdminMode){const{id:e,table:r}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(23806),n.e(64038),n.e(4422),n.e(3965),n.e(30670),n.e(55916),n.e(18303)]).then(n.bind(n,364233)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{table:r,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:r,integrationId:o,state:a,owner:i,userId:s,spaceId:c}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(23806),n.e(75134),n.e(85475),n.e(63513),n.e(65999),n.e(9647)]).then(n.bind(n,528039)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{responseType:e,redirectUri:r,integrationId:o,state:a,owner:i,userId:s,spaceId:c})}})}if("passkeyAuthVerify"===t.route.name){const{callbackType:e}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(25049),n.e(66805)]).then(n.bind(n,471283)),render:t=>{let{VerifyPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{callbackType:e})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:r,redirectUri:o,spaceId:a,state:i}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>n.e(58777).then(n.bind(n,215627)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{csrf:e,calendarCsrf:r,redirectUri:o,spaceId:a,state:i})}})}if("globalOauthPostLogin"===t.route.name){const{clientId:e,redirectUri:r,state:o,responseType:a,scope:i}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>Promise.all([n.e(63513),n.e(56353)]).then(n.bind(n,881489)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{clientId:e,redirectUri:r,csrfState:o,responseType:a,scope:i})}})}if("passkeyRegistrationVerification"===t.route.name){const{callbackType:r,csrfToken:o,attemptId:a,options:i}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>n.e(67045).then(n.bind(n,407485)),render:t=>{let{AddPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{environment:e,callbackType:r,csrfToken:o,attemptId:a,options:i})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:r,notion_last_visited_url:o,notion_authorization_code:a,external_object_instance_block_id:i,callback_type:s,integration_id:c,redirectToAuth:d}=t.route;return(0,p.jsx)(Ve().A,{fetch:()=>n.e(18071).then(n.bind(n,856425)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{notion_user_id:e,notion_workspace_id:r,notion_last_visited_url:o,notion_authorization_code:a,external_object_instance_block_id:i,callback_type:s,integration_id:c,redirectToAuth:d})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:r}=t.route;if(e.currentUser.isLoggedIn())return(0,p.jsx)(Ve().A,{fetch:()=>n.e(58657).then(n.bind(n,465677)),render:e=>{let{default:t}=e;return(0,p.jsx)(t,{redirectUri:r})}});{const e=be().Gm({url:`${S().A.domainBaseUrl}${pe().JZ.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:r}}),t=be().Gm({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return fe().TR(),(0,p.jsx)(Zn,{url:t})}}if("myIntegrations"===t.route.name)return(0,p.jsx)(Zn,{url:pe().JZ.creatorProfileIntegrations});if("inAppTemplateSubmission"===t.route.name)return(0,p.jsx)(Zn,{url:pe().JZ.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===t.route.name)return(0,p.jsx)(Zn,{url:pe().JZ.creatorProfile});if("creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name||"creatorProfileIntegrations"===t.route.name||"creatorProfileAnalytics"===t.route.name||"creatorProfileCoupons"===t.route.name){if(e.currentUser.isLoggedIn())return"pointer"in t.route?(0,p.jsx)(at,{publish:!!t.route.publish,lab:!!t.route.lab,botOrIntegrationPointer:t.route.pointer}):(0,p.jsx)(at,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=be().Gm({url:`${pe().JZ[t.route.name]}`}),n=be().Gm({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(Zn,{url:n})}}if("localizedTemplates"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(ht,{});{const e=be().Gm({url:`${pe().JZ[t.route.name]}`}),n=be().Gm({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(Zn,{url:n})}}if("studentGroupSignup"===t.route.name)return(0,p.jsx)(Tt,{});if("startupsApplication"===t.route.name)return(0,p.jsx)(It,{formType:"startups"});if("smbsApplication"===t.route.name)return(0,p.jsx)(It,{formType:"smb"});if("lennyApplication"===t.route.name)return(0,p.jsx)(Ct,{});if("githubStudentPackHome"===t.route.name)return(0,p.jsx)(gt,{});if("notFound"===t.route.name)return(0,p.jsx)(mt().o,{route:t.route,publicPageData:void 0});if("blank"===t.route.name)return(0,p.jsx)(st,{});if("modal"===t.route.name&&!e.currentUser.isLoggedIn()&&(t.route.templateGalleryItem||t.route.projectManagementLaunch)){const e={};return t.route.projectManagementLaunch?e.tg="gallery":t.route.templateGalleryItem&&(e.tg=t.route.templateGalleryItem),(0,p.jsx)(Zn,{url:pe().JZ.login,queryParams:e})}if("chat"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,de().X_)(t.route),n=(0,be().Gm)({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(Zn,{url:n})}if("marketplace"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,le().YD)(S().A,t.route),n=(0,be().Gm)({url:`${S().A.domainBaseUrl}${pe().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(Zn,{url:n})}return"quickSearch"===t.route.name?(0,p.jsx)(rt,{}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"modal"===t.route.name||"chat"===t.route.name||"aiInferenceTranscript"===t.route.name||"marketplace"===t.route.name||"team"===t.route.name||"posts"===t.route.name?(0,p.jsx)($n,{routerState:t}):(0,p.jsx)(Pe().A,{})}function Zn(e){let{url:t,queryParams:n}=e;const o=(0,v().v3)(),a=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{a.current||(a.current=!0,n&&Ie().I({currentUserId:void 0,params:n}),ke().oo({environment:o,url:t,redirect:!0}))}),[o,n,t]),(0,p.jsx)(Pe().A,{})}function Yn(e){ye().Ow({currentTab:e})}function Qn(e,t,n,r){const{RouterStore:o}=r,a=he().Q1({url:e,protocol:S().A.protocol,baseUrl:S().A.domainBaseUrl}),i=he().kb({schemeUrl:a,baseUrl:S().A.domainBaseUrl}),s=ue().parseRoute({url:i,baseUrl:S().A.domainBaseUrl,publicDomainName:S().A.publicDomainName,isMobile:r.device.isMobile,protocol:S().A.protocol,currentUrl:window.location.href});(r.device.isAndroid||t)&&Ae().TC({RouterStore:o,currentUserId:r.currentUser.id}),r.mobileNative&&r.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name&&"passkeyAuthCallback"!==s.name?ke().oo({environment:r,url:i,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):ke().oo({environment:r,url:i})}const Xn=!1;function er(e){let{environment:t,onMount:n}=e;const d=(0,r.useRef)(!1);(0,r.useEffect)((()=>{d.current||(d.current=!0,null==n||n())}),[n]),(0,r.useEffect)((()=>{C().jx()}),[]);const l="system"===window.notionTheme?c().VD(t):window.notionTheme,u=Xn?r.StrictMode:r.Fragment;return(0,p.jsx)(u,{children:(0,p.jsx)(o().a,{value:t,children:(0,p.jsxs)(a().w,{value:{mode:l},children:[(0,p.jsx)(s().Dk,{defaultLocale:"en-US",locale:i().locale,messages:i().D,children:(0,p.jsx)(m,{...f(t.device),children:(0,p.jsx)(k().K,{fallback:e=>{let{errorId:t}=e;return(0,p.jsx)(D,{errorId:t})},from:"Router",type:"AppCrash",children:(0,p.jsxs)(I,{id:"app",targetRenderPhase:"mount",children:[(0,p.jsx)(se().A,{}),(0,p.jsx)(ie,{children:(0,p.jsx)(Jn,{})})]})})})}),(0,p.jsx)(_,{})]})})})}},817411:(e,t,n)=>{n.d(t,{A:()=>u});n(581454),n(296540);var r=()=>n(484714),o=()=>n(56366),a=()=>n(401497);const i=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]];var s=()=>n(710149),c=()=>n(948914),d=()=>n(749687),l=n(474848);function u(e){let{skipFadeinDelay:t}=e;const n=(0,r().v3)(),u=(0,o().K8)((()=>n.device.isElectronMac&&!Boolean(c().A.state.isShowingTabBar)),[n]),m=(0,o().O$)(d().sidebarExpandedStore),f=(0,o().K8)((()=>m?d().sidebarWidthStore.state:0),[m]),g=(0,a().IS)((e=>{const t={width:20,height:20,borderRadius:4},n={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:e.surface.wash,boxShadow:e.sidebarBoxShadow,display:m?"flex":"none",minWidth:f,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{paddingTop:u?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...t,width:22,height:22},heroSectionTitle:{width:177,marginLeft:8,...n},toplevelMenu:{marginBottom:20,width:78,...n},toplevelMenuLast:{marginBottom:36,width:135,...n},sectionHeader:{marginBottom:14,width:56,...n},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...t},pageTitle:{marginLeft:8,...n}}}),[m,f,u]),v=(0,l.jsxs)("div",{style:g.heroSection,children:[(0,l.jsx)(s().A,{style:g.heroSectionIcon,emphasized:!0}),(0,l.jsx)(s().A,{style:g.heroSectionTitle,emphasized:!0})]}),h=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,l.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,l.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,l.jsx)(s().A,{style:g.toplevelMenuLast,emphasized:!0})]}),b=(0,l.jsx)(s().A,{style:g.sectionHeader,emphasized:!0}),S=i.map(((e,n)=>e.map(((e,r)=>(0,l.jsxs)("div",{style:{...!t&&p(n),...g.pageRow},children:[(0,l.jsx)(s().A,{style:g.pageIcon,emphasized:!0}),(0,l.jsx)(s().A,{style:{...g.pageTitle,width:80+20*e},emphasized:!0})]},`${n}-${r}`)))));return(0,l.jsxs)("div",{style:g.sidebar,children:[v,h,b,S]})}function p(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},840125:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>u,getUserControlledCloseConfirmationDialogReason:()=>l,setupOnBeforeUnload:()=>m,showConfirmationDialogEventEmitter:()=>c});n(16280);var r=()=>n(534177),o=()=>n(964345),a=()=>n(337567),i=()=>n(878423),s=()=>n(485634);const c=new(n(592328).A);let d;function l(){const e=u();switch(e){case"have_local_draft_unsaved_changes":case"dictation_in_progress":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,r().HB)(e)}function u(){if(!d)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return d()}const p="Changes you made may not be saved. Are you sure you want to quit?";function m(e){const{TransactionQueue:t,device:n,AppUpdateStore:r,GlobalFileUploadStore:l}=e;d=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||r.isMajorUpdate()?(0,a().A5)()?"have_pending_ai_edits":i().A.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":l.isUploading()?"uploading_files":s().A.hasPendingSyncedCollectionChanges()?"have_pending_synced_collection_changes":o().gZ.state?"dictation_in_progress":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=u();if(e)return c.emit(e),p}}},901459:(e,t,n)=>{n.d(t,{Z:()=>a});var r=()=>n(645873);const o=new(r().O2)("SearchModal",(async()=>Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(47123),n.e(5887),n.e(70769),n.e(97965),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(50142),n.e(20838),n.e(88860),n.e(83210),n.e(26090),n.e(96345),n.e(10596),n.e(73285),n.e(78846),n.e(13324),n.e(15724),n.e(99346),n.e(80187)]).then(n.bind(n,307060)))),a=(0,r()._h)(o,(e=>e.Search))},903659:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(296540),o=()=>n(56366),a=()=>n(93658),i=n(474848);const s=function(e){const t=(0,n(484714).Y0)(),s=(0,o().K8)((()=>({initiator:n(353643).A.state.initiator,isDragging:n(861841).Ay.state.isDragging})),[]),c=(0,o().K8)((()=>a().default.state.isActive),[]),d=(0,o().K8)((()=>!!a().default.state.isActive&&a().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),l=(0,r.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===d&&(e+=" notion-disable-local-cursor"),e}),[d]);return(0,r.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,i.jsx)("div",{style:{...e.style,cursor:d},className:l,children:e.children})}},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>c,xw:()=>i});var r=()=>n(416504),o=()=>n(317909),a=()=>n(755199);function i(e){const{environment:t,userSettingsStore:n}=e,o=n.getSettings(),a=null==o?void 0:o.time_zone,i=(0,r().P)();a!==i&&s({environment:t,userSettingsStore:n,timeZone:i})}function s(e){const{environment:t,userSettingsStore:n,timeZone:r}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{a().mJ({userSettingsStore:n,transaction:e,data:{time_zone:r}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:r}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{a().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:r}})},userId:n.id})}},951622:(e,t,n)=>{n.d(t,{A:()=>Ao});var r=n(296540),o=()=>n(662303),a=()=>n(484714),i=()=>n(852507),s=()=>n(554279),c=()=>n(885443),d=()=>n(402390),l=()=>n(541258),u=()=>n(824772),p=()=>n(206267),m=()=>n(351360),f=()=>n(329418),g=()=>n(763884);function v(e){g().A.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}const h=6e4;async function b(e){var t,n;void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore||await m().default.waitUntil((()=>void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore));const r=null===(t=m().default.state.currentUserStore)||void 0===t?void 0:t.id,o=null===(n=m().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!r||!o)return;const a=(0,f().g)({userId:r,spaceId:o}),i=Date.now();v(a?{userId:r,spaceId:o,session:{...a,lastFocusedTime:i}}:{userId:r,spaceId:o,session:{id:p().JW(),sessionStartTime:i,lastFocusedTime:i}})}var S=()=>n(780054),w=()=>n(645873);const y=new(w().O2)("thirdPartyScripts",(()=>n.e(1978).then(n.bind(n,63620)))),A=(0,w()._h)(y,(e=>e.InjectThirdPartyScripts));var I=()=>n(989423),k=()=>n(38337);const C={GlobalInAppMessageListener:new(w().O2)("GlobalInAppMessageListener",(()=>n.e(94869).then(n.bind(n,793383))))},x=(0,w()._h)(C.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener));var _=()=>n(554894),T=()=>n(56366),P=()=>n(401497),U=()=>n(959013),E=()=>n(284371),L=()=>n(436572),M=()=>n(186445),j=()=>n(227440),R=()=>n(508496),N=()=>n(540758),D=()=>n(670631),O=n(474848);function B(){const e=(0,U().tz)(),t=(0,P().DP)(),n=(0,T().K8)((()=>!j().A.state.online),[]),o=(0,T().K8)((()=>(0,M().s0)()),[]),a=(0,r.useRef)(n),i=(0,r.useRef)(o);(0,r.useEffect)((()=>{!n||a.current&&o===i.current||function(e){var t;const{isOffline:n,currentPageId:r,intl:o,theme:a}=e;if(!(D().A.state.offlinePages&&R().default.checkGate({gateName:"download_for_offline"})&&n&&r&&(0,N().B)(r)))return;const i=null===(t=D().A.state.offlinePages[r])||void 0===t?void 0:t.lastDownloadedAt,s=i?o.formatDate(i,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;L().D6({label:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{style:{fontWeight:E().Wy.medium},children:(0,O.jsx)(U().sA,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),i&&(0,O.jsx)("div",{style:{color:a.text.secondary},children:(0,O.jsx)(U().sA,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:s}})})]})})}({isOffline:n,currentPageId:o,intl:e,theme:t}),a.current=n,i.current=o}),[n,o,e,t])}var q=()=>n(498212),z=()=>n(589506);function W(){!function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,a().v3)();(0,r.useEffect)((()=>{e&&t&&z().readAndCacheOfflinePagesMemo({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t])}();const{publishUpdate:e,onReceiveUpdate:t}=function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,a().v3)();return(0,r.useMemo)((()=>{if(!t)return;if(!e)return;const n=(0,q().Ay)();let r;try{r=new BroadcastChannel(`offlinePageUpdates-${t}`)}catch(o){return}return{publishUpdate:()=>{r.postMessage({type:"update",tabId:n})},onReceiveUpdate:e=>{r.onmessage=t=>{"update"===t.data.type&&t.data.tabId!==n&&e()}}}}),[t,e])}()||{};!function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=(0,a().v3)();(0,r.useEffect)((()=>{t&&n&&e&&e((()=>{z().readAndCacheOfflinePages({userId:n,persistedRecordCache:t,tellOtherTabsToUpdate:!1})}))}),[t,n,e])}(t),function(e){const t=(0,T().K8)((()=>D().A.state.shouldPublishUpdate),[]);(0,r.useEffect)((()=>{t&&e&&(e(),D().A.setState({...D().A.state,shouldPublishUpdate:!1}))}),[t,e])}(e)}n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454);var V=()=>n(591779),K=()=>n(496603),$=()=>n(825972),F=()=>n(963589),G=()=>n(291606),H=()=>n(961581),J=()=>n(722038);const Z=1e3,Y=n(757695).default.createValue(12e5);class Q extends Error{constructor(e){super(e),this.name="OfflineAutosyncAbortedError"}}async function X(e){const{environment:{currentUser:{id:t},defaultRecordCache:{persistedRecordCache:n}},recentPageIds:r}=e;if(!n||!t)return{pagesToAdd:[],pagesToRemove:[]};return function(e){const{recentPageIds:t,existingAutosyncedPageIds:n}=e,r=new Set(t),o=new Set(n);return{pagesToAdd:t.filter((e=>!o.has(e))),pagesToRemove:Array.from(n).filter((e=>!r.has(e)))}}({recentPageIds:r,existingAutosyncedPageIds:(await n.getOfflineAutosyncedOrigins({userId:t})).map((e=>{let[t]=e;return t}))})}async function ee(e){const{environment:t,abortSignal:n,recentPageIds:r}=e,{pagesToAdd:o,pagesToRemove:a}=await X({environment:t,recentPageIds:r});n.throwIfAborted();for(const i of o)await(0,z().makePageAvailableOffline)({from:"addAutosyncedPage",autosyncTypes:["frecent"],pageId:i,environment:t,originPageId:i,visitedBlockIds:{forThisOriginPage:new Set}}),n.throwIfAborted();for(const i of a)await(0,z().makePageUnavailableOffline)({from:"removeAutosyncedPage",pageId:i,environment:t}),n.throwIfAborted()}function te(){const e=(0,a().v3)(),t=(0,J().y)(),n=(0,F().X)("offline_autosync"),o=(0,T().K8)((()=>function(e){var t;let{limit:n}=e;return null===(t=$().wI.state)||void 0===t?void 0:t.slice(0,n).map((e=>e.pageId))}({limit:R().default.getConfigKey("offline_mode_settings","autosynced_pages_limit")})),[]),i=(0,T().K8)((()=>function(){const e=(0,G().dE)();if(void 0===e)return(0,G().Nw)("on"),"on";return e}()),[]),s=(0,V().ZC)(i)??"off",c=(0,T().K8)((()=>H().A.state.initialRenderCompleted&&j().A.state.online&&t&&n),[t,n]);(0,r.useEffect)((()=>{const t=new AbortController,n=K().sg((()=>{if(c&&void 0!==o)if("on"!==s||"off"!==i){if("on"===i){ee({environment:e,abortSignal:t.signal,recentPageIds:o}).catch((e=>{if(!(e instanceof Q))throw e}));return setInterval((()=>{ee({environment:e,abortSignal:t.signal,recentPageIds:o}).catch((e=>{if(!(e instanceof Q))throw e}))}),Y.state)}}else(async function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=e;t&&n&&(await t.removeAllOfflineAutosyncedOrigins({userId:n}),(0,z().readAndCacheOfflinePages)({userId:n,persistedRecordCache:t,tellOtherTabsToUpdate:!0}))})(e).catch((e=>{if(!(e instanceof Q))throw e}))}),Z),r=n();return()=>{t.abort(new Q("Autosync aborted because hook deps changed")),n.cancel(),r&&clearInterval(r)}}),[e,o,c,i,s])}(0,n(604341).exposeDebugValue)("changeAutosyncInterval",(function(e){"number"==typeof e?(Y.setState(e),console.log(`Autosync interval set to ${e} ms.`)):(Y.reset(),console.log("Autosync interval set to default."))}));var ne=()=>n(346),re=()=>n(534177),oe=()=>n(705540),ae=()=>n(137493);async function ie(e,t){var n;return"undefined"==typeof navigator||void 0===(null===(n=navigator.locks)||void 0===n?void 0:n.request)?t():await navigator.locks.request(e,{ifAvailable:!0},(async e=>{if(e)return t()}))}const se=(0,n(583835).Dv)("extractWebClipperContent");var ce=()=>n(578194),de=()=>n(449506),le=()=>n(787172),ue=()=>n(357625),pe=()=>n(864260),me=()=>n(302022);const fe=new(n(752196).A);var ge=()=>n(851650),ve=()=>n(20822);var he=()=>n(457395),be=()=>n(437622),Se=()=>n(151059);function we(){const e=(0,a().v3)(),t=(0,T().K8)((()=>m().default.state.currentUserRootStore),[]);(0,r.useEffect)((()=>{t&&async function(e,t){await he().y();const n=t.getSpaceViewStores();for(const r of n){const t=r.getBookmarkedPageStores();for(const e of t)ye(e);const n=r.getSharedPageStores();for(const e of n)ye(e);const o=r.getTeamsStores();for(const e of o){const t=e.getTeamPagesStores();for(const e of t)ye(e)}const a=r.getSpaceStore();if(a){Se().A.getData(e,{spaceId:a.id});const t=(0,be().I0)(e,a);for(const e of t)ye(e)}}}(e,t)}),[t,e])}function ye(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var Ae=()=>n(857639),Ie=()=>n(994310),ke=()=>n(711059),Ce=()=>n(502626),xe=()=>n(934839),_e=()=>n(901389),Te=()=>n(135552),Pe=()=>n(731320),Ue=()=>n(150193),Ee=()=>n(865241);const Le=6e4;function Me(){const e=(0,a().v3)(),t=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n;r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),o=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),i=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n,o=(0,ke().parseVersion)(t.version),a=oe().getDesktopVersion(),i=(0,ke().getUpdateType)({currentVersion:a,nextVersion:o,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),s=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n,o=r.state;o.electronUpdate&&"downloading"===o.electronUpdate.state&&r.setState({appUpdate:o.appUpdate,electronUpdate:{...o.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),c=(0,r.useCallback)(((t,n)=>function(e,t,n){const{device:r}=n,{AppUpdateStore:o}=n,a=Ie().A.get(Ce().wp),i=t.version;if(a===i){if(r.isMac)return o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:ke().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void _e().ui({message:(0,O.jsx)(U().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ce().K0(n),items:[{label:(0,O.jsx)(U().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>Ce().K0(n)}]});Ae().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:a,nextUpdateReady:i}}})}const s=oe().getDesktopVersion(),c=(0,ke().parseVersion)(t.version),d=(0,ke().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:d,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),d=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),l=(0,r.useCallback)(((t,n)=>Ne(n,e)),[e]),u=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),p=(0,r.useCallback)(((t,n)=>De(n,e)),[e]),m=(0,r.useCallback)(((t,n)=>Oe(n,e)),[e]),f=(0,r.useCallback)(((t,n)=>Be(n,e)),[e]),g=(0,r.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(j().A.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;Ce().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,r.useEffect)((()=>{const{device:r}=e;if(r.isElectron){const e=oe().electronUpdateReady.addListener(c),r=oe().electronUpdateError.addListener(n),a=oe().electronUpdateChecking.addListener(t),v=oe().electronUpdateAvailable.addListener(i),h=oe().electronUpdateProgress.addListener(s),b=oe().electronUpdateNotAvailable.addListener(o),S=oe().appUpdateReady.addListener(f),w=oe().appUpdateError.addListener(l),y=oe().appUpdateChecking.addListener(d),A=oe().appUpdateAvailable.addListener(p),I=oe().appUpdateInstall.addListener(g),k=oe().appUpdateProgress.addListener(m),C=oe().appUpdateNotAvailable.addListener(u);return()=>{null==e||e(),null==r||r(),null==a||a(),null==v||v(),null==h||h(),null==b||b(),null==S||S(),null==w||w(),null==y||y(),null==A||A(),null==I||I(),null==k||k(),null==C||C()}}}),[e,d,u,p,l,g,m,f,i,t,n,o,s,c]),(0,r.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>Be(t,e),appUpdateError:t=>Ne(t,e),appUpdateChecking:d,appUpdateAvailable:t=>De(t,e),appUpdateProgress:t=>Oe(t,e),appUpdateNotAvailable:u}),function(e){const t=Ce().Cv(),n=Ce().B0();if(!(0,ke().isEqualVersion)(t,n)){0;Re((0,ke().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,Ce().bg(),e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,r=t.isAndroid&&(0,ke().isLessThanVersion)(n,[7,0]),o=t.isIOS&&(0,ke().isLessThanVersion)(n,[16,0]);(r||o)&&function(e){const{mobileNative:t}=e;if(!t)return;xe().HQ({bannerStore:Ue().A,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:Te().q.Red})}(e)}}),[e,d,u]);const v=(0,r.useRef)("");(0,r.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!S().A.isAdminMode&&(!S().A.isLocalhost||S().A.offline)){async function r(){if(Ee().A.state.isVisible)try{const t=Ce().Cv(),n=await de().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:v.current}});if("success"===n.type){const r=n.data;if("version"in r){const n=(0,ke().parseVersion)(r.version);n&&((0,ke().isEqualVersion)(n,t)||Be(r,e))}"hash"in r&&(v.current=r.hash||"")}}catch(t){}}const o=setInterval(r,Le);return()=>clearInterval(o)}}),[e])}async function je(e,t){const n=await async function(e){await m().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=m().default.state;return!(!n||!t||(0,Pe().qb)(e,t))}(e);n&&(Ce().Dv(e,t,"banner"),xe().HQ({bannerStore:Ue().A,id:"AppUpdate",contentKey:"minor_app_update",styleKey:Te().q.Blue}))}function Re(e,t,n,r){e===ke().UpdateType.Major||e===ke().UpdateType.Minor||Ce().wT()?(t&&Ce().fC(t)&&Ce().qr(t,n),je(r,e)):Ce().KD()?function(e,t){Ce().Dv(e,t,"modal"),_e().ui({message:(0,O.jsx)(U().sA,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ce().K0(e),items:[{label:(0,O.jsx)(U().sA,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>Ce().K0(e)}],innerStyle:{width:380}})}(r,e):t&&Ce().fC(t)&&Ce().qr(t,n)}function Ne(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function De(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const r=(0,ke().parseVersion)(e.version),o=Ce().Cv(),a=(0,ke().getUpdateType)({currentVersion:o,nextVersion:r,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:a,version:r,timestamp:Date.now(),progress:0}})}function Oe(e,t){const{AppUpdateStore:n}=t,r=n.state;r.appUpdate&&"downloading"===r.appUpdate.state&&n.setState({electronUpdate:r.electronUpdate,appUpdate:{...r.appUpdate,progress:e.downloaded/e.total}})}function Be(e,t){const{AppUpdateStore:n}=t,r=(0,ke().parseVersion)(e.version),o=Ce().Cv(),a=(0,ke().getUpdateType)({currentVersion:o,nextVersion:r,app:"client"}),i=e.createdTime;if(!Ce().fC(r)){const e={state:"ready",type:a,version:r,versionCreatedTime:i};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}Re(a,r,i,t)}var qe=()=>n(861017),ze=()=>n(939768);var We=()=>n(14307);async function Ve(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await oe().isWindowVisible()))return;if(We().isConnected())return void Ke(!0);if(!1===navigator.onLine&&!S().A.isLocalhost)return void Ke(!1);"success"===(await de().callApi({eventName:"ping",environment:e,data:{}})).type?Ke(!0):Ke(!1)}function Ke(e){j().A.setState({...j().A.state,online:e,lastOfflineTimestamp:e?j().A.state.lastOfflineTimestamp:Date.now()})}const $e=5e3;var Fe=()=>n(466103);n(672577),n(430670);var Ge=()=>n(451306),He=()=>n(919709),Je=()=>n(983650),Ze=()=>n(751735),Ye=()=>n(100622),Qe=()=>n(667019),Xe=()=>n(94953),et=()=>n(555776),tt=()=>n(116008),nt=()=>n(786074),rt=()=>n(372154),ot=()=>n(141465),at=()=>n(871399);function it(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Ge().EJ)({level:n})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\tbackground: ${(0,Ye().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().JG)(e)} !important;\n\t\t}\n\t`}function st(e){const{level:t}=e;return`\n\t\t.${(0,Ge().EJ)({level:t})}.${Je().uU}.${Je().Do} {\n\t\t\tbackground: ${(0,Ye().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().JG)(e)} !important;\n\t\t}\n\t`}function ct(e){const t=(0,Ye().aO)({level:1,mode:e.mode,hovered:!1,selected:!1}),n=(0,Ze().Mj)(t).alpha()/2,r=(0,Ze().Mj)(t).alpha(n).toRgbString(),o=(0,Ye().JG)({level:1,mode:e.mode,hovered:!1,selected:!1}),a=(0,Ze().Mj)(o).alpha()/2,i=(0,Ze().Mj)(o).alpha(a).toRgbString();return`\n\t\t.${Je().K6}.${Je().Do} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${r} !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function dt(e){const{theme:t,selected:n,hovered:r}=e;return`background: ${(0,Ye().FK)({annotationType:"update",type:"background",selected:n,hovered:r,overlapping:!1,mode:t.mode})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().FK)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t.mode})} !important;`}function lt(e){const{discussionId:t,theme:n,selected:r,hovered:o}=e;return`\n\t\t.${(0,Ge().ED)({type:"update"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${dt({theme:n,selected:r,hovered:o})}\n\t\t}\n\t\t.${(0,Ge().ED)({type:"remove"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${function(e){const{theme:t,selected:n,hovered:r}=e,o=(0,Ye().FK)({annotationType:"remove",type:"background",selected:n,hovered:r,overlapping:!1,mode:t.mode}),a=(0,Ye().FK)({annotationType:"remove",type:"underline",selected:n,hovered:r,overlapping:!1,mode:t.mode});return`background: ${o} !important;\n\t\t\tcolor: ${t.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;`}({theme:n,selected:r,hovered:o})}\n\t\t}\n\t`}function ut(e){var t,n,r;const o=(null===(t=Xe().A.state)||void 0===t?void 0:t.discussionIds)||[],a=null!==(n=rt().A.state)&&void 0!==n&&n.open&&(null===(r=rt().A.state)||void 0===r?void 0:r.discussionIds)||[];return[...o.flatMap((t=>K().Hn(Ge().DS).map((n=>it({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e.mode}))))),...a.flatMap((t=>K().Hn(Ge().DS).map((n=>it({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e.mode})))))].join("\n")}function pt(e){var t,n,r;const o=(null===(t=Xe().A.state)||void 0===t?void 0:t.discussionIds)||[],a=null!==(n=rt().A.state)&&void 0!==n&&n.open&&(null===(r=rt().A.state)||void 0===r?void 0:r.discussionIds)||[];return[...o.map((t=>lt({theme:e,discussionId:t,selected:!1,hovered:!0}))),...a.map((t=>lt({theme:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function mt(e){let t="";const n=nt().A.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,Ge().K3)({type:"insert",editId:n.editId})} {\n\t\t\t\t${dt({theme:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,Ge().K3)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,Ye().FK)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e.mode})} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${k()._Qb} .${(0,Ge().h_)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.regularTextColor} !important;\n\t\t}\n\n\t\t.${k()._Qb} .${(0,Ge().h_)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.quaternary} !important;\n\t\t}\n\t`}\n\t`}function ft(e){const t=Qe().W.getHoveredEditId();return t?function(e){const{editId:t,theme:n,selected:r,hovered:o}=e;return`\n\t\t.${(0,Ge().rI)({editId:t})}.${Je().Do} {\n\t\t\t${dt({theme:n,selected:r,hovered:o})}\n\t\t}\n\t`}({editId:t,theme:e,selected:!1,hovered:!0}):""}function gt(){const e=(0,P().DP)(),t=(0,T().K8)((()=>[ut(e),pt(e)].join("\n")),[e]),n=(0,T().K8)((()=>function(){var e,t,n;const r=null===(e=ot().A.state)||void 0===e?void 0:e.store,o="token"===(null===(t=ot().A.state)||void 0===t?void 0:t.type)?null===(n=ot().A.state)||void 0===n||null===(n=n.annotations)||void 0===n?void 0:n.find(He().sh$):void 0;if(!o)return"";const a=(0,He().cQR)(o);return"block"!==(null==r?void 0:r.table)?"":`\n\t\t\t.${(0,Ge().re)({href:a,blockId:r.id})}.${Je().Do} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),o=(0,T().K8)((()=>mt(e)),[e]),a=(0,T().K8)((()=>function(e){var t,n,r;if(!(null===(t=tt().A.state)||void 0===t?void 0:t.open))return"";let o=[],a=[];return null!==(n=et().A.state)&&void 0!==n&&n.isHovered&&(o=K().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!0,selected:!1,mode:e.mode})))),null!==(r=et().A.state)&&void 0!==r&&r.isActivelyComposing&&(a=K().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!1,selected:!0,mode:e.mode})))),[...o,...a].join("\n")}(e)),[e]),i=(0,T().K8)((()=>function(e){return at().default.isRightMarginCommentHovered()?[ct(e)].join("\n"):""}(e)),[e]),s=(0,T().K8)((()=>ft(e)),[e]),c=(0,r.useMemo)((()=>[t,n,o,a,i,s].filter(Boolean).join("\n")),[o,t,n,a,i,s]),d=(0,r.useRef)(null);(0,r.useLayoutEffect)((()=>{if(!d.current){const e=document.createElement("style");d.current=e,document.head.appendChild(e)}d.current.innerHTML=c}),[c])}var vt=()=>n(148307),ht=()=>n(634201),bt=()=>n(522419),St=()=>n(825237),wt=()=>n(416504),yt=()=>n(278238),At=()=>n(945778),It=()=>n(450648),kt=()=>n(854150),Ct=()=>n(435009),xt=()=>n(712030),_t=()=>n(267419),Tt=()=>n(878377),Pt=()=>n(669729),Ut=()=>n(903972);const Et=32;const Lt=32;async function Mt(e){const t=document.createElement("canvas");t.width=Lt,t.height=Lt;const n=t.getContext("2d"),r=document.createElement("img");return r.src=e,r.crossOrigin="anonymous",new Promise((e=>{r.onload=()=>{n.drawImage(r,0,0,Lt,Lt),e(t.toDataURL("image/png"))},r.onerror=()=>{e("")}}))}var jt=()=>n(492414),Rt=()=>n(807054),Nt=()=>n(972435),Dt=()=>n(696746),Ot=()=>n(179534),Bt=()=>n(562800),qt=()=>n(578872),zt=()=>n(430483),Wt=()=>n(278715),Vt=()=>n(589994),Kt=()=>n(977390),$t=()=>n(630116);const Ft=(0,U().YK)({notionAiDocTitle:{id:"documentTitleListener.notionAi.title",defaultMessage:"Notion AI"}});function Gt(){const e=(0,a().v3)(),t=(0,U().tz)(),n=(0,P().DP)(),o=(0,r.useRef)(),i=(0,T().O$)(zt().ts),s=(0,T().r6)((()=>{const{RouterStore:n,device:r}=e,o=n.state.route;if("chat"===o.name){return{assetPath:i?vt().A.images.assistantStaticFaceFaviconPng:vt().A.images.sparklesFavicon2Png,title:t.formatMessage(Ft.notionAiDocTitle)}}if("marketplace"===o.name)return{assetPath:vt().A.images.templates.faviconIco};if("settingsConsoleOrganization"===o.name)return{title:"Organization settings"};if("team"===o.name){const t=new($t().h4)(e,{table:kt().yK,id:o.teamId});if(!t.isReady())return;return{title:t.getName(),icon:t.getIcon()}}const a=m().default.state.mainEditorCurrentBlockStore;if(!a||!a.isReady())return;const s="page"===o.name&&o.blockId===a.id,c=a.getSpaceStore()??m().default.state.currentSpaceStore;let d=!1;if("space"===o.name&&o.requestedOnPublicDomain){const e=Bt().NG(c,a.id);d=(null==e?void 0:e.getDomainName())===o.spaceDomain}if(!s&&!d)return;const l=Ot().A.getUnreadCountForCurrentSpace().mentions,u=a.getTitleStore();let p;const f=a.getModel(),g=a.getCollectionViewIds(),v=null==u?void 0:u.getRecordModel(u.pointer);if(u&&v){if(p=(0,It().r4)({intl:Nt().A.getIntl(),textValue:u.getValue(),userTimeZone:(0,wt().P)(),getRecordModel:a.getRecordModel})||v.getEmptyTitlePlaceholder({getRecordModel:u.getRecordModel,userTimeZone:(0,wt().P)(),intl:t}),"block"===u.table&&(0,Dt().lU)(a)&&c){p=`${c.getName()} - ${t.formatMessage({id:"DocumentTitleListener.personalHomeLabel",defaultMessage:"Home"})}`}if("collection"===u.table&&f&&f.isCollectionView()&&g.length>1){const e=m().default.state.currentCollectionViewStore;e&&e.getName()&&(p=`${p} | ${e.getName()}`)}r.isElectron||(p=(0,ht().sd)(p.slice(0,100),_t().A.state)),Pe().qb(e,a)||e.device.isElectron||e.device.isMobileNative||(l>9?p=`(9+) ${p}`:l>0&&(p=`(${l}) ${p}`))}let h;null!=c&&c.getPublicSpaceData()&&(h="page"===o.name?(0,jt().Ay)({store:a,fullyQualified:!1,scrollToBlockId:null==o?void 0:o.scrollToBlockId,peekViewBlockId:o.peekViewBlockId,peekMode:o.peekMode,workflowViewType:o.workflowViewType,workflowViewKey:o.workflowViewKey,chatThreadId:o.chatThreadId,collectionViewId:o.collectionViewId,discussionId:o.discussionId,showMoveTo:o.showMoveTo,saveParent:o.saveParent,templateGalleryItem:o.templateGalleryItem,projectManagementLaunch:o.projectManagementLaunch,pageVisitSource:void 0,embedded:o.embedded}):(0,jt().Ay)({store:a,fullyQualified:!1,pageVisitSource:void 0}));const b=null==f?void 0:f.isNonverifiedContentClassification(),S=b&&f&&Wt().A.bypassedPage(a.id),w=(0,Tt().TMT)(),y=function(e,t,n){if("space"!==e.name&&"page"!==e.name||!e.requestedOnPublicDomain||!t)return n.getIcon();{const e=qt().GN(n);if(null==e||!e.getSiteId())return n.getIcon();const t=null==e?void 0:e.getSiteStore();if(e&&t&&t.isDefined()){const r=t.getFaviconUrl();return r?{pointer:e.pointer,icon:r}:n.getIcon()}}}(o,c,a);return{title:p,url:h,icon:y,isNonverified:b,hasBypassedContentClassification:S,isMemberOfSpace:w}}),[e,t,i],{useDeepEqual:!0});(0,T().O$)(s),(0,r.useEffect)((()=>{const r=K().sg((function(){const{device:r}=e,a=s.state;if(!a)return;const{url:i,title:c,icon:d}=a;let l,u,p,m;d&&(0,yt().T8)(d.icon)?p=d.icon:d&&(0,At().A)(d.icon)?l=d.icon:d&&bt().GM(d.icon)?u=d:a.assetPath&&bt().Du(a.assetPath)&&(m=a.assetPath);const f=a.isNonverified&&!a.hasBypassedContentClassification&&!a.isMemberOfSpace;c&&document.title!==c&&(f?document.title=t.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):r.isSafari&&l?document.title=`${l} ${c}`:document.title=c),i&&ze().ZO(i)!==ze().ZO(window.location.href)&&(window.history.replaceState(window.history.state,void 0,i),Ct().Mu({environment:e,url:window.location.href}));const g=document.querySelector("link[rel='shortcut icon']");if(g){const t=vt().A.images.faviconIco;if(f)g.href=t,o.current=t;else if(l)l!==o.current&&(o.current=l,async function(e,t){const n=document.createElement("canvas");n.width=Et,n.height=Et;const r=n.getContext("2d");if(r.font="normal normal normal 32px/32px sans",r.textAlign="center",r.textBaseline="middle","raw"===t)return r.fillText(e,n.width/2,n.height/2+4),n;const o=await Ut().w.load(),a=(0,Pt().$)(e,o);if(!a)return;const i=document.createElement("img");i.src=(0,ht().bz)(t);const s=(0,ht().LJ)(a);return new Promise((e=>{i.onload=()=>{r.drawImage(i,s.x,s.y,s.size,s.size,0,0,Et,Et),e(n)},i.onerror=()=>{e(void 0)}}))}(l,(0,xt().FN)(e)).then((async e=>{await Rt().waitForInitialPageRenderToComplete(),await Kt().A.waitUntil((()=>!Kt().A.state.isMeasuring)),g.href=(null==e?void 0:e.toDataURL("image/png"))||""})));else if(p){if(p!==o.current){o.current=p;const e=`${p}?mode=${n.mode}`;r.isFirefox?g.href=e:Mt(e).then((e=>{g.href=e}))}}else if(u){const{icon:t,...n}=u;if(window.location.origin!==S().A.domainBaseUrl){const r=St().wY({url:t,permissionRecord:n.pointer,baseUrl:S().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id,favicon:!0});r!==o.current&&(o.current=r,Vt().transactionQueue.awaitRecordTransaction(n.pointer).then((()=>{g.href=r})))}else{const r=St().wY({url:t,permissionRecord:n.pointer,baseUrl:S().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id,width:100});r!==o.current&&(o.current=r,Vt().transactionQueue.awaitRecordTransaction(n.pointer).then((()=>Mt(r))).then((e=>{g.href=e})))}}else if(m){const t=St().x8({url:m,width:100,baseUrl:S().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id});t!==o.current&&(o.current=t,Mt(t).then((e=>{g.href=e})))}else t!==o.current&&(g.href=t,o.current=t)}oe().electronApi&&oe().electronApi.setWindowTitle&&c&&oe().electronApi.setWindowTitle(c)}),500,{leading:!0}),a=document.title;return s.state&&r(),s.addListener(r),()=>{s.removeListener(r),document.title=a}}),[e,t,s,n.mode])}n(803949);var Ht=()=>n(831872),Jt=()=>n(964345),Zt=()=>n(840125);const Yt=(0,U().YK)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"},dictation_in_progress:{defaultMessage:"Transcription is in progress.",id:"closeConfirmationMessages.dictationInProgress"}});var Qt=()=>n(869562),Xt=()=>n(749687),en=()=>n(948914),tn=()=>n(982254),nn=()=>n(730591);var rn=()=>n(720665),on=()=>n(974233);function an(e){(0,on().default)({url:`${S().A.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}n(823215),n(737550);var sn=()=>n(979340),cn=()=>n(749240);function dn(){const e=(0,a().v3)(),t=(0,a().Y0)(),n=(0,T().K8)((()=>{const{currentUserStore:n,currentUserSettingsStore:r,currentUserRootStore:o}=m().default.state;if(!(e.currentUser.id&&n&&r&&o))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const a=o.getSpaceViewStores(),i=a.length>0&&a.every((e=>e.isReady()));if(!n.isDefined()||!r.isDefined()||!i)return;const s=K().oE(a.map((e=>e.getSpaceId()))).map((t=>Se().A.getData(e,{spaceId:t})));if(!s.every((e=>Boolean(e)||null===e)))return;const c=function(e){const t=e.map((e=>(0,be().Gb)(e))),n=new Set(K().oE(t));if(n.has("enterprise"))return"enterprise";if(n.has("business"))return"business";if(n.has("plus"))return"plus";if(n.has("personal"))return"personal_pro";if(n.has("team_free"))return"team_free";if(n.has("personal_free"))return"personal_free";if(n.has("free"))return"free";return"none"}(s),d=r.getSettings();if(!d)return;if(void 0===cn().subscriptionDataStoreInstance.state)return;const l={user_id:n.id,email:n.getEmail(),user_persona:d.persona,user_team_role:d.team_role,user_use_cases:d.use_cases,user_company_size:d.company_size,user_source:d.source,user_plan_type:c,user_subscription_tier:cn().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:un(s),time_zone:d.time_zone,locale:d.locale,preferred_locale:d.preferred_locale,signup_time:d.signup_time,app_version:t.version};return d.signup_time&&(l.created_at=Math.floor(d.signup_time/1e3)),t.desktopAppVersion&&(l.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(l.mobile_app_version=t.mobileAppVersion),d.used_desktop_web_app&&(l.used_desktop_web_app=d.used_desktop_web_app),d.used_mobile_web_app&&(l.used_mobile_web_app=d.used_mobile_web_app),d.used_mac_app&&(l.used_mac_app=d.used_mac_app),d.used_windows_app&&(l.used_windows_app=d.used_windows_app),d.used_ios_app&&(l.used_ios_app=d.used_ios_app),d.used_android_app&&(l.used_android_app=d.used_android_app),l}),[e,t],{useDeepEqual:!0});(0,r.useEffect)((()=>{n&&"none"!==n.user_plan_type&&ln(e,n)}),[e,n]);const o=void 0!==n;(0,r.useEffect)((()=>{const t=window.setTimeout((()=>{!o&&e.currentUser.id&&ln(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,o])}const ln=K().nF(n(444196).k,5e3);function un(e){return e.map((e=>(0,be().Gb)(e))).filter(re().Vq).some((e=>sn().dL(e)))}var pn=()=>n(845710),mn=()=>n(875856);var fn=()=>n(588165),gn=()=>n(621979);var vn=()=>n(987201),hn=()=>n(410690),bn=()=>n(711771),Sn=()=>n(148777),wn=()=>n(20199);const yn={recentPagesActions:new(w().O2)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,824188)))),userSignalsHelpers:new(w().O2)("userSignalsHelpers",(async()=>n.e(84084).then(n.bind(n,954220)))),broadcastChannel:new(w().O2)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,467135)))),minisearchDependency:bn().f};function An(e){const{elector:t,broadcastChannel:n}=e.state;e.setState(e.getInitialState());(async()=>{await(null==t?void 0:t.die()),await(null==n?void 0:n.close())})()}function In(){(0,r.useEffect)((()=>{(0,Sn().So)((()=>({appStart:(0,hn().getAppStartTime)(),hookStart:performance.now()})))}),[]);const e=(0,a().v3)(),{currentUserId:t,currentSpaceId:n}=(0,T().K8)((()=>{var e,t;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),o=(0,V().ZC)(t),i=(0,V().ZC)(n);(0,r.useEffect)((()=>{t&&n&&(t!==o||n!==i)&&(An(wn().A),async function(e){const{spaceId:t,userId:n,environment:r}=e;An(wn().A),(0,Sn().So)((e=>({appStart:e.appStart,hookStart:e.hookStart,setupLocalSearchStart:performance.now()})));const o=yn.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(r,n,t)})),a=yn.userSignalsHelpers.load(),i=yn.broadcastChannel.load(),s=(async()=>{const{BroadcastChannel:e,createLeaderElection:r}=await i,o=new e(`local_search_${t}_${n}`),a=r(o);wn().A.update((e=>({...e,elector:a,broadcastChannel:o})))})(),c=(await a).initializeAndLoadAllUserSignals({spaceId:t,userId:n,environment:r});await Promise.all([bn().f,o,c,s])}({spaceId:n,userId:t,environment:e}))}),[e,t,n,o,i])}var kn=()=>n(673998);var Cn=()=>n(908006),xn=()=>n(620689),_n=()=>n(574012),Tn=()=>n(24157);const Pn=new(n(496506).default)((()=>{const e=_n().A.state;return e.phase===_n().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var Un=()=>n(852477),En=()=>n(522945),Ln=()=>n(406792);function Mn(){const e=(0,a().v3)();(0,r.useEffect)((()=>{function t(t){!function(e,t){I().vd(e,"show_page_reload_confirmation_dialog",t)}(e,{reason:t})}return Zt().showConfirmationDialogEventEmitter.addListener(t),()=>{Zt().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}const jn=300;var Rn=()=>n(250454);const Nn=5e3;Math.random();Rn().I.setShouldCollect(!1);var Dn=()=>n(725614),On=()=>n(906537),Bn=()=>n(649642);const qn=window.matchMedia("(prefers-color-scheme: dark)");n(944114);var zn=()=>n(677338),Wn=()=>n(196286);const Vn=!1,Kn=(Vn?1:10)*rn().TD,$n=5*Kn;function Fn(){Vn&&console.log(...arguments)}function Gn(){(0,r.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,zn().x0)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const r=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[r,o]of t.entries())n-o>$n&&e.push(r);e.length&&Fn("Removing tab ids:",e);for(const r of e)t.delete(r)})(),n.postMessage(e);const r=t.size+1;Fn("Tab count is",r),(0,Wn().g)(r)}),Kn);return()=>{n.close(),window.clearInterval(r)}}),[])}var Hn=()=>n(919878),Jn=()=>n(980914);const Zn="loadCachedPageChunk";var Yn=()=>n(229833),Qn=()=>n(165162);const Xn=function(){const e=(0,a().v3)(),t=(0,r.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"initialize",error:(0,Yn().n6)(t),data:{userId:e.currentUser.id}})}),[e]);(0,i().l)((()=>{Qn().StatsigInitializer.initializePromise?Qn().StatsigInitializer.error?t(Qn().StatsigInitializer.error):Qn().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap")):t(new Error("`statsig.initialize` was not called on app bootstrap"))}))};var er=()=>n(317909);var tr=()=>n(187174),nr=()=>n(529543);const rr=function(){const e=(0,a().v3)(),t=(0,r.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"updateUser",error:(0,Yn().n6)(t),data:{nextUserId:e.currentUser.id,err:(0,n(319625).A)(t).message}})}),[e]),[i]=(0,tr().Yb)((async()=>await nr().getExperimentDeviceId(e)),[e]),[s]=(0,tr().Yb)((async()=>await nr().getBrowserId(e)),[e]),c=(0,T().K8)((()=>{var e,t;return!(null===(e=m().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=m().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),d=(0,T().K8)((()=>{var e;return null===(e=m().default.state.currentSpaceStore)||void 0===e?void 0:e.isDefined()}),[]),l=(0,T().K8)((()=>{if("resolved"===i.status&&"resolved"===s.status&&H().A.state.initialRenderCompleted)return!e.currentUser.id||d||c?(0,Qn().tX)(n(546369).getDataForStatsigUser({environment:e,deviceId:i.value,browserId:s.value})):void 0}),[e,i,s,d,c],{useDeepEqual:!0}),u=(0,r.useRef)(Qn().StatsigInitializer.statsigStageTwoUser),p=(0,r.useRef)(0),f=(0,T().K8)((()=>!j().A.state.online),[]);(0,r.useEffect)((()=>{!async function(){if(Qn().StatsigInitializer.isComplete&&l&&!K().n4(l,u.current)&&!f){u.current=l,p.current++;try{const t=await Qn().statsigClientLoader.getClient()||Qn().statsigClientLoader.getUninitializedStatsigClient({statsigUser:l,initialValues:void 0,overrideStableID:(0,Qn().getOrCreateStableID)()}),r=async function(a){t.off("initialization_failure",r),Ae().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}});const i=(0,n(754704).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...l.customIDs,device:(0,Qn().getDeviceAttributesForStatsigUser)(e.device),locale:o().locale},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(459225).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),s=await(0,on().default)(i);"success"===s.type?(t.dataAdapter.setData(JSON.stringify(s.data.initialValues)),t.updateUserSync(s.data.statsigUser)):Ae().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,on().V)(s),nextUserId:e.currentUser.id}})};t.on("initialization_failure",r),await t.updateUserAsync(l)}catch(r){t(r)}p.current--,0===p.current&&R().default.recomputeAllGroupStores()}}()}),[t,l,e,f])};var or=()=>n(331542);var ar=()=>n(110750),ir=()=>n(628182),sr=()=>n(584262),cr=()=>n(243020),dr=()=>n(427704),lr=()=>n(179034),ur=()=>n(245241);const pr=["compact","regular","unknown"];var mr=()=>n(671593),fr=()=>n(638681),gr=()=>n(328523),vr=()=>n(95313),hr=()=>n(518646),br=()=>n(324234),Sr=()=>n(750660),wr=()=>n(495262),yr=()=>n(5705),Ar=()=>n(867201),Ir=()=>n(537941),kr=()=>n(260488),Cr=()=>n(778417),xr=()=>n(426116),_r=()=>n(840153),Tr=()=>n(994877),Pr=()=>n(24611);var Ur=()=>n(357307);var Er=()=>n(962845),Lr=()=>n(155959),Mr=()=>n(210737);var jr=()=>n(644914);var Rr=()=>n(756279),Nr=()=>n(313790),Dr=()=>n(595985);var Or=()=>n(183558);function Br(e){const t=(0,ar().Xz)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var qr=()=>n(862292),zr=()=>n(986260),Wr=()=>n(372657),Vr=()=>n(836251),Kr=()=>n(347199),$r=()=>n(780865),Fr=()=>n(719431),Gr=()=>n(575301),Hr=()=>n(1130);const Jr={MobileNativePerformanceListener:new(w().O2)("MobileNativePerformanceListener",(async()=>await n.e(62058).then(n.bind(n,227731))))},Zr=(0,w()._h)(Jr.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var Yr=()=>n(179266),Qr=()=>n(129522),Xr=()=>n(106628),eo=()=>n(690978),to=()=>n(624307),no=()=>n(323914),ro=()=>n(496067),oo=()=>n(718807),ao=()=>n(524450),io=()=>n(732797),so=()=>n(529649),co=()=>n(933371),lo=()=>n(75368),uo=()=>n(466872),po=()=>n(224701);const mo=(0,U().YK)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}}),fo=K().Bj((async(e,t)=>(await Xr().T.searchActions.load()).getLocalCacheFromAppState(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=m().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function go(e){const{mobileNative:t,TabbedRouterStore:r,device:o}=e();if(o.isMobileNative&&t){var a;t.updateReceiveApiHandlers({connectivityTypeChanged:e=>{j().A.setState({...j().A.state,mobileConnectivityType:e})},toggleAvailableOffline:t=>{const{pageId:n}=t;z().toggleExplicitlyOfflined({store:new($t().Bv)(e(),{table:lr().ev,id:n}),environment:e(),analyticsFrom:"mobile_home"})},statusBarTap:ho,backButtonPress:()=>Ht().N6(e(),{type:"backbutton"}),keyboardWillShow:t=>{_n().A.updateKeyboardPhase(e(),_n().i.willShow,t??0)},keyboardDidShow:t=>{_n().A.updateKeyboardPhase(e(),_n().i.shown,t??0)},keyboardWillHide:()=>{_n().A.updateKeyboardPhase(e(),_n().i.willHide,0)},keyboardDidHide:()=>{var t;(_n().A.updateKeyboardPhase(e(),_n().i.hidden,0),o.isIpad)&&(Cr().IU({environment:e()}),null===(t=e().NativeMobileActionBarStore)||void 0===t||t.clear(!0))},keyboardConfigChanged:e=>{_n().A.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,Lr().T)("supportsNativeSafeAreaConfig")?(ir().U4.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):ir().U4.reset()},keyboardShortcut:t=>Ht().N6(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&_n().A.update((t=>({...t,nativeBottomBarHeight:e.height})))},pushNotificationTokenRefresh:t=>br().handleTokenRefresh(e(),t,"refresh"),resume:ao().A.resume,pause:async()=>{ao().A.pause();const{stopDictation:t}=await Promise.all([n.e(23806),n.e(75134),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(47858),n.e(51860),n.e(27274),n.e(92448),n.e(2681),n.e(90372)]).then(n.bind(n,185982));await t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await de().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}}),await po().Ow(e())},refreshSubscriptionDataV2:async()=>{await po().Ow(e())},processMobileActionBarAction:e=>{const{componentId:n,action:r}=e;t.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:r})},logout:t=>{Fr().logoutSingleAccount({environment:e(),userId:t,logoutOrigin:cr().d.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:r}=t;Fr().logoutSingleAccount({environment:e(),userId:n,logoutOrigin:cr().d.MobileNativeListener,fcmToken:r})},logoutAll:()=>{Fr().logout(e())},openDestinationV2:t=>{Mr().A.closeAll();const n=e(),r=(0,ar().Xz)(n.TabbedRouterStore.state),{activeTab:o,tabs:a}=n.TabbedRouterStore.state,i=r===a[o].rootPage,s="native"===r.type,c=i&&s;switch((0,Vr().Al)(n)&&Ir().s({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":!function(e,t){const n=new($t().Bv)(t,{table:lr().ev,id:e});Sr().ho({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{Ar().Y({store:n,environment:t,pageVisitSource:sr().y8.Move})}})}(t.blockId,n);break;case"trash":wo({query:t.query});break;case"webSearch":!function(e,t){kr()._N({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),gr().Mq(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){yo(e),lo().A.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){co().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),Ct().oo({environment:e,url:`${dr().GJ.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"createOrJoinWorkspace":return So(n,t.userId)}},openDestination:t=>{Mr().A.closeAll();const n=e();switch("closePopup"!==t&&(0,Vr().Al)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&Ir().s({environment:n,tab:r.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":yo(n);break;case"allUpdates":!function(e){(0,Lr().T)("supportsNativeHome")&&e.device.isPhone?(yr().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Ct().oo({environment:e,url:`${dr().GJ.nativeTab}/updates`,redirect:!0})):uo().A.setState({...uo().A.state,open:!0})}(n);break;case"addAccount":no().c.setState({...no().c.state,open:!0});break;case"createOrJoinWorkspace":return So(n);case"notificationAndSettings":to().A.setState({open:!0,source:to().C.Home});break;case"trash":wo({});break;case"memberSettings":so().A.setState({...so().A.state,open:!0});break;case"help":io().A.setState({...io().A.state,open:!0});break;case"intercom_messages":!function(e){Tr().SI({environment:e,from:"help_button"})}(n);break;case"aiWriter":!function(e){zr().hW(e)}(n)}},setCurrentUserId:async t=>{await bo(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const r=await _r().T({environment:n,newCurrentUserId:e}),{currentUserRootStore:o,currentUserSettingsStore:a}=m().default.state;if(!o)return;await o.load();const i=(0,be().km)(t);i&&await xr().tR({environment:r,spaceViewStore:i,userSettingsStore:a,userRootStore:o,pageVisitSource:sr().y8.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const n=(0,mr().tf)(fr().literals(...pr),e)?"unknown":e;n!==t.horizontalSizeClass.state&&t.horizontalSizeClass.setState(n)},updateTabbedRouterState:t=>{var n;const r=e(),{TabbedRouterStore:o}=r,a=o.state;if(t.tab!==a.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!K().n4(t.modal,a.modal)||a.tabs[a.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)co().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)})));Ir().s({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else ho();const i=o.state;return[{state:i,topPage:(0,ar().Xz)(i),webTransitionType:Br(i),updateId:t.updateId??(0,q().Ay)()}]},getLocalSearchResults:async t=>{const n=await fo(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const r=(0,mr().tf)(ur().gG,t.sort);if(r)return[{error:`old sort type is unsupported! ${r}`}];const o=t.sort,a=!j().A.state.online&&R().default.checkGate({gateName:"download_for_offline"}),i={...t.filters,isOfflineOnly:a},s=(0,eo().k)({query:{query:{text:t.query??"",filters:i,sort:o},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e()}),c=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!s||0===s.results.length)return c;const d=j().A.state.online?$r().kZ(e(),s.results):s.results;return[{value:{results:d,total:d.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await qr().T.formulas.load();(0,zr().aI)(e(),"custom_add_comment_menu_item",t)},filterValidMoveToBlocks:t=>{const n=t.targets.map((t=>new($t().Bv)(e(),{table:lr().ev,id:t}))),r=t.blocks.filter((t=>{const r=new($t().Bv)(e(),{table:lr().ev,id:t});return r.canEdit()&&(0,Wr().zO)(r,n)}));return[{value:{targets:t.targets,blocks:r}}]},completeMoveToTransaction:async t=>{const{targets:n,destination:r,moveToContext:o,timeToSelectMs:a,isSearchResult:i,flowId:s}=t,c=n.map((t=>new($t().Bv)(e(),{table:lr().ev,id:t}))),d=Sr().zs(e(),n,r);if(c&&c.length>0&&!d)try{return await er().createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:e(),waitForServerCommit:!1,perform:async t=>{await Sr().Ju({targets:c,value:r,transaction:t,environment:e(),moveToContext:o,renderType:"native",timeToSelectMs:a,disableSuccessToast:!0,isSearchResult:i,flowId:s})}}),[{value:t}]}catch(l){}return vr().qN(e(),{type:"moved_to_subpage"}),[{error:Nt().A.formatMessage(mo.failedToMovePageGeneric)}]},undoRevision:()=>{wr().tN({environment:e(),preventSelectText:!0})},searchTeams:async e=>{const{query:t}=e,n=m().default.state.currentSpaceStore,r=m().default.state.currentSpaceViewStore;if(!n||!r)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const o=await Xr().T.searchActions.load();return[{value:{ids:(await o.searchTeams({spaceViewStore:r,query:t,teamStores:r.getTeamsStores()})).map((e=>e.id))}}]},getImageBlockUrls:async t=>{var n;const{blockId:r,renderWidth:o}=t,a=null===(n=Qr().K.findBlockFromId(r))||void 0===n?void 0:n.getBlockStore();if(!a||"image"!==a.getType())return[{error:"blockId points to a non-image block"}];const i=a,s=(0,Pr().x7)(i),c={isAuthenticated:!0,url:s,width:o,permissionRecord:i.pointer},d=e(),l=await(0,Yr().L)(c,d);if(!l)return[{error:"could not get proxied image url"}];const u=0===l.indexOf("https:")?l:`${S().A.domainBaseUrl}${l}`;let p;return bt()._J(s)&&(p=await(0,hr().k)(d,{url:s,download:!1,downloadName:"image",permissionRecord:i.pointer},!1,!1)),[{value:{previewUrl:u,originalUrl:p}}]}});const s=e().mobileNative;var i;if(null!=s&&null!==(a=s.api)&&void 0!==a&&a.ready)null==s||null===(i=s.api)||void 0===i||i.ready()}}function vo(){const e=(0,a().v3)(),t=(0,F().X)("tablet_refresh_gate"),{device:n}=e;(0,r.useEffect)((()=>go((()=>e))),[e]),function(){const e=(0,a().v3)(),t=(0,T().K8)((()=>(0,Ur().Y)(e)),[e]);(0,r.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,a().v3)(),t=(0,T().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=m().default.state;if(!e||!t)return;const n=zt().zD.isShowingQNAOnMobile(),r=zt().zD.shouldShowAssistantFace();return{userId:e.id,spaceId:t.id,enabled:n,showAssistantFace:r}}),[]);(0,r.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const{mobileNative:e}=(0,a().v3)();(0,r.useEffect)((()=>{null==e||e.updateAiAssistantVisibilityState({enabled:!1})}),[e])}(),function(){const e=(0,a().v3)(),{mobileNative:t,WindowSizeStore:n}=e,o=(0,T().O$)(n),i=(0,T().K8)((()=>({visible:Xt().sidebarExpandedStore.state&&!(0,jr().o1)(e),width:(0,jr().r6)(e)})),[e]);(0,r.useEffect)((()=>{null==t||t.sidebarVisibility(i.visible,i.width)}),[e,t,o,i])}(),function(){const e=(0,a().v3)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:o,previousState:i}=(0,T().K8)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,r.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:o,topPage:(0,ar().Xz)(o),webTransitionType:Br(o),updateId:(0,Or().Ay)()}),!i)return;const t=(0,ar().WP)(i),r=(0,ar().WP)(o);K().n4(t,r)||gr().yY(e,{origin:t,destination:r,from:o.navigationSource,action:o.navigationAction,logging_source:"mobile_native"})}}),[e,t,o,i])}(),function(){const{mobileNative:e,RouterStore:t}=(0,a().v3)(),{isIOS:n}=(0,a().Y0)(),o=(0,r.useRef)(!1),i=(0,T().O$)(Nr().A),s=(0,T().K8)((()=>"onboarding"===t.state.route.name),[t]);(0,r.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(s||Xt().sidebarOpenStore.state||Dr().A.getPreventScrollType()!==Rr().A.None?!1!==o.current&&(o.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==o.current&&(o.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,s,e,i])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,a().v3)(),n=(0,T().K8)((()=>{var e;if(!(0,Lr().T)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=m().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,Lr().T)("supportsNativeBottomBarOverlappingWebView")?Mr().A.hasOpenMobileSlideUps():Mr().A.hasOpenPopups())return!1;const r=(0,ar().Xz)(t.state),o="web"===r.type&&((null===(e=r.redirectedTo)||void 0===e?void 0:e.route)||r.route);if(!o||"page"!==o.name)return!1;const a=Tn().default.state;if("empty"===a.mode)return!1;const i=(0,Er().ZS)({multiSelection:a.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!i||0===i.stores.length)&&i.stores.every((e=>e.canComment()))}),[t]);(0,r.useEffect)((()=>{(0,Lr().T)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),(0,Gr().qh)(),(0,r.useEffect)((()=>{n.isTablet&&t&&Xt().sidebarWidthStore.setState(300)}),[n,t]);const o=(0,r.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const r=n;t&&(e.tabs[r].nativeRootPageOverrideEnabled=void 0),r!==e.activeTab?e.tabs[r].pages=[]:e.tabs[r].pages=e.tabs[r].pages.slice(-1)}))}),[]),i=(0,r.useCallback)(((t,n)=>{var r;const{mobileNative:a,TabbedRouterStore:i,currentUser:s}=e,c=m().default.state.currentSpaceStore,d=null==c?void 0:c.id;if(null!=a&&null!==(r=a.api)&&void 0!==r&&r.setCurrentSpaceInfo&&(Ae().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:d}}),a.api.setCurrentSpaceInfo({spaceId:d,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,Vr().Al)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=d&&(0,q().Xw)(d);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=K().mg(i.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==n?void 0:n.id)&&o(t),i.setState(t)}fo(e,void 0)}),[o,e]),s=(0,r.useCallback)((t=>{var n;null!==(n=e.mobileNative)&&void 0!==n&&null!==(n=n.api)&&void 0!==n&&n.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const r=!(0,Vr().Al)(e)||void 0===e.currentUser.id,{TabbedRouterStore:a}=e,i=K().mg(a.state);o(i,r),a.setState(i)}),[o,e]),c=(0,T().K8)((()=>m().default.state.currentUserStore),[]),d=(0,V().ZC)(c);(0,r.useEffect)((()=>{(null==c?void 0:c.id)!==(null==d?void 0:d.id)&&s(c)}),[s,c,d,n.isMobileNative,e.mobileNative]);const l=(0,T().K8)((()=>m().default.state.currentSpaceViewStore),[]),u=(0,V().ZC)(l);(0,r.useEffect)((()=>{(null==l?void 0:l.id)!==(null==u?void 0:u.id)&&i(l,u)}),[i,l,u,n.isMobileNative,e.mobileNative]);const p=(0,F().X)("mab_debugging");return(0,r.useEffect)((()=>{zr().tu(p)}),[p]),(0,O.jsx)(Zr,{})}function ho(){var e;if(Dr().A.getPreventScrollType()===Rr().A.None)if(Xt().sidebarOpenStore.state)Kr().A.SidebarMobileScroller&&(null===(e=Kr().A.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(Kr().A.MenuScroller){var t;null===(t=Kr().A.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(Kr().A.MenuPageScroller){var n;null===(n=Kr().A.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(Kr().A.PageScroller){var r;null===(r=Kr().A.PageScroller.getNode())||void 0===r||r.scrollTo({top:0,behavior:"auto"})}}async function bo(e,t){return t.currentUser.id===e?t:await _r().T({environment:t,newCurrentUserId:e})}async function So(e,t){let n=e;t&&(n=await bo(t,e)),await Hr().Ig(n)}function wo(e){ro().A.setState({open:!0});const{query:t}=e;t&&oo().Ay.setState({...oo().Ay.state,currentTab:"all_pages",filter:t,limit:oo().Ay.startLimit})}function yo(e){(0,Lr().T)("supportsNativeHome")&&e.device.isPhone?(yr().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Qt().quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):Qt().quickAddPage({environment:e,from:"mobile_bottom_bar"}),gr().Mq(e,{itemName:"add_page"})}function Ao(e){const t=(0,a().v3)();(0,i().l)((()=>{const{device:e,mobileNative:n}=t;if(l().cL(t),u().fD(t),n&&n.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(k().Hw6)}(0,I().ET)(t),s().hR({device:e,config:S().A,cookieService:t.cookieService}),d().g5(o().locale),(0,c().O8)(window.location.href)})),function(){const e=(0,a().v3)(),t=(0,a().Y0)();(0,r.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{b()}),h),b());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{b()}),h),b()},r=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",r),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",r)}}),[t.isMobileNative,e])}(),function(){const e=(0,r.useRef)(!1),t=(0,a().v3)(),n=(0,r.useCallback)((async e=>{if(e.currentUser.id&&ue().fJ.size>0){const t=await de().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(ue().fJ.values())}});if("success"===t.type){const{results:n}=t.data,r=new Set(ue().fJ);for(const t of n)r.delete(t.id),t.status&&(0,le().s)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),ue().u_.emit(t.id,t),fe.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||ue().fJ.delete(t.id);if(r.size>0)for(const e of r.values())ue().fJ.delete(e)}}}),[]),o=(0,T().K8)((()=>{var e;return null===(e=m().default.state)||void 0===e||null===(e=e.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),i=(0,r.useCallback)((async e=>{if(e.currentUser.id&&o){const t=await de().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:o}});if("success"===t.type){for(const e of t.data.taskIds)ue().fJ.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,o]),s=(0,r.useCallback)((()=>{const n=j().A.state.online;n&&!e.current&&i(t),e.current=n}),[t,i]);function c(e){"success"===e.state?pe().A.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?pe().A.setStatus(e.request.blockId,e.status):pe().A.setStatus(e.request.blockId,void 0)}function d(e){"success"===e.state?me().A.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?me().A.setStatus(e.request.blockId,!0):me().A.setStatus(e.request.blockId,!1)}(0,r.useEffect)((()=>{e.current=j().A.state.online;const r=setInterval((()=>n(t)),2e3);return i(t),j().A.addListener(s),fe.addListener(ce().r,c),fe.addListener(se,d),()=>{clearInterval(r),j().A.removeListener(s),fe.removeListener(ce().r,c),fe.removeListener(se,d)}}),[t,n,s,i])}(),function(){const e=(0,a().v3)(),t=(0,r.useCallback)((()=>{ge().uh(e)}),[e]);(0,r.useEffect)((()=>(t(),ve().A.addListener(t),()=>{ve().A.removeListener(t)})),[t])}(),we(),Me(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{const{device:t}=e;"external"===(0,qe().parseRoute)({url:window.location.href,isMobile:t.isMobile,baseUrl:S().A.domainBaseUrl,publicDomainName:S().A.publicDomainName,protocol:S().A.protocol,currentUrl:window.location.href}).name&&_e().ui({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,O.jsx)(U().sA,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=ze().pf({relativeUrl:ze().ZO(window.location.href),baseUrl:S().A.domainBaseUrl}),t=ze().qg(e);t.protocol=ze().qg(window.location.href).protocol,window.location.href=ze().GP(t)}}]})}),[e])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{Ve(e);const t=window.setInterval((()=>Ve(e)),$e);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{(0,Fe().setEnvironment)(e)}),[e])}(),gt(),Gt(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{an(e);const t=window.setInterval((()=>an(e)),rn().pT);return()=>window.clearInterval(t)}),[e])}(),dn(),function(){const e=(0,a().v3)(),t=(0,T().K8)((()=>mn().default.state.isLoaded),[]),n=(0,T().K8)((()=>mn().default.state.isLoggingEnabled),[]);(0,r.useEffect)((()=>{t&&async function(){const t=await(0,I().TZ)(e);await pn().n_({config:S().A,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:mn().default.state.endpoint})}()}),[e,t,n])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{const t=t=>{Ht().N6(e,t)},n=t=>{const n=(0,fn().a)(e.device),r=K().Tj(n,((n,r)=>(0,gn().A)(e,t,n)));r&&!{cut:!0,copy:!0,paste:!0}[r]&&Ht().uj(e,t,r)};return window.addEventListener("keydown",n),window.addEventListener("cut",t),window.addEventListener("copy",t),window.addEventListener("paste",t),window.addEventListener("keypress",t),()=>{window.removeEventListener("keydown",n),window.removeEventListener("cut",t),window.removeEventListener("copy",t),window.removeEventListener("paste",t),window.removeEventListener("keypress",t)}}))}(),(0,vn().A)(),In(),function(){const e=(0,a().v3)(),t=(0,a().Y0)();(0,r.useEffect)((()=>{t.isElectron&&oe().setLogglyData(Ae().clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(Ae().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{kn().GB({environment:e})}),[e])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{if(e.device.isMobile){function t(){Cn().default.afterNextFlush((()=>{xn().pS(e)}))}return Tn().default.addListener(t),Pn.addListener(t),_n().A.addListener(t),()=>{Tn().default.removeListener(t),Pn.removeListener(t),_n().A.addListener(t)}}}),[e])}(),(0,Un().A)(),(0,En().Ay)(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{if(!Rn().I.getShouldCollect())return;const t=setInterval((()=>{Rn().I.getMetrics().forEach((t=>{(0,I().u4)({environment:e,event:t})})),Rn().I.resetMetrics()}),Nn);return()=>clearInterval(t)}),[e])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,Ln().default,R().default)}),[e])}(),Mn(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{let t,n=!document.hidden;function r(){e.device.isElectron||Ee().A.setState({...Ee().A.state,isVisible:!document.hidden});const r=!document.hidden;r!==n&&(n=r,Ee().P.setState(r),clearTimeout(t),r&&(t=setTimeout((()=>{Ee().P.setState(!1)}),jn)));const o=Ce().K7(),a=o&&(Date.now()-o)/rn().nD>=7;if(e.device.isBrowser&&!document.hidden&&(!o||a)&&j().A.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;Ce().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",r),r(),()=>{document.removeEventListener("visibilitychange",r)}}),[e])}(),function(){const{defaultRecordCache:{persistedRecordCache:e}}=(0,a().v3)(),t=(0,T().K8)((()=>(null==e?void 0:e.deviceSupportsLoadPageChunk())&&H().A.state.initialRenderCompleted&&R().default.checkGate({gateName:"load_page_chunk_in_web_worker"})),[e]);(0,r.useEffect)((()=>{e&&t&&e.preloadLoadPageChunkBundle()}),[e,t])}(),function(){const{deviceType:e}=(0,a().Y0)(),t=(0,a().v3)(),n=t.currentUser.isLoggedIn();(0,r.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const r=async()=>{await oe().isMainTabOrWindow()&&de().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};r();const o=window.setInterval((()=>{r()}),5*rn().Xb);return()=>{window.clearInterval(o)}}),[n,e,t])}(),Gn(),function(){const e=(0,a().v3)(),t=(0,r.useRef)(),n=(0,r.useRef)();(0,r.useEffect)((()=>{function r(){const r=Tn().default.state,o="empty"===r.mode?void 0:r.multiSelection.start.store,a="empty"===r.mode?void 0:r.multiSelection.end.store;if(t.current===o&&n.current===a)return;if(t.current=o,n.current=a,t.current!==n.current)return;const i=Jn().wg();if(!i)return;const{rowIndex:s,columnIndex:c,simpleTableStore:d}=i.getProps();Hn().VC({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:d})}return Tn().default.addListener(r),()=>{Tn().default.removeListener(r),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,a().v3)(),t=(0,r.useCallback)((t=>{var n,r;const o={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(r=m().default.state.mainEditorCurrentBlockStore)||void 0===r?void 0:r.id})`))||void 0===n?void 0:n.type)},a={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};Ln().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...o,sub_metrics:{dns_lookup:a.dns_lookup.endTime-a.dns_lookup.startTime,connection_establish:a.connection_establish.endTime-a.connection_establish.startTime,request_queued:a.request_queued.endTime-a.request_queued.startTime,response_wait:a.response_wait.endTime-a.response_wait.startTime,response_download:a.response_download.endTime-a.response_download.startTime}}});for(const[i,{startTime:s,endTime:c}]of Object.entries(a))Ln().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${i}`,startTime:s,endTime:c},{environment:e,data:o})}),[e]);(0,r.useEffect)((()=>{const e=new PerformanceObserver((n=>{const r=n.getEntries().find((e=>e.name.includes(`${S().A.api.http}/${Zn}`)&&!e.name.endsWith("s")));r&&("resource"===r.entryType&&t(r),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),Xn(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{const t=()=>er().updateConnectionState(e);return t(),j().A.addListener(t),()=>{j().A.removeListener(t)}}),[e])}(),function(){const e=(0,a().v3)();(0,r.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,a().v3)(),t=(0,r.useRef)("none"),n=(0,r.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?Bn().A.setState({isDragging:!0}):"dragging"===n&&Bn().A.setState({isDragging:!1}))}),[]),o=(0,r.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),i=(0,r.useCallback)((()=>{n("none")}),[n]),s=(0,r.useCallback)((()=>{"touching"===t.current&&On().isExpanded(On().get())&&n("dragging")}),[n]);(0,r.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",o),window.addEventListener("touchend",i),window.addEventListener("touchcancel",i),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",o),window.removeEventListener("touchend",i),window.removeEventListener("touchcancel",i),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,o,i,s]);const c=(0,r.useCallback)((()=>{Cn().default.afterNextFlush((()=>{Dn().clearSavedSelectionXPosition()}))}),[]),d=(0,r.useCallback)((()=>{setTimeout((()=>{On().get()||Dn().clear({environment:e})}),0)}),[e]);(0,r.useEffect)((()=>(window.addEventListener("mousedown",c),e.device.isMobileBrowser&&document.addEventListener("focusout",d),()=>{window.removeEventListener("mousedown",c),document.removeEventListener("focusout",d)})),[e,c,d])}(),function(){const e=(0,T().O$)(ae().j),t=(0,F().X)("simulate_offline");(0,r.useEffect)((()=>{ie("simulate_offline_set_value_in_local_storage",(()=>{t&&void 0===e&&ae().j.setState({shouldSimulateOffline:!1,lastUpdatedTime:Date.now()})}))}),[t,e]);const n=(0,T().K8)((()=>{var e;return null===(e=ae().j.state)||void 0===e?void 0:e.shouldSimulateOffline}),[]);(0,r.useEffect)((()=>{ie("simulate_offline_update_electron_with_new_value",(async()=>{t&&"boolean"==typeof n&&(n?await oe().setNetworkEmulation({title:"Offline",requestsAllowed:"none"}):await oe().setNetworkEmulation({title:"Online (No throttling)",requestsAllowed:"all",latency:0,downloadThroughput:-1,uploadThroughput:-1}))}))}),[t,n]),(0,r.useEffect)((()=>{}),[])}(),W(),(0,_().o)(),te(),B(),function(){const e=(0,a().v3)(),t=(0,a().Y0)(),n=(0,r.useRef)(!1),o=(0,r.useCallback)((()=>{"system"===ge().lv(e)&&ve().A.emit()}),[e]),i=(0,T().K8)((()=>{var e;return null===(e=m().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,r.useLayoutEffect)((()=>{!n.current&&i&&(o(),n.current=!0)}),[i,o]),(0,r.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>o()});else{if(qn.addEventListener&&qn.removeEventListener)return qn.addEventListener("change",o),()=>{qn.removeEventListener("change",o)};if(qn.addListener&&qn.removeListener)return qn.addListener(o),()=>{qn.removeListener(o)}}}),[t.isAndroid,e,o])}(),rr(),function(){const e=S().A.isLocalhost||!1;(0,r.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?L().D6({label:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,O.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,O.jsx)(or().A,{size:"md",onDarkBackground:!0})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackStillOk\t"!==n&&"webpackWarnings"!==n||L().N2()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e])}();const n=(0,ne().kg)();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(vo,{}),t.device.isElectron&&(0,O.jsx)(Io,{}),n&&(0,O.jsx)(ko,{}),(0,O.jsx)(A,{}),(0,O.jsx)(x,{})]})}function Io(){return function(){const e=(0,a().v3)(),t=(0,U().tz)(),n=(0,T().K8)((()=>({observedWidth:Xt().sidebarSizeObserver.rect.state.width,targetWidth:Xt().sidebarWidthStore.state,isExpanded:Xt().sidebarExpandedStore.state,resizing:Xt().sidebarResizingStore.state,isMouseEntered:Xt().sidebarMouseEnteredStore.state})),[]),o=(0,T().K8)((()=>nn().A.state.open),[]),[i,s]=(0,r.useState)(!1),c=e.currentUser.isLoggedIn(),d=(0,ke().formatVersion)(oe().getDesktopVersion()),[l,u]=(0,r.useState)(void 0);(0,r.useEffect)((()=>{l&&i&&oe().windowSidebarState.set({isLoggedIn:c,...n})}),[n,c,l,i]);const p=(0,T().K8)((()=>Jt().Ay.getState().enabled),[]);(0,r.useEffect)((()=>{oe().setIsRecording(p)}),[p]),(0,r.useEffect)((()=>{let e;e=c?n.isExpanded?"expanded":"collapsed":"disabled",oe().sidebarState.set(e)}),[n.isExpanded,c]);const f=(0,T().K8)((()=>{var e,t,n;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),currentPageId:null===(n=m().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id}}),[]);(0,r.useEffect)((()=>{oe().setAppStoreState(f)}),[f]);const g=(0,r.useCallback)(((t,n,r)=>{I().vd(e,n,r)}),[e]);(0,r.useEffect)((()=>oe().track.addListener(g)),[g]);const v=(0,r.useCallback)(((t,n)=>{n.forEach((t=>{I().u4({environment:e,event:t})}))}),[e]);(0,r.useEffect)((()=>oe().trackBatched.addListener(v)),[v]);const h=(0,r.useCallback)(((e,t)=>{u(t)}),[]);(0,r.useEffect)((()=>{if(void 0===l||window.location.href.includes("blank"))return;const e=()=>{Ee().A.update((e=>({...e,isVisible:!document.hidden&&l})))};return e(),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[l]),(0,r.useEffect)((()=>(oe().isActiveTab.get().then((e=>{u(e)})),oe().isActiveTab.addListener(h))),[h]);const b=(0,r.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),en().A.setState(t)}),[]);(0,r.useEffect)((()=>{var e;return null===(e=oe().electronAppFeatures.get())||void 0===e||e.then((e=>{en().A.setState(e)})),oe().electronAppFeatures.addListener(b)}),[b]);const w=(0,r.useCallback)(((e,t)=>{tn().A.update((e=>({...e,tabs:t})))}),[]);(0,r.useEffect)((()=>oe().electronTabs.addListener(w)),[w]);const y=(0,r.useCallback)(((e,t)=>{tn().A.update((e=>({...e,currentTab:t})))}),[]);(0,r.useEffect)((()=>oe().electronCurrentTab.addListener(y)),[y]);const A=(0,r.useCallback)(((e,t)=>{tn().A.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const r=Array.from(n);return{...e,unauthorizedIframeUrls:r}}))}),[]);(0,r.useEffect)((()=>oe().setUnauthorizedIframeUrls.addListener(A)),[A]);const k=(0,r.useCallback)((t=>{Qt().setExpand({environment:e,isExpanded:!n.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,n.isExpanded]);(0,r.useEffect)((()=>oe().sidebarState.addToggleListener(k)),[k]);const C=(0,r.useCallback)(((e,t)=>{t?Qt().open({fromElectron:!0}):Qt().close()}),[]);(0,r.useEffect)((()=>oe().sidebarState.addSetSidebarOpenListener(C)),[C]);const x=(0,r.useCallback)(((e,t)=>{Xt().sidebarExpandedStore.setState(t.isExpanded),Xt().sidebarWidthStore.setState(t.targetWidth)}),[]),_=(0,r.useCallback)((e=>{nn().A.update((e=>({...e,open:!e.open})))}),[]);(0,r.useEffect)((()=>oe().tabSpacesState.addToggleMenuListener(_)),[_]);const P=(0,r.useCallback)(((e,t)=>{nn().A.update((e=>({...e,tabSpacesState:{...e.tabSpacesState,...t}})))}),[]);(0,r.useEffect)((()=>oe().tabSpacesState.addListener(P)),[P]),(0,r.useEffect)((()=>{!l&&o&&nn().A.update((e=>({...e,open:!1})))}),[l,o]),(0,r.useEffect)((()=>(oe().windowSidebarState.get().then((e=>{e&&(Xt().sidebarExpandedStore.setState(e.isExpanded),Xt().sidebarWidthStore.setState(e.targetWidth)),s(!0)})),oe().windowSidebarState.addListener(x))),[x]),(0,r.useEffect)((()=>{!async function(){if(void 0===d)return;const t=await de().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:d}});"success"!==t.type||t.data.compatible||window.location.replace(S().A.domainBaseUrl+t.data.redirect)}()}),[d,e]),(0,r.useEffect)((()=>oe().performShortcut.addListener(((t,n)=>{Ht().N6(e,n)}))),[e]);const E=(0,T().K8)((()=>{if(R().default.checkGate({gateName:"desktop_close_confirmation_dialog"})){const e=(0,Zt().getUserControlledCloseConfirmationDialogReason)();if(e)return{analytics_id:e,localized_message:t.formatMessage(Yt[e])}}}),[t]);(0,r.useEffect)((()=>{oe().setCloseConfirmationDialogReason(E)}),[E])}(),null}function ko(){return(0,ne().a1)(),null}},987264:(e,t,n)=>{n.d(t,{s:()=>o});n(296540);var r=n(474848);const o=(0,n(340498).wt)("eyes",{viewBox:"0 0 72 72",svg:(0,r.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},993893:(e,t,n)=>{n.d(t,{setupTransactionLoadGenerator:()=>c});var r=()=>n(604341),o=()=>n(606952),a=()=>n(317909),i=()=>n(351360),s=()=>n(24157);function c(e){(0,r().exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=i().default.state.mainEditorCurrentBlockStore;if(!c)return void console.info("Cannot generateTransactionLoad: No current block");const d=c.getTitleStore();if(!d)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==s().default.state.mode)return void console.info("not editing anything. Click the page title.");const l=t=>{a().createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,canUndo:!0,perform:r=>{console.info("createAndCommit #",t);for(let a=0;a<n;a++){const n=`This is transaction #${t+1}, op ${a+1}, of load started at ${u}`;o().dw({environment:e,editorMode:"default",store:d,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:r})}}})},u=new Date;if(0===r)for(let e=0;e<t;e++)l(e);else{let e=0;const n=setInterval((()=>{e<t?(l(e),e++):clearInterval(n)}),r)}}))}}}]);