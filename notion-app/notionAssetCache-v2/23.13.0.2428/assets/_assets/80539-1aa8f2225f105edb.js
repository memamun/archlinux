"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80539,84084],{346:(e,t,o)=>{o.d(t,{MG:()=>g,T1:()=>m,a1:()=>_,dt:()=>f,kg:()=>v,lC:()=>y,n_:()=>h});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(187174),s=()=>o(645873),l=()=>o(941463),c=()=>o(441199),d=()=>o(749687),u=()=>o(737230),p=()=>o(756114);const m=new(s().O2)("PerformanceToolbar",(()=>Promise.all([o.e(23806),o.e(16471),o.e(47123),o.e(17989),o.e(56985),o.e(48680),o.e(45624)]).then(o.bind(o,140401)))),g=(0,s()._h)(m,(e=>e.PerformanceToolbar)),f=(0,s()._h)(m,(e=>e.PerformanceToolbarSettings));function v(){const e=(0,r().v3)();return(0,i().K8)((()=>(0,p().D)(e,e.RouterStore.state)),[e])}function h(){const e=(0,r().v3)(),t=b("PerformanceToolbarStore"),o=b("isPerformanceToolbarVisible");return(0,i().K8)((()=>!(!t||!o)&&o(e,e.RouterStore.state,t.state)),[o,e,t])}function y(){const e=b("PerformanceToolbarStore");return(0,i().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function _(){const e=(0,r().v3)(),t=b("createPerformanceToolbarMouseListeners"),o=b("PerformanceToolbarStore"),{sidebarExpanded:a,sidebarWidth:s,secondarySidebarExpanded:p,secondarySidebarWidth:m,updateSidebarExpanded:g,updateSidebarWidth:f}=(0,i().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,n.useEffect)((()=>{if(o&&t)return t(e,(e=>o.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),a,s,p,m,g,f)}),[t,e,o,a,s,p,m,g,f])}function b(e){const t=v(),[{value:o}]=(0,a().Yb)((()=>t?m.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return o}},38e3:(e,t,o)=>{o.d(t,{$:()=>p,Q:()=>m});o(16280);var n=()=>o(179034),r=()=>o(869558),i=()=>o(44729),a=()=>o(246826),s=()=>o(317909),l=()=>o(594794),c=()=>o(972435),d=()=>o(630116),u=()=>o(435930);function p(e){const{environment:t,layoutStore:o,transaction:n,options:r}=e,{inMemoryRecordCache:s}=o,l=o.getSpaceId(),c=o.getParentPointer();if(!c||"collection"!==c.table)throw new Error("Invalid state: no collection pointer");if(!l)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const d=a().Wv({environment:t,type:"collection_view",inMemoryRecordCache:s,transaction:n});i().NI({childStore:d,parentStore:o,transaction:n});const{collectionViewStore:u}=m({environment:t,transaction:n,layoutStore:o,collectionViewBlockStore:d,options:r});return{collectionViewStore:u,collectionViewBlockStore:d}}function m(e){const{environment:t,transaction:o,layoutStore:i,collectionViewBlockStore:p,options:m}=e,{inMemoryRecordCache:g}=i,f=i.getParentPointer();if(!f||"collection"!==f.table)throw new Error("Invalid state: no collection pointer");const v=i.getSpaceId();if(!v)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const h=(0,l().JH)({environment:t,table:r().Gy,spaceId:v}),y={id:h.id,type:"page",parent_id:p.pointer.id,parent_table:n().ev,space_id:v,alive:!0,name:c().A.formatMessage(u().s.editor),format:{collection_pointer:f,hide_linked_collection_name:!0}};return null!=m&&m.viewsTabId&&(y.format={...y.format,page_layout_pointer:{...i.pointer,views_main_tab_id:m.viewsTabId}}),a().eC({environment:t,table:r().Gy,value:y,inMemoryRecordCache:g,transaction:o}),s().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listBefore",args:{id:h.id}},transaction:o}),{collectionViewStore:d().pS.createChildStore(p,h)}}},51367:(e,t,o)=>{o.d(t,{DL:()=>a,Sq:()=>l,Y5:()=>s,gc:()=>d,wo:()=>c});var n=()=>o(917629),r=()=>o(989423),i=()=>o(508496);function a(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,r().u4)({environment:e,event:{eventName:"callout_show",eventProperties:t}}),i().default.logEvent("callout_show",t.callout_key)}function s(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,r().u4)({environment:e,event:{eventName:"callout_click",eventProperties:t}}),i().default.logEvent("callout_click",t.callout_key)}function l(e,t){const o=(0,n().h2)(t.callout_key);o&&(t.placement_key=(0,n().t9)(o)),(0,r().u4)({environment:e,event:{eventName:"callout_dismiss",eventProperties:t}}),i().default.logEvent("callout_dismiss",t.callout_key)}function c(e,t){const{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:i,eligibility_timeouts:a,blocklist:s}=t;(0,r().u4)({environment:e,event:{eventName:"callout_coordinator_resolved",eventProperties:{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:i,eligibility_timeouts:a,blocklist:s}}})}function d(e,t){(0,r().u4)({environment:e,event:{eventName:"callout_feature_interaction",eventProperties:t}})}},63467:(e,t,o)=>{o.d(t,{y:()=>d});var n=()=>o(637997),r=()=>o(267419);const i={ko:()=>o.e(2268).then(o.bind(o,224434)),es:()=>o.e(95264).then(o.bind(o,196425)),de:()=>o.e(35390).then(o.bind(o,653703)),fr:()=>o.e(3272).then(o.bind(o,94677)),pt:()=>o.e(27315).then(o.bind(o,766869)),zh:()=>o.e(69945).then(o.bind(o,516814)),ja:()=>o.e(77757).then(o.bind(o,824432)),da:()=>o.e(9423).then(o.bind(o,440761)),fi:()=>o.e(59337).then(o.bind(o,462135)),nb:()=>o.e(2040).then(o.bind(o,937314)),nl:()=>o.e(51106).then(o.bind(o,530897)),sv:()=>o.e(53631).then(o.bind(o,895222))};let a=!1,s=!1;async function l(e){for(const[o,r]of Object.entries(e.emojiLocaleKeywords)){var t;n().fB[o]={...n().fB[o],keywords:[...r,...(null===(t=n().fB[o])||void 0===t?void 0:t.keywords)||[]]}}await r().A.waitUntilLoaded(),r().A.update((t=>{let{emojiByName:o,...n}=t;return{...n,emojiByName:{...o,...e.emojiByName}}}))}async function c(){if(a)return;const[e]=o(662303).locale.split("-");e in i&&(await l(await i[e]()),a=!0)}const d=(0,o(279900).A)((async()=>{await async function(){s||(await l(await o.e(51872).then(o.bind(o,443716))),s=!0)}(),await c()}))},72307:(e,t,o)=>{o.d(t,{A:()=>n});const n={appCursorListener:{sidebar:1,secondarySidebar:2,editor:3,aiChat:3,marketplace:3,teamHome:3}}},79118:(e,t,o)=>{o.d(t,{Eo:()=>y,Fz:()=>m,KI:()=>s,M4:()=>c,YW:()=>S,iY:()=>A,mO:()=>g,qE:()=>d,vm:()=>v});var n=()=>o(604995),r=()=>o(247331),i=()=>o(977345);const a=(0,o(959013).YK)({buttonAutomationCurrentUserDescription:{defaultMessage:"The user who clicked this button",id:"automations.contextValue.buttonAutomationCurrentUserDescription"},buttonAutomationCurrentUserName:{defaultMessage:"Whoever clicked",id:"automations.contextValue.buttonAutomationCurrentUserName"},buttonAutomationCurrentUserTooltip:{defaultMessage:"The person who clicked the button",id:"automations.contextValue.buttonAutomationCurrentUserTooltip"},buttonAutomationThisPageDescription:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageDescription"},buttonAutomationThisPageName:{defaultMessage:"This page",id:"automations.contextValue.buttonAutomationThisPageName"},buttonAutomationThisPageTooltip:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageTooltip"},eventAutomationCurrentUserDescription:{defaultMessage:"The user who made the edit that triggered this automation to run.",id:"automations.contextValue.eventAutomationCurrentUserDescription"},eventAutomationCurrentUserName:{defaultMessage:"Whoever triggered",id:"automations.contextValue.eventAutomationCurrentUserName"},eventAutomationCurrentUserTooltip:{defaultMessage:"The person whose action triggered this automation",id:"automations.contextValue.eventAutomationCurrentUserTooltip"},eventAutomationThisPageDescription:{defaultMessage:"The page that was edited to trigger this automation to run.",id:"automations.contextValue.eventAutomationThisPageDescription"},eventAutomationThisPageName:{defaultMessage:"Trigger page",id:"automations.contextValue.eventAutomationThisPageName"},eventAutomationThisPageTooltip:{defaultMessage:"The page that triggered this automation",id:"automations.contextValue.eventAutomationThisPageTooltip"},now:{id:"automations.triggers.now.label",defaultMessage:"Time triggered"},nowDescription:{id:"automations.triggers.now.description",defaultMessage:"The time when this automation begins to run."},nowTooltip:{id:"automations.triggers.now.tooltip",defaultMessage:"The time this automation was triggered"},pageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Page creator"},pageCreatorDescription:{id:"automations.triggers.pageCreator.description",defaultMessage:"The user who created the page that was edited to trigger this automation to run."},pageCreatorTooltip:{id:"automations.triggers.pageCreator.tooltip",defaultMessage:"Person who created page"},today:{id:"automations.triggers.today.label",defaultMessage:"Date triggered"},todayDescription:{id:"automations.triggers.today.description",defaultMessage:"The date when this automation begins to run."},todayTooltip:{id:"automations.triggers.today.tooltip",defaultMessage:"The date this automation was triggered"}});function s(){return(0,i().$y)({source:"global",global:"button_page"})}function l(e,t,o){return{description:o,name:e,tooltip:t,compile:(n,i)=>({description:o?n.formatMessage(o):void 0,id:s(),kind:r().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{collection:i,type:"block"}}),evaluate:e=>({kind:r().FormulaContextValueKind.ContextValue,id:s(),value:{type:"block",value:e}})}}const c=l(a.buttonAutomationThisPageName,a.buttonAutomationThisPageTooltip,a.buttonAutomationThisPageDescription),d=l(a.eventAutomationThisPageName,a.eventAutomationThisPageTooltip,a.eventAutomationThisPageDescription);function u(){return(0,i().$y)({source:"global",global:"current_user"})}function p(e,t,o){return{description:o,name:e,tooltip:t,compile:n=>({description:o?n.formatMessage(o):void 0,id:u(),kind:r().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{type:"person"}}),evaluate:e=>({id:u(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const m=p(a.buttonAutomationCurrentUserName,a.buttonAutomationCurrentUserTooltip,a.buttonAutomationCurrentUserDescription),g=p(a.eventAutomationCurrentUserName,a.eventAutomationCurrentUserTooltip,a.eventAutomationCurrentUserDescription);function f(){return(0,i().$y)({source:"global",global:"now"})}const v={description:a.nowDescription,name:a.now,tooltip:a.nowTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:f(),kind:r().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:f(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,n().KQ)(Date.now(),e)}})};function h(){return(0,i().$y)({source:"global",global:"today"})}const y={description:a.todayDescription,name:a.today,tooltip:a.todayTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:h(),kind:r().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:h(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,n().p6)(Date.now(),e)}})};function _(){return(0,i().$y)({source:"global",global:"page_creator"})}function b(e,t){return{description:a.pageCreatorDescription,name:e,tooltip:t,compile(o){return{description:this.description?o.formatMessage(this.description):void 0,id:_(),kind:r().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{type:"person"}}},evaluate:e=>({id:_(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const S=b(a.pageCreator,a.pageCreatorTooltip),A=b(a.pageCreator,a.pageCreatorTooltip)},103966:(e,t,o)=>{o.d(t,{Z:()=>d});var n=()=>o(496603),r=()=>o(534177),i=()=>o(416504),a=()=>o(519831),s=()=>o(79118);const l={type:"button",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,contextType:i,getRecordModel:l,intl:c}=e,d=s().Fz.compile(c),u=s().vm.compile(c),p=s().Eo.compile(c),m=t.getParentPointer();let g,f;if("button_block"===i){if(e.pageBlockModel){const t=(0,o(236162).SH)({block:e.pageBlockModel,getRecordModel:l});t&&(g=s().M4.compile(c,t.pointer),f=s().YW.compile(c))}}else if("button_property"===i){const e=l(m);if((null==e?void 0:e.table)!==a().Vl)return{error:new(o(322867).N9)(`Unable to load automation parent: ${o(696706).L3.toKey(m)}`)};g=s().M4.compile(c,e.pointer),f=s().YW.compile(c)}else(0,r().HB)(i);return{value:{valueTypes:(0,n().oE)([d,u,p,g,f])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:r,thisPageBlockModel:a}=t??{},l=a?s().M4.evaluate(a.pointer):void 0,c=null==a?void 0:a.getCreatedByPointer(),d=c?s().YW.evaluate(c):void 0,u=o?s().Fz.evaluate(o):void 0,p=(0,i().P)(),m=s().vm.evaluate(r??p),g=s().Eo.evaluate(r??p);return{value:{values:(0,n().oE)([l,d,u,m,g])}}},isAvailableForContext:e=>!0};o(944114);const c={button:l,event:{type:"event",getCreatePermissions(e){const{parentPointer:t,spacePointer:o}=e;return[{minimumRole:"editor",pointer:t,type:"record_permission"},{minimumRole:"read_and_write",pointer:o,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e,n=[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}],i=t.getTrigger();if("event"===i.type){const e=i.event;(0,r().O9)(e.source)&&"filter"!==e.source.type&&(e.source.type===a().Vl||e.source.type===o(869558).Gy?n.push({minimumRole:"reader",pointer:e.source.pointer,type:"record_permission"}):(0,r().HB)(e.source))}return n},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,intl:o}=e,r=s().mO.compile(o),i=s().iY.compile(o),l=s().vm.compile(o),c=s().Eo.compile(o),d=t.getParentPointer();let u;return d.table===a().Vl&&(u=s().qE.compile(o,d)),{value:{valueTypes:(0,n().oE)([r,i,l,c,u])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:a,thisPageBlockModel:l}=t??{},c=l?s().qE.evaluate(l.pointer):void 0,d=o?s().mO.evaluate(o):void 0,u=(0,i().P)(),p=s().vm.evaluate(a??u),m=null==l?void 0:l.getCreatedByPointer(),g=(0,r().O9)(m)?s().iY.evaluate(m):void 0,f=s().Eo.evaluate(a??u);return{value:{values:(0,n().oE)([c,d,p,f,g])}}},isAvailableForContext:e=>!0},recurrence:{type:"recurrence",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{intl:t}=e;return{value:{valueTypes:[s().vm.compile(t),s().Eo.compile(t)]}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserTimeZone:o}=t??{},n=(0,i().P)();return{value:{values:[s().vm.evaluate(o??n),s().Eo.evaluate(o??n)]}}},isAvailableForContext(e){const{automation:t,automationActions:n,hasPremiumAutomations:i}=e;if(t.parent_table===o(179034).ev)return!0;if(t.parent_table===a().Vl){const e=o(388821).RecordMap.create();for(const t of n)e.addModel(t);return!!t.isCompleteSprintAutomation({getRecordModel:o(792071).b4_.fromRecordMap(e)})||i}(0,r().HB)(t.parent_table)}}};function d(e){return c[e]}},132456:(e,t,o)=>{o.d(t,{J4:()=>w,kw:()=>A,lf:()=>k});o(16280),o(816573),o(878100),o(177936),o(748140),o(821903),o(491134),o(128845),o(237467),o(444732),o(979577),o(581454);var n=o.n(o(883503)),r=()=>o(496603),i=()=>o(720665),a=()=>o(416845),s=()=>o(628536),l=()=>o(96689);const c={version:8,notion_version:0,variant:2},d={version:8,notion_version:1,variant:2},u=0,p=1,m=6,g=8,f=10,v=Date.UTC(2024,0,1);function h(e,t){if(e)return t[u]=255,t[u+1]=240|15&t[u+1],t;const o=Math.floor(((new Date).getTime()-v)/i().nD);if(o>=4096||o<0)throw new Error("Invalid offsetInDays.");return t[u]=o>>4,t[u+1]=o<<4&240|15&t[u+1],t}function y(e,t){if(e>=2**36||e<0)throw new Error("Invalid spaceShortId.");t[p]=240&t[p]|e/2**32&15;for(let o=0;o<4;o++)t[p+1+o]=e/2**(24-8*o)&255;return t}function _(e,t){const o=e?1:0;return t[m]=c.version<<4&240|c.notion_version<<1&14|1&o,t[g]=c.variant<<6&192|63&t[g],t}function b(e,t){if("block"===e)return t[f]=(0,s().vi)(e)|63&t[f],t;const o=(0,s().vi)(e);return t[f]=o>>8&127,t[f+1]=255&o,t}function S(e,t){const o=(0,s().TG)(e);return t[f]=127&o|128&t[f],t}function A(e,t,o,n){const r=new Uint8Array(16),i=globalThis.crypto.getRandomValues(r);return o!==l().NX&&h(e,i),y(t,i),_(n,i),b(o,i),T(i)}function w(e,t,o,n){return A(e,t,o,n)}function k(e,t,o){return I(e,t,o)}function I(e,t,o){const i=n()(o),l=r().iv(i,2).map((e=>parseInt(e.join(""),16)));if((0,s().ep)(t)){if(void 0===e)throw new(a().Um)(`Deterministic ID for '${t}' must specify a space short id`)}else if(void 0!==e)throw new(a().Um)(`Deterministic ID for '${t}' should not provide a space short id`);const c=new Uint8Array(l);return e&&y(e,c),S(t,c),function(e){e[m]=240&d.version<<4|14&d.notion_version<<1|1&e[m],e[g]=192&d.variant<<6|63&e[g]}(c),T(c)}const C=new Array(256).fill(0).map(((e,t)=>t.toString(16).padStart(2,"0")));function T(e){let t=0;return C[e[t++]]+C[e[t++]]+C[e[t++]]+C[e[t++]]+"-"+C[e[t++]]+C[e[t++]]+"-"+C[e[t++]]+C[e[t++]]+"-"+C[e[t++]]+C[e[t++]]+"-"+C[e[t++]]+C[e[t++]]+C[e[t++]]+C[e[t++]]+C[e[t++]]+C[e[t++]]}},191197:(e,t,o)=>{o.d(t,{i:()=>r,z:()=>i});var n=()=>o(989423);function r(e,t){const{from:o}=t;n().vd(e,"show_tooltip",{from:o,time:Date.now()})}function i(e,t){const{from:o}=t;n().vd(e,"dismiss_tooltip",{from:o,time:Date.now()})}},198874:(e,t,o)=>{o.d(t,{l:()=>b});o(16280);var n=()=>o(584262),r=()=>o(534177),i=()=>o(896628),a=()=>o(910302),s=()=>o(44729),l=()=>o(857783),c=()=>o(185544),d=()=>o(317909),u=()=>o(780054),p=()=>o(71584),m=()=>o(989423),g=()=>o(450486),f=()=>o(351360),v=()=>o(430483),h=()=>o(77246),y=()=>o(611371),_=()=>o(825726);function b(e){try{const{pageStore:t,environment:o,duplicateTo:_,triggeredFrom:b}=e,{currentUserStore:S,currentSpaceStore:A,currentSpaceViewStore:w}=f().default.state;if(!v().zD.isFullPageTranslateEnabled())throw new Error("Invalid call to duplicateTranslatedPage: full page translate is not enabled");if(!S||!A||!w)throw new Error("Cannot duplicate translated page: missing required stores");if(!(0,y().EF)(o))throw new Error("Cannot duplicate translated page: user cannot create page");const k=h().Uv.getStateForBlock(t.id);if(!k)throw new Error("Cannot duplicate translated page: no editor mode state");if("translate_locked"!==k.mode||"active"!==k.status)throw new Error("Cannot duplicate translated page: invalid editor mode state");const I=async e=>{const{duplicateStore:r,duplicateBlockResultStatusPromise:s}=e;try{"success"===(await s).status&&(r.isLocked()&&d().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPage.unlockPage",environment:o,canUndo:!0,perform:e=>{i()._l({environment:o,store:r,isLocked:!1,transaction:e})}}),l().uK({environment:o,store:r,pageVisitSource:n().y8.SavePageTranslationCopy}),a().DL({pageStore:t,environment:o,triggeredFrom:"navigation"}))}catch(c){throw new Error("Error duplicating translated page",{cause:c})}};if((0,m().u4)({environment:o,event:{eventName:"duplicate_translated_page",eventProperties:{duplicate_to:_,triggered_from:b,page_id:t.id}}}),"parent"===_){const e=t.getParentStore();if("block"!==(null==e?void 0:e.table)&&"team"!==(null==e?void 0:e.table)&&"space"!==(null==e?void 0:e.table)&&"collection"!==(null==e?void 0:e.table))throw new Error("Cannot duplicate translated page: invalid parent store table");const n=d().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPageToParent",environment:o,canUndo:!0,perform:n=>{const[i,a]=p().duplicateBlock({environment:o,stores:[t],addCopyName:!1,transaction:n,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!t.isInsideTemplate(),targetSpaceId:A.id,baseUrl:u().A.domainBaseUrl,publicDomainName:u().A.publicDomainName,preferDuplicateLocation:"local",applyTranslationMap:k.translationMap}),l=i[0],d={type:"append",after:t.id};switch(e.table){case"team":(0,g().moveToTeamImpl)({transaction:n,currentSpaceViewStore:w,teamStore:e,targets:[l],environment:o,location:d,action:"move",value:{type:"team",id:e.id,spaceId:A.id}});break;case"block":s().NI({parentStore:e,childStore:l,transaction:n,after:d.after});break;case"space":c().yM({environment:o,spaceStore:A,spaceViewStore:w,pageStore:l,isPrivate:!0,location:d,transaction:n});break;case"collection":s().X$({childStore:l,parentStore:e,transaction:n});break;default:(0,r().HB)(e)}return{duplicateStore:l,duplicateBlockResultStatusPromise:a}}}).performResult;return I(n),n.duplicateStore}if("private_pages"===_){const e=d().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPageToPrivatePages",environment:o,canUndo:!0,perform:e=>{const[n,r]=p().duplicateBlock({environment:o,stores:[t],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!t.isInsideTemplate(),targetSpaceId:A.id,baseUrl:u().A.domainBaseUrl,publicDomainName:u().A.publicDomainName,preferDuplicateLocation:"local",applyTranslationMap:k.translationMap}),i=n[0];return c().yM({environment:o,spaceStore:A,spaceViewStore:w,pageStore:i,isPrivate:!0,location:{type:"prepend"},transaction:e}),{duplicateStore:i,duplicateBlockResultStatusPromise:r}}}).performResult;return I(e),e.duplicateStore}(0,r().HB)(_)}catch(t){(0,_().l)(t)}}},204552:(e,t,o)=>{o.d(t,{c:()=>r,x:()=>i});var n=()=>o(645873);const r=(0,n()._h)(new(n().O2)("UniversalQnaModals",(async()=>await Promise.all([o.e(23806),o.e(37353),o.e(55373),o.e(29151),o.e(16908),o.e(48315),o.e(847),o.e(5887),o.e(17989),o.e(56985),o.e(21627),o.e(82472),o.e(96345),o.e(75659),o.e(47858),o.e(51860),o.e(221),o.e(14358)]).then(o.bind(o,457974)))),(e=>e.UniversalQnaModals)),i=(0,n()._h)(new(n().O2)("SlackConnectionOptions",(async()=>await o.e(85873).then(o.bind(o,210230)))),(e=>e.SlackConnectionOptions))},279900:(e,t,o)=>{function n(e){let t,o,n;return async function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t?(n=i,o||(o=t.then((()=>(o=void 0,t=e(...n),t))),o)):(t=e(...i),t)}}o.d(t,{A:()=>n})},310109:(e,t,o)=>{o.r(t),o.d(t,{getAllContextValues:()=>h,getContextValueForActionById:()=>_,getContextValuesForAction:()=>y,typecheckAutomation:()=>f,typecheckAutomationAsync:()=>v});o(944114),o(898992),o(581454),o(737550);var n=()=>o(496603),r=()=>o(973647),i=()=>o(534177),a=()=>o(999515),s=()=>o(977345),l=()=>o(329333),c=()=>o(638458),d=()=>o(322867),u=()=>o(281994),p=()=>o(648651),m=()=>o(103966);function*g(e){const{actionModels:t,automationModel:o,contextType:g,formulasModule:f,runtimeStats:v}=e,h={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}},y=performance.now();let _,b,S;if("button_block"===g||"button_property"===g){if(!o.isButtonType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();S=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else if("event"===g){if(!o.isEventType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();S=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else if("recurrence"===g){if(!o.isRecurrenceType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();S=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else(0,i().HB)(e);if(r().Q.isFail(S))return S;h.valueTypes.push(...n().o8(S.value.valueTypes));for(const i of t){_=void 0,v&&(_=p().hs.getOrCreateAction(v,i.pointer,i.getType()));const t=(0,l().getActionRegistryItem)(i.getType());if(!t){b={error:new(d().oM)({actionId:i.id,message:`Unsupported action type: ${i.getType()}`})};break}const m=performance.now(),g=(0,c().Q)({automationModel:o,formulasModule:f,formulaValueTypes:h.valueTypes}),y=(0,u().HI)(yield*t.resolveExecutionDependencies(g,i));yield*a().q.fetchRecords(y.map((e=>e.pointer))),_&&(_.totalDependencies=y.length,_.getDependenciesDurationMs=Math.trunc(performance.now()-m));const S=t.typecheck(e,i),A=n().o8(h.valueTypes);if(h.actionInputValueTypes[i.id]=A,r().Q.isFail(S)){b=S;break}for(const e of S.value.valueTypes??[]){h.valueTypes.some((t=>(0,s().oH)(e,t)))||h.valueTypes.push(e)}S.value.validationFailures&&S.value.validationFailures.length>0&&(h.actionValidationFailures[i.id]=S.value.validationFailures)}const A=Math.trunc(performance.now()-y);return v&&(v.typecheckStartTime=y,v.typecheckDurationMs=A,v.typecheckSuccess=!(0,i().O9)(b)),b??{value:h}}function f(e){return a().q.runSync(e.getRecordModel,g(e))}async function v(e){return await a().q.runAsync(e.loadRecordModel,g(e))}function h(e){return r().Q.isFail(e)?[]:e.value.valueTypes.slice(0)}function y(e,t){return r().Q.isFail(e)?[]:e.value.actionInputValueTypes[t]??[]}function _(e,t,o){const n=y(e,t);return(0,s().IV)(n,o)}},332390:(e,t,o)=>{o.d(t,{C7:()=>M,Yf:()=>R,k8:()=>x,lN:()=>E,oG:()=>U});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(700500),s=()=>o(130382),l=()=>o(959013),c=()=>o(534177),d=()=>o(191197),u=()=>o(953006),p=()=>o(68465),m=()=>o(231722),g=()=>o(792002),f=()=>o(465425),v=()=>o(51367),h=()=>o(301421),y=()=>o(351360),_=()=>o(411671),b=()=>o(630116),S=()=>o(24157),A=()=>o(576590),w=()=>o(656633),k=()=>o(972911),I=o(474848);const C=1,T=1,P=(0,l().YK)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function M(){const e=(0,r().v3)(),t=function(){const e=(0,r().v3)(),t=(0,i().K8)((()=>{var e;return null===(e=y().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),o=(0,i().K8)((()=>{const t=y().default.state.mainEditorCurrentBlockStore;return t&&_().A.getMode(e,t)}),[e]);return(0,i().K8)((()=>{if(e.device.isMobile)return;const{currentUserSettingsStore:n,inAppCalloutStore:r}=y().default.state;if(!r.getCalloutVisibility("ai_onboarding_tooltip").canShow)return;const i=null==n?void 0:n.getSettings();if(!i)return;if((0,c().O9)(i.last_used_ai_writer_at))return;if("tooltip"!==i.ai_assistant_onboarding_phase)return;if((0,w().vp)(e,t)){if(!(0,c().O9)(i.ai_sales_assisted_extra_notification_seen_at)||(0,s().Mn)(i.ai_sales_assisted_extra_notification_seen_at)<T)return}else if((0,c().O9)(i.ai_assistant_onboarding_phase_last_set_at)&&(0,s().Mn)(i.ai_assistant_onboarding_phase_last_set_at)<C)return;if("space_for_ai"!==(0,k().V7)())return;if(!(0,p().ZE)(o))return;const l=S().default.state;if("editing"===l.mode){const e=(0,m().H7)(l.multiSelection);if(e&&(0,g().gE)(e.selection)){const t=e.store,o=h().n.findEditableWithStore(t);if(o){const e="block"===t.pointer.table?b().Bv.createChildStore(t,t.pointer):void 0,n=e&&e.getType(),r=Boolean(n&&(0,a().ZW)(n)),i=t.getValue();if(r&&!i)return o}}}}),[e,o,t])}(),[o,d]=(0,n.useState)(!1),f=(0,n.useCallback)((()=>{d(!0)}),[]),v=!o&&Boolean(t);return(0,n.useEffect)((()=>()=>{v&&(0,k().ZI)(e)}),[e,v]),v&&t?(0,I.jsx)(u().k,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,I.jsx)(l().sA,{...P.spaceForAiHeader}),content:(0,I.jsx)(l().sA,{...P.spaceForAiContent}),onCloseClick:f}):null}function x(e){const{originRef:t,openState:o}=e,a=(0,r().v3)(),s=(0,i().K8)((()=>(0,k().V7)()),[]),[c,d]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{d(!0)}),[]),m="ask_ai_anything"===s&&"initialPrompt"===o.stage&&!c;return(0,n.useEffect)((()=>()=>{!a.device.isMobile&&m&&(0,k().ZI)(a)}),[a,m]),a.device.isMobile||!m?null:(0,I.jsx)(u().k,{origin:t,placementToOrigin:"top",header:(0,I.jsx)(l().sA,{...P.askAiAnythingHeader}),content:(0,I.jsx)(l().sA,{...P.askAiAnythingContent}),onCloseClick:p})}function E(e){const{originRef:t,openState:o,isInputEmpty:a}=e,s=(0,r().v3)(),c=(0,i().K8)((()=>(0,k().V7)()),[]),[d,p]=(0,n.useState)(!1),m=(0,n.useCallback)((()=>{p(!0)}),[]),g="refine_ai_response"===c&&"results"===o.stage&&!o.loading&&"cursor"===o.context.type&&a&&!d;return(0,n.useEffect)((()=>()=>{!s.device.isMobile&&g&&(0,k().ZI)(s)}),[s,g]),s.device.isMobile?null:(0,I.jsx)(u().k,{origin:g?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,I.jsx)(l().sA,{...P.refineAiResponseHeader}),content:(0,I.jsx)(l().sA,{...P.refineAiResponseContent}),onCloseClick:m})}function R(e){const{origin:t}=e,o=(0,r().v3)();(0,n.useEffect)((()=>{d().i(o,{from:"qna_button"}),v().DL(o,{callout_key:"ai_assistant_origin_element_tooltip",placement_key:"Tooltip"})}),[o]);const i=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=y().default.state;e&&(d().z(o,{from:"qna_button"}),v().Sq(o,{callout_key:"ai_assistant_origin_element_tooltip",dismiss_type:"tooltip_dismiss",placement_key:"Tooltip"}),(0,A().setQnaOnboardingPhase)(o,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}),f().a(o,"ai_assistant_origin_element_tooltip"))}),[o]);return(0,I.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,I.jsx)(l().sA,{...P.showAssistantOriginElementLocationHeader}),content:(0,I.jsx)(l().sA,{...P.showAssistantOriginElementLocationContent}),onCloseClick:i})}function U(e){const{origin:t}=e,o=(0,r().v3)();(0,n.useEffect)((()=>{d().i(o,{from:"qna_search"})}),[o]);const i=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=y().default.state;e&&(d().z(o,{from:"qna_search"}),(0,A().setQnaOnboardingPhase)(o,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[o]);return(0,I.jsx)(u().k,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,I.jsx)(l().sA,{...P.showAssistantLocationHeader}),content:(0,I.jsx)(l().sA,{...P.showAssistantLocationContent}),onCloseClick:i})}(0,o(466103).exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=y().default.state;t&&o(317909).createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,canUndo:!0,perform:e=>{o(755199).mJ({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},348792:(e,t,o)=>{o(16280),o(944114),o(898992),o(354520),o(672577),o(803949),o(581454),o(737550),o(814603),o(147566),o(198721);var n=()=>o(466103),r=()=>o(700500),i=()=>o(604995),a=()=>o(80979),s=()=>o(416504),l=()=>o(402390),c=()=>o(436604),d=()=>o(212547),u=()=>o(696706),p=()=>o(912720),m=()=>o(179034),g=()=>o(628536),f=()=>o(234459),v=()=>o(798880),h=()=>o(245241),y=()=>o(919709),_=()=>o(973647),b=()=>o(534177),S=()=>o(683259),A=()=>o(251582),w=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(823215),()=>o(496603)),k=()=>o(510818),I=()=>o(970013),C=()=>o(236162),T=()=>o(792071),P=()=>o(185078);function M(e){return e.every((e=>{const t="element"===e.type&&["annotation","mention","equation"].includes(e.tagName);return"text"===e.type||t}))}function x(e){return!!e&&"element"===e.type&&"block"===e.tagName}function E(e){return e.every((e=>"element"===e.type&&("block"===e.tagName||"text"===e.tagName||"property"===e.tagName)))}function R(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=T().Bj6.fromBlock(o),a=(0,S().vy)({textValue:i.getProperty("title"),exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,k().Pm)(e)})});if(0===a.length&&0===i.getContentLength()&&"page"!==i.getType())return;const s=e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type});if(!M(a))throw new Error("Delineated text node children are invalid");const l={type:"element",tagName:"text",attributes:{},children:a},c={type:"element",tagName:"block",attributes:{id:s.toString()},children:[l]};if(i.getContentLength()>0){const e=n.visitedBlockIds??new Set,t=w().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,S().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!E(t))throw new Error("Block simple XML node children are invalid");c.children.push(...t)}if("page"===i.type&&o.properties){const t=(0,C().zN)({getRecordValue:n.getRecordValue,block:o});if(t&&t.schema)for(const[i,a]of Object.entries(t.schema)){var d;const s=(null===(d=o.properties[i])||void 0===d?void 0:d.toString())??"";a&&s&&i in o.properties&&"text"===a.type&&c.children.push(Q(e,i,s,n,r,{parentCollectionId:t.id,propertyId:i}))}}return c}}function U(e){return async(t,o)=>{if(n=t.block,!["page","text","header","sub_header","sub_sub_header","quote","bulleted_list","toggle","to_do","numbered_list","callout"].includes(n.type))return;var n;return await Promise.resolve(R(e)({...t,block:t.block}))}}function B(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=T().Bj6.fromBlock(o),a={type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:[]};if(i.getContentLength()>0){const e=n.visitedBlockIds||new Set,t=w().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,S().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!E(t))throw new Error("Block simple XML node children are invalid");a.children.push(...t)}return a}}function O(e){return async(t,o)=>{if(n=t.block,!["transclusion_container","column","column_list","table_row"].includes(n.type))return;var n;return await Promise.resolve(B(e)({...t,block:t.block}))}}function N(e){const{block:t,exportArgs:o,renderers:n}=e,r=T().Bj6.fromBlock(t),i=r.getTransclusionReferenceTargetPointer();if(!i)return;const a=o.visitedBlockIds||new Set;return a.has(i.id)?void 0:(0,S().g8)({exportArgs:{...o,blockId:i.id,renderParentBlockId:r.id,visitedBlockIds:a.add(i.id)},renderers:n})}function V(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=T().Bj6.fromBlock(o),a=(0,S().vy)({textValue:i.getProperty("caption"),exportArgs:n,renderers:r,fromString:e=>({type:"text",value:e})}),s=e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type});if(!M(a))throw new Error("Delineated text node children are invalid");const l={type:"element",tagName:"text",attributes:{},children:a};return{type:"element",tagName:"block",attributes:{id:s.toString()},children:[l]}}}function L(e){return async(t,o)=>{if(n=t.block,!["image","video"].includes(n.type))return;var n;return await Promise.resolve(V(e)({...t,block:t.block}))}}function D(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=T().Bj6.fromBlock(o),a={type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:[]};if(i.getContentLength()>0){const e=n.visitedBlockIds||new Set,t=w().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,S().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!E(t))throw new Error("Block simple XML node children are invalid");a.children.push(...t)}return a}}function F(e){return async(t,o)=>{if(!function(e){return"table"===e.block.type}(t))return;return await Promise.resolve(D(e)(t))}}function $(e){return async(t,o)=>await Promise.resolve(j(e)(t))}function j(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=T().Bj6.fromBlock(o),a=i.getProperties(),s=w().oE(Object.keys(a).map((t=>{const o=i.getProperty(t);if(!o)return;const a=(0,S().vy)({textValue:o,exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,k().Pm)(e)})});if(!M(a))throw new Error("Property children are invalid");return{type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:t}).toString()},children:a}})));if(!s.length)return;return{type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:s}}}function H(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),{date_format:r,time_format:i,...a}=y().K7D(o),s="date"===(l=a).type?l.start_date:"daterange"===l.type?`${l.start_date} -> ${l.end_date}`:"datetime"===l.type?`${l.start_date} ${l.start_time}`:"datetimerange"===l.type?`${l.start_date} ${l.start_time} -> ${l.end_date} ${l.end_time}`:void(0,b().HB)(l);var l;return{type:"element",tagName:"mention",attributes:{id:n.toString()},children:[{type:"text",value:s}]}}}function q(e){const{children:t}=e;return t}function G(e){return async function(t){let{block:o,exportArgs:n,renderers:r}=t;const i=e.mapBlockOrAnnotation({type:"block",id:o.id,blockType:o.type}),a=await Promise.resolve((0,S().ki)({blockModel:T().Bj6.fromBlock(o),exportArgs:n,includeEmptyCollection:!0}));if(!a||!a.length)return;const s=a[0],{collectionTitle:l,columnIds:c,collectionDescription:d,columnIdToName:u,collectionId:p,collectionSpaceId:m,schema:g}=s,f=l?K(e,{collectionId:p,type:P().kl.NAME,collectionSpaceId:m},l,n,r):void 0,v=d?K(e,{collectionId:p,type:P().kl.DESCRIPTION,collectionSpaceId:m},d,n,r):void 0,h=[];for(const b of a){const{collectionViewName:t,collectionViewId:o,collectionViewSpaceId:i}=b;if(!t)continue;const a=t?K(e,{collectionId:p,type:P().kl.VIEW_NAME,collectionViewId:o,collectionSpaceId:m,collectionViewSpaceId:i},t,n,r):void 0;a&&h.push(a)}const y=[],_=w().oE(c.map((t=>{var o;const i=u[t];if(!i)return;const a=(0,S().vy)({textValue:[[i,[]]],exportArgs:n,renderers:r,fromString:e=>({type:"text",value:"string"==typeof e?(0,k().Pm)(e):""})});if(!M(a))throw new Error("Property children are invalid");const s={collectionId:p,type:P().kl.SCHEMA_PROPERTY_NAME,collectionSpaceId:m,propertyId:t,oldValue:i,propertySchemaType:null===(o=g[t])||void 0===o?void 0:o.type},l={type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:W(s),metadata:s}).toString()},children:a},c=g[t];return c&&(0,I().DQ)(c)&&c.options&&y.push(...c.options.map((o=>K(e,{collectionId:p,type:P().kl.SCHEMA_PROPERTY_OPTION,propertyId:t,optionId:o.id,optionColor:(0,I().lx)(c)?o.color:void 0,collectionSpaceId:m,oldValue:o.value,propertySchemaType:c.type},o.value,n,r)))),l})));return{type:"element",tagName:"block",attributes:{id:i.toString()},children:[...f?[f]:[],...h,...v?[v]:[],..._,...y]}}}function Q(e,t,o,n,r,i){const a=(0,S().vy)({textValue:[[o,[]]],exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,k().Pm)(e)})});if(!M(a))throw new Error("Delineated text node children are invalid");return{type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:t,metadata:i}).toString()},children:a}}function W(e){const{type:t,propertyId:o,optionId:n,optionColor:r,collectionViewId:i}=e;switch(t){case P().kl.NAME:return"collection.name";case P().kl.VIEW_NAME:return`collection.view_name.${i}`;case P().kl.DESCRIPTION:return"collection.description";case P().kl.SCHEMA_PROPERTY_NAME:return`collection.property.${o}`;case P().kl.SCHEMA_PROPERTY_OPTION:return`collection.option.${o}.${n}${r?`.${r}`:""}`;default:(0,b().HB)(t)}}function K(e,t,o,n,r){return Q(e,W(t),o,n,r,t)}function z(){throw new Error("unimplemented")}function J(){}function Y(e){const t=R(e),o=B(e),n=V(e),r=D(e),i=j(e),a=function(e){return t=>{const{annotation:o,children:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});if(!n)return;if(!function(e){return"text"===e.type||"element"===e.type&&("annotation"===e.tagName||"mention"===e.tagName||"equation"===e.tagName)}(n))throw new Error("Annotation simple XML node children are invalid");const i=[n];return{type:"element",tagName:"annotation",attributes:{id:r.toString()},children:i}}}(e),s=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=T().b4_.fromGetRecordValueFn(n.getRecordValue),i=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),a=y().v55(o);let s="Untitled page";return r({table:m().ev,id:a})&&(s=(0,S()._z)({intl:n.intl,blockId:a,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone})),{type:"element",tagName:"mention",attributes:{id:i.toString()},children:[{type:"text",value:s}]}}}(e),l=function(e){return t=>{const{annotation:o,exportArgs:{intl:n,getRecordValue:r}}=t,i=T().b4_.fromGetRecordValueFn(r),a=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),s=y().NcG(o),l=i({table:v().oo,id:s});let c=null==l?void 0:l.getFullName(n);return c||(c="Tim Smith"),{type:"element",tagName:"mention",attributes:{id:a.toString()},children:[{type:"text",value:c}]}}}(e),c=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});let i=(0,S().Pf)({annotation:o,exportArgs:n});return i||(i="Employee group"),{type:"element",tagName:"mention",attributes:{id:r.toString()},children:[{type:"text",value:i}]}}}(e),d=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});let i=(0,S().nZ)({annotation:o,exportArgs:n});return i||(i="Employee team"),{type:"element",tagName:"mention",attributes:{id:r.toString()},children:[{type:"text",value:i}]}}}(e),u=function(e){return t=>{var o;const{annotation:n,exportArgs:{getRecordValue:r}}=t,i=e.mapBlockOrAnnotation({type:"annotation",annotation:n}),a=T().b4_.fromGetRecordValueFn(r),s=y().T$c(n),l=(null===(o=a({table:m().ev,id:s}))||void 0===o?void 0:o.getFormatValue("original_url"))??"https://example.com";return{type:"element",tagName:"mention",attributes:{id:i.toString()},children:[{type:"text",value:l}]}}}(e),p=function(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),r=y().q1R(o).href;return{type:"element",tagName:"mention",attributes:{id:n.toString()},children:[{type:"text",value:r}]}}}(e),g=H(e),f=function(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),r=y().U35(o);return{type:"element",tagName:"equation",attributes:{id:n.toString()},children:[{type:"text",value:r}]}}}(e),h=function(e){return G(e)}(e),_=function(e){return async function(t){return G(e)({...t,block:{...t.block,type:"collection_view"}})}}(e),b={...{page:t,text:t,header:t,sub_header:t,sub_sub_header:t,quote:t,bulleted_list:t,toggle:t,to_do:t,numbered_list:t,callout:t,image:n,video:n,transclusion_container:o,transclusion_reference:N,column:o,column_list:o,table:r,table_row:i},...{code:J,embed:J,bookmark:J,file:J,tweet:J,maps:J,gist:J,framer:J,invision:J,mixpanel:J,drive:J,figma:J,loom:J,pdf:J,typeform:J,codepen:J,audio:J,divider:J,equation:J,collection_view:J,collection_view_page:J,factory:J,copy_indicator:J,breadcrumb:J,link_to_collection:J,link_to_page:J,table_of_contents:J,whimsical:J,miro:J,abstract:J,sketch:J,excalidraw:J,replit:J,alias:J,external_object_instance:J,tab:J,hex:J,deepnote:J,external_object_instance_page:J,button:J,ai_block:J,drawing:J,slide:J,personal_home_page:J,form:J,post:J,workflow:J,encrypted_text:J,transcription:J,person_profile:J}},A={...{page:U(e),text:U(e),header:U(e),sub_header:U(e),sub_sub_header:U(e),quote:U(e),bulleted_list:U(e),toggle:U(e),to_do:U(e),numbered_list:U(e),callout:U(e),image:L(e),video:L(e),transclusion_container:O(e),transclusion_reference:async e=>{const t=function(e){return"transclusion_reference"===e.type}(e.block)?e.block:void 0;if(t)return await Promise.resolve(N({...e,block:t}))},column:O(e),column_list:O(e),table:F(e),table_row:$(e),collection_view:h,collection_view_page:_},...{image:z,video:z,code:z,embed:z,bookmark:z,file:z,tweet:z,maps:z,gist:z,framer:z,invision:z,mixpanel:z,drive:z,figma:z,loom:z,pdf:z,typeform:z,codepen:z,audio:z,divider:z,equation:z,factory:z,copy_indicator:z,breadcrumb:z,link_to_collection:z,link_to_page:z,table_of_contents:z,transcription:z,whimsical:z,miro:z,abstract:z,sketch:z,excalidraw:z,replit:z,alias:z,external_object_instance:z,tab:z,hex:z,deepnote:z,external_object_instance_page:z,button:z,ai_block:z,drawing:z,slide:z,personal_home_page:z,form:z,post:z,workflow:z,encrypted_text:z,person_profile:z}};return{blockRenderers:b,annotationRenderers:{[y().Ifu.Bold]:a,[y().Ifu.Italic]:a,[y().Ifu.Strike]:a,[y().Ifu.Code]:a,[y().Ifu.Highlight]:a,[y().Ifu.Discussion]:a,[y().Ifu.Underline]:a,[y().Ifu.Link]:a,[y().Ifu.Equation]:f,[y().Ifu.Comment]:q,[y().Ifu.Page]:s,[y().Ifu.User]:l,[y().Ifu.Group]:c,[y().Ifu.Team]:d,[y().Ifu.LinkMention]:p,[y().Ifu.Date]:g,[y().Ifu.ExternalObjectInstance]:u,[y().Ifu.Inserted]:q,[y().Ifu.CustomEmoji]:J,[y().Ifu.SuggestionInsertText]:J,[y().Ifu.SuggestionRemoveText]:J,[y().Ifu.SuggestionAnnotate]:J,[y().Ifu.SuggestionUnannotate]:J,[y().Ifu.Deleted]:J,[y().Ifu.Bot]:J,[y().Ifu.TemporaryComment]:J,[y().Ifu.TemporaryCursor]:J,[y().Ifu.TemporaryEquation]:J,[y().Ifu.TemporaryPage]:J,[y().Ifu.TemporaryInput]:J,[y().Ifu.TemporarySelection]:J,[y().Ifu.TemporaryFindHighlight]:J,[y().Ifu.TemporarySelectedFindHighlight]:J,[y().Ifu.TemplateVariable]:J,[y().Ifu.FormulaPageProperty]:J,[y().Ifu.FormulaContextValue]:J,[y().Ifu.FormulaError]:J,[y().Ifu.Citation]:J,[y().Ifu.TemporaryNativeMABFilter]:J,[y().Ifu.TemporaryDictation]:J,[y().Ifu.TemporaryHighlight]:J,[y().Ifu.AssistantInstructionsCollection]:J,[y().Ifu.TemporaryCommentHighlight]:J,[y().Ifu.TemporarySuggestionUnderline]:J,[y().Ifu.GeoPoint]:J},asyncBlockRenderers:A,propertyRenderers:{title:J,text:J,select:J,multi_select:J,status:J,relation:J,rollup:J,url:J,email:J,phone_number:J,checkbox:J,person:J,number:J,date:J,file:J,formula:J,created_time:J,last_edited_time:J,created_by:J,last_edited_by:J,button:J,auto_increment_id:J,last_visited_time:J,location:J,verification:J,geo_point:J}}}o(18107),o(967357);var Z=()=>o(331119);function X(e){const{translateRenderer:t,attributes:o,expectedType:n}=e;if(!("id"in o))return{error:new Error("Expected ID attribute")};const r=parseInt(o.id);if(!(r in t.map))return{error:new Error(`Could not find ${r} in TranslateRenderer`)};const i=t.map[r];return"block"===i.type&&"block"===n?{value:{counter:r,value:{blockType:i.blockType,id:i.id}}}:"annotation"===i.type&&(0,y().Ta1)(i.annotation)&&"textAnnotation"===n||"annotation"===i.type&&(0,y().iGj)(i.annotation)&&"mentionAnnotation"===n||"annotation"===i.type&&(0,y().gir)(i.annotation)&&"equationAnnotation"===n?{value:{counter:r,value:i.annotation}}:{error:new Error(`Expected ${n}, received ${JSON.stringify(i)}.`)}}const ee=A().p.mapResult(Z().W6,(e=>({value:e.value})));function te(e){return A().p.mapResult((0,Z().U5)("text"),(t=>{const o=(0,A().$d)((0,Z().nx)("text",[ae(e),ne(e),re(e),ee]),t.children??[]);return _().Q.isFail(o),o}))}function oe(e){return A().p.mapResult((0,Z().U5)("block"),(t=>{const o=X({translateRenderer:e,attributes:t.attributes,expectedType:"block"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.mapResult((0,Z().nx)("block",[A().p.mapResult(ee,(e=>({value:[e]}))),A().p.mapResult(ae(e),(e=>({value:[e]}))),A().p.mapResult(ne(e),(e=>({value:[e]}))),A().p.mapResult(ie(e),(e=>({value:[e],metadata:e.metadata}))),A().p.mapResult(oe(e),(e=>({value:[e]}))),te(e)]),(e=>({value:e.flat()}))),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"block",blockType:o.value.value.blockType,id:o.value.value.id,children:n.value}}}))}function ne(e){return A().p.mapResult((0,Z().U5)("mention"),(t=>{const o=X({translateRenderer:e,attributes:t.attributes,expectedType:"mentionAnnotation"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.many(ee),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"mention",annotation:o.value.value,text:n.value.join("")}}}))}function re(e){return A().p.mapResult((0,Z().U5)("equation"),(t=>{const o=X({translateRenderer:e,attributes:t.attributes,expectedType:"equationAnnotation"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.many(ee),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"equation",annotation:o.value.value}}}))}function ie(e){return A().p.mapResult((0,Z().U5)("property"),(t=>{const o=(0,Z().nx)("property",[ee,ae(e),ne(e)]),n=function(e,t){if(!("key"in t))return{error:new Error("Expected key attribute")};const o=parseInt(t.key);if(!(o in e.map))return{error:new Error(`Could not find ${o} in TranslateRenderer`)};const n=e.map[o];return"property"!==n.type?{error:new Error(`Expected property, received ${JSON.stringify(n)}.`)}:{value:{counter:o,value:{key:n.key},metadata:n.metadata}}}(e,t.attributes);if(_().Q.isFail(n))return n;const r=(0,A().$d)(A().p.map(o,(e=>e)),t.children??[]);return _().Q.isFail(r)?r:{value:{type:"property",key:n.value.value.key,children:r.value,metadata:n.value.metadata}}}))}function ae(e){return A().p.mapResult((0,Z().U5)("annotation"),(t=>{const o=X({translateRenderer:e,attributes:t.attributes,expectedType:"textAnnotation"});if(_().Q.isFail(o))return o;const n=(0,Z().nx)("annotation",[ee,ae(e),ne(e)]),r=(0,A().$d)(A().p.map(n,(e=>{if(function(e){return 1===e.length}(e))return e;return[e.at(0)??""]})),t.children??[]);return _().Q.isFail(r)?r:{value:{type:"annotation",annotation:o.value.value,children:r.value}}}))}function se(e){const{annotation:t}=e;return(0,y().wmz)(t)}function le(e){const{annotation:t}=e;return(0,y().G0H)(t[1])}function ce(e){const{annotations:t,value:o}=function e(t){const o=[t.annotation],n=t.children[0];if("string"==typeof n)return{annotations:o,value:n};if("mention"===n.type)return{annotations:o,value:n};if("annotation"===n.type){const{annotations:t,value:r}=e(n);return o.push(...t),{annotations:o,value:r}}(0,b().HB)(n)}(e);return"string"==typeof o?(0,y().Ey_)(o,t):(0,y().wmz)(o.annotation,t)}function de(e){const t=[];for(const o of e.children)"string"==typeof o?t.push((0,y().Ey_)(o)):"annotation"===o.type?t.push(ce(o)):"mention"===o.type?t.push(se(o)):(0,b().HB)(o);return t}function ue(e){let t={};const o={},n=[];for(const r of e.children)"string"==typeof r?n.push((0,y().Ey_)(r)):"annotation"===r.type?n.push(ce(r)):"mention"===r.type?n.push(se(r)):"property"===r.type?o[r.key]={value:de(r),metadata:r.metadata}:"equation"===r.type?n.push(le(r)):"block"===r.type&&(t={...ue(r),...t});return{[e.id]:{value:n,blockType:e.blockType,mapping:(0,P().oQ)(e.blockType),properties:o},...t}}class pe{constructor(e){this.map=void 0,this.counter=0,this.renderers=void 0,this.hasTranslated=!1,this.renderers=Y(this),this.map=e??{}}getExportArgs(e){const{pagePointer:t,intl:n,getRecordModel:r,serverOrClientConfig:i,experimentService:a,formulasModule:l}=e;return{blockId:t.id,navigableBlockId:t.id,renderParentBlockId:void 0,root:t,numberedListCache:{},bulletedListCache:{},getExportedPathToFile:e=>"",getExportedRenderAsset:e=>"",getExportedPathToPage:e=>"",getRecordValue:r.getRecordValue,getRecordsWithParent:()=>[],userTimeZone:(0,s().P)(),intl:n,baseUrl:i.domainBaseUrl,publicDomainName:i.publicDomainBaseUrl,resultCache:new Map,regExpCache:new Map,experimentService:a,collectionFeatureGates:(0,o(670913).v)({experimentService:a,actor:void 0,spaceId:t.spaceId}),formulasModule:l}}mapPageToXML(e){if(this.hasTranslated)throw new Error("Page already loaded.");this.hasTranslated=!0;const t=this.getExportArgs(e),o=(0,S().g8)({exportArgs:t,renderers:this.renderers});if(!o||!x(o))throw new Error("Failed to render page");return o}async asyncMapPageToXML(e){if(this.hasTranslated)throw new Error("Page already loaded.");this.hasTranslated=!0;const t=this.getExportArgs(e),n=await(0,S().wL)({exportArgs:t,renderers:this.renderers,ticker:new(o(863567).D)});if(!n||!x(n))throw new Error("Failed to render page");return n}parseXMLToTranslations(e){const t=(0,A().$d)(oe(this),e);if(_().Q.isSuccess(t))return ue(t.value);throw t.error}getBlocksMissingFromTranslationMap(e){const t=Object.keys(e);return Object.values(this.map).map((e=>"block"===e.type?e.id:void 0)).filter(b().O9).filter((e=>!t.includes(e)))}mapBlockOrAnnotation(e){const t=this.counter++;return this.map[t]=e,t}}var me=()=>o(220719),ge=()=>o(545285),fe=()=>o(498212),ve=()=>o(449506),he=()=>o(276470),ye=()=>o(334261),_e=()=>o(246826),be=()=>o(72234),Se=()=>o(606952),Ae=()=>o(317909),we=()=>o(755199),ke=()=>o(813297),Ie=()=>o(780054),Ce=()=>o(862292),Te=()=>o(199058),Pe=()=>o(351360),Me=()=>o(508496),xe=()=>o(712505),Ee=()=>o(630116),Re=()=>o(148832),Ue=()=>o(502438),Be=()=>o(686594),Oe=()=>o(314648),Ne=()=>o(10984),Ve=()=>o(954220),Le=()=>o(157857),De=()=>o(698331),Fe=()=>o(972435),$e=()=>o(780865),je=()=>o(244641),He=()=>o(917629),qe=()=>o(465425);function Ge(e){const{environment:t,userAction:o,data:n}=e,r=Pe().default.state.currentUserSettingsStore;r?Ae().createAndCommit({userAction:o,environment:t,canUndo:!0,userId:r.id,perform:e=>{we().mJ({userSettingsStore:r,data:n,transaction:e})}}):console.error("Could not find current user settings")}(0,n().exposeDebugEnvironmentValue)("messages",(function(e){const t=t=>{qe().bc(e),qe().X3(e,t)};return{resetNotionCalendarOnboarding:()=>{Ge({environment:e,userAction:"debuggingHelpers.clearNotionCalendarOnboarding",data:{notion_calendar_launch_modal_phase:null,notion_calendar_launch_modal_dismissed_at:null,seen_open_in_calendar_tooltip:null}}),t("notion_calendar_launch_promo")},resetAsanaPostImportTour:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetAsanaPostImportTour",data:{seen_asana_post_import_tour:null}}),t("asana_post_import_tour")},resetFormsShareTooltip:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetFormsShareTooltip",data:{seen_forms_share_form_tooltip:null}}),t("forms_share_form_tooltip")},resetFormsAddConditionalLogicTooltip:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetFormsAddConditionalLogicTooltip",data:{seen_forms_add_conditional_logic_tooltip:null}}),t("forms_add_conditional_logic_tooltip")},resetDummyModal:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetDummyModal",data:{seen_dummy_modal:null}}),t("dummy_modal")},resetSidebarUpgradeNudge:()=>{Ge({environment:e,userAction:"sidebarUpgradeNudge.markNotificationAsDismissed",data:{dismissed_sidebar_upgrade_nudge:!1}}),t("sidebar_upgrade_nudge")},forceShowMessage:t=>{const o=(0,He().h2)(t);o?qe().UW(e,o):console.log(`Invalid static message key: ${t}`)},resetMessageExposures:()=>{qe().bc(e)},tryShowMessage:t=>{const o=(0,He().h2)(t);if(o){const t=qe().$j(e,o);t.error&&console.log(`Could not show ${o} because of ${t.error}`)}else console.log(`Invalid static message key: ${t}`)},resetMessage:t,resetLanguageSwitchPrompt:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetLanguageSwitchPrompt",data:{language_switching_prompt_dismissals:[]}}),t("language_switch_prompt")},pushOrReplaceToast:e=>{o(812182).HK(e)},resetLayoutPageEducation:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetLayoutPageEducation",data:{layout_info_panel_button_education_tooltip_dismissed_at:null,layout_builder_add_module_button_education_tooltip_dismissed_at:null}})},resetMwnFeatureModal:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetMwnFeatureModal",data:{mwn_feature_modal_dismissed_at_millis:null}}),t("mwn_feature_modal")},resetSlackEmbedAiConnectorTooltip:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetSlackEmbedAiConnectorTooltip",data:{seen_slack_embed_ai_connector_tooltip:!1}}),t("ai_slack_qna_embed_tooltip")},addDynamicCallout:t=>{qe().Ez(e,t)},resetGithubAIConnectorAnnouncement:()=>{const{currentSpaceViewStore:o}=Pe().default.state;o&&(Ae().createAndCommit({environment:e,userAction:"AiGithubAIConnectorAnnouncementModal.clearGithubAIConnectorAnnouncementSeenAt",canUndo:!0,perform:e=>{Ae().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),ai_github_ai_connector_announcement_seen_at:null}},transaction:e})}}),t("ai_github_ai_connector_announcement"))},resetJiraUniversalQnaAnnouncement:()=>{const{currentSpaceViewStore:o}=Pe().default.state;o&&(Ae().createAndCommit({environment:e,userAction:"debuggingHelpers.resetJiraUniversalQnaAnnouncement",canUndo:!0,perform:e=>{Ae().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),ai_jira_universal_qna_announcement_seen_at:null}},transaction:e})}}),t("ai_jira_universal_qna_announcement"))},advanceDaysSinceCalloutDismissal:t=>{const{messageKey:o,nDays:n}=t,{currentUserSettingsStore:r,currentSpaceViewStore:i}=Pe().default.state,a=je().c9.now().toMillis();if(r||i){if(r){const t=r.getSettings();if(t){const i=t.callout_dismissal_timestamps??[],s=new Map(i.map((e=>[e.name,e]))),l=s.get(o);l?(l.timestamp=je().c9.fromMillis(l.timestamp||a).minus({days:n}).toMillis(),Ae().createAndCommit({userAction:`debugHelpers.advanceDaysSinceCalloutDismissal(userSettings: ${o})`,environment:e,canUndo:!0,perform:e=>{we().mJ({userSettingsStore:r,transaction:e,data:{callout_dismissal_timestamps:Array.from(s.values())}})}})):console.warn(`No dismissal timestamp found for "${o}" in user settings.`)}else console.error("No user settings found!")}if(i){const t=i.getSettings();if(t){const r=t.callout_dismissal_timestamps??[],s=new Map(r.map((e=>[e.name,e]))),l=s.get(o);l?(l.timestamp=je().c9.fromMillis(l.timestamp||a).minus({days:n}).toMillis(),Ae().createAndCommit({userAction:`debugHelpers.advanceDaysSinceCalloutDismissal(spaceView: ${o})`,environment:e,canUndo:!0,perform:e=>{be().AG(i,e,{callout_dismissal_timestamps:Array.from(s.values())})}})):console.warn(`No dismissal timestamp found for "${o}" in space view settings.`)}else console.error("No space view settings found!")}}else console.error("No user settings or space view store found!")},resetAILimitNudge:()=>{Ge({environment:e,userAction:"debuggingHelpers.resetAiLimitNudge",data:{addOnLimitNotifications:null}}),t("ai_limit_nudge")},checkMessageEligibility:async t=>await qe().TD(e,t)}}));const Qe=20;async function We(e,t){const o=(0,fe().ZA)(t)||t,{inMemoryRecordCache:n,persistedRecordCache:r}=e.defaultRecordCache;let i;for(const a of n.data)if(a.pointer.id===o){console.log(`Found a ${a.pointer.table} record in the in-memory record cache:`,a.model,a.model.__IM_SORRY__getValue());const e=n.checkRecordForTemporaryData(a);if(e&&console.log("The record has been augmented by temporary data:",e),r&&(0,ge().u)(a.pointer)){const e=await r.get({pointer:a.pointer,userId:a.userId});console.log("The record is also in the persisted record cache: ",e)}i=d().ms.fromModel(a.model)}return i||console.log("Alas, no records with the id were found in the in-memory record cache."),i}function Ke(e,t){return"string"==typeof e&&"string"==typeof t?Object.keys(g().jo).includes(e)?{table:e,id:(0,fe().ZA)(t)||t}:{table:t,id:(0,fe().ZA)(e)||e}:"string"!=typeof e||t?"object"==typeof e?e:t:{table:"block",id:(0,fe().ZA)(e)||e}}function ze(e,t){if(t>Qe)return[];const o=[],n=(null==e?void 0:e.getAutomationStores())??[];o.push(...n.map((e=>Ye(e))).filter(b().O9));const r=(null==e?void 0:e.getTemplatePageStores())??[];for(const a of r){const e=a.getAutomationStore();if(e){const t=Ye(e);t&&o.push(t)}o.push(...Je(a,t+1))}const i=e.getSchema();for(const a of Object.values(i))if("button"===(null==a?void 0:a.type)&&(0,b().O9)(a.automation_id)){const t=Ye(Ee().dn.createChildStore(e,{id:a.automation_id,spaceId:e.getSpaceId(),table:p().yB}));t&&o.push(t)}return w().hS(o,(e=>u().L3.toKey(e.automation.pointer)))}function Je(e,t){if(t>Qe)return[];const o=[];{const n=e.getAutomationStore();if(n){const e=Ye(n);e&&o.push(e)}if(e.isCollectionView()){const n=e.getCollectionStore();n&&o.push(...ze(n,t+1))}}const n=e.getContentStores();for(const r of n){const e=r.getAutomationStore();if(e){const t=Ye(e);t&&o.push(t)}if(r.isCollectionView()){const e=r.getCollectionStore();e&&o.push(...ze(e,t+1))}o.push(...Je(r,t+1))}return w().hS(o,(e=>u().L3.toKey(e.automation.pointer)))}function Ye(e){if(!e)return;const t=(null==e?void 0:e.getActionStores())??[],o=null==e?void 0:e.getCreatedByPointer(),n=(null==o?void 0:o.table)===v().oo&&(null==e?void 0:e.getRecordModel(o));return n?{automation:e,actions:t,createdBy:n,parent:e.getParentBlockStore()}:void 0}(0,n().exposeDebugEnvironmentValue)("debugging",(e=>{const t=function(e){const t=async(t,o)=>{const n=Ke(t,o),r=await(0,he().e)(e,{pointer:n,version:-1,userId:e.currentUser.id});return(null==r?void 0:r.value)||void 0},n=async(t,n)=>{var i;const a=Ke(t,n),s=await(0,he().e)(e,{pointer:a,version:-1,userId:e.currentUser.id}),l=null==s?void 0:s.value;if(!l)return void console.log("Unable to find record.");const c=null===(i=(0,o(186445).ZO)())||void 0===i?void 0:i.pointer.spaceId;Ae().createAndCommit({environment:e,perform(t){const n=_e().Wv({environment:e,type:r().xd.code,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:c});Se().KY({environment:e,store:n.getBlockTitleStore(),transaction:t,value:[[JSON.stringify(l,null,2)]]}),o(899038).IA({blocks:[n],language:"JSON",transaction:t}),Se().KY({environment:e,store:n.getCaptionStore(),transaction:t,value:[[`${a.table} ${a.id}`]]}),o(797265).LE({environment:e,blocksToInsert:[n],target:Ue().default.state.stores,transaction:t,replaceEmptyTextBlock:!1})},userAction:"debuggingHelpers.editRecordJson",canUndo:!0}),console.log("Created a code block with the record source. You can make edits and, with the text cursor still in the block, use __console.updateRecordJson() to write it back to the database. Do not modify the caption.")},d=()=>{const t=Ue().default.state.stores[0];if(!(t instanceof Re().B&&t.isType(r().xd.code)))return void console.log("No code block is selected!");const o=(e=>{try{return JSON.parse(e)}catch(t){return void console.error(t)}})((0,y().q4_)(t.getTitleValue()));if(!o)return void console.log("Unable to parse JSON in selected code block.");const[n,i]=(0,y().q4_)(t.getCaptionStore().getValue()).split(" ");if(!n||!i)return void console.log("Unable to parse record pointer in caption.");const a=Ke(n,i);Ae().createAndCommit({environment:e,perform(n){const r=(0,Ee().Oo)(t,a);if(r instanceof Re().B){const t=o.properties;if(t){delete o.properties;const i=t.title;i&&Se().KY({environment:e,store:r.getBlockTitleStore(),value:i,transaction:n}),delete t.title,Ae().applyOperation({store:r,operation:{pointer:r.pointer,path:["properties"],command:"update",args:t},transaction:n})}}Ae().applyOperation({store:r,operation:{pointer:r.pointer,path:[],command:"update",args:o},transaction:n})},userAction:"debuggingHelpers.updateRecordJson",canUndo:!0}),console.log(`Updated ${n} ${i}. Press Cmd-Z (in Notion, not console) to undo.`)},u=async()=>{var t,o;const n=null===(t=Pe().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),r=null===(o=Pe().default.state.currentUserStore)||void 0===o?void 0:o.userId;if(!n||!r)return;const i=await(0,Ve().fetchUserSignals)({spaceId:n,environment:e});void 0!==i&&(0,Ve().setUserSignals)({spaceId:n,userId:r,environment:e,newSignals:i,initialize:!1})},_=()=>{var e,t;const o=null===(e=Pe().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId(),n=null===(t=Pe().default.state.currentUserStore)||void 0===t?void 0:t.userId;if(!o||!n)return;const r=Oe().default.getUserSignals({spaceId:o,userId:n});return r?Oe().USER_SIGNALS_KEYS.map((e=>[e,("similarUserRecentPages"===e?Array.from(Object.values(r[e])):r[e]).map((e=>{let{pageId:t,...o}=e;return{...o,pageId:t,page:k(m().ev,t)}}))])):void 0},S=(t,o)=>{var n;const r=Ke(t,o),i=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});if(void 0===(null==i?void 0:i.value))return`${r.table}: ${r.id}`;const a="type"in i.value?i.value.type:r.table;return"name"in(null==i?void 0:i.value)?`${a} ${i.value.id} ${i.value.name}`:"properties"in(null==i?void 0:i.value)&&(0,b().O9)(i.value.properties)&&"title"in i.value.properties&&(0,b().O9)(null==i?void 0:i.value.properties.title)?`${a} ${i.value.id} ${i.value.properties.title.join(" ").slice(0,30)}`:`${a} ${null==i||null===(n=i.value)||void 0===n?void 0:n.id}`},A=(t,o)=>{const n=Ke(t,o);return e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:n,userId:e.currentUser.id})},k=(e,t)=>{const o=Ke(e,t),n=A(e,t),r={title:S(e,t),raw:null==n?void 0:n.value,parent:void 0,id:o,children:[]};var i,a;void 0!==(null==n?void 0:n.value)&&"parent_table"in(null==n?void 0:n.value)&&"parent_id"in(null==n?void 0:n.value)&&n.value.parent_id&&(r.parent=Ke(null===(i=n.value)||void 0===i?void 0:i.parent_id,null===(a=n.value)||void 0===a?void 0:a.parent_table));if(null!=n&&n.value&&"content"in(null==n?void 0:n.value)){var s;const e=(null==n||null===(s=n.value)||void 0===s?void 0:s.content)||[];for(const t of e){const e=Ke(t,"block"),n=A(t,"block"),i={title:S(t,"block"),raw:null==n?void 0:n.value,parent:o,id:e,children:[]};r.children.push(i)}}return r},I=()=>{var e;const t=null===(e=E())||void 0===e?void 0:e.id;if(t)return k(t,"block");console.error("Not opening")},C=(e,t)=>`${Ie().A.adminUrl}/__admin/${e}/${t}`,T=(e,t)=>{window.open(C(e,t))},P=()=>{if(0!==Ue().default.state.stores.length)return Ue().default.state.stores.forEach((e=>{T(m().ev,e.id)}));console.error("No selected block")},M=()=>{Pe().default.state.currentSpaceStore?T(o(96689).NX,Pe().default.state.currentSpaceStore.id):console.error("No current space")},x=()=>{var e;const t=null===(e=E())||void 0===e?void 0:e.id;t?T(m().ev,t):console.error("Not opening")},E=()=>xe().default.state.open?(console.warn("Returning peek view page, if you want the underlying page, please close it and try again"),xe().default.state.targetStore):Pe().default.state.mainEditorCurrentBlockStore?Pe().default.state.mainEditorCurrentBlockStore:void console.error("No current mainEditorCurrentBlockStore"),R=t=>{if(!t.isTabbedPageLayout())return void console.error("Current layout is not a tabbed page layout, make it tabbed before using this function to add duplicate content tab");const n=t.getViewsModuleCollectionViewBlockStore();if(!n)return void console.error("No collection view block store found");const r=`view_tab_duplicate_${(0,o(138854).NE)()}`;Ae().createAndCommit({userAction:"debuggingHelpers.addDuplicateContentTabToCurrentLayout",environment:e,canUndo:!0,perform(i){(0,o(38e3).Q)({environment:e,layoutStore:t,transaction:i,collectionViewBlockStore:n,options:{viewsTabId:r}})}})},U=()=>{var t;if(!Pe().default.state.mainEditorCurrentBlockStore)return void console.error("No current mainEditorCurrentBlockStore");const o=Pe().default.state.mainEditorCurrentBlockStore.getAssociatedCollectionStore()||Pe().default.state.mainEditorCurrentBlockStore.getCollectionStore();if(!o)return void console.error("Cannot find collection store to remove Page sections from");const n=o.getFormat(),r=((null===(t=n.property_visibility)||void 0===t?void 0:t.filter((e=>"section"===e.visibility)))||[]).map((e=>e.property));Ae().createAndCommit({userAction:"debuggingHelpers.addRelationsGroupModuleToCurrentLayout",environment:e,canUndo:!0,perform(t){ye().LK({store:o,pageSectionFormats:[],transaction:t,environment:e}),r.forEach((e=>{ye().D7({property:e,visibility:"show",store:o,format:n,transaction:t})}))}})},B=t=>{const{visibility:o,section:n}=t,r=Pe().default.state.mainEditorCurrentBlockStore;if(!o||!n)return void console.error("No visibility or section provided");if(!r)return;const i=r.getAssociatedCollectionStore()||r.getCollectionStore(),a=(null==i?void 0:i.getFormat())||r.getFormat();ye().OD({environment:e,store:i||r,pageSection:n,visibility:o,format:a})},O=()=>{var e,t;const o=null===(e=E())||void 0===e?void 0:e.getCreatedById(),n=null===(t=E())||void 0===t?void 0:t.getCreatedByTable();if(o&&n)return A(o,n);console.error("no created_by_id or created_by_table for this page")},N=()=>{var e;const t=O(),o=null==t||null===(e=t.value)||void 0===e?void 0:e.id;o?T(v().oo,o):console.error("no current page Creator, not opening")},V=function(t){var o;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;const a="string"==typeof t?{query:{text:t,filters:(0,h().N2)(),sort:{field:"relevance"}},limit:20,debug:n}:t;return{environment:e,input:a,spaceId:null===(o=Pe().default.state.currentSpaceStore)||void 0===o?void 0:o.id,publicAccessPermissionAncestorBlockId:$e().Er(e).publicAccessPermissionAncestorBlockId,searchExperimentOverrides:i,forcedClusterPattern:r,source:"debugging"}},L=async function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i="string"==typeof t?{query:{text:t,filters:(0,h().N2)(),sort:{field:"relevance"}},limit:20,debug:o}:t,a=Pe().default.state.currentSpaceStore,{query:s,limit:l}=i;if(!a)return;const c=ve().callApi({eventName:"search",environment:e,data:{type:h().Vz.CollectionsInSpace,query:s.text.trim(),spaceId:a.id,limit:l,filters:h().N2({excludeTemplates:!0,requireEditPermissions:!0}),sort:{field:"relevance"},debug:o,searchExperimentOverrides:r,forcedClusterPattern:n}}),d=await c;return"success"===d.type?d.data:d},D={id:"root0000-0000",table:"block"},F=e=>{var t;if(void 0!==(null==e||null===(t=e.value)||void 0===t?void 0:t.parent_id))return Ke(e.value.parent_id,e.value.parent_table)},$=e=>{const t=new(o(795727).A);e.map((e=>{const o=Ke(e.id,e.table),n=S(e.id,e.table),r=A(e.id,e.table),i={title:n,parent:F(r),id:o,raw:null==r?void 0:r.value,children:[]};t.set(o,i)}));const n={title:"root",parent:void 0,id:D,raw:void 0,children:[]};return e.map((e=>{const o=Ke(e.id,e.table),r=t.get(o);var i;void 0!==(null==r?void 0:r.parent)&&t.has(r.parent)?null===(i=t.get(r.parent))||void 0===i||i.children.push(r):void 0!==r?n.children.push(r):n.children.push({title:"Failed to load Record",parent:void 0,id:o,raw:void 0,children:[]})})),n},j=()=>{if(!Me().default.isStatsigEnabled())throw new Error("Failed to override: Statsig not enabled");if(!Be().A.isInitialized())throw new Error("Failed to override: Statsig not initialized")},H=()=>{var e;return null===(e=E())||void 0===e?void 0:e.getSpaceId()},q=()=>{var e;return null===(e=Pe().default.state.currentUserStore)||void 0===e?void 0:e.id},G=async t=>{const o=H(),n=q(),r=`${"production"}-main-usw2-0001`,i=await ve().callApi({eventName:"getSpacesInitial",environment:e,data:{},headers:{[c().tx]:r}});if(o&&n&&"success"===i.type){const e=i.data.fanoutData,t=(null==e?void 0:e.filter((e=>{let{request:t}=e;return t.users[n].some((e=>{let{spaceId:t}=e;return t===o}))})))||[];return t.length>0?t[0].headers[c().tx]:void 0}},Q=()=>{const e=E();if(e)return Je(e,0)},W=()=>{var t;const n=null===(t=Pe().default.state.currentSpaceStore)||void 0===t?void 0:t.id,r=e.currentUser.id;if(n&&r)return(0,o(90634).hj)({spaceId:n,userId:r})},K=async(t,n)=>{const r=await Ce().T.formulas.load(),i=E(),a=null==i?void 0:i.getModel();if(!i||!a||!a.isPageBlock())return;const c=i.getRecordModel,d=i.getRecordRole,u=c({id:t,spaceId:i.getSpaceId(),table:p().yB});if(!u)return;const m=(0,o(68465).t1)(e),g=u.getActionPointers().map((e=>c(e))).filter(b().O9);return g.length===u.getActionIds().length?(0,o(310109).typecheckAutomation)("button_block"===n?{actionModels:g,automationModel:u,assistantFeatureGate:m,checkExperimentGate:e=>Me().default.checkGate({gateName:e}),contextType:n,formulasModule:r,getRecordModel:c,getRecordRole:d,intl:(0,l()._z)(),isSubscribed:(0,Ne().y4)(),pageBlockModel:a,userTimeZone:(0,s().P)(),valueTypes:[],env:"production"}:{actionModels:g,automationModel:u,assistantFeatureGate:m,checkExperimentGate:e=>Me().default.checkGate({gateName:e}),contextType:n,formulasModule:r,getRecordModel:c,getRecordRole:d,intl:(0,l()._z)(),isSubscribed:(0,Ne().y4)(),userTimeZone:(0,s().P)(),valueTypes:[],env:"production"}):void 0},z=async t=>{const n=E();if(!n)throw new Error("Could not get current page");const i=Ee().dn.createChildStore(n,{id:t,table:p().yB,spaceId:n.getSpaceId()}),[a,s,l]=await Promise.all([Ce().T.formulas.load(),ke().QV.automationTypecheck.load(),ke().QV.automationActionRegistry.load()]);if(i.isTriggerType("button")){const u=i.getParentStore();if(!u)throw new Error("Could not get parent store");if(u instanceof Re().B){var c;if(!u.isType(r().xd.button))throw new Error("Unexpected parent for button block automation");if(!n.isPageBlock())throw new Error("Current page must be a page block for button analysis");return(0,Le().jl)({environment:e,automationActionRegistryModule:l,automationStore:i,automationTypecheckModule:s,blockStore:u,currentUserId:null===(c=e.currentUser)||void 0===c?void 0:c.id,isLoggedIn:e.currentUser.isLoggedIn(),formulasModule:a,intl:Fe().A.getIntl(),pageStore:n,parentRecordStore:i,type:"button_block"})}{var d;const n=Object.entries(u.getSchema()).find((e=>{let[,o]=e;return"button"===(null==o?void 0:o.type)&&o.automation_id===t}));if(!n)throw new Error("Could not find property schema for button automation");const[r,c]=n;if("button"!==(null==c?void 0:c.type))throw new Error("Expected button property schema");const p=new(o(441307).A)(e);return p.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:u}),(0,Le().jl)({environment:e,automationActionRegistryModule:l,automationStore:i,automationTypecheckModule:s,collectionContextStore:p,currentUserId:null===(d=e.currentUser)||void 0===d?void 0:d.id,formulasModule:a,intl:Fe().A.getIntl(),isLoggedIn:e.currentUser.isLoggedIn(),parentRecordStore:i,propertyId:r,propertySchema:c,type:"button_property"})}}if((0,De().$X)(i))return(0,Le().sl)({environment:e,automationActionRegistryModule:l,automationTypecheckModule:s,automationStore:i,contextType:(0,De().H8)((0,me().o9)(i.getTriggerType(),"Could not get trigger type")),formulasModule:a,intl:Fe().A.getIntl()});throw new Error("Unexpected automation type")},J=t=>{const o=Pe().default.state.currentUserSettingsStore,n=null==o?void 0:o.getSettings();if(!o||!n)return void console.error("Could not find current user settings");const r=e=>e?(0,i().K1)({date:e,daysToAdd:-t}):e;Ae().createAndCommit({userAction:"debuggingHelpers.advanceAssistantOnboardingNDays",environment:e,canUndo:!0,userId:o.id,perform:e=>{we().mJ({userSettingsStore:o,data:{last_exposed_to_ai_qna_at:r(n.last_exposed_to_ai_qna_at),last_used_ai_writer_at:r(n.last_used_ai_writer_at),ai_assistant_onboarding_phase_last_set_at:r(n.ai_assistant_onboarding_phase_last_set_at),ai_assistant_tutorial_dismissed_at:r(n.ai_assistant_tutorial_dismissed_at),ai_sales_assisted_extra_notification_seen_at:r(n.ai_sales_assisted_extra_notification_seen_at),qna_reminders_shown_at:(0,b().O9)(n.qna_reminders_shown_at)?n.qna_reminders_shown_at.map((e=>(0,i().K1)({date:e,daysToAdd:-t}))):void 0},transaction:e})}})},Y=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetNotionAiSidebarNewBadge",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{ai_sidebar_item_new_badge_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},Z=()=>{const t=Pe().default.state.currentSpaceViewStore;t?Ae().createAndCommit({environment:e,userAction:"debuggingHelpers.resetDatabaseAISummaryDismiss",canUndo:!0,perform:e=>{be().AG(t,e,{dismissed_db_page_summary_suggestion:0})}}):console.error("Could not find current space view")},X=()=>{const t=Pe().default.state.currentSpaceViewStore;t?Ae().createAndCommit({userAction:"githubAIConnector.onboarding.dismissPersonalAuthPrompt",environment:e,canUndo:!0,perform:e=>{t&&Ae().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_github_personal_auth_prompt:!1}},transaction:e})}}):console.error("Could not find current user settings")},ee=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.clearQnAOnboarding",environment:e,canUndo:!0,userId:t.id,perform:e=>{var o;we().mJ({userSettingsStore:t,data:{ai_qna_intro_onboarding_phase:null,last_exposed_to_ai_qna_at:null,last_used_ai_writer_at:null,qna_reminders_shown_at:null,ai_assistant_onboarding_phase:null,ai_assistant_tooltips_onboarding_phase:null,ai_onboarding_phase:null,ai_assistant_onboarding_phase_last_set_at:null,ai_sales_assisted_extra_notification_seen_at:null,ai_assistant_tutorial_dismissed_at:null,assistant_summarize_this_page_shown_at:void 0,ai_qna_abandoned_search_reminder_shown_at:void 0,callout_dismissal_timestamps:((null===(o=t.getSettings())||void 0===o?void 0:o.callout_dismissal_timestamps)??[]).filter((e=>"ai_assistant_announcement"!==e.name))},transaction:e})}}):console.error("Could not find current user settings")},te=()=>{const{currentSpaceViewStore:t}=Pe().default.state;t&&Ae().createAndCommit({environment:e,userAction:"AiSlackQnaNotificationTooltip.clearSlackQnaAnnouncementSeenAt",canUndo:!0,perform:e=>{Ae().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),slack_universal_qna_announcement_seen_at:null}},transaction:e})}})},oe=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetTwoWayLimitAddRelationConfirmationDialog",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{relation_limit_confirmation_dialog_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},ne=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetAiPageTranslationPassiveSuggestions",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{ai_page_translation_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},re=()=>{const{currentSpaceViewStore:t}=Pe().default.state;t&&Ae().createAndCommit({environment:e,userAction:"AiGoogleDriveQnaNotificationTooltip.clearGoogleDriveQnaAnnouncementSeenAt",canUndo:!0,perform:e=>{Ae().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),google_drive_universal_qna_announcement_seen_at:null}},transaction:e})}})},ie=()=>{const t=Pe().default.state.currentSpaceStore,o=Pe().default.state.currentSpaceViewStore;t&&o?Ae().createAndCommit({userAction:"debuggingHelpers.resetAssistantLeapSettings",environment:e,canUndo:!0,perform:e=>{_e().zv({store:t,data:{settings:{...t.getSettings(),enable_ai_training:void 0}},transaction:e}),Ae().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),has_user_seen_leap_modal:!1}},transaction:e})}}):console.error("Could not find current space")},ae=()=>{const t=Pe().default.state.currentSpaceViewStore;t?Ae().createAndCommit({userAction:"slackAIConnector.onboarding.dismissPersonalAuthPrompt",environment:e,canUndo:!0,perform:e=>{t&&Ae().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_slack_personal_auth_prompt:!1}},transaction:e})}}):console.error("Could not find current user settings")},se=()=>{const{RouterStore:t}=e,o=Pe().default.state.currentSpaceStore;if(!o)return;const n=t.state.route;let r;if("aiInferenceTranscript"===n.name?r=n.threadId:"page"===n.name&&(r=(0,fe().ZA)(n.chatThreadId)),!r)return;const i=Ee().Ei.createChildStore(o,{id:r,spaceId:o.id,table:f().To});return{thread:i,messages:i.getMessageStores()}},le=()=>{const{thread:e}=se()??{};return e?e.getTranscript():[]},ce=()=>{var t,o,n,r,i;const{RouterStore:a}=e,s=a.state.route;if("page"!==s.name)return;const l=s.collectionViewId;if(!l)return void console.error("Must run this from a Form view");const c=null===(t=A(l,"collection_view"))||void 0===t?void 0:t.value;if(!c||"form_editor"!==c.type)return void console.error("Must run this from a Form view");const d=(null===(o=c.format)||void 0===o||null===(o=o.form_block_pointer)||void 0===o?void 0:o.id)??"",u=null===(n=A(d,"block"))||void 0===n?void 0:n.value;if(!u)return void console.error("Can't load form block");const p=(null===(r=u.format)||void 0===r||null===(r=r.form_layout_pointer)||void 0===r?void 0:r.id)??"",m=null===(i=A(p,"layout"))||void 0===i?void 0:i.value;m?(console.log("Form editor view: \n"),console.log(c),console.log("Form block: \n"),console.log(u),console.log("Form layout: \n"),console.log(m)):console.error("Can't load form layout")},de=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetJiraOnboardingTourLaunch",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{tutorials:{"jira-sync-onboarding":"all-projects-tooltip"},jira_sync_onboarding_tour_state:null,seen_jira_sync_source_tooltip:null},transaction:e})}}):console.error("Could not find current user settings")},ue=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetImproveJiraSyncPopup",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{seen_improve_jira_sync_popup:null},transaction:e})}}):console.error("Could not find current user settings")},ge=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetJiraSetupGuide",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{jira_sync_guide_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},je=async()=>{const{currentSpaceStore:t,currentSpaceViewStore:n}=Pe().default.state;if(t){const r=await(0,o(448433).h)({environment:e,currentSpaceStore:t,currentSpaceViewStore:n}),i=new Map;return r.getAllBlocks().forEach((e=>{e.block.source.forEach((t=>{const o=i.get(t)||[];o?i.set(t,[...o,e.block]):i.set(t,[e.block])}))})),{...r,groupedPages:i}}},He=async()=>{var t;const o=null===(t=e.defaultRecordCache.persistedRecordCache)||void 0===t?void 0:t.getDedicatedWorkerConnection_DEBUG_ONLY();if(!o)throw new Error("Browser SQLite is not active here!");await o.resetDb_DEBUG_ONLY(),console.log("Browser SQLite DB successfully reset!")},qe=async()=>{try{var t;await(null===(t=e.defaultRecordCache.persistedRecordCache)||void 0===t?void 0:t.reset()),o(670631).A.reset()}catch(n){console.error("Error resetting SQLite:",n)}finally{console.log("SQLite reset successfully")}},Ge=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unread_and_read",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";const r=H();if(r){const i=await ve().callApi({eventName:"getNotificationsForInbox",environment:e,data:{spaceId:r,size:o,type:t,locale:n}});console.log(i)}else console.log("no space id")},Qe=t=>{const n=o(388821).RecordMapWithRole.create();for(const[o,r]of Object.entries(t)){if(!g().bI(o)||!Array.isArray(r))throw new Error(`Not a table: ${o}. Argument should be like { block: [id1, id2], collection: [...], ... }`);for(const t of r){const r={table:o,id:t},i=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});i&&n.setValueAndRole(r,i.value,i.role)}}return n},ze=e=>Qe(e).toRecordMap(),Ye=()=>{const t=E();t&&(0,o(198874).l)({environment:e,pageStore:t,duplicateTo:"private_pages",triggeredFrom:"debugging_helper"})},Ze=()=>{const t=E();if(!t)return;const n=(new pe).mapPageToXML({pagePointer:t.getSpaceShardedPointer(),intl:(0,l()._z)(),getRecordModel:e.defaultRecordCache.inMemoryRecordCache.makeGetRecordModelFn(e.currentUser.id),serverOrClientConfig:{domainBaseUrl:Ie().A.domainBaseUrl,publicDomainBaseUrl:Ie().A.publicDomainName},experimentService:Me().default,formulasModule:a()});return(0,o(706461)._o)(n)},Xe=async t=>await(0,o(207276).p)({environment:e,chatTranscriptStorageStep:t,chatStartTimestamp:Date.now(),makeActiveSession:!0}),et=()=>{const t=Pe().default.state.currentUserSettingsStore;t?Ae().createAndCommit({userAction:"debuggingHelpers.resetAssistantSuggestionExposure",environment:e,canUndo:!0,userId:t.id,perform:e=>{we().mJ({userSettingsStore:t,data:{ai_suggested_skill_exposure_tracker:null},transaction:e})}}):console.error("Could not find current user settings")};return{getRecordFromApi:t,getRecordFromCache:A,getAdminUrl:C,getSelectedBlocks:()=>Ue().default.state.stores,openInAdmin:T,openSelectedBlocksInAdmin:P,openCurrentPageCreatorInAdmin:N,getCurrentPage:E,getCurrentLayoutStore:()=>{if(!Pe().default.state.mainEditorCurrentBlockStore)return void console.error("No current mainEditorCurrentBlockStore");const e=Pe().default.state.mainEditorCurrentBlockStore.getAssociatedCollectionStore();if(!e)return void console.error("Collection pages use layouts, but can't find a collection page in the main editor.");const t=e.getLayoutStore();if(t)return t;console.error("This collection doesn't have a layout in main editor.")},addDuplicateContentTabToCurrentLayout:R,removeAllCollectionPageSections:U,setPageSectionVisibility:B,getCurrentNormalizedPropertyGroups:()=>{if(!Pe().default.state.mainEditorCurrentBlockStore)return void console.error("No current mainEditorCurrentBlockStore");const e=Pe().default.state.mainEditorCurrentBlockStore.getAssociatedCollectionStore()||Pe().default.state.mainEditorCurrentBlockStore.getCollectionStore();if(e)return e.getNormalizedPropertyGroups();console.error("Property groups are stored on collections but can't find collection in main editor.")},openCurrentPageInAdmin:x,openCurrentSpaceInAdmin:M,quickFind:function(e){const t=V(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0),o=$e().Uc(t);return o&&o.then((e=>"success"===e.type?e.data:e))},quickFindRequest:function(e){return V(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)},quickFindCollections:L,getCurrentPageDetail:I,getHomeBlockIdsForUser:W,getRecordDetail:k,getRecordTitle:S,getRecordTree:$,overrideStatsigLocalExperiment:(e,t)=>{j(),Be().A.updateLocalOverrideConfig(e,t)},overrideStatsigLocalFeatureGate:(e,t)=>{j(),Be().A.updateLocalOverrideGate(e,t)},removeAllStatsigLocalOverrides:()=>{j(),Be().A.removeAllLocalOverrides()},getCurrentSpaceId:H,getCurrentUserId:q,getAutomationsForSelectedBlocks:()=>Ue().default.state.stores.map((e=>Je(e,0))).filter(b().O9),getAutomationsForCurrentPage:Q,getCurrentThread:se,getCurrentThreadSteps:le,debugCompileAutomation:K,getAutomationAnalysis:z,generateTutorialData:(e,t,o)=>{const n="production";if("development"!==n&&"local"!==n)return;const r=o??Pe().default.state.mainEditorCurrentBlockStore,i=null==r?void 0:r.getType(),a=null==r?void 0:r.getProperties(),s=null==r?void 0:r.getFormat();if(!(r&&i&&a&&s))return void console.log(`Missing one of these: ${JSON.stringify({rootBlockStore:r,type:i,properties:a,format:s})}`);function l(e,t){const o=t.getContentStores();return w().Bq(o.map(((t,o)=>{const n=t.getType(),r=t.getProperties(),i=t.getFormat();if(!n||!r||!i)return;return[{uri:`${e}/${o}`,type:"block",parentUri:e,parentType:"block",blockValue:{type:n,properties:r,format:i}},...l(`${e}/${o}`,t)]}))).filter(b().O9)}const c=[{uri:e,type:"block",parentUri:t,parentType:"collection",blockValue:{type:i,properties:a,format:s}},...l(e,r)];function d(t){const o=t.replace(e,"").split("/");return w().xQ(e)+o.join("_")}const u={},p=c.map((t=>{const o=t.uri;return JSON.stringify(t,((n,r)=>{if("uri"===n||"parentUri"===n)return["<<<START>>>","`",r.replace(e,"${uri}"),"`","<<<END>>>"].join("");if("title"===n&&Array.isArray(r)&&"image"!==t.blockValue.type){const e=[];for(const[t,n]of r.entries()){if(n.length>1&&"a"===n[1][0][0])return n;const r=d(`${o}/${t}`),i=[["<<<START>>>",`LocalizationHelper.formatMessage(messages.${r})`,"<<<END>>>"].join(""),...n.slice(1)];u[r]={defaultMessage:n[0],id:r,description:"Page template's content"},e.push(i)}return e}return r}))})).map((e=>e.replace(/"<<<START>>>/g,"").replace(/<<<END>>>"/g,"").replace(/<<<QUOTE>>>/g,'"')));return`\n\t\t\tconst messages = defineMessages({\n\t\t\t\t${(0,b().WP)(u).map((e=>{let[t,o]=e;return`"${t}": {\n\t\t\t\t\t\t\t\t\tid: "${o.id}",\n\t\t\t\t\t\t\t\t\tdefaultMessage: \`${o.defaultMessage}\`,\n\t\t\t\t\t\t\t\t\tdescription: "${o.description}",\n\t\t\t\t\t\t\t\t}`})).join(",\n")}\n\t\t\t})\n\t\t\tconst uri = "${e}"\n\t\t\treturn [\n\t\t\t\t${p.join(", ")}\n\t\t\t]`},setHomeTemplatesPersona:e=>{const t=[...Te().U7.map((e=>({personaValue:{type:"function",persona:e},key:`function - ${e}`}))),...Te().mh.map((e=>({personaValue:{type:"space_intent",persona:e},key:`space_intent - ${e}`}))),...Te().Ol.map((e=>({personaValue:{type:"space_type",persona:e},key:`space_type - ${e}`})))],n=t.find((t=>t.key===e));n?o(769705).A.setState(n.personaValue):console.error("input must be one of the following values",t.map((e=>e.key)))},setHomeLearnUserType:e=>{const t={isMultiplayer:e.isMultiplayer??!1,isNewAccount:e.isNewAccount??!1,isWorkspaceOwner:e.isWorkspaceOwner??!1,isOnTrial:e.isOnTrial??!1,persona:e.persona};o(116499).A.setState(t)},advanceAssistantOnboardingNDays:J,printAllFormsDataModel:ce,resetJiraOnboardingTourLaunch:de,resetImproveJiraSyncPopup:ue,resetJiraSetupGuide:ge,getAllUserSignals:_,loadAllUserSignals:u,getLocalSearchableCache:je,saveFileFromOpfs:async e=>{const t=await navigator.storage.getDirectory(),o=await(await t.getFileHandle(e)).getFile(),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=e,n.click()},resetBrowserSqlite:He,resetSqliteForOffline:qe,resetNotionAiSidebarNewBadge:Y,resetDatabaseAISummaryDismiss:Z,getNotificationsforInbox:Ge,createRecordMapWithRole:Qe,createRecordMap:ze,findId:We.bind(null,e),editRecordJson:n,updateRecordJson:d,duplicateTranslatedPage:Ye,loadAssistantChatTranscriptStorageStep:Xe,resetGithubPersonalAuthPrompt:X,resetSlackPersonalAuthPrompt:ae,getTranslatedPageXml:Ze,resetAssistantSuggestionExposure:et,resetGoogleDriveOnboarding:re,resetSlackOnboarding:te,resetAssistantOnboarding:ee,resetAssistantLeapSettings:ie,resetTwoWayLimitAddRelationConfirmationDialog:oe,resetAiPageTranslationPassiveSuggestions:ne,getCurrentCellId:G}}(e);for(const[n,r]of Object.entries(t))(0,o(604341).exposeDebugValue)(n,r);return t}))},388182:(e,t,o)=>{o.d(t,{A:()=>n});const n=o(757695).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},435930:(e,t,o)=>{o.d(t,{s:()=>a});const n={id:"pageLayoutEditor.property",defaultMessage:"Property",description:"Label for the property section in the page layout editor"},r={id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Heading",description:"Label for the titleWithIcon section in the page layout editor"},i={id:"pageLayoutEditor.collectionView",defaultMessage:"Database View",description:"Label for the form submit button section in the form page layout editor"},a=(0,o(959013).YK)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Property group"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Content"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"},views:{id:"pageLayoutEditor.views",defaultMessage:"Views"},viewsMain:{id:"pageLayoutEditor.views",defaultMessage:"Views"},relationsGroup:{id:"pageLayoutEditor.relationsGroup",defaultMessage:"Relations group"},formTitle:{id:"pageLayoutEditor.formTitle",defaultMessage:"Form Title"},formQuestion:{id:"pageLayoutEditor.formQuestion",defaultMessage:"Form Question"},formSubmit:{id:"pageLayoutEditor.formSubmit",defaultMessage:"Form Submit"},placeholder:{id:"pageLayoutEditor.placeholder",defaultMessage:"New"},normalizedTitleWithIcon:r,titleWithIcon:r,deleted_property:n,property_number:n,property_title:n,property_person:n,property_file:n,property_text:n,property_checkbox:n,property_url:n,property_email:n,property_phone_number:n,property_created_by:n,property_last_edited_by:n,property_button:n,property_select:n,property_multi_select:n,property_status:n,property_date:n,property_created_time:n,property_last_edited_time:n,property_last_visited_time:n,property_relation:n,property_rollup:n,property_formula:n,property_auto_increment_id:n,property_location:n,property_verification:n,property_geo_point:n,property:n,collectionView:i,collectionViewV2:i})},450486:(e,t,o)=>{o.r(t),o.d(t,{moveToTeamImpl:()=>l});var n=()=>o(496603),r=()=>o(534177),i=()=>o(44729),a=()=>o(955930),s=()=>o(375078);function l(e){let{transaction:t,currentSpaceViewStore:o,teamStore:l,targets:c,location:d,environment:u}=e;const p=o.getTeamsStores(),m=l.getTeamPagesStore();s().maybeTurnCollectionViewIntoCollectionViewPage({environment:u,blocks:c,transaction:t});for(const s of c){const e=n().I6(p,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(s.id)}));(null==e?void 0:e.id)!==l.id&&("append"===d.type?i().NI({parentStore:m,childStore:s,after:d.after,transaction:t}):"prepend"===d.type?i().Ti({parentStore:m,childStore:s,before:d.before,transaction:t}):(0,r().HB)(d),e&&a().Ex({teamStore:e,store:s,transaction:t}))}return l}},518598:(e,t,o)=>{o.d(t,{K:()=>d});o(296540);var n=()=>o(426388),r=()=>o(959013),i=()=>o(705540),a=()=>o(285790),s=()=>o(745766),l=o(474848);const c=(0,r().YK)({menu:{defaultMessage:"Menu",id:"topbar.appMenuButton.title"}});function d(){const e=(0,r().tz)();return(0,l.jsx)(a().A,{style:{position:"absolute",top:"10px",left:"14px",width:24,height:24,zIndex:1e5,...(0,s().g)({noDrag:!0})},iconStyle:{width:16,height:16},isDarkIconColor:!0,onClick:()=>{i().openAppMenu()},icon:n().S,ariaLabel:e.formatMessage(c.menu)})}},555267:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),r=()=>o(401497),i=()=>o(62856),a=()=>o(331542),s=o(474848);function l(e){let{loadingMessage:t}=e;const o=(0,r().DP)(),l=(0,i().A)(!0,400);return(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:l&&(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)(a().A,{}),t&&(0,s.jsx)("div",{style:{marginLeft:8,color:o.text.secondary},children:t})]})})}},567121:(e,t,o)=>{o.d(t,{EG:()=>a,K5:()=>i,RH:()=>r,Yi:()=>s,ls:()=>n});const n=32,r=202,i=1e3,a="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",s="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},578194:(e,t,o)=>{o.d(t,{r:()=>n});const n=(0,o(583835).Dv)("importEvernote")},756114:(e,t,o)=>{o.d(t,{D:()=>n});function n(e,t){t.route.name;return!1}},765974:(e,t,o)=>{o.d(t,{b:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M11.84 3.563c-.817-1.417-2.862-1.417-3.68 0L2.314 13.688c-.818 1.416.205 3.187 1.84 3.187h11.692c1.636 0 2.658-1.77 1.84-3.187zM9.876 6.75c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5"})},r=(0,o(340498).wt)("exclamationMarkTriangleFill",n)},893627:(e,t,o)=>{o.d(t,{K:()=>a});var n=o.n(o(440537)),r=()=>o(132456),i=()=>o(206267);class a{constructor(e){this.environmentName=void 0,this.mainShortId=void 0,this.getSettings=void 0,this.isServerOriginated=void 0,this.mapSpaceIdToShortId=void 0,this.idCreatorLogger=void 0,this.environmentName=e.environmentName,this.mainShortId=o(851941).Yf[this.environmentName],this.getSettings=e.getSettings,this.isServerOriginated=e.isServerOriginated,this.mapSpaceIdToShortId=e.mapSpaceIdToShortId,this.idCreatorLogger=e.idCreatorLogger??(()=>{})}idInMain(e){const{enableTestDateOffset:t,enableIdSchema:n}=this.getSettings();return n&&e!==o(867178).wI?(this.idCreatorLogger(void 0,e,t?"id_schema_test":"id_schema"),(0,r().J4)(t,this.mainShortId,e,this.isServerOriginated)):this.legacyId(e,"disabled")}pointerInMain(e){return{table:e,id:this.idInMain(e)}}async idWithSpaceId(e,t){const{enableTestDateOffset:o,enableIdSchema:i}=this.getSettings();if(!i||"space"===t)return this.legacyId(t,"disabled");const a=this.mapSpaceIdToShortId(e),s=n().types.isPromise(a)?await a:a;return s?(this.idCreatorLogger(e,t,o?"id_schema_test":"id_schema"),(0,r().kw)(o,s,t,this.isServerOriginated)):this.legacyId(t,"missing_short_id")}async pointerWithSpaceId(e,t){return{table:t,spaceId:e,id:await this.idWithSpaceId(e,t)}}idWithSpaceShortId(e,t){const{enableTestDateOffset:o,enableIdSchema:n}=this.getSettings();return n&&"space"!==t?(this.idCreatorLogger(void 0,t,o?"id_schema_test":"id_schema"),(0,r().kw)(o,e,t,this.isServerOriginated)):this.legacyId(t,"disabled")}legacyId(e,t){return this.idCreatorLogger(void 0,e,t),i().JW()}async deterministicIdWithSpaceId(e,t,o){const{enableTestDateOffset:a,enableIdSchema:s}=this.getSettings();if(!s)return this.idCreatorLogger(e,t,"disabled"),i().gB(o);const l=this.mapSpaceIdToShortId(e),c=n().types.isPromise(l)?await l:l;return c?(this.idCreatorLogger(e,t,a?"id_schema_test":"id_schema"),(0,r().lf)(c,t,o)):(this.idCreatorLogger(e,t,"missing_short_id"),i().gB(o))}deterministicIdWithSpaceShortId(e,t,o){const{enableTestDateOffset:n,enableIdSchema:a}=this.getSettings();return a?(this.idCreatorLogger(void 0,t,n?"id_schema_test":"id_schema"),(0,r().lf)(e,t,o)):(this.idCreatorLogger(void 0,t,"disabled"),i().gB(o))}async getSpaceIdCreator(e){if(!e)return new s(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new s(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),r=n().types.isPromise(o)?await o:o;return this.getSpaceShortIdCreator(e,r)}getSpaceIdCreatorSync(e){if(!e)return new s(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new s(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),r=n().types.isPromise(o)?void 0:o;return this.getSpaceShortIdCreator(e,r)}getSpaceShortIdCreator(e,t){const{enableIdSchema:o}=this.getSettings();return o&&t?new l(e,this,t):new s(e,this.idCreatorLogger)}async getSpaceIdCreatorFromModel(e){return e.getShortIdStr()?this.getSpaceShortIdCreator(e.id,Number(e.getShortIdStr())):await this.getSpaceIdCreator(e.id)}}class s{constructor(e,t){this.spaceId=void 0,this.idCreatorLogger=void 0,this.spaceId=e,this.idCreatorLogger=t}idInSavedSpace(e){return this.idCreatorLogger(void 0,e,"disabled"),i().JW()}idInMain(e){return this.idCreatorLogger(void 0,e,"disabled"),i().JW()}deterministicIdInSavedSpace(e,t){return this.idCreatorLogger(void 0,e,"disabled"),i().gB(t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}class l{constructor(e,t,o){this.spaceId=void 0,this.idCreator=void 0,this.spaceShortId=void 0,this.spaceId=e,this.idCreator=t,this.spaceShortId=o}idInSavedSpace(e){return this.idCreator.idWithSpaceShortId(this.spaceShortId,e)}idInMain(e){return this.idCreator.idInMain(e)}deterministicIdInSavedSpace(e,t){return this.idCreator.deterministicIdWithSpaceShortId(this.spaceShortId,e,t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}},954220:(e,t,o)=>{o.r(t),o.d(t,{computeSimilarUserRecentPagesState:()=>p,fetchUserSignals:()=>v,initializeAndLoadAllUserSignals:()=>g,refreshAndBroadcastSimilarUserSignals:()=>m,setUserSignals:()=>f});o(944114),o(898992),o(803949),o(581454);var n=()=>o(386164),r=()=>o(496603),i=()=>o(449506),a=()=>o(187778),s=()=>o(508496),l=()=>o(20199),c=()=>o(314648);const d=5*o(720665).Xb;function u(e){const t=s().default.getEligibleGroup({experimentId:e,parameter:"editedPagesLookbackDays",defaultGroup:"control"});return void 0===t||"control"===t?"1":t}function p(e){const t={};return e.forEach((e=>{let{userId:o,recentPages:n,similarity:i}=e;if(!n.length)return;const a=r().$z(n,(e=>{let{pageId:t}=e;return t}));Object.entries(a).forEach((e=>{let[n,r]=e;const a=r.map((e=>{let{visitedAt:t}=e;return t})).sort(((e,t)=>t-e));t[n]||(t[n]={pageId:n,sortedSimilarUserSignals:[]}),t[n].sortedSimilarUserSignals.push({userId:o,similarity:i,visitedAt:a})}))})),Object.values(t).forEach((e=>{e.sortedSimilarUserSignals.sort(((e,t)=>t.similarity-e.similarity))})),t}async function m(e){var t;const{spaceId:o,userId:n,environment:r}=e,i=await v({spaceId:o,environment:r,signalsOverride:[{name:"similarUserRecentPages",includeRecords:!0},{name:"similarUsersEditedPages",includeRecords:!0,lookbackDays:1}]});void 0!==i&&(f({spaceId:o,userId:n,environment:r,newSignals:i,initialize:!1}),await(null===(t=l().A.state.broadcastChannel)||void 0===t?void 0:t.postMessage({type:"userSignals",data:i})))}async function g(e){const{spaceId:t,userId:o,environment:n,refreshTimer:r=d}=e,i=await v({spaceId:t,environment:n});if(void 0===i)return;f({spaceId:t,userId:o,environment:n,newSignals:i,initialize:!0});var a;"on"===s().default.getGroup("search_refresh_user_signals")?(await c().default.waitUntil((()=>Boolean(c().default.getUserSignals({spaceId:t,userId:o})))),null===(a=l().A.state.broadcastChannel)||void 0===a||a.addEventListener("message",(e=>{"userSignals"===e.type&&f({spaceId:t,userId:o,environment:n,newSignals:e.data,initialize:!1})})),await l().A.waitUntil((()=>Boolean(l().A.state.elector))),l().A.state.elector.awaitLeadership().then((()=>{c().default.update((e=>{e.refreshIntervalId&&window.clearInterval(e.refreshIntervalId);const i=window.setInterval((async()=>{await m({spaceId:t,userId:o,environment:n})}),r);return{...e,refreshIntervalId:i}}))}))):c().default.update((e=>{e.refreshIntervalId&&window.clearTimeout(e.refreshIntervalId);const i=window.setTimeout((async()=>{const e=await v({spaceId:t,environment:n});void 0!==e&&f({spaceId:t,userId:o,environment:n,newSignals:e,initialize:!1})}),r);return{...e,refreshIntervalId:i}}))}function f(e){const{spaceId:t,userId:o,environment:n,newSignals:r,initialize:i}=e;r&&(c().default.setUserSignals({spaceId:t,userId:o,userSignals:r,initialize:i}),a().G(n,i?"userSignalsInitialization":"userSignalsReload"))}async function v(e){const{spaceId:t,environment:o,signalsOverride:a}=e,s=u("search-local-edited-pages-max"),l=u("search-local-sim-users-edited-pages-max"),d=parseInt(l),m=parseInt(s),g=await i().callApi({eventName:"getUserSignals",environment:o,data:{spaceId:t,signals:a??[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages",includeRecords:!0,lookbackDays:m},{name:"similarUsersEditedPages",includeRecords:!0,lookbackDays:d}]},headers:(0,n().WS)({cellId:void 0,recordId:void 0,spaceId:t})});if("success"!==g.type)return;const f=a?r().Up((0,c().getInitialUserSignalsState)(),a.map((e=>e.name))):(0,c().getInitialUserSignalsState)();return g.data.signals.forEach((e=>{if("error"===e.status)return;const t=e.name;switch(t){case"similarUserRecentPages":f.similarUserRecentPages=p(e.data);break;case"recentPages":f.recentPages=e.data;break;case"topPages7dPageView":f.topPages7dPageView=e.data;break;case"similarUsersEditedPages":f.similarUsersEditedPages=e.data;break;case"editedPages":f.editedPages=e.data}})),f}}}]);