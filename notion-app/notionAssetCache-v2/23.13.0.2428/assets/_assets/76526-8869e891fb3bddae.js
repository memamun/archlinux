"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[76526],{67805:(e,i,t)=>{t.d(i,{X:()=>o,cT:()=>a,sL:()=>l});t(898992),t(672577);var s=()=>t(68263),n=()=>t(731320),r=()=>t(508496);function o(e,i){return e.sort(((e,t)=>{const s=e.store.canAdmin();if(s===t.store.canAdmin()){var n,r;const s=null===(n=e.publishedMetadata.publishedBy)||void 0===n?void 0:n.id,o=e.publishedMetadata.publishedTime,a=null===(r=t.publishedMetadata.publishedBy)||void 0===r?void 0:r.id,l=t.publishedMetadata.publishedTime;if(i){if(s===i&&a===i&&o&&l)return l-o;if(s===i)return-1;if(a===i)return 1}return o&&l?l-o:0}return s?-1:1}))}function a(e){const{environment:i,store:t}=e;if(!t.pathIsAccessibleAndAlive())return!1;if(!n().i0(t).find((e=>(0,s().W8)(e.permissionItem))))return!1;if(n().qb(i,t))return!1;return!("on"===r().default.getEligibleGroup({experimentId:"sites_disable_banner",defaultGroup:"control"}))}function l(e){const{environment:i,store:t}=e;if(!t.pathIsAccessibleAndAlive())return!1;if(!n().i0(t).find((e=>(0,s().FP)(e.permissionItem)&&"none"!==e.permissionItem.role)))return!1;if(n().qb(i,t))return!1;return"on"===r().default.getEligibleGroup({experimentId:"sites_disable_banner",defaultGroup:"control"})}},183607:(e,i,t)=>{t.d(i,{X:()=>n});t(296540);var s=t(474848);const n=(0,t(340498).wt)("arrowsDiverging",{viewBox:"0 0 12 12",svg:(0,s.jsx)("path",{d:"M6 11.2891C6.42188 11.2891 6.63281 11.0469 6.63281 10.5625V7.3457C6.63281 7.00586 6.71875 6.64062 6.89062 6.25C7.06641 5.85938 7.29492 5.47266 7.57617 5.08984C7.86133 4.70703 8.16992 4.35547 8.50195 4.03516C8.83789 3.71484 9.16406 3.45312 9.48047 3.25L9.95508 2.94531C10.1621 2.81641 10.2656 2.63281 10.2656 2.39453C10.2656 2.21875 10.2109 2.07227 10.1016 1.95508C9.99219 1.83789 9.8418 1.7793 9.65039 1.7793C9.4668 1.7793 9.29102 1.83398 9.12305 1.94336L8.81836 2.14844C8.51367 2.34766 8.20898 2.58984 7.9043 2.875C7.59961 3.15625 7.31641 3.45508 7.05469 3.77148C6.79297 4.08398 6.56836 4.39258 6.38086 4.69727C6.19727 4.99805 6.07227 5.26953 6.00586 5.51172H5.98828C5.91797 5.26953 5.79102 4.99805 5.60742 4.69727C5.42383 4.39258 5.19922 4.08398 4.93359 3.77148C4.67188 3.45508 4.38867 3.15625 4.08398 2.875C3.7832 2.58984 3.48047 2.34766 3.17578 2.14844L2.87109 1.94336C2.69922 1.83398 2.52344 1.7793 2.34375 1.7793C2.14844 1.7793 1.99609 1.83984 1.88672 1.96094C1.78125 2.08203 1.72852 2.22461 1.72852 2.38867C1.72852 2.62695 1.83203 2.8125 2.03906 2.94531L2.51367 3.25C2.83008 3.45312 3.1543 3.71484 3.48633 4.03516C3.81836 4.35547 4.12695 4.70703 4.41211 5.08984C4.69727 5.47266 4.92773 5.85938 5.10352 6.25C5.2793 6.64062 5.36719 7.00586 5.36719 7.3457V10.5625C5.36719 11.0469 5.57812 11.2891 6 11.2891ZM1.81641 3.9707L3.71484 1.52734C3.85547 1.33984 3.88281 1.17578 3.79688 1.03516C3.71484 0.890625 3.55469 0.814453 3.31641 0.806641L0.808594 0.712891C0.613281 0.705078 0.466797 0.763672 0.369141 0.888672C0.271484 1.00977 0.251953 1.16406 0.310547 1.35156L1.02539 3.75391C1.0918 3.98438 1.20312 4.125 1.35938 4.17578C1.51953 4.22656 1.67188 4.1582 1.81641 3.9707ZM10.0898 3.95898C10.2266 4.1543 10.375 4.23047 10.5352 4.1875C10.6992 4.14062 10.8164 4.00391 10.8867 3.77734L11.6777 1.39258C11.7402 1.20508 11.7246 1.04883 11.6309 0.923828C11.541 0.798828 11.3984 0.736328 11.2031 0.736328L8.68945 0.753906C8.45117 0.753906 8.28711 0.824219 8.19727 0.964844C8.10742 1.10156 8.13086 1.26562 8.26758 1.45703L10.0898 3.95898Z"})})},258398:(e,i,t)=>{t.d(i,{A:()=>w});t(944114);var s=t(296540),n=()=>t(484714),r=()=>t(56366),o=()=>t(401497),a=()=>t(584262),l=()=>t(328347),d=()=>t(846899),c=()=>t(959013),u=()=>t(661920),m=()=>t(179030),p=()=>t(135552),h=()=>t(676870),C=()=>t(525700),g=()=>t(578872),f=()=>t(712505),b=()=>t(716979),v=()=>t(562800),M=t(474848);function w(e){let{blockStore:i,legacyColor:t}=e;const w=(0,r().K8)((()=>i.isFormBlock()),[i]),S=(0,n().v3)(),A=S.device.isMobile,I=(0,r().K8)((()=>{const e=g().UP(i);return v().Ix({spaceStore:i.getSpaceStore(),domainId:e})}),[i]),y=(0,s.useCallback)((()=>{C().uY({environment:S,store:i,pageVisitSource:a().y8.SiteBanner})}),[S,i]),P=(0,s.useCallback)((()=>{var e;f().default.isSidePeekOpen()&&(null===(e=f().default.peekTargetStore.state)||void 0===e?void 0:e.id)!==i.id&&u().YH(),b().n0(S),(0,h().EN)(S,{source:"site_settings_banner"})}),[i.id,S]),x=(0,o().IS)((()=>({icon:{height:16,width:16,marginRight:4}})),[]);if(!I||w)return null;let k;const L=[];return A?(k=(0,M.jsx)(c().sA,{defaultMessage:"This page is live on the web.",id:"pageViewBlock.sitesBannerMobile.message"}),L.push({label:(0,M.jsx)(c().sA,{defaultMessage:"View",id:"pageViewBlock.sitesBanner.view"}),onClick:()=>y()})):(k=(0,M.jsx)(c().sA,{defaultMessage:"This page is live on {domain}",id:"pageViewBlock.sitesBanner.message",values:{domain:I}}),L.push({label:(0,M.jsxs)(M.Fragment,{children:[(0,l().h)(x.icon),(0,M.jsx)(c().sA,{defaultMessage:"View site",id:"pageViewBlock.sitesBanner.viewSite"})]}),onClick:()=>y()},{label:(0,M.jsxs)(M.Fragment,{children:[(0,d().B)(x.icon),(0,M.jsx)(c().sA,{defaultMessage:"Site settings",id:"pageViewBlock.sitesBanner.settings"})]}),onClick:()=>P()})),(0,M.jsx)(m().l,{label:k,display:"full-width",actions:L,tint:(0,p().V)(t)})}},328347:(e,i,t)=>{t.d(i,{h:()=>n});t(296540);var s=t(474848);const n=(0,t(340498).wt)("globe2",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM3.88477 3.76465C4.56836 3.11523 5.39551 2.61621 6.31836 2.34277C5.83301 2.82812 5.42285 3.51172 5.11523 4.3457C4.63672 4.19531 4.22656 3.99707 3.88477 3.76465ZM9.68848 2.34961C10.6045 2.62305 11.4316 3.11523 12.1084 3.76465C11.7734 4.00391 11.3633 4.19531 10.8848 4.35254C10.5771 3.51172 10.167 2.82812 9.68848 2.34961ZM8.47852 2.56836C9.0459 2.8418 9.56543 3.58008 9.93457 4.58496C9.4834 4.66699 8.99805 4.71484 8.47852 4.73535V2.56836ZM6.06543 4.58496C6.44141 3.58008 6.9541 2.8418 7.52148 2.56836V4.73535C7.00195 4.71484 6.5166 4.66699 6.06543 4.58496ZM2.05273 7.58594C2.14844 6.42383 2.58594 5.35059 3.25586 4.46875C3.67285 4.77637 4.21289 5.04297 4.8418 5.24121C4.66406 5.95215 4.54785 6.74512 4.51367 7.58594H2.05273ZM11.4863 7.58594C11.4521 6.74512 11.3359 5.95215 11.1582 5.24121C11.7871 5.04297 12.3271 4.7832 12.7373 4.46875C13.4141 5.35059 13.8516 6.42383 13.9473 7.58594H11.4863ZM5.49121 7.58594C5.52539 6.84082 5.62793 6.12988 5.78516 5.4873C6.33203 5.59668 6.91309 5.66504 7.52148 5.69238V7.58594H5.49121ZM8.47852 7.58594V5.69238C9.08691 5.66504 9.66797 5.59668 10.2148 5.4873C10.3721 6.12988 10.4746 6.84082 10.5088 7.58594H8.47852ZM2.05273 8.54297H4.51367C4.54785 9.39746 4.66406 10.1973 4.8418 10.915C4.21973 11.1133 3.68652 11.373 3.27637 11.6807C2.59277 10.792 2.14844 9.71191 2.05273 8.54297ZM5.49121 8.54297H7.52148V10.4707C6.91992 10.498 6.33203 10.5664 5.79199 10.6689C5.62793 10.0195 5.51855 9.29492 5.49121 8.54297ZM8.47852 10.4707V8.54297H10.5088C10.4814 9.29492 10.3721 10.0195 10.208 10.6689C9.66797 10.5664 9.08691 10.498 8.47852 10.4707ZM11.1582 10.915C11.3428 10.1973 11.4521 9.39746 11.4863 8.54297H13.9473C13.8516 9.71191 13.4072 10.792 12.7236 11.6807C12.3135 11.373 11.7803 11.1133 11.1582 10.915ZM8.47852 11.4277C8.99121 11.4482 9.47656 11.4961 9.9209 11.5781C9.55176 12.5625 9.03906 13.2939 8.47852 13.5605V11.4277ZM6.0791 11.5781C6.52344 11.4961 7.00879 11.4482 7.52148 11.4277V13.5605C6.96094 13.2939 6.44824 12.5625 6.0791 11.5781ZM3.90527 12.3848C4.24023 12.1523 4.65039 11.9609 5.12207 11.8105C5.42969 12.6309 5.83301 13.3008 6.30469 13.7793C5.40234 13.5059 4.58203 13.0205 3.90527 12.3848ZM10.8779 11.8105C11.3496 11.9609 11.7598 12.1523 12.0947 12.3848C11.418 13.0205 10.5977 13.5059 9.69531 13.7793C10.167 13.3008 10.5703 12.6309 10.8779 11.8105Z"})})},558410:(e,i,t)=>{t.d(i,{A:()=>r});t(898992),t(354520);var s=()=>t(496603);class n extends(()=>t(757695))().default{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,i){this.state.sites[e]=i,this.emit()}getSortedSitesForSpace(e,i){const{sortAscending:n,sortColumn:r}=this.state,o=this.state.sites[e];if(o)switch(r){case"page":return s().My(o,(e=>t(919709).q4_(e.store.getTitleValue()).toLowerCase()),n?"asc":"desc");case"published-by":return s().My(o,(e=>{const s=e.publishedMetadata.publishedBy,n=s?t(630116).sk.createChildStore(e.store,s):void 0;return null==n?void 0:n.getDisplayName(i).toLowerCase()}),n?"asc":"desc");case"published-date":return s().My(o,(e=>e.publishedMetadata.publishedTime),n?"asc":"desc");default:return o}}removeSiteFromSpace(e,i){const t=this.state.sites[e];t&&(this.state.sites[e]=t.filter((e=>e.store.id!==i)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const r=new n},716979:(e,i,t)=>{t.d(i,{EL:()=>A,KD:()=>w,Ss:()=>v,l2:()=>I,n0:()=>S,rw:()=>M});t(16280),t(944114),t(898992),t(354520),t(296540);var s=()=>t(388821),n=()=>t(179034),r=()=>t(959013),o=()=>t(763824),a=()=>t(449506),l=()=>t(901389),d=()=>t(106628),c=()=>t(321172),u=()=>t(437487),m=()=>t(227440),p=()=>t(630116),h=()=>t(250484),C=()=>t(67805),g=()=>t(558410),f=t(474848);const b=50;function v(e){g().A.resetSitesForSpace(e.id)}async function M(e,i){const{spaceStore:t,currentUserId:r,limit:l}=i;if(!t.id)return;const[d]=await Promise.all([a().callApi({eventName:"getPublishedPagesForUser",environment:e,data:{spaceId:t.id,limit:l||b,fetchPublishedMetadata:!0}}),(0,o().wR)(1500)]);if("failed"===d.type)throw new Error("Failed to fetch published pages.");if(d.data.recordMap){const e=[],i=s().RecordMapWithRole.create(d.data.recordMap),o=d.data.publishedEdits;for(const{model:s}of i)if(s&&s.table===n().ev){const i=p().Bv.createChildStore(t,{table:n().ev,id:s.id}),r=o[i.id],a=r&&r.authors?r.authors[0]:void 0,l={publishedTime:null==r?void 0:r.timestamp,publishedBy:a};e.push({store:i,publishedMetadata:l})}let a=e;return r&&(a=C().X(e,r)),g().A.initializeSiteResultsForSpace(t.id,a),a}}async function w(e,i){const{spaceStore:t}=i,s=e.currentUser.id,n=await M(e,{spaceStore:t,currentUserId:s});return n?n.filter((e=>{var i;return(null===(i=e.publishedMetadata.publishedBy)||void 0===i?void 0:i.id)===s})):[]}function S(e){c().Tk(e),u().Ay.setState({...u().Ay.state,display:u().pP.Publish,tab:u().QC.Publish})}async function A(e){return new Promise(((i,t)=>{l().ui({message:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(r().sA,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(r().sA,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,f.jsx)(r().sA,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>i(!0)}],showCancel:!0})}))}async function I(e,i){if(!m().A.state.online)return[];const t=await d().T.searchActions.load();return await t.searchPublicPages({environment:i,query:e,source:"public_home_page_menu",limit:h().ZK})}},976721:(e,i,t)=>{t.d(i,{Dw:()=>w,Hc:()=>M,o5:()=>v});t(16280),t(296540);var s=()=>t(857639),n=()=>t(183607),r=()=>t(433847),o=()=>t(161479),a=()=>t(959013),l=()=>t(496603),d=()=>t(701763),c=()=>t(901389),u=()=>t(579627),m=()=>t(317909),p=()=>t(125565),h=()=>t(247123),C=()=>t(406792),g=()=>t(630116),f=()=>t(663590),b=t(474848);async function v(e){let{newRole:i,...t}=e;const s=t.oldPermissionItem,n=(0,l().o8)(s);return n.role=i,await M({newPermissionItem:n,...t})}async function M(e){const{oldPermissionItem:i,newPermissionItem:t,wasInherited:n,environment:a,store:l,sudoModeStore:c,restrictingVisibility:p,fromPermissionWrapper:h,trustedDomainsLoggingData:b}=e,v=(0,f().FI)();if(!(0,r().nK)(i,t))throw new Error("Permission type mismatch.");const M=!!c&&c.shouldSaveTransactionWithSudoMode(l),S=(0,r().$q)(i.role,t.role);if(n&&S!==t.role||p){return await w({environment:a,useSudoMode:M,store:l,permissionItem:t,fromPermissionWrapper:h,isRedesignEnabled:v,shouldInherit:!0,trustedDomainsLoggingData:b})}return l instanceof g().Bv&&!l.isTopLevel()&&i.role!==t.role&&S!==i.role&&d().MR(a),m().createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:a,canUndo:!0,useSudoMode:M,perform:i=>{const s=C().default.DO_NOT_USE_markLegacy("share_menu.update_page_permission_lag");u().wd({environment:a,store:l,permissionItems:[t],transaction:i,pagePermissionChangeLocation:e.location,metric:s,fromPermissionWrapper:h})}}),"trusted_domain_permission"===t.type&&s().log({level:"warning",from:"shareMenu.handlePermissionItemChange",type:"TrustedDomainPermissionChange",spaceId:(0,o().e)(l.pointer.spaceId),data:{miscDataToConvertToString:{message:"shareMenu.handlePermissionItemChange updating trusted domain permission",blockId:l.id,oldPermissionItem:i,newPermissionItem:t,trustedDomainsLoggingData:b}}}),!0}async function w(e){const{environment:i,useSudoMode:t,store:s,permissionItem:r,fromPermissionWrapper:o,isRedesignEnabled:l,shouldInherit:d,trustedDomainsLoggingData:C}=e,g="none"===(null==r?void 0:r.role)?{type:"remove",permissionItem:r}:{type:"restrict"};return!!("user_permission"===(null==r?void 0:r.type)&&(null==r?void 0:r.user_id)===i.currentUser.id||(l?await c().Gh({message:(0,h().r6)(g,l),description:(0,b.jsx)(p().A,{isSmall:!0,isMultiline:!0,children:(0,b.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.footer.whisperTextV2",defaultMessage:"Changing this will unlink this page from its parent, so it will no longer inherit share settings. Admins can still restore settings on unlinked pages."})}),acceptLabel:(0,h().QU)(g,l),icon:(0,n().X)({height:24,width:24})}):await c().Gh({message:(0,h().r6)(g),acceptLabel:(0,h().QU)(g),cancelLabel:(0,b.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,b.jsx)(p().A,{isSmall:!0,isMultiline:!0,children:(0,b.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})})).accept)&&(m().createAndCommit({userAction:"PermissionItem.onAccept",environment:i,canUndo:!0,useSudoMode:t,perform:e=>{u().wW({environment:i,store:s,permissionItem:r,shouldInherit:d,transaction:e,fromPermissionWrapper:o,trustedDomainsLoggingData:C})}}),!0)}}}]);