"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[57314],{140612:(e,t,s)=>{s.d(t,{w:()=>o});var r=()=>s(989423);function o(e,t){const{spaceId:s,pageId:o,joinSpaceMethod:a}=t;(0,r().u4)({environment:e,event:{eventName:"trusted_domain_banner_cta_clicked",eventProperties:{spaceId:s,pageId:o,joinSpaceMethod:a}}})}},260775:(e,t,s)=>{s.d(t,{RestrictedAccessComponent:()=>d});s(296540);var r=()=>s(401497),o=()=>s(987264),a=()=>s(517592),n=()=>s(959013),c=()=>s(284371),i=()=>s(21140),l=()=>s(322114),u=s(474848);function d(e){let{canRequestAccess:t,block:s}=e;const d=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},contentWrapper:{maxWidth:350,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:8},title:{fontWeight:c().Wy.semibold,fontSize:20},subtitle:{color:e.mediumTextColor,fontWeight:c().Wy.regular,lineHeight:1.4},notionLogo:{width:50,height:50}})),[]);return(0,u.jsx)("div",{style:d.container,children:(0,u.jsx)("div",{style:d.contentWrapper,children:t?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{children:(0,a().A)(d.notionLogo)}),(0,u.jsx)("div",{style:d.title,children:(0,u.jsx)(n().sA,{id:"fullPageError.canRequestAccess.title",defaultMessage:"No access to this page"})}),(0,u.jsxs)(i().wt,{gap:16,children:[(0,u.jsx)("div",{style:d.subtitle,children:(0,u.jsx)(n().sA,{id:"fullPageError.canRequestAccess.message",defaultMessage:"You can access this page if someone approves your request."})}),(0,u.jsx)(l().A,{type:"current-actor-to-block",block:s,flowId:"peek-renderer"})]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{children:(0,o().s)(d.notionLogo)}),(0,u.jsx)("div",{style:d.title,children:(0,u.jsx)(n().sA,{id:"fullPageError.contentDoesNotExist.title",defaultMessage:"This content does not exist"})})]})})})}},322114:(e,t,s)=>{s.d(t,{A:()=>R});var r=s(296540),o=()=>s(484714),a=()=>s(56366),n=()=>s(757695),c=()=>s(959013),i=()=>s(100622),l=()=>s(534177),u=()=>s(284371),d=()=>s(452939),p=()=>s(701763),m=()=>s(140612),g=()=>s(449506),f=()=>s(898486),y=()=>s(722872),b=()=>s(351360),v=()=>s(10984),A=()=>s(251126),x=()=>s(805751),h=()=>s(623580),q=()=>s(928600),_=()=>s(864943),j=()=>s(204063),I=s(474848);const k={marginBottom:10},S={...k,width:"100%",height:"100%",padding:10,alignItems:"top",borderRadius:0},w=(0,c().YK)({requestAccessMessagePlaceholder:{defaultMessage:"Message (optional)",id:"requestAccessForm.messageInput.placeholder"},rateLimitError:{defaultMessage:"You have recently requested access to this page.",id:"requestAccessForm.errorMessage.rateLimit"},currentUserNotFound:{defaultMessage:"Current user not found.",id:"requestAccessForm.errorMessage.currentUserNotFound"}});function C(){return(0,I.jsx)(c().sA,{defaultMessage:"Cancel",id:"requestAccessForm.cancelButton.label"})}const M=n().default.createClass(0,{name:"RequestAttemptStore"}),T=n().default.createClass(void 0,{name:"MessageStore"});const R=function(e){const t=(0,o().v3)(),n=(0,o().WS)(),i=(0,a().uB)(e.popupStore,s(463830).A),l=(0,a().uB)(void 0,T),p=(0,a().uB)(void 0,M),g=(0,r.useCallback)((()=>W(i)),[i]),f=(0,r.useCallback)((()=>(0,I.jsx)(P,{...e,requestAttemptStore:p,messageStore:l,buttonPopupStore:i})),[e,p,l,i]),y=(0,a().K8)((()=>p.state>0),[p]),b=(0,a().K8)((()=>i.state.open),[i]);if("current-actor-to-block"===e.type)return(0,I.jsx)(L,{type:"page",block:e.block,flowId:e.flowId,buttonType:e.buttonType});if("current-actor-to-collection"===e.type)return(0,I.jsx)(L,{type:"collection",collection:e.collection,flowId:e.flowId,buttonType:e.buttonType});const v="primary"===e.buttonType?j().A:_().A,A=n?(0,I.jsx)(s(14235).Ay,{popupType:s(377586).n.SlideUp,open:b,render:f}):(0,I.jsx)(s(957986).A,{open:b,onDismiss:g,render:f});return"current-actor-to-space-via-onboarding"===e.type?A:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(v,{size:"lg",disabled:y,onClick:()=>{var s,r;return function(e,t){const{environment:s,flowId:r,type:o,source:a,spaceId:n,pageId:c}=e;"trusted_domain_page"===a&&n&&m().w(s,{spaceId:n,pageId:c,joinSpaceMethod:"request_to_join"});"current-actor-to-block"===o?d().Xx(s,{button_name:"request-access",flow_id:r,request_access_type:"page"}):"current-actor-to-space-via-team"===o&&d().Xx(s,{button_name:"request-access",flow_id:r,request_access_type:"team"});t.setState({open:!0})}({environment:t,flowId:e.flowId,type:e.type,source:e.source,pageId:null===(s=e.block)||void 0===s?void 0:s.id,spaceId:null===(r=e.block)||void 0===r?void 0:r.spaceId},i)},style:"outline"===e.buttonType?{fontWeight:u().Wy.semibold}:{},children:y?(0,I.jsx)(c().sA,{id:"fullPageError.requestAccessButton.requested",defaultMessage:"Requested access"}):E(e.type)}),A]})};function B(e){let{result:t}=e;return t&&t.error?(0,I.jsx)("div",{style:{color:i().Ay.redWithAlpha(1),textAlign:"center",width:"100%",marginBottom:16},children:t.error}):null}function F(e){e.update((e=>e+1))}function W(e){return e.setState({open:!1})}function N(e){let{error:t,result:s,ready:n,requestAttemptStore:i,messageStore:l,type:d}=e;const p=(0,c().tz)(),m=(0,o().WS)(),g=(0,r.useCallback)((()=>F(i)),[i]),f=(0,r.useCallback)((e=>function(e,t){t.setState(e.target.value)}(e,l)),[l]),y=(0,a().K8)((()=>Boolean(0===i.state||n&&s&&s.error)),[i,n,s]),b=(0,a().K8)((()=>l.state||""),[l]);return(0,I.jsxs)(I.Fragment,{children:[!m&&(0,I.jsx)("div",{style:{fontSize:16,fontWeight:u().Wy.semibold,marginBottom:16},children:E(d)}),(0,I.jsx)(h().A,{format:m?h().C.Transparent:void 0,textarea:!0,value:b,onChange:f,disabled:!y,placeholder:p.formatMessage(w.requestAccessMessagePlaceholder),style:{...m?{...S,padding:"16px"}:{...k,marginBottom:16,padding:"8px 12px",alignItems:"flex-start"}}}),!m&&(0,I.jsx)(j().A,{size:"lg",disabled:!y,onClick:g,style:k,children:(0,I.jsx)(c().sA,{defaultMessage:"Send request",id:"requestAccessForm.sendRequestButton.label"})}),(0,I.jsx)(B,{result:s})]})}function P(e){const{requestAttemptStore:t,messageStore:s,buttonPopupStore:n}=e,i=(0,o().v3)(),u=(0,o().WS)(),d=(0,c().tz)(),m=(0,r.useCallback)(((r,o,a)=>(0,I.jsx)(N,{requestAttemptStore:t,messageStore:s,error:r,result:o,ready:a,type:e.type})),[t,s,e.type]),v=(0,a().K8)((()=>{var e;return null===(e=b().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),h=(0,r.useCallback)((t=>async function(e){const{messageStore:t,buttonPopupStore:s,type:r,teamId:o,requestAttempt:a,environment:n,currentUserId:c,intl:i,flowId:u}=e;if(0===a)return;const d=t.state,m=await async function(){if("current-actor-to-block"===r)return g().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-block",block:e.block,message:d}});if("current-actor-to-collection"===r)return g().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-collection",collection:e.collection,message:d}});if("current-actor-to-space-via-team"===r)return g().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-space-via-team",teamId:o,message:d}});if("current-actor-to-space-via-block"===r){if(!c)return;return g().callApi({eventName:"requestAccess",environment:n,data:{type:"actor-to-space",spaceId:e.block.spaceId,message:d,forActorId:c,attributes:{add_permissions_on_approval:!1,origin_type:"trusted_domain_page"}}})}if("current-actor-to-space-via-onboarding"===r){if(!c)return;return g().callApi({eventName:"requestAccess",environment:n,data:{type:"actor-to-space",spaceId:e.spaceId,message:d,forActorId:c,attributes:{add_permissions_on_approval:!1,origin_type:"onboarding"}}})}}();return m?"success"!==m.type?"UserRateLimitResponse"===(null===(y=m.body)||void 0===y?void 0:y.name)?{error:i.formatMessage(w.rateLimitError)}:{error:(0,f().Hu)(i,m)}:("current-actor-to-block"===r?p().T_(n,{request_access_type:"page",flow_id:u,requestId:m.data.requestId}):"current-actor-to-space-via-team"===r?p().T_(n,{request_access_type:"team",flow_id:u}):"current-actor-to-space-via-block"===r?p().T_(n,{request_access_type:"space",flow_id:u,source:"trusted_domain_page"}):"current-actor-to-collection"===r?p().T_(n,{request_access_type:"collection",flow_id:u,requestId:m.data.requestId}):"current-actor-to-space-via-onboarding"===r?p().T_(n,{request_access_type:"space",flow_id:u,source:"onboarding"}):(0,l().HB)(r),s.reset(),{value:!0}):{error:i.formatMessage(w.currentUserNotFound)};var y}({...e,requestAttempt:t,environment:i,intl:d,currentUserId:v})),[i,d,e,v]),j=(0,r.useCallback)((()=>F(t)),[t]),k=(0,r.useCallback)((()=>W(n)),[n]),S=(0,a().O$)(t);return u?(0,I.jsx)(q().A,{menuType:y().gu.Modal,whiteBackground:!0,title:E(e.type),left:C(),onClickLeft:k,right:(0,I.jsx)(c().sA,{id:"requestAccessForm.mobileSend.label",defaultMessage:"Send"}),onClickRight:j,children:(0,I.jsx)(x().A,{debugName:"RequestAccessForm",capture:!0,children:(0,I.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"stretch",alignItems:"stretch",width:"100%",height:"100%"},children:(0,I.jsx)(A().A,{request:S,performRequest:h,render:m})})})}):(0,I.jsx)(x().A,{debugName:"RequestAccessForm",capture:!0,children:(0,I.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-evently",alignItems:"stretch",padding:"20px 28px 24px",width:"340px"},children:[(0,I.jsx)(A().A,{request:S,performRequest:h,render:m}),(0,I.jsx)(_().A,{size:"lg",onClick:k,children:C()})]})})}function L(e){const{type:t,flowId:s,buttonType:n}=e,i=(0,o().v3)(),u="outline"===n?_().A:j().A,[d,m]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),b={attributes:{add_permissions_on_approval:!1,role:(0,a().K8)((()=>(0,v().dL)()),[])?"reader":"read_and_write"},message:void 0};let A;"page"===t?A={...b,type:"current-actor-to-block",block:{id:e.block.id,spaceId:e.block.spaceId}}:"collection"===t?A={...b,type:"current-actor-to-collection",collection:{id:e.collection.id,spaceId:e.collection.spaceId}}:(0,l().HB)(t);const x=(0,r.useCallback)((async()=>{var e;const r=await g().callApi({eventName:"requestAccess",environment:i,data:A});"success"===r.type&&r.data.request?(m(!0),p().T_(i,{request_access_type:t,previous_access_level:"none",requested_access_level:"read_and_write",flow_id:s,requestId:r.data.requestId})):"failed"===r.type&&"UserRateLimitResponse"===(null===(e=r.body)||void 0===e?void 0:e.name)&&y(!0)}),[i,A,t,s]);return(0,I.jsx)(u,{size:"lg",disabled:d||f,disabledFeedback:d||f,onClick:x,children:d?(0,I.jsx)(c().sA,{id:"fullPageError.requestAccessButton.edit.Requested",defaultMessage:"Requested access"}):f?(0,I.jsx)(c().sA,{id:"fullPageError.requestAccessButton.edit.TryAgain",defaultMessage:"Try again later"}):E("page"===t?"current-actor-to-block":"current-actor-to-collection")})}function E(e){return"current-actor-to-space-via-block"===e||"current-actor-to-space-via-onboarding"===e?(0,I.jsx)(c().sA,{defaultMessage:"Request membership",id:"requestAccessForm.requestAccessToSpaceButton.title"}):(0,I.jsx)(c().sA,{defaultMessage:"Request access",id:"requestAccessForm.requestAccessButton.title"})}}}]);