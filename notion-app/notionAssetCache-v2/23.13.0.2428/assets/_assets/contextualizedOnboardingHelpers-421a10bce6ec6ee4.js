"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[11126,62342],{59424:(e,o,n)=>{n.r(o),n.d(o,{getContextualizedOnboardingAnalyticsData:()=>c,getOnboardingProgressPercentage:()=>p,getSpaceIntentOverride:()=>u,getStageName:()=>s,getStages:()=>d,isEducationFlowState:()=>_,isPublicAccessPageRedirect:()=>b,shouldRedirectToJoinSpace:()=>g,shouldShowProgressIndicatorOnStage:()=>m});n(16280);var t=()=>n(313127),a=()=>n(437622),i=()=>n(351360),r=()=>n(151168),l=()=>n(71666);function s(e){const{flowName:o,stageIndex:n,environment:t}=e;return d({flowName:o,environment:t})[n]}function d(e){let{flowName:o,environment:n}=e;const t=n.device.isMobile,a=l().onboardingFlowNameToFlowConfig[o];if(t){if(!a.isEnabledForMobile)throw new Error(`Mobile flow is not enabled for flow name: ${o}`);return a.getMobileStages(n)}if(!a.isEnabledForDesktop)throw new Error(`Desktop flow is not enabled for flow name: ${o}`);return a.getDesktopStages()}function _(e){var o,n;return"education_flow"===e.flowName&&void 0!==(null===(o=e.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.educationRole)&&void 0!==(null===(n=e.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.educationLevel)}function c(e){var o,n,t,l,d,_,c;let{onboardingState:g,spaceJoinOrCreate:b,environment:u}=e;const{currentSpaceStore:p}=i().default.state,m=(0,a().p3)(),f=(null===(o=g.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.userPersona)??m.function,v=(null===(n=g.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.userRole)??m.role,w=(null===(t=g.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.companySize)??m.companySize,S=(null===(l=g.planTypeAndSurveyInfo)||void 0===l?void 0:l.planType)??m.intent,y=(null===(d=g.planTypeAndSurveyInfo)||void 0===d||null===(d=d.surveyResponses)||void 0===d?void 0:d.useCases)??m.useCases,h=(null===(_=g.planTypeAndSurveyInfo)||void 0===_||null===(_=_.surveyResponses)||void 0===_?void 0:_.categories)??m.categories,F=(null===(c=g.planTypeAndSurveyInfo)||void 0===c?void 0:c.collaborativeIntent)??m.collaborativeIntent;return{flow_name:g.flowName,flow_id:g.flowId,stage:s({flowName:g.flowName,stageIndex:g.currentStageIndex,environment:u}),initial_workspace_type:b,is_new_onboarding:!!g.isFirstTimeOnboarding,is_create_or_join:!0,stage_number:g.currentStageIndex,num_of_joinable_spaces:g.joinableSpaces.length,historical_stages:g.historicalStages,selectedPresets:void 0,user_persona:f,user_team_role:v,user_use_cases:y,user_categories:h,user_company_size:w,plan_selection:S,collaborative_intent:F,plan_type:null==p?void 0:p.getPlanType(),stage_duration_in_ms:void 0,onboarding_templates:void 0,trial_id:(0,r().E5)(),performance_marketing_term:g.performanceMarketingTerm,is_invalid_redirect:g.isInvalidRedirect,is_dark_mode:"dark"===u.ThemeStore.state.mode,selected_workflow_templates:g.selectedWorkflowTemplateIds}}function g(e){return"guest_redirect"===e.type||"redirect_page"===e.type||"redirect_space"===e.type}function b(e){return"public_access_page_redirect"===e.type}function u(e){if("form_response_onboarding"===e.flowName)return"string"==typeof(o=e.formSpaceIntent)&&t().ay.includes(o)?e.formSpaceIntent:"personal";var o}function p(e,o){const{currentStageIndex:n}=e;return 15+(n+1)/d({flowName:e.flowName,environment:o}).length*80}function m(e,o){const n=o.device.isMobile,{currentStageIndex:t}=e,a=d({flowName:e.flowName,environment:o}).indexOf(n?"mobile_onboarding_plan_type_choose":"onboarding_plan_type_choose");return-1!==a&&t>=a}},71666:(e,o,n)=>{n.r(o),n.d(o,{onboardingFlowNameToFlowConfig:()=>p});var t=n.n(n(794148)),a=()=>n(677338),i=()=>n(867899),r=()=>n(496414),l=()=>n(989423),s=()=>n(285518),d=()=>n(144114),_=()=>n(351360),c=()=>n(508496),g=()=>n(589994),b=()=>n(151168);var u=()=>n(322920);const p={education_flow:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","education_persona_survey","education_category_picker"],onStartFlow:()=>{},shouldShowFlowToUser:e=>!1},ai_onboarding_phase_2:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","app_builder","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const o=(0,s().R)(_().default.state.currentUserRootStore);void 0===o&&(0,l().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const n=0===(o??0),t=e.device.isMobile;return n&&!t&&!!a().v()&&"on"===c().default.getEligibleGroup({experimentId:"ai_builder_onboarding_flow",defaultGroup:"control"})}},form_response_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose"],getMobileStages:()=>["mobile_profile","mobile_onboarding_workspace_choose"],onStartFlow:()=>{},onCompleteFlow:async(e,o,a)=>{t()("form_response_onboarding"===o.flowName);const{defaultOnboardingComplete:r}=await i().F.contextualizedOnboardingActions.load();await r(e,a),n(464510).V(o.formResponseId,o.secretKey,o.formSpaceId)},shouldShowFlowToUser:()=>0===(0,s().R)(_().default.state.currentUserRootStore)&&(0,n(326406).A)()},mail_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async(e,o,t)=>{const{setAndTrackContextualizedOnboardingComplete:a}=await i().F.contextualizedOnboardingActions.load(),{onboardingData:l,joinableSpaces:s}=o;if(!l)return;const{onboardingStateActions:_}=await n(935370).onboardingActionsDependency.load();if(r().m({message:_.messages.creatingWorkspace}),0===s.length&&l.canUserCreateSpace){const t=n(972435).A.getIntl(),i=l.userStore.getFullName(t),{spaceViewStore:r}=await n(426116).bz({environment:e,planType:"personal",name:(0,d().JR)(i||"",t),userRootStore:l.userRootStore,analyticsFrom:"onboarding",icon:void 0,userPersona:"unfilled"});n(72234).I$(e,r,!0),a({environment:e,onboardingState:o,userStore:l.userStore,spaceJoinOrCreate:"create",permissionLevel:"member"})}await g().transactionQueue.drain(),r().V(),await(0,n(838824).Z)({environment:e,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>"mail"===(0,a().dY)()},calendar_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile"],getMobileStages:()=>["mobile_profile"],onStartFlow:()=>{},onCompleteFlow:async(e,o,t)=>{await g().transactionQueue.drain(),await(0,n(645200).J7)({environment:e,url:`${n(780054).A.domainBaseUrl}/calendarAuth/`,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>0===(0,s().R)(_().default.state.currentUserRootStore)&&"calendar"===(0,a().dY)()},performance_marketing_term_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_invite"],onStartFlow:()=>{},onCompleteFlow:async(e,o,n)=>{const{defaultOnboardingComplete:t}=await i().F.contextualizedOnboardingActions.load();await t(e,n)},shouldShowFlowToUser:e=>!e.device.isMobile&&("gantt"===(0,b().TQ)()||"crm"===(0,b().TQ)()||"projectManagement"===(0,b().TQ)())},mobile_tutorial_onboarding:{isEnabledForDesktop:!1,isEnabledForMobile:!0,getMobileStages:e=>(0,u().getMobileTutorialStages)(e),onStartFlow:()=>{},onCompleteFlow:async(e,o,n)=>{var t,a;const r=o.onboardingData;if(!r)return;const{redirectAfterContextualizedOnboardingComplete:l}=await i().F.contextualizedOnboardingActions.load(),s=(0,d().sg)(r);await l({environment:e,spaceViewId:null===(t=_().default.state.currentSpaceViewStore)||void 0===t?void 0:t.id,spaceId:null===(a=_().default.state.currentSpaceStore)||void 0===a?void 0:a.id,onboardingData:r,spaceJoinOrCreate:"join",redirectData:s,onboardingFlow:o.flowName,onboardingState:o,permissionLevel:(0,d().S1)(s)})},shouldShowFlowToUser:(e,o)=>!!o},default:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","onboarding_category_survey",..."on"===c().default.getEligibleGroup({experimentId:"onboarding_split_team_survey",defaultGroup:"control",disableExposureLogging:!0})?["team_onboarding_function","team_onboarding_role","team_onboarding_company_size"]:["team_onboarding_persona_survey"],"team_onboarding_use_cases","team_onboarding_workspace_create","team_onboarding_invite","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],getMobileStages:e=>[...["mobile_profile","mobile_onboarding_workspace_choose","mobile_onboarding_plan_type_choose","mobile_onboarding_collaborative_intent_choose",..."on"===c().default.getEligibleGroup({experimentId:"onboarding_split_team_survey",defaultGroup:"control",disableExposureLogging:!0})?["mobile_team_onboarding_function","mobile_team_onboarding_role","mobile_team_onboarding_company_size"]:["mobile_team_onboarding_persona_survey"],"mobile_onboarding_category_survey","mobile_team_onboarding_use_cases","mobile_team_onboarding_workspace_create","mobile_team_onboarding_invite"],...(0,u().getMobileTutorialStages)(e)],onStartFlow:()=>{},shouldShowFlowToUser:(e,o)=>(void 0===(0,s().R)(_().default.state.currentUserRootStore)&&(0,l().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}}),!o)},undefined:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async()=>{},shouldShowFlowToUser:()=>!1}}},285518:(e,o,n)=>{n.d(o,{R:()=>a});n(898992),n(354520),n(581454);var t=()=>n(496603);function a(e){return e&&e.isReady()?t().sb(e.getSpaceViewStores().filter((e=>e.getJoined())).map((e=>e.getSpaceId()))).length:void 0}},322920:(e,o,n)=>{n.r(o),n.d(o,{getContextualizedOnboardingFlowName:()=>r,getMobileTutorialStages:()=>l});var t=()=>n(820103),a=()=>n(47373),i=()=>n(71666);function r(e,o){for(const n of t().uL){if(i().onboardingFlowNameToFlowConfig[n].shouldShowFlowToUser(e,o))return n}return t().JT}function l(e){switch((0,a().DV)({environment:e})){case"v1":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share","mobile_onboarding_multi_platform"];case"v2":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share"];case"v3":return["mobile_onboarding_skill_mab","mobile_onboarding_skill_filing","mobile_onboarding_skill_swipe"];default:return["mobile_onboarding_editor","mobile_onboarding_sidebar","mobile_onboarding_desktop","mobile_onboarding_web_clipper","mobile_onboarding_app_download"]}}}}]);