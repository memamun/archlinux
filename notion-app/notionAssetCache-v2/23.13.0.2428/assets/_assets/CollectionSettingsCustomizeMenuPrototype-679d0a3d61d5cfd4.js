"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[39778],{11356:(e,t,n)=>{n.d(t,{G:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M7.3 1.995a.55.55 0 1 0 0 1.1h5.4a.55.55 0 0 0 0-1.1zm-2.35 2.8a.55.55 0 0 1 .55-.55h9a.55.55 0 0 1 0 1.1h-9a.55.55 0 0 1-.55-.55m-1.987 3.75c0-1.174.951-2.125 2.125-2.125h9.825c1.174 0 2.125.951 2.125 2.125v6.45a2.125 2.125 0 0 1-2.125 2.125H5.088a2.125 2.125 0 0 1-2.125-2.125zm2.125-.875a.875.875 0 0 0-.875.875v6.45c0 .483.392.875.875.875h9.825a.875.875 0 0 0 .875-.875v-6.45a.875.875 0 0 0-.875-.875z"})},i=(0,n(340498).wt)("stack",o)},14192:(e,t,n)=>{n.r(t),n.d(t,{CollectionSettingsCustomizeMenuPrototype:()=>H});n(898992),n(354520);var o=n(296540),i=()=>n(484714),l=()=>n(56366),s=()=>n(401497),r=()=>n(663077),a=()=>n(952816),c=()=>n(735695),u=()=>n(497222),d=()=>n(963589),p=(n(16280),n(944114),n(672577),n(581454),()=>n(959013)),m=()=>n(534177),g=()=>n(939740),f=()=>n(89924);const v=(0,o.createContext)(void 0);function h(){const e=(0,o.useContext)(v);if(!e)throw new Error("useWorkflowTemplatesCustomizeContext must be used within a WorkflowTemplatesCustomizeContextProvider");return e}v.displayName="WorkflowTemplatesCustomizeContext";var y=()=>n(376415),S=()=>n(272752),x=()=>n(44750),T=()=>n(666990),w=()=>n(340498),C=()=>n(686526),k=()=>n(736982),I=()=>n(913454),b=()=>n(204067),F=()=>n(362941),j=n(474848);const M=["linked_collection","collection_view","property"],_={property:{getTitleFn:e=>e.formatMessage({id:"workflowFeatureGroupMenuItem.propertiesTitle",defaultMessage:"Properties"}),icon:n(202017).n,getCaptionFn:function(e){const t=e.getSchema();return z({collectionStore:e,featureType:"property",primitiveIds:Object.keys(t),getPrimitiveName:e=>{var n;return null===(n=t[e])||void 0===n?void 0:n.name}})},navigateFn:function(e){C().a2({collectionSettingsStore:e,item:{type:"properties",timelineViewTab:"timeline"}})},shouldRenderFn:()=>!0},collection_view:{getTitleFn:e=>e.formatMessage({id:"workflowFeatureGroupMenuItem.viewsTitle",defaultMessage:"Views"}),icon:n(11356).G,getCaptionFn:function(e){var t;const n=(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores())??[];return z({collectionStore:e,featureType:"collection_view",primitiveIds:n.map((e=>e.id)),getPrimitiveName:e=>{var t;return null===(t=n.find((t=>t.id===e)))||void 0===t?void 0:t.getName()}})},navigateFn:function(e){C().a2({collectionSettingsStore:e,item:{type:"views"}})},shouldRenderFn:()=>!0},linked_collection:{getTitleFn:e=>e.formatMessage({id:"workflowFeatureGroupMenuItem.linkedCollectionsTitle",defaultMessage:"Linked to"}),icon:n(955363).N,getCaptionFn:function(e){const t=A(e).map((e=>e.name));return(0,I().getWorkflowTemplateItemsCaption)(t)},navigateFn:function(e){C().a2({collectionSettingsStore:e,item:{type:"linked_collections"}})},shouldRenderFn:function(e){return A(e).length>0}}};function P(e){let{buttonMenuItemProps:t,featureGroupType:n}=e;const o=(0,p().tz)(),i=(0,s().IS)((()=>({iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{width:w().Ev.default,height:w().Ev.default}})),[]),{collectionStore:r,collectionSettingsStore:a}=(0,S().V)(),{getTitleFn:c,icon:u,getCaptionFn:d,navigateFn:m}=_[n],g=c(o),f=(0,l().K8)((()=>d(r)),[r,d]);return(0,j.jsx)(k().I,{buttonMenuItemProps:t,title:g,caption:f,icon:(0,j.jsx)("div",{style:i.iconContainer,children:u(i.icon)}),right:(0,j.jsx)(F()._,{}),onClick:()=>m(a)})}function z(e){let{collectionStore:t,featureType:n,primitiveIds:o,getPrimitiveName:i}=e;if(0===o.length)return;const l=(0,b().rS)(t,n).map((e=>e.id)),s=[...o].sort(((e,t)=>l.indexOf(t)-l.indexOf(e))).map((e=>i(e))).filter(p().Vq).filter((e=>e.length>0));return 0!==s.length?(0,I().getWorkflowTemplateItemsCaption)(s):void 0}function A(e){const t=e.getSchema();return Object.values(t).filter(p().Vq).filter((e=>"relation"===e.type))}function V(){const{suggestedTemplates:e,legacyUnpackagedFeatureTemplates:t}=h(),n=function(){const e=function(){const{collectionTemplate:e,instantiatedTemplates:t}=h(),n=(null==e?void 0:e.value.templateItems.filter((e=>!0===e.isInSettings)).map((e=>e.pointer)))??[],o=[];for(const i of n){const e=t.find((e=>e.templateId===i));if(e){if(!(0,r().bz)(e))throw new Error("Template in settings must be feature templates");o.push(e)}}return o}(),{collectionStore:t,collectionContextStore:n}=(0,S().V)(),o=(0,i().v3)(),s=(0,l().K8)((()=>e.map((e=>(0,x().Z)({template:e,isInSuggestedSection:!1,collectionContextStore:n,environment:o})))),[n,o,e]),{legacyUnpackagedFeatureTemplates:a}=h(),c=a.filter((e=>e.isInstalled)).map((e=>(0,T().d)({legacyUnpackagedFeatureTemplate:e,collectionContextStore:n}))),u=(0,l().K8)((()=>M.filter((e=>function(e){let{collectionStore:t,featureGroupType:n}=e;return _[n].shouldRenderFn(t)}({collectionStore:t,featureGroupType:e}))).map((e=>({key:e,action:()=>{},render:t=>(0,j.jsx)(P,{buttonMenuItemProps:t,featureGroupType:e})})))),[t]);return{key:"general",render:e=>(0,j.jsx)(f().A,{...e,title:"General"}),items:[...s,...c,...u]}}(),o=(0,p().tz)(),{device:{isMobile:s}}=(0,i().v3)(),a=[...n.items.length>0?[n]:[],(0,y().i)({title:o.formatMessage({id:"workflowCustomizeList.suggestedSectionTitle",defaultMessage:"Suggested"}),templates:s?e.filter((e=>!("property"===e.type&&"relation"===e.value.type))):e,legacyUnpackagedFeatureTemplates:t.filter((e=>!e.isInstalled)),isSuggestedSection:!0})].filter(m().Vq);return(0,j.jsx)(g().Ay,{disableInitialScroll:!0,type:g().Oh.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:a})}var U=()=>n(557336),G=()=>n(405417);function N(e){const t=[],n=Boolean((0,G().r6)(e));t.push({type:"subitems",isInstalled:n});const o=Boolean((0,U().QZ)({feature:"timeline_arrows_by",collectionContextStore:e}));return t.push({type:"dependencies",isInstalled:o}),t}var O=()=>n(200277),B=()=>n(970013),E=()=>n(901389),Z=()=>n(317909),K=()=>n(780054);var R=()=>n(368472),W=()=>n(95347);function H(e){let{collectionTemplate:t}=e;const n=(0,i().v3)(),{collectionStore:o,collectionSettingsStore:p,collectionContextStore:m}=(0,S().V)(),g=(0,W().C5)(m),f=(0,d().X)("workflow_templates_builder"),{instantiatedTemplates:h,suggestedTemplates:y,legacyUnpackagedFeatureTemplates:x}=(0,l().K8)((()=>({instantiatedTemplates:(0,b().Xg)(n,o).filter(r().Jb),suggestedTemplates:(0,O().N)(n,o),legacyUnpackagedFeatureTemplates:N(m)})),[n,o,m]),T=(0,s().IS)((()=>({header:{display:"flex",alignItems:"center"},title:{overflow:"hidden",textOverflow:"ellipsis"},searchInput:{padding:4}})),[]);return t?(0,j.jsx)(c().Ay,{collectionSettingsStore:p,title:(0,j.jsx)("div",{style:T.header,children:(0,j.jsx)("div",{style:T.title,children:`Customize ${g}`})}),children:(0,j.jsxs)(v.Provider,{value:{collectionTemplate:t,instantiatedTemplates:h,suggestedTemplates:y,legacyUnpackagedFeatureTemplates:x},children:[(0,j.jsx)(V,{}),(0,j.jsx)(R().IB,{collectionContextStore:m,collectionSettingsStore:p,children:f&&(0,j.jsx)(u().A,{icon:a().E,onClick:()=>{!function(e){const{environment:t,collectionContextStore:n}=e,{env:o}=K().A;if("production"===o)return;const i=e=>{E().k5(e,o)},l=n.collectionStore();if(!l)return void i("No collection store!");const s=l.getModel();if(!s)return void i("No collection model!");const r=[];Z().createAndCommit({environment:t,userAction:"collectionFixingActions.fixCollection",canUndo:!0,perform(e){const t=s.getSchema()[B().rn];t&&"title"===t.type||(r.push("missing/malformed title property"),Z().applyOperation({store:l,operation:{pointer:l.pointer,path:["schema",B().rn],command:"set",args:{type:"title",name:"Name"}},transaction:e}))}}),0===r.length?i("The database seems fine."):i(`Applied the following fixes: ${r.join(", ")}`)}({environment:n,collectionContextStore:m})},title:"Fix database (Dev)"})})]})}):null}},376415:(e,t,n)=>{n.d(t,{i:()=>v});n(581454);var o=n(296540),i=()=>n(484714),l=()=>n(56366),s=()=>n(401497),r=()=>n(30626),a=()=>n(959013),c=()=>n(736982),u=()=>n(89924),d=()=>n(175116),p=()=>n(44750),m=()=>n(666990),g=n(474848);const f=3;function v(e){let{title:t,templates:n,legacyUnpackagedFeatureTemplates:v,isSuggestedSection:h,additionalItems:y=[]}=e;const S=(0,s().IS)((e=>({title:{color:e.mediumTextColor},iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{width:18,height:18,fill:e.mediumTextColor}})),[]),x=(0,d().ET)(),T=(0,i().v3)(),[w,C]=(0,o.useState)(!1),k=[...(0,l().K8)((()=>n.map((e=>(0,p().Z)({template:e,isInSuggestedSection:h,collectionContextStore:x,environment:T})))),[x,T,h,n]),...v.map((e=>(0,m().d)({legacyUnpackagedFeatureTemplate:e,collectionContextStore:x}))),...y];if(0===k.length)return;const I={key:`${t}-toggle-truncation`,action:()=>{C(!w)},render:e=>(0,g.jsx)(c().I,{buttonMenuItemProps:e,title:(0,g.jsx)("div",{style:S.title,children:w?(0,g.jsx)(a().sA,{id:"useFeatureTemplatesSection.showLess",defaultMessage:"Show less"}):(0,g.jsx)(a().sA,{id:"useFeatureTemplatesSection.showMore",defaultMessage:"More"})}),icon:(0,g.jsx)("div",{style:S.iconContainer,children:(0,r()._)(S.icon)})})},b=w?k:k.slice(0,f);return{key:t,render:e=>(0,g.jsx)(u().A,{...e,title:t}),items:[...b,...k.length>f?[I]:[]]}}},666990:(e,t,n)=>{n.d(t,{d:()=>g});n(296540);var o=()=>n(401497),i=()=>n(148307),l=()=>n(632625),s=()=>n(959013),r=()=>n(534177),a=()=>n(686526),c=()=>n(736982),u=()=>n(760578),d=()=>n(362941),p=()=>n(342288),m=n(474848);function g(e){let{legacyUnpackagedFeatureTemplate:t,collectionContextStore:n}=e;return{key:t.type,action:()=>{const e=n.settingsStore;switch(t.type){case"subitems":a().a2({collectionSettingsStore:e,item:{type:"subitemV2",from:"customize_menu"}});break;case"dependencies":a().a2({collectionSettingsStore:e,item:{type:"dependencies",from:"customize_menu"}});break;default:(0,r().HB)(t.type)}},render:e=>(0,m.jsx)(v,{legacyFeature:t,buttonMenuItemProps:e})}}function f(e,t,n){const o=t=>{const n={items:"items"};return{title:(0,m.jsx)(s().sA,{...(0,u().mv)({feature:t,databaseType:void 0}),values:n}),caption:e.formatMessage((0,u().I_)({feature:t,databaseType:void 0}),n)}},a=t.accentColors.brown,c=e=>(0,m.jsx)("div",{style:{height:28,width:28,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",background:n.isInstalled?void 0:a[30]},children:(0,m.jsx)(l().A,{icon:e,theme:t,size:16,style:{fill:n.isInstalled?t.regularIconColor:a[400]}})});switch(n.type){case"subitems":return{...o("subitem"),icon:c(i().A.images.appPackages.featureSubtasksSvg)};case"dependencies":return{...o("timeline_arrows_by"),icon:c(i().A.images.appPackages.featureDependenciesSvg)};default:(0,r().HB)(n.type)}}function v(e){const{legacyFeature:t,buttonMenuItemProps:n}=e,i=(0,s().tz)(),l=(0,o().DP)();return(0,m.jsx)(c().I,{buttonMenuItemProps:n,...f(i,l,t),right:t.isInstalled?(0,m.jsx)(d()._,{}):(0,m.jsx)(p().z,{isAdded:!1})})}},952816:(e,t,n)=>{n.d(t,{E:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("bug",{viewBox:"0 0 64 64",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"m32,8c-5.55,0-9,3.83-9,10h18c0-6.17-3.45-10-9-10Z"}),(0,o.jsx)("path",{d:"m48,36h12v-4h-12v-6.01c2.74-.06,4.78-.94,6.76-2.92l4.24-4.24-2.83-2.83-4.24,4.24c-1.3,1.3-2.41,1.76-4.24,1.76h-13.69v32c6.15,0,10.63-3.12,12.7-8.47l1.54,1.54c1.3,1.3,1.76,2.41,1.76,4.24v2.69h4v-2.69c0-2.9-.88-5.02-2.93-7.07l-3.26-3.26c.12-.95.19-1.94.19-2.98v-2Z"}),(0,o.jsx)("path",{d:"m12.07,20.24l-4.24-4.24-2.83,2.83,4.24,4.24c1.98,1.98,4.02,2.85,6.76,2.92v6.01H4v4h12v2c0,1.04.07,2.03.19,2.98l-3.26,3.26c-2.05,2.05-2.93,4.17-2.93,7.07v2.69h4v-2.69c0-1.83.46-2.95,1.76-4.24l1.54-1.54c2.08,5.35,6.55,8.47,12.7,8.47V22h-13.69c-1.83,0-2.95-.46-4.24-1.76Z"})]})})}}]);