"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[23133],{3197:(e,t,o)=>{o.d(t,{t:()=>s});var n=o(296540),r=()=>o(183558),i=()=>o(248064),l=()=>o(384130),a=()=>o(937199);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,a().LH)(),s=(0,i().h)(),{dismissTooltip:d}=(0,l().J)();return(0,n.useCallback)((()=>{var n;"form"===(null===(n=o.getModel())||void 0===n?void 0:n.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,r().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&d())}),[o,e,s,t,d])}},156275:(e,t,o)=>{o.d(t,{F:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowLeftRounded",{viewBox:"0 0 16 13",svg:(0,n.jsx)("path",{d:"M0.617188 6.85156C0.617188 6.60677 0.710938 6.39323 0.898438 6.21094L6.03906 1.07812C6.13281 0.984375 6.23177 0.914062 6.33594 0.867188C6.4401 0.820312 6.54948 0.796875 6.66406 0.796875C6.90365 0.796875 7.10417 0.875 7.26562 1.03125C7.42708 1.1875 7.50781 1.38281 7.50781 1.61719C7.50781 1.74219 7.48438 1.85677 7.4375 1.96094C7.39062 2.0599 7.32812 2.14844 7.25 2.22656L5.5 4L2.59375 6.66406L2.3125 6.15625L5.02344 5.99219H14.5156C14.776 5.99219 14.9844 6.07292 15.1406 6.23438C15.3021 6.39062 15.3828 6.59635 15.3828 6.85156C15.3828 7.10156 15.3021 7.30729 15.1406 7.46875C14.9844 7.625 14.776 7.70312 14.5156 7.70312H5.02344L2.3125 7.54688L2.59375 7.04688L5.5 9.70312L7.25 11.4688C7.32812 11.5469 7.39062 11.638 7.4375 11.7422C7.48438 11.8464 7.50781 11.9583 7.50781 12.0781C7.50781 12.3125 7.42708 12.5078 7.26562 12.6641C7.10417 12.8203 6.90365 12.8984 6.66406 12.8984C6.4349 12.8984 6.22917 12.8099 6.04688 12.6328L0.898438 7.49219C0.710938 7.3099 0.617188 7.09635 0.617188 6.85156Z"})})},248064:(e,t,o)=>{o.d(t,{h:()=>s});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(978846),a=()=>o(937199);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,a().LH)(),d=(0,r().v3)(),c=(0,i().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),u="form"===c?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,n.useCallback)((n=>{const{layoutModule:r,transaction:i}=n;if(!e.getModel()||!u||"form_conditional_modules"===u)return;let a;if("form"===c)a=n.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;a="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,l().UQ)({environment:d,sessionId:s,layoutStore:e,position:a,module:r,transaction:i,isPropertyCreation:!1}),o({type:"existing_module",moduleId:r.id,isDragging:!1})}),[u,t,d,e,c,s,o])}},261164:(e,t,o)=>{o.d(t,{o:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowRightRounded",{viewBox:"0 0 16 13",svg:(0,n.jsx)("path",{d:"M15.3828 6.85156C15.3828 7.09635 15.2917 7.3099 15.1094 7.49219L9.95312 12.6328C9.77083 12.8099 9.5651 12.8984 9.33594 12.8984C9.09635 12.8984 8.89583 12.8203 8.73438 12.6641C8.57812 12.5078 8.5 12.3125 8.5 12.0781C8.5 11.9583 8.52083 11.8464 8.5625 11.7422C8.60938 11.638 8.67188 11.5469 8.75 11.4688L10.5 9.70312L13.4141 7.04688L13.6875 7.54688L10.9766 7.70312H1.48438C1.22396 7.70312 1.01302 7.625 0.851562 7.46875C0.695312 7.30729 0.617188 7.10156 0.617188 6.85156C0.617188 6.59635 0.695312 6.39062 0.851562 6.23438C1.01302 6.07292 1.22396 5.99219 1.48438 5.99219H10.9766L13.6875 6.15625L13.4141 6.66406L10.5 4L8.75 2.22656C8.67188 2.14844 8.60938 2.0599 8.5625 1.96094C8.52083 1.85677 8.5 1.74219 8.5 1.61719C8.5 1.38281 8.57812 1.1875 8.73438 1.03125C8.89583 0.875 9.09635 0.796875 9.33594 0.796875C9.45052 0.796875 9.5599 0.820312 9.66406 0.867188C9.76823 0.914062 9.86719 0.984375 9.96094 1.07812L15.1094 6.21094C15.2917 6.39323 15.3828 6.60677 15.3828 6.85156Z"})})},290966:(e,t,o)=>{o.d(t,{E_:()=>T,HQ:()=>j,I5:()=>B,ZQ:()=>k});o(16280),o(898992),o(823215),o(354520),o(581454),o(296540);var n=()=>o(662303),r=()=>o(428045),i=()=>o(134025),l=()=>o(912720),a=()=>o(179034),s=()=>o(519831),d=()=>o(869558),c=()=>o(144081),u=()=>o(921515),p=()=>o(959013),m=()=>o(496603),f=()=>o(534177),S=()=>o(284371),y=()=>o(966759),v=()=>o(235191),g=()=>o(901389),h=()=>o(317909),_=()=>o(67103),C=()=>o(16006),w=()=>o(972435),I=()=>o(470928),x=()=>o(630116),b=()=>o(913454),L=()=>o(204067),M=o(474848);function k(e){let{transaction:t,collectionStore:o,templateId:n,instance:r,logger:p}=e;p.debug(`Creating/updating ${u().rM} record for "${n}".`);const m=o.getSpaceId(),S=r.id;if("automation"===r.type){const e={table:l().yB,id:S,spaceId:m};h().applyOperation({store:x().dn.createChildStore(o,e),operation:i().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("block"===r.type){const e={table:a().ev,id:S,spaceId:m};h().applyOperation({store:x().Bv.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection"===r.type){const e={table:s().Vl,id:S,spaceId:m};h().applyOperation({store:o,operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection_view"===r.type){const e={table:d().Gy,id:S,spaceId:m};h().applyOperation({store:x().pS.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("layout"===r.type){const e={table:c().zx,id:S,spaceId:m};h().applyOperation({store:x().K_.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("compound"===r.type){if(r.instancePointers.length<2)throw new Error(`Compound template instance ${r.id} must contain 2 or more instances`);const e=r.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,f().HB)(e)}));h().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:n,id:r.id,instance_pointers:e}}},transaction:t})}else"property"===r.type?h().applyOperation({store:o,operation:i().op.update({pointer:o.pointer,path:["schema",r.id],args:{workflow_template_instance:{template_id:n}}}),transaction:t}):(0,f().HB)(r)}function T(e){let{environment:t,collectionStore:o,propertyId:n,compoundTemplateInstancesToDelete:i,collectionContextStore:l,from:a}=e;if(!i.every((e=>e.templateId===r().z$)))return!1;if(!(0,I().Io)())return!1;const s=(0,L().aL)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:i}),d=m().sb(s.filter((e=>"property"===e.type)).map((e=>e.id))),c=o.getSchema(),u=d.map((e=>{var t;if(e===n)return;const o=c[e];if(!o)throw new Error(`Property ${e} not found`);if(o.name)return o.name;const r=null===(t=o.workflow_template_instance)||void 0===t?void 0:t.template_id;if(!r)throw new Error(`Property ${e} has no workflow template id`);const i=b().globalWorkflowTemplates.fromId(r);return(0,b().getWorkflowTemplateName)(i)})).filter(f().O9);return A({environment:t,collectionStore:o,propertyIds:d,otherPropertyNames:u,collectionContextStore:l,from:a}),!0}function B(e){let{environment:t,collectionStore:o,propertyId:n,collectionContextStore:r,from:i}=e;const l=o.getSchema(),a=Object.keys(l).filter((e=>(0,I().Do)({collectionStore:o,propertyId:e})||(0,I().k$)(e))),s=a.map((e=>{var t;if(e===n)return;const r=null===(t=l[e])||void 0===t?void 0:t.name;if(r)return r;if((0,I().Do)({collectionStore:o,propertyId:e}))return w().A.formatMessage(_().Gl.verificationPropertyName);if((0,I().k$)(e))return w().A.formatMessage(_().Gl.ownerPropertyName);throw new Error(`Property ${e} must be a verification or owner property`)})).filter(f().O9);return A({environment:t,collectionStore:o,propertyIds:a,otherPropertyNames:s,collectionContextStore:r,from:i}),!0}function A(e){let{environment:t,collectionStore:o,propertyIds:r,otherPropertyNames:i,collectionContextStore:l,from:a}=e;const s=[{label:(0,M.jsx)(p().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:r.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:n,propertyIds:r,from:i}=e;h().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const l=o.getSchema();for(const a of r){v().BJ({environment:t,collectionStore:o,schema:l,property:a,transaction:e});const r=l[a];r&&(0,y().i)({environment:t,collectionContextStore:n,property_type:r.type,from:i,property:a})}}})}({environment:t,collectionStore:o,collectionContextStore:l,propertyIds:r,from:a})}],d=new Intl.ListFormat(n().locale,{style:"long",type:"conjunction"}),c=(0,M.jsx)(p().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"Delete this property from <bold>{databaseName}</bold>? {otherPropertyNames} will also be deleted",values:{bold:e=>(0,M.jsx)("span",{style:{fontWeight:S().Wy.bold},children:e}),databaseName:(0,M.jsx)(C().A,{style:{display:"inline",fontWeight:S().Wy.bold},shouldWrap:!0,store:o}),otherPropertyNames:d.format(i)}});g().ui({message:(0,M.jsx)("span",{children:c}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:s})}function j(e){const{environment:t,transaction:o,collectionStore:n,instance:r}=e;(0,L().aI)({environment:t,instancePointer:r,inMemoryRecordCache:n.inMemoryRecordCache})||h().applyOperation({store:n,operation:{pointer:n.pointer,command:"keyedObjectListRemove",path:["format","compound_workflow_template_instances"],args:{remove:{id:r.id}}},transaction:o})}},384130:(e,t,o)=>{o.d(t,{J:()=>p,v:()=>u});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(317909),a=()=>o(755199),s=()=>o(186445),d=()=>o(351360);function c(e){let{userSettingsDismissibleKey:t}=e;const o=(0,r().v3)(),c=(0,i().K8)((()=>d().default.state.currentUserSettingsStore),[]),u=(0,i().K8)((()=>{const e=null==c?void 0:c.getSettings();return!e||Boolean(e[t])}),[t,c]),p=(0,i().K8)((()=>{const e=(0,s()._m)(o),t=null==c?void 0:c.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!u}),[o,c,u]),m=n.useCallback((()=>{c&&!u&&p&&l().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{a().mJ({userSettingsStore:c,transaction:e,data:{[t]:Date.now()}})}})}),[o,p,t,c,u]);return{shouldShowTooltip:p,dismissTooltip:m}}function u(){return c({userSettingsDismissibleKey:"layout_info_panel_button_education_tooltip_dismissed_at"})}function p(){return c({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},402137:(e,t,o)=>{o.d(t,{w:()=>s});o(18107),o(967357),o(814603),o(147566),o(198721);const n="://",r="www.",i=/.+\..+\..+/,l=/\.{2,}/,a=/.+\..+/;function s(e){const t=e.trim();if(0===t.length)return!1;if(-1===t.indexOf(".")&&-1===t.indexOf("localhost"))return!1;if("."===t.at(t.length-1)||-1!==t.indexOf(" "))return!1;let o,s=`${-1===t.indexOf(n)?"http://":""}${t}`;try{o=new URL(s)}catch(c){const e=-1===s.indexOf(r),[t,i]=s.split(n);s=`${t}${n}${e?"www.":""}${i}`;try{o=new URL(s)}catch(c){return!1}}const d=o.hostname;return!l.test(d)&&(!(t.includes(r)&&"localhost"!==d&&!i.test(d))&&!("localhost"!==d&&!a.test(d)))}},404085:(e,t,o)=>{o.d(t,{l:()=>r});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M9.381 13.619a.875.875 0 0 0 1.238 0l5.4-5.4A.875.875 0 1 0 14.78 6.98L10 11.763 5.219 6.98A.875.875 0 1 0 3.98 8.22z"})},r=(0,o(340498).wt)("arrowChevronSingleDownFill",n)},412532:(e,t,o)=>{o.d(t,{l:()=>r});o(296540);const n={viewBox:"0 0 16 16",svg:(0,o(474848).jsx)("path",{d:"M13.165 12.75a.8.8 0 0 0 .69-1.203L8.692 2.693a.8.8 0 0 0-1.382 0l-5.165 8.854a.8.8 0 0 0 .691 1.203z"})},r=(0,o(340498).wt)("arrowCaretUpFillSmall",n)},498474:(e,t,o)=>{o.d(t,{q:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowUp",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},542371:(e,t,o)=>{o.d(t,{A:()=>n});class n extends(()=>o(757695))().default{getInitialState(){}}},612900:(e,t,o)=>{o.d(t,{u:()=>i});var n=()=>o(645873);const r=new(n().O2)("PulsingWrapper",(async()=>o.e(45248).then(o.bind(o,673962)))),i=(0,n().jQ)(r,(e=>e.PulsingWrapper),{renderLoading:(e,t)=>t.children})},731120:(e,t,o)=>{o.d(t,{A:()=>n});class n extends(()=>o(757695))().default{getInitialState(){return{isOpen:!1}}}},766911:(e,t,o)=>{o.r(t),o.d(t,{CollectionFormEditorView:()=>q});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(757695),a=()=>o(735695),s=()=>o(101981),d=()=>o(145214),c=()=>o(525432),u=()=>o(630116),p=(o(16280),o(898992),o(672577),()=>o(908006)),m=()=>o(118884),f=()=>o(591779),S=()=>o(206267),y=()=>o(919709),v=()=>o(686526),g=()=>o(725614),h=()=>o(175116),_=()=>o(454305),C=()=>o(753199),w=()=>o(953418),I=()=>o(963589),x=()=>o(11978),b=()=>o(640868),L=()=>o(937199),M=()=>o(421682),k=()=>o(817942),T=()=>o(731120),B=()=>o(542371),A=()=>o(104129);class j extends l().default{getInitialState(){return{openTooltip:void 0}}}class E extends l().default{getInitialState(){return{conditionalGroupCollapsedStates:{}}}}var O=()=>o(24157),K=()=>o(611371),P=()=>o(134217),D=()=>o(847554),R=()=>o(749240);class $ extends l().default{getInitialState(){}autofocusQuestionDescription(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"description"})}autofocusQuestionTitle(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"title"})}clear(){this.setState(void 0)}}var W=()=>o(348241),Q=o(474848);function V(e){let{collectionContextStore:t,collectionViewStore:o,layoutStore:l,headingWidth:a,isCollectionEmpty:s}=e;const d=(0,r().v3)(),c=(0,i().uB)(void 0,B().A),u=(0,i().uB)(void 0,E),p=(0,i().uB)(void 0,j),m=(0,x().O)(),f=(0,i().O$)(R().subscriptionDataStoreInstance),S=(0,D().b)(f);return(0,n.useEffect)((()=>{m&&f&&P().V$(d,m,f,S)&&K().He(d)}),[d,m,f,S]),(0,Q.jsx)(F,{collectionContextStore:t,collectionViewStore:o,layoutStore:l,layoutBuilderModuleSelectionStore:c,formConditionalGroupsStore:u,formAddConditionalLogicTooltipStore:p,headingWidth:a,isCollectionEmpty:s,children:(0,Q.jsx)(N,{children:(0,Q.jsx)(k().Mx,{type:"form",children:(0,Q.jsx)(M().J,{area:"form_layout_schema"})})})})}function F(e){let{children:t,collectionContextStore:o,collectionViewStore:a,layoutStore:s,layoutBuilderModuleSelectionStore:d,formConditionalGroupsStore:c,formAddConditionalLogicTooltipStore:u,headingWidth:f,isCollectionEmpty:C}=e;const I=(0,r().v3)(),x=(0,i().K8)((()=>o.collectionStore()),[o]),[M]=(0,n.useState)(S().JW()),k=(0,i().K8)((()=>d.getState()),[d]),B=(0,i().uB)(void 0,T().A),j=(0,i().uB)(void 0,$),E=(0,i().uB)(void 0,_().A),O=l().default.createValue(!1,{name:"headerFocusStore"}),K=(0,i().K8)((()=>o.permissionScopesStore.state.canConfigureCollection),[o]),P=(0,i().K8)((()=>a.getFormBlockStore()),[a]),D=(0,i().K8)((()=>I.WindowSizeStore.state.height),[I.WindowSizeStore]),R=(0,n.useCallback)((e=>{var t;const n=d.getState(),r=s.getModules();if(n&&"existing_module"===n.type){var i;const t=null===(i=r.form_conditional_modules)||void 0===i?void 0:i[n.moduleId],o=void 0!==t?t:r.form_layout_schema.find((e=>e.id===n.moduleId));!o||"placeholder"!==o.type||t||e&&("existing_module"!==e.type||n.moduleId===e.moduleId)||(0,b().U)({environment:I,position:{area:t?"form_conditional_modules":"form_layout_schema",moduleId:o.id},layoutStore:s,sessionId:M})}if(d.setState(e),(e||n)&&g().clear({environment:I}),!e||"existing_module"!==e.type||e.isDragging)return;if(!x)return;const l=s.getModuleById(e.moduleId);if(!l)return;const a=void 0!==(null===(t=r.form_conditional_modules)||void 0===t?void 0:t[l.id]);p().default.afterNextFlush((()=>{const t=A().A.findModuleContainer({layoutStore:s,moduleId:l.id}),n=null==t?void 0:t.getNode(),r={current:n??null},i=null==n?void 0:n.getBoundingClientRect();switch(((null==i?void 0:i.bottom)??0)+120>D&&(0,w().vq)(n,{edgeDist:.5*D,animate:!0}),l.type){case"formQuestion":v().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore,ref:r}),v().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionEditSettings",formQuestionId:l.formQuestionId,moduleId:l.id},ref:r});break;case"placeholder":v().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore}),v().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionCreateSettings",moduleId:l.id,area:a?"form_conditional_modules":"form_layout_schema",parentModuleId:l.parentModuleId,parentConditionalGroupId:l.parentConditionalGroupId},ref:r});break;default:throw new Error("Unexpected module type")}d.setState(e)}))}),[d,x,s,I,M,D,o]),V=l().default.createValue(!1),F=(0,n.useMemo)((()=>({collectionStore:x,layoutStore:s,currentModuleSelection:k,setModuleSelection:R,sessionId:M,addModuleHoverMenuStore:B,canEditLayout:K,isPropertyTypeSearchInputDirtyStore:V,layoutBuilderModuleSelectionStore:d})),[x,s,k,R,M,B,K,V,d]),N=(0,n.useMemo)((()=>{if(!x||!P)throw new Error("Need a collection store and form block store to build the form context");return{formConditionalGroupsStore:c,formAddConditionalLogicTooltipStore:u,autofocusedQuestionTextStore:j,formBlockStore:P,headerMouseStore:E,headerFocusStore:O,collectionStore:x,isCollectionEmpty:C}}),[j,P,c,u,O,E,x,C]);(0,n.useEffect)((()=>{o.formsBaseLayoutEditorContextValueStore.setState(F),o.formsSpecificLayoutEditorContextValueStore.setState(N)}),[o,F,N]);const H=(0,n.useRef)(!1);(0,n.useEffect)((()=>{if(!1===H.current&&P&&P.isReady()){H.current=!0;const e=P.getTitleStore();e&&!y().q4_(e.getValue())&&g().setSelectionAtEnd({store:e})}}),[P,H]);const q=(0,n.useCallback)((()=>{R(void 0),v().os({collectionSettingsStore:o.settingsStore})}),[o.settingsStore,R]);return(0,m().X)(q),x&&a?(0,Q.jsx)(h().RI,{value:o,children:(0,Q.jsx)(L().Op.Provider,{value:F,children:(0,Q.jsx)(W().zi.Provider,{value:N,children:t})})}):null}function N(e){let{children:t}=e;const o=(0,I().X)("db_ux_simplification_next"),{setModuleSelection:r,currentModuleSelection:l,layoutStore:a}=(0,L().LH)(),s=(0,h().ET)(),d=(0,i().K8)((()=>s.settingsStore.state.open),[s]),c=(0,f().ZC)(d),u=(0,n.useCallback)((()=>{r(void 0)}),[r]);(0,n.useEffect)((()=>{c&&!d&&u()}),[u,d,c]);const p=(0,i().K8)((()=>(O().default.state,O().default.getRootFormQuestionStoreOfSelection())),[]),m=(0,i().K8)((()=>"existing_module"===(null==l?void 0:l.type)?a.getModuleById(l.moduleId):void 0),[l,a]);return(0,n.useEffect)((()=>{p&&m&&"formQuestion"===(null==m?void 0:m.type)&&p.id!==m.formQuestionId&&(u(),v().os({collectionSettingsStore:s.settingsStore}))}),[u,s.settingsStore,m,p]),(0,Q.jsx)("div",{style:{marginTop:o?12:void 0,paddingBottom:96,cursor:"default"},onClick:e=>{(0,C().SQ)({event:e,context:C().y$.EditorClick,callback:()=>{u()}})},children:t})}const H=l().default.createClass(void 0,{name:"ReducerResultStore"});function q(e){const{paddingLeft:t,paddingRight:o,collectionContextStore:n,headingWidth:l}=e,p=(0,r().v3)(),m=(0,i().K8)((()=>p.device.isMobile),[p.device]),f=(0,i().K8)((()=>n.collectionViewStore()),[n]),S=(0,i().K8)((()=>n.settingsStore),[n]),y=(0,i().K8)((()=>{if(f)return f.getFormBlockStore()}),[f]),v=(0,i().K8)((()=>{if(!y)return;const e=null==y?void 0:y.getFormat().form_layout_pointer;return e?u().K_.createChildStore(y,e):void 0}),[y]),g=(0,i().K8)((()=>null==v?void 0:v.isDefined()),[v]),h=(0,i().K8)((()=>null==y?void 0:y.isDefined()),[y]),_=(0,i().K8)((()=>"sidebar"===(0,c().DN)(n,m,l)&&S.state.open),[n,S,l,m]),C=(0,i().uB)(void 0,H),w=(0,i().K8)((()=>!!C.state&&0===C.state.blockIds.length),[C]);return f&&v&&g&&h?(0,Q.jsxs)("div",{style:{paddingLeft:t,paddingRight:o},children:[(0,Q.jsx)(s().A,{id:"form_editor_results",collectionContextStore:n,reducer:{type:"results",filter:{operator:"and",filters:[]},limit:1},resultStore:C}),(0,Q.jsx)(d().A,{animate:{width:_?`calc(100% - ${a().vE}px)`:"100%"},children:(0,Q.jsx)(V,{collectionContextStore:n,collectionViewStore:f,layoutStore:v,headingWidth:l,isCollectionEmpty:w})})]}):null}}}]);