"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98906],{492720:(e,s,t)=>{t.d(s,{p:()=>r});var o=()=>t(762433),n=()=>t(57605);function r(e,s){if(!s)return;const t=n().A.getData(e,{spaceId:s});if(!t)return;const r=(0,o().AI)(t),a=(0,o().q8)(t);if(r&&a&&"year"!==a)switch(r){case"plus":return"team_three_months";case"business":return"business_three_months";case"enterprise":return"enterprise_three_months";default:return}}},876963:(e,s,t)=>{t.r(s),t.d(s,{DeletePaidWorkspaceModal:()=>b});var o=t(296540),n=()=>t(484714),r=()=>t(56366),a=()=>t(206267),u=()=>t(762433),i=()=>t(786508),c=()=>t(166386),l=()=>t(959013),d=()=>t(496603),p=()=>t(252105),h=()=>t(436572),f=()=>t(351360),v=()=>t(749356),g=()=>t(807778),y=()=>t(492720),m=()=>t(231127),S=()=>t(129476),w=()=>t(30265),_=t(474848);function b(e){let{isOpen:s,onClose:t,onConfirmDelete:d,billingData:m,spaceStore:b}=e;const O=(0,n().v3)(),T=(0,u().AI)(m),x="free",[C,I]=o.useState("survey"),[D,V]=o.useState({reasons:[],reasonOther:void 0,reasonOtherTools:void 0}),[A]=o.useState(a().JW()),[B,j]=o.useState(void 0),P=(0,r().K8)((()=>Boolean(null==b?void 0:b.canAdmin())),[b]);(0,o.useEffect)((()=>p().u4(O,{name:"churn_survey",args:{churnType:T,reasons:D.reasons,reasonOther:D.reasonOther,reasonOtherTools:D.reasonOtherTools,stage:C,churnSurveyId:A}})),[O,C,D,A,T]);const R=o.useCallback((()=>{p().u4(O,{name:"churn_survey_close",args:{churnSurveyId:A}}),t()}),[A,O,t]),W=o.useCallback((()=>{R(),d()}),[R,d]);return(0,_.jsx)(w().W,{step:C,isOpen:s,onClose:R,children:(()=>{switch(C){case"survey":return(0,_.jsx)(S().lU,{options:k(),description:(0,_.jsx)(l().sA,{id:"deletePaidWorkspaceFlow.surveyStep.description",defaultMessage:"Let us know why youâ€™re deleting your workspace"}),onSubmit:async e=>{var s,t;p().u4(O,{name:"churn_survey_submitted",args:{newProduct:x,churnType:T,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0,stage:C,churnSurveyId:A}}),V((s=>({...s,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0})));const o=await v().z6(O,{spaceId:null===(s=f().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),offerCampaign:(0,y().p)(O,null===(t=f().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId())}),n=(0,i().RS)(o);if(n&&(0,c().OJ)(n))return j(n),void I("offer");W()}});case"offer":return B?(0,_.jsx)(S().hL,{currentProduct:T,coupon:B,newProduct:x,secondaryButtonMessage:(0,_.jsx)(l().sA,{id:"churnSurvey.offer.continueDeletingWorkspace.title",defaultMessage:"Continue deleting workspace"}),onSubmit:async e=>{if(e){var s;p().u4(O,{name:"offer_accepted",args:{coupon:B}});const e=null===(s=f().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),t=(0,u().Rz)(m),o=(0,y().p)(O,e);t&&e&&(0,u().qd)({billingData:m,canUpdateBilling:P})&&(0,c().OJ)(B)&&((0,g().S7)()&&o?await v().VY({environment:O,spaceId:e,offerCampaign:o,entrypoint:"deleted_space"}):await v().Qm(O,{customerId:t,newPlan:T,coupon:B,offerType:"downgrade_flow"}),h().D6({label:(0,_.jsx)(l().sA,{id:"applyCoupon.success",defaultMessage:"Coupon successfully applied"})})),R()}else W()}}):void W()}})()})}function k(){return[...(0,d().k4)([m().V.consolidatingWorkspaces,m().V.missingFeatures,m().V.notUsingEnough,m().V.switching,m().V.tooExpensive,m().V.tooDifficult]),m().V.other]}}}]);