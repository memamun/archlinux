"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[87982],{601203:(e,t,n)=>{n.d(t,{Kz:()=>S,Qe:()=>g,dn:()=>y,gM:()=>T,jO:()=>h,qu:()=>b});n(898992),n(354520),n(581454);var a=()=>n(251111),r=()=>n(762433),i=()=>n(643819),o=()=>n(622963),s=()=>n(496603),d=()=>n(534177),c=()=>n(449506),u=()=>n(780054),l=()=>n(351360),m=()=>n(506090),p=()=>n(134217),f=()=>n(830140),v=()=>n(430395),x=()=>n(981046),A=()=>n(749240);async function g(e){var t;let{environment:n,billingData:i,billingInterval:s,vatId:u,addOn:f,onlyShowAddOn:v}=e;const g=m().A.state,y=A().subscriptionDataStoreInstance.state;if(!g.open||!y)return;const h=(null==i?void 0:i.address)??g.temporaryAddress;if(!(0,a().Z)(h))return;m().A.update((e=>({...e,calculatingTax:!0})));const b=s??g.temporaryBillingInterval??"year",S=f??g.addOnFeature,T=v??g.onlyShowAddOn,j=null===(t=l().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!j)return;const C=await(0,p().$)(n,j,y),{planAmount:M,promoInfo:w,accountBalance:O}=(0,p().TQ)({memberCount:C,promo:g.appliedPromo,currencyCode:x().A.selectedCurrencyCode,data:y,addOnFeature:S,onlyShowAddOn:T,subscriptionTier:g.subscriptionTier,taxAmount:g.taxAmount,calculatingTax:g.calculatingTax,billingInterval:b,coupon:g.coupon}),D=Math.max(0,M-w.amount+O),N=[g.subscriptionTier,g.addOnFeature].map((e=>{switch(e){case void 0:return;case"ai":case"sites_custom_hostnames":return e;default:return(0,o()._y)(e)}})).map((e=>{const t=x().A.getPrice(n,(t=>t.product===e&&t.billingInterval===s));return null==t?void 0:t.result})).map(I).filter(d().O9),U=await c().callApi({eventName:"calculateTax",environment:n,data:{address:h,lineItems:N,price:D,vatId:u??g.vatApplicable?g.temporaryVatCode:void 0,customerId:(0,r().Rz)(i)}});if("failed"===U.type)m().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=U.data;e.valid?m().A.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):m().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function y(e,t){var n;const o=v().A.state,s=A().subscriptionDataStoreInstance.state;if(!o.open||!s)return;const d=o.temporaryAddress;if(!(0,a().Z)(d))return;v().A.update((e=>({...e,calculatingTax:!0})));const u=(null===(n=o.totalUpgradeCost)||void 0===n?void 0:n.amount)||0,l=await c().callApi({eventName:"calculateTax",environment:e,data:{address:d,price:u,vatId:o.vatApplicable?o.temporaryVatCode:void 0,customerId:(0,r().Rz)(t)}});if("failed"===l.type)v().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=l.data;e.valid?v().A.update((t=>({...t,taxAmount:i().W.fromValue({amount:e.taxAmount,currencyCode:x().A.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):v().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e){const{environment:t,priceForTaxCalculation:n,address:a,customerId:r,vatId:i}=e,o=f().A.state,s=await c().callApi({eventName:"calculateTax",environment:t,data:{address:a,customerId:r,vatId:i,price:n}});if("failed"===s.type);else{const e=s.data;e.valid&&o.open&&f().A.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function b(e){const{environment:t,billingData:n,stripeData:i,taxableAmount:o,lineItems:s}=e,{address:d}=null!=n&&n.address?{address:null==n?void 0:n.address}:e,u=(null==i?void 0:i.vatId)??(n?(0,r().t_)(n,"vat"):void 0);if(!d||!(0,a().Z)(d))return;const l=(0,r().Rz)(n),m=await c().callApi({eventName:"calculateTax",environment:t,data:{address:d,price:o.amount,vatId:u,customerId:l,lineItems:s}});if("failed"===m.type)return;const p=m.data;return p.valid?p.taxAmount:void 0}function I(e){if(!e)return;if(void 0===e.unitAmount)return;const t=u().A.pricing[e.product];return"productId"in t?{amount:e.unitAmount.amount,productId:t.productId}:void 0}function S(e){const t=u().A.pricing[e.price.product];if("productId"in t)return{amount:e.price.unitAmount.amount*e.quantity,productId:t.productId}}function T(e){let{line:t,defaultProductId:n=u().A.pricing.plus.productId}=e;const a=(0,s().xu)(t.discount_amounts??[],"amount"),r=t.price?"string"==typeof(i=t.price.product)?i:i.id:n;var i;return{amount:t.amount-a,productId:r}}},730764:(e,t,n)=>{n.d(t,{w:()=>T});n(898992),n(737550);var a=n(296540),r=()=>n(484714),i=()=>n(56366),o=()=>n(401497),s=()=>n(441738),d=()=>n(166386),c=()=>n(959013),u=()=>n(449506),l=()=>n(554509),m=()=>n(719147),p=()=>n(836251),f=()=>n(351360),v=()=>n(506090),x=()=>n(807778),A=()=>n(906195),g=()=>n(477401),y=()=>n(981046),h=()=>n(749240),b=()=>n(284371),I=n(474848);const S=function(){const e=(0,o().IS)((e=>({discountDescription:{alignItems:"center",color:e.mediumTextColor,fontSize:12,lineHeight:b().K_.UISmall.desktop}})),[]);return(0,I.jsx)("div",{style:e.discountDescription,children:(0,I.jsx)(c().sA,{id:"spaceSubscriptionSettings.orderOptions.estimatedPriceWarning",defaultMessage:"The final amount due may be impacted by prorations and member changes since your last invoice."})})};function T(e){const{products:t,showTrialEndDisclaimer:n}=e,a=(0,o().IS)((()=>({termsOfService:{display:"flex",flexDirection:"column",gap:12}})),[]),r=(0,i().K8)((()=>y().A.state.selectedCurrencyCode),[]),s=t.includes("ai"),c=t.some((e=>"ai"!==e)),u=void 0!==r&&"USD"!==r,m=(0,i().K8)((()=>{var e;return v().A.state.open?null===(e=v().A.state)||void 0===e?void 0:e.coupon:void 0}),[]),p=(0,A().D)()&&t.includes("plus")&&(0,d().u6)(m);return(0,I.jsx)(l().D,{styleName:"Body-12px/Regular",colorName:"secondary",children:(0,I.jsxs)("div",{style:a.termsOfService,children:[n?(0,I.jsx)(j,{}):null,s&&!c?(0,I.jsx)(C,{}):null,s&&c?(0,I.jsx)(M,{}):null,!s&&c?(0,I.jsx)(w,{}):null,c&&p&&(0,I.jsx)(O,{}),u?(0,I.jsx)(D,{currencyCode:r}):null]})})}function j(){return(0,I.jsx)("div",{children:(0,I.jsx)(c().sA,{id:"spaceSubscriptionUpgradeModal.trialWillEndToday.message",defaultMessage:"Upgrading will end your trial and your workspace will be billed immediately."})})}function C(){const e=(0,r().v3)(),t=function(){const e=(0,r().v3)(),t=(0,i().K8)((()=>{var e;return null===(e=f().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[n,o]=(0,a.useState)();return(0,a.useEffect)((()=>{async function n(){var n;if(!t)return!1;const a=await u().callApi({eventName:"getSpaceMembershipUpdates",environment:e,data:{spaceId:t}});if("failed"===a.type)return!1;const r=!1===(null===(n=a.data[0])||void 0===n?void 0:n.isProcessed);o(!!r)}n()}),[e,t]),n}(),n=(0,g().U)(),o=(0,i().K8)((()=>{var t;return(0,x().Ft)(e)&&!(0,s().GI)(null===(t=h().subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)&&n}),[n,e]);return(0,I.jsxs)("div",{children:[o?(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.aiWithDiscount",defaultMessage:"By continuing, you agree to the <aiTerms>Notion AI Product Specific Terms</aiTerms> and agree to receive <bold>50% off Notion AI</bold> for the next 3 months with a paid plan. <terms>See details.</terms>",values:{br:(0,I.jsx)("br",{}),aiTerms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("ai.terms"),external:!0,children:e}),bold:e=>(0,I.jsx)("b",{children:e}),terms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("terms.discounts.ai.summer.2023"),external:!0,children:e})}}):(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.aiOnly",defaultMessage:"By continuing, you agree to the <aiTerms>Notion AI Product Specific Terms</aiTerms>.",values:{br:(0,I.jsx)("br",{}),aiTerms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("ai.terms"),external:!0,children:e})}}),t?(0,I.jsx)(S,{}):null]})}function M(){return(0,I.jsx)("div",{children:(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.planWithAi",defaultMessage:"By continuing, you agree to the <terms>Notion Terms and Conditions</terms> and <aiTerms>Notion AI Product Specific Terms</aiTerms>.",values:{br:(0,I.jsx)("br",{}),terms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("terms"),external:!0,children:e}),aiTerms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("ai.terms"),external:!0,children:e})}})})}function w(){return(0,I.jsx)("div",{children:(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.planOnly",defaultMessage:"By continuing, you agree to the <terms>Notion Terms and Conditions</terms>.",values:{terms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("terms"),external:!0,children:e})}})})}function O(){return(0,I.jsx)("div",{children:(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.planOnlyResurrection",defaultMessage:"Enjoy 50% off your first 3 months of billing, then standard rates apply. <learnMore>Learn more</learnMore>",values:{learnMore:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("resurrectionLearnMore"),external:!0,children:e})}})})}function D(e){return(0,I.jsx)("div",{children:(0,I.jsx)(c().sA,{id:"subscriptionUpgradeModal.confirmation.currency",defaultMessage:"<terms>Learn about FX rates</terms>. Rates will refresh throughout the billing period.",values:{terms:e=>(0,I.jsx)(m().A,{href:(0,p().xS)("terms.currency.fxRates"),external:!0,children:e})}})})}},906195:(e,t,n)=>{n.d(t,{D:()=>x});var a=n(296540),r=()=>n(484714),i=()=>n(56366),o=()=>n(786508),s=()=>n(166386),d=()=>n(449506),c=()=>n(437622),u=()=>n(58293),l=()=>n(351360),m=()=>n(749356),p=()=>n(714300),f=()=>n(762433),v=()=>n(807778);function x(){const e=(0,r().v3)(),t=(0,u().r)(),n=null==t?void 0:t.id,x=(0,p().l)({spaceId:n}),[A,g]=(0,a.useState)(!1),{currentSpaceStore:y}=(0,i().K8)((()=>{const{currentSpaceStore:e}=l().default.state;return{currentSpaceStore:e}}),[]),h=(0,i().K8)((()=>y?(0,c().GK)(e,y):void 0),[y,e]),b=function(e){return(0,i().K8)((()=>(0,v().vv)()&&Boolean("free"===(0,f().AI)(e))),[e])}(x),I=(0,i().K8)((()=>null==t?void 0:t.canAdmin()),[t]);return(0,a.useEffect)((()=>{!async function(){if(b&&n&&I)try{const t=await d().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:n,offerCampaign:"resurrection_offer"}});if("failed"===t.type)return;if("offer"in t.data){const n=(0,o().RS)(t.data.offer);(0,s().u6)(n)&&(g(!0),h&&(0,m().Zc)({environment:e,spaceName:h,offerCampaign:"resurrection_offer"}))}}catch(t){return}}()}),[e,n,b,h,I]),A}}}]);