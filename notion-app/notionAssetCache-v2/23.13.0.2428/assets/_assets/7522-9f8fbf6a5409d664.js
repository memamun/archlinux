"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7522],{49650:(e,t,n)=>{n.d(t,{A:()=>i});n(898992),n(672577);class o extends(()=>n(959180))().A{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const i=new o},274652:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(296540),i=n(474848);const r=o.forwardRef((function(e,t){const o=(0,n(401497).IS)((t=>({base:{color:e.isBlue?n(100622).Ay.blue:t.mediumTextColor},disabled:{cursor:"not-allowed"},buttonMenuItem:{...e.style,...e.disabled?{cursor:"not-allowed"}:{}}})),[e.disabled,e.isBlue,e.style]),{color:r}=o.base;return(0,i.jsx)(n(760217).A,{ref:t,...e,title:(0,i.jsx)("div",{style:{color:r,fill:r},children:e.title}),icon:(0,i.jsx)(n(8980).I,{icon:n(617668).plusIcon,style:{fill:r}}),style:o.buttonMenuItem})}))},286611:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=n(474848);const l=(0,n(340498).wt)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,s.jsxs)("svg",{children:[(0,s.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var c=()=>n(959013),d=()=>n(284371),u=()=>n(755199),m=()=>n(351360);function p(){const[e,t]=(0,o.useState)(!1),a=(0,i().v3)(),s=(0,r().K8)((()=>m().default.state.currentUserSettingsStore),[]);return[(0,r().K8)((()=>{const t=n(508496).default.checkGate({gateName:"dictation_new_page_nux"}),o=null==s?void 0:s.getSettings(),i=Boolean(null==o?void 0:o.dismissed_dictation_new_page_nux);return t&&!i&&!e}),[s,e]),(0,o.useCallback)((()=>{s&&(t(!0),u().wG({environment:a,userSettingsStore:s,dismissed:!0}))}),[a,s,t])]}(0,n(604341).exposeDebugValue)("resetDictationTooltip",(e=>{const t=m().default.state.currentUserSettingsStore;t&&u().wG({environment:e,userSettingsStore:t,dismissed:!1})}));var f=()=>n(962730),g=()=>n(301948),y=()=>n(760217),v=()=>n(364280);const h=(0,o.forwardRef)((function(e,t){const{format:n,className:o,icon:i,title:r,isDefault:a,recurrence:l,recurrenceDisabled:c,right:d,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,locked:y,type:v}=e;return"collection-overlay"===n?(0,s.jsx)(C,{ref:t,className:o,icon:i,format:n,title:r,isDefault:a,recurrence:l,recurrenceDisabled:c,right:d,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,locked:y,type:v}):"phone-modal"===n?(0,s.jsx)(k,{ref:t,icon:i,format:n,title:r,isDefault:a,recurrence:l,focused:u,onClick:m}):"horizontal-new-page"===n?"dictation"===v?(0,s.jsx)(S,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r,type:v}):(0,s.jsx)(_,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r,type:v}):"horizontal-new-page-submenu"===n?(0,s.jsx)(w,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r}):(0,s.jsx)(x,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,format:n,title:r,isDefault:a,recurrence:l,recurrenceDisabled:c,right:d})}));function M(e){let{format:t,title:o,isDefault:i,recurrenceDisabled:r}=e;const u=(0,a().DP)();return"collection-overlay"!==t?(0,s.jsx)(s.Fragment,{children:o}):(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o,(0,s.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i&&(0,s.jsx)("span",{style:{fontSize:12,fontWeight:d().Wy.medium,color:u.mediumTextColor},children:(0,s.jsx)(c().sA,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),r&&l({width:14,height:12.25,color:n(100622).Ay.lightIconColor,marginLeft:8})]})]})}const C=(0,o.forwardRef)((function(e,t){let{className:n,icon:o,format:r,title:a,isDefault:l,recurrence:c,recurrenceDisabled:d,right:u,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:v,locked:h,type:C}=e;const k=(0,i().v3)(),{device:A}=k;return(0,s.jsx)(y().A,{ref:t,className:n,icon:o,title:(0,s.jsx)(M,{format:r,title:a,isDefault:l,recurrence:c,recurrenceDisabled:d}),right:u,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:v,showDragHandle:!A.isMobile&&!h,dragHandleDisabled:"empty_page"===C})})),k=(0,o.forwardRef)((function(e,t){let{icon:n,format:o,title:i,isDefault:r,recurrence:a,focused:l,onClick:c}=e;return(0,s.jsx)(y().A,{ref:t,icon:n?(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24},children:n}):null,title:(0,s.jsx)(M,{format:o,title:i,isDefault:r,recurrence:a}),focused:l,onClick:c,showDragHandle:!1})}));function A(e,t,o){const{device:i}=e;return{...n(799954).nE,display:"flex",alignItems:"center",flexGrow:1,height:i.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:o?t.mediumTextColor:t.lightTextColor}}const x=(0,o.forwardRef)((function(e,t){let{focused:o,onClick:l,onMouseMove:c,onMouseEnter:d,onMouseLeave:u,icon:m,format:p,title:f,isDefault:g,recurrence:y,recurrenceDisabled:v,right:h}=e;const C=(0,a().DP)(),k=(0,i().v3)(),x=(0,n(792485).S)(),b=(0,r().K8)((()=>{const e=null==x?void 0:x.publicEditModeStore.state;return(0,n(68465).ZE)(e)}),[x]);return(0,s.jsxs)(n(704152).A,{style:A(k,C,b),hovered:o,onClick:l,onMouseMove:c,onMouseEnter:d,onMouseLeave:u,hoveredStyle:{background:C.buttonHoveredBackground,color:C.regularTextColor},pressedStyle:{background:C.buttonPressedBackground},children:[(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:m}),(0,s.jsx)(M,{format:p,title:f,isDefault:g,recurrence:y,recurrenceDisabled:v}),h&&(0,s.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:h})]})})),b=(0,c().YK)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),_=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:l,onMouseEnter:c,onMouseLeave:u,icon:m,title:p,type:f,tooltipEvents:g}=e;const y=(0,i().v3)(),h=(0,a().IS)((e=>({item:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",background:e.assistantTintedActionButtonBackground,borderRadius:100,fontSize:13,fontWeight:d().Wy.medium},moreItem:{width:32,height:32,padding:0,justifyContent:"center"},itemFocused:{background:e.tint.regular},itemFilled:{borderColor:e.tint.regular,background:e.assistantTintedActionButtonBackground},itemFilledAndFocused:{background:e.tint.regular}})),[]),M=(0,r().K8)((()=>!y.device.isMobile&&("ai"===f||"dictation"===f)),[y.device.isMobile,f]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:l,onMouseEnter:c,onMouseLeave:u,...g||{},style:{...h.item,..."more"===f?h.moreItem:{},...M?h.itemFilled:{},...n?h.itemFocused:{},...M&&n?h.itemFilledAndFocused:{}},children:(0,s.jsxs)(v().fI,{gap:4,alignItems:"center",children:[m,p]})})})),w=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:i,onMouseEnter:r,onMouseLeave:l,icon:c,title:d}=e;const u=(0,a().IS)((e=>({item:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px"},itemFocused:{background:e.tint.regular,borderRadius:6}})),[]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:i,onMouseEnter:r,onMouseLeave:l,style:{...u.item,...n?u.itemFocused:{}},children:(0,s.jsxs)(v().fI,{gap:8,alignItems:"center",children:[c,d]})})})),S=(0,o.forwardRef)((function(e,t){const i=(0,o.useRef)(null),[r,l]=p(),d=(0,a().IS)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginLeft:"-4px"},badge:{background:e.accentColors.translucentGray[300],color:e.text.contrastSecondary,marginLeft:0,width:"fit-content"}})),[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(594607).B,{shouldShow:r,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,s.jsx)(n(953006).k,{style:{width:200},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"top",alignmentToOrigin:f().C.Center,header:(0,s.jsx)(g().A,{style:d.badge}),content:(0,s.jsx)(c().sA,{...b.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:l})}),(0,s.jsx)(n(859428).A,{disableTooltip:r,renderTooltip:()=>(0,s.jsxs)("div",{style:d.tooltipContainer,children:[(0,s.jsx)(g().A,{style:d.badge}),(0,s.jsx)(c().sA,{...b.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:f().W.Top,render:n=>(0,s.jsx)("div",{ref:i,children:(0,s.jsx)(_,{...e,ref:t,tooltipEvents:n})})})]})}))},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>I,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>x,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>A,MAX_RECURRENCE_INTERVAL:()=>v,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>h,RRULE_WEEKDAYS_MAP:()=>y,adjustedStartDateIfPossible:()=>_,areRecurrenceSchedulesEqual:()=>N,convertFromUnpersistedRecurrenceConfig:()=>L,convertToUnpersistedRecurrenceConfig:()=>j,getFormattedEndCondition:()=>E,getFormattedNextRecurrenceTime:()=>T,getNewEndTimestamp:()=>R,getNextDateUtc:()=>D,getRecurrenceAfter:()=>w,isRunningBetweenMidnightAnd3AM:()=>S,isValidRecurrenceInterval:()=>M,isValidRecurrenceNumberOfRuns:()=>C,rruleFromRecurrence:()=>k,templateAncestorsViolateRecurrenceNesting:()=>b});n(898992),n(354520),n(581454);var o=()=>n(244641);n(944114);function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const r=[];for(const a of e)r.push(...i(n[0],...n.slice(1)).map((e=>[a,...e])));return r}var r=()=>n(496603),a=()=>n(534177),s=()=>n(720665),l=()=>n(597777),c=()=>n(869190),d=()=>n(416504),u=()=>n(402390);class m extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>n(912720);const f=(0,n(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),g={day:m.DAILY,week:m.WEEKLY,month:m.MONTHLY,year:m.YEARLY},y={MO:m.MO,TU:m.TU,WE:m.WE,TH:m.TH,FR:m.FR,SA:m.SA,SU:m.SU},v=99,h=999;function M(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function C(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=h}function k(e){const{start_date:t,frequency:n,interval:o,weekdays:r,timezone:s,hour:c,minute:d}=e,u="week"===n&&r?r.map((e=>y[e])):void 0,p={};return(0,a().O9)(e.end_condition)&&("date"===e.end_condition.type?p.until=(0,l().eU)(e.end_condition.end_at):"number"===e.end_condition.type?p.count=e.end_condition.number_of_occurrences:(0,a().HB)(e.end_condition)),"month"===e.frequency&&(0,a().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?p.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?p.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return y[t].nth(n)})):(0,a().HB)(e.monthly_restriction)),new m({freq:g[n],dtstart:(0,l().eU)(t),interval:o,byweekday:u,tzid:s,byhour:c??0,byminute:d??0,bysecond:0,...p})}const A=1,x=1;function b(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=o>A,a=n.length>=x;return{violatesConstraint:r||a,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:i}}function _(e){var t;const{recurrence:n,afterDate:i}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=i)return n;let r=o().c9.fromMillis(n.start_date,{zone:"utc"});const a=o().c9.fromMillis(i,{zone:"utc"});switch(n.frequency){case"year":{const e=Math.floor(a.diff(r,"years").years/n.interval);r=r.plus({years:e*n.interval});break}case"month":{const e=Math.floor(a.diff(r,"months").months/n.interval);r=r.plus({months:e*n.interval});break}case"week":{const e=Math.floor(a.diff(r,"weeks").weeks/n.interval);r=r.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(a.diff(r,"days").days/n.interval);r=r.plus({days:e*n.interval});break}}return{...n,start_date:(0,l().DH)(r.toMillis())}}function w(e){const{recurrence:t,afterDate:n}=e;if((0,p().wt)(t)){const e=(0,l().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=k(_({recurrence:t,afterDate:n})).after((0,l().eU)(n));if(!e)return;return(0,l().h1)(e)}}function S(e){return 0===e.hour||1===e.hour||2===e.hour}function D(e){return k(e).after((0,l().eU)((0,l().Rz)()))||void 0}function T(e){const{recurrence:t,intl:n}=e,i=D(L(t));if(!i)return;const r=S(t),a=o().c9.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,u().H)(n)).setZone(t.timezone),s=(0,c().Yq)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(r)return n.formatMessage(f.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(o().c9.TIME_SIMPLE);return t.timezone!==(0,d().P)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(f.dateAtTime,{date:s,time:e})}}function E(e,t){return(0,a().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().Yq)({date:o().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,a().HB)(e):t.formatMessage(f.noEndCondition)}const I=100;function j(e){return{...e,start_date:(0,l().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().l1)(e.end_condition.end_at)}:(0,a().HB)(e.end_condition):void 0}}function R(e,t,n){return e.plus(n-t)}function P(e,t){const n=o().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Rz)(n.toJSDate())}}function L(e){return{...e,start_date:(0,l().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?P(e,e.end_condition):(0,a().HB)(e.end_condition):void 0}}function N(e,t){const n=r().fN(e,(e=>void 0!==e)),o=r().fN(t,(e=>void 0!==e));return r().n4(n,o)}},485894:(e,t,n)=>{n.d(t,{k:()=>i,q:()=>r});var o=()=>n(645873);const i=new(o().O2)("recurrence",(async()=>{const[e,t,{TemplateRecurrenceConfigMenu:o}]=await Promise.all([Promise.all([n.e(23806),n.e(38664),n.e(24587),n.e(4422),n.e(21627),n.e(29021)]).then(n.bind(n,839916)),Promise.all([n.e(23806),n.e(38664),n.e(24587),n.e(4422),n.e(21627),n.e(29021)]).then(n.bind(n,390527)),Promise.all([n.e(23806),n.e(38664),n.e(24587),n.e(4422),n.e(21627),n.e(29021)]).then(n.bind(n,528411))]);return{recurrenceActions:e,recurrenceHelpers:t,TemplateRecurrenceConfigMenu:o}})),r=(0,o().jQ)(i,(e=>e.TemplateRecurrenceConfigMenu))},763996:(e,t,n)=>{n.d(t,{A:()=>J});var o=n.n(n(32485)),i=n(296540),r=()=>n(484714),a=()=>n(56366),s=()=>n(401497),l=()=>n(584262),c=()=>n(859384),d=()=>n(764781),u=()=>n(89849),m=()=>n(748054),p=()=>n(236262),f=()=>n(959013),g=()=>n(100622),y=()=>n(496603),v=()=>n(284371),h=()=>n(160568),M=()=>n(557281),C=()=>n(901389),k=()=>n(896628),A=()=>n(435009),x=()=>n(317909),b=()=>n(813297),_=()=>n(104636),w=()=>n(31902),S=()=>n(175116),D=()=>n(484792),T=()=>n(485894),E=()=>n(878377),I=()=>n(989423),j=()=>n(38337),R=()=>n(492414),P=()=>n(972435),L=()=>n(722872),N=()=>n(377586),O=()=>n(351360),U=()=>n(463830),F=()=>n(575143),B=()=>n(406699),H=()=>n(802790),V=()=>n(928600),K=()=>n(678553),z=()=>n(939740),q=()=>n(16006),W=()=>n(89924),Y=()=>n(719147),Z=n(474848);const G=(0,f().YK)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}}),J=i.memo(i.forwardRef((function(e,t){const{templateStore:o,isMobile:l,isOverlay:c,isDefault:d,locked:u,canConfigureCollection:m,draggable:p,recurrence:f,recurrenceDisabled:g,recurrenceButtonDisabled:v,collectionStore:h,focused:M}=e,C=(0,r().Y0)(),k=(0,r().v3)(),[A,x]=(0,i.useState)(!1),b=(0,a().uB)(void 0,U().A),_=!o&&!c;(0,a().K8)((()=>{if(!o)return!1;const e=o.getAutomationPointer();return!!e&&(0,n(322931).z)(o,e)}),[o]);const w=(0,a().K8)((()=>{var e;return Boolean(null===(e=h.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())}),[h]),S=(0,a().K8)((()=>(!u||u&&!p)&&(m||w)&&(A||b.state.open||l||c)&&!_),[u,p,m,w,A,b,l,c,_]),D=(0,a().K8)((()=>!o||o.isEmptyPage()),[o]),E=(0,a().K8)((()=>{var e;return null==o||null===(e=o.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:h.getRecordModel})}),[o,h]),I=(0,i.useRef)(null);(0,n(790748).b)(n(49650).A,(()=>({templateStore:o,getNode:()=>I.current})),[o]);const R=(0,s().IS)((e=>({recordIcon:{...!c&&{pointerEvents:"none",marginRight:10}},pageIcon:{...!c&&{fill:e.lightIconColor}}})),[c]),L=(0,i.useCallback)((()=>{x(!0)}),[]),N=(0,i.useCallback)((()=>{x(!1)}),[]),O=o?(0,Z.jsx)(q().A,{enableHover:!0,showTooltipWhenTruncated:!0,store:o}):P().A.formatMessage(G.emptyPageTitle),F=(0,a().uB)(void 0,U().A),B=(0,a().K8)((()=>F.state.open),[F]),H=(f||B)&&o;return(0,Z.jsx)("div",{ref:I,style:{display:"contents"},children:(0,Z.jsx)(n(286611).A,{ref:t,className:j().SDd,type:o?"custom_template":"empty_page",format:c?"collection-overlay":"page-menu-item",locked:u||!m||!p,icon:(0,Z.jsx)(n(614505).A,{disabled:!0,icon:E,isEmptyPage:D,size:C.isMobile&&c?24:20,isLarge:!c,style:R.recordIcon,pageIconStyle:R.pageIcon}),title:O,onClick:e.onClick,onMouseEnter:e.onMouseEnter,right:S&&(0,Z.jsxs)(n(364280).fI,{alignItems:"center",gap:2,children:[H&&(0,Z.jsx)(T().q,{...y().cJ(e,["onClick"]),focused:M,disabled:v,recurrence:f,showTooltip:!0,variant:"icon",buttonPopupStore:F,onChange:async e=>{const{recurrenceActions:t}=await T().k.load();e?t.addRecurrence({environment:k,blockStore:o,recurrence:e}):t.deleteRecurrence({environment:k,blockStore:o})}}),(0,Z.jsx)(Q,{templateStore:o,buttonPopupStore:b,isOverlay:c,canEditContentOnly:w,onCancelClick:e.onCancelClick})]}),onMouseMove:L,onMouseLeave:N,focused:M,isDefault:d,recurrence:f,recurrenceDisabled:g})})})));function Q(e){const{templateStore:t,buttonPopupStore:i,isOverlay:s,canEditContentOnly:l,onCancelClick:c}=e,d=(0,r().v3)(),{isMobile:u}=(0,r().Y0)(),m=(0,a().K8)((()=>!!t&&(0,E().p2L)({environment:d,blocks:[t],publicEditMode:void 0})),[t,d]);return(0,Z.jsx)(n(859428).A,{renderTooltip:()=>m?(0,Z.jsx)(f().sA,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,Z.jsx)(f().sA,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:e=>(0,Z.jsx)(B().Ay,{popupType:u?N().n.SlideUp:N().n.Popup,placementToOrigin:B().sx.Right,originGap:12,buttonPopupStore:i,renderOrigin:t=>(0,Z.jsx)(n(911706).A,{className:o()(j().dn9,{[j().qGl]:u||s}),isMobile:u&&s,style:{...!s&&{marginRight:0}},...(0,n(553965).A)(e,t)}),render:e=>(0,Z.jsx)(X,{templateStore:t,buttonPopupStore:i,canEditContentOnly:l,isOverlay:s,parent:e,onCancelClick:c}),onClick:()=>{h()._o(d,{template_action:"open_menu"})}})})}function X(e){const{templateStore:t,buttonPopupStore:n,canEditContentOnly:o,isOverlay:l,parent:A,onCancelClick:j}=e,R=(0,r().v3)(),N=(0,r().Y0)(),O=(0,S().ET)(),U=(0,i.useContext)(D().n),{collectionStore:B,collectionViewStore:J}=(0,a().K8)((()=>({collectionStore:null==O?void 0:O.collectionStore(),collectionViewStore:null==O?void 0:O.collectionViewStore()})),[O]),Q=(0,a().K8)((()=>!!t&&(0,E().p2L)({environment:R,blocks:[t],publicEditMode:void 0})),[t,R]),X=(0,a().K8)((()=>null==t?void 0:t.getAutomationStore()),[t]),te=(0,a().K8)((()=>null!=X&&X.isActive()?null==X?void 0:X.getRecurrence():void 0),[X]),ne=(0,a().K8)((()=>{if(!t)return!1;const e=(0,_().Is)(t);return!e.automationStoresReady||e.violatesConstraint}),[t]),oe=(0,a().K8)((()=>{if(t){const e=(0,_().Is)(t);if(e.automationStoresReady)return e}}),[t]),ie=(0,a().K8)((()=>Boolean(null==oe?void 0:oe.templateNestingExceedsMaxDepth)),[oe]),re=(0,a().K8)((()=>null==oe?void 0:oe.immediateAncestorRecurrenceType),[oe]),ae=(0,a().K8)((()=>Boolean(null==oe?void 0:oe.ancestorHasDailyTemplate)),[oe]),se=(le={templateNestingExceedsMaxDepth:ie,immediateAncestorRecurrenceType:re,ancestorHasDailyTemplate:ae,automationStore:X,environment:R},(0,a().K8)((()=>function(e){const{templateNestingExceedsMaxDepth:t,immediateAncestorRecurrenceType:n,ancestorHasDailyTemplate:o,automationStore:i,environment:r}=e,a="disabled_duplication"===(null==i?void 0:i.getStatus())||"disabled_inactive_space"===(null==i?void 0:i.getStatus());return a&&null!=i&&i.getAlive()?(0,Z.jsx)(f().sA,{defaultMessage:"This repeating template was turned off. <inlinelink>Turn on</inlinelink> with the same settings.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionDisabledDuringDuplication",values:{inlinelink:e=>(0,Z.jsx)(Y().A,{external:!1,color:"notion-link-blue",hoverColor:"blue",onClick:()=>{!async function(e,t){if(!t)return;const{automationActions:n}=await b().QV.automations.load();x().createAndCommit({userAction:"CollectionTemplatePickerItem.setAutomationStatusToActive",environment:e,canUndo:!0,perform:o=>n.enableAutomation({automationStore:t,environment:e,transaction:o})})}(r,i)},children:e})}}):o?(0,Z.jsx)(f().sA,{defaultMessage:"It already gets created daily from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInDaily"}):t?(0,Z.jsx)(f().sA,{defaultMessage:"It already gets created automatically from other repeating templates.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionTooDeeplyNested"}):n?(0,Z.jsx)(f().sA,{defaultMessage:"This template is within another template that repeats every {immediateAncestorRecurrenceType}.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInTemplate",values:{immediateAncestorRecurrenceType:n}}):void 0}(le)),[le]));var le;const ce=(0,a().K8)((()=>null==X?void 0:X.isReady()),[X]),de=(0,s().IS)((()=>({nestingExplanationMenuItemTitle:{whiteSpace:"normal",fontWeight:v().Wy.medium,fontSize:v().J.UISmall.desktop},nestingExplanationMenuItemCaption:{whiteSpace:"normal",color:g().Ay.lightTextColor,fontWeight:v().Wy.regular,fontSize:v().J.UISmall.desktop}})),[]),ue=(0,i.useCallback)((e=>{if(!B||null==J||!J.isDefined())return;const n=null!=t&&t.id?{template_page_id:null==t?void 0:t.id}:"empty";C().ui({showCancel:!0,keepFocus:!1,message:(0,Z.jsx)(f().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,Z.jsx)("span",{children:e}),pageName:t?(0,Z.jsx)(q().A,{store:t,style:{display:"inline"}}):P().A.formatMessage(G.emptyPageTitle)}}),items:[{label:(0,Z.jsx)(f().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,Z.jsx)(q().A,{store:B,style:{display:"inline"}})}}),onAccept:()=>{e.close(),x().createAndCommit({environment:R,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",canUndo:!0,perform:e=>{k().zA({stores:[B],update:{collection_default_template:n},transaction:e}),k().zA({stores:[J],update:{collection_view_default_template:n},transaction:e})}})}},{label:(0,Z.jsx)(f().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,Z.jsx)(w().A,{collectionViewName:J.getName(),collectionViewType:J.getType()})}}),onAccept:()=>{e.close(),x().createAndCommit({environment:R,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",canUndo:!0,perform:e=>{k().zA({stores:[J],update:{collection_view_default_template:n},transaction:e})}})}}]})}),[R,B,J,t]);if(!B)return null;const me={key:"section",render:e=>(0,Z.jsx)(W().A,{...e}),items:y().oE([t&&!o&&Q&&(!X||ce)&&!ne&&{key:"repeatControl",render:e=>t&&(0,Z.jsx)(T().q,{...e,recurrence:te,onChange:async e=>{const{recurrenceActions:n}=await T().k.load();e?n.addRecurrence({environment:R,blockStore:t,recurrence:e}):n.deleteRecurrence({environment:R,blockStore:t})}}),action:()=>function(e,t){I().vd(e,"recurrence_menu_open",{isConfigured:void 0!==t})}(R,te)},l&&!o&&{key:"Set default",render:e=>(0,Z.jsx)(F().A,{...e,title:(0,Z.jsx)(f().sA,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:m().M}),action:()=>ue(A)},t&&{key:"Edit",render:e=>(0,Z.jsx)(F().A,{...e,title:Q?(0,Z.jsx)(f().sA,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,Z.jsx)(f().sA,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:Q?c().M:u().h}),action:()=>function(e,t,n,o,i){if(!n)return;null==o||o(),ee(n,e,i),t.reset(),h()._o(e,{template_action:"edit"})}(R,n,t,j,U)},t&&!o&&Q&&{key:"Duplicate",render:e=>(0,Z.jsx)(F().A,{...e,title:(0,Z.jsx)(f().sA,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:d().V}),action:e=>async function(e,t,n,o,i,r,a){if(!i)return;null==r||r();const{recurrenceActions:s}=await T().k.load(),{performResult:l}=x().createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:t,canUndo:!0,perform:o=>{const r=M().oZ({environment:t,event:e.event,collectionStore:n,templateStore:i,transaction:o});if(i.getAutomationId()){const e=i.getAutomationStore(),n=null==e?void 0:e.getRecurrence();e&&null!=e&&e.isActive()&&n&&s.createRecurrenceInner(o,t,r,n)}return r}});l&&ee(l,t,a);o.reset(),h()._o(t,{template_action:"duplicate"})}(e,R,B,n,t,j,U)},t&&!o&&Q&&{key:"Delete",render:e=>(0,Z.jsx)(F().A,{...e,title:(0,Z.jsx)(f().sA,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:p().I}),action:Q?()=>async function(e,t,n){if(!n)return;if(!(await C().Gh({message:(0,Z.jsx)(f().sA,{defaultMessage:"Delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,Z.jsx)(f().sA,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})})))return;x().createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:e,canUndo:!0,perform:e=>M().m0({collectionStore:t,templateStore:n,transaction:e})}),h()._o(e,{template_action:"delete"})}(R,B,t):()=>{}},(ne||se)&&{key:"nestedTemplateExplanation",render:e=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H().A,{size:12}),(0,Z.jsx)(K().A,{...e,style:{padding:2},titleStyle:de.nestingExplanationMenuItemTitle,title:$({cannotAddRecurrenceToTemplate:ne}),captionStyle:de.nestingExplanationMenuItemCaption,caption:se})]}),action:()=>{}}])};let pe;return pe=N.isMobile?{menuType:L().gu.ActionSheet}:{menuType:L().gu.Popup,width:230},(0,Z.jsx)(V().A,{...pe,children:(0,Z.jsx)(z().Ay,{type:z().Oh.Vertical,initialFocus:void 0,sections:[me]})})}function $(e){const{cannotAddRecurrenceToTemplate:t}=e;return t&&(0,Z.jsx)(f().sA,{defaultMessage:"This template can't be repeated.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationTitle"})}function ee(e,t,n){const{mainEditorCurrentBlockStore:o}=O().default.state;!function(e,t,n){n?n(e):A().oo({environment:t,url:e})}(o?(0,R().Ay)({store:o,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:l().y8.PeekOpen}):(0,R().Ay)({store:e,fullyQualified:!1,pageVisitSource:l().y8.LinkInPage}),t,n)}},864779:(e,t,n)=>{n.d(t,{Me:()=>s,Vv:()=>i,Z3:()=>r,wI:()=>a});var o=()=>n(244641);function i(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function r(e){const{currentSprintEndDate:t,sprintSchedule:n}=e;return l({startDate:d({dateToAdjust:o().c9.fromISO(t),weekday:n.weekday,wrapForEqualDays:!0}),duration:n.duration})}function a(e){const{userTimeZone:t,sprintSchedule:n}=e;return l({startDate:o().c9.local({zone:t}),duration:n.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:n}=e,i=d({dateToAdjust:o().c9.fromISO(t),weekday:n.weekday,wrapForEqualDays:!1}),{end_date:r}=l({startDate:i,duration:n.duration});let a=o().c9.fromISO(r);const s=o().c9.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:n.duration}).toISODate(),end_date:a.toISODate()}}function l(e){const{startDate:t,duration:n}=e,o=t.plus({weeks:n}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:o.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:n,wrapForEqualDays:o}=e,i=u({currentWeekday:t.weekday%7,nextWeekday:c[n],wrapForEqualDays:o});return t.plus({days:i})}function u(e){const{currentWeekday:t,nextWeekday:n,wrapForEqualDays:o}=e,i="number"==typeof t?t:c[t],r="number"==typeof n?n:c[n];if(i===r)return o?7:0;let a=i,s=0;for(;a!==r;)a===c.SA?a=0:a+=1,s+=1;return s}},911706:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(401497),i=()=>n(30626),r=()=>n(704152),a=n(474848);function s(e){let{onClick:t,className:n,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:m,onMouseLeave:p}=e;const{buttonStyle:f,iconStyle:g}=(0,o().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:6,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(r().A,{onClick:t,style:f,className:n,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:m,onMouseLeave:p,children:(0,i()._)(g)})}},950914:(e,t,n)=>{n.d(t,{AL:()=>r,Q6:()=>s,vt:()=>a});n(898992),n(672577);var o=()=>n(66689),i=()=>n(254947);const r={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function a(e){const{eventTracker:t,properties:n}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:n})}function s(e,t){var n;return null===(n=t.groups)||void 0===n||null===(n=n.find((t=>t.id===o().nl||(null==t?void 0:t.name)===i().P0||(null==t?void 0:t.name)===e.formatMessage(i().oz.statusGroupNameComplete))))||void 0===n?void 0:n.name}}}]);