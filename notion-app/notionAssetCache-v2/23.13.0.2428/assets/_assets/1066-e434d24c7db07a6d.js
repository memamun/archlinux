"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[1066],{430395:(e,t,n)=>{n.d(t,{A:()=>i});class a extends(()=>n(757695))().default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:n(206267).JW(),type:n(506090).p.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const i=new a},585312:(e,t,n)=>{n.d(t,{q:()=>b});var a=()=>n(624119),i=(a(),n(296540),()=>n(484714)),o=()=>n(852507),r=()=>n(56366),s=()=>n(959013),d=()=>n(252105),l=()=>n(84817),c=()=>n(710149),u=()=>n(351360),p=()=>n(506090),m=()=>n(932065),y=()=>n(414402),g=()=>n(471725),v=n(474848);function b(e){const{modalId:t}=e,n=(0,r().O$)(g().D),l=(0,i().v3)();(0,o().w)((()=>{g().D.setState(!0)}));const c={defaultValues:{billingDetails:(0,r().K8)((()=>{const e=u().default.state.currentUserStore;return{email:null==e?void 0:e.getEmail(),name:null==e?void 0:e.getName()}}),[])},terms:{card:"never"}};return(0,v.jsxs)(m().iy,{title:n?(0,v.jsx)(y().y,{labelOnly:!0}):(0,v.jsx)(s().sA,{id:"subscriptions.checkout.paymentMethod.title",defaultMessage:"Payment method"}),children:[n?(0,v.jsx)(h,{}):null,(0,v.jsx)(a().PaymentElement,{options:c,onChange:e=>{d().C3(l,{event:e,modal_id:t}),p().A.update((e=>{if(!e.open)return e;const{paymentData:t,...n}=e;return n}))},onReady:()=>g().D.setState(!1)})]})}function h(){return(0,v.jsxs)(l().Y1,{gap:12,children:[(0,v.jsxs)(l().Y1,{direction:"horizontal",gap:12,children:[(0,v.jsx)(c().A,{style:{width:"50%",height:60,borderRadius:6}}),(0,v.jsx)(c().A,{style:{width:"50%",height:60,borderRadius:6}})]}),(0,v.jsx)(y().y,{}),(0,v.jsx)(y().y,{}),(0,v.jsx)(y().y,{}),(0,v.jsx)(y().y,{})]})}},816953:(e,t,n)=>{n.d(t,{A:()=>d});var a=()=>n(484714),i=()=>n(660237),o=()=>n(187174),r=()=>n(816758),s=()=>n(449506);function d(){var e;const t=(0,a().v3)(),[n]=(0,o().Yb)((async()=>{const e=await s().callApi({eventName:"getGeoIpLocation",environment:t,data:{}});if("success"===e.type)return e.data}),[t]),d=null==n||null===(e=n.value)||void 0===e?void 0:e.countryCodeFromIp;return!!(0,i().Ef)(d)&&(0,r().Lv)(d)}},977327:(e,t,n)=>{n.d(t,{d:()=>a});const a=(0,n(340498).xh)("infoBubble",{default:{loader:()=>n.e(89306).then(n.bind(n,889306))},small:{loader:()=>n.e(87344).then(n.bind(n,487344))},mini:{loader:()=>n.e(72612).then(n.bind(n,272612))},large:{loader:()=>n.e(78596).then(n.bind(n,778596))}})},986578:(e,t,n)=>{n.r(t),n.d(t,{CheckoutUpgradeModal:()=>ke});var a=()=>n(624119),i=n(296540),o=()=>n(484714),r=()=>n(56366),s=()=>n(762433),d=()=>n(107683),l=()=>n(38337),c=()=>n(506090),u=()=>n(224701),p=()=>n(112527),m=()=>n(134217),y=()=>n(972418),g=()=>n(847554),v=()=>n(981046),b=(n(944114),n(898992),n(737550),()=>n(852507)),h=()=>n(857639),f=()=>n(977327),x=()=>n(984380),S=()=>n(622963),I=()=>n(979340),_=()=>n(959013),C=()=>n(496603),w=()=>n(252105),A=()=>n(209660),j=()=>n(938987),T=()=>n(84817),M=()=>n(460292),P=()=>n(554509),D=()=>n(876853),E=()=>n(6208),k=()=>n(351360),U=()=>n(227440),B=()=>n(404141),O=(n(16280),n(354520),n(908872),()=>n(244641)),N=()=>n(584262),q=()=>n(967786),K=()=>n(179034),Y=()=>n(323063),F=()=>n(166386),R=()=>n(807487),L=()=>n(901389),z=()=>n(496414),V=()=>n(857783),Q=()=>n(436572),G=()=>n(34542),W=()=>n(211716),H=()=>n(770769),J=()=>n(57605),$=()=>n(630116),X=()=>n(23954),Z=()=>n(399995),ee=()=>n(106196),te=n(474848);function ne(e){const{onClick:t}=e;return(0,te.jsx)(ee().N,{buttonInfo:{onClick:t,label:(0,te.jsx)(_().sA,{id:"spaceSubscriptionUpgradeModal.upgradeAi.getStarted",defaultMessage:"Get started"})}})}var ae=()=>n(807778),ie=()=>n(779795),oe=()=>n(998497);const re=(0,_().YK)({cancelFailedSubscription:{id:"subscription.upgrade.cancel_failed_subscription",defaultMessage:"Cancelling subscription..."}});async function se(e){var t;const{address:n,billingEmail:a,billingInterval:i,coupon:o,currencyCode:r,environment:d,isStartingTrial:l,modalId:c,modalType:u,paymentData:p,promo:m,quantity:y,selectedProducts:g,stripe:v,useTestClock:b,vatId:h,intl:f}=e,x=k().default.state.currentSpaceStore;if(!x)return;const I=await ie().p_({environment:d,spaceId:x.id}),A=await J().A.awaitData(d,{spaceId:null==x?void 0:x.id});if(!A)throw new Error("Billing data not loaded");const j=(null===(t=(0,s().KH)(A,"sites_custom_hostnames"))||void 0===t?void 0:t.quantity)??0,T=(0,S().Nw)({prices:I,quantity:y,domainsQuantity:j}),M=(0,s().lQ)(A),P=l?O().c9.now().plus({days:14}):void 0,D=(0,C().oE)(g).filter((e=>"free"!==e)),E={interval:i,currency:r},U=D.reduce(((e,t)=>(0,Y().qq)(T,e,{...E,product:t})),{...M,trialEnd:P}),B=D.some((e=>(0,F().Jf)(o,e,i)));try{const e=await oe().updateSubscription({environment:d,spaceStore:x,desiredState:(0,Y().Vr)(I,U,i),paymentData:p,billingEmail:a,coupon:m&&"coupon"===m.source?m.code:void 0,customerName:n.name,businessName:n.businessName,addressLine1:n.addressLine1,addressCity:n.city,addressZip:n.zipCode,addressState:n.state,addressCountry:n.country,vatId:h??void 0,promoCodeId:m&&"promo_code"===m.source?m.code:void 0,from:"subscription_upgrade_modal",useTestClock:b,sessionId:c,inAppOffer:B?o:void 0});await oe().handlePaymentIntentNextActions({paymentIntentData:e,stripe:v,onSuccess:()=>{w().dI(d,{payment_intent_id:e.paymentIntentId,modal_id:c,modal_type:u})},onFailure:async()=>{await async function(e){const{updateSubscriptionResponse:t,environment:n,modalId:a,modalType:i,spaceStore:o,currencyCode:r,intl:s}=e,{subscriptionStatus:d,paymentIntentId:l}=t,c=X().w;await oe().refreshBillingHistory(n,c);const u=c.state.billingEvents;L().ui({message:"trialing"===d?(0,te.jsx)(_().sA,{id:"subscription.upgrade.payment_failed.trial",defaultMessage:"Please provide an alternate payment method to complete your upgrade."}):(0,te.jsx)(_().sA,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."}),showCancel:!1,keepFocus:!1,disableBackgroundDismiss:!0,items:[{label:(0,te.jsx)(_().sA,{id:"subscription.upgrade.payment_failed.pay_invoice",defaultMessage:"Complete payment"}),onAccept:()=>{if(w().GB(n,{payment_intent_id:l,modal_id:a,modal_type:i}),(0,ae().Ug)())return(0,Z().U)(n,o,r,[u[0]],X().w,s);window.open(t.invoiceUrl,"_blank")},color:"red"},{label:(0,te.jsx)(_().sA,{id:"subscription.upgrade.payment_failed.cancel",defaultMessage:"Cancel upgrade"}),onAccept:async()=>{w().WB(n,{payment_intent_id:t.paymentIntentId,modal_id:a,modal_type:i}),z().m({message:re.cancelFailedSubscription}),await oe().cancelSubscription({environment:n,spaceStore:o,from:"subscription_upgrade_modal-failed_payment"}),z().V()}}]})}({updateSubscriptionResponse:e,environment:d,modalId:c,spaceStore:x,currencyCode:r,intl:f})}}),m&&(0,q().rP)(d.currentUser.id)}catch{w().WB(d,{modal_id:c,modal_type:u})}}var de=()=>n(19575),le=()=>n(749356),ce=()=>n(601203),ue=()=>n(730764),pe=()=>n(637833),me=()=>n(558094),ye=()=>n(906195),ge=()=>n(775916),ve=()=>n(816953),be=()=>n(651390),he=()=>n(931783),fe=()=>n(662866),xe=()=>n(932065),Se=()=>n(161165),Ie=()=>n(401497),_e=()=>n(581495),Ce=()=>n(270511);function we(e){let{header:t,paymentContent:n,orderOptions:a,footer:i,showDismissButton:s}=e;const d=(0,o().v3)(),{isMobile:l}=(0,o().Y0)(),c=(0,r().K8)((()=>(0,Ce().A)(d)),[d])||!a,u=function(e){return(0,Ie().IS)((()=>({wrapper:{...!e&&{minWidth:506}},mobile:{display:"grid",gridTemplateRows:"1fr auto",overflow:"hidden auto"}})),[e])}(l),p=(0,te.jsxs)(T().Y1,{direction:c?"vertical":"horizontal",gap:c?20:32,style:{...l&&u.mobile},children:[(0,te.jsx)(T().Y1,{direction:"vertical",gap:c?20:28,width:c?"fill":420,children:n}),(0,te.jsxs)(T().Y1,{direction:"vertical",gap:c?20:28,width:c?"fill":310,children:[a,i]})]});return(0,te.jsxs)(T().Y1,{direction:"vertical",gap:c?28:36,padding:32,width:"hug",height:"hug",style:u.wrapper,children:[t,p,s&&(0,te.jsx)(_e().Rz,{})]})}n(581454);var Ae=()=>n(534177),je=()=>n(802790),Te=()=>n(331542),Me=()=>n(275764);function Pe(e){var t;const{state:n,data:a,promo:d,billingData:l,dueAtPeriodEnd:c,billingInterval:u,products:p}=e,{coupon:m,calculatingTax:y,taxAmount:b}=n,h=(0,o().v3)(),[f,x]=i.useState(!1),I=Me().Ux(d),_=(0,g().b)(a),[C,w,A]=(0,r().K8)((()=>{const e=p.map((e=>v().A.getPrice(h,(t=>t.product===e&&t.billingInterval===u))));let t,n;return"year"===u&&(t=p.map((e=>v().A.getPrice(h,(t=>t.product===e&&"month"===t.billingInterval)))),n=p.map((e=>v().A.getPrice(h,(t=>t.product===e&&"year"===t.billingInterval))))),[e,t,n]}),[u,h,p]);if(C.some((e=>!e.isLoaded)))return(0,te.jsx)(Te().A,{});const j=C.map((e=>e.result)).filter(Ae().O9),M=null==w?void 0:w.map((e=>e.result)).filter(Ae().O9),P=null==A?void 0:A.map((e=>e.result)).filter(Ae().O9),D=j[0].unitAmount.currencyValue,E=(null===(t=(0,s().KH)(l,"sites_custom_hostnames"))||void 0===t?void 0:t.quantity)??0,k=(0,S().Nw)({prices:j,quantity:_,domainsQuantity:E}),U=p.filter((e=>(0,F().Jf)(m,e,u))),B=U&&U.length>0,O=Me().G5({items:k,coupon:B?m:void 0}),N=B&&P,q=M&&P?Me().G5({items:(0,S().Nw)({prices:N?P:M,quantity:_,domainsQuantity:E})}).withMultipliedAmount(N?1:12):void 0,K=q?q.minus(O):void 0,Y=Me().g3({calculatingTax:y,taxAmount:b,currencyValue:D}),R=Me().jn({items:k,promo:I}),L=Me().o2(a,D),z=O.plus(Y).minus(R).minus(L),V=z.amount<0?z.withMultipliedAmount(0):z,Q=function(e){var t;let{hasDiscount:n,dueAtPeriodEnd:a,billingData:i,billingInterval:o}=e;if(n)return{chargeType:"immediate"};if(a&&null!=i&&null!==(t=i.subscription)&&void 0!==t&&t.currentPeriodEnd)return{chargeType:"nextPeriod",periodEnd:i.subscription.currentPeriodEnd};return{chargeType:void 0,billingInterval:o}}({hasDiscount:0!==R.amount&&0!==L.amount,dueAtPeriodEnd:c,billingData:l,billingInterval:u});return(0,te.jsxs)(T().Y1,{gap:2,children:[(0,te.jsx)(xe().BB,{total:V,handleToggleExpanded:()=>x((e=>!e)),isExpanded:f,discount:R,accountBalance:L,annualPriceDifference:K,coupon:B?m:void 0,isTotalLoading:y,...Q}),(0,te.jsx)(xe()._z,{isExpanded:f,children:(0,te.jsxs)(T().Y1,{gap:12,children:[(0,te.jsx)(xe().f5,{items:k,coupon:B?m:void 0}),(0,te.jsx)(je().A,{size:1}),(0,te.jsx)(xe().Qs,{subtotal:O,tax:Y,discount:R,accountBalance:L,showDiscountLine:0!==R.amount&&I&&!m,isCalculatingTax:y,subtotalMonthly:q})]})})]})}var De=()=>n(585312);function Ee(e){const{state:t,data:n,spaceStore:d,spaceViewStore:l}=e,u=(0,o().v3)(),g=(0,_().tz)(),O=(0,a().useStripe)(),q=(0,a().useElements)(),{isMobile:Y}=(0,o().Y0)(),F=(0,y().lh)({spaceId:d.id}),L=(0,r().K8)((()=>k().default.state.currentUserRootStore),[]),z=(0,ge().p)(),J=(0,r().K8)((()=>{if(c().A.state.open)return c().A.state.dismissMobilePlansModal}),[]),X=(0,r().K8)((()=>U().A.state.online),[]),{availableCurrencyCodes:Z,currencyCode:ee}=(0,r().K8)((()=>({availableCurrencyCodes:v().A.availableCurrencyCodes,currencyCode:v().A.selectedCurrencyCode??"USD"})),[]),oe=(0,ve().A)(),re=(0,E().L)(),Ie=(0,y().UL)(),_e=(0,ye().D)(),Ce=(0,r().K8)((()=>t.addOnFeature??(0,S()._y)(t.subscriptionTier)),[t.addOnFeature,t.subscriptionTier]),Ae=(0,Se().v1)(F,z,Ce);(0,b().l)((()=>{const e=m().qc(n);c().A.update((t=>{var a;return{...t,appliedPromo:e?null===(a=n.customerData)||void 0===a?void 0:a.stripe.promo:void 0}})),e&&void 0!==(null==F?void 0:F.address)&&c().A.setAddressField(null==F?void 0:F.address)}));const je=Ae&&(0,s().eh)(F,"ai"),Te=(0,r().K8)((()=>{const e=[Ce];return!((0,s().ji)(F)??[]).includes("ai")&&!Ae&&e.push("ai"),e}),[Ce,F,Ae]),[{billingInterval:Me,addOnFeature:Ee,name:ke,businessName:Ue,vatId:Be},Oe]=i.useState({billingInterval:"ai"===Ce?"year":"month",name:re??"",businessName:"",vatId:oe?"":void 0}),[Ne,qe]=i.useState({}),[Ke,Ye]=i.useState(),[Fe,Re]=i.useState(!1),Le=i.useCallback((e=>{Ye(void 0),e.name&&qe((e=>({...e,name:void 0}))),Oe((t=>({...t,...e})))}),[]),ze=i.useMemo((()=>(0,C().sb)((0,C().oE)([Ce,Ee,...je?["ai"]:[]]))),[Ce,Ee,je]),[Ve,Qe]=i.useState(!1);i.useEffect((()=>{Ie&&!t.coupon&&(c().A.update((e=>({...e,coupon:"ai_fifty_percent"}))),async function(){await(0,le().x3)({environment:u,hasReceived:!1,offerType:"add_on_upgrade_flow",coupon:"ai_fifty_percent"})}())}),[t.coupon,Ie,u]),i.useEffect((()=>{_e&&("month"===Me&&"plus"===Ce&&(c().A.update((e=>({...e,coupon:"resurrection_offer"}))),Ve||(!async function(){await(0,le().x3)({environment:u,hasReceived:!1,offerType:"resurrection_flow",coupon:"resurrection_offer"})}(),Qe(!0))),"year"===Me&&"plus"===Ce&&c().A.update((e=>({...e,coupon:void 0}))))}),[t.coupon,_e,Me,Ce,u,Ve]),i.useEffect((()=>{ce().Qe({environment:u,billingInterval:Me,vatId:Be,billingData:F,addOn:Ee,onlyShowAddOn:"ai"===Ce})}),[u,Me,Ee,Be,F,Ce]);const Ge={month:(0,be().H)({billingInterval:"month",priceStore:v().A,products:Te}),year:(0,be().H)({billingInterval:"year",priceStore:v().A,products:Te})},We=(0,he()._)({asyncPrice:Ge[Me??"month"].ai}),He=(0,Se().tA)(F,Ie),Je=(0,he()._)({asyncPrice:Ge.month[Ce]}),$e=(0,he()._)({asyncPrice:Ge.year[Ce]}),Xe=i.useCallback((async e=>{if(Ye(void 0),!(0,D().r)(ke))return void qe((e=>({...e,name:g.formatMessage({id:"spaceSubscriptionUpgradeModal.name.required.error",defaultMessage:"Please enter a valid name."})})));if(w().Fp(u,{modal_id:t.sessionId}),Re(!0),!q||!O)return(0,h().log)({level:"error",from:"SpaceSubscriptionUpgradeModal",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}}),Ye(g.formatMessage({id:"spaceSubscriptionUpgradeModal.payment.genericError",defaultMessage:"Your payment could not be processed. Please try again."})),void Re(!1);const a=await m().$(u,d.id,n),i=await async function(e){const{billingEmail:t,coupon:n,currencyCode:a,environment:i,elements:o,billingInterval:r,name:s,businessName:d,vatId:l,intl:c,modalId:u,promo:m,quantity:y,selectedProducts:g,stripe:v,useTestClock:b}=e,h=await async function(e){const{modalId:t,modalType:n,environment:a,intl:i,elements:o,stripe:r}=e,s=i.formatMessage({id:"spaceSubscriptionUpgradeModal.payment.genericError",defaultMessage:"Your payment could not be processed. Please try again."}),{error:d}=await o.submit();if(d)return w().qC(a,{error:"could not submit form",error_type:"payment_method",modal_id:t,modal_type:n}),{error:s};const{error:l,paymentMethod:c}=await r.createPaymentMethod({elements:o});if(l)return w().qC(a,{error:l.message,error_type:"payment_method",modal_id:t,modal_type:n}),w().cr(a,{error:l.code,stripe_decline_code:l.decline_code}),{error:p().translateStripeError(i,l)};if(!c)return w().qC(a,{error:"could not create token",error_type:"payment_method",modal_id:t,modal_type:n}),{error:s};const u={type:"paymentMethodId",value:c.id},m=c.billing_details.address;return{paymentData:u,address:{zipCode:(null==m?void 0:m.postal_code)??"",country:R()._q.includes(c.type)?"KR":(null==m?void 0:m.country)??""}}}({modalId:u,environment:i,intl:c,elements:o,stripe:v});if("error"in h)return{error:h.error};return void(await se({address:{name:s??"",businessName:d??"",addressLine1:"",addressLine2:"",zipCode:h.address.zipCode??"",city:"",state:"",country:h.address.country??""},billingEmail:t,billingInterval:r,coupon:n,currencyCode:a,environment:i,modalId:u,paymentData:h.paymentData,promo:m,quantity:y,selectedProducts:g,stripe:v,vatId:l,useTestClock:b,intl:c}))}({billingEmail:m().Nl(t,F),coupon:t.coupon,currencyCode:ee,environment:u,elements:q,intl:g,billingInterval:Me,name:ke,businessName:Ue,vatId:oe?Be:void 0,modalId:t.sessionId,promo:t.appliedPromo,quantity:a,selectedProducts:ze,stripe:O,useTestClock:e.useTestClock});return null!=i&&i.error?(Ye(i.error),void Re(!1)):(function(e){const{environment:t,modalId:n}=e;c().A.reset(),w().OC(t,{modal_id:n})}({environment:u,modalId:t.sessionId}),"ai"===Ce?(B().A.reset(),function(e){const{environment:t,spaceStore:n,spaceViewStore:a,intl:i,currentUserRootStore:o}=e,r=(0,H().getAIUpgradeTemplate)({intl:i});if(!r)throw new Error("AI template not found");if(!o)throw new Error("Cannot create BlockStore: currentUserRootStore not found");const s=$().Bv.createChildStore(o,{table:K().ev,id:r.rootId});(0,G().Fq)({environment:t,blockStore:s,spaceStore:n,spaceViewStore:a,hideModal:!0,disableRedirect:!0,showDuplicationStartedToast:!1,showDuplicationFinishedToast:!1}).then((e=>{e&&Q().D6({label:i.formatMessage({id:"spaceSubscriptionUpgradeModal.upgradeAi.success",defaultMessage:"You now have unlimited Notion AI"}),style:{gap:8,display:"flex"},right:(0,te.jsx)(ne,{onClick:()=>{V().uK({environment:t,store:e,visitType:W().ig.Link,pageVisitSource:N().y8.Duplicate})}})})})).catch((e=>{h().log({from:"client/checkoutActions",level:"error",type:"aiUpgrade.duplicationFailed",data:{message:"AI Upgrade duplication failed.  Block store not found"}})}))}({environment:u,spaceStore:d,spaceViewStore:l,intl:g,currentUserRootStore:L}),void(Y&&(null==J||J()))):void A().Ow({currentTab:"billing"}))}),[F,Me,Ue,ee,L,n,q,u,g,Y,ke,J,Ce,ze,d,l,t,O,oe,Be]),Ze=(0,r().K8)((()=>(0,ae().Ir)()&&!1),[]),et=[{buttonType:"primary",isDisabled:Fe,isLoading:Fe,label:x().Kq.some((e=>e===Ce))?(0,te.jsx)(_().sA,{id:"subscriptionUpgradeModal.upgradeButton.upgradeToPlan",defaultMessage:"Upgrade to {plan}",values:{plan:(0,I().u2)(Ce,g)}}):(0,te.jsx)(_().sA,{id:"subscriptionUpgradeModal.upgradeButton.upgradeAi",defaultMessage:"Upgrade now"}),onClick:()=>Xe({useTestClock:!1})}];Ze&&et.push({buttonType:"primary",isDisabled:Fe,label:"ðŸš§ Upgrade with Test Clock ðŸš§",onClick:()=>Xe({useTestClock:!0})});const tt=["business","enterprise"].includes(Ce)?[{buttonType:"outline",label:(0,te.jsxs)(T().Y1,{direction:"horizontal",gap:6,align:"center",children:[(0,te.jsx)(M().Q,{iconGroup:f().d,variantName:"default",colorName:"primary"}),(0,te.jsx)(_().sA,{id:"spaceSubscriptionSettings.upgradeModal.contactSales",defaultMessage:"Contact sales"})]}),onClick:()=>(0,de().lK)({initialQuestion:"enterprise"===Ce?"interest_in_enterprise":"interest_in_business",openedFrom:"enterprise"===Ce?"enterprise_checkout_modal":"business_checkout_modal"})}]:void 0;if(!X)return(0,te.jsx)(fe()._,{});const nt=(0,Se().P8)({product:Ce,coupon:t.coupon,isOnTrialWithAiProduct:je});return Ae&&(nt.subtitle=(0,te.jsx)(P().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",customStyles:{maxWidth:525},children:(0,te.jsx)(_().sA,{id:"subscriptionUpgradeModal.upgradeDuringTrial",defaultMessage:"Unlimited access to our most loved team features. If you choose not to upgrade, you will be on a free plan with restricted usage."})})),(0,te.jsx)(we,{showDismissButton:!0,header:(0,te.jsx)(xe().K4,{...nt,image:"ai"===Ce?(0,te.jsx)(j().cG,{variant:"medium",style:{}}):(0,te.jsx)(me().X,{product:Ce})}),paymentContent:(0,te.jsxs)(T().Y1,{gap:14,children:[(0,te.jsx)(xe().ck,{formData:{name:ke,businessName:Ue,vatId:Be},onChangeFormData:Le,errors:Ne,modalId:t.sessionId}),(0,te.jsx)(De().q,{modalId:t.sessionId})]}),orderOptions:He?null:(0,te.jsxs)(T().Y1,{gap:20,children:[(0,te.jsx)(xe().TJ,{selectedBillingInterval:Me,monthlyUnitPrice:Je,yearlyUnitPrice:$e,onChange:e=>{w().bT(u,{billingInterval:e,modal_id:t.sessionId}),Le({billingInterval:e})},product:Ce,coupon:t.coupon}),Te.includes("ai")&&"ai"!==Ce?(0,te.jsx)(xe().nB,{selectedAddOn:Ee,unitPrice:We,onChange:e=>{w().Gs(u,{addOnFeatures:e?[e]:void 0,modal_id:t.sessionId}),Le({addOnFeature:e})},coupon:t.coupon,billingInterval:Me}):null,(0,te.jsx)("div",{style:{position:"absolute",top:-8,right:0},children:(0,te.jsx)(pe().y,{availableCurrencyCodes:Z,selectedCurrencyCode:ee,onSelectCurrency:ie().cP,from:"upgrade_modal"})})]}),footer:(0,te.jsxs)(T().Y1,{gap:16,children:[(0,te.jsx)(Pe,{state:t,data:n,billingInterval:Me,products:ze,promo:t.appliedPromo,billingData:F,dueAtPeriodEnd:Ae}),(0,te.jsx)(xe().iu,{primaryButtons:et,secondaryButtons:tt,termsOfService:(0,te.jsx)(ue().w,{showTrialEndDisclaimer:(0,s().TB)(F)&&!Se().v1,products:ze})}),Ke?(0,te.jsx)(P().D,{styleName:"Caption-12px/Regular",colorName:"uiRedPrimary",children:Ke}):null]})})}function ke(e){let{data:t,spaceStore:n,spaceViewStore:a}=e;const i=(0,o().v3)(),s=(0,y().lh)({spaceId:n.id}),p=(0,r().K8)((()=>c().A.state),[]);return(0,te.jsx)(d().s,{ariaLabelledBy:l().Kvs,isOpen:p.open,onClosed:()=>u().dl(i),animateSizeTransition:!1,areaConstraint:{width:{type:"min",length:400}},render:()=>p.open?(0,te.jsx)("div",{style:{overflowY:"auto"},children:(0,te.jsx)(Ue,{state:p,billingData:s,data:t,spaceStore:n,spaceViewStore:a})}):null})}function Ue(e){const{state:t,billingData:n,data:i,spaceStore:o,spaceViewStore:d}=e,{subscriptionTier:l,onlyShowAddOn:c,calculatingTax:u,temporaryBillingInterval:y,taxAmount:b,addOnFeature:h,coupon:f}=t,x=(0,r().K8)((()=>(0,s().Ry)(n)??v().A.selectedCurrencyCode),[n]),S=(0,g().b)(i),{payAmount:I}=m().TQ({subscriptionTier:l,memberCount:S,currencyCode:x,promo:t.appliedPromo,data:i,onlyShowAddOn:c,calculatingTax:u,billingInterval:y??"year",taxAmount:b,addOnFeature:h,coupon:f}),_=(0,p().useElementsOptions)({type:"subscription",amount:I.amount,currency:I.currencyCode}),C=(0,p().getStripe)();return(0,te.jsx)(a().Elements,{stripe:C,options:_,children:(0,te.jsx)(Ee,{spaceViewStore:d,state:t,data:i,spaceStore:o})})}}}]);