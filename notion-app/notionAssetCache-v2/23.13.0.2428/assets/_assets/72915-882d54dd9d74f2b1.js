"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[72915],{372915:(e,t,n)=>{n.d(t,{O:()=>he,A:()=>ve});var i=n(296540),o=()=>n(908006),s=()=>n(484714),r=()=>n(819121),l=()=>n(56366),a=()=>n(835755),d=()=>n(263931),c=()=>n(861017),g=()=>n(919709),u=()=>n(959013),p=()=>n(317909);const S=1e3;function f(e){if(e){const t=(0,g().q4_)(e.getValue());return Boolean(t)}return!1}function x(e){if(e){const t=e.getSettings();if(t&&t.hidden_collection_descriptions)return t.hidden_collection_descriptions}return[]}function m(e){const{environment:t,pageId:n,isExpanded:i,store:o,userSettingsStore:s,descriptionStore:r}=e,l=o.state.isExpanded;o.setState({isExpanded:i});f(r)&&s&&l!==i&&p().createAndCommit({userAction:"pageDescriptionActions.setExpanded",environment:t,canUndo:!0,perform:e=>{if(i){const t={pointer:{table:"user_settings",id:s.id},path:["settings","hidden_collection_descriptions"],command:"listRemove",args:{id:n}};p().applyOperation({store:s,transaction:e,operation:t})}else{const t={pointer:{table:"user_settings",id:s.id},path:["settings","hidden_collection_descriptions"],command:"listAfter",args:{id:n}};p().applyOperation({store:s,transaction:e,operation:t});let i=x(s);for(;i.length>S;){const t=i[0],n={pointer:{table:"user_settings",id:s.id},path:["settings","hidden_collection_descriptions"],command:"listRemove",args:{id:t}};p().applyOperation({store:s,transaction:e,operation:n}),i=x(s)}}}})}var h=()=>n(778417),v=()=>n(725614),y=()=>n(186445),b=()=>n(478726),C=()=>n(836251),j=()=>n(792002),w=()=>n(645873),M=()=>n(551619),I=()=>n(817942),K=()=>n(792485),E=()=>n(315564),A=()=>n(220719),k=()=>n(496603),T=()=>n(284371),_=()=>n(606952),P=()=>n(614505),B=()=>n(16006),R=()=>n(859428),D=()=>n(246722),L=()=>n(792540),V=()=>n(231722),F=()=>n(731320),U=()=>n(969197),z=()=>n(77246),W=()=>n(24157),O=n(474848);function H(e){let{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:s,collectionStore:r,locked:l,canEdit:a}=e;return(0,O.jsx)("div",{style:{maxWidth:"100%",borderRadius:4,overflow:"hidden",marginBottom:12},children:(0,O.jsx)(ee,{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:s,collectionStore:r,locked:l,canEdit:a})})}const N=i.memo(H);function G(e){return e.isExpanded()}function Q(e){let{collectionStore:t}=e;const n=(0,l().K8)((()=>t&&t.getIcon()),[t]);return(0,O.jsxs)("div",{style:{display:"flex",alignItems:"start"},children:[(0,O.jsx)("div",{style:{paddingTop:4,paddingRight:6},children:(0,E().S)({width:12})}),(0,O.jsx)("div",{children:(0,O.jsx)("div",{children:(0,O.jsx)(u().sA,{defaultMessage:"Please unlock {pageTitleWithIcon} to edit the description.",id:"pageDescription.lockedTooltip.message",values:{pageTitleWithIcon:(0,O.jsxs)("span",{style:{whiteSpace:"nowrap",fontWeight:T().Wy.bold},children:[n&&(0,O.jsx)(P().A,{disabled:!0,icon:n,isEmptyPage:!1,size:12,style:{marginRight:4,display:"inline-block"}}),t&&(0,O.jsx)(B().A,{store:t,style:{display:"inline"}})]})}})})})]})}function $(e){return!0}function J(e){return!0}function Y(e,t,n,i,o,s){G(t)||e.preventDefault(),function(e,t,n,i,o){m({environment:i,pageId:t,isExpanded:!G(e),store:e,userSettingsStore:o,descriptionStore:n})}(t,n,i,o,s)}function q(e,t,n,i,o,s){if(!function(e,t,n){const i=n&&n.publicEditModeStore.state,o=(0,A().o9)((0,U().T)(e));return!t&&!(0,F().QT)(i)&&"suggest"!==z().Uv.getMode(o)&&e.canEdit()}(n,i,s))return;if(e.preventDefault(),o&&o.isComposing())return;const r=W().default.state;if("editing"===r.mode){const e=(0,V().H7)(r.multiSelection);if(!e)return;const i=null!=s&&s.pageStore?z().Uv.getMode(s.pageStore):"default";p().createAndCommit({userAction:"PageDescription.handleEnter",environment:t,canUndo:!0,perform:o=>{_().$D({environment:t,editorMode:i,store:n,string:"\n",selection:e.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}})}}const Z={fontSize:14,paddingLeft:6,paddingBottom:4,paddingTop:3,width:780};function X(e){let{descriptionStore:t,disabled:n,toggleStore:o,pageId:r,userSettingsStore:a}=e;const d=(0,s().v3)(),c=(0,u().tz)(),{device:g}=d,p=(0,K().S)(),S=(0,i.useRef)(null),f=(0,i.useCallback)((e=>q(e,d,t,n,S.current,p)),[d,t,n,p,S]),x=(0,l().K8)((()=>G(o)),[o]);return t?(0,O.jsx)(D().A,{ref:S,store:t,style:Z,disabled:n,placeholder:c.formatMessage({defaultMessage:"Add a descriptionâ€¦",id:"pageDescription.emptyPlaceholder"}),disableSlashCommands:!0,disableEmbedMenu:!0,disableMentions:!0,onTab:$,onUntab:J,onEnter:f,onClick:x?k().lQ:e=>Y(e,o,r,t,d,a),disableStyleAnnotations:g.isMobileBrowser,disableInsertedDeletedAnnotations:g.isMobileBrowser,disableHorizontalEdgeScroll:!0,pasteBehavior:"inline",inPageFind:L().Os.none}):null}function ee(e){let{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:r,collectionStore:l,locked:a,canEdit:d}=e;return(0,s().v3)().device.isMobile?(0,O.jsx)(X,{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:r}):(0,O.jsx)(R().A,{renderTooltip:()=>(0,O.jsx)(Q,{collectionStore:l}),disableTooltip:!a||!d,render:e=>(0,O.jsx)("div",{children:(0,O.jsx)("div",{style:{display:"flex",cursor:"text"},...e,children:(0,O.jsx)(X,{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:r})})})})}var te=()=>n(603616),ne=()=>n(781141),ie=()=>n(441301),oe=()=>n(644914),se=()=>n(578872),re=()=>n(351360),le=()=>n(661179);class ae extends(()=>n(757695))().default{getInitialState(){return{isExpanded:!0}}isExpanded(){return Boolean(this.state.isExpanded)}}const de=ae;var ce=()=>n(548821),ge=()=>n(563615),ue=()=>n(938090),pe=()=>n(145214),Se=()=>n(493823),fe=()=>n(774524),xe=()=>n(556048);function me(e){const{canEdit:t,context:n,controlHoverStyle:p,disabled:S,handleHeaderMouseEnter:w,handleHeaderMouseLeave:K,headerFocusStore:E,isEditable:A,paddingLeft:k,paddingRight:T,pageCover:_,store:P,topControls:B,onCollectionViewBlockMount:R,editorContentContainerRef:D}=e,L=(0,s().v3)(),V=(0,s().Y0)(),[F,U]=(0,i.useState)(!!V.isAndroid);(0,i.useEffect)((()=>{(async()=>{if((0,C().w6)(L)){const e=L.RouterStore.getState();if((0,c().bh)(e.route)){const e=(0,se().GN)(P),t=null==e?void 0:e.getSiteStore();await(null==t?void 0:t.load());const n=null==t?void 0:t.getSettings(),i=null==n?void 0:n.embedSettings;return void U(Boolean(!(null!=i&&i.hideTitle)))}}U(!0)})()}),[L,P]);const W=(0,i.useMemo)((()=>new de),[]),H=(0,l().K8)((()=>P.getCollectionViewSourceDescriptionStore()),[P]),G=(0,l().K8)((()=>P.getCollectionViewSourceCollectionStore()),[P]),Q=(0,l().K8)((()=>f(H)),[H]),$=(0,l().K8)((()=>P.getTitleStore()),[P]),J=(0,l().K8)((()=>z().Uv.getMode(P)),[P]),Y=i.useRef(!1);(0,i.useEffect)((()=>{if(!Y.current){Y.current=!0;const{currentUserSettingsStore:e}=re().default.state;!function(e){const{pageId:t,store:n,userSettingsStore:i,descriptionHasText:o}=e;let s=o;x(i).includes(t)&&(s=!1),n.setState({isExpanded:s})}({pageId:P.id,store:W,userSettingsStore:e,descriptionHasText:Q})}}),[Q,P.id,W]);const q=(0,l().K8)((()=>g().q4_(null==$?void 0:$.getValue())),[$]),Z=(0,l().K8)((()=>!(0!==P.getCollectionViewStores().length)||(!!P.getCollectionViewSourceCollectionStore()||!!$&&(!!q||!!(0,j().j_)($)))),[P,$,q]),X=(0,l().K8)((()=>y().sj(P.id)||y().Wu(P.id)),[P]),ee=(0,l().K8)((()=>(0,b().NR)(P,L)),[P,L]),ae=(0,l().K8)((()=>(0,b().uf)(P,n,L)),[P,n,L]),ge=(0,M().dK)(P),me=(0,M().l8)(P),he=ge||me,ve=()=>{const{currentUserSettingsStore:e}=re().default.state,t=P.id;m({environment:L,pageId:t,isExpanded:!1,store:W,userSettingsStore:e,descriptionStore:H})},ye=()=>{const{currentUserSettingsStore:e}=re().default.state,t=P.id;m({environment:L,pageId:t,isExpanded:!0,store:W,userSettingsStore:e,descriptionStore:H})},be=(0,l().K8)((()=>{const e=W.isExpanded();return(f(H)||A)&&e}),[H,A,W]),Ce=(0,l().K8)((()=>{if(!be)return{type:"hidden"};if(!H)return{type:"hidden"};if(!W.isExpanded())return{type:"hidden"};const{currentUserSettingsStore:e}=re().default.state;return{type:"visible",descriptionStore:H,currentUserSettingsStore:e,collectionStore:G}}),[H,G,W,be]),je=(0,l().K8)((()=>P.isNonEditableState()),[P]),we=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,r().p)(t)&&E.setState(!0)},Me=()=>{const{currentUserSettingsStore:e}=re().default.state,t=H;m({environment:L,pageId:P.id,store:W,userSettingsStore:e,isExpanded:!0,descriptionStore:t}),o().default.afterNextFlush((()=>{t&&!V.isMobileBrowser&&v().setSelectionAtEnd({store:t})}))},Ie=()=>{E.setState(!1)},Ke=()=>{$&&(h().IU({environment:L}),v().setSelectionAtEnd({store:$}))},Ee=()=>{if(A&&!G&&!q)return(0,O.jsx)(Se().p,{style:p,isLightGray:!0,onClick:Ke,icon:d().D,children:V.isSmallPhone?(0,O.jsx)(u().sA,{id:"pageViewBlock.add.pageTitleMobile",defaultMessage:"Title"}):(0,O.jsx)(u().sA,{id:"pageViewBlock.add.pageTitle",defaultMessage:"Add title"})},"add-title")},Ae=()=>{if(G)return be?(0,O.jsx)(Se().p,{isLightGray:!0,style:p,onClick:ve,icon:a().p,children:(0,O.jsx)(u().sA,{defaultMessage:"Hide description",id:"pageViewBlock.hideDescription.button"})}):A&&!Q&&"suggest"!==J?(0,O.jsx)(Se().p,{isLightGray:!0,style:p,onClick:Me,icon:a().p,children:V.isSmallPhone?(0,O.jsx)(u().sA,{defaultMessage:"Description",id:"pageViewBlock.addDescription.mobileButton"}):(0,O.jsx)(u().sA,{defaultMessage:"Add description",id:"pageViewBlock.addDescription.button"})}):Q?(0,O.jsx)(Se().p,{isLightGray:!0,style:p,onClick:ye,icon:a().p,children:V.isSmallPhone?(0,O.jsx)(u().sA,{defaultMessage:"Description",id:"pageViewBlock.showDescription.mobileButton"}):(0,O.jsx)(u().sA,{defaultMessage:"Show description",id:"pageViewBlock.showDescription.button"})}):void 0},ke=(0,l().K8)((()=>(0,oe().Uh)(L)+(0,oe().zo)(L,!1)-le().A.state-k),[L,k]),Te=(0,l().K8)((()=>{const{WindowSizeStore:e}=L;return{paddingLeft:e.getSafePaddingLeftCSS(k),paddingRight:e.getSafePaddingRightCSS(T)}}),[L,k,T]);const _e=(0,l().K8)((()=>function(e,t){if(!function(e){var t;return e.id===(null===(t=re().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)}(t))return;const{RouterStore:n}=e,i=n.state.route;if("page"===i.name)return i.collectionViewId}(L,P)),[P,L]);return(0,O.jsxs)(O.Fragment,{children:[F&&function(){const i=X?null:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,O.jsx)(te().A,{...e}),Z&&(0,O.jsx)(ie().s,{...e})]});return(0,O.jsxs)("div",{style:ee,onMouseEnter:w,onMouseLeave:K,children:[_,(0,O.jsxs)(pe().A,{animate:{width:ae},style:{maxWidth:"100%",paddingLeft:Te.paddingLeft},children:[(0,O.jsxs)(fe().A,{store:P,context:e.context,onFocus:we,onBlur:Ie,children:[B,Ee(),Ae()]}),(0,O.jsxs)("div",{style:{paddingRight:Te.paddingRight,marginBottom:8,width:ke},children:[i,he&&(0,O.jsx)(xe().GL,{store:P}),"visible"===Ce.type&&(0,O.jsx)(N,{disabled:!A,canEdit:t,locked:je,pageId:P.id,toggleStore:W,descriptionStore:Ce.descriptionStore,collectionStore:Ce.collectionStore,userSettingsStore:Ce.currentUserSettingsStore}),(0,O.jsx)(ne().h,{store:P,context:n,layoutModule:void 0,disabled:S||"suggest"===J,wrapper:e=>(0,O.jsx)(I().vV,{className:"layout-content-with-divider",children:e})},P.id)]})]})]})}(),(0,O.jsx)(ue().dN,{editorContentContainerRef:D,overridePaddingLeft:k,overridePaddingRight:T,store:P,isFullScreen:!0,viewId:_e,disabled:S,headerActionsBehavior:n===ce().Rr.InAppTemplatePreview?"hidden":"default",onMount:R})]})}function he(e){const t=(0,s().v3)(),{value:n}=(0,w().fJ)(ge().oQ.workflowNavigationHelpers);return(0,l().K8)((()=>null==n?void 0:n.getIsWorkflowEditorOpen(t)),[t,n])?(0,O.jsx)(ge().$b,{...e,renderLoading:()=>(0,O.jsx)(me,{...e})}):(0,O.jsx)(me,{...e})}const ve=i.memo(me,n(821062).A)},441301:(e,t,n)=>{n.d(t,{s:()=>u});var i=n(296540),o=()=>n(662303),s=()=>n(484714),r=()=>n(56366),l=()=>n(799954),a=()=>n(284371),d=()=>n(548821),c=()=>n(551619),g=n(474848);const u=i.memo((function(e){let{store:t,context:u,disabled:S,isInSidePeek:f,extraStyles:x,titlePlaceholder:m,collectionContextStore:h,shouldShowTemplatePicker:v,onTitleChange:y,onTitleEditText:b,onTitleEsc:C,onTitleUntab:j,onTitleTab:w,onMoveUp:M,onMoveDown:I,hideText:K,disableEnter:E}=e;const A=(0,n(959013).tz)(),k=(0,s().v3)(),T=(0,s().Y0)(),_=(0,n(792485).S)(),P=(0,r().K8)((()=>t.getTitleStore()),[t]),B=(0,r().K8)((()=>{if(t.isCollectionView()){const e=t.getCollectionViewSourceCollectionStore();return!!e&&e.isSyncedCollection()}return t.isType(n(700500).xd.externalObjectInstancePage)}),[t]),R=(0,c().Sm)(t),D=(0,r().K8)((()=>{if(S)return!1;if(n(620149).l.state)return!1;const e=_&&_.publicEditModeStore.state;return!(0,n(731320).QT)(e)&&t.canEditCollection()}),[S,_,t]),L=(0,r().K8)((()=>{if(!t.isCollectionView())return!1;const e=t.getCollectionViewSourceCollectionStore();return!!e&&(0,n(107041).Qu)(e.getValue())}),[t]),V=(0,r().K8)((()=>{const e=t.getModel();return m??(null==e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:t.getRecordModel,userTimeZone:(0,n(416504).P)(),intl:n(972435).A.getIntl()}))}),[t,m]),F=!k.device.isMobile&&f,U=(0,r().K8)((()=>D&&!t.isNonEditableState()&&!B&&!R&&!(0,n(696746).Nh)(t.id)&&!("suggest"===n(77246).Uv.getMode(t))),[D,B,R,t]),z=(0,r().K8)((()=>t.isEmptyPage()),[t]),W=(0,r().K8)((()=>t.isTemplate()),[t]),O=(0,r().K8)((()=>t.getAssociatedCollectionTemplateStores()),[t]),H=(0,r().K8)((()=>t.getSyncedUri()),[t]),N=function(e){const{store:t,isInSidePeek:i,context:c,extraStyles:g}=e,u=(0,s().v3)(),p=(0,r().K8)((()=>t.getFormat()),[t]),S=(0,r().K8)((()=>t.isCollectionView()),[t]),f=(0,r().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);return(0,n(401497).IS)((e=>{const t=!!p.page_small_text||u.device.isMobile||S||i;let n;n=u.device.isMobile?28:t?32:c===d().Rr.DraftPostInInlineComposer?26:40;const s=c===d().Rr.DraftPostInInlineComposer?a().Wy.semibold:a().Wy.bold,r=u.device.isMobile?"0px":`${l().nE}px`;return{title:{...l().nE,paddingBottom:r,width:f?"fit-content":"100%",fontSize:"1em",fontWeight:"inherit",margin:0,...c===d().Rr.DraftPostInInlineComposer&&{fontSize:24}},selectable:{color:e.regularTextColor,fontWeight:s,lineHeight:1.2,fontSize:n,fontFamily:a().xf({pageFont:p.page_font,locale:o().locale}),cursor:"text",display:"flex",alignItems:"center",textRendering:u.device.isSafari?"optimizeSpeed":void 0,...g},link:{width:16,fill:e.mediumIconColor},placeholder:{...l().nE,paddingBottom:r,WebkitTextFillColor:e.pageTitlePlaceholderTextColor,cursor:"text",...c===d().Rr.DraftPostInInlineComposer&&{color:e.text.tertiary,WebkitTextFillColor:e.text.tertiary}}}}),[u.device.isMobile,u.device.isSafari,g,p.page_font,p.page_small_text,S,f,i,c])}({store:t,isInSidePeek:f,context:u,extraStyles:x}),G=(0,r().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]),Q=(0,r().K8)((()=>t.isExternalCollectionBlockStore()?t:void 0),[t]),$=(0,r().K8)((()=>(null==Q?void 0:Q.canEdit())??!1),[Q]),J=(0,r().K8)((()=>H?(0,n(493208).e)(H,t.pointer.spaceId):void 0),[t.pointer.spaceId,H]),Y=(0,r().K8)((()=>n(430483).zD.shouldEnablePageTitleDiffs(T)),[T]),q=O&&0===O.length,Z=(0,c().O9)(t,u),X=(0,r().K8)((()=>!!E||!Z&&(!(!v||W||q||k.device.isMobile)&&z)),[Z,E,v,W,q,k.device.isMobile,z]),ee=(0,i.useRef)(null),te=(0,i.useCallback)((()=>{t&&n(317909).createAndCommit({userAction:"TourTutorial.createEmptyTextBlock",environment:k,canUndo:!0,perform:e=>{n(324089)._N({environment:k,store:t,transaction:e})}})}),[t,k]);if(L)return null;if(!P)return null;const ne=n(630116).Bv.createChildStore(P,t.pointer),ie=k.device.isIOS||k.device.isSafari,oe=(0,g.jsx)(n(998109).n,{step:"create_page_start_with_title",showSidebarOverlays:!1,onNextButtonClick:te,children:K?(0,g.jsx)(g.Fragment,{}):(0,g.jsx)(n(246722).A,{tagName:"h1",style:N.title,store:P,placeholderStyle:N.placeholder,disabled:!U,placeholder:V,disableSlashCommands:!0,disableSelectAllBlocks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!Y,disableMobileActionBar:!1,disableShiftEnter:!0,disableEmbedMenu:!0,onEsc:C,onUntab:j,onTab:w,onMoveDown:I,onMoveUp:M,disableUpDownArrows:!(!v||W||q||k.device.isMobile)&&z,disableEnter:X,onChange:y,disableHorizontalEdgeScroll:!0,pasteBehavior:"block",trackEditsToUserFlow:"user_flow_edit_page_title",inPageFind:n(792540).Os.block_match},P.id)}),se=A.formatMessage({id:"PageTitle.syncedBlock.original",defaultMessage:"Link to original url"});return(0,g.jsxs)("div",{style:F?{flex:1}:void 0,ref:ee,children:[(0,g.jsxs)(n(199896).A,{canSelect:!1,canDrag:!1,canEditText:U,onEditText:b,store:ne,style:N.selectable,analyticsName:"page_content",shouldShowDropZone:!0,children:[ie?(0,g.jsx)(n(155004).s,{allowSelectionWithin:!0,style:{width:"100%",maxWidth:"100%"},children:oe}):oe,(0,g.jsx)(n(964447).vE,{origin:ee??void 0}),G&&(0,g.jsx)(n(859428).A,{placement:n(962730).W.Bottom,renderTooltip:()=>se,render:e=>(0,g.jsx)(n(296798).A,{href:J,ignoreLocalHoverState:!0,hovered:!1,children:(0,g.jsx)(n(285790).A,{ariaLabel:se,...e,icon:()=>(0,n(657222).w)(N.link),style:{marginLeft:4},onClick:()=>{J&&n(755636).f({url:J,environment:k})}})})}),Q&&!k.device.isMobile&&(0,g.jsx)(n(346436).A,{store:Q,canEdit:$,buttonStyle:{fontWeight:"normal",margin:0}})]}),(0,g.jsx)("div",{style:{marginLeft:4},children:(0,g.jsx)(p,{store:t,collectionContextStore:h})})]})}));function p(e){const{store:t,collectionContextStore:i}=e,o=(0,r().K8)((()=>t.isCollectionView()),[t]),s=(0,r().K8)((()=>t.getCollectionViewSourceCollectionStore()),[t]);return o&&i&&s?(0,g.jsx)(n(948049).A,{collectionStore:s,collectionContextStore:i}):null}},603616:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(296540),o=()=>n(56366),s=()=>n(700500),r=()=>n(614505),l=()=>n(780054),a=()=>n(186445),d=n(474848);const c=i.memo((function(e){let{store:t,isEditable:c,hasCover:g,isInSidePeek:u,openMenuOnMount:p,openMenuOnMountCallback:S,isInPageLayoutModuleEditor:f,isInlinePostTitle:x}=e;const m=(0,n(484714).v3)(),h=(0,n(959013).tz)(),v=(0,n(401497).DP)(),y=(0,o().K8)((()=>t.hasIcon()),[t]),b=(0,o().K8)((()=>t.isPersonProfile()),[t]),C=(0,o().K8)((()=>b?t.getPersonProfileUserStore():void 0),[b,t]),j=(0,o().K8)((()=>{if(y)return t.getIcon()}),[y,t]),w=(0,o().K8)((()=>t.getIconStore()),[t]),M=(0,o().K8)((()=>t.getType()),[t]),I=(0,o().K8)((()=>{if(t.isCollectionView()){const e=t.getCollectionViewSourceCollectionStore();return!!e&&e.isSyncedCollection()}return t.isType(s().xd.externalObjectInstancePage)}),[t]),K=(0,o().K8)((()=>t.isType(s().xd.form)),[t]),E=(0,o().K8)((()=>t.isCollectionView()),[t])||u,A=x,k=(0,o().K8)((()=>t.isEmptyPage()),[t]),T=(0,o().K8)((()=>n(77246).Uv.getMode(t)),[t]),_=(0,i.useCallback)((async e=>{const i=t.getIconStore();if(i){const t=(0,n(522419).pc)({source:e,secureFileConfigRootpath:l().A.secureFileConfig.rootPath,secureFileConfigHostname:l().A.secureFileConfig.hostname}),o=t?t.link:e,{serverCommitResult:s}=n(317909).createAndCommit({userAction:"PageIcon.handleChange",environment:m,canUndo:!0,perform:e=>{n(246826).KY({store:i,value:o,transaction:e})}});await s}}),[m,t]),P={position:"relative",zIndex:1,marginLeft:3,marginBottom:m.device.isMobile?8:0,marginTop:4,pointerEvents:"auto"};let B,R,D;if(A?P.marginRight=4:E?P.marginRight=6:P.marginTop=g&&!f?-80:m.device.isMobile||f?0:(0,a().Ws)(m)-(K?32:0),B=A?{marginTop:4,marginRight:2}:E?{marginTop:4,marginRight:8}:{marginTop:g&&!f?-42:m.device.isMobile||f?0:(0,a().Ws)(m)-(K?32:0)},R=A?26:E?36:I?74:140,b&&(P.borderRadius="50%",P.background=v.contentBackground,P.overflow="hidden",P.width=R),D=A?26:E?36:78,!y)return b?(0,d.jsx)("div",{style:P,children:(0,d.jsx)(n(453697).A,{userStore:C,size:R})}):null;if(c&&"suggest"!==T){const e=null==w?void 0:w.table;return(0,d.jsx)(r().A,{disabled:!1,bucket:"secure",icon:j,store:t,isEmptyPage:k,onChange:_,size:R,emojiSize:D,style:P,emojiStyle:B,largeIcon:!0,openMenuOnMount:p,openMenuOnMountCallback:S,iconLoggingData:{recordTable:e,source:"page_header",block_type:M,collection_id:"collection"===e?null==w?void 0:w.id:void 0},label:h.formatMessage({id:"layout.pageIcon.label",defaultMessage:"Change page icon"}),testId:"pageIcon"})}return(0,d.jsx)(r().A,{disabled:!0,icon:j,isEmptyPage:k,size:R,emojiSize:D,style:P,emojiStyle:B,largeIcon:!0,label:h.formatMessage({id:"layout.pageIcon.disabledLabel",defaultMessage:"Page icon"}),testId:"pageIcon"})}))},774524:(e,t,n)=>{n.d(t,{A:()=>c});n(296540);var i=()=>n(662303),o=()=>n(484714),s=()=>n(56366),r=()=>n(401497),l=()=>n(284371),a=()=>n(478726),d=n(474848);function c(e){const{store:t,context:n,onFocus:c,onBlur:g,children:u}=e,p=(0,o().v3)(),S=(0,s().K8)((()=>t.hasIcon()),[t]),f=(0,s().K8)((()=>t.hasCover()),[t]),x=(0,s().K8)((()=>t.isCollectionView()),[t]),m=(0,s().K8)((()=>(0,a().$n)(p)),[p]),h=(0,s().K8)((()=>(0,a().mb)(t)),[t]),v=(0,r().IS)((e=>{const{device:t}=p,{isMobile:o}=t,s=(0,a().XD)(n,p);let r,d,c;return o?f?(c="block",r=s,d=4):(c="flex",r=s,d=m):x||h?(c="flex",f?(r=16,d=4):(r=4,d=4)):(c="flex",S?(r=8,d=4):f?(r=16,d=4):(r=s,d=m)),{container:{display:c,justifyContent:"flex-start",flexWrap:"wrap",paddingTop:r,paddingBottom:d,marginLeft:-1,color:e.lightTextColor,fontFamily:l().vc(i().locale).sans,pointerEvents:"auto"}}}),[n,p,f,S,x,h,m]);return(0,d.jsx)("div",{onFocus:c,onBlur:g,style:v.container,className:"notion-page-controls",children:u})}},948049:(e,t,n)=>{n.d(t,{A:()=>b});n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(401497),r=()=>n(651124),l=()=>n(796073),a=()=>n(693954),d=()=>n(959013),c=()=>n(100622),g=()=>n(686526),u=()=>n(664133),p=()=>n(989423),S=()=>n(493208),f=()=>n(504836),x=()=>n(252833),m=()=>n(907514),h=()=>n(666803),v=()=>n(296798),y=n(474848);const b=function(e){let{collectionStore:t,collectionContextStore:n}=e;return(0,o().K8)((()=>t.isSyncedCollection()),[t])?(0,y.jsx)(M,{collectionStore:t,collectionContextStore:n}):null};function C(e){return{color:e.mediumTextColor,fontSize:14,lineHeight:1.2}}function j(e){let{collectionStore:t,collectionContextStore:n}=e;const r=(0,s().DP)(),u=(0,i().v3)(),p=(0,o().K8)((()=>t.getFormatStore().getKeyStore("sync_state").getKeyStore("syncing").getValue()),[t]),S=(0,o().K8)((()=>t.getFormatStore().getKeyStore("sync_state").getKeyStore("last_synced_at").getValue()),[t]),f=(0,o().K8)((()=>null==n?void 0:n.numberChildrenUnfurledStore.state),[n]),x=(0,o().K8)((()=>null==n?void 0:n.numberChildrenReceivedStore.state),[n]),h=f&&x&&f/x<1&&!u.device.isMobile,b=p&&u.device.isMobile;let j;return S&&(j=(0,y.jsx)(d().sA,{defaultMessage:"Synced {lastSyncedAt}",id:"synced.lastSyncedAt.label",values:{lastSyncedAt:(0,m().nl)(S,{useLowercase:!0})}})),"row_limit_exceeded"===p?(0,y.jsx)(v().A,{style:{display:"inline-flex",...C(r)},onClick:()=>function(e){e&&(g().Ow({collectionContextStore:e,collectionSettingsStore:e.settingsStore}),g().a2({collectionSettingsStore:e.settingsStore,item:{type:"source"}}))}(n),children:(0,y.jsxs)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...C(r)},children:[(0,a().Q)({fill:(0,c().k5)("orange",r).fill,marginLeft:4,marginRight:4,width:12,alignSelf:"center"}),(0,y.jsx)(d().sA,{defaultMessage:"Partial Sync",id:"synced.partial_sync.label"})]})}):h||b?(0,y.jsxs)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...C(r)},children:[(0,y.jsx)(d().sA,{defaultMessage:"Syncing",id:"synced.syncing.label"}),(0,l().$)({marginLeft:4,marginRight:4,width:12,alignSelf:"center"},"sync-spinner")]}):(0,y.jsx)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...C(r)},children:j})}function w(){const e=(0,i().v3)(),t=(0,s().IS)((e=>({span:{color:e.mediumTextColor},linkBox:{fontSize:"14px",lineHeight:1.2,color:e.blueColor,marginLeft:"5px",marginRight:"5px"}})),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{style:t.span,children:"â€¢"}),(0,y.jsx)(v().A,{inline:!0,onClick:async()=>{await u().jh({environment:e,from:"collection_header"});const t=h().Ay.createNewFlowId();(0,p().u4)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"database_sync",flowId:t}}})},style:t.linkBox,hoveredStyle:{background:"none",textDecoration:"underline"},children:(0,y.jsx)(d().sA,{defaultMessage:"Improve your Jira sync",id:"synced.improve_jira_sync.label"})})]})}function M(e){let{collectionStore:t,collectionContextStore:n}=e;const i=(0,s().DP)(),l=(0,o().K8)((()=>t.getFormatStore().getKeyStore("original_url").getValue()),[t]),a=(0,o().K8)((()=>t.getSpaceId()),[t]),d=(0,o().K8)((()=>Boolean(t.getFormatStore().getKeyStore("sync_state").getValue())),[t]),c=(0,o().K8)((()=>l&&(0,S().e)(l,a)),[a,l]),g=(0,o().K8)((()=>(0,x().fH)(l,a)),[a,l]),u=(0,o().K8)((()=>{if(!(0,f().pB)())return!1;const e=t.getFormat().uri;return!!e&&(t.getFormat().external_collection_type!==r().uO.Jira&&(0,x().Ip)(e))}),[t]);return(0,y.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[c&&(0,y.jsx)(v().A,{href:c,style:{display:"inline-flex"},hoveredStyle:{background:"none",textDecoration:"underline"},innerStyle:{flexShrink:1,width:"none",padding:"2px 0px",marginRight:5,borderRadius:4,display:"flex",alignItems:"center",alignSelf:"center",...C(i)},external:!0,children:g}),d?(0,y.jsx)("span",{style:{color:i.mediumTextColor},children:"â€¢"}):null,d?(0,y.jsx)(j,{collectionStore:t,collectionContextStore:n}):null,u&&(0,y.jsx)(w,{})]})}}}]);