"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25700,46204],{73223:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>c,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>d,tutorialGoToPrevStep:()=>l});var i=()=>n(541235),o=()=>n(317909),r=()=>n(755199),a=()=>n(739135),s=()=>n(351360);function d(e,t){var n;const{currentUserSettingsStore:i}=s().default.state;if(!i)return;const o=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;v({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...o,[t]:(0,a().i9)(i,t)}}})},userId:i.id})}function l(e,t){var n;const{currentUserSettingsStore:i}=s().default.state;if(!i)return;const o=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;v({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{r().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...o,[t]:(0,a().KD)(i,t)}}})},userId:i.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=s().default.state;if(!o)return;const a=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;v({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{r().mJ({userSettingsStore:o,transaction:e,data:{tutorials:{...a,[t]:i().YD}}})},userId:o.id})}function u(e){const{currentUserSettingsStore:t}=s().default.state;t&&v({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{r().mJ({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var o;const{currentUserSettingsStore:d}=s().default.state;if(!d||(0,a().x$)(d,t))return;const l=(0,a().gt)(d,t);i().c$[t].steps.findIndex((e=>e.id===l))>=i().c$[t].steps.findIndex((e=>e.id===n))||r().mJ({userSettingsStore:d,transaction:e,data:{tutorials:{...null===(o=d.getSettings())||void 0===o?void 0:o.tutorials,[t]:n}}})}function m(e,t,n){if((0,a().ll)(n))return;const i=(0,a().tb)(t,n);i&&p(e,t,i)}function v(e){return o().createAndCommit({...e,canUndo:!1})}},300451:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().default{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const o=new i},435212:(e,t,n)=>{n.d(t,{Kz:()=>r,Sc:()=>a,as:()=>o});var i=()=>n(989423);function o(e,t){(0,i().u4)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function r(e,t){(0,i().u4)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function a(e){(0,i().u4)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},525700:(e,t,n)=>{n.d(t,{Bp:()=>E,DD:()=>O,E9:()=>G,H6:()=>T,HE:()=>B,HY:()=>P,JI:()=>R,Nf:()=>q,P8:()=>V,V_:()=>$,XL:()=>W,Xz:()=>j,aD:()=>x,aN:()=>z,d7:()=>Q,d8:()=>k,j4:()=>F,n0:()=>J,pu:()=>H,uH:()=>C,uY:()=>Y,wl:()=>N,yF:()=>M,zV:()=>D});n(16280),n(944114),n(898992),n(354520),n(581454),n(296540);var i=()=>n(68263),o=()=>n(161479),r=()=>n(101628),a=()=>n(245241),s=()=>n(959013),d=()=>n(496603),l=()=>n(498212),c=()=>n(449506),u=()=>n(246826),p=()=>n(755636),m=()=>n(436572),v=()=>n(317909),g=()=>n(780054),f=()=>n(594794),S=()=>n(976721),h=()=>n(562800),I=()=>n(40226),b=()=>n(380682),A=()=>n(300451),U=()=>n(676870),_=()=>n(435212),y=n(474848);function k(e){const{environment:t,store:n,type:i,header:a,domainId:s}=e,d=n.getSiteStore();if(d)return d.id;let l=s;var c;l||(l=null===(c=h().Nq(n.getSpaceStore()))||void 0===c?void 0:c.id);const p=(0,f().JH)({environment:t,table:r().Eu,spaceId:(0,o().e)(n.getSpaceId())});v().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const o=u().vt({environment:t,table:p.table,args:{id:p.id,type:i,spaceId:p.spaceId,blockId:n.id,domainId:l,currentUserId:t.currentUser.id,header:a??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return u().zv({store:n.getFormatStore(),data:{site_id:o.id},transaction:e}),o.id}})}function w(e){const{environment:t,siteRootBlockStore:n,domainId:i}=e;let o=n.getSiteStore();if(o||(k({environment:t,type:"site",store:n,domainId:i}),o=n.getSiteStore()),o)return o}function D(e){const{environment:t,domainId:n,resetWatermark:i}=e,o=w(e);o&&o.isDefined()&&(v().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{o.getDomainId()!==n&&v().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),v().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(i){const n=o.getHeader();v().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),m().D6({label:(0,y.jsx)(s().sA,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function T(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:i}=e,r=w(e);if(!r)return;"form"!==r.getType()&&v().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{r&&r.isDefined()&&i!==r.isSearchEngineIndexingEnabled()&&(v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:i,currentUserId:t.currentUser.id})}),i&&e.postSubmitCallbacks.push((async e=>{e||await c().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,o().e)(n.pointer.spaceId)}}})})))}})}function B(e){const{environment:t,store:n,seoTitle:i,seoDescription:o}=e;v().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const r=n.getFormat().seo_title,a=n.getFormat().seo_description;r===i&&a===o||(u().zv({store:n.getFormatStore(),data:{seo_title:i,seo_description:o},transaction:e}),(0,U().NZ)(t,{target_block_id:n.id,new_title:i??null,new_description:o??null}),m().D6({label:(0,y.jsx)(s().sA,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function x(e){A().A.setState({...A().A.state,settingOpen:e})}function N(){A().A.setState({...A().A.state,settingOpen:"initial"})}function E(e){b().A.setState({...b().A.state,siteSettingContentType:e})}function P(e){var t,n,i;const{siteRootBlockStore:o,permissionItem:r,from:a,sudoModeStore:s}=e,d=o.getSiteStore(),l=null==d?void 0:d.getHeader(),c=(null==l||null===(t=l.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];A().A.setState({settingOpen:"initial",permissionItem:r,from:a,sudoModeStore:s,faviconUrl:(null==d?void 0:d.getFaviconUrl())||null,previewImageUrl:(null==d?void 0:d.getPreviewImageUrl())||null,hideBreadcrumbs:null==l?void 0:l.hideBreadcrumbs,hideSearch:null==l?void 0:l.hideSearch,hideWatermark:null==l?void 0:l.hideWatermark,enableDuplicateAsTemplate:r.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==d?void 0:d.getGoogleAnalyticsId(),theme:null==d||null===(n=d.getSettings())||void 0===n?void 0:n.theme,enableQna:null==d||null===(i=d.getSettings())||void 0===i?void 0:i.enableQna})}async function C(e){var t;const{environment:n,store:o,siteRootBlockStore:r}=e,a=w({environment:n,siteRootBlockStore:r}),u=null==a?void 0:a.getType();if(!a||"form"===u)return;const p=A().A.getState();let g=!1;const f={};let I;p.enableQna&&(I=await async function(e){var t,n,i,o;const{environment:r,siteStore:a}=e,s=null===(t=a.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=a.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(i=h().Nq(a.getSpaceStore()))||void 0===i?void 0:i.domain_name)))throw new Error("no domain on site");const d=h().Ix({spaceStore:a.getSpaceStore(),domainId:null===(o=a.getDomainStore())||void 0===o?void 0:o.id}).split(":")[0],u=`${(0,l().S2)(a.id)}@${d}`,p=await c().callApi({eventName:"createEmailUser",environment:r,data:{email:u}});if("failed"===p.type)throw new Error("failed to create qna user");return p.data.userId}({environment:n,siteStore:a})),v().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(a&&a.isDefined()){var t,i;(a.getFaviconUrl()||null)!==p.faviconUrl&&(v().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateFaviconUrl({faviconUrl:p.faviconUrl,currentUserId:n.currentUser.id})}),g=!0,f.favicon=p.faviconUrl);(a.getPreviewImageUrl()||null)!==p.previewImageUrl&&(v().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updatePreviewImageUrl({previewImageUrl:p.previewImageUrl,currentUserId:n.currentUser.id})}),g=!0,f.preview_image=p.previewImageUrl);const o=a.getHeader();let r=o;const s=function(e,t){const n=e.map((e=>({type:"block",blockId:e})));if(!t&&0===n.length)return;if(t&&(0,d().n4)(n,t))return;return n}(p.customHeaderBlockIds,null==o?void 0:o.customItems);s&&(r={...r,customItems:s},f.custom_headers=s.map((e=>e.blockId))),(null==o?void 0:o.hideBreadcrumbs)!==p.hideBreadcrumbs&&(r={...r,hideBreadcrumbs:p.hideBreadcrumbs},f.hide_breadcrumbs=p.hideBreadcrumbs),(null==o?void 0:o.hideSearch)!==p.hideSearch&&(r={...r,hideSearch:p.hideSearch},f.hide_search=p.hideSearch),(null==o?void 0:o.hideWatermark)!==p.hideWatermark&&(r={...r,hideWatermark:p.hideWatermark},f.hide_watermark=p.hideWatermark),r&&o!==r&&(v().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateHeader({header:r,currentUserId:n.currentUser.id})}),g=!0);a.getGoogleAnalyticsId()!==p.googleAnalyticsId&&(v().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:p.googleAnalyticsId,currentUserId:n.currentUser.id})}),g=!0,f.google_analytics_id=p.googleAnalyticsId);(null===(t=a.getSettings())||void 0===t?void 0:t.theme)!==p.theme&&(v().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateTheme({theme:p.theme,currentUserId:n.currentUser.id})}),g=!0,f.theme=p.theme);(null===(i=a.getSettings())||void 0===i?void 0:i.enableQna)!==p.enableQna&&(p.enableQna?I&&v().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:p.enableQna,siteUserId:I}}}):v().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:p.enableQna}}}),g=!0)}}});if((null===(t=p.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==p.enableDuplicateAsTemplate&&p.permissionItem&&p.from){const e=(0,i().Yi)(p.from);(0,S().Hc)({oldPermissionItem:p.permissionItem,newPermissionItem:{...p.permissionItem,allow_duplicate:p.enableDuplicateAsTemplate},wasInherited:e!==o.id,environment:n,store:o,sudoModeStore:p.sudoModeStore,location:"published_site_settings"}),g=!0,f.enable_duplicate_as_template=p.enableDuplicateAsTemplate}g&&((0,_().Kz)(n,{settings_changed:f}),m().D6({label:(0,y.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})}))}function H(e){A().A.setState({...A().A.state,faviconUrl:e})}function M(e){A().A.setState({...A().A.state,previewImageUrl:e})}function O(e){A().A.setState({...A().A.state,hideBreadcrumbs:e})}function W(e){A().A.setState({...A().A.state,hideSearch:e})}function j(e){A().A.setState({...A().A.state,hideWatermark:e})}function Q(e){A().A.setState({...A().A.state,enableDuplicateAsTemplate:e})}function z(e){const t=A().A.state.customHeaderBlockIds.concat([e]);A().A.setState({...A().A.state,customHeaderBlockIds:t})}function R(e){const t=A().A.state.customHeaderBlockIds.filter((t=>t!==e));A().A.setState({...A().A.state,customHeaderBlockIds:t})}function q(e){A().A.setState({...A().A.state,googleAnalyticsId:e})}function $(e){A().A.setState({...A().A.state,theme:e})}async function F(e){const{environment:t,spaceStore:n,query:i,siteRootBlockId:o}=e;if(!n)return;const r=await c().callApi({eventName:"searchPagesInSite",environment:t,data:{query:i,spaceId:n.id,filters:a().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[o],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==r.type?r.data:void 0}async function J(e){const{environment:t,blockStore:n,slug:i}=e,o=await c().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:i,clientVersion:g().A.version}});if("success"!==o.type)return{error:o};m().D6({label:(0,y.jsx)(s().sA,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function V(e){A().A.setState({...A().A.state,enableQna:e})}function Y(e){const{environment:t,store:n,pageVisitSource:i}=e,o=I().R({store:n,pageVisitSource:i});p().f({environment:t,url:o})}function G(e){const{environment:t,siteStore:n,embedSettings:i}=e;v().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{u().zv({store:n.getSettingsStore(),data:{embedSettings:i},transaction:e})}})}},541235:(e,t,n)=>{n.d(t,{YD:()=>r,c$:()=>i,q_:()=>o});const i={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]}},o="completed",r="dismissed"},676870:(e,t,n)=>{n.d(t,{EN:()=>o,Ex:()=>r,NZ:()=>a,T6:()=>d,i_:()=>s,kW:()=>l});var i=()=>n(989423);function o(e,t){(0,i().u4)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function r(e,t){(0,i().u4)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function a(e,t){(0,i().u4)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,i().u4)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function d(e,t){(0,i().u4)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function l(e,t){(0,i().u4)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},739135:(e,t,n)=>{n.d(t,{KD:()=>l,gt:()=>c,i9:()=>d,ll:()=>a,tb:()=>s,x$:()=>r});var i=()=>n(541235),o=()=>n(496603);function r(e,t){return a(c(e,t))}function a(e){return void 0!==e&&(e===i().q_||e===i().YD)}function s(e,t){if(a(t))return;const n=i().c$[e],o=n.steps.findIndex((e=>e.id===t));return-1===o?n.steps[0].id:o===n.steps.length-1?i().q_:n.steps[o+1].id}function d(e,t){const n=c(e,t);if(n&&!a(n))return s(t,n)}function l(e,t){const n=c(e,t);if(n)return function(e,t){const n=i().c$[e];var r;if(a(t))return null===(r=(0,o().HV)(n.steps))||void 0===r?void 0:r.id;const s=n.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?n.steps[s-1].id:void 0}(t,n)}function c(e,t){var n;if(!e)return;const o=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===o?i().c$[t].steps[0].id:o}}}]);