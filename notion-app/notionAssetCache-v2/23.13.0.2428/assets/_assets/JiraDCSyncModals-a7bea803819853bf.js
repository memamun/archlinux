"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28763],{442277:(e,t,n)=>{n.d(t,{B:()=>a});n(296540);var i=n(474848);const a=(0,n(340498).wt)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})})},691298:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(296540),a=()=>n(502438),s=()=>n(24157);const o=function(e){let{shouldPreserveTextSelection:t,shouldPreserveBlockSelection:o,shouldRestoreSelection:r,onClearSelection:l}=e;const d=(0,n(484714).v3)(),c=(0,i.useRef)(t),u=(0,i.useRef)(""),h=(0,i.useRef)({selectionState:null,textSelectionState:null}),p=(0,i.useCallback)((()=>h.current),[]),g=(0,i.useCallback)((()=>{u.current=window.location.href,s().default.hasSelection()&&(h.current.textSelectionState=s().default.cloneState()),n(725614).clear({preventDismissMobileKeyboard:!0,environment:d}),o&&(a().default.isSelected()&&(h.current.selectionState=a().default.cloneState()),n(778417).IU({preventDismissMobileKeyboard:!0,environment:d}))}),[d,o]),m=(0,i.useCallback)((()=>{h.current={selectionState:null,textSelectionState:null},u.current="",null==l||l()}),[l]),A=(0,i.useCallback)((()=>{const{selectionState:e,textSelectionState:t}=h.current;window.location.href===u.current&&(t&&"mode"in t&&"editing"===t.mode&&s().default.setState({...s().default.state,...t}),o&&e&&a().default.setState({...a().default.state,...e})),m()}),[m,o]);return(0,n(852507).l)((()=>{c.current=t,t&&g()})),(0,i.useEffect)((()=>(c.current&&!t?r?A():m():!c.current&&t&&g(),c.current=t,()=>{r?A():m()})),[t,m,A,g,r]),{clearSavedSelection:m,restoreSavedSelection:A,getSavedSelection:p}}},992567:(e,t,n)=>{n.r(t),n.d(t,{default:()=>se});n(898992),n(354520);var i=n(296540),a=()=>n(484714),s=()=>n(56366),o=()=>n(401497),r=()=>n(148307),l=()=>n(442277),d=()=>n(66913),c=()=>n(426388),u=()=>n(206267),h=()=>n(959013),p=()=>n(284371),g=()=>n(504836),m=()=>n(691298),A=()=>n(351360),x=()=>n(666803),f=()=>n(40851),y=(n(672577),n(581454),()=>n(831310)),v=()=>n(668725),j=()=>n(738418),w=()=>n(617871),S=()=>n(857639),C=()=>n(388693),I=()=>n(496603),k=()=>n(901389),b=()=>n(780054),T=()=>n(989423),M=()=>n(974233),D=()=>n(972435),B=()=>n(53137),z=()=>n(449506),P=()=>n(633457);const J=(0,h().YK)({dismissButtonLabel:{defaultMessage:"OK",id:"dialog.dismissButton.label"},pleaseTryAgainMsg:{defaultMessage:"Please try again",id:"dialog.pleaseTryAgainMsg"},AuthenticationFailedMsg:{defaultMessage:"Authentication failed. Please try again.",id:"jiraDCAuthActions.authenticationFailedMsg"}});var U=()=>n(722872),H=()=>n(962730),V=()=>n(493823),W=()=>n(760217),L=()=>n(406699),F=()=>n(802790),_=()=>n(285790),R=()=>n(805751),O=()=>n(623580),E=()=>n(928600),K=()=>n(939740),N=()=>n(864943),G=()=>n(204063),Y=()=>n(89924),q=()=>n(859428),$=()=>n(21140),X=n(474848);function Q(e){const{site:t,APIToken:n,username:i,password:a,jiraDataCenterBasicAuthEnabled:r,jiraDCVersion:l,formValues:{site:d,token:c,username:u,password:g},onChange:m,invalidFields:A,hidePopup:f,environment:y}=e,v=(0,s().O$)(x().Ay),j=(0,o().IS)((e=>({title:{fontWeight:p().Wy.semibold},inputLabels:{fontSize:p().J.UISmall.desktop,fontWeight:p().Wy.semibold,font:"SF Pro",lineHeight:p().K_.UISmall.desktop,color:e.lightTextColor},placeHolder:{font:"SF Pro",fontWeight:p().Wy.regular,fontSize:p().J.UIRegular.desktop,lineHeight:p().K_.UISmall.desktop},captionText:{font:"SF Pro",fontWeight:p().Wy.regular,lineHeight:p().K_.UISmall.desktop,fontSize:p().J.UISmall.desktop,color:e.lightTextColor},inputBox:{width:"100%",height:28,padding:4,gap:4,radius:"default"},invalidInput:{boxShadow:e.outlineRedInputBoxShadow}})),[]);return(0,X.jsx)(R().A,{debugName:"AtlassianAPIAuthContentPopup",capture:!0,children:(0,X.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"},children:[(0,X.jsx)("div",{style:{overflowY:"scroll"},children:(0,X.jsxs)("div",{style:{padding:2},children:[(0,X.jsx)("div",{children:r&&(0,X.jsx)("div",{children:(0,X.jsxs)("div",{children:[(0,X.jsx)("label",{htmlFor:"jiraDCVersion",style:{...j.inputLabels},children:l}),(0,X.jsx)(Z,{onSelectOption:e=>{x().Ay.setState({...x().Ay.state,authenticationType:e})},options:[{key:x().XT.Bearer,label:(0,X.jsx)(h().sA,{id:"jiraAuthentication.jiraDCNewerVersionOption.label",defaultMessage:"8.14 or later"})},{key:x().XT.Basic,label:(0,X.jsx)(h().sA,{id:"jiraAuthentication.jiraDCOlderVersionOption.label",defaultMessage:"Prior to 8.14"})}],currentOption:v.authenticationType??x().XT.Bearer})]})})}),(0,X.jsx)(F().A,{size:14,isHidden:!0}),(0,X.jsxs)("div",{children:[(0,X.jsx)("label",{htmlFor:"site",style:j.inputLabels,children:t}),(0,X.jsx)(F().A,{size:8,isHidden:!0}),(0,X.jsx)(O().A,{id:"site",value:d,onChange:e=>m("site",e.target.value),showClearButton:!0,placeholder:"https://domain.com",inputElementAttributes:{minLength:4},style:{...j.inputBox,...A.includes("site")&&j.invalidInput}})]}),(0,X.jsx)(F().A,{size:14,isHidden:!0}),(0,X.jsx)("div",{children:r&&v.authenticationType===x().XT.Basic?(0,X.jsxs)("div",{children:[(0,X.jsxs)("div",{children:[(0,X.jsx)("label",{htmlFor:"username",style:j.inputLabels,children:i}),(0,X.jsx)(F().A,{size:8,isHidden:!0}),(0,X.jsx)(O().A,{id:"username",type:"username",value:u,onChange:e=>{m("username",e.target.value)},showClearButton:!0,placeholder:"Enter your username",inputElementAttributes:{minLength:4},style:{...j.inputBox,...A.includes("username")&&j.invalidInput}}),(0,X.jsx)(F().A,{size:8,isHidden:!0})]}),(0,X.jsx)(F().A,{size:14,isHidden:!0}),(0,X.jsxs)("div",{children:[(0,X.jsx)("label",{htmlFor:"password",style:j.inputLabels,children:a}),(0,X.jsx)(F().A,{size:8,isHidden:!0}),(0,X.jsx)(O().A,{id:"password",type:"password",value:g,onChange:e=>{m("password",e.target.value)},showClearButton:!0,placeholder:"Enter your password",inputElementAttributes:{minLength:4},style:{...j.inputBox,...A.includes("password")&&j.invalidInput}}),(0,X.jsx)(F().A,{size:8,isHidden:!0})]}),(0,X.jsx)(F().A,{size:14,isHidden:!0})]}):(0,X.jsxs)("div",{children:[(0,X.jsxs)("div",{children:[(0,X.jsx)("label",{htmlFor:"APIToken",style:j.inputLabels,children:n}),(0,X.jsx)(F().A,{size:8,isHidden:!0}),(0,X.jsx)(O().A,{id:"AccessToken",type:"password",value:c,onChange:e=>{m("token",e.target.value)},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4},style:{...j.inputBox,...(v.adminTokenError||A.includes("token"))&&j.invalidInput}}),(0,X.jsx)(F().A,{size:8,isHidden:!0})]}),(0,X.jsx)(F().A,{size:14,isHidden:!0})]})})]})}),(0,X.jsxs)("div",{style:{display:"flex",justifyContent:"normal"},children:[(0,X.jsx)(G().A,{size:"lg",disabled:"Basic"===v.authenticationType&&r?!d||!u||!g:!d||!c,onClick:async()=>{await async function(e){const{environment:t,siteValue:n,tokenValue:i,usernameValue:a,passwordValue:s}=e,o=x().Ay.getFlowId(),r=x().Ay.state;(0,T().u4)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_initiated",flowId:o}}});const l=B().A.integrations.state.find((e=>e.id===w().Fv));if(!l||!r.spaceId||!t.currentUser.id)return k().ui({message:D().A.formatMessage(J.pleaseTryAgainMsg),showCancel:!1,keepFocus:!1,items:[{label:D().A.formatMessage(J.pleaseTryAgainMsg),onAccept:I().D_}]}),void S().log({level:"info",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Missing required data to authenticate with Jira DC",miscDataToConvertToString:{siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}});const d=l.id,c=(0,C().UI)(b().A.domainBaseUrl),u=l.redirect_uris.includes(c)?c:l.redirect_uris[0],h=await z().callApi({eventName:"createOauthAuthorizationCode",environment:t,data:{integrationId:d,spaceId:r.spaceId,redirectUri:u}});if("failed"===h.type)return k().Qg(h),S().log({level:"error",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Unexpected error creating authorization code",miscDataToConvertToString:{response:h,siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}}),(0,T().u4)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_status",flowId:o,status:"failed"}}}),{error:`Unexpected error creating authorization code: ${(0,M().V)(h)}`};const p=h.data.code;let g;if(g="Basic"===r.authenticationType?await z().callApi({eventName:"authenticateJiraDCUser",environment:t,data:{domain:n,userId:t.currentUser.id,spaceId:r.spaceId,notionAuthorizationCode:p,username:a,password:s,authType:"Basic"}}):await z().callApi({eventName:"authenticateJiraDCUser",environment:t,data:{domain:n,userId:t.currentUser.id,spaceId:r.spaceId,personalAccessToken:i,notionAuthorizationCode:p}}),(0,T().u4)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_status",flowId:o,status:"success"===g.type?"success":"failed"}}}),"failed"===g.type||"AUTHENTICATION_FAILED"===g.data.code){const e="failed"===g.type?(0,M().V)(g):J.AuthenticationFailedMsg.defaultMessage;k().ui({message:e,showCancel:!1,keepFocus:!1,items:[{label:D().A.formatMessage(J.dismissButtonLabel),onAccept:I().D_}]}),S().log({level:"error",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Failed to authenticate with Jira DC",miscDataToConvertToString:{errorStatus:g.status,siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}})}else{S().log({level:"info",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Authentication with Jira DC is successful",miscDataToConvertToString:{siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}}),await P().oX({environment:t});const e=r.notionState;x().Ay.setState({...x().Ay.state,open:!1,isMemberAuthSuccessForDataCenter:!0,notionState:void 0}),e&&await P().A1({environment:t,notionState:e})}}({environment:y,siteValue:d,tokenValue:c,usernameValue:u,passwordValue:g})},children:(0,X.jsx)(h().sA,{id:"JiraDCAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,X.jsx)(N().A,{size:"lg",style:{marginLeft:12},onClick:()=>{f()},children:(0,X.jsx)(h().sA,{id:"JiraDCAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}function Z(e){var t;const{onSelectOption:n,options:i,currentOption:a}=e,s=null===(t=i.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,r=(0,o().IS)((e=>({icon:{marginLeft:4,fill:e.lightIconColor,width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:10,fontSize:p().J.UISmall.desktop},dropdownLabel:{font:"SF Pro",fontSize:p().J.UIRegular.desktop,fontWeight:p().Wy.regular,lineHeight:p().K_.UISmall.desktop}})),[]);return(0,X.jsx)(L().Ay,{popupType:L().z7.Popup,placementToOrigin:L().sx.Left,renderOrigin:e=>(0,X.jsxs)(V().p,{...e,size:"lg",style:r.dropdownLabel,disabled:!1,hoveredStyle:{background:"rgba(0, 0, 0, 0)"},children:[s,(0,v().b)(r.icon)]}),render:e=>{const t={menuType:U().gu.Popup,width:250,left:50},a=[{key:"settings-item-section",render:e=>(0,X.jsx)(Y().A,{...e}),items:i.map((t=>{let{key:i,label:a}=t;return{key:i,action:()=>{n(i),e.close()},render:e=>(0,X.jsx)(W().A,{...e,title:a,shouldWrapCaption:!0,right:s===a?(0,X.jsx)("div",{style:{width:14},children:(0,y().o)()}):void 0})}}))}];return(0,X.jsx)(E().A,{...t,children:(0,X.jsx)(K().Ay,{type:K().Oh.Vertical,sections:a,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}const ee=function(e){const t=(0,h().tz)(),n=t.formatMessage({id:"jiraDataCenterAuth.siteHelperText",defaultMessage:"The base URL that is used to access Jira. If you are running on a non-standard port, please provide the input in host:port format"}),i=t.formatMessage({id:"jiraDataCenterAuth.stepsToGetPAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Jira server"}),a=t.formatMessage({id:"AtlassianApiTokenAuthentication.stepsToGetDCVersion.captions",defaultMessage:"Click to learn how to know the version of DC Server you are running"});return(0,X.jsx)(Q,{hidePopup:()=>{!function(e){const{key:t,value:n}=e;x().Ay.setState({...x().Ay.state,[t]:n})}({key:"open",value:!1})},site:(0,X.jsxs)($().Ye,{style:{alignItems:"center",gap:2},children:[(0,X.jsx)(h().sA,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Jira site url"}),(0,X.jsx)(q().A,{style:{width:300,whiteSpace:"normal"},placement:H().W.Right,renderTooltip:()=>n,render:e=>(0,X.jsx)(_().A,{ariaLabel:n,disableBackground:!0,icon:j().G,...e})})]}),APIToken:(0,X.jsxs)($().Ye,{style:{alignItems:"center",gap:2},children:[(0,X.jsx)(h().sA,{id:"AtlassianDCApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,X.jsx)(q().A,{placement:H().W.Right,renderTooltip:()=>i,render:e=>(0,X.jsx)(_().A,{ariaLabel:i,onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:j().G,...e})})]}),username:(0,X.jsx)($().Ye,{style:{alignItems:"center",gap:2},children:(0,X.jsx)(h().sA,{id:"AtlassianDCApiTokenAuthentication.usernameMessage",defaultMessage:"Jira username"})}),password:(0,X.jsx)($().Ye,{style:{alignItems:"center",gap:2},children:(0,X.jsx)(h().sA,{id:"AtlassianDCApiTokenAuthentication.passwordMessage",defaultMessage:"Jira password"})}),jiraDCVersion:(0,X.jsxs)($().Ye,{style:{alignItems:"center",gap:2},children:[(0,X.jsx)(h().sA,{id:"AtlassianApiTokenAuthentication.DCVersion",defaultMessage:"Jira version"}),(0,X.jsx)(q().A,{style:{width:300,whiteSpace:"normal"},placement:H().W.Right,renderTooltip:()=>a,render:e=>(0,X.jsx)(_().A,{ariaLabel:a,onClick:()=>{window.open("https://community.atlassian.com/t5/Jira-questions/Re-where-can-i-check-jira-version-am-using-how-to-check/qaq-p/664639/comment-id/218177#M218177","_blank")},icon:j().G,...e})})]}),...e})};var te=()=>n(704152),ne=()=>n(297872),ie=()=>n(957986);const ae=(0,h().YK)({headerTitle:{id:"jiraDCAuthModal.header.title",defaultMessage:"Authenticate your account"}});function se(){const e=(0,a().v3)(),t=(0,s().O$)(x().Ay),{open:n,type:i}=t,o=()=>{const e=x().Ay.getInitialState();x().Ay.setState({...e,open:!1})},r=(0,s().uB)(void 0,f().A),l=(0,s().O$)(A().default).currentSpaceStore,d=t.flowId||u().JW(),c=!!i&&!!l&&t.instanceValue!==x().cK.Cloud&&"dc-auth"===t.type;if((0,m().A)({shouldPreserveTextSelection:n&&c,shouldPreserveBlockSelection:n&&c,shouldRestoreSelection:!0}),!c)return null;const{height:h,width:p}="auth"===i?{width:450,height:"fit-content"}:{width:400,height:"fit-content"};return(0,X.jsx)(ie().A,{open:n,innerStyle:{width:p,height:h,overflow:"scroll",borderRadius:5,maxHeight:675,minHeight:300,padding:6},render:()=>(0,X.jsx)(ne().A,{capture:!0,allowEsc:!0,render:()=>(0,X.jsx)(oe,{type:i,handleModalClose:o,environment:e,requestStore:r,spaceStore:l,flowId:d})}),onDismiss:o})}function oe(e){const{environment:t,requestStore:n,spaceStore:a}=e,r=e.flowId||u().JW(),l=(0,s().O$)(x().Ay);(0,i.useEffect)((()=>{l.flowId||x().Ay.setState({...l,flowId:r})}),[l,r]);const d=(0,o().IS)((e=>({wrapper:{padding:"20px 14px 10px 14px",height:"100%",display:"flex",flexDirection:"column"}})),[]);return(0,X.jsx)("div",{style:d.wrapper,children:(0,X.jsx)(le,{handleModalClose:e.handleModalClose,environment:t,requestStore:n,spaceStore:a,flowId:r})})}function re(e){let{handleModalClose:t,caption:n,title:i}=e;const a=(0,o().IS)((e=>({wrapper:{marginBottom:18},header:{fontWeight:p().Wy.medium,fontSize:17,textAlign:"center",marginTop:8},description:{fontWeight:p().Wy.regular,color:e.mediumTextColor,fontSize:p().J.UIRegular.desktop,maxHeight:72,textAlign:"center",padding:"0px 68px",marginBottom:24},icon:{height:40,width:40},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{width:20,height:20,opacity:.4,fontWeight:p().Wy.bold,padding:3},notionLogo:{height:40,width:40,color:e.regularIconColor},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor}})),[]),s=i||ae.headerTitle;return(0,X.jsxs)("div",{style:a.wrapper,children:[(0,X.jsx)(te().A,{onClick:t,style:a.closeButton,hoveredStyle:a.closeButtonHover,children:(0,d().V)(a.closeButtonIcon)}),(0,X.jsxs)("div",{style:a.iconGroup,children:[(0,X.jsx)("img",{style:a.icon,src:r().A.images.externalIntegrations.jiraPng,alt:"Jira Icon"}),(0,l().B)(a.arrowRight),(0,c().S)(a.notionLogo)]}),(0,X.jsx)("div",{style:a.header,children:(0,X.jsx)(h().sA,{...s})}),n]})}function le(e){let{environment:t,handleModalClose:n}=e;const[a,o]=(0,i.useState)([]),r=(0,s().O$)(x().Ay),[l,d]=i.useState({site:r.site||"",token:"",username:"",password:""}),c=(0,s().K8)((()=>(0,g().nh)()),[]);return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(re,{handleModalClose:n}),(0,X.jsx)(ee,{formValues:l,onChange:(e,t)=>{d({...l,[e]:t}),o((t=>t.filter((t=>t!==e))))},invalidFields:a,environment:t,jiraDataCenterBasicAuthEnabled:c})]})}}}]);