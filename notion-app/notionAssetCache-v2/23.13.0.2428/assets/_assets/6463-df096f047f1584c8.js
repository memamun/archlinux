"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6463],{653048:(e,t,o)=>{o.d(t,{A:()=>E,t:()=>X});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(484714),l=()=>o(56366),i=()=>o(401497),a=()=>o(764880),s=()=>o(289915),c=()=>o(970013),d=()=>o(713998),p=()=>o(784892),u=()=>o(597777),x=()=>o(681873),f=()=>o(799829),g=()=>o(959013),h=()=>o(534177),m=()=>o(284371),y=()=>o(436696),v=()=>o(755022),S=()=>o(170356),j=()=>o(205098),C=()=>o(685889),b=()=>o(630116),w=()=>o(870988),M=()=>o(859794),A=()=>o(448061),V=()=>o(972435),F=()=>o(44935),T=()=>o(297872),_=()=>o(623580),I=()=>o(419357),P=o(474848);const k=(0,g().YK)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function R(e){let{value:t,onChange:o}=e;const{device:l}=(0,r().v3)(),a=(0,n.useRef)(null),[s,c]=(0,n.useState)(!1),d=(0,n.useCallback)((()=>c(!0)),[c]),p=(0,n.useCallback)((()=>c(!1)),[c]),u=(0,n.useCallback)((e=>{o(e.target.value)}),[o]),x=(0,n.useCallback)((()=>{if(a.current){var e;(null===(e=window)||void 0===e?void 0:e.document.activeElement)===a.current&&a.current.blur(),p()}}),[p]),f=(0,i().IS)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),h=t||"";return(0,P.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:d,children:l.isMobile?(0,P.jsx)(I().Ay,{value:h,onChange:u,placeholder:V().A.formatMessage(k.value),onBlur:p,rightMobileEditLabel:(0,P.jsx)(g().sA,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):(0,P.jsx)(F().H,{action:d,render:e=>(0,P.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!s?f.focused:f.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,P.jsx)(T().A,{capture:s,render:e=>(0,P.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,P.jsx)(_().A,{focus:s,ref:a,value:h,onChange:u,placeholder:V().A.formatMessage(k.value),onBlur:p,onCancel:x,style:{marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:w().G$}})})})})})})}var O=()=>o(760217),z=()=>o(406699),B=()=>o(625830),G=()=>o(933117),D=()=>o(448693),$=()=>o(654734),U=()=>o(272630),L=()=>o(512052),Y=()=>o(903400),H=()=>o(399762);const K=(0,g().YK)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function X(e){return e?(0,P.jsx)(g().sA,{defaultMessage:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}):(0,P.jsx)(g().sA,{defaultMessage:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}const E=function(e){let{schema:t,property:n,parentStore:l,filter:i,collectionViewId:a,filterValueType:c,onChange:d,collectionContextStore:p,collectionViewType:u}=e;const x=(0,r().v3)(),f=(0,g().tz)(),m=(0,P.jsx)("span",{});if("date"===c)return(0,s().nM)(i)?(0,s().fZ)(i)?m:(0,s().Cw)(i)?(0,P.jsx)(oe,{intl:f,parentStore:l,schema:t,collectionViewId:a,property:n,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):(0,P.jsx)(te,{intl:f,collectionViewId:a,property:n,schema:t,parentStore:l,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):m;if("text"===c){if(!(0,s().YH)(i))return m;const e=i;if((0,s().fZ)(e))return m;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,P.jsx)(R,{value:t.value,onChange:t=>{const o={type:"exact",value:t},n={...e,value:o};d(n)}})}if("number"===c){if(!(0,s().My)(i))return m;const e=i;if((0,s().fZ)(e))return m;const t=e.value;return(0,P.jsx)(R,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const n={type:"exact",value:(0,o(668766).q)(t,f)},r={...e,value:n};d(r)}})}if("checkbox"===c){if(!(0,s().Ui)(i)||!a)return m;const e=i,o=e.value;return(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(Z,{operatorValue:o,events:e}),render:o=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}if("select"===c||"multi_select"===c||"status"===c){if(!((0,s().v0)(i)||(0,s().as)(i)||(0,s().H$)(i))||!a)return m;const e=i;if((0,s().fZ)(e))return m;const o=t[n];if(!o)return m;const r=(0,s().v0)(e)?(0,s().Zl)(e):(0,s().as)(e)?(0,s().SM)(e):(0,s().Wc)(o,(0,s().V6)(e));return(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(ee,{schema:t,property:n,operatorValues:r,events:e}),render:o=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}if("location"===c){if(!(0,s().G)(i))return m;const e=i,o=(0,s().GK)(e);return(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(Q,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}if("relation"===c){if(!(0,s().Pq)(i)||!a)return m;const e=i;if((0,s().fZ)(e))return m;const o=(0,s().Rh)(e);return(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(le,{parentStore:l,operatorValues:o,events:e,schema:t,property:n}),render:o=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}if("person"===c){if(!(0,s().I_)(i)||!a)return m;const e=i;if((0,s().fZ)(e))return m;const o=(0,s().Wf)(e);return(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(re,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}if("file"===c){if(!(0,s().B6)(i))return m;const e=i;if((0,s().fZ)(e))return m;(0,h().HB)(e)}if("verification"===c)return(0,s().uU)(i)?(0,P.jsx)(z().Ay,{popupType:x.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(q,{operatorValues:(0,s().ms)(i),events:e}),render:e=>(0,P.jsx)(M().td,{collectionViewId:a,propertyFilter:{property:n,filter:i},schema:t,onChange:e=>{d(e)},onClose:e.close,parentStore:l,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!1})}):m;if("geo_point"===c){if(!(0,s().uf)(i))return m;const e=i;return(0,s().fZ)(e)?m:null}(0,h().HB)(c)};function W(){return{maxWidth:w().tv}}function N(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function Z(e){let{operatorValue:t,events:o}=e;const n=null==t?void 0:t.value;return(0,P.jsx)(U().A,{...o,disableMargins:!0,placeholder:(0,P.jsx)(g().sA,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof n&&(0,P.jsx)(B().A,{checked:n,size:16,disabled:!0})})}function q(e){let{operatorValues:t,events:o}=e;const n=t.filter((e=>{let{value:t}=e;return Boolean(t)})).map(j().w0);return(0,P.jsx)(U().A,{...o,disableMargins:!0,placeholder:(0,P.jsx)(g().sA,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:n.length&&(0,P.jsx)("span",{children:(0,x().A)(n,(e=>(0,P.jsx)("span",{style:{whiteSpace:"pre"},children:(0,P.jsx)(g().sA,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function Q(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,P.jsx)(U().A,{...o,disableMargins:!0,desktopStyle:W(),innerStyle:N(t.length>0),placeholder:(0,P.jsx)(g().sA,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:t.length>0&&t.map((e=>e.value&&(0,P.jsx)("div",{style:{margin:"0 10px 6px 0"},children:(0,P.jsx)(A().A,{collectionStore:b().md.createChildStore(n,{table:"collection",id:e.value})})},e.value)))})}function J(e){let{operatorValue:t,events:o,isRange:n,schema:r,property:l}=e;const i=r[l],a=i&&"date"===i.type?i.date_format:void 0;let s;if("exact"===t.type&&t.value)if((0,u().$P)(t.value))s=t.value;else if((0,u().jS)(t.value)){const e=(0,u().dq)(t.value);e&&(s=e.value)}return(0,P.jsx)(U().A,{...o,placeholder:n?(0,P.jsx)(g().sA,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,P.jsx)(g().sA,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:s&&(0,P.jsx)("span",{style:{...m().RC},children:(0,P.jsx)($().A,{value:s,dateFormat:a||u().vz})}),disableMargins:!0})}function ee(e){let{operatorValues:t,events:o,schema:n,property:l}=e;const i=(0,r().v3)(),{device:a}=i,s=n[l],u=s&&((0,c().lx)(s)||"status"===s.type)&&s.options||[];return(0,P.jsx)(U().A,{...o,disableMargins:!0,desktopStyle:W(),innerStyle:N(t.length>0),placeholder:(0,P.jsx)(g().sA,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:t.length>0&&(0,P.jsx)(P.Fragment,{children:t.map((e=>{if(void 0===e.value)return null;const t=(0,d().jy)(u,e.value);return t?(0,P.jsx)(H().O,{format:a.isMobile?p().NY.Large:p().NY.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function te(e){let{filter:t,intl:o,collectionViewId:n,property:l,schema:i,parentStore:a,onChange:c,collectionContextStore:d,collectionViewType:p}=e;const u=(0,r().v3)();if(!n)return null;const x={menuTitle:o.formatMessage(K.dateTitle),items:s().ty,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),d?(0,y().X)({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):(0,v().D)(u,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,P.jsx)(O().A,{title:(0,j().RR)(e.value),...e}),renderOrigin:e=>(0,P.jsx)(U().A,{...e,disableMargins:!0,placeholder:o.formatMessage(K.emptyPlaceholder),title:(0,j().RR)(t.value)})},f=t.value;if("exact"===f.type){const e=(0,P.jsx)(g().sA,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,P.jsx)(G().A,{...x,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,P.jsx)(z().Ay,{popupType:u.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(J,{schema:i,property:l,operatorValue:f,events:e,isRange:!1}),render:e=>(0,P.jsx)(M().td,{collectionViewId:n,propertyFilter:{property:l,filter:t},schema:i,onChange:e=>{c(e)},onClose:e.close,parentStore:a,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:S().NS,width:"100%"}:void 0;return(0,P.jsx)("div",{style:o,children:e})}return(0,P.jsx)(G().A,{...x,mobileActionSheet:!0},"date-filter-value-type")}function oe(e){let{filter:t,intl:o,parentStore:n,schema:l,collectionViewId:i,property:a,onChange:c,collectionContextStore:d,collectionViewType:p}=e;const u=(0,r().v3)();if(!i)return null;const x={menuTitle:o.formatMessage(K.dateTitle),items:(0,s().jw)(),getKey:e=>(0,s().q5)(e),selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),d?(0,y().X)({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):(0,v().D)(u,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,P.jsx)(O().A,{title:(0,j().kz)(e.value),...e}),renderOrigin:e=>(0,P.jsx)(U().A,{...e,disableMargins:!0,placeholder:o.formatMessage(K.emptyPlaceholder),title:(0,j().kz)(t.value)})},f=t.value;if("exact"===f.type){const e=(0,P.jsx)(g().sA,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,P.jsx)(G().A,{...x,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,P.jsx)(z().Ay,{popupType:u.device.isMobile?z().z7.SlideUp:z().z7.Popup,renderOrigin:e=>(0,P.jsx)(J,{schema:l,property:a,operatorValue:f,events:e,isRange:!0}),render:e=>(0,P.jsx)(M().td,{collectionViewId:i,propertyFilter:{property:a,filter:t},schema:l,onChange:e=>{c(e)},onClose:e.close,parentStore:n,context:M().mL.AdvancedFilter,allowRelativePersonFilter:!0})})}}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:S().NS,width:"100%"}:void 0;return(0,P.jsx)("div",{style:o,children:e})}return"relative"!==f.type||"custom"!==f.value&&"surrounding"!==f.value?(0,P.jsx)(G().A,{...x,mobileActionSheet:!0},"date-filter-value-type"):(0,P.jsx)(Y().i,{renderAsQueryDropdown:u.device.isMobile,filter:f,onUpdate:e=>{const o={...t,value:e};c(o),d?(0,y().X)({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):(0,v().D)(u,{view_type:p,action:"set_filter_value_type"})}})}function ne(e){var t;let{operatorValue:o,parentStore:n}=e;const i=(0,r().v3)(),{device:s}=i,c=(0,l().K8)((()=>!o.value||"relative"===o.type&&"me"===o.value?void 0:(0,a().xC)({pointer:o.value,getRecordValue:n.getRecordValue})),[o,n]);return o.value?"relative"===o.type&&"me"===o.value?(0,P.jsx)("span",{style:{marginTop:1,marginRight:10,marginBottom:6},children:(0,P.jsx)(g().sA,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):c?(0,P.jsx)(D().Ay,{actor:c,isSingle:!1,shouldShrink:!1,format:s.isMobile?D().t_.Format.Large:D().t_.Format.Medium,showRemoveButton:!1},null===(t=c.asActor)||void 0===t?void 0:t.id):null:null}function re(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,P.jsx)(U().A,{...o,placeholder:X(void 0),disableMargins:!0,desktopStyle:W(),innerStyle:N(t.length>0),title:t.length>0&&t.map((e=>(0,P.jsx)(ne,{operatorValue:e,parentStore:n},`${e.type}__${e.value}`)))})}function le(e){let{operatorValues:t,events:o,parentStore:n,schema:a,property:s}=e;const d=(0,i().DP)(),u=(0,r().v3)(),{device:x}=u,m=a[s],y=(0,l().K8)((()=>{if(m&&(0,c().nC)(m))return(0,C().LQ)(m,n)}),[m,n]);return(0,P.jsx)(U().A,{...o,disableMargins:!0,desktopStyle:W(),innerStyle:N(t.length>0),placeholder:(0,P.jsx)(g().sA,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:t.length>0&&t.map(((e,t)=>{if(!e.value)return null;const o=e.type,r={isSingle:!1,shouldShrink:!1,format:x.isMobile?p().NY.Large:p().NY.Medium};if("exact"===o)return(0,P.jsx)(L().A,{blockId:e.value,parentStore:n,relationPropertySchema:m&&(0,c().nC)(m)?m:void 0,...r},e.value);if("relative"===o){if("builtin"===e.value.type)return y?(0,P.jsx)(p().Ay,{value:(0,P.jsx)(g().sA,{...f().n$[y][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:d,...r},t):null;if("current_page_in_related_collection"===e.value.type)return(0,P.jsx)(p().Ay,{value:(0,P.jsx)(g().sA,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"}),backgroundColor:"transparent",theme:d,...r},t)}else(0,h().HB)(o)}))})}},870988:(e,t,o)=>{o.d(t,{tY:()=>ce,tv:()=>se,G$:()=>ae});o(944114),o(898992),o(354520),o(430670),o(581454);var n=o(296540),r=()=>o(484714),l=()=>o(401497),i=()=>o(289915),a=()=>o(3284),s=()=>o(668725),c=()=>o(30626),d=()=>o(764781),p=()=>o(617668),u=()=>o(904789),x=()=>o(236262),f=()=>o(959013),g=()=>o(496603),h=()=>o(534177),m=()=>o(436696),y=()=>o(755022),v=()=>o(170356),S=()=>o(873050),j=()=>o(205098),C=()=>o(722872),b=()=>o(962730),w=()=>o(377586),M=()=>o(463830),A=()=>o(274652),V=(o(737550),()=>o(56366)),F=()=>o(713998),T=()=>o(329199),_=()=>o(972435),I=()=>o(553965),P=()=>o(760217),k=()=>o(933117),R=()=>o(859428),O=()=>o(125565),z=()=>o(272630),B=o(474848);function G(e){const{filter:t}=e,{isMobile:o}=(0,r().Y0)(),n=_().A.getIntl(),l={width:190,menuTitle:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:i().$N,selectedItem:(0,i().CY)(t),getKey:e=>e,onSelect:o=>{const n={...t,use_end:(0,i().Zt)(o)};e.onChange(n)},renderItem:e=>(0,B.jsx)(R().A,{renderTooltip:()=>(0,j().WG)(e.value),render:t=>(0,B.jsx)(P().A,{title:(0,j().h0)(e.value),...(0,I().A)(e,t)}),placement:b().W.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,B.jsx)(z().A,{...e,placeholder:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,B.jsx)(O().A,{isMobile:o,children:(0,j().h0)((0,i().CY)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,B.jsx)(k().A,{...l,mobileActionSheet:!0},"date-filter-mode")}var D=()=>o(568063);const $=(0,f().j4)((function(e){const t=(0,r().v3)(),{filterValueType:o,filter:n,intl:l}=e,a=(0,i().U6)(o),s={width:190,menuTitle:l.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:a,selectedItem:n.operator,getKey:e=>e,onSelect:r=>{const l=(0,j().iI)(o,n,r,"combinator");e.onChange(l),e.collectionContextStore?(0,m().X)({environment:t,collectionContextStore:e.collectionContextStore,action:"set_filter_comparator"}):(0,y().D)(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,B.jsx)(P().A,{title:(0,j().J)(e.value),...e}),renderOrigin:e=>(0,B.jsx)(z().A,{...e,placeholder:l.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,B.jsx)(O().A,{isMobile:t.device.isMobile,children:(0,j().J)(n.operator)}),disableMargins:!0})};return(0,B.jsx)(k().A,{...s,mobileActionSheet:!0},"comparator")}));var U=()=>o(653048);const L=(0,f().YK)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});const Y=(0,f().j4)((function(e){const t=(0,r().v3)();if((0,i().s1)(e.filter))return(0,B.jsx)(K,{intl:e.intl,onChange:e.onChange,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const o=(0,i().HF)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,i().$S)(o,e.filter)){const t=(0,j().xt)(o);return(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)($,{filterValueType:o,filter:t,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,B.jsx)(U().A,{filterValueType:o,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const l=(0,B.jsx)(f().sA,{...j().Jk[o],values:{property:(0,B.jsx)(f().sA,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,B.jsx)($,{filterValueType:o,filter:e.filter,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,B.jsx)(U().A,{filterValueType:o,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?l:(0,B.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${v().NS}px`,gridTemplateRows:`${v().sw}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:l})})),H=Y;function K(e){let{filter:t,intl:o,onChange:l,collectionContextStore:a,collectionViewType:s,property:c,schema:d,parentStore:p,collectionViewId:u}=e;const x=(0,r().v3)(),f={menuTitle:o.formatMessage(L.setFilter),items:i().$X,getKey:e=>e,selectedItem:t.operator,onSelect:e=>{const o={...t,operator:e};l(o),a?(0,m().X)({environment:x,collectionContextStore:a,action:"set_rollup_set_filter"}):(0,y().D)(x,{view_type:s,action:"set_rollup_set_filter"})},renderItem:e=>(0,B.jsx)(P().A,{title:(0,j().wE)(e.value,o),...e}),renderOrigin:e=>(0,B.jsx)(z().A,{...e,placeholder:o.formatMessage(L.setFilter),title:(0,j().wE)(t.operator,o),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:g,targetCollectionSchema:h}=(0,V().K8)((()=>{var e;if("rollup"===(null==d||null===(e=d[c])||void 0===e?void 0:e.type)){const e=(0,D().eY)({schema:d,property:c,getRecordModel:p.getRecordModel});return{targetProperty:null==e?void 0:e.targetProperty,targetCollectionSchema:null==e?void 0:e.targetCollectionSchema}}return{targetProperty:c,targetCollectionSchema:d}}),[c,d,p]);if(!g||!h)return(0,B.jsx)("div",{style:{gridColumnEnd:"span 2"}});const S=(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(k().A,{...f,mobileActionSheet:!0},"set_filter"),(0,B.jsx)(Y,{collectionViewId:u,filter:t.subfilter,schema:h,property:g,parentStore:p,collectionContextStore:a,collectionViewType:s,onChange:e=>{const o={...t,subfilter:e};l(o)},isArrayFilter:!0})]});return x.device.isMobile?S:(0,B.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${v().NS}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${v().sw}px`},children:S})}var X=()=>o(406699);const E=function(e){let{schema:t,propertyFilter:l,parentStore:a,index:s,collectionContextStore:c,collectionViewType:d,onChange:p,filterOperator:u,collectionViewId:x}=e;const g=(0,r().v3)(),{device:h}=g,v=(0,F()._g)({schema:t,property:l.property}),S=(0,V().K8)((()=>(0,i().tn)(t,l.property,l.filter,a.getRecordModel)),[a,l,t]);if(!v)return null;if(!S)return null;const C=(0,i().nM)(l.filter)&&(0,i().gc)(l.filter)&&(0,i().qK)(v),b=C?{width:"120px",marginRight:"4px"}:{},w=(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(X().Ay,{popupType:h.isMobile?X().z7.SlideUp:X().z7.Popup,renderOrigin:e=>(0,B.jsx)(o(992510).A,{...e,propertySchema:v,disableMargins:!0,textWrapperStyle:{width:"100%",...b}}),render:e=>(0,B.jsx)(o(150987).A,{isRelationProperty:!1,schema:t,onAccept:e=>function(e,t,o,n,r,l,a,s,c){const{property:d,filter:p}=n,u=o[d],x=o[e],f={property:e,filter:p},g=x&&(0,i().tn)(o,e,p,r.getRecordModel),h=x&&"relation"===x.type&&d!==e,v=u&&("created_by"===u.type||"last_edited_by"===u.type)&&x&&"person"===x.type,S=(0,i().I_)(p)&&!(0,i().fZ)(p)&&(0,i().Wf)(p).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));(!g||h||v&&S||!(0,T().hs)(f,o))&&(f.filter=(0,j().SN)({schema:o,property:e,getRecordModel:r.getRecordModel}));null==c||c(l,f),a?(0,m().X)({environment:t,collectionContextStore:a,action:"set_filter_property"}):(0,y().D)(t,{view_type:s,action:"set_filter_property"})}(e,g,t,l,a,s,c,d,p),onClose:e.close,allowProperty:F().ah})}),C&&(0,B.jsx)(G,{filter:l.filter,onChange:e=>{const t={...l,filter:e};null==p||p(s,t)}})]});return(0,B.jsxs)(n.Fragment,{children:[u,h.isMobile?w:(0,B.jsx)("div",{style:{display:"flex"},children:w}),(0,B.jsx)(f().sA,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,B.jsx)(H,{filter:l.filter,schema:t,property:l.property,parentStore:a,collectionViewId:x,collectionContextStore:c,collectionViewType:d,onChange:e=>{const t={...l,filter:e};null==p||p(s,t)},isArrayFilter:!1})]})};function W(){return(0,B.jsx)(f().sA,{defaultMessage:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const N=(0,f().YK)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});const Z=(0,f().j4)((function(e){const{intl:t,filterOperator:o,onChange:n,disableMargins:r}=e,l={width:"auto",menuTitle:t.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:i().Ak,getKey:e=>e,selectedItem:o,onSelect:n,renderItem:e=>(0,B.jsx)(P().A,{title:(0,j().Az)(e.value,t),caption:(0,j().YL)(e.value,t),...e}),renderOrigin:e=>(0,B.jsx)(z().A,{...e,title:o&&(0,j().Az)(o,t),placeholder:t.formatMessage(N.operatorPlaceholder),disableMargins:r})};return(0,B.jsx)(k().A,{...l,mobileActionSheet:!0},"operator")}));var q=()=>o(44935),Q=()=>o(285790),J=()=>o(928600),ee=()=>o(939740),te=()=>o(45552),oe=()=>o(8980),ne=()=>o(89924);const re=60,le=120,ie=110,ae=170,se=400;function ce(e){const{combinatorFilter:t,index:o,level:l,schema:a,onChange:s,parentStore:c,collectionContextStore:d,collectionViewType:p,collectionViewId:u}=e,x=(0,r().Y0)(),f=(0,n.useRef)([]),g=(t.filters??[]).flatMap((e=>(0,i().LB)(e)?[]:[e]));return(0,B.jsxs)(n.Fragment,{children:[Fe(t,l)?void 0:(0,B.jsx)("div",{style:x.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] ${re}px\n             [boolean-end property-start] minmax(min-content, ${le}px)\n             [property-end operator-start] ${ie}px\n             [operator-end value-start] auto\n             [value-end menu-start] ${v().sw}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${v().sw}px, auto)`,gridColumnGap:v().NS,gridRowGap:v().Z3,padding:`${v().Z3}px ${v().NS}px 0 ${v().NS}px`,justifyItems:"stretch",alignItems:"start"},children:g.map(((o,n)=>(0,B.jsx)(de,{childFilter:o,newIndex:n,schema:a,level:l,combinatorFilter:t,onChange:s,index:e.index,collectionContextStore:d,collectionViewType:p,buttonPopupStores:f.current,parentStore:c,collectionViewId:u},n)))}),(0,B.jsx)(ge,{schema:a,level:l,combinatorFilter:t,onChange:s,index:o,buttonPopupStores:f.current,collectionContextStore:d,collectionViewType:p})]})}function de(e){const{childFilter:t,newIndex:o,...n}=e,l=(0,r().Y0)();return(0,i().dU)(t)?l.isMobile?(0,B.jsx)(fe,{childFilter:t,newIndex:o,...n}):(0,B.jsx)(xe,{childFilter:t,newIndex:o,...n}):(0,i().yX)(t)?l.isMobile?(0,B.jsx)(ue,{childFilter:t,newIndex:o,...n}):(0,B.jsx)(pe,{childFilter:t,newIndex:o,...n}):null}function pe(e){const{newIndex:t,childFilter:o}=e;return(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(E,{index:t,propertyFilter:o,schema:e.schema,filterOperator:(0,B.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),parentStore:e.parentStore,onChange:(t,o)=>Pe(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},t),(0,B.jsx)(he,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function ue(e){const{childFilter:t,newIndex:o}=e;return(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,B.jsxs)(ne().A,{title:(0,B.jsx)(f().sA,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:o+1}}),children:[(0,B.jsx)(E,{index:o,propertyFilter:t,schema:e.schema,filterOperator:null,parentStore:e.parentStore,onChange:(t,o)=>Pe(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},o),(0,B.jsx)(he,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function xe(e){const{newIndex:t,childFilter:o}=e,r=(0,l().IS)((e=>({wrapperStyles:{gridColumn:"property-start / value-end",...Ie(e)}})),[]);return(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),(0,B.jsx)("div",{style:r.wrapperStyles,children:(0,B.jsx)(ce,{index:t,level:e.level+1,combinatorFilter:o,onChange:(t,o)=>Pe(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})}),(0,B.jsx)(he,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function fe(e){const{childFilter:t,newIndex:o}=e,r=(t.filters||[]).length,l=(0,B.jsx)(f().sA,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:o+1}});return(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,B.jsxs)(ne().A,{title:l,children:[(0,B.jsx)(X().Ay,{buttonPopupStore:je(o,e.buttonPopupStores),popupType:X().z7.SlideUp,renderOrigin:o=>(0,B.jsx)(P().A,{focused:!1,...o,showExtensionArrow:!0,right:r.toString(),title:(0,j().Dz)({filter:t,schema:e.schema})}),render:n=>(0,B.jsx)(J().A,{menuType:C().gu.Modal,title:l,left:(0,B.jsx)(te().BackMenuText,{}),onClickLeft:n.close,children:(0,B.jsx)(ce,{index:o,level:e.level+1,combinatorFilter:t,onChange:(t,o)=>Pe(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})})}),(0,B.jsx)(he,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function ge(e){const t=(0,r().v3)(),o=(0,r().Y0)(),{schema:n,level:i,combinatorFilter:a,onChange:c,index:d,buttonPopupStores:p,collectionContextStore:u,collectionViewType:x}=e,f=(0,l().IS)((()=>({buttonMenuItemStyles:{height:32}})),[]);return o.isMobile?(0,B.jsxs)(ne().A,{topBorder:Fe(a,i),children:[(0,B.jsx)(Te,{props:{onClick:()=>ke(t,n,a,c,d,u,x)}}),Me(e.level)&&(0,B.jsx)(_e,{props:{onClick:()=>ve(t,n,a,c,d,u,x,p)}})]}):Me(i)?(0,B.jsx)(ne().A,{topBorder:Fe(a,i),children:(0,B.jsx)(X().Ay,{alignmentToOrigin:b().C.Start,popupType:w().n.Popup,renderOrigin:e=>(0,B.jsx)(q().H,{action:()=>e.onClick(),render:t=>{const{focused:o,...n}=t;return(0,B.jsx)(A().A,{...e,...n,focused:o,isBlue:!1,style:f.buttonMenuItemStyles,title:(0,B.jsxs)("div",{children:[(0,B.jsx)(W,{}),(0,s().b)({width:10,marginLeft:6,display:"inline"})]})})}}),render:e=>(0,B.jsx)(ee().Ay,{type:ee().Oh.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,B.jsx)(ne().A,{...e}),items:[{key:"add_filter",render:e=>(0,B.jsx)(Te,{props:e}),action:o=>{e.close(),ke(t,n,a,c,d,u,x)}},{key:"add_filter_group",render:e=>(0,B.jsx)(_e,{props:e}),action:o=>{e.close(),ve(t,n,a,c,d,u,x,p)}}]}]})})}):(0,B.jsx)(ne().A,{topBorder:Fe(a,i),children:(0,B.jsx)(q().H,{action:()=>ke(t,e.schema,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType),render:e=>{const{focused:o,...r}=e;return(0,B.jsx)(A().A,{...r,focused:e.focused,isBlue:!1,style:f.buttonMenuItemStyles,onClick:()=>ke(t,n,a,c,d,u,x),title:(0,B.jsx)(W,{})})}})})}function he(e){const t=(0,r().Y0)(),o=(0,f().tz)();return t.isMobile?(0,B.jsx)(me,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:void 0,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType}):(0,B.jsx)(X().Ay,{popupType:w().n.Popup,renderOrigin:e=>(0,B.jsx)(q().H,{action:()=>e.onClick(),render:e=>(0,B.jsx)(Q().A,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:c()._,ariaLabel:o.formatMessage({id:"collections.CollectionFilterCombinatorGrid.RowActions.threeDotActionMenu",defaultMessage:"Edit filter actions"})})}),render:t=>(0,B.jsx)(me,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:t,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType})})}function me(e){const{filter:t,indexToChange:o,parent:n}=e,l=(0,r().v3)(),s=(0,r().Y0)(),c=(0,i().dU)(t),p=c?(0,B.jsx)(f().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,B.jsx)(f().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),u=c?(0,B.jsx)(f().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,B.jsx)(f().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),h=[{key:"delete",action:()=>{var t,r,l,i,a;n&&n.close(),t=o,r=e.buttonPopupStores,l=e.combinatorFilter,i=e.onChange,a=e.index,Ve((e=>e.splice(t,1)),l,i,a),je(t,r).reset(),r.splice(t,1)},render:e=>(0,B.jsx)(P().A,{...e,icon:(0,B.jsx)(oe().I,{icon:x().I}),isRedOnHover:!0,title:p})},{key:"duplicate",action:()=>{n&&n.close(),function(e,t,o,n,r,l,i){Ve((t=>{const o=t[e];if(o){const n={...o};t.splice(e,0,n)}}),t,o,n),r?(0,m().X)({environment:i,collectionContextStore:r,action:"add_filter_group"}):(0,y().D)(i,{view_type:l,action:"duplicate_filter"})}(o,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType,l)},render:e=>(0,B.jsx)(P().A,{...e,icon:(0,B.jsx)(oe().I,{icon:d().V}),title:u})}];if((0,i().yX)(t)&&Me(e.level)&&h.push({key:"turn_into_group",action:()=>{n&&n.close(),ye(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,B.jsx)(P().A,{...e,icon:(0,B.jsx)(oe().I,{icon:a().Q}),title:(0,B.jsx)(f().sA,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,i().dU)(t)&&t.filters&&1===t.filters.length){const r=(0,i().dU)(t.filters[0])?(0,B.jsx)(f().sA,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,B.jsx)(f().sA,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});h.push({key:"turn_into_filter",action:()=>{n&&n.close(),function(e,t,o,n,r,l,a,s){const c=g().$1(t.filters||[]);c&&!(0,i().LB)(c)&&Pe(e,c,n,r,l);a?(0,m().X)({environment:o,collectionContextStore:a,action:"turn_into_filter"}):(0,y().D)(o,{view_type:s,action:"turn_into_filter"})}(o,t,l,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType)},render:e=>(0,B.jsx)(P().A,{...e,icon:(0,B.jsx)(oe().I,{icon:a().Q}),title:r})})}const v=Ce(t);return(0,i().dU)(t)&&e.level+v+1<3&&h.push({key:"wrap_in_group",action:()=>{n&&n.close(),ye(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,B.jsx)(P().A,{...e,icon:(0,B.jsx)(oe().I,{icon:a().Q}),title:(0,B.jsx)(f().sA,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,B.jsx)(f().sA,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,B.jsx)(ee().Ay,{initialFocus:s.isMobile?void 0:0,type:ee().Oh.Vertical,sections:[{key:"actions",render:s.isMobile?e=>(0,B.jsx)("div",{...e}):e=>(0,B.jsx)(ne().A,{...e}),items:h}]})}function ye(e,t,o,n,r,l,i,a,s){Pe(t,{operator:we(n),filters:[o]},n,r,l),Se(t,i),a?(0,m().X)({environment:e,collectionContextStore:a,action:"turn_into_filter_group"}):(0,y().D)(e,{view_type:s,action:"turn_into_filter_group"})}function ve(e,t,o,n,r,l,i,a){const s=Ae(t,o),c={operator:we(o),filters:[s]};Se(Ve((e=>e.push(c)),o,n,r)-1,a),l?(0,m().X)({environment:e,collectionContextStore:l,action:"add_filter_group"}):(0,y().D)(e,{view_type:i,action:"add_filter_group"})}function Se(e,t){je(e,t).setState({open:!0})}function je(e,t){for(;t.length<e+1;){const e=new(M().A);t.push(e)}return t[e]}function Ce(e){if((0,i().dU)(e)){const t=(e.filters||[]).filter(i().dU);return 1+(g().T9(t.map(Ce))||0)}return 0}function be(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,B.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,B.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,B.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,B.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,h().HB)(t)}function we(e){return"or"===e.operator?"and":"or"}function Me(e){return e<2}function Ae(e,t){const o=(t.filters||[]).filter(i().yX),n=o[o.length-1];return n?g().mg(n):(0,S().MI)(e)}function Ve(e,t,o,n){const r=[...t.filters||[]],l=e(r);return o(n,{...t,filters:r}),l}function Fe(e,t){return(0,i().U0)(e)&&0===t}function Te(e){let{props:t}=e;const o=(0,B.jsx)(oe().I,{icon:p().plusIcon});return(0,B.jsx)(P().A,{focused:!1,...t,icon:o,title:(0,B.jsx)(W,{})})}function _e(e){let{props:t}=e;const o=(0,B.jsx)(oe().I,{icon:u().R});return(0,B.jsx)(P().A,{focused:!1,...t,icon:o,title:(0,B.jsx)(f().sA,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,B.jsx)(f().sA,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function Ie(e){return{background:e.filterGroupBackground,borderRadius:6,boxShadow:`0 0 0 1px ${e.filterGroupBorder}`,margin:1,alignSelf:"stretch"}}function Pe(e,t,o,n,r){Ve((o=>o.splice(e,1,t)),o,n,r)}function ke(e,t,o,n,r,l,i){const a=Ae(t,o);Ve((e=>e.push(a)),o,n,r),l?(0,m().X)({environment:e,collectionContextStore:l,action:"add_filter"}):(0,y().D)(e,{view_type:i,action:"add_filter"})}function Re(e){let{newIndex:t,combinatorFilter:o,onChange:n,index:l,collectionContextStore:i,collectionViewType:a}=e;const s=(0,r().v3)(),c=o.operator,{device:d}=s,p={justifySelf:"end"},u={...p,lineHeight:"32px",paddingRight:4};if(0===t)return d.isMobile?null:(0,B.jsx)(O().A,{style:u,children:(0,B.jsx)(f().sA,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===t){const e=(0,B.jsx)(Z,{disableMargins:!0,filterOperator:c,onChange:e=>function(e,t,o,n,r,l,i){n(r,{...o,operator:e}),l?(0,m().X)({environment:t,collectionContextStore:l,action:"set_filter_operator"}):(0,y().D)(t,{view_type:i,action:"set_filter_operator"})}(e,s,o,n,l,i,a)});return s.device.isMobile?(0,B.jsx)(ne().A,{children:e}):(0,B.jsx)("div",{style:p,children:e})}return d.isMobile?null:(0,B.jsx)(O().A,{style:u,children:(0,B.jsx)(be,{operator:c})})}},904789:(e,t,o)=>{o.d(t,{R:()=>l});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M12 8.875c.345 0 .625.28.625.625v1.875H14.5a.625.625 0 1 1 0 1.25h-1.875V14.5a.625.625 0 1 1-1.25 0v-1.875H9.5a.625.625 0 1 1 0-1.25h1.875V9.5c0-.345.28-.625.625-.625"}),(0,n.jsx)("path",{d:"M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},l=(0,o(340498).wt)("squareOnSquarePlus",r)}}]);