"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[43647],{608581:(e,t,o)=>{o.d(t,{A:()=>d});o(898992),o(354520),o(581454),o(941795);var i=o(296540),n=()=>o(401497),s=()=>o(451306),r=()=>o(284371),a=()=>o(963575),l=o(474848);function c(e){const{button:t,isLast:o}=e,a=(0,n().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return i.cloneElement(t,{...(0,s().AH)(t.props.style,a.button,o&&a.buttonLast),hoveredStyle:(0,s().AH)(a.buttonHovered,o&&a.buttonLast).style,pressedStyle:a.buttonPressed})}const d=function(e){let{children:t,isVisible:d,position:g,style:u}=e;const p=(0,o(484714).v3)(),h=(0,n().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:a().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:p.device.isMobile?"auto":"none",opacity:p.device.isMobile?1:0,fontFamily:r().vc(o(662303).locale).sans,position:"absolute",right:a().A.horizontal.small,bottom:a().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:a().A.vertical.small,bottom:void 0}})),[p]),m=i.Children.toArray(t).filter(o(534177).O9),v=m.length;return(0,l.jsx)(o(145214).A,{animate:{opacity:d?1:0},...(0,s().AH)(h.container,u,d&&h.containerHover,"top"===g&&h.containerTop),children:m.map(((e,t)=>{const n=t===v-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(859428).A&&i.isValidElement(e))return i.cloneElement(e,{render:(t,o)=>{const i=e.props.render(t,o);return(0,l.jsx)(c,{isLast:n,button:i},e.key)}});if(e.type===o(704152).A&&i.isValidElement(e))return(0,l.jsx)(c,{isLast:n,button:e},e.key)}}))})}},801678:(e,t,o)=>{o.d(t,{A:()=>v});var i=o(296540),n=()=>o(662303),s=()=>o(484714),r=()=>o(56366),a=()=>o(451306),l=()=>o(959013),c=()=>o(100622),d=()=>o(496603),g=()=>o(284371),u=()=>o(720665),p=()=>o(145214),h=o(474848);const m={isRepositioning:!1};const v=function(e){const t=(0,i.useRef)(null),n=(0,s().v3)(),{isMobile:l}=(0,s().Y0)(),[c,g]=(0,i.useState)(m),p=(0,i.useCallback)((()=>{g(m)}),[]),{renderControl:v,onFlushTemporaryPosition:x,style:f,source:C,store:y}=e,{isRepositioning:A,image:k,startDragRenderedPosition:R,startDragImageScreenHeight:S}=c,j=(0,r().K8)((()=>0===o(502438).default.state.stores.length),[]),[w,P]=(0,i.useState)(!1),M=(0,r().uB)(e.mouseStore,o(454305).A),E=(0,r().K8)((()=>M.state.mouseEntered),[M]),H=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:A?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[A]),L=(0,r().K8)((()=>function(e,t,o){return(0,d().Et)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,d().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,u().pN)(t)?o:t}}const i=t.getFormat(),n=i.page_cover_position;if((0,d().Et)(n))return n;return o}(e,t)}(C,y,c.temporaryPosition)),[c.temporaryPosition,C,y]);(0,i.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&A&&x({imagePosition:L,reset:()=>{M.reset(),p()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[L,A,M,x,p]),A&&!j&&p();const D=(0,i.useMemo)((()=>(0,d().nF)((e=>{M.setState({...M.state,mouseEntered:!0})}),100)),[M]),B=(0,i.useMemo)((()=>(0,d().sg)((e=>{M.setState({...M.state,mouseEntered:!1})}),100)),[M]),F=(0,i.useCallback)(((e,t)=>{o(778417).IU({environment:n});const i=new Image;i.onload=()=>{g((e=>({...e,isRepositioning:!0,image:i})))},t&&(i.src=t)}),[n]),I=(0,i.useCallback)((e=>{x({imagePosition:L,reset:()=>{p()}})}),[L,x,p]),T=(0,i.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&P(!0)}),[]),W=(0,i.useCallback)((()=>{P(!0)}),[]),V=(0,i.useCallback)((e=>{if(k&&A){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/k.width*k.height;g((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:L})))}}}),[k,L,A]),K=(0,i.useCallback)((e=>{if(A){const t=e.diffY/(S||0)+(R||0);g((e=>({...e,temporaryPosition:(0,d().LI)((0,o(40845).A)(t,0,1),4)})))}}),[A,S,R]),_=(0,i.useCallback)((()=>{g((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),z=(0,r().K8)((()=>v({handleRepositionClick:F,handleSavePositionClick:I,handleCancelClick:p,isVisible:l||E||w||A,isRepositioning:A})),[F,I,w,l,A,E,v,p]);return(0,h.jsxs)("div",{ref:t,onFocus:T,onBlur:W,onMouseEnter:D,onMouseMove:D,onMouseLeave:B,...(0,a().AH)(H.container,f),children:[(0,h.jsx)(o(603820).A,{onDraggableDragStart:V,onDraggableDragMove:K,onDraggableDragEnd:_,onDraggableDragCancel:_,disabled:!A,render:t=>(0,h.jsx)("div",{...(0,a().AH)(H.dragContainer),...t,children:e.render({imagePosition:L,isRepositioning:A})})}),(0,h.jsx)(b,{small:e.small,isRepositioning:A}),z]})};function b(e){let{small:t,isRepositioning:o}=e;if(t)return null;const i={background:c().Ay.blackWithAlpha(.4),borderRadius:4,color:c().Ay.white,fontSize:12,fontFamily:g().vc(n().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,h.jsx)(p().A,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:i,children:(0,h.jsx)(l().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},943647:(e,t,o)=>{o.d(t,{A:()=>x});var i=o(296540),n=()=>o(484714),s=()=>o(56366),r=()=>o(959013),a=()=>o(896628),l=()=>o(454531),c=()=>o(317909),d=()=>o(478726),g=()=>o(867772),u=()=>o(681810),p=()=>o(608581),h=()=>o(145214),m=()=>o(704152),v=()=>o(24611),b=o(474848);const x=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:d,height:p,proxyWidth:h}=e;const m=(0,n().v3)(),v=(0,s().uB)(void 0,o(454305).A),x=(0,s().K8)((()=>r||"suggest"===o(77246).Uv.getMode(t)),[r,t]),y=(0,s().K8)((()=>t.getCover()),[t]),A=(0,s().O$)(u().A),[k,R]=(0,i.useState)(void 0);if(!y)return null;const S=A.loadingMode!==g().pF&&A.loadingMode!==g().Wc;return(0,b.jsx)(o(801678).A,{mouseStore:v,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:i,reset:n}=e;c().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{a().yY({store:t,coverPosition:i,transaction:e}),n()}})}(e,t,m),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:s,isRepositioning:r}=e;return(0,b.jsx)(C,{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:s,isRepositioning:r,lastProxiedUrl:k,store:t,disabled:x,paddingRight:l,paddingLeft:d,mouseStore:v})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:p,maxHeight:280,cursor:"default"},render:e=>(0,b.jsxs)(i.Fragment,{children:[(0,b.jsx)(o(360083).A,{url:y.cover,isAuthenticated:!0,permissionRecord:y.pointer,width:h,onFinishedLoadingProxyUrl:R,render:(t,i)=>{const n={width:"100%",height:p,maxHeight:280,objectFit:"cover",opacity:S?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:p,maxHeight:280};return(0,b.jsx)(o(307440).E,{src:i,placeholderSrc:S?A.dataURL:void 0,placeholderBehavior:S?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:n,onLoadComplete:f,testId:"pageCover"})}}),S&&(0,b.jsxs)("div",{style:o(816559).fd,children:[(0,b.jsx)(o(331542).A,{size:"md",style:{marginRight:4}}),(0,b.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,b.jsx)(o(773382).A,{percentage:A.uploadProgress})})]})]})})};function f(){u().A.reset()}function C(e){let{isVisible:t,isRepositioning:o,handleCancelClick:a,handleRepositionClick:c,handleSavePositionClick:x,lastProxiedUrl:f,store:C,disabled:y,paddingRight:A,paddingLeft:k,mouseStore:R}=e;const S=(0,n().v3)(),j=(0,r().tz)(),w=(0,i.useCallback)((e=>function(e,t,o,i,n){n.reset();const s=e.target.getBoundingClientRect();l().W({environment:t,intl:o,store:i,rect:s})}(e,S,j,C,R)),[S,j,C,R]),P=(0,s().K8)((()=>u().A.state.loadingMode),[]),M=(0,s().K8)((()=>function(e){let t;return t=e.isFullWidth()?"100%":d().x6,t}(C)),[C]);if(y||P!==g().pF)return null;const{device:E}=S,{isMobile:H}=E;return(0,b.jsx)(h().A,{animate:{width:M,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,b.jsxs)(p().A,{isVisible:t,position:"bottom",style:{marginRight:A,marginLeft:k},children:[!o&&(0,b.jsx)(m().A,{style:{borderRight:H?"none":void 0,...v().k},onClick:w,children:(0,b.jsx)(r().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!H&&(0,b.jsx)(m().A,{style:{...v().k,borderRight:"none"},onClick:e=>c(e,f),children:(0,b.jsx)(r().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!H&&(0,b.jsx)(m().A,{style:v().k,onClick:x,children:(0,b.jsx)(r().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!H&&(0,b.jsx)(m().A,{style:{...v().k,borderRight:"none"},onClick:a,children:(0,b.jsx)(r().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}}}]);