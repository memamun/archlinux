"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98682],{7767:(e,t,n)=>{n.d(t,{A:()=>o});var i=()=>n(194188),r=()=>n(10123),s=()=>n(570551);function o(e,t){(0,s().A)(2,arguments);var n=(0,r().A)(e).getTime(),o=(0,i().A)(t);return new Date(n+o)}},10123:(e,t,n)=>{n.d(t,{A:()=>s});var i=()=>n(570551);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){(0,i().A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},36951:(e,t,n)=>{n.d(t,{Ak:()=>v,VK:()=>f,xh:()=>g});n(16280);var i=()=>n(370657),r=()=>n(386164),s=()=>n(427704),o=()=>n(234459),a=()=>n(919709),l=()=>n(532659),c=()=>n(498212),d=()=>n(449506),u=()=>n(435009),h=()=>n(594794),p=()=>n(351360),m=()=>n(582524);async function g(e){var t;const{environment:n,clientStore:s,message:o}=e,u=p().default.state.currentSpaceStore;if(!u)throw new Error("No current space store");const h=null===(t=n.currentUser)||void 0===t?void 0:t.id;if(!h)throw new Error("No current user");if((0,a().q4_)(o).trim().length<6)return;const m=await d().callStreamApi({eventName:"runInferenceTranscript",environment:n,data:{transcript:[{id:(0,c().Ay)(),type:"config",value:{type:"route-inference-transcript",configs:i().r5}},{id:(0,c().Ay)(),type:"user",value:o,userId:h}],traceId:(0,c().Ay)(),spaceId:u.id,generateTitle:!1},headers:(0,r().WS)({spaceId:u.id})});if("failed"===m.type)throw m.error;if(l().hS.is(m.data))for await(const i of m.data)if("config"===i.type)s.state.userSelectedConfig||s.setState({...s.state,config:i.value});else if("error"===i.type)throw i.message}function f(e){const{environment:t,threadId:n}=e;u().oo({environment:t,url:n?`${s().GJ.aiInferenceTranscript}?t=${(0,c().Xw)(n)}`:s().GJ.aiInferenceTranscript})}function v(e){const{environment:t,query:n,clientStore:i}=e,{currentSpaceStore:r,currentUserStore:s}=p().default.state;if(!r||!n)throw new Error("No current space or value");if(!t.currentUser.id)throw new Error("No current user");const a=(0,h().Z1)({environment:t,table:o().To,spaceId:r.id});(0,m().Wq)({clientStore:i}),(0,m().i0)({environment:t,clientStore:i,threadStore:void 0,threadId:a,threadParentPointer:{...r.pointer,spaceId:r.id},additionalSteps:[],config:{type:"search",scopeForNextSearch:{type:"everything"}},userStore:s,spaceStore:r,value:n}),f({environment:t,threadId:a})}},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});class i extends(()=>n(757695))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const r=new i},194188:(e,t,n)=>{function i(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{A:()=>i})},359545:(e,t,n)=>{n.d(t,{d:()=>r});n(296540);var i=n(474848);const r=(0,n(340498).wt)("computerChip",{viewBox:"0 0 64 64",svg:(0,i.jsx)("path",{d:"m58,21.5v-3l-6-1.5v-1c0-2.47-1.53-4-4-4h-1l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-1c-2.47,0-4,1.53-4,4v1l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v1c0,2.47,1.53,4,4,4h1l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h1c2.47,0,4-1.53,4-4v-1l6-1.5v-3l-6-1.5v-6l6-1.5v-3l-6-1.5v-6l6-1.5Zm-10,26.5H16V16h32v32Zm-4-28h-24v24h24v-24Zm-17,10c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Z"})})},392890:(e,t,n)=>{n.d(t,{A:()=>a});var i=()=>n(194188),r=()=>n(7767),s=()=>n(570551),o=6e4;function a(e,t){(0,s().A)(2,arguments);var n=(0,i().A)(t);return(0,r().A)(e,n*o)}},392998:(e,t,n)=>{n.d(t,{A:()=>o});var i=()=>n(194188),r=()=>n(10123),s=()=>n(570551);function o(e,t){(0,s().A)(2,arguments);var n=(0,r().A)(e),o=(0,i().A)(t);return isNaN(o)?new Date(NaN):o?(n.setDate(n.getDate()+o),n):n}},408197:(e,t,n)=>{n.d(t,{s:()=>r});n(296540);const i={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M10.566 16.22a4.6 4.6 0 0 1-2.068-.487v-.01l-1.423-.487h-.122V7.498l1.76-1.876c.293-.375.576-.938.846-1.475.179-.355.352-.7.519-.972l.36-.74a1.29 1.29 0 0 1 1.551-.527c.624.243.955.916.77 1.56l-.507 1.774c-.099.343-.241.63-.384.917a5.6 5.6 0 0 0-.376.887.404.404 0 0 0 .39.517h4.095a1.22 1.22 0 0 1 1.218 1.218c0 .42-.224.78-.555.995a1.2 1.2 0 0 1-.147 2.213c.274.224.459.556.459.936a1.21 1.21 0 0 1-1.21 1.219 1.22 1.22 0 0 1-.868 2.077zM5.734 8.148H3.663a.975.975 0 0 0-.975.975v5.138c0 .538.436.975.974.975h2.072z"})},r=(0,n(340498).wt)("handThumbsUpFill",i)},436150:(e,t,n)=>{n.d(t,{v:()=>r});n(296540);const i={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"m6.953 12.502 1.76 1.876c.293.375.576.938.846 1.475.179.356.352.7.519.972l.36.741c.322.527.976.741 1.551.527.624-.244.955-.917.77-1.56l-.507-1.775a5.3 5.3 0 0 0-.384-.917c-.138-.278-.276-.556-.376-.887a.404.404 0 0 1 .39-.517h4.095a1.22 1.22 0 0 0 1.218-1.218c0-.42-.224-.78-.555-.995.4-.195.672-.594.672-1.072a1.2 1.2 0 0 0-.819-1.141 1.21 1.21 0 0 0 .459-.936 1.21 1.21 0 0 0-1.21-1.219 1.22 1.22 0 0 0-.868-2.077h-4.308c-.722 0-1.424.166-2.068.488v.01l-1.423.487h-.122zM5.734 4.764v7.088H3.663a.975.975 0 0 1-.975-.975V5.74c0-.538.436-.975.974-.975z"})},r=(0,n(340498).wt)("handThumbsDownFill",i)},529324:(e,t,n)=>{n.d(t,{C:()=>i});const i=(0,n(340498).xh)("magnifyingGlass",{default:{loader:()=>n.e(1827).then(n.bind(n,901827))},small:{loader:()=>n.e(41805).then(n.bind(n,741805))},mini:{loader:()=>n.e(20283).then(n.bind(n,420283))},large:{loader:()=>n.e(61969).then(n.bind(n,861969))}})},570551:(e,t,n)=>{function i(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{A:()=>i})},631818:(e,t,n)=>{n.d(t,{A:()=>D,x:()=>F});n(581454);var i=n(296540),r=()=>n(484714),s=()=>n(56366),o=()=>n(401497),a=()=>n(584262),l=()=>n(657222),c=()=>n(861017),d=()=>n(179034),u=()=>n(959013),h=()=>n(284371),p=()=>n(755636),m=()=>n(281948),g=()=>n(768407),f=()=>n(493823),v=()=>n(406699),y=()=>n(928600),x=()=>n(939740),b=()=>n(614505),S=()=>n(16006),I=()=>n(89924),w=()=>n(780054),A=()=>n(886680),k=()=>n(722872),M=()=>n(962730),j=()=>n(351360),C=()=>n(630116),T=n(474848);const P=4,B=4,E={height:20,paddingTop:2,paddingBottom:2,marginTop:-2,marginBottom:-2,paddingLeft:4,paddingRight:4,marginLeft:-P,marginRight:-B};function R(e){let{event:t,onClick:n}=e;const i=(0,r().v3)(),s=(0,o().IS)((()=>({container:{display:"flex",flexDirection:"row",justifyItems:"center",width:"fit-content",maxWidth:"100%",gap:6}})),[]),{attachments:a}=t,[l,...d]=function(e){let{environment:t,attachments:n}=e;if(!n)return[];const i=n.findIndex((e=>"page"===(0,c().parseRoute)({url:e.fileUrl,isMobile:t.device.isMobile,baseUrl:w().A.domainBaseUrl,publicDomainName:w().A.publicDomainName,protocol:w().A.protocol,currentUrl:window.location.href}).name));if(-1===i)return n;return[n[i],...n.slice(0,i),...n.slice(i+1)]}({environment:i,attachments:a});return a&&l?(0,T.jsxs)("div",{style:s.container,children:[(0,T.jsx)(N,{attachment:l,attachmentIndex:0,onClick:n}),(0,T.jsx)(_,{attachments:d,onClickAttachment:n})]}):null}function N(e){let{attachment:t,attachmentIndex:n,menuListItemProps:c,onClick:d}=e;const{fileUrl:u,iconLink:v}=t,y=0===n,x=(0,o().IS)((e=>({button:{gap:4,flexShrink:1,...y?{maxWidth:`calc(100% + ${P+B}px)`}:{width:"100%"},...y&&E},title:{...y?{...(0,A().w_)(e),fontWeight:h().Wy.medium}:{maxWidth:200},...h().RC},icon:{height:16},linkIcon:{height:16,width:16,fill:e.mediumIconColor}})),[y]),I=(0,r().v3)(),w=(0,s().K8)((()=>{const{currentSpaceStore:e}=j().default.state;return F({environment:I,fileUrl:u,currentSpaceStore:e})}),[I,u]),k=(0,s().K8)((()=>{const e=null==w?void 0:w.getIcon();return w&&e?(0,T.jsx)(b().A,{icon:e,isEmptyPage:w.isEmptyPage(),size:16,disabled:!0}):v?(0,T.jsx)("img",{style:x.icon,src:v,alt:`Icon image for the Notion calendar event attachment entitled "${t.title}"`}):(0,l().w)(x.linkIcon)}),[t.title,w,v,x.icon,x.linkIcon]),M=w?(0,T.jsx)(S().A,{store:w,underline:y}):(0,T.jsx)("div",{style:x.title,children:t.title?t.title:(0,T.jsx)(g().lj,{textValue:[[t.fileUrl]]})}),C=(0,i.useCallback)((e=>{if(e.preventDefault(),!u)return;d({index:n,attachmentType:w?"notion":"other",attachmentBlockId:null==w?void 0:w.id});const t=e.metaKey||e.ctrlKey;w?m().VU({environment:I,openInNew:t?"tab":void 0,store:w,pageVisitSource:a().y8.PersonalHomeCalendarAttachment,peekMode:"center_peek",resultsStore:void 0,collectionContextStore:void 0}):p().f({environment:I,url:u})}),[n,w,I,u,d]);return(0,T.jsxs)(f().p,{style:x.button,href:u,metaHref:u,...c,onClick:C,children:[k,M]})}function _(e){let{attachments:t,onClickAttachment:n}=e;const i=(0,r().WS)(),s=(0,o().IS)((e=>({button:{color:e.mediumTextColor,...E,marginRight:0},sectionMenuItem:{display:"flex",flexDirection:"column",padding:4,width:"100%"}})),[]);return t&&0!==t.length?(0,T.jsx)(v().Ay,{alignmentToOrigin:M().C.Start,placementToOrigin:M().W.Bottom,renderOrigin:e=>(0,T.jsx)(f().p,{style:s.button,...e,children:(0,T.jsx)(u().sA,{id:"EventCalendarAttachments.plusMoreAttachments",defaultMessage:"+{numRemainingAttachments}",values:{numRemainingAttachments:t.length}})}),popupType:i?v().z7.SlideUp:v().z7.Popup,render:e=>(0,T.jsx)(y().A,{menuType:k().gu.Popup,maxWidth:300,children:(0,T.jsx)(x().Ay,{onAccept:e.close,type:x().Oh.Vertical,sections:[{key:"all",render:e=>(0,T.jsx)(I().A,{...e,style:s.sectionMenuItem}),items:t.map(((e,t)=>({key:e.fileUrl,render:i=>(0,T.jsx)(N,{menuListItemProps:i,attachment:e,attachmentIndex:t+1,onClick:n},e.fileUrl),action:()=>{}})))}],initialFocus:0})})}):(0,T.jsx)(T.Fragment,{})}function F(e){const{environment:t,currentSpaceStore:n}=e;let i=e.fileUrl;if(!n)return;w().A.isLocalhost&&(i=i.replace("dev.notion.so","localhost:3000").replace("https","http"));const r=(0,c().parseRoute)({url:i,isMobile:t.device.isMobile,baseUrl:w().A.domainBaseUrl,publicDomainName:w().A.publicDomainName,protocol:w().A.protocol,currentUrl:window.location.href}),s="page"===r.name?r.blockId:void 0;if(!s)return;const o=C().Bv.createChildStore(n,{table:d().ev,id:s});return o.load(),o.isReady()?o:void 0}const D=i.memo(R)},715011:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(296540),r=()=>n(959013),s=()=>n(409268),o=n(474848);function a(e){const t=(0,i.useMemo)((()=>(0,s().s)(e.store)),[e.store]);return(0,o.jsx)(r().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},810072:(e,t,n)=>{n.r(t),n.d(t,{default:()=>tt});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(823215),n(354520),n(803949),n(581454),n(737550);var i=()=>n(392890),r=n(296540),s=()=>n(484714),o=()=>n(56366),a=()=>n(401497),l=()=>n(584262),c=()=>n(921940),d=()=>n(416504),u=()=>n(187174),h=()=>n(529324),p=()=>n(356596),m=()=>n(38679),g=()=>n(340498),f=n(474848);const v={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M12.207 18.678a1.91 1.91 0 0 1-2.33-.838l-.348-.715c-.177-.293-.36-.658-.535-1.005l-.13-.257c-.225-.442-.431-.822-.627-1.08l-2.164-2.306h-2.41a1.6 1.6 0 0 1-1.6-1.6V5.74a1.6 1.6 0 0 1 1.6-1.6H6.97l1.227-.42.021-.011a5.2 5.2 0 0 1 2.347-.553h4.309a1.844 1.844 0 0 1 1.78 2.32c.554.318.922.918.922 1.6 0 .284-.067.547-.18.78.333.327.54.782.54 1.297 0 .429-.145.817-.388 1.124.17.27.271.592.271.943a1.844 1.844 0 0 1-1.843 1.844h-3.783c.069.167.15.33.242.516v.001c.14.28.302.608.416 1.004l.001.002.507 1.774a1.913 1.913 0 0 1-1.144 2.315zm-1.567-2.126.345.71a.66.66 0 0 0 .781.247.66.66 0 0 0 .393-.804l-.507-1.773v-.001c-.08-.276-.195-.512-.336-.797l-.014-.028a6 6 0 0 1-.408-.97 1.03 1.03 0 0 1 .988-1.323h4.095a.594.594 0 0 0 .593-.594.56.56 0 0 0-.27-.47.625.625 0 0 1 .066-1.086.56.56 0 0 0 .322-.511.58.58 0 0 0-.4-.55.625.625 0 0 1-.191-1.074.59.59 0 0 0 .23-.453.586.586 0 0 0-.584-.594.625.625 0 0 1-.452-1.057.594.594 0 0 0-.416-1.02h-4.31c-.593 0-1.17.13-1.703.381a.6.6 0 0 1-.161.083l-1.424.488a.6.6 0 0 1-.202.033h-.181v6.136l2.275 2.425.037.043c.286.367.547.86.772 1.303l.147.29a13 13 0 0 0 .515.966m-4.846-5.324v-5.84H3.663a.35.35 0 0 0-.35.35v5.139c0 .193.156.35.35.35z"})},y=(0,g().wt)("handThumbsDown",v);const x={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M12.207 1.322a1.91 1.91 0 0 0-2.33.838l-.348.715c-.177.292-.36.658-.535 1.005l-.13.257c-.225.442-.431.822-.627 1.08L6.073 7.521h-2.41a1.6 1.6 0 0 0-1.6 1.6v5.139a1.6 1.6 0 0 0 1.6 1.6H6.97l1.227.42.021.01c.73.366 1.528.554 2.347.554h4.309a1.844 1.844 0 0 0 1.78-2.32c.554-.318.922-.918.922-1.6 0-.284-.067-.547-.18-.78.333-.327.54-.782.54-1.297a1.8 1.8 0 0 0-.388-1.124c.17-.27.271-.592.271-.943a1.844 1.844 0 0 0-1.843-1.844h-3.783c.069-.167.15-.33.242-.516a6 6 0 0 0 .416-1.004l.001-.002.507-1.774a1.913 1.913 0 0 0-1.144-2.315zM10.64 3.449l.345-.71a.66.66 0 0 1 .781-.248c.32.128.488.471.393.804l-.507 1.773v.001c-.08.276-.195.512-.336.797l-.014.028c-.134.27-.292.59-.408.97a1.03 1.03 0 0 0 .988 1.323h4.095c.327 0 .593.267.593.594a.56.56 0 0 1-.27.47.625.625 0 0 0 .066 1.086.56.56 0 0 1 .322.511.58.58 0 0 1-.4.55.625.625 0 0 0-.191 1.074c.149.122.23.285.23.453a.586.586 0 0 1-.584.594.625.625 0 0 0-.452 1.057.594.594 0 0 1-.416 1.02h-4.31c-.593 0-1.17-.13-1.703-.381a.6.6 0 0 0-.161-.083l-1.424-.488a.6.6 0 0 0-.202-.033h-.181V8.475L9.169 6.05l.037-.043c.286-.367.547-.86.772-1.303l.147-.29a13 13 0 0 1 .515-.965M5.794 8.772v5.839H3.663a.35.35 0 0 1-.35-.35V9.122a.35.35 0 0 1 .35-.35z"})},b=(0,g().wt)("handThumbsUp",x);var S=()=>n(799384),I=()=>n(349348),w=()=>n(992437),A=()=>n(386164),k=()=>n(450648),M=()=>n(620333),j=()=>n(245241),C=()=>n(175947),T=()=>n(959013),P=()=>n(496603),B=()=>n(284371),E=()=>n(449506),R=()=>n(705540),N=()=>n(12831),_=()=>n(839752),F=()=>n(725614),D=()=>n(36951),K=()=>n(985554),U=()=>n(186445),O=()=>n(728611),L=()=>n(751380),V=()=>n(847743),q=()=>n(792540),z=()=>n(148777),W=()=>n(825972),H=()=>n(658883),Q=()=>n(531770),G=()=>n(135599),$=()=>n(508496);class Y extends(()=>n(757695))().default{getInitialState(){return{pageIdToUsers:{},similarUserIdToLastVisitedPageId:{}}}getPageIdToActiveSimilarUsersCount(){const e={};for(const[t,i]of(0,n(534177).WP)(this.state.pageIdToUsers))e[t]=(null==i?void 0:i.length)??0;return e}}const X=new Y;var Z=()=>n(866515);const J=6e4;function ee(e){return Date.now()-e.timestamp>=e.numberOfMinutes*J}var te=()=>n(963589),ne=()=>n(857437),ie=()=>n(573985),re=()=>n(631818),se=()=>n(677169),oe=()=>n(158751),ae=()=>n(379560),le=()=>n(962730),ce=()=>n(756279),de=()=>n(351360),ue=()=>n(430483),he=()=>n(982254),pe=()=>n(970585),me=()=>n(786601),ge=()=>n(24157),fe=()=>n(10722),ve=()=>n(122058),ye=()=>n(760217),xe=()=>n(364280),be=()=>n(285790),Se=()=>n(805751),Ie=()=>n(939740),we=()=>n(957986),Ae=()=>n(460292),ke=()=>n(14235),Me=()=>n(128295),je=()=>n(2143),Ce=()=>n(228927),Te=()=>n(89924),Pe=()=>n(859428),Be=()=>n(42425),Ee=()=>n(246722),Re=()=>n(126126),Ne=()=>n(896278),_e=()=>n(90612),Fe=()=>n(913441);const De=7,Ke=20,Ue=(0,P().sg)(ve().nT,75);const Oe={padding:"4px 8px"};function Le(){var e;const t=(0,s().v3)(),n=(0,T().tz)(),p=(0,o().O$)(me().A),m=(0,o().K8)((()=>de().default.state.currentSpaceStore),[]),g=(0,V().AI)({initialValue:[]}),{queryTextValue:v,query:y}=(0,o().K8)((()=>{var e;if(!m)return{queryTextValue:[],query:""};const i="deep_dive"===p.surface?null===(e=p.query)||void 0===e?void 0:e.store:null==g?void 0:g.store,r=(null==i?void 0:i.getValue())??[];return{queryTextValue:r,query:(0,k().r4)({intl:n,textValue:r,userTimeZone:(0,d().P)(),deterministic:!1,disableAnnotationPrefix:!0,disableInsertedAnnotations:!1,getRecordModel:w().b.fromGetRecordValueFn(t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(t.currentUser.id))})}}),[m,p.surface,null===(e=p.query)||void 0===e?void 0:e.store,null==g?void 0:g.store,n,t.defaultRecordCache.inMemoryRecordCache,t.currentUser.id]),x=(0,r.useRef)(!0);(0,r.useEffect)((()=>{if("default"!==p.surface)return;p.isOpen&&x.current?(x.current=!1,me().A.update((e=>({...e,openedTimeMs:Date.now(),query:g}))),F().setSelectionAtEnd({store:g.store})):x.current=!0}),[p.isOpen,g,g.store,p.surface]);const b=(0,o().K8)((()=>"on"===$().default.getEligibleGroup({experimentId:"search_quickfind_prefetch"})),[]),B=0===y.trim().length,{results:L,searchSessionId:z,searchSessionFlowNumber:Y,isResultsLoading:X,searchAnalytics:J}=(0,G().W)({searchQuery:y,limit:De,source:"mini_quick_find",type:j().Vz.BlocksInSpace,disable:B,isLocalOnlyMode:!1,isTitleOnly:!0,usePrefetch_EXPERIMENTAL:b,overrideSearchSessionId:p.sessionId}),ee=(0,r.useRef)(Date.now());(0,r.useEffect)((()=>{!B&&m&&(Ue({searchSessionId:z,results:L.map((e=>({id:e.store.id,source:e.localSource?"local":"server"}))),searchSessionFlowNumber:Y,queryLength:y.length,queryWords:y.split(" ").length,timeToResult:Date.now()-ee.current,environment:t,query:v,spaceStore:m}),ee.current=Date.now())}),[L,z]);const[ye,xe]=(0,r.useState)("recents"),be=(0,r.useMemo)((()=>(0,M().mk)({searchSessionId:z,searchSessionFlowNumber:Y})),[z,Y]),Me=(0,o().K8)((()=>p.isNewElectronTab),[p.isNewElectronTab],{debugName:"MiniSearch.isNewElectronTab"}),Pe=(0,o().K8)((()=>he().A.state.tabs),[],{debugName:"MiniSearch.electronTabs"}),Re=(0,o().K8)((()=>{if(0===y.length)return[];return(0,Q().wn)({query:y,environment:t,searchMode:"nav-local-only"})??[]}),[t,y],{debugName:"MiniSearch.matchingActions"}),Fe=(0,r.useCallback)((e=>{var n;const i=null===(n=me().A.state.previousTextSelection)||void 0===n?void 0:n.multiSelection;(0,ve().yM)({openedTimeMs:p.openedTimeMs??0,searchSessionId:p.sessionId??"",environment:t}),e.shouldResetQuery&&g.setValue([]),me().A.update((t=>({...t,isOpen:!1,isNewElectronTab:!1,openedTimeMs:e.shouldResetMetricsState?void 0:t.openedTimeMs,sessionId:e.shouldResetMetricsState?void 0:t.sessionId,previousTextSelection:void 0}))),ot(!1),rt(!1),nt(Ke),i&&"editing"!==ge().default.state.mode&&ge().default.setState({forceExtendAnnotations:{},mode:"editing",multiSelection:i})}),[t,p.openedTimeMs,p.sessionId,g]),Le=(0,r.useCallback)((e=>(0,Ne().g)({environment:t,result:e,action:()=>Fe({shouldResetQuery:!0,shouldResetMetricsState:!1}),queryId:be,isMiniSearch:!0,desktopProps:{electronTabs:Pe,isNewElectronTabSearch:Boolean(Me)},buttonStyles:Oe})),[Fe,Pe,t,Me,be]),qe=(0,r.useMemo)((()=>{const e=[];return Re.forEach((t=>{const{eventName:n}=t;"full_search"!==n&&"full_search_deep_dive"!==n&&"deep_dive"!==n&&e.push(Le(t))})),e}),[Le,Re]),ze=(0,o().K8)((()=>"default"===p.surface&&"center"===p.position),[p]),We=function(){const e=(0,s().v3)(),[t,n]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),c=(0,se().m)(),d=(0,o().K8)((()=>ae().A.getEvents()),[]),h=(0,o().K8)((()=>de().default.state.currentSpaceStore),[]),p=(0,o().K8)((()=>de().default.state.currentSpaceViewStore),[]);(0,u().Yb)((async()=>{if(!c.botId||t)return;const i="two_days",r=(0,oe().B7)(i),s=await(0,ie().qq)({environment:e,currentSpaceViewStore:p,forceRefetch:!1,reason:"background_load",botId:c.botId,timeRange:{key:i,...r}});"success"!==s&&"skipped"!==s||n(!0)}),[c.botId,p,e,t]);const m=(0,r.useCallback)((()=>{const e=Date.now();return d.filter((t=>{var n;if(t.isAllDay||"declined"===t.responseStatus)return!1;const r=new Date(t.end.dateTime),s=(0,i().A)(r,5);return((null===(n=t.attachments)||void 0===n?void 0:n.length)??0)>0&&s.getTime()>=e}))}),[d]);(0,Z().n)((()=>{const e=m(),t=e.map((e=>e.id)),n=a.map((e=>e.id));(0,P().R9)(t,n).length>0&&l(e)}),12e4,t);const g=2,f=(0,o().K8)((()=>{const t=[];for(const n of a){const{attachments:i}=n;if(t.length===g)break;const r=(0,P().oE)(null==i?void 0:i.map((t=>{const n=t.fileUrl;return(0,re().x)({environment:e,fileUrl:n,currentSpaceStore:h})}))),s=r.length>0?r[0]:void 0;s&&!t.includes(s)&&t.push(s)}return t}),[a,e,h]);return f}(),He=(0,o().K8)((()=>(0,U().ao)()),[]),Ge=(0,o().K8)((()=>{var e;return null===(e=de().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),$e=(0,o().K8)((()=>{var e;return null===(e=de().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),[tt,nt]=(0,r.useState)(Ke),[it,rt]=(0,r.useState)(!1),[st,ot]=(0,r.useState)(!1),at=(0,o().K8)((()=>W().NK.state.filter((e=>e.pageId!==(null==He?void 0:He.id)&&!We.some((t=>t.id===e.pageId)))).slice(0,tt-We.length)),[null==He?void 0:He.id,tt,We]),lt=(0,r.useCallback)((e=>{Ge&&(0,_e().fQ)({environment:t,offsetFromBottom:e,spaceId:Ge,setIsLoadingRecents:rt,setEndOfRecentsReached:ot,numRecents:tt,setNumRecents:nt,endOfRecentsReached:st,isLoadingRecents:it,incrementBy:Ke})}),[st,t,it,tt,Ge]),ct=l().y8.MiniQuickFind,dt=(0,r.useMemo)((()=>"results"===ye?"query_results":"recent_pages"),[ye]),ut=(0,o().K8)((()=>t.device.isElectron),[t]),ht=(0,o().K8)((()=>(0,H().q)(t)),[t]),pt=(0,te().X)("quick_find_highlights_enabled"),mt=(0,r.useCallback)((e=>{const n=e.store;return{action:i=>{let{event:r}=i;const s=(0,O().Vr)(r);if(J.trackSelectSearchItem({result:e,isMetaClick:Boolean(s),context:dt}),s||Fe({shouldResetQuery:!0,shouldResetMetricsState:!1}),ut&&ht){const e=(0,c().A)({pageModel:n.getModel(),pageId:n.id,pageVisitSource:ct,queryId:be});R().openQuickSearchResult(e)}else _().q9({searchResult:{type:"custom",store:n},environment:t,pageVisitSource:ct,queryId:be,openInNew:s,electronTabSearch:{tabs:Pe,isNewTab:Boolean(Me)},context:dt})},key:n.id,render:t=>(0,f.jsx)(Qe,{...t,store:n,currentView:ye,result:e,highlight:pt?e.highlight:void 0})}}),[Fe,dt,Pe,t,ht,ut,Me,ct,J,be,ye,pt]),gt=(0,o().K8)((()=>L.map((e=>mt(e)))),[mt,L],{debugName:"MiniSearch.resultItems"}),ft=(0,o().K8)((()=>{const e=new Map;return at.forEach(((t,n)=>{const i=(0,W().ht)(t.visitedAt),r=Ve({blockStore:t.store,idx:n,resultFeatureNames:["RECENT_ALIVE_PAGES"]}),s=mt(r);var o;e.has(i)?null===(o=e.get(i))||void 0===o||o.push(s):e.set(i,[s])})),e}),[mt,at],{debugName:"MiniSearch.resultsByBucket"}),vt=(0,r.useMemo)((()=>{const e=[...qe,...gt];if(0!==e.length)return{items:e,key:"results",render:e=>(0,f.jsx)(Te().A,{...e,title:n.formatMessage(Je.quickMatchesSectionTitle)})}}),[n,qe,gt]),yt=(0,te().X)("unified_find_use_inferencetranscript_deep_find"),xt=(0,r.useCallback)((async e=>{Fe({shouldResetQuery:!0,shouldResetMetricsState:!1}),yt?(0,D().Ak)({environment:t,query:v,clientStore:K().K}):await fe().oZ({environment:t,menuListItemAction:e.menuListItemAction,queryTextValue:v,isNewElectronTab:Me,searchSessionId:z,surface:p.surface})}),[Fe,t,Me,p.surface,v,z,yt]),bt=(0,r.useCallback)((async e=>{Fe({shouldResetQuery:!0,shouldResetMetricsState:!1}),await N().Lv({environment:t,menuListItemAction:e.menuListItemAction,intl:n,queryTextValue:v,isNewElectronTab:Me,searchSessionId:z,surface:p.surface})}),[Fe,t,n,Me,p.surface,v,z]),St=(0,o().K8)((()=>{const e=function(e){const{onClick:t}=e;return{action:t,key:"deep-find-entry-point",render:e=>(0,f.jsx)(Xe,{menuListProps:e,title:(0,f.jsx)(T().sA,{...Je.deepFindTitle}),subtitle:(0,f.jsx)(T().sA,{...Je.deepFindSubtitle}),renderIcon:e=>(0,S().o)(e)})}}({onClick:e=>xt({menuListItemAction:e})}),t=[e];if(ue().zD.isResearchModeUnifiedFindEnabled()&&!Me&&y.includes(" ")){const e=function(e){const{onClick:t}=e;return{action:t,key:"research-mode-entry-point",render:e=>(0,f.jsx)(Xe,{menuListProps:e,title:(0,f.jsx)(T().sA,{...Je.researchModeTitle}),subtitle:(0,f.jsx)(T().sA,{...Je.researchModeSubtitle}),renderIcon:e=>(0,f.jsx)(Ze,{styles:e})})}}({onClick:e=>bt({menuListItemAction:e})});t.push(e)}return{items:t,key:"search",render:e=>(0,f.jsx)(Te().A,{...e})}}),[xt,bt,y,Me]),It=(0,r.useMemo)((()=>{if(Me)return(0,_e().mD)({environment:t,intl:n,electronTabs:Pe,isNewElectronTab:Me})}),[t,n,Me,Pe]),wt=(0,o().K8)((()=>{const e=[];if(It&&e.push({items:[It],key:"new-page",render:e=>(0,f.jsx)(Te().A,{...e})}),We.length>0){const t=We.map(((e,t)=>Ve({blockStore:e,idx:t,resultFeatureNames:["UPCOMING_MEETING_ATTACHMENTS"]})));e.push({items:t.map(mt),key:"upcoming-meeting-attachments",render:e=>(0,f.jsx)(Te().A,{...e,title:n.formatMessage(Je.fromCalendarEvents)})})}return W().Rj.forEach((t=>{const n=ft.get(t);n&&0!==n.length&&e.push({items:n,key:`recent-pages-${t}`,render:e=>(0,f.jsx)(Te().A,{...e,title:(0,f.jsx)(_e().sg,{bucket:t})})})})),e}),[mt,n,It,We,ft]),At=(0,r.useMemo)((()=>{const e=[St];return vt&&e.push(vt),e}),[vt,St]),kt=(0,r.useMemo)((()=>new(pe().A)),[]),Mt=(0,r.useCallback)((e=>{kt.setState({focus:{section:e.section??0,indexLocal:e.indexLocal,indexGlobal:e.indexGlobal,footerFocused:!1}})}),[kt]),jt=L.length>0;(0,r.useEffect)((()=>{xe(B?"recents":"results");const e=kt.state.focus,t=St.items.length;e&&0===e.section&&e.indexGlobal<t||Mt({indexLocal:0,indexGlobal:0,section:0})}),[Mt,B,jt,kt,St.items.length]),(0,r.useEffect)((()=>{p.isOpen&&Ge&&(E().callApi({eventName:"warmSearchCache",environment:t,data:{spaceId:Ge}}),E().callApi({eventName:"warmVectorDBCache",environment:t,data:{spaceId:Ge},headers:(0,A().WS)({spaceId:Ge})}))}),[p.isOpen,t,Ge]);const Ct=(0,r.useCallback)((e=>{0===y.trim().length&&xe("recents")}),[y]),Tt=!B&&"default"===p.surface&&0===L.length&&0===qe.length&&"results"===ye&&!X,Pt=function(e){const{shouldUseCenterModal:t,isElectron:n}=e,i=(0,s().v3)(),{isDeepDive:l,isSidebarPosition:c}=(0,o().K8)((()=>{const e=me().A.state;return{isDeepDive:"deep_dive"===e.surface,isSidebarPosition:"default"===e.surface&&"sidebar"===e.position}}),[]),d=(0,r.useMemo)((()=>n?(0,C().ek)(i.device.isElectronMac)-8:void 0),[i.device.isElectronMac,n]);return(0,a().IS)((e=>{const i=c?500:400;return{searchIcon:{color:e.mediumIconColor,width:25,height:25,marginLeft:4,marginRight:4},input:{margin:"10px 10px",width:"auto",fontSize:14},container:{width:t?600:l?"100%":420,display:"flex",flexDirection:"column"},scroller:{width:"100%",minHeight:l?0:i,maxHeight:i,position:"relative",display:"flex",flexDirection:"column"},popup:{marginTop:c&&n?d:0}}}),[c,t,l,n,d])}({shouldUseCenterModal:ze,isElectron:ut}),Bt=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",margin:10,gap:8},placeholder:{cursor:"text"},input:{maxHeight:100,overflow:"scroll"}})),[]),Et=(0,te().X)("unified_find_input_at_mentions"),[Rt,Nt]=(0,ne().$)(),_t=(0,r.useMemo)((()=>{if("deep_dive"===p.surface)return null;const e={placeholder:n.formatMessage(Me?Je.openInNewTabPlaceholder:Je.defaultInputPlaceHolder),left:Me?(0,I().Y)(Pt.searchIcon):(0,S().o)(Pt.searchIcon)};return(0,f.jsx)(Se().A,{capture:!0,debugName:"MiniSearch",children:(0,f.jsxs)("div",{style:Bt.container,children:[(0,f.jsx)(Ae().Q,{iconGroup:h().C,variantName:"default",colorName:"tertiary",style:Pt.searchIcon}),(0,f.jsx)(Ee().A,{...Rt,placeholder:e.placeholder,onClick:void 0,disabled:!1,store:g.store,inPageFind:q().Os.none,pasteBehavior:"inline",placeholderStyle:Bt.placeholder,disableUpDownArrows:!0,disableSlashCommands:!0,disableMobileActionBar:!0,disableEmbedMenu:!0,disableInsertedDeletedAnnotations:!0,disableEmojiCommands:!1,disableMentions:!Et,disableComment:!0,style:Bt.input,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!0,disableStyleAnnotations:!0,disableSuggestEdit:!0,onChange:Ct,onEsc:()=>Fe({shouldResetQuery:!1,shouldResetMetricsState:!0})})]})})}),[p.surface,n,Me,Pt.searchIcon,Bt.container,Bt.placeholder,Bt.input,Rt,g.store,Et,Ct,Fe]),Ft=(0,r.useMemo)((()=>{if(Ge&&$e&&z)return{space_id:Ge,user_id:$e,search_session_id:z,search_session_flow_number:Y,results:L.map((e=>({...e,store:void 0,serverEventProperties:void 0}))),query:v}}),[Ge,$e,z,Y,L,v]),Dt=(0,o().K8)((()=>(0,f.jsxs)("div",{style:Pt.container,children:[_t,(0,f.jsxs)(je().H,{type:ce().A.Y,style:Pt.scroller,children:[(0,f.jsx)(Ie().Ay,{comboboxProps:Nt,type:Ie().Oh.Vertical,initialFocus:0,sections:"recents"===ye?wt:At,disableKeyboardArrowWrap:!0,store:kt}),Tt?(0,f.jsx)(et,{}):null,"recents"===ye?(0,f.jsx)(Ce().A,{onChange:lt}):null]}),(0,f.jsx)(Ye,{searchSessionFlowNumber:Y,quickFindFeedbackPayload:Ft,currentView:ye})]})),[Pt.container,Pt.scroller,_t,Nt,ye,wt,At,kt,Tt,lt,Y,Ft]);return ze?(0,f.jsx)(we().A,{open:p.isOpen,onDismiss:()=>Fe({shouldResetQuery:!1,shouldResetMetricsState:!0}),render:()=>Dt,transitionAppearance:"none",isWaxPaper:!0,backgroundStyle:{background:"transparent"},innerStyle:{width:"max-content",height:"max-content"},style:{display:"flex",alignItems:"center"}}):(0,f.jsx)(ke().Ay,{open:p.isOpen,popupType:ke().nl.Popup,originRect:"deep_dive"===p.surface?p.domRect:void 0,sameWidthAsOrigin:"deep_dive"===p.surface,style:Pt.popup,placementToOrigin:le().W.Bottom,alignmentToOrigin:Be().C1.Start,keepFocus:"deep_dive"===p.surface,disableMouseCapture:"deep_dive"===p.surface,preventCaptureEsc:"deep_dive"===p.surface,render:()=>Dt,onDismiss:()=>Fe({shouldResetQuery:!1,shouldResetMetricsState:!0}),trapFocus:!0},p.surface)}function Ve(e){const{blockStore:t,idx:n,resultFeatureNames:i}=e;return{id:t.id,score:0,spaceId:t.getSpaceId(),sources:[j().Ni.Local],featureGroups:i?[{groupName:"custom",features:i.map((e=>({name:e,value:1})))}]:[],store:t,originalPosition:n,localSource:new Set,serverEventProperties:void 0}}function qe(e){const{spaceStore:t,similarUsers:i,isUserPresentOnPage:r}=e;if(!t)return[];return[...i].sort(((e,t)=>{const n=r({userId:e.userId,visitedAt:e.visitedAt});return n!==r({userId:t.userId,visitedAt:t.visitedAt})?n?-1:1:t.visitedAt-e.visitedAt})).slice(0,4).map((e=>{const i=n(870092).L.createChildStore(t,{table:n(798880).oo,id:e.userId});return i.load(),{store:i,visitedAt:e.visitedAt,isPresent:r({userId:e.userId,visitedAt:e.visitedAt})}}))}function ze(e){const{store:t,pathHighlight:n,styles:i}=e,r=(0,L().PO)({words:(0,L().oQ)(n),styleOverride:i.pathHighlight});return(0,f.jsx)(Me().Ay,{store:t,showFullPathInTooltip:!0,highlighter:r})}function We(e){const{store:t,intl:i,pathDisplay:s,styles:a}=e,l=(0,o().K8)((()=>(0,n(819493).b)(t)),[t]),c=[s,(0,o().K8)((()=>{if(null==l||!l.canAccess)return;const e=(0,n(764880).lR)(i,l.createdBy);return(0,f.jsx)("span",{style:a.pathText,children:e})}),[l,a.pathText,i]),(0,o().K8)((()=>{const e=t.getLastEditedTime();if(e)return(0,f.jsx)("span",{style:a.pathText,children:(0,f.jsx)(T().sA,{...Je.lastEdited,values:{time:(0,n(907514).nl)(e,{useCompactFormat:!0})}})})}),[t,a.pathText])].filter(Boolean);return(0,f.jsx)(xe().fI,{gap:4,children:c.map(((e,t)=>(0,f.jsxs)(r.Fragment,{children:[t>0&&(0,f.jsx)("span",{style:a.pathText,children:"•"}),e]},t)))})}function He(e){const{badges:t,store:i,highlight:s,recordPathCaption:l}=e,c=(0,T().tz)(),d=(0,a().IS)((e=>({databaseIcon:{color:e.text.secondary,width:14,height:14},verifiedIcon:{width:15,height:15,color:e.blueColor},divider:{color:e.text.secondary,fontSize:12},title:{fontWeight:B().Wy.medium},titleHighlight:{color:e.text.uiBluePrimary,background:e.tint.uiBlue}})),[]),u=(0,L().PO)({words:(0,L().oQ)((null==s?void 0:s.title)??(null==s?void 0:s.text)),styleOverride:d.titleHighlight}),h=(0,o().K8)((()=>(0,f.jsx)(n(16006).A,{store:i,style:d.title,highlighter:u})),[i,u,d.title]),p=(0,r.useMemo)((()=>new Set(t.map((e=>e.type)))),[t]);return(0,f.jsxs)(xe().fI,{gap:4,alignItems:"center",children:[h,p.has("is_collection")?(0,n(648403).H)(d.databaseIcon):void 0,p.has("verified")?(0,n(943882).w)(d.verifiedIcon):void 0,p.has("is_template")?(0,f.jsx)(Fe().rx,{label:c.formatMessage(j().Nz.template)}):void 0,p.has("popular_this_week")?(0,f.jsx)(Fe().oj,{label:c.formatMessage(j().Nz.popularThisWeek)}):void 0,p.has("most_viewed")?(0,f.jsx)(Fe().iY,{label:c.formatMessage(j().Nz.mostViewed)}):void 0,l?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{style:d.divider,children:"—"}),l]}):void 0]})}const Qe=r.memo(r.forwardRef((function(e,t){const{store:i,focused:s,currentView:l,highlight:c,result:d}=e,u=(0,T().tz)(),h=(0,a().IS)((e=>({enterIcon:{width:12,height:12,color:e.text.secondary,display:s?"block":"none"},divider:{color:e.text.tertiary},pathHighlight:{color:e.text.uiBluePrimary,background:e.tint.uiBlue},pathText:{color:e.lightTextColor}})),[s]),m=(0,o().K8)((()=>(0,Me().a6)(i)),[i]),g=(0,o().K8)((()=>{if(m)return(0,f.jsx)(ze,{store:i,pathHighlight:null==c?void 0:c.pathText,styles:h})}),[i,c,h,m]),v=(0,o().K8)((()=>de().default.state.currentSpaceStore),[]),y=(0,o().K8)((()=>i.id),[i]),x=(0,o().K8)((()=>X.state.pageIdToUsers[y]??[]),[y]),b=(0,o().K8)((()=>i.getIcon()),[i]),S=(0,o().K8)((()=>i.isEmptyPage()),[i]),I=(0,o().K8)((()=>(0,f.jsx)(n(614505).A,{disabled:!0,icon:b,isEmptyPage:S,size:20})),[b,S]),w=(0,o().K8)((()=>X.state.similarUserIdToLastVisitedPageId),[]),A=(0,r.useCallback)((e=>function(e){return!ee({timestamp:e.timestamp,numberOfMinutes:2})}({timestamp:e.visitedAt})&&w[e.userId]===y),[w,y]),k=(0,o().K8)((()=>qe({spaceStore:v,similarUsers:x,isUserPresentOnPage:A})),[A,x,v]),M=(0,o().K8)((()=>k.every((e=>e.store.isReady()))),[k]),j=(0,r.useMemo)((()=>{if(!M)return null;const e=k.length;return(0,f.jsx)("div",{style:{display:"flex"},children:k.map(((t,n)=>{let{store:i,visitedAt:r,isPresent:s}=t;return(0,f.jsx)("span",{style:{zIndex:e-n},children:(0,f.jsx)(Ge,{userStore:i,isPresent:s})},`search-user-presence-${i.id}-${y}-${r}`)}))})}),[M,y,k]),C=(0,r.useMemo)((()=>(0,f.jsxs)(xe().fI,{gap:12,alignItems:"center",children:[j,(0,f.jsx)("div",{children:(0,p().K)(h.enterIcon)})]})),[j,h.enterIcon]),P="recents"===l,B=(0,o().K8)((()=>!P&&(i.isType("link_to_collection")||i.isType("collection_view_page")||i.isType("collection_view"))),[P,i]),E=(0,r.useMemo)((()=>{var e;const t=d.badges??[];return Boolean(null===(e=d.localSource)||void 0===e?void 0:e.has("topPages7dPageView"))&&t.push({type:"popular_this_week",properties:{},label:"Popular this week"}),B&&t.push({type:"is_collection",properties:{},label:"Collection"}),t}),[B,d.badges,d.localSource]);return(0,f.jsx)(ye().A,{style:{paddingLeft:4},...e,ref:t,buttonStyle:Oe,title:(0,f.jsx)(He,{badges:E,store:i,highlight:c,recordPathCaption:P&&g?g:void 0}),caption:P?void 0:(0,f.jsx)(We,{store:e.store,intl:u,pathDisplay:g,styles:h}),icon:I,right:C,className:"notranslate"})})));function Ge(e){const{userStore:t,isPresent:i}=e,r=(0,T().tz)(),s=(0,Re().XE)((e=>(0,n(100622).Nq)(t.id,e)),i),{name:l,email:c}=(0,o().K8)((()=>({name:(0,n(695608).c6)(r,t.getModel()),email:t.getEmail()})),[r,t]),d=(0,a().IS)((e=>({avatarOuterOutline:{...s.avatarOuterOutline,outlineColor:i?s.avatarOuterOutline.outlineColor:e.accentColors.gray[100]}})),[i,s.avatarOuterOutline]);return(0,f.jsx)(Pe().A,{textWrap:!0,renderTooltip:()=>(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:l}),(0,f.jsx)("div",{children:c})]}),render:e=>(0,f.jsx)("div",{style:d.avatarOuterOutline,...e,children:(0,f.jsx)("div",{style:s.avatarBorder,children:(0,f.jsx)(n(453697).A,{iconStyle:s.avatarInnerOutline,style:s.uiUserAvatarStyles,size:Re().eQ,isOffline:!i,userStore:t,avatarShouldShowShadow:!0,initialOverrideStyle:s.initialColor})})})})}function $e(e){var t,i,l,c;const d=(0,s().v3)(),u=(0,T().tz)(),h=(0,o().K8)((()=>(0,z().PE)({environment:d})),[d]),p=(0,r.useCallback)((async()=>{const e=await n(884107).R.clipboardActions.load();await e.copyString({environment:d,stringValue:JSON.stringify({cacheStats:h,readinessTimings:(0,z().Yp)()},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}),[h,d]),m=(0,a().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:4},devMessage:{color:e.text.secondary},indexBuilding:{color:e.text.tertiary,fontSize:12,display:"flex"}})),[]),g=(0,r.useMemo)((()=>{var e,t,n,i;return(0,f.jsxs)(xe().VP,{gap:8,children:[h.localSearchableBlocksCacheLoaded&&(0,f.jsxs)(xe().VP,{gap:2,children:[(0,f.jsx)("div",{children:`Pages: ${h.localSearchableBlocksCacheSize} `}),(0,f.jsx)("div",{children:`Recents: ${null===(e=h.localSearchableBlocksCacheBlockSourceCount)||void 0===e?void 0:e.recentVisit}`}),(0,f.jsx)("div",{children:`Frecency: ${null===(t=h.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.frecencyStore}`}),(0,f.jsx)("div",{children:`Similar: ${null===(n=h.localSearchableBlocksCacheBlockSourceCount)||void 0===n?void 0:n.similarUser1dRecentPages}`}),(0,f.jsx)("div",{children:`Popular: ${null===(i=h.localSearchableBlocksCacheBlockSourceCount)||void 0===i?void 0:i.topPages7dPageView}`})]}),!h.hasPersistedRecordCache&&(0,f.jsx)("div",{children:"NO RECORD CACHE"}),(0,f.jsx)("div",{style:m.devMessage,children:"[Dev] Click to copy index metadata"})]})}),[h.hasPersistedRecordCache,null===(t=h.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.frecencyStore,null===(i=h.localSearchableBlocksCacheBlockSourceCount)||void 0===i?void 0:i.recentVisit,null===(l=h.localSearchableBlocksCacheBlockSourceCount)||void 0===l?void 0:l.similarUser1dRecentPages,null===(c=h.localSearchableBlocksCacheBlockSourceCount)||void 0===c?void 0:c.topPages7dPageView,h.localSearchableBlocksCacheLoaded,h.localSearchableBlocksCacheSize,m.devMessage]),v=h.localSearchableBlocksCacheLoaded;return(0,r.useMemo)((()=>(0,f.jsx)(Pe().A,{placement:le().W.Bottom,renderTooltip:()=>g,render:e=>(0,f.jsxs)(xe().fI,{gap:8,alignItems:"center",children:[(0,f.jsx)(be().A,{...e,style:m.buttonContainer,iconStyle:{height:15,width:15},icon:n(359545).d,onClick:p,ariaLabel:u.formatMessage(Je.copySearchIndexReadiness)}),v?null:(0,f.jsx)("div",{style:m.indexBuilding,children:(0,f.jsxs)(xe().fI,{gap:4,alignItems:"center",children:[(0,f.jsx)(n(331542).A,{style:{height:12,width:12}}),"Building..."]})})]})})),[p,g,v,m.buttonContainer,m.indexBuilding,u])}const Ye=r.memo((function(e){const{searchSessionFlowNumber:t,quickFindFeedbackPayload:i,currentView:o}=e,l=(0,T().tz)(),c=(0,a().IS)((e=>({container:{padding:"6px 8px",color:e.text.secondary,display:"flex",justifyContent:"space-between",borderTop:`1px solid ${e.lightDividerColor}`,marginTop:1},button:{fontSize:13,gap:4,paddingLeft:10,color:e.text.grayTertiary},icon:{width:12,height:12}})),[]),d=(0,s().v3)(),[u,h]=(0,r.useState)(!1);(0,r.useEffect)((()=>{m(void 0)}),[t,o]);const[p,m]=(0,r.useState)(void 0),g=(0,r.useCallback)((async()=>{i&&(m("thumbsUp"),await(0,fe().Tk)({environment:d,feedback:"thumbsUp",quickFindFeedbackPayload:i}))}),[d,i]),v=(0,r.useCallback)((async()=>{i&&(m("thumbsDown"),h(!0),await(0,fe().Tk)({environment:d,feedback:"thumbsDown",quickFindFeedbackPayload:i}))}),[d,i]),x=(0,r.useCallback)((async e=>{i&&await fe().d7({environment:d,quickFindFeedbackPayload:{...i,additional_information:e.additionalInformation,desired_result_url:e.desiredUrl,can_followup_with_user:e.canFollowUpWithUser}})}),[d,i]);return(0,f.jsxs)("div",{style:c.container,children:[(0,n(211134).PF)(n(780054).A)?(0,f.jsx)($e,{styles:c}):null,(0,f.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[null,Boolean(i)?(0,f.jsxs)("div",{children:[(0,f.jsx)(be().A,{icon:"thumbsUp"===p?n(408197).s:b,ariaLabel:l.formatMessage(Je.thumbsUpFeedback),onClick:g,disabled:void 0!==p}),(0,f.jsx)(be().A,{icon:"thumbsDown"===p?n(436150).v:y,ariaLabel:l.formatMessage(Je.thumbsDownFeedback),onClick:v,disabled:void 0!==p})]}):null]}),(0,f.jsx)(n(410386).e,{isOpen:u,setIsOpen:h,submit:x})]})}));function Xe(e){const{menuListProps:t,title:n,subtitle:i,renderIcon:s}=e,{focused:o}=t,l=(0,a().IS)((e=>({container:{borderRadius:6,paddingLeft:4},titleContainer:{display:"flex",alignItems:"center",gap:8},title:{fontWeight:B().Wy.medium},subtitle:{color:e.text.secondary,fontSize:12},divider:{color:e.text.secondary,fontSize:12},enterIcon:{width:12,height:12,color:e.text.secondary},searchIcon:{width:20,height:20}})),[]),c=(0,r.useMemo)((()=>{if(o)return(0,f.jsx)("div",{children:(0,p().K)(l.enterIcon)})}),[l.enterIcon,o]);return(0,f.jsx)(ye().A,{...t,title:(0,f.jsx)("div",{style:l.titleContainer,children:(0,f.jsx)("span",{style:l.title,children:n})}),icon:s(l.searchIcon),style:l.container,right:c,buttonStyle:Oe,caption:(0,f.jsx)("span",{style:l.subtitle,children:i})})}function Ze(e){const{styles:t}=e,n=(0,a().IS)((e=>({iconColor:{color:e.icon.primary}})),[]);return(0,m().eyeglassesIcon)({...t,...n.iconColor})}const Je=(0,T().YK)({openInNewTabPlaceholder:{defaultMessage:"Open in new tab...",id:"MiniSearch.openInNewTab"},defaultInputPlaceHolder:{defaultMessage:"Search or ask anything",id:"MiniSearch.defaultInputPlaceHolder"},giveSearchFeedbackDev:{defaultMessage:"#proj-unified-find (dev)",id:"MiniSearch.giveSearchFeedbackDev"},fromCalendarEvents:{id:"miniSearch.fromCalendarEvents",defaultMessage:"From calendar events"},noQuickResultsFound:{id:"miniSearch.noQuickResultsFound",defaultMessage:"No quick results found"},searchMoreSources:{id:"miniSearch.searchMoreSources",defaultMessage:"Press {returnButton} to expand your search"},returnKey:{id:"miniSearch.returnKey",defaultMessage:"Return"},quickMatchesSectionTitle:{id:"miniSearch.quickMatches.sectionTitle",defaultMessage:"Quick matches"},researchModeTitle:{id:"miniSearch.researchMode.title",defaultMessage:"Deep Research"},researchModeSubtitle:{id:"miniSearch.researchMode.subtitle",defaultMessage:"Get a thorough report for any topic"},deepFindTitle:{id:"miniSearch.deepFind.title",defaultMessage:"Search"},deepFindSubtitle:{id:"miniSearch.deepFind.subtitle",defaultMessage:"Get more results & AI summary"},copySearchIndexReadiness:{id:"miniSearch.copySearchIndexReadiness",defaultMessage:"Button to copy local/client search index readiness"},thumbsUpFeedback:{id:"miniSearch.thumbsUpFeedback",defaultMessage:"Give thumbs up feedback"},thumbsDownFeedback:{id:"miniSearch.thumbsDownFeedback",defaultMessage:"Give thumbs down feedback"},lastEdited:{id:"miniSearch.lastEdited",defaultMessage:"Edited {time}"}});function et(){const e=(0,a().IS)((e=>({wrapper:{display:"grid",alignItems:"center",height:"100%",width:"100%",userSelect:"none",flex:1},container:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:4},iconContainer:{display:"flex",gap:4,alignItems:"center",marginBottom:16},logoIcon:{width:32,height:32,padding:6},iconWrapper:{padding:2,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-12,background:e.white,border:`1.5px solid ${e.lightDividerColor}`},heading:{fontSize:14,fontWeight:500,color:e.text.secondary,display:"flex",alignItems:"center",gap:8},subtext:{fontSize:14,color:e.text.secondary},returnIcon:{width:12,height:12},returnText:{display:"flex",alignItems:"center",gap:6,fontSize:12,border:`1px solid ${e.stroke.secondary}`,padding:"2px 4px",borderRadius:4,color:e.text.secondary,fontFamily:"monospace",fontWeight:400}})),[]),t=(0,f.jsxs)("span",{style:e.returnText,children:[(0,p().K)(e.returnIcon),(0,f.jsx)(T().sA,{...Je.returnKey})]});return(0,f.jsx)("div",{style:e.wrapper,children:(0,f.jsx)("div",{style:e.container,children:(0,f.jsx)("div",{style:e.heading,children:(0,f.jsx)(T().sA,{...Je.searchMoreSources,values:{returnButton:t}})})})})}const tt=function(){return(0,o().K8)((()=>ue().zD.isQuickFindEnabled()),[])?(0,f.jsx)(Le,{}):null}},819493:(e,t,n)=>{n.d(t,{$:()=>I,b:()=>w});n(898992),n(908872),n(296540);var i=()=>n(662303),r=()=>n(484714),s=()=>n(56366),o=()=>n(401497),a=()=>n(764880),l=()=>n(869190),c=()=>n(959013),d=()=>n(777092),u=()=>n(921855),h=()=>n(972435),p=()=>n(963589),m=()=>n(962730),g=()=>n(706965),f=()=>n(678553),v=()=>n(89924),y=()=>n(859428),x=()=>n(125565),b=()=>n(715011),S=n(474848);function I(e){let{isPageMoreButton:t,hideTopBorder:n,store:i,wordCountStores:l,showWordCount:d}=e;const u=(0,s().K8)((()=>w(i)),[i]),{device:p}=(0,r().v3)(),I=(0,s().K8)((()=>p.isPhone),[p]),k=h().A.getIntl(),M=(0,o().IS)((()=>({menuItem:{paddingTop:I?8:n?0:6,paddingBottom:I?8:16}})),[n,I]);return u&&!u.canAccess?null:(0,S.jsx)(v().A,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,S.jsx)(f().A,{style:u?void 0:M.menuItem,shouldWrapTitle:!0,title:u?(0,S.jsx)(y().A,{placement:m().W.Right,render:e=>(0,S.jsxs)("div",{...e,children:[d&&(0,S.jsx)(x().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,S.jsx)(c().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,S.jsx)(b().A,{store:i})}})}),l&&(0,S.jsx)(A,{stores:l}),(0,S.jsx)(x().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(c().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,a().lR)(k,u.lastEditedBy):void 0}})}),(0,S.jsx)(x().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,style:{marginBottom:d?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,S.jsx)(g().A,{store:i,compactFormat:!0})}):void 0,loading:!u})})}function w(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),r=e.getLastEditedByPointer(),s=e.getLastEditedTime(),o=h().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&s&&r){const a=(0,d().vt)({parentStore:e,pointer:t}),c=(0,l().jE)(n,i().locale,o),u=(0,d().vt)({parentStore:e,pointer:r}),h=(0,l().jE)(s,i().locale,o);if(!u)return;return{canAccess:!0,createdBy:a,createdTime:c,lastEditedBy:u,lastEditedTime:h}}}function A(e){const{stores:t}=e,n=(0,p().X)("selectable_word_count"),i=(0,s().K8)((()=>n?k(t):0),[n,t]);return n?(0,S.jsx)(x().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,S.jsx)(c().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:i}})}):null}function k(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+k(t.getContentStores())}),0)}},851775:(e,t,n)=>{n.d(t,{A:()=>o});var i=()=>n(194188),r=()=>n(10123),s=()=>n(570551);function o(e,t){(0,s().A)(2,arguments);var n=(0,r().A)(e),o=(0,i().A)(t),a=n.getFullYear(),l=n.getDate(),c=new Date(0);c.setFullYear(a,o,15),c.setHours(0,0,0,0);var d=function(e){(0,s().A)(1,arguments);var t=(0,r().A)(e),n=t.getFullYear(),i=t.getMonth(),o=new Date(0);return o.setFullYear(n,i+1,0),o.setHours(0,0,0,0),o.getDate()}(c);return n.setMonth(o,Math.min(l,d)),n}}}]);