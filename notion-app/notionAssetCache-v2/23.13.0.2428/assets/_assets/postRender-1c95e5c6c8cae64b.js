"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21088,21682,24587,38664,70593,75681],{369:(e,t,n)=>{n.d(t,{R:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("eyeHide",{viewBox:"0 0 16 12",svg:(0,o.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},5580:(e,t,n)=>{n.d(t,{n:()=>r});var o=()=>n(56366),i=()=>n(209199),a=()=>n(351360);function r(){return(0,o().K8)((()=>{var e;const t=(null===(e=a().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??i().q;return(0,i().o_)(t)}),[])}},6027:(e,t,n)=>{n.d(t,{F:()=>Y});var o=()=>n(662303),i=()=>n(825237),a=()=>n(945778),r=()=>n(142748),s=()=>n(919709),l=()=>n(751735),d=()=>n(496603),c=()=>n(284371),u=()=>n(780054),p=()=>n(972435),m=()=>n(108944),g=()=>n(613735),f=()=>n(337567),h=()=>n(896628),y=()=>n(317909),v=()=>n(892632);const b=630,x=1200,S=(0,n(100622).O4)({theme:"light"}),M=240,A="white",C=200,w=96,j=150,k=184,I=100,T=145,P=23,_=347,B=24,L=100,R=100,D=100,O="black",N=96,E=68,F=S.text.tertiary,U=40,V=(0,n(959013).YK)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),K='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function z(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e}))}function W(e,t){return`${c().Wy.bold} ${t}px ${c().xf({pageFont:e,locale:o().locale})}`}function H(e){const t=c().Wy.medium,n=c().xf({pageFont:e,locale:o().locale});return`${t} ${U}px ${n}`}function G(e){let{context:t,text:n,font:o,color:i,x:a,y:r}=e;t.font=o,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,a,r)}async function Y(e){var t;let{store:n,environment:o}=e;if(n.pathIsDead()||!(0,r().ot)(m().E(n))||(0,f().dL)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:o.currentUser.id}))return;const c=s().q4_(n.getTitleValue())||"",U=null===(t=n.getIcon())||void 0===t?void 0:t.icon,Y=function(e,t){var n;const o=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(o)return i().wY({url:o,width:x,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(o,n),q=n.getFormat(),Q=new OffscreenCanvas(x,b),$=Q.getContext("2d"),[Z,J]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=W(t,N),n.style.top="110vh",n.innerText=e;const o=x-L-R,i=document.body;if(i.appendChild(n),n.clientWidth<o)return i.removeChild(n),[e,N];if(n.style.font=W(t,E),n.clientWidth<o)return i.removeChild(n),[e,E];let a=e;for(;n.clientWidth>o;)a=a.substring(0,a.length-1),n.innerText=`${a}…`;return i.removeChild(n),[`${a}…`,E]}(c,q.page_font),X=W(q.page_font,J),ee=_+(U?P:0),te=ee+B+J;if($){!function(e){e.fillStyle=A,e.fillRect(0,0,x,b)}($),await async function(e){let{context:t,coverImageUrl:n,icon:o,coverPosition:i=.5}=e;if(n){const e=await z(n),o=e.width*(M/x),a=((0,d().Et)(i)?1-i:.5)*(e.height-o);t.drawImage(e,0,a,e.width,o,0,0,x,M)}else{const e=(0,g().b)({icon:o,theme:S}),n=e?(0,l().X4)(e,.1):S.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,x,M),t.fillStyle="rgb(0,0,0,1)"}}({context:$,coverImageUrl:Y,icon:U,coverPosition:q.page_cover_position}),await async function(e){let{context:t,store:n,icon:o}=e;if(o)if((0,a().A)(o))t.font=`${C}px ${K}`,t.textAlign="left",t.textBaseline="top",t.fillText(o,w,j);else{const e=i().wY({url:o,baseUrl:u().A.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:k,userId:void 0}),a=await z(e);t.drawImage(a,I,T,k,k)}}({context:$,store:n,icon:U}),G({context:$,text:Z,font:X,color:O,x:L,y:ee}),G({context:$,text:p().A.formatMessage(V.builtWithNotion),font:H(q.page_font),color:F,x:D,y:te});const e=await Q.convertToBlob();!function(e){let{store:t,file:n,environment:o}=e;v().QM({environment:o,file:n,bucket:"secure",record:t.pointer,onComplete:e=>{y().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:o,canUndo:!1,perform:n=>{h().lm({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:o,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},11356:(e,t,n)=>{n.d(t,{G:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M7.3 1.995a.55.55 0 1 0 0 1.1h5.4a.55.55 0 0 0 0-1.1zm-2.35 2.8a.55.55 0 0 1 .55-.55h9a.55.55 0 0 1 0 1.1h-9a.55.55 0 0 1-.55-.55m-1.987 3.75c0-1.174.951-2.125 2.125-2.125h9.825c1.174 0 2.125.951 2.125 2.125v6.45a2.125 2.125 0 0 1-2.125 2.125H5.088a2.125 2.125 0 0 1-2.125-2.125zm2.125-.875a.875.875 0 0 0-.875.875v6.45c0 .483.392.875.875.875h9.825a.875.875 0 0 0 .875-.875v-6.45a.875.875 0 0 0-.875-.875z"})},i=(0,n(340498).wt)("stack",o)},19606:(e,t,n)=>{n.d(t,{A:()=>m,z:()=>p});var o=n(296540),i=()=>n(56366),a=()=>n(959013),r=()=>n(705540),s=()=>n(204063),l=()=>n(780054),d=()=>n(351360),c=()=>n(645200),u=n(474848);const p=(0,a().YK)({getNotionCalendar:{id:"notionCalendarLaunchButton.getNotionCalendar",defaultMessage:"Get Notion Calendar"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const m=function(e){let{style:t,openCalendarFrom:m,getNotionCalendarFrom:g,onOpenCalendarClick:f,onGetNotionCalendarClick:h,onDownloadClick:y}=e;const v=(0,n(484714).v3)(),b=(0,n(401497).IS)((e=>({button:{marginLeft:8,whiteSpace:"nowrap",...t}})),[t]),x=(0,i().K8)((()=>(0,n(583238).mX)()),[]),S=(0,i().K8)((()=>d().default.state.currentSpaceStore&&(0,n(437622).dT)({env:"production",spaceStore:d().default.state.currentSpaceStore})),[]),[{value:M}]=(0,n(187174).Yb)((async()=>{var e;return!(null===(e=r().electronApi)||void 0===e||!e.isProtocolRegistered)&&r().electronApi.isProtocolRegistered(l().A.calendar.desktopProtocol)}),[]),A=(0,o.useCallback)((()=>{c().Op({environment:v,spaceStore:void 0,collectionViewStore:void 0,from:m}),null==f||f()}),[v,m,f]),C=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t}=d().default.state;e&&t&&(c().Op({environment:v,spaceStore:t,collectionViewStore:void 0,from:g}),null==h||h())}),[v,g,h]),w=(0,o.useCallback)((()=>{n(755636).f({environment:v,url:l().A.calendar.downloadUrl}),null==y||y()}),[v,y]);return v.device.isElectron?M?(0,u.jsx)(s().A,{style:b.button,size:"lg",onClick:A,children:(0,u.jsx)(a().sA,{...p.openCalendar})}):(0,u.jsx)(s().A,{style:b.button,size:"lg",onClick:w,children:(0,u.jsx)(a().sA,{...p.downloadApp})}):x||S?(0,u.jsx)(s().A,{style:b.button,size:"lg",onClick:A,children:(0,u.jsx)(a().sA,{...p.openCalendar})}):(0,u.jsx)(s().A,{style:b.button,color:"black",size:"lg",onClick:C,children:(0,u.jsx)(a().sA,{...p.getNotionCalendar})})}},26517:(e,t,n)=>{n.d(t,{Wf:()=>v,YB:()=>h,aj:()=>y,f3:()=>x,qg:()=>b});n(898992),n(354520),n(581454),n(296540);var o=()=>n(484714),i=()=>n(401497),a=()=>n(651124),r=()=>n(831310),s=()=>n(959013),l=()=>n(449195),d=()=>n(722872),c=()=>n(760217),u=()=>n(928600),p=()=>n(939740),m=()=>n(89924),g=()=>n(74263),f=n(474848);function h(e){const{currentVisibility:t,propertySchema:n,onSelect:o,onClose:i}=e;let r=[...a().vj];r=r.filter((e=>"section"!==e)),(0,l()._f)({propertySchema:n})||(r=r.filter((e=>"hide_if_empty"!==e)));const d=r.map((e=>({visibility:e,label:(0,f.jsx)(s().sA,{...g().gY[e]})})));return(0,f.jsx)(S,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:o,onClose:i})}function y(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=(0,l().SB)(t),a=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,f.jsx)(s().sA,{...g().vG[e]})})));return(0,f.jsx)(S,{currentVisibility:i,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function v(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(s().sA,{...g().wV[e]})}))),r="section_hide"===t?void 0:t;return(0,f.jsx)(S,{currentVisibility:r,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function b(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().qG.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(s().sA,{...g().Bb[e]})}))),r="section_collapsed"===t?"section_show":t;return(0,f.jsx)(S,{currentVisibility:r,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function x(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().RL.map((e=>({visibility:e,label:(0,f.jsx)(s().sA,{...g().PP[e]})})));return(0,f.jsx)(S,{currentVisibility:t,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function S(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:i,onClose:a}=e,r=(0,o().Y0)(),l=n.map((e=>{let{visibility:n,label:o}=e;return{key:n,render:e=>(0,f.jsx)(M,{buttonMenuItemProps:e,isChecked:n===t,label:o}),action:()=>{i(n),a&&a()}}})),c=[{key:"visibilityLevels",render:e=>(0,f.jsx)(m().A,{...e,topBorder:0!==e.index}),items:l}];let g;return g=r.isMobile?{menuType:d().gu.Modal,title:(0,f.jsx)(s().sA,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,f.jsx)(s().sA,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>a&&a()}:{menuType:d().gu.Popup,width:"auto",maxWidth:360},(0,f.jsx)(u().A,{...g,children:(0,f.jsx)(p().Ay,{type:p().Oh.Vertical,initialFocus:void 0,sections:c})})}function M(e){const{buttonMenuItemProps:t,label:n,isChecked:a}=e,{isMobile:s}=(0,o().Y0)(),l=(0,i().IS)((()=>({title:{display:"flex",alignItems:"center",width:150},checkedIcon:{width:s?16:14}})),[s]),d=(0,f.jsx)("div",{style:l.title,children:n}),u=(0,f.jsx)("div",{style:l.checkedIcon,children:(0,r().o)()});return(0,f.jsx)(c().A,{...t,textWrapperStyle:{marginRight:0},title:d,right:a?u:void 0})}},41432:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},49650:(e,t,n)=>{n.d(t,{A:()=>i});n(898992),n(672577);class o extends(()=>n(959180))().A{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const i=new o},64901:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var o=n(474848);const i=function(e){const t=(0,n(484714).v3)(),i=(0,n(401497).DP)();return(0,o.jsx)(n(187485).A,{style:{display:"flex",alignSelf:"stretch",width:36,...e.isRight?{marginRight:-8}:{marginLeft:-8}},external:!0,href:e.href,onClick:()=>n(148024).FH(t,{from:e.analyticsFrom}),children:(0,o.jsx)(n(704152).A,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,n(133033).$)({width:18,marginTop:1,fill:i.lightIconColor})})})}},67805:(e,t,n)=>{n.d(t,{X:()=>r,cT:()=>s,sL:()=>l});n(898992),n(672577);var o=()=>n(68263),i=()=>n(731320),a=()=>n(508496);function r(e,t){return e.sort(((e,n)=>{const o=e.store.canAdmin();if(o===n.store.canAdmin()){var i,a;const o=null===(i=e.publishedMetadata.publishedBy)||void 0===i?void 0:i.id,r=e.publishedMetadata.publishedTime,s=null===(a=n.publishedMetadata.publishedBy)||void 0===a?void 0:a.id,l=n.publishedMetadata.publishedTime;if(t){if(o===t&&s===t&&r&&l)return l-r;if(o===t)return-1;if(s===t)return 1}return r&&l?l-r:0}return o?-1:1}))}function s(e){const{environment:t,store:n}=e;if(!n.pathIsAccessibleAndAlive())return!1;if(!i().i0(n).find((e=>(0,o().W8)(e.permissionItem))))return!1;if(i().qb(t,n))return!1;return!("on"===a().default.getEligibleGroup({experimentId:"sites_disable_banner",defaultGroup:"control"}))}function l(e){const{environment:t,store:n}=e;if(!n.pathIsAccessibleAndAlive())return!1;if(!i().i0(n).find((e=>(0,o().FP)(e.permissionItem)&&"none"!==e.permissionItem.role)))return!1;if(i().qb(t,n))return!1;return"on"===a().default.getEligibleGroup({experimentId:"sites_disable_banner",defaultGroup:"control"})}},70423:(e,t,n)=>{n.d(t,{L:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},70463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(898992),n(941795);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(133033),l=()=>n(427704),d=()=>n(959013),c=()=>n(100622),u=()=>n(284371),p=()=>n(449506),m=()=>n(186445),g=()=>n(404141),f=()=>n(446242),h=()=>n(623580),y=()=>n(204063),v=()=>n(719147),b=n(474848);const x={padding:"24px 36px 24px",minWidth:300,maxWidth:400},S=n(757695).default.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,a().K8)((()=>f().A.state.open),[]);return(0,b.jsx)(n(957986).A,{open:e,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(I,{}),onDismiss:C})};function A(){const e=(0,r().DP)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,s().$)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(v().A,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function C(){f().A.setState({open:!1})}function w(){C(),g().A.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function j(){const e=(0,r().DP)(),t=(0,i().v3)(),n=(0,a().K8)((()=>(0,m()._m)(t)),[t]),o=(0,a().K8)((()=>null==n?void 0:n.getEmail()),[n]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:e.mediumTextColor},children:(0,b.jsx)(d().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:e.mediumTextColor},children:(0,b.jsx)(d().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:u().Wy.medium,marginTop:0},children:o}),(0,b.jsx)("div",{style:{color:e.mediumTextColor,marginTop:4},children:(0,b.jsx)(d().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(y().A,{style:{marginTop:12},onClick:w,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function k(){const e=(0,d().tz)(),t=(0,r().DP)(),n=(0,i().v3)(),s=(0,a().uB)(void 0,S),[l,u]=(0,o.useState)(""),m=(0,o.useCallback)((()=>async function(e,t,n,o){if(n){const i=await p().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==i.type&&i.data.promo?f().A.state.open&&(await f().A.state.handlePromoCode(n),C()):o.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,l,s)),[n,e,l,s]),g=(0,o.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,u,s)),[u,s]),v=(0,a().O$)(s),x=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:t.mediumTextColor},children:(0,b.jsx)(d().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:t.mediumTextColor},children:(0,b.jsx)(d().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(h().A,{style:{marginRight:8,height:32},value:l,onChange:g,onSubmit:m,placeholder:x}),(0,b.jsx)(y().A,{onClick:m,disabled:!l,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:c().Ay.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:v})]})]})}function I(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:o.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(v().A,{external:!0,href:l().eR.pricing,children:e})}})}),(0,b.jsx)(j,{}),(0,b.jsx)(k,{}),(0,b.jsx)(A,{})]})}},72388:(e,t,n)=>{n.d(t,{V:()=>l});var o=()=>n(484714),i=()=>n(56366),a=()=>n(187174),r=()=>n(386164),s=()=>n(449506);function l(e,t){const n=(0,o().v3)(),l=(0,i().K8)((()=>{if(0!==t.length)return{spaceId:e,userIds:t}}),[e,t],{useDeepEqual:!0}),[{value:d}]=(0,a().Yb)((async()=>{if(void 0===l)return{};const t=await s().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:n,data:l,headers:(0,r().WS)({cellId:void 0,spaceId:e})});return"success"===t.type?t.data.userToGroupMap:{}}),[n,l,e],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3});return d}},74263:(e,t,n)=>{n.d(t,{Bb:()=>a,PP:()=>s,gY:()=>m,vG:()=>d,wV:()=>u});var o=()=>n(959013);const i=(0,o().YK)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),a={section_show:i.expanded,section_collapsed:i.expanded,section_hide:i.off},r=(0,o().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),s={inline:r.default,minimal:r.minimal},l=(0,o().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),d={always_show:l.alwaysShow,section_show:l.showOnHover,section_collapsed:l.showOnHover,section_hide:l.off,inline:l.off,minimal:l.off},c=(0,o().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),u={inline:c.asPageSection,minimal:c.minimal},p=(0,o().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),m={show:p.alwaysShow,hide:p.alwaysHide,hide_if_empty:p.hideWhenEmpty,section:p.asPageSection}},75846:(e,t,n)=>{n.d(t,{u:()=>o});const o=(0,n(340498).xh)("globe",{default:{loader:()=>n.e(88865).then(n.bind(n,788865))},small:{loader:()=>n.e(60219).then(n.bind(n,60219))},mini:{loader:()=>n.e(29485).then(n.bind(n,629485))},large:{loader:()=>n.e(31331).then(n.bind(n,431331))}})},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new o},79118:(e,t,n)=>{n.d(t,{Eo:()=>v,Fz:()=>m,KI:()=>s,M4:()=>d,YW:()=>S,iY:()=>M,mO:()=>g,qE:()=>c,vm:()=>h});var o=()=>n(604995),i=()=>n(247331),a=()=>n(977345);const r=(0,n(959013).YK)({buttonAutomationCurrentUserDescription:{defaultMessage:"The user who clicked this button",id:"automations.contextValue.buttonAutomationCurrentUserDescription"},buttonAutomationCurrentUserName:{defaultMessage:"Whoever clicked",id:"automations.contextValue.buttonAutomationCurrentUserName"},buttonAutomationCurrentUserTooltip:{defaultMessage:"The person who clicked the button",id:"automations.contextValue.buttonAutomationCurrentUserTooltip"},buttonAutomationThisPageDescription:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageDescription"},buttonAutomationThisPageName:{defaultMessage:"This page",id:"automations.contextValue.buttonAutomationThisPageName"},buttonAutomationThisPageTooltip:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageTooltip"},eventAutomationCurrentUserDescription:{defaultMessage:"The user who made the edit that triggered this automation to run.",id:"automations.contextValue.eventAutomationCurrentUserDescription"},eventAutomationCurrentUserName:{defaultMessage:"Whoever triggered",id:"automations.contextValue.eventAutomationCurrentUserName"},eventAutomationCurrentUserTooltip:{defaultMessage:"The person whose action triggered this automation",id:"automations.contextValue.eventAutomationCurrentUserTooltip"},eventAutomationThisPageDescription:{defaultMessage:"The page that was edited to trigger this automation to run.",id:"automations.contextValue.eventAutomationThisPageDescription"},eventAutomationThisPageName:{defaultMessage:"Trigger page",id:"automations.contextValue.eventAutomationThisPageName"},eventAutomationThisPageTooltip:{defaultMessage:"The page that triggered this automation",id:"automations.contextValue.eventAutomationThisPageTooltip"},now:{id:"automations.triggers.now.label",defaultMessage:"Time triggered"},nowDescription:{id:"automations.triggers.now.description",defaultMessage:"The time when this automation begins to run."},nowTooltip:{id:"automations.triggers.now.tooltip",defaultMessage:"The time this automation was triggered"},pageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Page creator"},pageCreatorDescription:{id:"automations.triggers.pageCreator.description",defaultMessage:"The user who created the page that was edited to trigger this automation to run."},pageCreatorTooltip:{id:"automations.triggers.pageCreator.tooltip",defaultMessage:"Person who created page"},today:{id:"automations.triggers.today.label",defaultMessage:"Date triggered"},todayDescription:{id:"automations.triggers.today.description",defaultMessage:"The date when this automation begins to run."},todayTooltip:{id:"automations.triggers.today.tooltip",defaultMessage:"The date this automation was triggered"}});function s(){return(0,a().$y)({source:"global",global:"button_page"})}function l(e,t,n){return{description:n,name:e,tooltip:t,compile:(o,a)=>({description:n?o.formatMessage(n):void 0,id:s(),kind:i().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{collection:a,type:"block"}}),evaluate:e=>({kind:i().FormulaContextValueKind.ContextValue,id:s(),value:{type:"block",value:e}})}}const d=l(r.buttonAutomationThisPageName,r.buttonAutomationThisPageTooltip,r.buttonAutomationThisPageDescription),c=l(r.eventAutomationThisPageName,r.eventAutomationThisPageTooltip,r.eventAutomationThisPageDescription);function u(){return(0,a().$y)({source:"global",global:"current_user"})}function p(e,t,n){return{description:n,name:e,tooltip:t,compile:o=>({description:n?o.formatMessage(n):void 0,id:u(),kind:i().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{type:"person"}}),evaluate:e=>({id:u(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const m=p(r.buttonAutomationCurrentUserName,r.buttonAutomationCurrentUserTooltip,r.buttonAutomationCurrentUserDescription),g=p(r.eventAutomationCurrentUserName,r.eventAutomationCurrentUserTooltip,r.eventAutomationCurrentUserDescription);function f(){return(0,a().$y)({source:"global",global:"now"})}const h={description:r.nowDescription,name:r.now,tooltip:r.nowTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:f(),kind:i().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:f(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,o().KQ)(Date.now(),e)}})};function y(){return(0,a().$y)({source:"global",global:"today"})}const v={description:r.todayDescription,name:r.today,tooltip:r.todayTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:y(),kind:i().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:y(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,o().p6)(Date.now(),e)}})};function b(){return(0,a().$y)({source:"global",global:"page_creator"})}function x(e,t){return{description:r.pageCreatorDescription,name:e,tooltip:t,compile(n){return{description:this.description?n.formatMessage(this.description):void 0,id:b(),kind:i().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{type:"person"}}},evaluate:e=>({id:b(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const S=x(r.pageCreator,r.pageCreatorTooltip),M=x(r.pageCreator,r.pageCreatorTooltip)},82926:(e,t,n)=>{n.d(t,{j8:()=>f,un:()=>m,p2:()=>p,WE:()=>u,n5:()=>h,Xn:()=>g});var o=()=>n(161479);const i=(0,n(583835).Dv)("restoreSnapshot");var a=()=>n(570323),r=()=>n(989423);var s=()=>n(136833);var l=()=>n(357625),d=()=>n(496414);const c=(0,n(959013).YK)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function u(e){const{environment:t,from:n,...o}=e;!function(e,t){r().vd(e,"open_history",{from:t})}(t,n),a().A.setState({...o,open:!0,size:50})}function p(){const e=a().A.state;e.open&&a().A.setState({...e,size:e.size+20})}function m(){a().A.setState({open:!1})}function g(e){const{environment:t,snapshot:n,nextFutureSnapshot:o}=e;!function(e,t){r().vd(e,"select_snapshot",{ageMs:(0,s().S)(t)})}(t,n);const i=a().A.state;i.open&&a().A.setState({...i,snapshot:n,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function f(){const e=a().A.state;e.open&&a().A.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function h(e,t){if(!a().A.state.open||!a().A.state.snapshot)return;if(!a().A.state.snapshot)return;!function(e,t){r().vd(e,"restore_snapshot",{ageMs:(0,s().S)(t)})}(e,a().A.state.snapshot),d().m({message:c.restoringPreviousVersion});const n=await l().UT(e,i,{block:{id:a().A.state.blockStore.id,spaceId:(0,o().e)(a().A.state.blockStore.pointer.spaceId)},timestamp:a().A.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(d().V(),n.value.error)throw n.value.error}},91669:(e,t,n)=>{n.d(t,{z:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1}}}const i=new o},103674:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{permissionsInviteStore:new(n(986229).A),contextualInviteStore:new(n(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},103966:(e,t,n)=>{n.d(t,{Z:()=>c});var o=()=>n(496603),i=()=>n(534177),a=()=>n(416504),r=()=>n(519831),s=()=>n(79118);const l={type:"button",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,contextType:a,getRecordModel:l,intl:d}=e,c=s().Fz.compile(d),u=s().vm.compile(d),p=s().Eo.compile(d),m=t.getParentPointer();let g,f;if("button_block"===a){if(e.pageBlockModel){const t=(0,n(236162).SH)({block:e.pageBlockModel,getRecordModel:l});t&&(g=s().M4.compile(d,t.pointer),f=s().YW.compile(d))}}else if("button_property"===a){const e=l(m);if((null==e?void 0:e.table)!==r().Vl)return{error:new(n(322867).N9)(`Unable to load automation parent: ${n(696706).L3.toKey(m)}`)};g=s().M4.compile(d,e.pointer),f=s().YW.compile(d)}else(0,i().HB)(a);return{value:{valueTypes:(0,o().oE)([c,u,p,g,f])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:n,executingUserTimeZone:i,thisPageBlockModel:r}=t??{},l=r?s().M4.evaluate(r.pointer):void 0,d=null==r?void 0:r.getCreatedByPointer(),c=d?s().YW.evaluate(d):void 0,u=n?s().Fz.evaluate(n):void 0,p=(0,a().P)(),m=s().vm.evaluate(i??p),g=s().Eo.evaluate(i??p);return{value:{values:(0,o().oE)([l,c,u,m,g])}}},isAvailableForContext:e=>!0};n(944114);const d={button:l,event:{type:"event",getCreatePermissions(e){const{parentPointer:t,spacePointer:n}=e;return[{minimumRole:"editor",pointer:t,type:"record_permission"},{minimumRole:"read_and_write",pointer:n,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e,o=[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}],a=t.getTrigger();if("event"===a.type){const e=a.event;(0,i().O9)(e.source)&&"filter"!==e.source.type&&(e.source.type===r().Vl||e.source.type===n(869558).Gy?o.push({minimumRole:"reader",pointer:e.source.pointer,type:"record_permission"}):(0,i().HB)(e.source))}return o},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,intl:n}=e,i=s().mO.compile(n),a=s().iY.compile(n),l=s().vm.compile(n),d=s().Eo.compile(n),c=t.getParentPointer();let u;return c.table===r().Vl&&(u=s().qE.compile(n,c)),{value:{valueTypes:(0,o().oE)([i,a,l,d,u])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:n,executingUserTimeZone:r,thisPageBlockModel:l}=t??{},d=l?s().qE.evaluate(l.pointer):void 0,c=n?s().mO.evaluate(n):void 0,u=(0,a().P)(),p=s().vm.evaluate(r??u),m=null==l?void 0:l.getCreatedByPointer(),g=(0,i().O9)(m)?s().iY.evaluate(m):void 0,f=s().Eo.evaluate(r??u);return{value:{values:(0,o().oE)([d,c,p,f,g])}}},isAvailableForContext:e=>!0},recurrence:{type:"recurrence",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{intl:t}=e;return{value:{valueTypes:[s().vm.compile(t),s().Eo.compile(t)]}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserTimeZone:n}=t??{},o=(0,a().P)();return{value:{values:[s().vm.evaluate(n??o),s().Eo.evaluate(n??o)]}}},isAvailableForContext(e){const{automation:t,automationActions:o,hasPremiumAutomations:a}=e;if(t.parent_table===n(179034).ev)return!0;if(t.parent_table===r().Vl){const e=n(388821).RecordMap.create();for(const t of o)e.addModel(t);return!!t.isCompleteSprintAutomation({getRecordModel:n(792071).b4_.fromRecordMap(e)})||a}(0,i().HB)(t.parent_table)}}};function c(e){return d[e]}},105819:(e,t,n)=>{n.d(t,{x:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"m13.987 5.682-.684.684-1.288-1.288.692-.691a.91.91 0 0 1 1.28 0c.35.35.35.93 0 1.28zm-9.433 9.433 7.914-7.914-1.289-1.289-7.92 7.908c-.122.122-.214.29-.274.457l-.336 1.082c-.06.229.153.442.366.366l1.082-.335q.252-.07.457-.275m12.446.76H5.61l1.25-1.25H17a.625.625 0 1 1 0 1.25"})},i=(0,n(340498).wt)("pencilLine",o)},108924:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>bu});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(257615),s=()=>n(430923),l=()=>n(774733),d=()=>n(645873);const c=new(d().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([n.e(7097).then(n.bind(n,15121)),n.e(7097).then(n.bind(n,91063))]);return{Notification:e,ElectronContextMenu:t}})),u=(0,d()._h)(c,(e=>e.ElectronContextMenu));var p=()=>n(695490),m=()=>n(347845),g=(n(898992),n(354520),()=>n(919709)),f=()=>n(496603),h=()=>n(901997),y=()=>n(98244),v=()=>n(317909),b=()=>n(928600),x=()=>n(14235),S=()=>n(722872),M=()=>n(231722),A=()=>n(333665),C=()=>n(486666),w=()=>n(962730),j=()=>n(377586),k=()=>n(797162),I=()=>n(24157),T=()=>n(97270),P=()=>n(693319),_=n(474848);function B(){const e=(0,i().Y0)(),{open:t,filter:n,emojiTextStore:r,popupOpen:s,originRect:l,alwaysShowPopup:d}=(0,a().K8)((()=>{const e=T().A.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){return A().vD(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:o,showPopupWithEmptyFilter:i,selectionRect:a}=e,r=Boolean(i);return{open:t,filter:n,emojiTextStore:o,popupOpen:n.length>0||r,originRect:a,alwaysShowPopup:r}}),[]),{textMode:c,prevChar:u,singleTextSelectionStore:p}=(0,a().K8)((()=>{var e;const t=I().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:o}=t,i=g().qAZ(o.start.store.getValue());return{textMode:n,prevChar:i?i[o.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,M().H7)(o))||void 0===e?void 0:e.store}}),[]),m=(0,a().K8)((()=>k().A.state.open),[]);return(0,o.useEffect)((()=>{t&&!m&&("editing"!==c||!n&&":"!==u||p!==r||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&y().VN()}),[r,n,m,t,u,p,c]),(0,_.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:s,originRect:l,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:R,render:()=>(0,_.jsx)(L,{open:t,filter:n||"",alwaysShowPopup:d}),keepFocus:!0})}function L(e){let{open:t,filter:n,alwaysShowPopup:a}=e;const r=(0,i().v3)(),s=(0,i().Y0)(),l=(0,o.useRef)(null),d=s.isMobileNative&&!s.isTablet?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:C().jv,onClickOutside:y().VN};const c=(0,o.useMemo)((()=>f().sg((e=>{h().P$(r,{searchQuery:e})}),500)),[r]);return t?!Boolean(a)&&n.length<1?null:(0,_.jsx)(b().A,{innerRef:l,...d,children:(0,_.jsx)(P().p,{filter:n,onSubmit:e=>D(e,r),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?y().VN():c(n))},isCallout:!1,menuRef:l,isInline:!0,onUpload:{onComplete:e=>{D(e,r)}}})}):null}function R(){y().VN()}function D(e,t){v().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{y().Ju({environment:t,emoji:e,transaction:n})}})}var O=()=>n(592678),N=(n(944114),n(581454),()=>n(813206)),E=()=>n(584262),F=()=>n(416504),U=()=>n(921997),V=()=>n(959044),K=()=>n(959013),z=()=>n(848259),W=()=>n(449506),H=()=>n(705540),G=()=>n(780054),Y=()=>n(909470),q=()=>n(299545),Q=()=>n(941541),$=()=>n(179534),Z=()=>n(524450),J=()=>n(351360),X=()=>n(508496),ee=()=>n(630116),te=()=>n(477293);function ne(e,t){const n=(0,a().K8)((()=>t?null==e?void 0:e.userId:void 0),[t,null==e?void 0:e.userId]),r=(0,K().tz)(),s=(0,i().v3)(),l=(0,o.useRef)(),d=(0,o.useRef)(),c=(0,o.useRef)(-1),u=(0,o.useCallback)((()=>{const{mobileNative:e}=s,{allSpaces:t,currentSpace:n}=oe();e&&(t===l.current&&n===d.current||e.setBadgeNumber(t,n),d.current=n),t!==l.current&&(t>0?H().setBadge(`${t}`):H().setBadge("")),l.current=t}),[s]),p=(0,o.useMemo)((()=>f().Oo(u)),[u]),m="on"===(0,te().r)("inbox_activity_split"),g=(0,o.useCallback)((async(t,n)=>{if(n===c.current||!e)return;if(c.current=n,!function(e){if(0===$().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(n)))return;let o=[];if(X().default.checkGate({gateName:"multi_cell_get_user_notifications"})){const e=W().callMultiCellApi({eventName:"getUserNotifications",environment:s,data:{size:1e3,isInboxV2:!0,splitInboxActivity:m},headers:{}});for await(const t of e)"success"===t.type&&o.push(...t.data.results)}else{const e=await W().callApi({eventName:"getUserNotifications",environment:s,data:{size:1e3,isInboxV2:!0,splitInboxActivity:m}});if("failed"===e.type)return;o=e.data.results}$().A.setState({results:o}),p();const i=f().KC.apply(null,o.map((e=>e.unreceived.notificationIds)));for(const a of i)ie(a,e,r,s)}),[e,p,s,m,r]),h=(0,o.useMemo)((()=>f().nF(g,1e3)),[g]);(0,o.useEffect)((()=>{if(!n)return;let e;const t=(e,t)=>{Z().A.whenActive((()=>{h(e,t)}))};if(n){const o=(0,U().dp)(n);e=Q().Ay.addListener(o,void 0,t,void 0,s),g("initializeListener",-1)}return $().A.addListener(u),s.mobileNative&&J().default.addListener(u),()=>{e&&Q().Ay.removeListener(e,s),$().A.addListener(u),s.mobileNative&&J().default.removeListener(u)}}),[n,s,g,h,u])}function oe(){const e="on"===X().default.getGroup("inbox_activity_split")?"comments":"mentions";return{allSpaces:$().A.getTotalUnreadCountForType(e),currentSpace:$().A.getUnreadCountForCurrentSpace()[e]??0}}async function ie(e,t,n,o){const i=(0,ee().Oo)(t,{table:V()._p,id:e});await i.load();const a=i.getKeyStore("activity_id").getValue(),r=i.getKeyStore("space_id").getValue();if(!r||!a)return;const s=(0,q().jA)(i,a,r);await s.load();const l=s.getModel(),{currentUserStore:d,currentSpaceViewStore:u}=J().default.state;if(d&&u&&l&&!l.invalid&&!N().zP(l,d.id)&&await H().isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await u.load(),!u.isDefined())return;if(!l.isMentionType())return;if("reacted"===l.getType())return;if(!u.getNotifyDesktop())return;if(!o.device.isDesktop)return;const e=(0,(await c.load()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,F().P)(),intl:n,pageVisitSource:E().y8.PushNotification,recipientUser:d.getModel(),experimentService:X().default,collectionFeatureGates:(0,Y().i)()});if(!e)return;const{subject:t,body:a}=e,r=new Notification(t,{body:a,silent:!0}),p=N().JT(l.type),m={medium:"desktop_push",type:p,badge_number:oe().allSpaces,notification_id:i.id,activity_id:s.id},g=e=>z().Gj({environment:o,args:m,action:e});g("sent"),r.addEventListener("show",(()=>g("shown"))),r.addEventListener("close",(()=>g("closed"))),r.addEventListener("click",(()=>{const e=N().KP({activity:l,getRecordModel:i.getRecordModel,baseUrl:G().A.domainBaseUrl,pageVisitSource:E().y8.PushNotification}),t=(0,E().p3)(e,[p,"desktop_push"],E().y8.PushNotification);H().openNotificationUrl(t,o),g("clicked")}))}}const ae=new(d().O2)("linkMenu",(()=>Promise.all([n.e(23806),n.e(4586)]).then(n.bind(n,553679)))),re=(0,d()._h)(ae,(e=>e.default)),se=new(d().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,572107)))),le=(0,d()._h)(se,(e=>e.MessageStoreDebugPanel));var de=()=>n(971320);function ce(){return(0,a().K8)((()=>de().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,_.jsx)(le,{}):null}var ue=()=>n(187174),pe=()=>n(386164),me=()=>n(534177),ge=()=>n(37433);function fe(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:o,currentUserStore:i}=J().default.state,a=null==n?void 0:n.getUserId(),r=null==n?void 0:n.getSpaceId(),s={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&a&&r?function(){const{spaceTransitionStatus:e}=J().default.state;switch(e){case"notTransitioning":return!1;case"joiningOrCreatingSpace":case"switchingToOrLoadingSpace":return!0;default:(0,me().HB)(e)}}()||t.currentUser.id!==a||(null==i?void 0:i.id)!==a||(null==o?void 0:o.id)!==r?s:(0,ge().nk)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:a,spaceViewSpaceId:r}:s:s}const he=(0,f().sg)(W().callApi,1e3,{leading:!0,trailing:!0}),ye=function(){const e=(0,i().v3)(),t=(0,a().K8)((()=>fe({environment:e})),[e]);return(0,ue().Yb)((async()=>{t.readyForHomePagesRequest&&await he({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,pe().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var ve=()=>n(362749),be=()=>n(171510),xe=()=>n(793531),Se=()=>n(205682),Me=()=>n(77238),Ae=()=>n(93658),Ce=()=>n(263928),we=()=>n(634157);function je(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,a().O$)(J().default),n=e.currentUser.id,r=(0,a().K8)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!r||!n)return;const t=Q().Ay.addListener((0,U().Li)({userId:n,spaceId:r}),void 0,(async(t,o)=>{(function(e){var t;let{spaceId:n,userId:o,emitValue:i}=e;const a=null===(t=we().A.getUserJoinedTeamsState({userId:o,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(a===i)return!1;if(void 0===a&&we().A.getHasFetched({userId:o,spaceId:n}))return!1;return!0})({spaceId:r,userId:n,emitValue:o})&&await Ce().u({environment:e,spaceId:r,userId:n,emitValue:o});const i=we().A.getUserJoinedTeamsState({userId:n,spaceId:r});i&&we().A.setUserJoinedTeamsState({userId:n,spaceId:r,state:{...i,lastEmitValue:o}})}),void 0,e);return function(){t&&Q().Ay.removeListener(t,e)}}),[e,n,r]),null}var ke=()=>n(195795),Ie=()=>n(401497),Te=()=>n(66913),Pe=()=>n(133033),_e=()=>n(284371),Be=()=>n(296511),Le=()=>n(725614),Re=()=>n(921855),De=()=>n(792540),Oe=()=>n(836251),Ne=()=>n(24973),Ee=()=>n(285790),Fe=()=>n(859428),Ue=()=>n(246722);const Ve=(0,K().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function Ke(){const e=(0,i().v3)(),{device:t}=e,n=(0,K().tz)(),r=(0,Ie().IS)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?_e().J.UIRegular.mobile:_e().J.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:s,altText:l,canEdit:d}=(0,a().K8)((()=>{const e=Ne().A.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,Re().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,o.useEffect)((()=>{s&&Le().setSelectionAtEnd({store:s})}),[s]),(0,_.jsx)(b().A,{menuType:t.isMobile?S().gu.ActionSheet:S().gu.Popup,width:t.isMobile?"100vw":310,children:(0,_.jsxs)("div",{style:r.wrapper,children:[(0,_.jsxs)("div",{children:[(0,_.jsx)(Ee().A,{style:r.closeButton,hovered:!0,icon:Te().V,onClick:()=>Be().V(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{style:r.helpText,children:(0,_.jsx)(K().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,_.jsx)(Fe().A,{renderTooltip:()=>n.formatMessage(Ve.learnTooltip),render:e=>(0,_.jsx)(Ee().A,{ariaLabel:n.formatMessage(Ve.learnTooltip),icon:Pe().$,external:!0,href:(0,Oe().xS)("guides.altText"),style:r.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&s&&(0,_.jsx)(Ue().A,{store:s,disabled:!1,pasteBehavior:"plaintext",style:r.input,placeholderStyle:r.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>Be().V(e),onEsc:()=>Be().V(e),onTab:()=>!0,placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:De().Os.none})]})})}const ze=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,Ie().IS)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:o,originRect:r}=(0,a().K8)((()=>{const{open:e}=Ne().A.state;return e?{open:e,originRect:Ne().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,_.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:o,originRect:r,originGap:8,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.End,onDismiss:()=>Be().V(e),render:()=>(0,_.jsx)(Ke,{}),sameWidthAsOrigin:!1,style:n.popup,trapFocus:!0})};var We=()=>n(112873),He=()=>n(963589),Ge=()=>n(517223),Ye=()=>n(644914),qe=()=>n(737230),Qe=()=>n(372154),$e=()=>n(700500),Ze=()=>n(273321),Je=()=>n(555776),Xe=()=>n(116008),et=()=>n(756279),tt=()=>n(344051),nt=()=>n(545805),ot=()=>n(45552),it=()=>n(13679),at=()=>n(987017);const rt=[Qe().c.Open,Qe().c.Resolved];const st=function(e){let{discussionIds:t,blockStore:o,recursivelyLoadAllDiscussions:r,tab:s,property_id:l}=e;const d=(0,i().v3)(),{resolved:c,unresolved:u}=(0,a().K8)((()=>{const e=q().Bw(o,{recursivelyLoadAllDiscussions:r,includePropertyDiscussions:!0}).filter((e=>{if(t&&!t.includes(e.id)&&!q().j3(e))return!1;return!Boolean(l)||e.getPropertyId()===l})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=q().uy(e);return{resolved:n,unresolved:i}}),[o,r,t,l]),{device:p}=d;let m;return m=p.isMobile?{menuType:S().gu.Modal,title:(0,_.jsx)(K().sA,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,_.jsx)(ut,{tab:s,resolved:c,unresolved:u}),right:(0,_.jsx)(ot().DoneMenuText,{}),onClickRight:We().xl,whiteBackground:!0}:{menuType:S().gu.Popup,header:(0,_.jsx)(ut,{tab:s,resolved:c,unresolved:u}),width:480,maxHeight:"50vh",onClickOutside:We().xl},(0,_.jsx)(n(700180).A,{capture:!0,preventType:et().A.All,children:(0,_.jsx)(n(297872).A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,_.jsx)(nt().A,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:We().xl,onBackspace:ct,onDelete:ct,children:(0,_.jsx)(it().A,{store:o,droppable:!0,render:()=>(0,_.jsx)(b().A,{...m,children:(0,_.jsx)(mt,{tab:s,blockStore:o,resolved:c,unresolved:u})})},o.id)})})})};function lt(e){let{message:t}=e;const n=(0,i().v3)(),{device:o}=n,a=(0,Ie().IS)((e=>({emptyState:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.mediumTextColor}})),[o.isMobile]);return(0,_.jsx)("div",{style:a.emptyState,children:t})}function dt(e){const t=Qe().A.state;t.open&&Qe().A.setState({...t,tab:rt[e]})}function ct(e){null==e||e.preventDefault(),We().xl()}function ut(e){let{tab:t,resolved:n,unresolved:o}=e;const a=(0,i().v3)(),{device:r}=a,s=o.length,l=n.length,d=(0,Ie().IS)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===l||0===s?null:(0,_.jsx)(at().Ay,{tabs:[(0,_.jsxs)("div",{children:[(0,_.jsx)(K().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,_.jsx)("span",{style:d.openCountStyle,children:s})]},"openDiscussions"),(0,_.jsxs)("div",{children:[(0,_.jsx)(K().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,_.jsx)("span",{style:d.resolvedCountStyle,children:l})]},"resolvedDiscussions")],selectedIndex:rt.indexOf(t),onChange:dt,style:{...r.isAndroid&&{borderBottom:"none"}}})}function pt(e){const{value:t}=(0,d().fJ)(l().commentsDependency),n=(0,i().v3)(),o=(0,a().K8)((()=>Xe().A.state.open&&Je().A.state.overlapsExistingDiscussionMenu),[]),r=(0,a().K8)((()=>Qe().A.state.open&&Qe().A.state.tab===Qe().c.Open),[]),s=(0,a().K8)((()=>Qe().A.state.open&&Qe().A.state.keepNewDiscussionAtBottom),[]),c=(0,a().K8)((()=>(Xe().A.state.open&&Je().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const u=s?e.discussionStores[0]:void 0;return(0,_.jsxs)(_.Fragment,{children:[t&&e.discussionStores.slice(u?1:0).map(((n,o,i)=>(0,_.jsx)(l().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===o,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:We().xl},n.id))),u&&t&&(0,_.jsx)(l().PW,{store:u,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:We().xl},u.id),o&&r&&(0,_.jsx)(Ze().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:c,noBackgroundColors:!0})]})}function mt(e){let{tab:t,blockStore:n,resolved:r,unresolved:s}=e;const c=(0,Ie().DP)(),u=(0,i().v3)(),{device:p}=u,m=(0,a().K8)((()=>n.getType()),[n]),g=(0,a().K8)((()=>tt().B(n)),[n]),{value:f}=(0,d().fJ)(l().commentsDependency);if(!f)return null;if(t===Qe().c.Open){if(s.length){const e=m&&(0,me().O)($e().kt,m);return p.isMobile&&e&&g?(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${c.regularDividerColor}`,marginBottom:1},children:(0,_.jsx)(g,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,_.jsx)(pt,{discussionStores:s,blockStore:n})]}):(0,_.jsx)(pt,{discussionStores:s,blockStore:n})}return(0,_.jsx)(lt,{message:(0,_.jsx)(K().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return r.length?(0,_.jsx)(pt,{discussionStores:r,blockStore:n}):(0,_.jsx)(lt,{message:(0,_.jsx)(K().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const gt=function(){const e=(0,i().v3)(),{device:t}=e,r=(0,a().K8)((()=>Qe().A.state.rect),[]),s=(0,a().K8)((()=>{if(!Qe().A.state.open)return!1;let t=!1;const o=Qe().A.state.property_id;if(Qe().A.state.open&&o){var i;const e=null===(i=Qe().A.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,Ge().Hc)({layoutStore:e,propertyId:o}).isPropertyInPageDetails)}const a=(0,n(835066).$N)(e,Qe().A.state.blockStore);return!!t||(qe().Ay.state.currentTab!==qe().tF.Comments||!(0,Ye().Nk)(e))&&!a}),[e]),l=(0,o.useCallback)((()=>{We().xl()}),[]),d=(0,o.useCallback)((()=>{if(Qe().A.state.open)return(0,_.jsx)(st,{tab:Qe().A.state.tab,blockStore:Qe().A.state.blockStore,discussionIds:Qe().A.state.discussionIds,recursivelyLoadAllDiscussions:Qe().A.state.recursivelyLoadAllDiscussions,property_id:Qe().A.state.property_id})}),[]),c=(0,He().X)("comment_sidebar_for_you");return(0,_.jsx)(x().Ay,{popupType:t.isMobile?c?j().n.BottomSheet:j().n.SlideUp:j().n.Popup,bottomSheetInitialState:"half",open:s,originRect:r,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Center,disableMouseCapture:!0,originGap:4,render:d,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:l,trapFocus:!0})};var ft=()=>n(925193),ht=()=>n(847832),yt=()=>n(857639),vt=()=>n(356596),bt=()=>n(129518),xt=()=>n(541372),St=()=>n(178658),Mt=()=>n(938987),At=()=>n(949575),Ct=()=>n(945710),wt=()=>n(352097),jt=()=>n(310770),kt=()=>n(390849),It=()=>n(931871),Tt=()=>n(989423),Pt=()=>n(186445),_t=()=>n(38337),Bt=()=>n(495159),Lt=()=>n(972435),Rt=()=>n(430483),Dt=()=>n(84349),Ot=()=>n(525569),Nt=()=>n(502438),Et=()=>n(760217),Ft=()=>n(939740),Ut=()=>n(89924);const Vt=(0,K().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const Kt=function(){const e=(0,i().Y0)(),t=(0,i().v3)(),r=(0,a().O$)(Dt().A),{stores:s,phase:l}=(0,a().O$)(Nt().default);(0,o.useEffect)((()=>{r.open&&((0,n(821062).A)(s,r.blocks)&&l===Nt().SelectionPhase.Selected||xt().VN(t))}),[r,s,l,t]);const d=(0,o.useCallback)((()=>{xt().VN(t)}),[t]),c=r.open&&"ai_actions"===r.type;return(0,_.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:r.open,originRect:r.open?r.rect:void 0,placementToOrigin:c?w().W.Right:w().W.Bottom,alignmentToOrigin:c?w().C.Start:w().C.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,_.jsx)(Wt,{}),onDismiss:d,disableFlippingPlacement:c})};function zt(e){const{menuItemProps:t}=e,{isMobile:n}=(0,i().Y0)(),o=(0,a().O$)(Rt().ts),r=n?{mobileIconStyle:o?{marginLeft:18,marginRight:2}:void 0}:{desktopIconStyle:o?{marginLeft:8,marginRight:2}:void 0};return(0,_.jsx)(Et().A,{...t,title:Lt().A.formatMessage(Bt().VT.askAI),icon:(0,_.jsx)(Mt().H2,{}),...r})}function Wt(){const e=(0,i().v3)(),t=(0,Ie().DP)(),{device:n}=e,o=(0,a().K8)((()=>{const n=Dt().A.state;return n.open?"ai_actions"===n.type?function(e,t,n){var o;const i=(0,Pt().ao)();if(!i)return null;const a=(0,At().clientSkillToAssistantSurfaceAction)((0,Ct().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),r={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:i,selectionState:Nt().default.state,textSelectionState:I().default.state,userSettings:null===(o=J().default.state.currentUserSettingsStore)||void 0===o?void 0:o.getSettings()},s=(0,At().filterAssistantSurfaceActionsForContext)(a,r),l=(0,jt().d7)({assistantSuggestionContext:r,validatedActions:s}).filter(Ct().isAssistantSurfaceActionWithClientSkill),d=(0,At().clientSkillToAssistantSurfaceAction)(l),c=(0,ft().gC)();return[{key:"ai_actions_paste_menu",render:e=>(0,_.jsx)(Ut().A,{...e,title:Lt().A.formatMessage(Vt.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,_.jsx)(Et().A,{...e,icon:(0,_.jsx)(bt().O1,{svg:vt().K}),title:Lt().A.formatMessage(Vt.pasteItem)}),action:()=>{(0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),xt().VN(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,_.jsx)(Et().A,{...t,title:Lt().A.formatMessage(It().DZ.writerGlobalSkill,{displayName:Lt().A.formatMessage(e.displayName),acceptsParameters:(0,ht().yH)(e.skillType)||(0,ht().SH)(e.skillType)}),icon:(0,_.jsx)(bt().O1,{svg:e.icon,svgFill:(0,wt().vJ)(e.category).color(n).color})}),action:async()=>{try{(0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),xt().VN(t),await(0,St().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=Ot().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await kt().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,Ct().dangerouslyCreateClientSkillWithParameterValues)(e),updater:Ot().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{yt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,_.jsx)(zt,{menuItemProps:e}),action:async()=>{try{(0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),xt().VN(t),await(0,St().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{yt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,e,t):"blocks"===n.type||"links"===n.type?function(e,t){const{blocks:n}=e,{currentSpaceStore:o}=J().default.state,i=[];if("blocks"===e.type){const{copiedStores:a,pageSource:r}=e;xt().GV({currentSpaceId:null==o?void 0:o.id,blocks:n,copiedStores:a})&&i.push({name:Lt().A.formatMessage(Vt.createTransclusion),action:async()=>{(0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await xt().Ce({environment:t,blocks:n,copiedBlockIds:a.map((e=>e.id))})}}),xt().h8({blocks:n})&&i.push({name:Lt().A.formatMessage(Vt.linkToPage),action:async()=>((0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),xt().Xw({environment:t,blocks:n,source:{type:"blocks",copiedStores:a,pageSource:r}}))})}return"links"===e.type&&i.push({name:Lt().A.formatMessage(Vt.linkToPage),action:async()=>((0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),xt().Xw({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,_.jsx)(Ut().A,{...e}),items:[{key:"dismiss",render:e=>(0,_.jsx)(Et().A,{...e,title:Lt().A.formatMessage(Vt.dismissItem)}),action:()=>{(0,Tt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),xt().VN(t)}},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,_.jsx)(Et().A,{...e,title:t}),action:n}}))]}]}(n,e):void(0,me().HB)(n):null}),[e,t]);if(null===o)return null;let r;return r=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:320,maxHeight:"40vh"},(0,_.jsx)(b().A,{...r,className:_t().poM,children:(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:o,initialFocus:0})})}var Ht=()=>n(673898),Gt=()=>n(623580),Yt=()=>n(125565);const qt=function(){const e=(0,i().v3)(),{device:t}=e,{active:n,stringValue:o}=(0,a().K8)((()=>{const{active:e,stringValue:t}=Ht().A.state;return{active:e,stringValue:t}}),[]),r=window.innerWidth/2-150,s=window.innerHeight/2,l=t.isMobileNative?(0,_.jsx)(K().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,_.jsx)(K().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,_.jsx)(x().Ay,{popupType:t.isMobileNative?j().n.SlideUp:j().n.Popup,open:n,originRect:{top:s,left:r},onDismiss:Qt,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Start,originGap:0,render:()=>(0,_.jsx)(nt().A,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:f().D_,onCommandEnter:f().D_,onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onDelete:f().D_,onBackspace:f().D_,onEsc:f().D_,onLeft:f().D_,onRight:f().D_,onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:f().D_,children:(0,_.jsxs)("div",{style:{padding:8,width:300},children:[(0,_.jsx)(Gt().A,{style:{width:"100%",fontSize:12},value:o,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,_.jsx)(Yt().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function Qt(){Ht().A.setState({...Ht().A.state,active:!1,stringValue:""})}var $t=()=>n(509111),Zt=()=>n(588264),Jt=()=>n(338235),Xt=()=>n(887480),en=()=>n(605402);const tn=function(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,a().K8)((()=>({currentSpaceStore:J().default.state.currentSpaceStore})),[]);return(0,o.useEffect)((()=>{if(!t)return;const o=Q().Ay.addListener((0,U().On)(t.id),void 0,(async(o,i)=>{if(!en().A.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const a=await W().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,pe().WS)({cellId:void 0,spaceId:t.id})});if("failed"===a.type)return yt().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed"}),[];en().A.setState({permissionGroupsAndMemberCounts:a.data.groupsWithMemberCount.map((e=>({group:n(792071).Bj6.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){o&&Q().Ay.removeListener(o,e)}}),[t,e]),null};n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var nn=()=>n(486130);const on=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:r}=(0,a().O$)(J().default),s=null==r?void 0:r.id;return(0,o.useEffect)((()=>{if(!t||!s)return;const o=Q().Ay.addListener((0,U().yp)({spaceId:t.id,userId:s}),void 0,(async(o,i)=>{if(!nn()._.shouldRefetch({spaceId:t.id,userId:s,emitValue:i}))return;const a=await W().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[s]},headers:(0,pe().WS)({cellId:void 0,spaceId:t.id})});if("failed"===a.type)return yt().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers"}),[];n(689025).A.setState({spacePermissionGroupIds:new Set(a.data.userToGroupMap[s]||[]),lastEmitData:{spaceId:t.id,userId:s,value:i}});const r=nn()._.getState();nn()._.setState({...r,[s]:{...r[s],[t.id]:{spacePermissionGroupIds:new Set(a.data.userToGroupMap[s]||[]),lastEmitValue:i}}})}),void 0,e);return function(){o&&Q().Ay.removeListener(o,e)}}),[t,s,e]),null};var an=()=>n(666144),rn=()=>n(245865),sn=()=>n(423219);function ln(e){const{environment:t,pointers:n,userIdToCloneFrom:o}=e;for(const i of n)an().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:i,userId:o}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const dn=new(n(99895).G)((()=>0));const cn=function(){const e=(0,i().v3)(),[t,r]=(0,o.useState)(!1);(0,o.useEffect)((()=>{!async function(){await n(807054).waitForInitialPageRenderToComplete(),r(!0)}()}),[]);const s=(0,a().K8)((()=>{var e;return null===(e=(0,n(87878).vZ)())||void 0===e?void 0:e.id}),[]),l=e.currentUser.id,d=(0,a().K8)((()=>{const e=sn().A.getKeys();return s&&l?e.includes(s)?e:[...e,s]:e}),[s,l]);return function(e,t){const n=(0,i().v3)();(0,o.useEffect)((()=>{const o=dn.get(e)+1;dn.set(e,o);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${o})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),rn().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),rn().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,a().K8)((()=>{if(!t)return[];const n=[];for(const t of d){const o=sn().A.getDataWithoutRefetch(e,{spaceId:t});if(!o)continue;const i=o.pointers,a=o.lastFetchedBy;t===s&&a!==l&&ln({environment:e,pointers:i,userIdToCloneFrom:a}),n.push(...i)}return n}),[d,s,l,e,t])),function(e){const t=(0,i().v3)();(0,o.useEffect)((()=>{const n=[];for(const o of e){const e=Q().Ay.addListener((0,U().VW)(o),void 0,((e,t)=>{sn().A.emit({spaceId:o},t)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)Q().Ay.removeListener(e,t)}}),[t,e])}(d),null};var un=()=>n(597777),pn=()=>n(220719),mn=()=>n(743336),gn=()=>n(606952),fn=()=>n(536131);const hn=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,a().O$)(fn().A);return(0,_.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.originRect,onDismiss:mn().V,render:()=>(0,_.jsx)(yn,{shouldShowReminder:!!n.open&&n.allowReminders}),trapFocus:!0})};function yn(e){let{shouldShowReminder:t}=e;const n=(0,i().v3)(),o=(0,a().K8)((()=>vn()),[]);if(!o)return null;const r="default",{date_format:s,time_format:l,dateValue:c}=o;return(0,_.jsx)(d().u2,{dependency:p().cm,children:e=>{let{DatePropertyMenu:o}=e;return(0,_.jsx)(o,{firstDayOfWeek:Pt().XX.state,value:c,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=vn();if(!n)return;const{textStore:o,textValue:i,tokenIndex:a}=n,r=g().AhH(i.slice(0,a)),s=g().AhH(i.slice(0,a+1));v().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{gn().jQ({environment:e,store:o,selection:{startIndex:r,endIndex:s},transaction:t})}})}(t);if(!un().kC(e))return;const o=vn();if(!o)return;const{date_format:i,time_format:a}=o;bn({date_format:i,time_format:a,...e},t,n)}(e,n,r),dateFormat:s,onChangeDateFormat:e=>function(e,t,n){const o=vn();if(!o)return;const{dateValue:i,time_format:a}=o;bn({date_format:e,time_format:a,...i},t,n)}(e,n,r),timeFormat:l,onChangeTimeFormat:e=>function(e,t,n){const o=vn();if(!o)return;const{dateValue:i,date_format:a}=o;bn({date_format:a,time_format:e,...i},t,n)}(e,n,r),onDismiss:mn().V,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function vn(){const e=fn().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,o=t.getValue();if(o){const e=o[n];if(e){(0,pn().MX)(g().qXl(e),"Token should be a mention token");const i=g().uPN(e),a=g().$CJ(i);if(a){const{date_format:r,time_format:s,...l}=g().K7D(a);return{textStore:t,textValue:o,tokenIndex:n,token:e,annotations:i,date_format:r,time_format:s,dateValue:l}}}}}}function bn(e,t,n){const o=vn();if(!o)return;const{textStore:i,textValue:a,tokenIndex:r,token:s,annotations:l}=o,d=l.map((t=>g().qsB(t)?["d",e]:t)),c=g().Ey_(s[0],d),u=g().AhH(a.slice(0,r)),p=g().AhH(a.slice(0,r+1));v().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{gn().jQ({environment:t,store:i,selection:{startIndex:u,endIndex:p},transaction:e}),gn().yr({environment:t,store:i,tokens:[c],index:u,transaction:e}),X().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||Le().clear({environment:t})}})}n(737550);var xn=()=>n(90023),Sn=()=>n(304740),Mn=()=>n(861017),An=()=>n(179034),Cn=()=>n(720665),wn=()=>n(437219),jn=()=>n(131581),kn=()=>n(664133),In=()=>n(108944),Tn=()=>n(176106),Pn=()=>n(666803),_n=()=>n(802790),Bn=()=>n(331542),Ln=()=>n(515918);const Rn=(0,K().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Dn=(0,K().YK)({mentionPage:{defaultMessage:"Mention",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},pagePreview:{defaultMessage:"Preview",id:"embedMenu.actions.pagePreview.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),On={image:Lt().A.formatMessage(Rn.image),video:Lt().A.formatMessage(Rn.video),tweet:Lt().A.formatMessage(Rn.tweet),drive:Lt().A.formatMessage(Rn.drive),gist:Lt().A.formatMessage(Rn.gist),figma:Lt().A.formatMessage(Rn.figma),invision:Lt().A.formatMessage(Rn.invision),abstract:Lt().A.formatMessage(Rn.abstract),framer:Lt().A.formatMessage(Rn.framer),whimsical:Lt().A.formatMessage(Rn.whimsical),mixpanel:Lt().A.formatMessage(Rn.mixpanel),miro:Lt().A.formatMessage(Rn.miro),sketch:Lt().A.formatMessage(Rn.sketch),excalidraw:Lt().A.formatMessage(Rn.excalidraw),replit:Lt().A.formatMessage(Rn.replit),audio:Lt().A.formatMessage(Rn.audio),maps:Lt().A.formatMessage(Rn.maps),loom:Lt().A.formatMessage(Rn.loom),typeform:Lt().A.formatMessage(Rn.typeform),codepen:Lt().A.formatMessage(Rn.codepen),pdf:Lt().A.formatMessage(Rn.pdf),embed:Lt().A.formatMessage(Rn.embed),hex:Lt().A.formatMessage(Rn.hex),deepnote:Lt().A.formatMessage(Rn.deepnote),drawing:Lt().A.formatMessage(Rn.drawing)};const Nn=function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,a().O$)(Tn().A);return(0,_.jsx)(x().Ay,{popupType:t.isMobileNative&&!t.isTablet?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,_.jsx)(Bn().A,{}):(0,_.jsx)(Wn,{}),onDismiss:()=>En(e)})};function En(e){const t=Tn().A.state;if(!t.open)return;const{url:n}=t;wn().ol(e,{url:n,type:"close"}),jn().VN()}function Fn(e,t){const n=Tn().A.state;if(!n.open)return;const{url:o}=n;jn().Ju({environment:t,type:e}),"form"!==e&&wn().ol(t,{url:o,type:e})}function Un(e,t){const{device:n}=t,{url:o,textStore:i}=e,{currentSpaceStore:a}=J().default.state,r=[],s=(0,Mn().parseRoute)({url:o,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName,isMobile:n.isMobile,protocol:G().A.protocol,currentUrl:window.location.href}),l=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"],d=i.getRecordStoreUIParent(),c="page"===s.name?s.blockId:"team"===s.name?s.peekViewBlockId:void 0,u="page"===s.name&&s.scrollToBlockId,p="page"===s.name?s.collectionViewId:void 0;if(c){const e=ee().Bv.createChildStore(i,{table:An().ev,id:c});e.isType("form")&&r.push({name:Lt().A.formatMessage(Dn.embed),validator:()=>!jn().en(i)&&zn(d)&&(null==a?void 0:a.id)===e.getSpaceId(),type:$e().xd.form});const t=u?ee().Bv.createChildStore(i,{table:An().ev,id:u}):void 0;r.push({name:Lt().A.formatMessage(Dn.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!jn().en(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(o)}(e,p))&&!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(o)}(e,p)&&(null==a?void 0:a.id)===e.getSpaceId()&&zn(d)&&Kn(e),type:$e().xd.collectionView}),r.push({name:Lt().A.formatMessage(void 0===t?Dn.mentionPage:Dn.mentionBlock),validator:()=>Kn(e),type:"mention-page"}),r.push({name:Lt().A.formatMessage(Dn.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!jn().en(i)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==a?void 0:a.id)&&zn(d)&&Kn(e)),type:"create-transclusion"}),X().default.checkGate({gateName:"enable_page_previews"})&&r.push({name:Lt().A.formatMessage(Dn.pagePreview),validator:()=>!t&&!e.isCollectionView()&&!jn().en(i)&&Kn(e)&&zn(d)&&!e.isType("form"),type:"page-preview"})}const m=Cn().HP(On);for(const f of m)"embed"!==f&&r.push({name:On[f],validator:e=>Sn().dA[f](e)&&zn(d),type:f});r.push({name:Lt().A.formatMessage(Dn.bookmarkMenuItem),validator:e=>!jn().en(i)&&zn(d)&&Sn().Vp(e),type:$e().xd.bookmark}),r.push({name:On.embed,validator:e=>!jn().en(i)&&zn(d)&&Sn().dA.embed(e),type:"embed"});const g=f().oE(r.map((e=>{let{name:n,validator:i,type:a}=e;if(i({url:o,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,_.jsx)(Et().A,{...e,title:n}),action:()=>Fn(a,t)}}}))),h={key:"link-mention",render:e=>(0,_.jsx)(Et().A,{...e,title:Lt().A.formatMessage(Dn.linkMention)}),action:()=>Fn("link-mention",t)},y={key:"dismiss",render:e=>(0,_.jsx)(Et().A,{...e,title:Lt().A.formatMessage(Dn.dismissItem)}),action:()=>En(t)};if(0===g.length)return[];(0,Mn().Jx)(s)?g.push(y):(Vn(o,l)?("embed Create bookmark"!==g[0].key||g.reverse(),g.push(y)):g.unshift(y),X().default.checkGate({gateName:"enable_link_mentions"})&&g.splice(0,0,h));const v={key:"embed section",render:e=>(0,_.jsx)(Ut().A,{...e}),items:g},b={key:"import section",render:e=>(0,_.jsx)(Ut().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(_n().A,{size:4}),(0,_.jsx)(Et().A,{...e,title:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(K().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,_.jsx)(Ln().A,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const o=Tn().A.state;if(!o.open)return;const{url:i}=o,a=J().default.state.mainEditorCurrentBlockStore,r=a&&(null===(t=(0,In().Uo)(a))||void 0===t?void 0:t.id),s=null===(n=i.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];Pn().Ay.setState({...Pn().Ay.state,teamSpaceId:r,projectKeys:s?[s]:[]}),kn().jh({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,Tt().u4)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:Pn().Ay.createNewFlowId(),from:"link_paste_menu"}}}),jn().VN(),wn().ol(e,{url:i,type:"jira-sync"})}(t)}]};return Vn(o,["atlassian.net/jira","/jira/"])?[v,b]:[v]}function Vn(e,t){return t.some((t=>e.includes(t)))}function Kn(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,xn().xm)(t)}function zn(e){if(!(e instanceof ee().Bv))return!1;const t=e.getType();return!!t&&(0,$e().IU)(t,e.getFormat())}function Wn(){const e=(0,i().v3)(),{device:t}=e,n=(0,a().K8)((()=>{const t=Tn().A.state;return t.open?Un(t,e):null}),[e]),r=(0,a().K8)((()=>!!Tn().A.state.loading),[]),s=(null==n?void 0:n.length)??0;(0,o.useEffect)((()=>{r||0!==s||jn().VN()}),[s,r]),function(){const e=(0,a().O$)(Tn().A),t=(0,a().O$)(I().default);(0,o.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,M().KP)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||jn().VN()}}),[e,t])}();const l=(0,Ie().IS)((e=>({header:t.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:_e().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:_e().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[t]);if(null===n)return null;let d;return d=t.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:n.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},(0,_.jsx)(_.Fragment,{children:r?(0,_.jsx)(Bn().A,{style:{marginLeft:3,marginRight:3}}):(0,_.jsx)(b().A,{...d,className:_t().poM,header:(0,_.jsx)(Yt().A,{style:l.header,isSmall:!t.isMobile,isSecondaryColor:!t.isMobile,children:(0,_.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:n,initialFocus:0})})})}var Hn=()=>n(633457),Gn=()=>n(523713);function Yn(){const e=(0,i().v3)(),t=e.currentUser.id,n=(0,a().K8)((()=>{var e;return null===(e=J().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),r=(0,a().K8)((()=>(0,Gn().x)({isPhone:e.device.isPhone,spaceStore:J().default.state.currentSpaceStore})),[e.device]);return(0,o.useEffect)((()=>{if(!n||!t||!r)return;const o=Q().Ay.addListener((0,U().DZ)({notionUserId:t,spaceId:n}),void 0,(0,Q().AY)(((t,n,o,i)=>{-1!==i&&qn(e)})),void 0,e);return function(){o&&Q().Ay.removeListener(o,e)}}),[e,t,n,r]),null}const qn=(0,f().sg)((e=>{Hn().oX({environment:e})}),5e3,{leading:!0,trailing:!0});var Qn=()=>n(908006),$n=()=>n(522419),Zn=()=>n(681546),Jn=()=>n(452951),Xn=()=>n(340498);const eo=(0,Xn().wt)("collapse",{viewBox:"0 0 16 16",svg:(0,_.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var to=()=>n(812318),no=()=>n(236190),oo=()=>n(689094),io=()=>n(343666),ao=()=>n(100622),ro=()=>n(124952),so=()=>n(235116),lo=()=>n(35622),co=()=>n(797265),uo=()=>n(778417),po=()=>n(569912),mo=()=>n(129522),go=()=>n(640867),fo=()=>n(145214),ho=()=>n(493823),yo=()=>n(625325);const vo={background:"rgba(255, 255, 255, 0.055)"},bo={padding:"6px 10px 6px 6px"},xo={padding:"6px 6px 6px 10px"},So={display:"flex",borderRadius:4,background:ao().Ay.blackWithAlpha(.65)},Mo=.5,Ao=.5,Co=2,wo=-.002,jo=-.004;function ko(e){let{visible:t,isOpen:n,zoomScale:o,handleZoomIn:r,handleZoomOut:s,handleNext:l,handlePrevious:d,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,resetHideControlsTimeout:m,clearHideControlsTimeout:f,isSaving:h,isEditingZoom:y,handleClose:v}=e;const b=(0,i().Y0)(),x=(0,i().v3)(),{blockStore:S,imageUrl:M}=(0,a().K8)((()=>({blockStore:go().A.state.blockStore,imageUrl:go().A.state.imageUrl})),[]),A=(0,a().K8)((()=>{var e;return Boolean(S&&(M||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&g().q4_(S.getProperties().source)))}),[S,M]);if(b.isMobile)return null;return(0,_.jsxs)(fo().A,{visible:t,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:Oo(n),onClick:e=>{!function(e){e.stopPropagation()}(e),m(),u()},children:[(0,_.jsx)("div",{style:{...So,marginRight:10},children:(0,_.jsx)(To,{handlePrevious:d,handleNext:l})}),(0,_.jsxs)("div",{style:So,children:[(0,_.jsx)(Io,{zoomScale:o,handleZoomIn:r,handleZoomOut:s,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,isEditingZoom:y}),(0,_.jsx)(Ko,{}),A?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Po,{onClick:()=>{if(!S||!A)return;go().A.setState({...go().A.state,isSaving:!0}),f();const e=null==S?void 0:S.getProperties();let t,n;if(t=M||g().q4_(null==e?void 0:e.source),t){if((0,$n()._J)(t)){const o=g().q4_(null==e?void 0:e.title)||(0,$n().Jt)(t);n=so().KE(x,{url:t,download:!0,downloadName:o,permissionRecord:S.pointer})}else{const o=g().q4_(null==e?void 0:e.caption);n=(0,$n().pJ)(t,null==S?void 0:S.pointer,G().A.domainBaseUrl,x.currentUser.id,o)}n.then((()=>{go().A.setState({...go().A.state,isSaving:!1}),(0,ro().d)(x,{type:"download",triggered_by:"click"}),m()}))}},loading:h}),(0,_.jsx)(Ko,{})]}):void 0,(0,_.jsx)(_o,{onClick:v})]})]})}function Io(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:a,setZoomScale:r,disableZoomEditing:s,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i().v3)(),p=(0,o.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,ro().d)(u,{type:"set_zoom",new_zoom:e}),r(e)}s()}),[s,u,r]);return(0,_.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=Ao,render:e=>(0,_.jsx)(ho().p,{...e,disabled:t<=Ao,style:{...Fo(t<=Ao),...xo},onClick:a,icon:e=>(0,no().c)({...e,fill:No(),height:16,margin:0,width:16})})}),d?(0,_.jsx)(Bo,{initialValue:c,onSubmit:p,onCancel:s,primaryColor:No(),secondaryColor:Eo()}):(0,_.jsx)(ho().p,{onClick:e=>{e.stopPropagation(),l()},style:{color:Eo(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=Co,render:e=>(0,_.jsx)(ho().p,{...e,disabled:t>=Co,style:Fo(t>=Co),onClick:n,icon:e=>(0,oo().W)({...e,fill:No(),height:16,margin:0,width:16})})})]})}function To(e){let{handlePrevious:t,handleNext:n}=e;const o=(0,_.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:r}=(0,a().K8)((()=>{const{blockStore:e}=go().A.state;return{blockStore:e,allImageBlocksOnPage:e?Ro():[]}}),[]);if(!i)return o;if(r.length<=1)return o;const s=r.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===s)return o;const l=r.length;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,_.jsx)(Uo,{imageIndex:s-1,totalImageCount:l})}),disableTooltip:0===s,render:e=>(0,_.jsx)(ho().p,{...e,disabled:s<=0,style:{...Fo(s<=0),...xo},hoveredStyle:vo,onClick:()=>t(),icon:e=>(0,Zn().i)({...e,fill:No(),height:16,margin:0,width:16})})}),(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,_.jsx)(Uo,{imageIndex:s+1,totalImageCount:l})}),disableTooltip:s+1===l,render:e=>(0,_.jsx)(ho().p,{...e,disabled:s>=l-1,style:{...Fo(s>=l-1),...bo},hoveredStyle:vo,onClick:()=>n(),icon:e=>(0,Jn().Z)({...e,fill:No(),height:16,margin:0,width:16})})})]})}function Po(e){let{onClick:t,loading:n}=e;return(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,_.jsx)(ho().p,{...e,disabled:n,onClick:t,style:Fo(!1),hoveredStyle:vo,children:n?(0,_.jsx)(Bn().A,{size:"sm"}):(0,to().k)({fill:No(),width:16})})})}function _o(e){let{onClick:t}=e;return(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Vo,{primaryText:(0,_.jsx)(K().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,_.jsx)(ho().p,{...e,onClick:t,style:{...Fo(!1),...bo},hoveredStyle:vo,icon:e=>eo({...e,fill:No(),height:16,margin:0,width:16})})})}function Bo(e){const[t,n]=(0,o.useState)(e.initialValue);return(0,_.jsx)(Gt().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Gt().C.Transparent,right:(0,_.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const Lo=function(){const e=(0,i().v3)(),t=(0,o.useRef)(!1),r=(0,o.useRef)(),s=(0,o.useRef)(),[l,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(void 0),[p,m]=(0,o.useState)(!1),{isOpen:g,rendered:h,fullScreenNodeRect:y,fullscreenNodeAnimationComplete:v,contentAspectRatio:b,zoomScale:x,panOffset:S,skipAnimations:M,isSaving:A,blockStore:C,panStartPosition:w}=(0,a().K8)((()=>{var e;const{state:t}=go().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),j=(0,a().K8)((()=>{const t=e.WindowSizeStore.state.width;return lo().wX(t)}),[e.WindowSizeStore]);(0,n(388487).A)({capture:g,preventType:et().A.All});const k=(0,o.useCallback)((()=>{r.current&&clearTimeout(r.current)}),[]),I=(0,o.useCallback)((()=>{m(!0),k(),l||A||(r.current=setTimeout((()=>m(!1)),2e3))}),[k,l,A]),T=(0,o.useCallback)((e=>{I();const t=Math.max(Math.min(e,Co),Ao),n=t<=1?{x:0,y:0}:S;go().A.setState({...go().A.state,zoomScale:t,panOffset:n})}),[S,I]),P=(0,o.useCallback)((e=>{const t=Go(e,c);t&&(e.x!==t.x&&(w.x=w.x+(e.x-t.x)),e.y!==t.y&&(w.y=w.y+(e.y-t.y)),go().A.setState({...go().A.state,panOffset:t,panStartPosition:w}))}),[c,w]),B=(0,o.useCallback)((()=>{d(!1),go().A.setState({...go().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),L=(0,o.useCallback)((()=>{d(!0),k()}),[k]),R=(0,o.useCallback)((()=>{d(!1),I()}),[I]),D=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];lo().VN(),(0,ro().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),uo().IU({environment:e}),Ho(),Qn().default.afterNextFlush((()=>{B()}))}),[e,B]),N=(0,o.useCallback)((e=>{(0,O().Vt)(e)||D()}),[D]),E=(0,o.useCallback)((e=>{if(e.stopPropagation(),(0,O().Vt)(e))return;let t,n;t=x<1?1:x<1.5?1.5:1,n=t<=1?{x:0,y:0}:Go({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},c)??S,go().A.setState({...go().A.state,zoomScale:t,panOffset:n}),I(),R()}),[c,R,S,I,x]),F=(0,o.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!C)return;const o=Ro();if(!o)return;const i=o.findIndex((e=>e.id===C.id));if(i+t<0||i+t>=o.length)return;(0,ro().d)(e,{type:t>0?"next":"previous",image_count:o.length,image_index:i+t,triggered_by:n?"keypress":"click"}),go().A.setState({...go().A.state,skipAnimations:!0}),s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{go().A.setState({...go().A.state,skipAnimations:!1})}),250);const a=o[i+t];co().iy({environment:e,blockStore:a}),B()}),[C,e,B]),U=(0,o.useCallback)((function(){F(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[F]),V=(0,o.useCallback)((function(){F(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[F]),K=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(x-Mo))/2;x-n<.25&&(n-=Mo),(0,ro().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),z=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(x+Mo))/2;n-x<.25&&(n+=Mo),(0,ro().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),W=(0,o.useCallback)((e=>{c&&1===e.buttons&&Do()&&P({x:e.clientX/x-w.x,y:e.clientY/x-w.y})}),[c,w.x,w.y,P,x]),H=(0,o.useCallback)((e=>{switch(e.key){case"+":case"=":z(!0);break;case"-":case"_":K(!0)}}),[z,K]);(0,o.useEffect)((()=>{const e=e=>{T(x+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*jo):t.deltaX&&e(t.deltaX*jo):t.metaKey?t.deltaY?e(t.deltaY*wo):t.deltaX&&e(t.deltaX*wo):Do()&&P({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,S.x,S.y,P,T,x]);const G=window.innerWidth,Y=window.innerHeight-2*j;let q=G-2*j;const Q=b??(y?y.width/y.height:void 0);if(void 0===Q)return null;let $=q/Q;if($>Y){const e=$/Y;$/=e,q/=e}const Z={opacity:0},J={scale:x,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let X;return X=p?x>=1.5?"zoom-out":"zoom-in":"none",(0,_.jsx)(yo().A,{open:g||!v,children:(0,po().A)((e=>(0,_.jsx)(nt().A,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{D(!0)},onEnter:f().D_,onSpace:()=>D(!0),onCommandEnter:()=>D(!0),onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onUp:f().D_,onDown:f().D_,onDelete:f().D_,onBackspace:f().D_,onLeft:()=>U(!0),onRight:()=>V(!0),onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:H,children:(0,_.jsxs)("div",{style:Yo({isOpen:g,showControls:p}),...e,onClick:N,onMouseMove:I,children:[g&&(0,_.jsx)(n(552713).B,{}),(0,_.jsx)(fo().A,{visible:g,initial:Z,exit:Z,animate:J,skip:M,forceCompositeLayer:!0,style:{display:"flex",cursor:X,maxWidth:q,maxHeight:$,justifyContent:"center"},ref:e=>{e&&!c&&u({width:e.clientWidth,height:e.clientHeight})},onClick:E,onMouseDown:Wo,onMouseUp:Ho,onMouseLeave:Ho,onMouseMove:W,onAnimationEnd:zo,children:h}),(0,_.jsx)(ko,{visible:p,isOpen:g,zoomScale:x,handleZoomIn:z,handleZoomOut:K,handlePrevious:U,handleNext:V,setZoomScale:T,disableZoomEditing:R,enableZoomEditing:L,clearHideControlsTimeout:k,resetHideControlsTimeout:I,isSaving:A,isEditingZoom:l,handleClose:D})]})})))})};function Ro(){const{blockStore:e}=go().A.state;if(!e)return[];if(function(){const{blockStore:e}=go().A.state;return(null==e?void 0:e.getParentTable())===io().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Nt().default.getCurrentRootStore();return mo().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function Do(){const{zoomScale:e}=go().A.state;return e>1}function Oo(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function No(){return ao().Ay.white}function Eo(){return ao().Ay.whiteWithAlpha(.5)}function Fo(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function Uo(e){let{imageIndex:t,totalImageCount:n}=e;return(0,_.jsx)(K().sA,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function Vo(e){const{primaryText:t,secondaryText:n}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,_.jsx)("span",{style:{color:Eo()},children:n}):void 0]})}function Ko(){return(0,_.jsx)("span",{style:{borderLeft:`1px solid ${ao().Ay.whiteWithAlpha(.25)}`,height:"100%"}})}function zo(){const{isOpen:e}=go().A.state;e||go().A.setState({...go().A.state,fullscreenNodeAnimationComplete:!0})}function Wo(e){const{panOffset:t,zoomScale:n}=go().A.state;go().A.setState({...go().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function Ho(){go().A.setState({...go().A.state,skipAnimations:!1})}function Go(e,t){if(!t)return;let n,o;n=t.width*Co>window.innerWidth?(t.width*Co-window.innerWidth)/(2*Co):(window.innerWidth-t.width*Co)/(2*Co),o=t.height*Co>window.innerHeight?(t.height*Co-window.innerHeight)/(2*Co):(window.innerHeight-t.height*Co)/(2*Co);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*o),o)}}function Yo(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var qo=()=>n(851860),Qo=()=>n(448619),$o=()=>n(969197),Zo=()=>n(792002),Jo=()=>n(569777);const Xo=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),r=(0,o.useCallback)((n=>function(e,t,n){if(!Jo().A.isOpen())return;if(!n.current)return;const o=n.current.getSelection();if(!o)return;const i=Jo().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&o.startIndex===i&&o.endIndex===i&&(ni(t),Qo().IV())}(n,e,t)),[e]),s=(0,o.useCallback)((n=>function(e,t,n){if(!n.current)return;const o=n.current.getSelection();if(!o)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===o.startIndex&&0===o.endIndex&&(ni(t),Qo().IV(Jo().q.Backward))}(n,e,t)),[e]),l=(0,o.useCallback)((()=>ni(e)),[e]),c=(0,a().K8)((()=>Jo().A.state),[]),u=(0,a().K8)((()=>function(){if(!Jo().A.isOpen())return;return Jo().A.state.savedTextSelectionRect}()),[]),p=(0,a().K8)((()=>function(){var e;if("editing"!==I().default.state.mode&&!Jo().A.isOpen())return!0;const t=Jo().A.isOpen()?null===(e=(0,M().H7)(Jo().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,$o().TL)(t);if(e&&e.isNonEditableState())return!0}const n={[g().Ifu.User]:g().Ifu.User,[g().Ifu.Page]:g().Ifu.Page,[g().Ifu.CustomEmoji]:g().Ifu.CustomEmoji,[g().Ifu.Comment]:g().Ifu.Comment,[g().Ifu.Bot]:g().Ifu.Bot,[g().Ifu.Date]:g().Ifu.Date,[g().Ifu.ExternalObjectInstance]:g().Ifu.ExternalObjectInstance,[g().Ifu.TemporaryPage]:g().Ifu.TemporaryPage,[g().Ifu.TemplateVariable]:g().Ifu.TemplateVariable,[g().Ifu.FormulaPageProperty]:g().Ifu.FormulaPageProperty,[g().Ifu.FormulaContextValue]:g().Ifu.FormulaContextValue,[g().Ifu.Group]:g().Ifu.Group,[g().Ifu.Team]:g().Ifu.Team,[g().Ifu.Citation]:g().Ifu.Citation,[g().Ifu.LinkMention]:g().Ifu.LinkMention,[g().Ifu.AssistantInstructionsCollection]:g().Ifu.AssistantInstructionsCollection,[g().Ifu.GeoPoint]:g().Ifu.GeoPoint};for(const o of Object.values(n))if((0,Zo().y_)(o))return!0;return!1}()),[]);if(!c.open)return null;const m=c.value,f=c.error;return(0,_.jsx)(d().u2,{dependency:n(354584).y,children:e=>c.open?(0,_.jsx)(n(548901).A,{Prism:e,ref:t,isOpen:!0,equationValue:m,error:f,displayMode:"inline",disabled:p,originRect:u,originGap:8,onDismiss:ti,onChange:ei,onSubmit:l,onLeft:s,onRight:r}):null})};function ei(e,t){Jo().A.isOpen()&&Jo().A.setState({...Jo().A.state,value:e,error:t})}function ti(){Qo().IV()}function ni(e){v().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{Qo().t5({environment:e,equationStore:Jo().A,transaction:t})}})}var oi=()=>n(813743),ii=()=>n(728611),ai=()=>n(487494),ri=()=>n(525112);function si(e){switch(e){case ai().A.Preview:return(0,_.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case ai().A.Mention:return(0,_.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case ai().A.Link:return(0,_.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,me().HB)(e)}}const li=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),[n]=(0,a().$y)(ri().A),r=(0,o.useCallback)((t=>{if(n.open){var o;if(!t)oi().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!1});ri().A.setState({open:!1})}}),[e,n]),s=(0,o.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&r(void 0)}),[r,n.open]),l=(0,o.useCallback)((e=>{if(!n.open||!e.target)return;const o=t.current;o&&(o.contains(e.target)||r(void 0))}),[r,n.open]);(0,o.useEffect)((()=>((0,ii().P4)(window,"keydown",s),(0,ii().P4)(window,"mousedown",l),()=>{(0,ii().Ol)(window,"keydown",s),(0,ii().Ol)(window,"mousedown",l)})),[s,l]);const d=(0,o.useRef)(!1);function c(t){var o;n.open&&void 0!==t.indexGlobal&&(ri().A.setState({...n,focusedIndex:t.indexGlobal}),oi().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0}))}(0,a().K8)((()=>{var t,o;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(o=n.args.commentStore.state)||void 0===o?void 0:o.isReady()))??!1;var a;i&&!d.current&&n.open&&oi().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(a=n.args.commentStore)||void 0===a?void 0:a.state,useTempStores:!0});d.current=i}),[e,n]);const u=(0,a().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),p=e.device.isMobile;return(0,_.jsx)(x().Ay,{popupType:u?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:w().W.Top,alignmentToOrigin:w().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:p,keepFocus:p,render:function(){var o;const{device:i}=e;if(!n.open)return;const a=function(t){const{url:n,args:o}=t,i=[];i.push({title:si(ai().A.Preview),validator:()=>!0,type:ai().A.Preview}),i.push({title:si(ai().A.Mention),validator:()=>!0,type:ai().A.Mention}),i.push({title:si(ai().A.Link),validator:()=>!0,type:ai().A.Link});return[{key:"menu section",render:e=>(0,_.jsx)(Ut().A,{...e}),items:f().oE(i.map((t=>{let{title:i,validator:a,type:r}=t;if(a({url:n,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`item ${r}`,render:t=>(0,_.jsx)(Et().A,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),oi().fS({actionType:r,environment:e,commentStore:null===(i=o.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return oi().fS({actionType:r,environment:e,commentStore:null===(t=o.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),r=i.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:_e().Wy.semibold,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:_e().Wy.semibold};let s;return s=i.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:200,maxHeight:"40vh"},null!==(o=n.args.commentStore)&&void 0!==o&&o.state&&n.args.commentStore.state.isReady()?(0,_.jsx)(b().A,{...s,className:_t().poM,ref:t,header:(0,_.jsx)(Yt().A,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,_.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:a,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,_.jsx)(b().A,{...s,className:_t().poM,ref:t,header:(0,_.jsx)(Yt().A,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,_.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,_.jsx)(Ut().A,{style:{display:"flex",justifyContent:"center"},children:(0,_.jsx)(Bn().A,{})})})},onDismiss:()=>r(void 0)})};var di=()=>n(775812),ci=(n(672577),()=>n(829300)),ui=()=>n(536612),pi=()=>n(663038),mi=()=>n(691298),gi=()=>n(875497),fi=()=>n(529183),hi=()=>n(757695);class yi extends hi().default{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const vi=yi;var bi=()=>n(375447),xi=()=>n(472090),Si=()=>n(278132),Mi=()=>n(743176),Ai=()=>n(247331),Ci=()=>n(977345),wi=()=>n(380048),ji=()=>n(353147),ki=()=>n(476724),Ii=()=>n(381138),Ti=()=>n(379632),Pi=()=>n(983650),_i=()=>n(267419);function Bi(e){return"+"===e.insertionType?(0,_.jsx)(Li,{}):(0,_.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,_.jsx)(Ni,{svg:Ii().q.__iconDefinition.svg,viewBox:Ii().q.__iconDefinition.viewBox})})}function Li(){return(0,_.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,_.jsx)(Ni,{svg:oo().W.__iconDefinition.svg,viewBox:oo().W.__iconDefinition.viewBox})})}function Ri(){return(0,_.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,_.jsx)(Ni,{svg:ki().I.__iconDefinition.svg,viewBox:ki().I.__iconDefinition.viewBox})})}function Di(){return(0,_.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,_.jsx)(Ni,{svg:ji().b.__iconDefinition.svg,viewBox:ji().b.__iconDefinition.viewBox})})}function Oi(e){const{pageStore:t,theme:n,isSafariOrIOS:o,emojiType:i,currentUserId:a}=e;return(0,Pi().h6)({pageModel:t.getModel(),pageRole:t.getRole(),showEmojiInline:!0,emojiType:i,baseUrl:G().A.domainBaseUrl,getRecordModel:t.getRecordModel,isClient:!0,isSafariOrIOS:o,currentUserId:a,theme:n,emojiData:_i().A.state})}function Ni(e){const{svg:t,viewBox:n}=e,i=(0,o.useMemo)((()=>{const e=Ti().A.renderToString((0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,n]),a=(0,Ie().IS)((e=>({container:{width:"100%",height:"100%",backgroundColor:e.mediumIconColor,WebkitMaskImage:i,maskImage:i,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})),[i]);return(0,_.jsx)("div",{style:a.container})}var Ei=()=>n(17022);class Fi extends hi().default{getInitialState(){}}const Ui=new Fi;function Vi(e){const{isFirefox:t}=(0,i().Y0)();return(0,o.useCallback)((n=>{Ei().A.withListenerIgnored((()=>{var o;const i=bi().A.state;if(!i.open)return;if(!n)return void i.temporaryInputData.setState(void 0);const{title:a,icon:r,allowTabCompletion:s}=n,l=e.current??"",d=a.toLowerCase().startsWith(l)?i.oldTextValue&&0!==(null===(o=i.oldTextValue)||void 0===o?void 0:o.length)?"":a.slice(l.length):"";Ui.setState(s?d:void 0);const c=t?void 0:r;i.temporaryInputData.setState({prefix:i.insertionType,suffix:"[["===i.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const Ki=(0,K().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}'s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),zi=o.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,r=(0,a().K8)((()=>330),[]),s=(0,a().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===Ai().FormulaContextValueKind.ContextValue)return e}),[t]),l=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:o}=e,r=(0,i().v3)(),s=(0,K().tz)(),l=(0,a().K8)((()=>{if(!t)return;const e=Pt().oc();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,me().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const o=ee().md.createChildStore(e,n);return o.getSchema()}(e,t):void 0}),[t]);if(!t||!l)return[];const d=(0,Ci().sM)(t);return(0,f().oE)(Object.entries(l).map((e=>{let[i,a]=e;if(a&&Ai().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(a.type))return{action:e=>{v().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{const l=(0,g().ESw)({contextValueId:t.id,name:(0,Si().Nl)(s,d,a.name),property:i,valueSnapshot:"current"});ci().Ju({annotations:[l],editorMode:"default",environment:r,mentionType:"formulaContextVariable",menuListItemAction:e,query:n.current??"",transaction:o})}})},key:`formula property ${i}`,render:e=>(e.focused&&o({allowTabCompletion:!0,icon:(0,_.jsx)(Di,{}),title:s.formatMessage(Ki.possessiveContextValueProperty,{contextValueName:d,propertyName:a.name})}),(0,_.jsx)(Et().A,{...e,icon:(0,_.jsx)(Wi,{children:Mi().Yp[a.type]({height:17,width:17})}),title:a.name}))}})))}({contextValue:s,queryRef:n,setTemporaryInputData:Vi(n)}),d=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:i}=e,a=(0,K().tz)(),r=(0,o.useCallback)((()=>{i.setState({formulaTypecheckContextValue:void 0}),bi().A.updateOpenState({showFormulaProperty:!1})}),[i]),s=(0,Ie().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,Ci().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,_.jsx)(Ut().A,{...e,desktopTitleStyle:s.sectionDesktopTitle,title:(0,_.jsxs)("header",{style:s.titleHeader,children:[(0,_.jsx)(Ee().A,{ariaLabel:a.formatMessage(Ki.backButtonAriaLabel),icon:wi().I,iconStyle:s.backButtonIcon,onClick:r,style:s.backButton}),(0,_.jsx)(K().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:s,items:l,mentionMenuCurrentFormulaStore:t});if(!d||0===d.length)return null;const c={menuType:S().gu.Popup,width:r};return(0,_.jsx)(b().A,{...c,children:(0,_.jsx)(Ft().Ay,{initialFocus:0,sections:d,type:Ft().Oh.Vertical})})}));function Wi(e){const{children:t}=e,n=(0,Ie().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,_.jsx)("div",{style:n.wrapper,children:t})}class Hi extends hi().default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const Gi=Hi;function Yi(e,t){return t?bi().A.state.open&&"@"===bi().A.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():bi().A.state.open&&"[["===bi().A.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var qi=()=>n(296206),Qi=()=>n(966505),$i=()=>n(766637);function Zi(e,t){const n=(0,a().K8)((()=>bi().A.getMentionMenuContext()),[]);return(0,o.useCallback)((()=>{let o,i=Date.now();const a=bi().A.state;if(a.open&&(i=a.openTime,o=a.flowId),a.open){var r;const s=Date.now(),{numServerRequests:l}=$i().A.state,d=a.sessionId,c=a.showMentionAndShare;qi().sM(e,{timeToAbandonInMs:s-i,analyticsFrom:n,queryLength:(null===(r=t.current)||void 0===r?void 0:r.length)??0,flowId:o,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}a.open&&a.showInvite&&Qi().F$(e,{origin:bi().A.getInviteOrigin(),invite_flow_id:a.flowId}),ci().VN()}),[n,e,t])}function Ji(e){let{usePopupOnMobile:t}=e;const n=(0,i().Y0)();return!t&&(n.isMobileNative&&!n.isTablet)}var Xi=()=>n(349471);function ea(e){let{clearSavedSelection:t,filter:n}=e;const o=(0,i().v3)(),r=(0,a().O$)(bi().A),s=(0,a().K8)((()=>330),[]);if(!r.open)return null;const l="block"===r.textStore.table?r.textStore.id:void 0;return(0,_.jsx)(Xi().Ay,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{ci().eh({environment:o,titleText:Yi(o,n),clearSavedSelection:t,createInValue:e,menuListItemAction:void 0})},parentBlockId:l,onAutocompleteQueryChange:ta,autocompleteQuery:r.createInQuery,desktopWidth:s,onCancel:na})}function ta(e){bi().A.updateOpenState({createInQuery:e})}function na(){bi().A.updateOpenState({showCreateIn:!1,createInQuery:""})}var oa=()=>n(690490);function ia(e){let{inviteTargetsStore:t,personPropertyInviteStore:n,filter:r}=e;const s=(0,i().v3)(),l=(0,o.useCallback)((()=>aa(s,t,n)),[s,t,n]),d=(0,a().K8)((()=>Pt().ao()),[]),c=(0,a().K8)((()=>bi().A.getInviteOrigin()),[]);return d?(0,_.jsx)(oa().A,{inviteOrigin:c,store:d,onInviteCompleteFn:e=>{if(!e.success)return aa(s,t,n),null;const{invitedUsers:o,requestedUsers:i}=e,a=f().xW(Object.values(o),Object.values(i));a.length?v().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:s,canUndo:!0,perform:e=>{ci().Ju({environment:s,editorMode:"default",annotations:a.map((e=>(0,g().P4h)(e))),transaction:e,menuListItemAction:void 0,query:Yi(s,r),mentionType:"user"})}}):aa(s,t,n)},handleBackButtonClick:l,inviteTargetsStore:t,personPropertyInviteStore:n}):null}function aa(e,t,n){const o=bi().A.state;o.open&&(Qi().F$(e,{origin:bi().A.getInviteOrigin(),invite_flow_id:o.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),bi().A.updateOpenState({showInvite:!1}))}var ra=()=>n(97835),sa=()=>n(763884),la=()=>n(134696),da=()=>n(579627),ca=()=>n(436572),ua=()=>n(574012),pa=()=>n(8980);const ma="ShowMentionInvite";function ga(e){return`${ma}-${e}`}function fa(e){const t=(0,i().v3)(),n=(0,a().K8)((()=>Pt().ao()),[]),{mentionMenuCurrentMentionStore:o,menuPopupType:r}=e,{userId:s,displayName:l,userEmail:d}=(0,a().K8)((()=>o.getState()),[o]),c=(0,a().K8)((()=>ua().A.mobileNativeBottomPadding(t)),[t]),u=(0,a().K8)((()=>bi().A.state.open),[]);if(!n)return null;const p={key:"invite buttons",render:e=>(0,_.jsx)(Ut().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,_.jsx)(Et().A,{title:(0,_.jsx)(K().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,_.jsx)(K().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:l}}),icon:(0,ji().b)({width:18}),...e}),action:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{ci().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(s)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),sa().A.set({userId:t.currentUser.id,key:ga(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,_.jsx)(Et().A,{title:(0,_.jsx)(K().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,_.jsx)(K().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:l}}),icon:(0,_.jsx)(pa().I,{icon:ra().x}),...e}),action:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{ci().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(s)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),v().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{da().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:s}],pagePermissionChangeLocation:"mention_share_menu"})}}),la().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:s,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:s}],invite_message_length:0}),ca().rL({item:{label:(0,_.jsx)(K().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:l}})},undoFunc:()=>v().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{da().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:s}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},m=r===S().gu.ActionSheet?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${c}px)`}:{menuType:S().gu.Popup};return(0,_.jsxs)(b().A,{...m,children:[(0,_.jsx)(nt().A,{debugName:"MentionMenu",capture:u}),(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:0,sections:[p]})]})}var ha=()=>n(227440),ya=()=>n(64e3);const va=(0,K().YK)({addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}});var ba=()=>n(30626),xa=()=>n(406792),Sa=()=>n(311337),Ma=()=>n(310109),Aa=()=>n(467730),Ca=()=>n(173979),wa=()=>n(578136),ja=()=>n(217827);var ka=()=>n(148307),Ia=()=>n(576250),Ta=()=>n(264879),Pa=()=>n(857783),_a=()=>n(553965);const Ba={..._e().RC,fontWeight:_e().Wy.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function La(e){const{pageTitle:t}=e;return t?(0,_.jsx)(K().sA,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,_.jsx)("span",{style:Ba,children:t})}}):(0,_.jsx)(K().sA,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ra(e){const{pageTitle:t}=e;return t?(0,_.jsx)(K().sA,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,_.jsx)("span",{style:Ba,children:t})}}):(0,_.jsx)(K().sA,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Da=()=>n(103448);function Oa(e){const{topBorder:t,query:n,clearSavedSelection:r,setTemporaryInputData:s}=e,{isOpen:l,insertionType:d,isCreatePageEnabled:c,textStore:u}=(0,a().K8)((()=>{const e=bi().A.state.open;return{isOpen:e,isCreatePageEnabled:bi().A.state.mentionTypes.createPage,insertionType:e?bi().A.state.insertionType:void 0,textStore:e?bi().A.state.textStore:void 0}}),[]),p=function(e){const{query:t,textStore:n,clearSavedSelection:r,setTemporaryInputData:s}=e,l=(0,i().v3)(),d=(0,K().tz)(),c=(0,a().K8)((()=>Ta().D8(n)),[n]),u=(0,o.useMemo)((()=>({key:"add new subpage",action:async e=>{c&&await ci().eh({environment:l,clearSavedSelection:r,titleText:t,createInValue:c.createInValue,onPageCreated:e=>{e&&""===g().q4_(e.getTitleValue())&&Pa().uK({environment:l,store:e,pageVisitSource:E().y8.Create})},menuListItemAction:e})},render:e=>{e.focused&&s({title:0===t.length?d.formatMessage(va.addPage):"",icon:(0,_.jsx)(Li,{}),allowTabCompletion:!1});const n=n=>(0,_.jsx)(Et().A,{...(0,_a().A)(n||{},e),icon:(0,oo().W)({width:16}),title:(0,_.jsx)(Ra,{pageTitle:t})});return l.device.isMobile?n():(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Da().A,{imageURL:ka().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,_.jsx)(K().sA,{...Xi().DZ.createSubpage})}),placement:w().W.Right,delayThreshold:0,render:e=>n(e)})}})),[l,r,c,d,t,s]);return u}({query:n,textStore:u,clearSavedSelection:r,setTemporaryInputData:s}),m=function(e){const{query:t,setTemporaryInputData:n}=e,a=(0,i().v3)(),r=(0,K().tz)(),s=(0,o.useCallback)((()=>{bi().A.updateOpenState({showCreateIn:!0})}),[]),l=(0,o.useMemo)((()=>({key:"open create in menu",action:s,render:e=>{e.focused&&n({title:0===t.length?r.formatMessage(va.addPage):"",icon:(0,_.jsx)(Li,{}),allowTabCompletion:!1});const o=n=>(0,_.jsx)(Et().A,{...(0,_a().A)(n||{},e),icon:(0,Ia().y)({width:16}),title:(0,_.jsx)(La,{pageTitle:t})});return a.device.isMobile?o():(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)(Da().A,{imageURL:ka().A.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,_.jsx)(K().sA,{...Xi().DZ.newPageIn})}),placement:w().W.Right,delayThreshold:0,render:e=>o(e)})}})),[a.device.isMobile,s,r,t,n]);return l}({query:n,setTemporaryInputData:s}),f="@"===d?(0,_.jsx)(K().sA,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;if(c&&l)return{key:"create page",render:e=>(0,_.jsx)(Ut().A,{title:f,...e,topBorder:t}),items:[p,m]}}var Na=()=>n(395361),Ea=()=>n(869190),Fa=()=>n(604995),Ua=()=>n(498140),Va=()=>n(5580);function Ka(e){const{category:t,query:n,setTemporaryInputData:o,templateVariableResults:a}=e,r=(0,i().v3)(),s=(0,K().tz)();return a.filter((e=>(0,Ca().BX)(e,t))).map((e=>({key:e,render:t=>{const n=(0,Ca().Ti)(e,s),i=(0,Ca().EC)(e,s);return t.focused&&o({title:n,icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),(0,_.jsx)(Et().A,{...t,title:n,caption:i,inline:!0})},action:t=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{ci().Ju({environment:r,editorMode:"default",annotations:[g().Ii$({type:e})],transaction:o,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var za=()=>n(742117),Wa=()=>n(575143);function Ha(e,t){return function(){t.setState({formulaTypecheckContextValue:e}),bi().A.updateOpenState({showFormulaProperty:!0})}}function Ga(e){const{formulaReturnType:t,query:n,formulaContextVariableResults:o,setTemporaryInputData:a}=e;return Ya({environment:(0,i().v3)(),formulaVariableFilter:e=>e.kind===Ai().FormulaContextValueKind.ContextValue&&e.type.type===t&&!(0,Ci().IF)(e),query:n,formulaContextVariableResults:o,setTemporaryInputData:a})}function Ya(e){const{environment:t,formulaVariableFilter:n,query:o,formulaContextVariableResults:i,setTemporaryInputData:a}=e;if(0===i.length)return[];const r=i.filter(n);return 0===r.length?[]:r.map((e=>{const n=(0,Ci().sM)(e),i=(0,Ci().E9)(e),r=(0,Ci().Ix)(e.type);return{action:qa(t,e,o),key:e.id,render:t=>(t.focused&&a({allowTabCompletion:!0,icon:(0,_.jsx)(Di,{}),title:e.name}),(0,_.jsx)(Wa().A,{...t,svg:r,title:n,tooltipText:i}))}}))}function qa(e,t,n){return function(o){v().createAndCommit({userAction:"MentionMenu.formulaMenuItem",environment:e,canUndo:!0,perform:i=>{const a=(0,g().CA$)(t);ci().Ju({annotations:[a],editorMode:"default",environment:e,mentionType:"formulaContextVariable",menuListItemAction:o,query:n,transaction:i})}})}}function Qa(e){const{topBorder:t,query:r,setTemporaryInputData:s,templateVariableResults:l,formulaContextVariableResults:d}=e,c=(0,i().v3)(),u=(0,K().tz)(),p=function(e){const[t,i]=(0,o.useState)([]),r=(0,K().tz)(),{areDateMentionsAllowed:s,areReminderMentionsAllowed:l}=(0,a().K8)((()=>({areDateMentionsAllowed:bi().A.state.mentionTypes.date,areReminderMentionsAllowed:bi().A.state.mentionTypes.reminder})),[]),d=(0,Va().n)(),c=(0,He().X)("chrono_node_date_mentions"),u=(0,o.useCallback)((async()=>{if(e.length<1)return;const t=await async function(e){const{query:t,intl:o,userLocal:i}=e,{chronoNodeDependency:a}=await Promise.all([n.e(91757),n.e(58587)]).then(n.bind(n,211051)),r=await a.load(),s={en:r.en.parse,ja:r.ja.parse,zh:r.zh.parse,fr:r.fr.parse,de:r.de.parse,es:r.es.parse,pt:r.pt.parse,nl:r.nl.parse}[i]??r.en.parse,l=s(t,void 0,{forwardDate:!0}),d=l.length>0?l[0]:void 0;if(!d)return;const{start:c,end:u}=d,p=c.isCertain("minute")||c.isCertain("hour"),m=(null==u?void 0:u.isCertain("minute"))||(null==u?void 0:u.isCertain("hour")),g=c.date().getTime(),f=null==u?void 0:u.date().getTime(),h=(0,F().P)(),y=Fa().KQ(g,h),v={unit:"day",value:0,time:un().lM,defaultTimeZone:h},b=t.toLowerCase().startsWith(o.formatMessage(Ua().DZ.remind).toLowerCase());let x;if(g&&!f)x=p?{...y,reminder:b?$a(c):void 0}:{type:"date",start_date:y.start_date,reminder:b?v:void 0};else if(f){const e=Fa().NC(g,f,(0,F().P)());x=p&&m?{...e,reminder:b?$a(c):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:b?v:void 0}}if(!x)return;let S=(0,Ea().ZF)({value:x,allowRelativeDates:!0,userTimeZone:(0,F().P)(),intl:o});b&&(S=o.formatMessage(Za.reminder,{dateTime:S}));return{label:S,value:()=>x}}({query:e,intl:r,userLocal:d});i(t?[t]:[])}),[r,e,d]),p=(0,Na().Y)((async()=>await u()),100);return(0,ue().Yb)((async()=>{if(!s)return;c&&p.cancel();const t=function(e){const{query:t,allowReminder:n,intl:o}=e;if(0===t.length)return(0,f().oE)([{label:o.formatMessage(Za.autocompleteToday),value:()=>Fa().Ec((0,F().P)())},n?void 0:{label:o.formatMessage(Za.autocompleteNextTuesday),value:()=>{const e=Fa().ah((0,F().P)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(Fa().tr),start_time:n.toFormat(un().GE),time_zone:(0,F().P)()}}},n?{label:o.formatMessage(Za.autocompleteReminder),value:()=>({type:"datetime",start_date:Fa().uf((0,F().P)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:un().lM,defaultTimeZone:(0,F().P)()},time_zone:(0,F().P)()})}:void 0]);const i=t.normalize("NFKD"),a=n?Ua().bm(i,o):Ua().FA(i,o);if(!a)return[];let r=(0,Ea().ZF)({value:a,date_format:"relative",userTimeZone:(0,F().P)(),intl:o,allowRelativeDates:!0});a.reminder&&(r=o.formatMessage(Za.reminder,{dateTime:r}));return[{label:r,value:()=>a}]}({query:e,allowReminder:l,intl:r}).slice(0,6);t.length>0||!c?i(t):await p()}),[p,s,e,l,r,c]),t}(r),m=Ka({templateVariableResults:l,category:"date",query:r,setTemporaryInputData:s}),g=Ga({formulaReturnType:"date",query:r,formulaContextVariableResults:d,setTemporaryInputData:s}),h=(0,o.useMemo)((()=>p.map((e=>{let{label:t,value:n}=e;return{key:t,render:e=>{if(e.focused&&s({title:t,icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),Ua().e_(t,u)){const o=(0,Ea().ZF)({value:n(),userTimeZone:(0,F().P)(),intl:u,allowRelativeDates:!1});return(0,_.jsx)(Et().A,{...e,title:t,caption:o,inline:!0})}return(0,_.jsx)(Et().A,{...e,title:t})},action:e=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:c,canUndo:!0,perform:t=>{const o=n();ci().Ju({environment:c,editorMode:"default",annotations:[["d",{...o,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:r,mentionType:o.reminder?"reminder":"date"})}})}}}))),[p,u,s,c,r]),y=(0,o.useMemo)((()=>[...g,...m,...h]),[h,g,m]),b=(0,o.useMemo)((()=>{if(y.length>0)return{key:"date results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),desktopTitleStyle:{paddingTop:4},topBorder:t}),items:y}}),[y,t]);return b}function $a(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:un().lM}}const Za=(0,K().YK)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"}});var Ja=()=>n(862139);const Xa=(0,K().YK)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function er(e){const{topBorder:t,query:n,setTemporaryInputData:r}=e,s=(0,i().v3)(),l=(0,K().tz)(),d=function(e){const{query:t}=e,n=(0,a().K8)((()=>bi().A.state.mentionTypes.group),[]),i=(0,a().K8)((()=>en().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))),[]),r=(0,o.useMemo)((()=>n?(0,Aa().Ay)(t,i,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,i]);return r}({query:n}),c=(0,a().K8)((()=>f().pY(en().A.state.permissionGroupsAndMemberCounts,(e=>e.group.group_id))),[]),u=(0,a().K8)((()=>{var e;return null===(e=J().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,o.useMemo)((()=>f().oE(d.map((e=>{var t;if(!u)return;const o=l.formatMessage(Xa.groupMentionCaption,{numMembersInGroup:(null===(t=c[e.group_id])||void 0===t?void 0:t.memberCount)||0});return{key:e.id,render:t=>(t.focused&&r({title:e.name||"",icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),(0,_.jsx)(Ja()._,{menuListItemProps:{...t,caption:o},group:e})),action:t=>{v().createAndCommit({userAction:"MentionMenu.groupMention",environment:s,canUndo:!0,perform:o=>{ci().Ju({environment:s,editorMode:"default",annotations:[g().dWL(e.group_id,u)],transaction:o,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[d,u,l,c,r,s,n]);if(0!==d.length)return{key:"group results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t}),items:p}}var tr=()=>n(125958),nr=()=>n(712505),or=()=>n(417522);function ir(e){const t=(0,i().v3)(),n=(0,K().tz)(),{query:o,setTemporaryInputData:r,topBorder:s}=e,l=function(e){const{intl:t,query:n}=e,o=n.toLowerCase(),i=(0,He().X)("mention_menu_page_headings"),r=(0,a().K8)((()=>{const e=(0,Pt().ZO)();if(!e)return;const{mainEditorCurrentBlockStore:t}=J().default.state;return e===t?t:nr().default.peekTargetStore.state===e?nr().default.peekTargetStore.state:void 0}),[]),s=(0,a().K8)((()=>{if(!i||!r)return[];const e=X().default.checkGate({gateName:"toc_nested_headings"});return(0,tr().T)(r.id,r.getRecordModel,e)}),[i,r]),l=(0,a().K8)((()=>r?(0,f().oE)(s.map((e=>{const n=ee().Bv.createChildStore(r,{table:An().ev,id:e}),i=n.getModel();if(!i)return;const a=i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,F().P)(),intl:t});return a&&a.toLowerCase().includes(o)?n:void 0}))):[]),[t,o,r,s]);return l}({query:o,intl:n}),d=0===l.length,c=(0,a().K8)((()=>l.map((e=>{const i=e.id;return{key:i,render:t=>{if(t.focused){const t=e.getModel();if(t){const o=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,F().P)(),intl:n});r({title:o||"",icon:(0,_.jsx)(Ri,{}),allowTabCompletion:!0})}}return(0,_.jsx)(or().A,{...t,store:e})},action:e=>{v().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{ci().Ju({environment:t,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:o,mentionType:"heading"})}})}}}))),[t,l,n,o,r]);if(!d)return{key:"heading results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),topBorder:s}),items:c}}var ar=()=>n(626822);function rr(e){const{topBorder:t,environment:n,query:r,setTemporaryInputData:s}=e,{teamResults:l,currentTeamResultStore:d}=function(e){const t=(0,i().v3)(),{query:n}=e,o=(0,a().K8)((()=>(0,wa().D)({isMobileNative:t.device.isMobileNative,disableExposureLogging:!0})&&bi().A.state.mentionTypes.team),[t.device.isMobileNative]),r=(0,a().K8)((()=>{var e;if(!o)return[];if(!bi().A.state.open)return[];const t=(null===(e=J().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(me().O9))||[];return(0,Aa().Ay)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[o,n]),s=(0,a().K8)((()=>bi().A.state.open?bi().A.state.textStore:void 0),[]);return{teamResults:r,currentTeamResultStore:(0,a().K8)((()=>{if(s&&(0,In().Wo)(s))return(0,In().yQ)(s)}),[s])}}({query:r}),c=(0,a().K8)((()=>{var e;return null===(e=J().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),u=(0,a().K8)((()=>f().oE(l.map((e=>{if(!c)return;return{key:e.id,render:t=>(t.focused&&s({title:e.getName()||"",icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),(0,o.createElement)(ar().A,{...t,key:e.id,teamStore:e})),action:t=>{v().createAndCommit({userAction:"MentionMenu.teamMention",environment:n,canUndo:!0,perform:o=>{ci().Ju({environment:n,editorMode:"default",annotations:[g().DH3(e.id,c,"teamspace")],transaction:o,menuListItemAction:t,query:r,mentionType:"team"})}})}}})))),[n,r,s,c,l]),p=(0,o.useMemo)((()=>{if(0!==u.length)return{key:"team results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),topBorder:t}),items:u}}),[u,t]);return{currentTeamResultStore:d,teamResultsSection:p}}var sr=()=>n(245241),lr=()=>n(712030),dr=()=>n(825972),cr=()=>n(135599),ur=()=>n(62856),pr=()=>n(578872),mr=()=>n(792415),gr=()=>n(488999);var fr=()=>n(148832),hr=()=>n(305390);const yr=20;function vr(e){const t=(0,a().K8)((()=>bi().A.state.mentionTypes.page),[]),n=(0,a().K8)((()=>bi().A.state.open&&bi().A.state.textStore instanceof fr().B?bi().A.state.textStore:void 0),[]),o=(0,i().v3)(),r=(0,a().K8)((()=>(0,Sa().y)(o)),[o]),{overriddenPublicShareLinkSpaceStore:s,furthestPublicShareAncestorId:l}=function(){const e=(0,i().v3)(),t=(0,a().K8)((()=>(0,Sa().y)(e)),[e]);return{furthestPublicShareAncestorId:(0,a().K8)((()=>{var e,n;const{mainEditorCurrentBlockStore:o}=J().default.state;var i;if(t&&o)return null!==(e=mr().A.state.publicPageData)&&void 0!==e&&e.isPublicShareLink?null===(i=(0,gr().A)(o))||void 0===i?void 0:i.id:null===(n=(0,pr().GN)(o))||void 0===n?void 0:n.id}),[t]),overriddenPublicShareLinkSpaceStore:(0,a().K8)((()=>{if(!t)return;const{mainEditorCurrentBlockStore:e}=J().default.state;return null==e?void 0:e.getSpaceStore()}),[t])}}(),d=(0,a().K8)((()=>Boolean(J().default.state.currentSpaceStore||s)||Boolean(n)),[n,s]),c=(0,a().K8)((()=>{var e;return null===(e=(0,Pt().ao)())||void 0===e?void 0:e.id}),[]),u=(0,a().K8)((()=>dr().NK.state.filter((e=>e.pageId!==c)).slice(0,yr).map((e=>e.store))),[c]),p=""===e,{results:m,isResultsLoading:g}=(0,cr().W)({source:"mention_menu",searchQuery:e,limit:yr,disable:!t||!d||p,...r?{type:sr().Vz.BlocksInAncestor,filters:{excludeTemplates:!0,includePublicPagesWithoutExplicitAccess:!0},overrideSpaceStore:s,ancestorId:l}:{type:sr().Vz.BlocksInSpace,filters:{excludeTemplates:!0}}});return{results:(0,a().K8)((()=>p?u.map((e=>({pageStore:e,serverEventProperties:void 0}))):m.map((e=>{let{store:t,serverEventProperties:n}=e;return{pageStore:t,serverEventProperties:n}}))),[m,u,p]),isLoading:g}}function br(e){let{show:t}=e;const n=(0,ur().A)(t,500,300);return(0,_.jsx)(Bn().A,{style:{textAlign:"center",visibility:n?"visible":"hidden",display:"inline",marginLeft:8}})}const xr=(0,K().YK)({noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}});var Sr=()=>n(764880),Mr=()=>n(237829),Ar=()=>n(695608),Cr=()=>n(498212),wr=()=>n(812182),jr=()=>n(21510),kr=()=>n(731320),Ir=()=>n(928074),Tr=()=>n(448693);function Pr(e,t){const{user:o,focused:r}=e,s=(0,i().v3)(),l=(0,K().tz)(),d=(0,Ie().IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.contrastSecondary,fontWeight:_e().Wy.regular,maxWidth:240},tooltipHeader:{color:e.text.contrastPrimary,fontWeight:_e().Wy.medium}})),[]),c=(0,Sr().A7)(o),u=(0,Sr().lR)(l,c),p=(0,a().K8)((()=>{const e=(0,Pt().ao)();return!(e&&(0,Ir().Aj)({store:e}))||"none"!==(0,kr().om)(o.id)}),[o.id]),m=(0,a().K8)((()=>{var e;return o.id===(null===(e=J().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[o.id]),g=(0,a().K8)((()=>!bi().A.getIsMockText()),[]),f=(0,a().K8)((()=>{if(!g)return;if(!r)return;if(p)return;const e=(0,Pt().ao)(),t=e&&Boolean(sa().A.get({userId:s.currentUser.id,key:ga(e.id)})),o=null==e?void 0:e.canAdmin();return!t&&o?(0,ra().x)(d.icon):(0,n(70423).L)(d.icon)}),[g,s.currentUser.id,p,r,d.icon]),h=(0,a().K8)((()=>{if(!g)return null;const e=o.email;return(0,_.jsxs)("div",{style:d.tooltip,children:[(0,_.jsx)("header",{style:d.tooltipHeader,children:(0,_.jsx)(Br,{userName:u,userHasAccessToPage:p,userIsSelf:m})}),e]})}),[g,p,m,u,o.email,d.tooltip,d.tooltipHeader]);return(0,_.jsx)(n(457688).A,{...e,ref:t,actor:c,right:f,tooltip:h,tooltipPlacement:g?w().W.Right:void 0,useEmailAsTooltip:!g})}const _r=o.forwardRef(Pr);function Br(e){let{userName:t,userHasAccessToPage:n,userIsSelf:o}=e;return o?(0,_.jsx)(K().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):n?null:(0,_.jsx)(K().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won't be notified because they don't have page access",values:{userName:t}})}var Lr=()=>n(106628);const Rr=75;function Dr(e,t,n,o){const{hasUserType:i,open:r}=(0,a().K8)((()=>({hasUserType:bi().A.state.mentionTypes.user,open:bi().A.state.open})),[]),s=(0,a().K8)((()=>Boolean(J().default.state.currentSpaceStore)),[]),l=(0,a().K8)((()=>bi().A.state.emptyQueryUserRequestStore.state.result??[]),[]),[{value:d,status:c}]=(0,ue().Yb)((async()=>r&&i&&s&&!o?async function(e,t,n,o){const i=0===e.trim().length;let a;a=i?o:await async function(e,t,n){if(ha().A.state.online){const o=await Lr().T.searchActions.load();return await o.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:o.isPersonalPronoun(e,n)})}return[]}(e,t,n);if(""===e){const e=4;return a.slice(0,e)}return a.slice(0,20)}(e,t,n.locale,l):[]),[r,i,s,e,t,n.locale,l,o],{debounce:Rr});return{results:d??[],isLoading:"pending"===c}}const Or="__invite";function Nr(e){const{topBorder:t,query:n,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,setTemporaryInputData:d,templateVariableResults:c,formulaContextVariableResults:u,currentTeamResultStore:p,disabled:m}=e,f=(0,i().v3)(),h=(0,K().tz)(),y=(0,a().K8)((()=>bi().A.state.mentionTypes.user),[]),{results:b,isLoading:x}=Dr(n,f,h,m),S=(0,a().K8)((()=>(0,Pt().ao)()),[]),M=(0,a().K8)((()=>S&&Boolean(sa().A.get({userId:f.currentUser.id,key:ga(S.id)}))),[f.currentUser.id,S]),A=(0,a().K8)((()=>bi().A.state.mentionTypes.inviteUserToPage&&!M),[M]),C=Ka({templateVariableResults:c,category:"user",query:n,setTemporaryInputData:d}),w=Ga({formulaReturnType:"person",query:n,formulaContextVariableResults:u,setTemporaryInputData:d}),j=(0,a().K8)((()=>{const e=bi().A.state.mentionTypes.team;return(0,wa().D)({isMobileNative:f.device.isMobileNative,disableExposureLogging:!0})&&e}),[f.device.isMobileNative]),k=(0,a().K8)((()=>!b.find((e=>e.email===n))&&bi().A.state.mentionTypes.inviteUserToWorkspace),[n,b]),I=(0,a().K8)((()=>{var e;return null===(e=J().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),T=k||b.length>0||C.length>0||w.length>0||j,P=(0,a().K8)((()=>{if(!I||!p||!T)return;const e=h.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&d({title:e,icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),(0,o.createElement)(ar().A,{...t,key:"everyone-unique-item",teamStore:p,renderAsEveryoneMention:!0})),action:e=>{v().createAndCommit({userAction:"MentionMenu.teamMention",environment:f,canUndo:!0,perform:t=>{ci().Ju({environment:f,editorMode:"default",annotations:[g().DH3(p.id,I,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[T,p,f,h,n,d,I]),B=(0,a().K8)((()=>bi().A.getIsMockText()),[]),L=(0,o.useMemo)((()=>["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"]),[]),R=(0,a().K8)((()=>jr().A.state.open&&L.includes(jr().A.state.discussionLocation)),[L]),D=!B&&!R,O=(0,a().K8)((()=>bi().A.getMentionMenuContext()??An().ev),[]),N=(0,a().K8)((()=>!!S&&((0,Ir().Aj)({store:S})&&S.canAdmin())),[S]),E=(0,o.useCallback)((e=>!("none"!==(0,kr().om)(e))&&!f.device.isMobile&&D&&!M&&N),[M,N,f.device.isMobile,D]),F=(0,a().K8)((()=>bi().A.state.open?bi().A.state.flowId:void 0),[]),U=(0,o.useCallback)(((e,t,n,o)=>{t.reset(),n.reset(),F&&(t.setState({...t.state,tokenQuery:o}),n.setState({...n.state,flowId:F}),Qi().TS(e,{origin:bi().A.getInviteOrigin(),invite_flow_id:F}),bi().A.updateOpenState({showInvite:!0}))}),[F]),V=(0,a().K8)((()=>b.map((e=>{const t=e.id,i={key:t,render:n=>(n.focused&&d({title:(0,Ar().c6)(h,e),icon:(0,_.jsx)(Di,{}),allowTabCompletion:!0}),(0,o.createElement)(_r,{...n,key:t,user:e})),action:o=>{const i=(0,kr().om)(t);if(A&&"none"===i)l.setState({userId:t,userEmail:e.email,displayName:(0,Sr().A7)(e).getDisplayName(h)}),bi().A.updateOpenState({showMentionAndShare:!0});else if(v().createAndCommit({userAction:"MentionMenu.menuItem",environment:f,canUndo:!0,perform:t=>{ci().Ju({environment:f,editorMode:"default",annotations:[(0,g().P4h)(e.id)],transaction:t,menuListItemAction:o,query:n,mentionType:"user"})}}),E(t)){const t=(0,Cr().Ay)();wr().HK(function(e){const{environment:t,user:n,pageStore:o,intl:i,flowId:a,from:r}=e;return o&&sa().A.set({userId:t.currentUser.id,key:ga(o.id),value:!0}),{id:`invite_${n.id}`,title:i.formatMessage(Ur.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,_.jsx)(Er,{user:n}),actions:{primary:{title:i.formatMessage(Ur.pageInviteToastInviteButton),onAction:()=>{if(!o)return;const i="read_and_write";v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{da().zP({environment:t,transaction:e,store:o,permissionItems:[{type:"user_permission",role:i,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:a})}}),sa().A.set({userId:t.currentUser.id,key:ga(o.id),value:!1}),la().Jg(t,{role:i,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:i,user_id:n.id}],invite_message_length:0,invite_flow_id:a}),Fr(t,{flow_id:a,selection:"invite",target_user_id:n.id,from:r}),wr().HK(function(e){const{user:t,intl:n,environment:o,pageStore:i,flowId:a,from:r}=e;return{id:`invite_${t.id}`,icon:Mr().X,title:n.formatMessage(Ur.pageInviteSnackbarSuccessTitle),message:n.formatMessage(Ur.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(Ur.pageInviteUndo),onAction:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:o,canUndo:!0,perform:e=>{i&&da().zP({environment:o,transaction:e,store:i,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:a})}}),wr().UW(`invite_${t.id}`),function(e,t){(0,Tt().u4)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("undo_invite_to_page_popup",void 0,t)}(o,{flow_id:a,target_user_id:t.id,from:r})}}}}}(e))}},secondary:{title:i.formatMessage(Ur.pageInviteToastIgnoreButton),onAction:()=>{o&&(wr().UW(`invite_${n.id}`),Fr(t,{flow_id:a,selection:"dismiss",target_user_id:n.id,from:r}))}}}}}({environment:f,user:e,pageStore:S,intl:h,flowId:t,from:O})),function(e,t){(0,Tt().u4)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("trigger_invite_to_page_popup",void 0,t)}(f,{flow_id:t,target_user_id:e.id,from:O})}}};return i})).concat(k&&T?[{key:Or,action:()=>U(f,r,s,n),render:e=>(e.focused&&d({title:"",icon:(0,_.jsx)(Di,{}),allowTabCompletion:!1}),(0,_.jsx)(Et().A,{...e,icon:(0,_.jsx)(pa().I,{icon:ra().x}),title:n.length>0?(0,_.jsx)(K().sA,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,_.jsx)(K().sA,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[E,f,U,h,r,O,l,S,s,n,d,k,A,T,b]),z=(0,o.useMemo)((()=>[...P?[P]:[],...w,...C,...V]),[P,w,C,V]),W=(0,o.useMemo)((()=>({key:"user results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t}),items:z})),[z,t]);return y?{userResultsSection:W,isUserResultsLoading:x,numberOfUserResults:b.length}:{userResultsSection:void 0,isUserResultsLoading:!1,numberOfUserResults:0}}function Er(e){const{user:t}=e,n=(0,Ie().IS)((()=>{const e=(0,ao().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.tooltipBackground,color:e.text.contrastPrimary}}}),[]);return(0,_.jsxs)("div",{style:n.container,children:[(0,_.jsx)(Fe().A,{overlayContainerZIndex:202,alignment:w().C.Center,originGap:2,placement:w().W.Top,renderTooltip:()=>t.email,render:e=>(0,_.jsx)("div",{style:n.tokenContainer,...e,children:(0,_.jsx)(Tr().t_,{userValue:t,isSingle:!0,shouldShrink:!0,format:Tr().t_.Format.Medium})}),style:n.darkTooltip}),(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{...Ur.pageInviteToastMessage})})]})}function Fr(e,t){(0,Tt().u4)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("select_invite_to_page_popup",t.selection,t)}const Ur=(0,K().YK)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They won’t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var Vr=()=>n(842599);function Kr(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,r=i.length>0,s=(0,a().K8)((()=>bi().A.state.open&&bi().A.state.insertionType),[]),l=function(e){const{templateVariableResults:t,query:n,numberOfUserResults:o}=e,i=(0,a().K8)((()=>bi().A.state.open),[]),r=(0,a().K8)((()=>bi().A.state.open?bi().A.state.sectionOrder:void 0),[]),s=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:o}=e,i=t+n.length;if(""===o||i>0||(0,Vr().xn)(o))return!0;const a=n.some((e=>(0,Ca().BX)(e,"user")));if(a)return!0;return!1}({numberOfUserResults:o,templateVariableResults:t,query:n});if(i&&r)return r;if(s)return Wr;return zr}({numberOfUserResults:t,templateVariableResults:n,query:i});return(0,o.useMemo)((()=>{const e=l,t=(0,Cn().sb)([...e,...bi().k]),n=t.filter((e=>"createPage"!==e));return"+"===s?["createPage",...n]:"@"===s&&r||"[["===s?[...n,"createPage"]:t}),[r,s,l])}const zr=["date","page","team","group","heading","user"],Wr=["date","user","page","team","group","heading"];function Hr(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c}=e,u=(0,i().v3)(),p=(0,a().K8)((()=>(0,Sa().y)(u)),[u]),m=(0,Ie().DP)(),g=(0,i().WS)(),{expandSection:h,isOpen:y}=(0,a().K8)((()=>({isOpen:bi().A.state.open,expandSection:bi().A.state.open?bi().A.state.expandSection:void 0})),[]),b=function(e){const t=(0,K().tz)();return(0,a().K8)((()=>bi().A.state.mentionTypes.templateVariable),[])?(0,Ca().W4)(e,t):[]}(t),x=function(e){const t=(0,a().K8)((()=>bi().A.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:i}=(0,a().K8)((()=>({automationActionStore:ja().A.state.automationActionStore,typecheckResult:ja().A.state.typecheckResult})),[]),r=(0,o.useMemo)((()=>n&&i?(0,Ma().getContextValuesForAction)({value:i},n.id):(null==i?void 0:i.valueTypes)||[]),[n,i]),s=i&&t;return(0,o.useMemo)((()=>s?(0,Aa().Ay)(e,r,(e=>e.kind!==Ai().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[s,e,r])}(t),S=(0,o.useRef)(zr[0]),{pageResultsSection:M,isPageResultsLoading:A}=function(e){const{query:t,topBorder:n,setTemporaryInputData:a,formulaContextVariableResults:r}=e,s=(0,K().tz)(),l=(0,i().v3)(),{device:d}=l,c=l.currentUser.id,u=(0,Ie().DP)(),p=d.isSafari||d.isIOS,{results:m,isLoading:g}=vr(t),h=Ga({formulaReturnType:"block",query:t,formulaContextVariableResults:r,setTemporaryInputData:a}),y=(0,o.useMemo)((()=>(0,f().oE)(m.map((e=>{let{pageStore:n,serverEventProperties:o}=e;const i=n.id;return{key:i,render:e=>{if(e.focused){const e=n.getModel();if(e){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,F().P)(),intl:s});a({title:t||"",icon:(0,_.jsx)(Oi,{pageStore:n,theme:u,isSafariOrIOS:p,emojiType:(0,lr().FN)(l),currentUserId:c}),allowTabCompletion:!0})}}return(0,_.jsx)(hr().A,{...e,store:n,showVerifiedPageBadge:!0})},action:e=>{v().createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:l,canUndo:!0,perform:n=>{ci().Ju({environment:l,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:t,serverEventProperties:o,mentionType:"page",resultId:i})}})}}})))),[c,l,s,p,t,m,a,u]),b=(0,o.useMemo)((()=>[...h,...y]),[h,y]),x=b.length>0||g?xr.linkToPage:xr.noPageResults,S=(0,o.useMemo)((()=>(0,_.jsxs)(_.Fragment,{children:[s.formatMessage(x),(0,_.jsx)(br,{show:g})]})),[s,g,x]),M=(0,o.useMemo)((()=>({key:"no page results",render:e=>(0,_.jsx)(Ut().A,{...e,title:S,topBorder:n}),items:b})),[b,S,n]);return{pageResultsSection:M,isPageResultsLoading:g}}({query:t,topBorder:"page"!==S.current,setTemporaryInputData:c,formulaContextVariableResults:x}),C=Qa({templateVariableResults:b,formulaContextVariableResults:x,topBorder:"date"!==S.current,query:t,setTemporaryInputData:c}),w=ir({query:t,setTemporaryInputData:c,topBorder:"heading"!==S.current}),{teamResultsSection:j,currentTeamResultStore:k}=rr({topBorder:"team"!==S.current,environment:u,query:t,setTemporaryInputData:c}),{userResultsSection:I,isUserResultsLoading:T,numberOfUserResults:P}=Nr({topBorder:"user"!==S.current,query:t,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,setTemporaryInputData:c,templateVariableResults:b,formulaContextVariableResults:x,currentTeamResultStore:k,disabled:p}),B=er({topBorder:"group"!==S.current,query:t,setTemporaryInputData:c}),L=Oa({topBorder:"createPage"!==S.current,query:t,clearSavedSelection:n,setTemporaryInputData:c}),R=function(e){const{mentionMenuCurrentFormulaStore:t,setTemporaryInputData:n,topBorder:o,formulaContextVariableResults:i}=e,r=i.filter((e=>e.kind===Ai().FormulaContextValueKind.ContextValue&&"block"===e.type.type)),s=(0,a().K8)((()=>{const e=r.map((e=>{const o=(0,Ci().sM)(e),i=(0,Ci().E9)(e),a=(0,Ci().Ix)(e.type);return{action:Ha(e,t),key:e.id,render:e=>(e.focused&&n({title:o,icon:(0,_.jsx)(Di,{}),allowTabCompletion:!1}),(0,_.jsx)(Wa().A,{...e,right:(0,za().V)({height:"auto",marginInlineStart:6,width:12}),svg:a,title:o,tooltipText:i}))}}));return(0,f().oE)(e)}),[r,t,n]);if(s.length>0)return{items:s,key:"formula property results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Property from",id:"mentionMenu.formulaPropertySection.title"}),topBorder:o})}}({mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,topBorder:"formula"!==S.current,formulaContextVariableResults:x}),D=function(e){const{query:t,formulaContextVariableResults:n,setTemporaryInputData:o,topBorder:r}=e,s=(0,i().v3)(),l=(0,a().K8)((()=>Ya({environment:s,formulaVariableFilter:e=>e.kind===Ai().FormulaContextValueKind.ContextValue&&(0,Ci().IF)(e),query:t,formulaContextVariableResults:n,setTemporaryInputData:o})),[s,n,t,o]);if(0!==l.length)return{items:l,key:"custom formula results",render:e=>(0,_.jsx)(Ut().A,{...e,title:(0,_.jsx)(K().sA,{defaultMessage:"Custom",id:"mentionMenu.customFormulaVariables.title"}),topBorder:r})}}({query:t,formulaContextVariableResults:x,setTemporaryInputData:c,topBorder:"custom-formula"!==S.current}),O=(0,o.useMemo)((()=>({date:C,user:I,page:M,group:B,team:j,heading:w,createPage:L,formula:R,"custom-formula":D,bot:void 0})),[C,I,M,B,j,w,L,R,D]),N=Kr({templateVariableResults:b,numberOfUserResults:P,query:t});(0,o.useEffect)((()=>{const e=N.find((e=>void 0!==O[e]));S.current=e??N[0]}),[O,N]);const E=!T&&!A;(0,o.useEffect)((()=>{const e=xa().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");E&&xa().default.DO_NOT_USE_measureLegacy(e,{environment:u})}),[u,E]);const U=(0,o.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:o,expandSection:i,theme:a,isPhone:r}=e;if(!o||i===t)return n;const{items:s}=n,l=r||"heading"===t?3:5;if(s.length<=l)return n;const d=[...s.slice(0,l),{key:"show more",render:e=>(0,_.jsx)(Et().A,{...e,icon:(0,ba()._)({width:16,fill:a.mediumTextColor}),title:(0,_.jsx)("span",{style:{color:a.mediumTextColor},children:(0,_.jsx)(K().sA,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:s.length-l}})})}),action:()=>{bi().A.updateOpenState({expandSection:t})}}];return{...n,items:d}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:g,isOpen:y,expandSection:h,theme:m})),[g,y,h,m]);return(0,o.useMemo)((()=>{const e=[];for(const t of N){const n=O[t];n&&(p&&"user"===t||e.push("createPage"===t?n:U({sectionName:t,menuSection:n})))}return e}),[N,O,U,p])}const Gr=(0,K().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),Yr=(0,K().YK)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),qr=o.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:s}=e;return(0,_.jsx)(Qr,{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:s})}));function Qr(e){let{query:t,queryRef:r,clearSavedSelection:s,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u}=e;const p=(0,K().tz)(),m=(0,i().v3)(),g=(0,a().O$)(bi().A),f=(0,a().K8)((()=>ha().A.state.online),[]),h=Boolean(g.open&&g.usePopupOnMobile),y=Vi(r),v=Hr({clearSavedSelection:s,query:t,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u,setTemporaryInputData:y}),x=(0,n(575301).o_)();let M;(0,o.useEffect)((()=>{if(!f)return;const e=g.mentionTypes.user,t=g.mentionTypes.page,n=g.mentionTypes.date;let o="";e&&t&&n?o=p.formatMessage(Yr.mentionAll):e&&t?o=p.formatMessage(Yr.mentionPersonPage):e&&n?o=p.formatMessage(Yr.mentionPersonDate):t&&n?o=p.formatMessage(Yr.mentionPageDate):e?o=p.formatMessage(Yr.mentionPerson):n?o=p.formatMessage(Yr.mentionDate):t&&g&&(o=g.open&&"+"===g.insertionType?p.formatMessage(va.addPage):p.formatMessage(Yr.mentionPage)),y({title:o,icon:(0,_.jsx)(Bi,{insertionType:g.open?g.insertionType:"+"}),allowTabCompletion:!1})}),[f,y,p,g]),f||(M=(0,_.jsx)(ya().A,{title:(0,_.jsx)(K().sA,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})}));const{device:A}=m,C=(0,a().K8)((()=>330),[]),w=Zi(m,r);let j;j=Ji({usePopupOnMobile:h})?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${x}px)`}:{menuType:S().gu.Popup,width:C,maxHeight:A.isMobile?"30vh":"40vh",onClickOutside:w};const k=(0,o.useCallback)((e=>{(function(e){return""===e})(r.current??"")&&(e.preventDefault(),w())}),[r,w]);return(0,_.jsxs)(b().A,{...j,header:M,children:[(0,_.jsx)(nt().A,{debugName:"MentionMenu",capture:g.open,onBackspace:k}),(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:$r(t),sections:v,onEmptyEnter:w,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===v.length&&(0,_.jsx)(Ut().A,{children:(0,_.jsx)(ya().A,{title:(0,_.jsx)(K().sA,{...Gr.noResults})})})]})}function $r(e){if(""!==e)return 0}function Zr(){const e=(0,i().v3)(),t=(0,a().O$)(bi().A),n=t.open&&t.showCreateIn,r=t.open&&t.showInvite,s=t.open&&t.showMentionAndShare,l=t.open&&t.showFormulaProperty,d=Boolean(t.usePopupOnMobile),c=(0,a().uB)(void 0,fi().Ay),u=(0,a().uB)(void 0,gi().A),p=(0,a().uB)(void 0,Gi),m=(0,a().uB)(void 0,vi),g=(0,a().K8)((()=>{if(t.open)return A().aX(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),f=(0,a().K8)((()=>{if(g&&t.open)return A().mX(t.textStore,g)}),[g,t]),h=(0,a().K8)((()=>Yi(e,f)),[e,f]),y=(0,o.useRef)(h);(0,o.useEffect)((()=>{y.current=h}),[h]);const v=(0,a().K8)((()=>!!t.open&&("+"!==t.insertionType||""!==h)),[h,t]),b=(0,a().K8)((()=>Pt().ao()),[]),C=v&&(b&&(n||r)||s),{clearSavedSelection:k,getSavedSelection:T}=(0,mi().A)({shouldPreserveTextSelection:C,shouldPreserveBlockSelection:!1,shouldRestoreSelection:C});(0,o.useEffect)((()=>{const e=bi().A.state;if(e.open){var t;const n=I().default.state,o="editing"===n.mode?(0,M().H7)(n.multiSelection):void 0,i=(null==o?void 0:o.store)===e.textStore,a=T().textSelectionState,r=a&&"editing"===a.mode&&(null===(t=(0,M().H7)(a.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!i&&!r)return void ci().VN();const s=i&&(null==o?void 0:o.selection);if(g&&s&&(s.startIndex<g.filter.startIndex||s.endIndex>g.filter.endIndex))return void ci().VN();const l=f&&f[0];if("+"===e.insertionType&&l&&!(0,pi().D$)(l))return void ci().VN();if("@"===e.insertionType&&l&&(0,pi().Yv)(l))return void ci().VN();if(void 0===f&&!e.isEmptyPageTitle)return void ci().VN()}}),[f,T,g]);const{device:P}=e,[B,L]=(0,o.useState)(void 0),R=ui().A.getSize(),D=(0,a().K8)((()=>{if(P.isMobile&&0!==R)return ui().A.find((e=>e.isCaptured()))}),[P,R]);(0,o.useEffect)((()=>{const e=null==D?void 0:D.getNode();if(e){const t=new(xi().E);return t.observe(e),t.rect.addListener((e=>{L({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[D]);const O=Ji({usePopupOnMobile:d}),N=O?j().n.SlideUp:j().n.Popup,E=Zi(e,y);return(0,_.jsx)(x().Ay,{popupType:N,open:v,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22}:t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Start,originGap:12,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:E,disableDarkOverlayBackground:P.isMobile,keepFocus:!0,trapFocus:!1,render:()=>P.isMobile?(0,_.jsxs)(_.Fragment,{children:[!s&&(0,_.jsx)(qr,{query:h,queryRef:y,clearSavedSelection:k,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:p,mentionMenuCurrentFormulaStore:m}),(0,_.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,_.jsx)(ea,{clearSavedSelection:k,filter:f}),open:n,keepFocus:!0,trapFocus:!1}),(0,_.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,_.jsx)(ia,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}),open:r,keepFocus:!0,trapFocus:!1}),(0,_.jsx)(x().Ay,{popupType:N,render:()=>(0,_.jsx)(fa,{mentionMenuCurrentMentionStore:p,menuPopupType:O?S().gu.ActionSheet:S().gu.Popup}),open:s,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Start,originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,_.jsx)(x().Ay,{keepFocus:!0,open:l,popupType:j().n.SlideUp,render:()=>(0,_.jsx)(zi,{mentionMenuCurrentFormulaStore:m,queryRef:y}),trapFocus:!1})]}):n?(0,_.jsx)(ea,{clearSavedSelection:k,filter:f}):r?(0,_.jsx)(ia,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}):s?(0,_.jsx)(fa,{mentionMenuCurrentMentionStore:p,menuPopupType:S().gu.Popup}):l?(0,_.jsx)(zi,{mentionMenuCurrentFormulaStore:m,queryRef:y}):(0,_.jsx)(qr,{query:h,queryRef:y,clearSavedSelection:k,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:p,mentionMenuCurrentFormulaStore:m})})}var Jr=()=>n(415651);const Xr=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=Jr().v7(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&uo().IU({environment:t})}(t,e),o(t)},o=f().nF((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(ts,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&X().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),Jr().GB(e,{currentX:n.clientX,currentY:n.clientY})}),es),i=t=>{!function(e,t){e.preventDefault();const n=Array.from(e.dataTransfer.files);n.length>0&&Jr().b({environment:t,files:n,analyticsFrom:"native_drag"})}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},es=62.5;function ts(e){Jr().Pt(e)}var ns=()=>n(211716),os=()=>n(906537),is=()=>n(35392);const as=function(){const e=(0,i().v3)(),t=(0,a().K8)((()=>{const e=I().default.state;if("editing"!==e.mode)return null;const t=(0,M().H7)(e.multiSelection);if(!t)return null;const{store:n,selection:o}=t;if(o.endIndex!==o.startIndex+1)return null;const i=n.getValue(),a=g().ANx(i,o.startIndex);if(!a||!g().rjO(a))return null;const[r]=g().N5L([a]);return{pageId:r,store:n}}),[]),n=(0,o.useCallback)((()=>(0,_.jsx)(rs,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const r=os().getSelectionRect();return(0,_.jsx)(Fe().A,{render:()=>{},renderTooltip:n,originRect:r,forceVisibleState:Boolean(t&&r),placement:w().W.Bottom})};function rs(e){let{pageMentionTokenStoreState:t}=e;const n=(0,Ie().DP)(),a=(0,i().v3)(),r=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault();const a=ee().Bv.createChildStore(i,{table:An().ev,id:o});Pa().uK({store:a,environment:t,visitType:ns().ig.Link,openInNew:"tab",pageVisitSource:E().y8.MentionInPage})}(e,a,t)),[a,t]),s=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault&&e.preventDefault();const a=ee().Bv.createChildStore(i,{table:An().ev,id:o});Pa().uK({store:a,environment:t,visitType:ns().ig.Link,pageVisitSource:E().y8.MentionInPage})}(e,a,t)),[a,t]);return(0,_.jsx)(nt().A,{debugName:"PageMentionOverlay",capture:!0,onEnter:s,onCommandEnter:r,children:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(K().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{onlyShowFirst:!0,name:"enter",style:{color:n.text.contrastSecondary}})})]})})}var ss=()=>n(569577),ls=()=>n(315957);function ds(){const e=(0,K().tz)(),t=(0,Ie().DP)(),n=(0,i().v3)(),{device:r}=n,s=(0,a().K8)((()=>ls().A.state.blockStore),[]),l=(0,a().K8)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,a().K8)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,a().K8)((()=>{var t;return(null==s||null===(t=s.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,F().P)(),intl:e}))??""}),[s,e]);if((0,o.useEffect)((()=>{const{blockStore:e}=ls().A.state;if(!e)return;const t=e.getTitleStore();t&&Le().selectAllText({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!s||!l)return null;let u;return u=r.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,_.jsx)(b().A,{...u,children:(0,_.jsx)("div",{style:us(t),children:(0,_.jsx)(Ue().A,{store:l,disabled:!d,onEsc:()=>ss().V(n),onEnter:()=>ss().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:c,style:ps(t),pasteBehavior:"inline",inPageFind:De().Os.none})})})}const cs=function(){const e=(0,i().v3)(),{device:t}=e,{blockStore:n,originRect:o}=(0,a().K8)((()=>{const{blockStore:e,originRect:t}=ls().A.state;return{blockStore:e,originRect:t}}),[]);return(0,_.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Center,originGap:4,onDismiss:()=>ss().V(e),render:()=>(0,_.jsx)(ds,{}),trapFocus:!0})};function us(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function ps(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var ms=()=>n(735384),gs=()=>n(246826),fs=()=>n(898286),hs=()=>n(270710),ys=()=>n(614505);function vs(e){const t=(0,K().tz)(),n=(0,i().v3)(),{device:r}=n,s=(0,a().K8)((()=>hs().A.state.clonedBlockStore),[]),l=(0,a().K8)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,a().K8)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,a().K8)((()=>{var e;if(s)return null===(e=s.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,F().P)(),intl:t})}),[s,t]);(0,o.useEffect)((()=>{if(!s)return;const e=s.getTitleStore();e&&Le().selectAllText({environment:n,store:e,canSelectAllBlocks:!1})}),[s,n]);const u=(0,Ie().IS)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!s||!l)return null;const{renderDelete:p}=e;let m;return m=r.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,_.jsx)(b().A,{...m,children:(0,_.jsxs)("div",{style:u.wrapper,children:[(0,_.jsx)(Ms,{blockStore:s}),(0,_.jsx)(Ue().A,{store:l,disabled:!d,onEsc:()=>fs().V(n),onEnter:()=>fs().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:De().Os.none}),p&&d&&(0,_.jsx)(xs,{})]})})}const bs=function(){const e=(0,i().v3)(),{device:t}=e,{clonedBlockStore:n,originRect:o}=(0,a().K8)((()=>{const{clonedBlockStore:e,originRect:t}=hs().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,_.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:w().W.Bottom,alignmentToOrigin:w().C.Center,originGap:4,onDismiss:()=>fs().V(e),render:()=>(0,_.jsx)(Ss,{}),trapFocus:!0})};function xs(){const e=(0,i().v3)(),t=(0,K().tz)();return(0,_.jsx)(Ee().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,ms().I)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=hs().A.state;t&&await co().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),fs().V(e)}})}function Ss(){const e=(0,a().K8)((()=>hs().A.state.renderDelete),[]);return(0,_.jsx)(vs,{renderDelete:Boolean(e)})}function Ms(e){let{blockStore:t}=e;const n=(0,Ie().DP)(),o=(0,i().v3)(),r={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},s=(0,a().K8)((()=>t.canEdit()),[t]),l=(0,a().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,a().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,a().K8)((()=>t.getIcon()),[t]),u=(0,a().K8)((()=>t.isEmptyPage()),[t]),p=(0,a().K8)((()=>t.getType()),[t]);return s?(0,_.jsx)(ys().A,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:r,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:p,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=hs().A.state;if(n){const o=n.getIconStore();o&&v().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{gs().KY({store:o,value:e,transaction:t})}})}}(e,o)}):(0,_.jsx)(ys().A,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:r})}n(823215);var As=()=>n(792485),Cs=()=>n(713998);const ws=(0,Xn().wt)("bold",{viewBox:"0 0 16 16",svg:(0,_.jsx)("g",{children:(0,_.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var js=()=>n(668725),ks=()=>n(815883),Is=()=>n(339764);const Ts=(0,Xn().wt)("italic",{viewBox:"0 0 16 16",svg:(0,_.jsx)("g",{children:(0,_.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var Ps=()=>n(657222);const _s=(0,Xn().wt)("strikethrough",{viewBox:"0 0 16 16",svg:(0,_.jsx)("g",{children:(0,_.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),Bs=(0,Xn().wt)("underline",{viewBox:"0 0 16 16",svg:(0,_.jsx)("g",{children:(0,_.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var Ls=()=>n(519831),Rs=()=>n(843005),Ds=()=>n(741496),Os=()=>n(21869),Ns=()=>n(332751);function Es(e){const{clientSkill:t}=e,n=(0,K().tz)(),o=(0,a().K8)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,_.jsx)(_.Fragment,{children:o})}var Fs=()=>n(602098);function Us(e){if(e.inMemoryRecordCache.isMockTextStore){const t=e.getRecordStoreAtRootPath();if(t.table===An().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof ee().bx||e instanceof ee().dn)).ancestor)}var Vs=()=>n(704152);function Ks(e){const t=(0,i().v3)(),{isMobile:a}=(0,i().Y0)(),r=(0,o.useRef)(null),s=async()=>{const o=I().default.state;if("empty"===o.mode)return;const i=await n(862292).T.formulas.load();n(441467).of({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,formulasModule:i})};return(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,_.jsxs)(Vs().A,{ref:r,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,n(350124).s)({width:a?22:20,height:a?22:20,marginTop:a?0:1,marginRight:e.iconOnly?0:4}),!a&&!e.iconOnly&&(0,_.jsx)(K().sA,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}Ks.displayName="InlineReactionButton";const zs=Ks;var Ws=()=>n(667925),Hs=()=>n(962845),Gs=()=>n(478726),Ys=()=>n(494043),qs=()=>n(441199),Qs=()=>n(397248),$s=()=>n(337567),Zs=()=>n(77246),Js=()=>n(195613),Xs=()=>n(396831),el=()=>n(285288),tl=()=>n(170722),nl=()=>n(369241),ol=()=>n(496889),il=()=>n(452558),al=()=>n(406699),rl=()=>n(720263),sl=()=>n(880922),ll=()=>n(473227);function dl(e){const t=(0,i().v3)(),{isMobile:n}=(0,i().Y0)(),r=(0,a().K8)((()=>"suggest"===Zs().Uv.getMode(e.blockStore)),[e.blockStore]),s=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof ee().Bv&&n.isNavigableBlock()&&ll().PD({environment:t,navigableBlockStore:n,mode:r?"default":"suggest",location:"rich_text_menu"})},l=(0,Ie().IS)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:r?t.blueColor:t.icon.primary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,r,e.iconOnly,e.style]);return(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:r?(0,_.jsx)(K().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,_.jsx)(K().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,_.jsx)("div",{})]}),render:t=>(0,_.jsxs)(Vs().A,{style:l.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,sl().A)(l.icon),!n&&!e.iconOnly&&(r?(0,_.jsx)(K().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,_.jsx)(K().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var cl=()=>n(236228),ul=()=>n(777849),pl=()=>n(780243);function ml(){var e;if(!(0,He().X)("selectable_word_count"))return null;const t=null===(e=os().get())||void 0===e?void 0:e.cloneContents(),n=t?gl(t):0;return 0===n?null:(0,_.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,_.jsx)(K().sA,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function gl(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];o.childNodes.length>0?t+=gl(o):o.textContent&&(t+=(0,Re().sQ)(o.textContent))}return t}const fl={[$e().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[$e().xd.code]:new Set(["showCode","showCompletions"]),[$e().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[$e().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},hl={[$e().xd.factory]:!0};const yl=function(){const e=(0,As().S)(),t=(0,i().v3)(),r=(0,i().Y0)(),s=(0,a().O$)(tl().A),{isActive:l,blockTarget:d,isAnimatingClosed:c}=s,u=(0,a().K8)((()=>J().default.state.mainEditorCurrentBlockStore),[]),p=(0,a().K8)((()=>Rt().zD.isRichTextMenuSuggestionEnabled()),[]),[m,g]=(0,o.useState)(void 0),h=(0,o.useCallback)((()=>{var e;if(!p||!u)return;const n=(0,At().filterAndRankAssistantSurfaceActionsForContext)((0,At().clientSkillToAssistantSurfaceAction)((0,Ct().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:u,selectionState:Nt().default.state,textSelectionState:I().default.state,isMobile:t.device.isMobile,userSettings:null===(e=J().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[p,u,t]),y=(0,a().K8)((()=>{const t=d,o=I().default.state;if(!l||"empty"===o.mode)return;const{multiSelection:i}=o,a=(0,Hs().$W)(i),r=a.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),s=(0,M().KP)(i),c=I().default.isEditingComment(),u=I().default.isEditingFormQuestion(),p=t&&"form"===t.getType(),g=u||p,f=I().default.isEditingCaption(),h=t&&t.getParentTable()===Ls().Vl,y=s&&t&&i.start.store===t.getCollectionViewSourceDescriptionStore(),v=n(747100).Gb(),b=e&&e.publicEditModeStore.state,x=!(0,kr().QT)(b)&&(i.start.store.canEdit()&&i.end.store.canEdit()),S=t&&"suggest"===Zs().Uv.getMode(t),A=X().default.checkGate({gateName:"block_reactions"}),C=r.some(((e,t)=>{const n=a[t].store.table===io().SN&&!a[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),w=x&&!C,j=t&&t.getType(),k=j&&fl[j],T=null==t?void 0:t.isType("button"),P=(0,Fs().u)(i.start.store)||(0,Fs().u)(i.end.store),_=Us(i.start.store)||Us(i.end.store);let B=!1;const L=Se().A.state.isOpen?Se().A.state:Me().A.state.isOpen?Me().A.state:void 0;if(L){const e=L.store.getParentStore();if((null==e?void 0:e.table)===Ls().Vl){const t=e.getSchema(),n=L.property,o=(0,Cs()._g)({schema:t,property:n});"text"!==(null==o?void 0:o.type)||o.ai_inference||(B=!0)}}const R={isSingleStoreSelection:s,showTurnInto:Boolean(s&&!c&&!h&&!y&&!f&&t&&w&&!T&&!S&&!g&&(P||!_)),showBold:Boolean(w),showItalic:Boolean(w),showStrikethrough:Boolean(w),showUnderline:Boolean(w),showCode:Boolean(w),showLink:Boolean(s&&w),showHighlight:Boolean(w),showDiscuss:Boolean(!c&&t&&(B||!h)&&!y&&!g&&!_),showReact:Boolean(A&&!c&&t&&!h&&!y&&!_&&!g),showSuggest:Boolean(!c&&t&&!h&&!y&&!_&&!v&&!C&&!g),showEquation:Boolean(s&&w&&!S&&!g),showActionButton:Boolean(s&&!c&&!f&&t&&!h&&!g&&(P||!_)),targetBlockStore:t,isComment:c,showCompletions:Boolean((0,n(68465).ZE)(b)&&w&&!c&&!f&&t&&!h&&!y&&!T&&!_&&!S&&!g),topRankedSkill:m};if(k&&k.size>0)for(const e of k)R[e]=!1;return R}),[d,l,e,m]),[v,b]=(0,o.useState)(y);(0,o.useEffect)((()=>{y&&b(y)}),[y]);const x=(0,a().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),S=(0,a().K8)((()=>y&&y.showDiscuss&&!y.showBold),[y]),A=(0,o.useCallback)((()=>{if(n(711319).A.state.open||nl().A.state.open)return;if(n(620149).l.state)return Ns().I();const e=I().default.state;if("empty"===e.mode)return Ns().I();const o=(0,Hs().$W)(e.multiSelection);if(0===o.length)return Ns().I();if(!o.every((e=>{let{store:t}=e;return t.table===An().ev||t.table===io().SN||t.table===Ls().Vl||t.table===n(37165).lo})))return Ns().I();if(!t.currentUser.isLoggedIn()||!o.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=os().get();if(Pt().fI())return Ns().I();if(o.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return Ns().I();const a=o.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(a.some((e=>e&&e.pathIsDead())))return Ns().I();if(a.some((e=>e&&(0,$s().dL)(e))))return Ns().I();if(a.some(((e,t)=>{const n=o[t].store.canComment(),i=o[t].store.table===io().SN&&o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Ns().I();const l=o.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof ee().Bv))return!1;const o=n.getValue();return!!o&&hl[o.type]}));if(l)return Ns().I();const d=i?os().getRect(i):void 0;if(d&&!Qs().HY(d,(0,n(59728).A)()))return Ns().I();if(hs().A.isActive()||ls().A.isActive()||Jo().A.isOpen()||l||qs().default.isPeekDismissableState()||!i||!function(){const e=os().get();return!!e&&!e.collapsed&&"empty"!==I().default.state.mode&&!(0,M().kM)(I().default.state.multiSelection)}()||n(807926).A.state.open||"assistantCompletionPopup"===Ot().default.state.type)return Ns().I();let c=0,u=0;if(d){c=d.left;const e=25,t=d.top-36-e,o=n(175947).ek(r.isElectronMac),i=x-36-e;u=Math.min(Math.max(t,o),i)}0===Math.abs(tl().A.state.top-u)&&Math.abs(tl().A.state.left-c)<10&&(u=tl().A.state.top,c=tl().A.state.left),g(h()),tl().A.setState({...s,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:Nt().default.state.stores[0]})}),[t.currentUser,x,r.isElectronMac,s,g,h]),C=(0,o.useMemo)((()=>f().nF(A,200,{leading:!1})),[A]);(0,o.useEffect)((()=>(Nt().default.addListener(C),I().default.addListener(C),Js().A.addListener(A),el().A.addListener(A),Xs().A.addListener(A),qs().default.addListener(A),()=>{I().default.removeListener(C),Nt().default.removeListener(C),Js().A.removeListener(A),el().A.removeListener(A),Xs().A.removeListener(A),qs().default.removeListener(A)})),[A,C]);const w=(0,a().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===An().ev)return!!t&&(0,Gs().fc)(t);return!1}(d)),[d]),j=(0,o.useCallback)((()=>{s.isActive||tl().A.setState({...s,isAnimatingClosed:!1}),b(y)}),[s,y]);return(0,_.jsx)(yo().A,{open:l||c,children:(0,_.jsx)(bl,{handleAnimationEnd:j,isActive:l,isExternallyImportedAndSyncedCollectionPageBlockTarget:w,lastRenderState:v,richTextMenuStoreState:s,canOnlyDiscuss:S})})},vl=o.forwardRef((function(e,t){let{lastRenderState:n,richTextMenuStoreState:o,canOnlyDiscuss:i,style:a}=e;const{top:r,left:s}=o,l=Math.max(i?s:s-60,0),d=i?"12px 0":12;return(0,_.jsxs)("div",{className:_t().Vl,style:{pointerEvents:"none",position:"absolute",top:r,left:0,display:"flex",width:"100%",...a},ref:t,children:[(0,_.jsx)("div",{style:{flexShrink:1,width:l,minWidth:24}}),(0,po().A)((e=>(0,_.jsx)("div",{style:{pointerEvents:"none",padding:d},...e,children:n&&(0,_.jsx)(Rl,{renderState:n})}))),(0,_.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function bl(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:o,lastRenderState:i,richTextMenuStoreState:a,canOnlyDiscuss:r}=e;return(0,_.jsx)(fo().A,{tag:vl,visible:n&&!o,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:t,config:{duration:120},lastRenderState:i,richTextMenuStoreState:a,canOnlyDiscuss:r})}function xl(e){let{theme:t,styles:n}=e;return(0,_.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function Sl(e){let{blockStore:t}=e;const n=(0,Ie().DP)(),o=(0,i().v3)(),r=(0,K().tz)();let s=(0,_.jsx)(K().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,a().K8)((()=>t.getType()),[t]);if(l){const e=Ws().ry[l];s=e&&e.displayName||s}return(0,_.jsx)(al().Ay,{popupType:al().z7.Popup,buttonPopupStore:nl().A,originGap:4,renderOrigin:e=>(0,_.jsx)(Fe().A,{renderTooltip:()=>r.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,_.jsxs)(Vs().A,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.icon.primary,borderRadius:6},...(0,_a().A)(e,t),children:[s,(0,js().b)({width:10,marginLeft:4,fill:n.lightIconColor})]})}),render:()=>(0,_.jsx)(b().A,{menuType:S().gu.Popup,children:(0,_.jsx)(il().A,{context:{blocks:[t],environment:o,publicEditMode:void 0,analyticsFrom:"rich_text_menu"},sections:[Rs().t3],onAccept:e=>{const n=t.getType(),i=t.getFormat();Ns().I(),(0,Ds().N)(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Ys().Yt)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,Os().s)(o,{action:"turn_into"})}})}function Ml(){const e=(0,Ie().DP)();return(0,_.jsx)(cl().A,{type:"b",tooltipLabel:(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:e.text.contrastSecondary},name:"toggleBold"})})]}),children:ws({width:16,height:16})})}function Al(){const e=(0,Ie().DP)();return(0,_.jsx)(cl().A,{type:"i",tooltipLabel:(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:e.text.contrastSecondary},name:"toggleItalics"})})]}),children:Ts({width:16,height:16})})}function Cl(){const e=(0,Ie().DP)();return(0,_.jsx)(cl().A,{type:"s",tooltipLabel:(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:e.text.contrastSecondary},name:"toggleStrike"})})]}),children:_s({width:16,height:16})})}function wl(){const e=(0,Ie().DP)();return(0,_.jsx)(cl().A,{type:"_",tooltipLabel:(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:e.text.contrastSecondary},name:"toggleUnderline"})})]}),children:Bs({width:16,height:16})})}function jl(){const e=(0,Ie().DP)();return(0,_.jsx)(cl().A,{type:"c",tooltipLabel:(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{children:(0,_.jsx)(K().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:e.text.contrastSecondary},name:"toggleCode"})})]}),children:(0,ks().N)({width:16,height:16})})}function kl(e){let{}=e;const t=(0,Ie().DP)();return(0,_.jsx)(pl().A,{children:(0,_.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,Ps().w)({width:16,height:16,color:t.icon.primary}),(0,js().b)({width:10,fill:t.lightIconColor})]})})}function Il(e){let{intl:t,topRankedSkill:n}=e;const o=(0,Ie().DP)(),r=(0,i().v3)(),s=(0,a().K8)((()=>Rt().zD.isXMLAssistantEnabled()),[]);return(0,_.jsxs)(_.Fragment,{children:[n&&(0,_.jsxs)(Vs().A,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,bt().Nj)({environment:r,clientSkillWithParameterValues:(0,Ct().dangerouslyCreateClientSkillWithParameterValues)(n),from:"rich_text_menu",assistantSurfaceType:r.device.isMobile?"mobileWriter":"writer"}),(0,Os().s)(r,{action:"completions"})},children:[n.icon({width:16,height:16,marginRight:6,fill:(0,wt().vJ)(n.category).color(o).color}),(0,_.jsx)("span",{children:(0,_.jsx)(Es,{clientSkill:n})})]}),(0,_.jsx)(Fe().A,{renderTooltip:()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{children:s?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,_.jsx)("div",{children:(0,_.jsx)(is().A,{style:{color:o.text.contrastSecondary},name:"commandJ"})})]}),render:e=>(0,_.jsxs)(Vs().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,St().toggleInitialPrompt)({from:"rich_text_menu",environment:r}),(0,Os().s)(r,{action:"completions"})},children:[(0,_.jsx)(Mt().iB,{}),(0,_.jsx)("span",{style:{marginLeft:6,marginRight:2},children:(0,_.jsx)(K().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Tl(){const e=(0,i().v3)();return(0,_.jsx)(ul().A,{onClick:()=>{(0,Os().s)(e,{action:"e"}),Ns().I()},children:(0,Is().c)({width:16,height:16})})}function Pl(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ie().DP)(),i=(0,K().tz)();return(0,_.jsx)(rl().A,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28},iconOnly:n,blockStore:t,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function _l(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ie().DP)();return(0,_.jsx)(zs,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28,width:n?28:void 0},iconOnly:n,blockStore:t})}function Bl(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,_.jsx)(dl,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function Ll(e){let{targetBlockStore:t}=e;const n=(0,Ie().DP)(),o=(0,i().v3)();return(0,_.jsx)(ol().A,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.icon.primary},fadeIn:!1,onClick:()=>{(0,Os().s)(o,{action:"more"})}})}function Rl(e){let{renderState:t}=e;const o=(0,K().tz)(),i=(0,Ie().DP)(),r=(0,a().K8)((()=>tl().A.state.isActive),[]),s=t.showDiscuss||t.showReact||t.showSuggest,l=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,d=l;return(0,_.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:r?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Il,{intl:o,topRankedSkill:t.topRankedSkill}),(0,_.jsx)(xl,{theme:i})]}),s&&t.targetBlockStore&&(0,_.jsxs)(_.Fragment,{children:[t.showDiscuss&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Pl,{targetBlockStore:t.targetBlockStore,iconOnly:!1}),!d&&(t.showReact||t.showSuggest)&&(0,_.jsx)(xl,{theme:i})]}),t.showReact&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(_l,{targetBlockStore:t.targetBlockStore,iconOnly:d}),!d&&t.showSuggest&&(0,_.jsx)(xl,{theme:i})]}),t.showSuggest&&(0,_.jsx)(Bl,{targetBlockStore:t.targetBlockStore,iconOnly:d}),l&&(0,_.jsx)(xl,{theme:i})]}),l&&(0,_.jsxs)(_.Fragment,{children:[t.showTurnInto&&t.targetBlockStore&&(0,_.jsx)(Sl,{blockStore:t.targetBlockStore}),(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,_.jsx)(Ml,{}),t.showItalic&&(0,_.jsx)(Al,{}),t.showUnderline&&(0,_.jsx)(wl,{}),t.showStrikethrough&&(0,_.jsx)(Cl,{}),t.showCode&&(0,_.jsx)(jl,{}),t.showEquation&&(0,_.jsx)(Tl,{})]}),t.showLink&&(0,_.jsx)(kl,{}),t.showHighlight&&(0,_.jsx)(n(213799).A,{blockStore:t.targetBlockStore})]}),(0,_.jsx)(ml,{}),t.showActionButton&&t.targetBlockStore&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(xl,{theme:i}),(0,_.jsx)(Ll,{targetBlockStore:t.targetBlockStore})]})]})}var Dl=()=>n(753199),Ol=()=>n(489348),Nl=()=>n(869562),El=()=>n(749687);const Fl=5,Ul=18,Vl=.38;const Kl=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0),n=(0,o.useRef)(void 0),r=(0,o.useRef)(1/0),s=(0,o.useRef)(void 0),l=(0,a().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,o.useEffect)((()=>{l<Nl().OnlyOneSidebarVisibleWidthThreshold&&(0,Ye().Nk)(e)&&(0,Ye().KB)(e)&&Nl().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,l]),(0,o.useEffect)((()=>{const o=o=>{!function(e){let{e:t,environment:n,timerRef:o,cachedPageViewRectRef:i,previousMousePositionRef:a,mouseSpeedRef:r}=e;(0,Dl().SQ)({event:t,context:Dl().y$.SidebarMouseMove,callback:()=>{Wl(i),void 0!==a.current&&(r.current=Math.sqrt(Math.pow(t.clientX-a.current.x,2)+Math.pow(t.clientY-a.current.y,2))),function(e){let{x:t,y:n,timerRef:o,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(o.current),o.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:o,previousMousePositionRef:a});const e=X().default.checkGate({gateName:"sidebar_hover_expansion_v3"});if(i.current){const o=El().sidebarOpenStore.state,a=t.clientX,s=i.current.left,l=Math.max(s*Vl,Ul,El().sidebarMousePeekXStore.state);a<l&&!nr().default.isCenterPeekOpen()&&r.current<Fl&&0!==r.current&&!o&&!e&&Nl().open({fromElectron:!1}),a>(0,Ye().r6)(n)&&a>l&&o&&Nl().close()}}})}({e:o,environment:e,timerRef:s,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:r})};return window.addEventListener("mousemove",o),window.addEventListener("mouseout",zl),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseout",zl)}}),[e]),(0,_.jsx)(_.Fragment,{})};function zl(e){e.toElement||e.relatedTarget||Nl().close()}const Wl=f().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=J().default.state,t=Ol().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Hl=()=>n(171789),Gl=(n(803949),()=>n(662303)),Yl=()=>n(484392),ql=()=>n(916833),Ql=()=>n(177167),$l=()=>n(201902),Zl=()=>n(246760),Jl=()=>n(111091),Xl=()=>n(161479),ed=()=>n(979340),td=()=>n(148024),nd=()=>n(901389),od=()=>n(435009),id=()=>n(82926),ad=()=>n(120303),rd=()=>n(112995),sd=()=>n(650843),ld=()=>n(878377),dd=()=>n(777092),cd=()=>n(600871),ud=()=>n(891078),pd=()=>n(570323),md=()=>n(548821),gd=()=>n(991249),fd=()=>n(134217),hd=()=>n(10984),yd=()=>n(749240),vd=()=>n(958846),bd=()=>n(187485),xd=()=>n(460292),Sd=()=>n(554509),Md=()=>n(864943),Ad=()=>n(204063),Cd=()=>n(16006),wd=()=>n(2143),jd=()=>n(64901),kd=()=>n(221844),Id=()=>n(970013),Td=()=>n(452540),Pd=()=>n(388821),_d=()=>n(696706),Bd=()=>n(869558),Ld=()=>n(798880),Rd=()=>n(763824),Dd=()=>n(299772);const Od=function(e){const t=(0,i().v3)(),r=(0,a().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),s=(0,a().K8)((()=>{var e;return null==r||null===(e=r.getLayoutStore())||void 0===e?void 0:e.getModules()}),[r]),l=(0,a().K8)((()=>{if(!r)return 0;const{count:e}=(0,Ge().pm)({collectionStore:r});return e}),[r]),{device:{isMobile:d}}=(0,i().v3)(),c=l>0&&!d,u=(0,Ie().IS)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1,...c&&{paddingLeft:70,paddingRight:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(154807).xt,flexShrink:0,borderLeft:`1px solid ${e.stroke.secondary}`}})),[c]),p=(0,o.useCallback)((e=>{id().un(),od().oo({environment:t,url:e})}),[t]),m=e.blockStore.id,h=e.timestamp,[y]=(0,ue().Yb)((async()=>await async function(e,t,n){const{timestamp:o}=e,i=e.block.id,a=await W().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===a.type)throw a.error;const r=Pd().RecordMapWithRole.create(a.data.contentMap),s=n.currentUser.id,l=new(kd().A)({name:"PageSnapshotPreview"});for(const{pointer:m,model:g}of r)g&&l.setModelAndRole({pointer:m,userId:s},g,"reader");l.snapshotData={blockId:i,timestamp:o};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:s}),o=(0,Td().jV)(e);n||!(0,Cr().uj)(e.id)||d.has(o)||d.set(o,(0,ee().Oo)(t,e))},u=[];for(const{model:m}of r)if(m)if(m.table===An().ev){const e=m,t=e.getProperties(),n=_d().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(g().moK)));for(const d of n)c(d);const o=_d().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(Cs().n)));for(const d of o)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:An().ev,id:d});const a=e.getCollectionPointer();a&&(c(a),u.push(a.id));const r=f().sb(f().Bq(Object.keys(t).map((e=>t[e])).map(g().Fbh)));for(const d of r)c({table:Ld().oo,id:d});const s=m.getCreatedByPointer();s&&c(s);const l=m.getLastEditedByPointer();l&&c(l)}else if(m.table===Bd().Gy){var p;const e=null===(p=m.getFormat())||void 0===p?void 0:p.collection_pointer;e&&c(e)}else if(m.table===io().SN){const e=m.getCreatedByPointer();e&&c(e)}return await Nd({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Ls().Vl,id:e},userId:s}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const o=null===(t=n.schema)||void 0===t?void 0:t[e],i=o&&(0,Id().nC)(o)?(0,Id().zO)(o):void 0;i&&c({table:Ls().Vl,id:i})}))})),await Nd({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),{blockStore:new(ee().Bv)(n,{table:An().ev,id:i},{inMemoryRecordCache:l}),timestamp:o}}({block:{id:m,spaceId:(0,Xl().e)(e.blockStore.pointer.spaceId)},timestamp:h},e.blockStore,t)),[m,t,e.blockStore,h]),v="pending"!==y.status&&"idle"!==y.status,b=y.value,x=y.error,S=(0,ur().A)(!v||!b,400,400),M=(0,a().K8)((()=>{if(S)return(0,_.jsx)("div",{style:u.spinnerWrapper,children:(0,_.jsx)(Bn().A,{})});if(x)return(0,_.jsx)("div",{style:{padding:32},children:(0,_.jsx)(K().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const o=(0,Pt().fl)({environment:t,store:e.blockStore});return b?(0,_.jsxs)(n(21140).Ye,{style:u.container,children:[(0,_.jsx)(it().A,{store:b.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:n}=e;return(0,_.jsx)(wd().H,{style:u.scroller,type:o,...n,children:(0,_.jsx)(Dd().Ay,{store:b.blockStore,disabled:!0,context:md().Rr.InPageSnapShot,paddingBottom:(0,Dd().Wj)(t),layoutModulesByArea:s})})}},b.timestamp),c&&(null==s?void 0:s.page_details)&&(0,_.jsx)(wd().H,{style:u.layoutDetailsSidebar,type:et().A.Y,children:(0,_.jsx)(n(146594).H,{store:b.blockStore,context:md().Rr.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:s.page_details})})]}):void 0}),[S,x,t,e.blockStore,b,u.spinnerWrapper,u.container,u.layoutDetailsSidebar,u.scroller,c,s]);return(0,_.jsx)(rd().K,{from:"PageSnapshotPreview",fallback:e=>{let{errorId:t}=e;return(0,_.jsx)(sd().LargeSurfaceRenderError,{errorId:t})},children:(0,_.jsx)(n(484792).B,{value:p,children:M})})};async function Nd(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:o}=e,i=Array.from(t.values());await(0,Rd().lX)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))}var Ed=()=>n(147577);const Fd={display:"flex",justifyContent:"center",padding:32},Ud=(0,K().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Vd=function(){const e=(0,K().tz)(),t=(0,i().v3)(),{device:o}=t,r=(0,a().O$)(pd().A),s=ac();return o.isMobile?(0,_.jsx)(x().Ay,{ariaLabel:qd(e),popupType:j().n.SlideUp,open:r.open,render:()=>(0,_.jsx)(ic,{}),onDismiss:id().un}):(0,_.jsx)(n(957986).A,{ariaLabel:qd(e),open:r.open,innerStyle:s.modal,onDismiss:id().un,render:()=>(0,_.jsx)(ic,{}),className:_t().uMd})},Kd=(0,_.jsx)(K().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function zd(){return Jl().MO.filter((e=>"personal"!==e.tier))}function Wd(e){const t=zd(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function Hd(e){var t;if(G().A.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const o=(i=n,(Date.now()-parseInt(i.timestamp))/Cn().nD);var i;if((0,hd().sP)()&&o<=Jl().et.plus.days)return;const a=function(e){return zd().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,hd().bw)(a))return;const r=a[0]??"enterprise";return(0,ed().dL)(r)?void 0:{tier:r,message:(0,_.jsx)(K().sA,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Yl().A)((0,ed().$P)(r)?"plus":r),snapshotLimitDays:(null===(t=Wd(r))||void 0===t?void 0:t.days)??Math.floor(o)}})}}function Gd(){return(0,_.jsx)(jd().A,{href:(0,Oe().xS)("guides.pageHistory"),analyticsFrom:"page_history"})}function Yd(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,cd().mM)({environment:t})}function qd(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function Qd(e){const{device:t}=e;return t.isMobile?24:20}function $d(e){let{menuState:t}=e;const n=(0,i().v3)(),r=(0,a().K8)((()=>t.blockStore.getIcon()),[t.blockStore]),s=(0,a().K8)((()=>t.blockStore.isEmptyPage()),[t.blockStore]),l=ac();return t.snapshot?(0,_.jsxs)(o.Fragment,{children:[(0,_.jsxs)("div",{style:l.header,children:[r?(0,_.jsx)(ys().A,{disabled:!0,icon:r,isEmptyPage:s,size:Qd(n)}):null,r?null:(0,_.jsx)(xd().Q,{iconGroup:$l().M,variantName:"default",colorName:"secondary"}),(0,_.jsx)(Sd().D,{styleName:"Body-14px/Regular",colorName:"tertiary",children:(0,_.jsx)(Cd().A,{store:t.blockStore})})]}),(0,_.jsx)(Od,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function Zd(e,t){gd().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"}}})}function Jd(e){let{message:t,showUpgradeButtonForTier:n}=e;const o=(0,i().v3)(),{device:r}=o,s=(0,a().K8)((()=>fd().qc(yd().subscriptionDataStoreInstance.state)),[]),l=ac();let d=Yd(n,o);return d&&(0,cd().mM)({environment:o})&&"personal"===n&&!s&&(d=!1),(0,_.jsxs)("div",{style:r.isMobile?l.unavailableMessageComponentMobile:l.unavailableMessageComponent,children:[Yd(n,o)?(0,_.jsx)("img",{src:ka().A.images.icons.clockArrowLockSvg,alt:"loading..."}):null,(0,_.jsx)("div",{style:{...!r.isMobile&&{maxWidth:283}},children:t}),d&&n?(0,_.jsx)(Md().A,{size:"lg",onClick:()=>Zd(n,o),style:l.upsell,icon:()=>(0,_.jsx)(xd().Q,{iconGroup:ql().z,variantName:"default",colorName:"uiBluePrimary"}),children:(0,_.jsx)(K().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function Xd(e){const t=(0,i().v3)(),n=(0,K().tz)(),{device:r}=t,{menuState:s,loadingMore:l}=e,d=(0,ur().A)(l,300,100),c=ac();const u=function(e){const t=new Map;return e.forEach((e=>{const n=(0,Ea().W_)(parseInt(e.timestamp),"very_short",Gl().locale),o=t.get(n)??0;t.set(n,o+1)})),t}(e.snapshotValues),p=(0,o.useCallback)((e=>{const t=e>Date.now()-6*Cn().nD,n=u.get((0,Ea().W_)(e,"very_short",Gl().locale));return!!n&&(n>1||t)}),[u]),m=(0,a().K8)((()=>f().oE(e.snapshotValues.map(((o,i)=>{const a=i>0?e.snapshotValues[i-1]:void 0,l=!Hd({snapshot:o,nextFutureSnapshot:a});return{key:o.id,action:()=>{id().Xn({environment:t,snapshot:o,nextFutureSnapshot:a})},render:e=>{const t=o.authors||[],i=n.formatList(f().oE(t.map((e=>(0,dd().JQ)({parentStore:s.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),a=(0,_.jsx)("div",{style:{..._e().RC},children:i}),d=Boolean(s.snapshot&&s.snapshot.id===o.id),u=parseInt(o.timestamp),m=p(u),g=new Date(u).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",h=m?(0,Ea().jE)(u,Gl().locale,n,"·",g):(0,Ea().W_)(u,g,Gl().locale);return l?(0,_.jsx)(Et().A,{...e,title:h,focused:!r.isMobile&&d,caption:a,buttonStyle:c.buttonMenuItem,itemMarginLeft:8}):(0,_.jsx)(Et().A,{...e,title:(0,_.jsx)("div",{style:c.menuItem,children:(0,_.jsx)("div",{style:{...r.isMobile&&{display:"flex",flex:1},..._e().RC},children:h})}),focused:!r.isMobile&&d,caption:a,right:(0,_.jsx)(xd().Q,{iconGroup:Ql().x,variantName:"small",colorName:"tertiary"}),buttonStyle:c.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginRight:"7px"}})}}})))),[e.snapshotValues,r.isMobile,t,n,s.blockStore,s.snapshot,c,p]),g=s.snapshot&&s.snapshot.id,h=m.findIndex((e=>g===e.key)),y=[{key:"snapshots",render:e=>(0,_.jsx)(Ut().A,{...e}),items:m}];return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:h,sections:y}),(0,_.jsx)(vd().A,{loading:l,fetchSize:s.size,resultSize:e.snapshotValues.length,onLoadMore:id().p2}),d&&(0,_.jsx)("div",{style:Fd,children:(0,_.jsx)(Bn().A,{})})]})}function ec(e){let{menuState:t,onRestoreSnapshot:n}=e;const o=(0,i().v3)();return(0,_.jsx)(x().Ay,{popupType:j().n.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=Hd({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),i=!e,a=i?(0,_.jsx)(Od,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,_.jsx)(Jd,{message:e.message,showUpgradeButtonForTier:e.tier}),r=!i&&o.device.isMobileBrowser;return(0,_.jsx)(b().A,{menuType:S().gu.Modal,title:(0,Ea().jE)(parseInt(t.snapshot.timestamp),Gl().locale,Lt().A.getIntl()),right:(0,_.jsx)(ot().DoneMenuText,{}),onClickRight:id().j8,leftDisabled:!i&&!o.device.isMobileBrowser,left:r?(0,_.jsx)(K().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,_.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{r?Zd(e.tier,o):await n()})(),whiteBackground:i,forceFullScreenSlideUp:!0,children:a})}})}function tc(e){const t=(0,i().v3)(),{menuState:n}=e,o=(0,ud().i0)(n.blockStore),r=(0,ud().ty)(n.blockStore),s=(0,a().K8)((()=>Boolean(n.snapshot&&!o&&!r&&!Hd({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,ld().Xmj)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,t))),[t,n,o,r]),l=ac();return(0,_.jsxs)("div",{style:l.sidebarStyle,children:[(0,_.jsxs)("div",{style:l.sidebarHeader,children:[(0,_.jsx)(Sd().D,{styleName:"Heading-17px/Semibold",colorName:"primary",customStyles:{fontSize:16},children:(0,_.jsx)(K().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,_.jsx)(ad().R,{onClick:id().un,style:l.dismiss})]}),(0,_.jsx)(wd().H,{type:et().A.Y,style:{flex:1},children:(0,_.jsx)(Xd,{...e})}),(0,_.jsxs)("div",{style:l.actions,children:[(0,_.jsx)(ho().p,{size:"lg",style:l.learnMoreButton,onClick:()=>{td().FH(t,{from:"page_history"}),od().oo({environment:t,url:(0,Oe().xS)("guides.pageHistory"),openInNew:"tab"})},icon:()=>(0,_.jsx)(xd().Q,{iconGroup:Zl().G,variantName:"small",colorName:"secondary"}),children:(0,_.jsx)(Sd().D,{colorName:"secondary",children:(0,_.jsx)(K().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})})}),(0,_.jsx)(Fe().A,{disableTooltip:s,renderTooltip:()=>r?(0,_.jsx)(K().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):o?(0,_.jsx)(K().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,_.jsx)(K().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,_.jsx)(Ad().A,{size:"lg",onClick:e.onRestoreSnapshot,disabled:!s,...t,style:l.restoreButton,children:(0,_.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function nc(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,_.jsx)(Jd,{message:Kd,showUpgradeButtonForTier:!1})),n=e.error?(0,_.jsx)("div",{style:Fd,children:(0,_.jsx)(K().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,_.jsx)("div",{style:Fd,children:(0,_.jsx)(Bn().A,{})}):(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(wd().H,{type:et().A.Y,children:(0,_.jsx)(Xd,{...e})}),(0,_.jsx)(ec,{...e})]}),(0,_.jsx)(b().A,{menuType:S().gu.Modal,title:(0,_.jsx)(K().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,_.jsx)(Gd,{}),right:(0,_.jsx)(ot().DoneMenuText,{}),onClickRight:id().un,header:t,children:(0,_.jsx)(rd().K,{from:"MobileHistory",fallback:e=>{let{errorId:t}=e;return(0,_.jsx)(sd().LargeSurfaceRenderError,{errorId:t})},children:n})})}function oc(e){const t=(0,i().v3)(),n=(0,a().K8)((()=>e.menuState.snapshot?Hd({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),o=ac(),r=(0,a().K8)((()=>(0,Dd().Wj)(t)),[t]);let s;return s=e.error?(0,_.jsx)("div",{style:Fd,children:(0,_.jsx)(K().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,_.jsx)("div",{style:Fd,children:(0,_.jsx)(Bn().A,{})}):n?(0,_.jsxs)("div",{style:o.blurContainer,children:[(0,_.jsx)("div",{style:o.unavailableMessageText,children:(0,_.jsx)(Jd,{message:n.message,showUpgradeButtonForTier:n.tier})}),(0,_.jsx)("div",{style:o.snapshotBlur,children:(0,_.jsx)(Dd().Ay,{store:e.menuState.blockStore,disabled:!0,context:md().Rr.InPageSnapShot,paddingBottom:r})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,_.jsx)($d,{menuState:e.menuState}):(0,_.jsx)(Jd,{message:Kd,showUpgradeButtonForTier:!1}),(0,_.jsxs)(rd().K,{from:"DesktopHistory",fallback:e=>{let{errorId:t}=e;return(0,_.jsx)(sd().LargeSurfaceRenderError,{errorId:t})},children:[(0,_.jsx)("div",{style:o.preview,children:s}),(0,_.jsx)(tc,{...e})]})}function ic(){const e=(0,i().v3)(),{device:t}=e,n=(0,a().O$)(pd().A),[o]=(0,ue().Yb)((async()=>{if(n.open)return await async function(e,t,n){const{device:o}=n,i=await W().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:a}=i.data;if(t.pageHasCollection=a.some((e=>{var t;const n="collection"===e.parent_table,o=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||o&&0!==o})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),o=a.findIndex((t=>parseInt(t.timestamp)<e));0===a.length||(0===o?id().Xn({environment:n,snapshot:a[o],nextFutureSnapshot:void 0}):o>0?id().Xn({environment:n,snapshot:a[o-1],nextFutureSnapshot:o>1?a[o-2]:void 0}):a.length<t.size?id().Xn({environment:n,snapshot:a[a.length-1],nextFutureSnapshot:a.length>1?a[a.length-2]:void 0}):id().p2())}else Boolean(t.snapshot)||o.isMobile||pd().A.setState({...t,snapshot:a[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,Xl().e)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),r="pending"!==o.status&&"idle"!==o.status,s=o.error,l=o.value,d=(0,ur().A)(Boolean(n.open&&(!l||l.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const c=t.isMobile?nc:oc;return(0,_.jsx)(c,{snapshotValues:l?l.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",o=n.pageHasCollection?[{key:t,text:(0,_.jsx)(K().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(K().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,_.jsx)(bd().A,{external:!0,href:(0,Oe().xS)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,_.jsx)(K().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:i,selectionResult:a}=await nd().Gh({message:(0,_.jsx)("div",{style:{fontWeight:_e().Wy.semibold,fontSize:"medium"},children:(0,_.jsx)(K().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,_.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o,mode:o?"wide":void 0,textAlign:"left"});if(i){try{await id().n5(e,null==a?void 0:a[t])}catch{nd().f1(Lt().A.formatMessage(Ud.restoreSnapshotError))}id().un()}},error:s,initialLoading:d,loadingMore:!r})}function ac(){return(0,Ie().IS)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:Ed().pN,padding:"10px 8px 0px 8px",borderLeft:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",padding:"4px 4px 4px 8px"},actions:{display:"flex",padding:"12px 12px 12px 6px",borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginLeft:"-8px",marginRight:"-8px"},learnMoreButton:{padding:"0px 8px",borderRadius:"6px",gap:4},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${Ed().pN}px)`,boxShadow:`1px 0 0 ${e.regularDividerColor}`},restoreButton:{backgroundColor:e.text.uiBluePrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginLeft:"0px",marginRight:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingLeft:14,gap:6},modal:{height:`${Ed().fi}vh`,width:`${Ed().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingLeft:"8px",paddingRight:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var rc=()=>n(988499);async function sc(e){const{environment:t,emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:a}=e,r=function(e){const{emitValue:t,spaceStore:n,currentUserId:o,lastEmitData:i}=e;if(void 0===t)return!0;const a=n.id!==i.spaceId,r=o!==i.userId,s=t!==i.value;return a||r||s}({emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:a});if(!r)return;const{teams:s,teamAggregateData:l}=await(0,ge().qd)({fromCache:!1,environment:t,spaceStore:o,currentUserId:i,includeArchived:!1});rc().A.setState({teams:s,teamAggregateData:l,lastEmitData:{spaceId:o.id,userId:i,value:n}})}const lc=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,a().O$)(J().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=Q().Ay.addListener((0,U().Dh)(t.id),void 0,(async(n,o)=>{await sc({environment:e,emitValue:o,spaceStore:t,currentUserId:r,lastEmitData:rc().A.state.lastEmitData})}),void 0,e);return function(){n&&Q().Ay.removeListener(n,e)}}),[t,r,e]),null};var dc=()=>n(510683),cc=()=>n(755199),uc=()=>n(444768);const pc=function(){const e=(0,Ie().DP)(),t=(0,i().v3)(),o=(0,a().O$)(uc().A),r=(0,a().O$)(n(661179).A);if(!o.open)return null;const s=o.integration.info.icon;return s?(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+r,right:16+r,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,_.jsx)(n(854672).A,{type:"image_url",imageURL:s,size:38,style:{marginBottom:6}}),(0,_.jsx)("div",{style:{color:e.regularTextColor,fontSize:14,fontWeight:_e().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,_.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:o.integration.name}})}),(0,_.jsxs)("div",{style:{color:e.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,_.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,_.jsx)(n(719147).A,{href:(0,Oe().xS)("guides.unfurling"),external:!0,children:(0,_.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,_.jsx)(Ad().A,{onClick:()=>async function(e){const t=uc().A.state,{currentSpaceStore:n}=J().default.state;if(!t.open||!n)return;await dc().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),mc(t.integration.id,e),uc().A.reset()}(t),style:{width:"100%"},children:(0,_.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,_.jsx)(Ee().A,{icon:n(212050).u,onClick:()=>function(e){const t=uc().A.state;t.open&&mc(t.integration.id,e);uc().A.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function mc(e,t){const{currentUserSettingsStore:n}=J().default.state;n&&v().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{cc().Cw({transaction:t,userSettingsStore:n,integrationId:e})}})}n(18107),n(967357);var gc=()=>n(617871),fc=()=>n(559926),hc=()=>n(650829),yc=()=>n(398209),vc=()=>n(147294);const bc=function(){const e=(0,a().uB)(yc().A),t=(0,i().v3)(),n=(0,o.useRef)(null),r=(0,i().Y0)(),[s,l]=(0,a().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,o.useEffect)((()=>{const e=e=>{s&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&wc(t)},o=e=>{if(!s||!e.target||!n.current)return;const o=n.current;o&&o!==e.target&&wc(t)};return(0,ii().P4)(window,"keydown",e),(0,ii().P4)(window,"mousedown",o),()=>{(0,ii().Ol)(window,"keydown",e),(0,ii().Ol)(window,"mousedown",o)}}),[s,n,t]),(0,_.jsx)(x().Ay,{popupType:r.isMobileNative&&!r.isTablet?j().n.SlideUp:j().n.Popup,open:Boolean(s&&l),originRect:s?l:void 0,placementToOrigin:w().W.Top,alignmentToOrigin:w().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:r.isMobile,keepFocus:r.isMobile,render:()=>(0,_.jsx)(xc,{}),onDismiss:wc})};function xc(){const e=(0,a().uB)(yc().A),t=(0,i().v3)(),n=(0,i().Y0)(),r=(0,o.useRef)(null),s=(0,K().tz)(),[l,d,c,u]=(0,a().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),p=(0,Ie().IS)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:_e().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:_e().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]);if(!l)return null;const m={fontSize:_e().J.UIRegular.desktop,fontWeight:_e().Wy.regular,font:"SF Pro"},g=[{key:"embed section",render:e=>(0,_.jsx)(Ut().A,{...e,style:{paddingTop:6,paddingBottom:0}}),items:d.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,_.jsx)(Et().A,{...n,title:(0,_.jsx)(Sc,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),Mc(e,s,t)},style:m}),action:()=>Ac(e,t)})))},{key:"import section",render:e=>(0,_.jsx)(Ut().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:d.filter((e=>"import"===e)).map((e=>({key:e,render:n=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(_n().A,{size:4}),(0,_.jsx)(Et().A,{...n,title:(0,_.jsx)(Sc,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),Mc(e,s,t)},style:m})]}),action:()=>Ac(e,t)})))}];return(0,_.jsx)(hc().LazyAssistantUnfurlingMenuWithAiSection,{url:u,integration:c,headerStyle:p.header,menuTextStyle:m,updateUnfurlingOptionType:Mc,handleDismiss:Ac,renderMenu:e=>{let o,{maybeAiActionSection:i}=e;return o=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:d.includes("import")?260:i?220:200,maxHeight:"40vh",onClickOutside:()=>wc(t)},(0,_.jsx)(b().A,{...o,className:_t().Uvd,ref:r,header:(0,_.jsx)(Yt().A,{style:p.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,_.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,_.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:i?[...g,i]:g,initialFocus:0,onKeyboardArrow:e=>function(e,t,n,o){const i=yc().A.state;if(!i.open||void 0===e.indexGlobal)return;const a=i.allOptionTypes.at(e.indexGlobal);if(!a)return void(o&&Mc("preview",t,n));Mc(a,t,n)}(e,s,t,!!i),priority:1,disallowBackspace:!0})})}})}function Sc(e){let{optionType:t,integration:n}=e;return"preview"===t?(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===t?(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===t?(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===t?(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===t?(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===t?(null==n?void 0:n.id)===gc().me?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,_.jsx)(Ln().A,{style:{display:"inline"}})]}):(null==n?void 0:n.id)===gc().mn?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports and Lists"}),(0,_.jsx)(vc().E,{style:{display:"inline"},newBadgeKey:"salesforce_sync_unfurling_option",didUserEngage:!1})]}):(0,_.jsx)(K().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}):void(0,me().HB)(t)}function Mc(e,t,n){v().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:o=>{Hn().Oi({environment:n,type:Cc(e),useTemporaryRecordCache:!0,transaction:o,intl:t})}})}function Ac(e,t){const n=yc().A.state;fc().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open&&Hn().z1({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore}),v().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{Hn().VN({environment:t,setType:e?Cc(e):void 0,transaction:n})}})}function Cc(e){return"import"===e?"link":e}function wc(e){Ac(void 0,e)}n(16280);var jc=()=>n(721908),kc=()=>n(592269),Ic=()=>n(921598),Tc=()=>n(854150),Pc=()=>n(313892),_c=()=>n(519839),Bc=()=>n(199896),Lc=()=>n(861841),Rc=()=>n(854502),Dc=()=>n(666710);const Oc=200,Nc=30,Ec=125,Fc=25;var Uc=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Uc||{});function Vc(e){return e.type===Uc.Selectable?{type:Lc().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:Lc().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Kc(e){const{target:t,device:n,direction:o,points:i}=e;return o===Lc().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function zc(e){return(0,Bc().M)(e)?{type:Uc.Selectable,target:e}:{type:Uc.DropTarget,target:e}}function Wc(e){if(!e||!(0,Bc().M)(e))return!1;let t=e;const n=Lc().Ay.state;if(!n.isDragging)return!1;const{draggedStores:o}=n;for(;t;){if(o.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Hc(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Gc(e){switch(e.direction){case Lc().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,canAcceptDrop:s}=e,l=Lc().bH.Onto,d=Kc({device:t,target:i,direction:l,points:a});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&qc(d,o)&&!Wc(i)&&s(i,l))return{...zc(i),direction:l,left:o.left,top:o.top,width:o.width,height:o.height,priority:r}}(e);case Lc().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=Lc().bH.Left,c=Kc({device:t,target:i,direction:d,points:a});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.left)<=Oc&&(s||!Wc(i))&&l(i,d))return{...zc(i),direction:d,left:o.left,top:o.top,width:0,height:o.height,priority:r}}(e);case Lc().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=Lc().bH.Right,c=Kc({device:t,target:i,direction:d,points:a});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.right)<=Oc&&(s||!Wc(i))&&l(i,d))return{...zc(i),direction:d,left:o.right,top:o.top,width:0,height:o.height,priority:r}}(e);case Lc().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Nc,c=Hc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Lc().bH.Above,p=Kc({device:t,target:i,direction:u,points:a});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&o&&p.x>=o.left-d-c&&p.x<=o.right+c&&(s||!Wc(i))&&Math.abs(p.y-o.top)<=Ec&&(o.height<=2*Fc||p.y<=o.top+Fc)&&l(i,u))return{...zc(i),direction:u,left:o.left,top:o.top,width:o.width,height:0,priority:r}}(e);case Lc().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Nc,c=Hc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Ec,p=i.props.isLastItem?Number.MAX_SAFE_INTEGER:Ec,m=Lc().bH.Below,g=Kc({device:t,target:i,direction:m,points:a});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&o&&g.x>=o.left-d-c&&g.x<=o.right+c&&o.bottom-g.y<=u&&g.y-o.bottom<=p&&(o.height<=2*Fc||g.y>=o.bottom-Fc)&&(s||i.props.isLastItem||!Wc(i))&&l(i,Lc().bH.Below))return{...zc(i),direction:Lc().bH.Below,left:o.left,top:o.bottom,width:o.width,height:0,priority:r}}(e)}}function Yc(e){const{device:t,rect:n,target:o,points:i,optionKeyDown:a}=e;return qc(Kc({device:t,target:o,direction:Lc().bH.Onto,points:i}),n)&&Wc(o)&&!a}function qc(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Qc=()=>n(281322),$c=()=>n(776894),Zc=()=>n(396301),Jc=()=>n(49650),Xc=()=>n(585533),eu=()=>n(182106),tu=()=>n(696152),nu=()=>n(695625),ou=()=>n(444570),iu=()=>n(915440),au=()=>n(871399);const ru=2,su=20,lu=7;function du(){const e=(0,o.useRef)(!1),t=(0,o.useRef)(!1),n=(0,o.useRef)(void 0),a=(0,i().Y0)(),r=(0,i().v3)(),s=(0,As().S)(),l=(0,jc().d)((e=>Ei().A.withListenerIgnored((()=>(e=>{const o=au().default.state;if(!(e&&e.target instanceof Element)||o.isOpen&&o.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:i}=Lc().Ay.state;if(i)g();else{if(!n.current)return;pu(r,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,o.useCallback)((()=>{e.current||l(void 0)}),[l]),c=f().nF((()=>{const{isDragging:e}=Lc().Ay.state;Qn().default.afterNextFlush((()=>{n.current&&!e&&pu(r,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,o.useMemo)((()=>new WeakMap),[]),p=(0,o.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,ld().x7S)({environment:r,blocks:e,publicEditMode:s&&s.publicEditModeStore.state});return u.set(e,n),n??!1}),[r,s,u]),m=(0,o.useCallback)((()=>{const e=Lc().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:o,offsetX:i,offsetY:a,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:o,environment:i,pageContext:a,canDragFn:r}=e,{device:s}=i,l=Qc().r(),d=function(){const{selectableRectMap:e}=Dc().default.state,{dropTargetRectMap:t}=Rc().A.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const p=nu().T.findSelectableFromStore(n),m=p?p.getContextSelectableContainer():void 0;let g=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),p=e.getContextSelectableContainer();if(s.isPhone&&p!==m)continue;if(!p||p.getProps().disable)continue;const h=uu(p),y={device:s,isNativeDrag:o,rect:n,target:e,points:t,priority:h,optionKeyDown:l.option,canAcceptDrop:(e,t)=>vu({target:e,direction:t,optionKeyDown:l.option,environment:i,pageContext:a,canDragFn:r})};if(Yc(y))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};g.push(...f().oE([Gc({...y,direction:Lc().bH.Onto}),Gc({...y,direction:Lc().bH.Left}),Gc({...y,direction:Lc().bH.Right}),Gc({...y,direction:Lc().bH.Above}),Gc({...y,direction:Lc().bH.Below})]))}g=function(e){const t=gu(f().Sk(e,gu));return e.filter((e=>gu(e)===t))}(g);const h=g.filter((e=>e.direction===Lc().bH.Above||e.direction===Lc().bH.Below)),y=f().wq(h,(e=>Math.abs(e.top-mu(e,t,i).y)));if(y&&y.target===p)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let v=h.filter((e=>{let{top:t}=e;return Math.abs(t-(y?y.top:0))<=ru}));if(v.length>1){v=v.filter((e=>{const n=mu(e,t,i).x,o=Hc({device:s});return n>=e.left-o&&n<=e.left+e.width+o})),v=f().Ul(v,(e=>{let{left:t}=e;return t}));let e=0;for(;e<v.length-1;e++){const n=v[e+1],o=mu(n,t,i).x;if(n.left>o)break}v=v.slice(0,e+1),v.reverse()}const b=v.map(Vc);let x;const S=g.filter((e=>e.direction===Lc().bH.Onto)),M=f().wq(S,(e=>e.height));if(M){h.some((e=>{const n=mu(e,t,i).y;return Math.abs(e.top-n)<lu}))||(x=Vc(M))}let A;const C=g.filter((e=>e.direction===Lc().bH.Left||e.direction===Lc().bH.Right)).sort(((e,t)=>e.height-t.height));let w=f().wq(C,(e=>{const n=mu(e,t,i).x;return Math.abs(e.left-n)}));if(w){const e=w,t=C.filter((t=>Math.abs(t.left-e.left)<su));t.length>0&&(w=f().wq(t,(e=>e.left)))}if(w){const e=w;h.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(A=Vc(w))}return{ontoDropZone:x,verticalDropZone:A,horizontalDropZones:b}}({points:{mousePoint:{x:n,y:o},originPoint:{x:n-i,y:o-a}},draggingStore:t[0],isNativeDrag:l,environment:r,pageContext:s,canDragFn:p});if(d.ontoDropZone)Lc().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Lc().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=f().RT(d.horizontalDropZones);if(t.type===Lc().OX.Selectable){const o=nu().T.findSelectableFromStore(t.store);if(o){const i=o.getContextClosestSelectable();let a;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(a=i.props.store),void Lc().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:a})}}else{if(Xc().A.findDropTargetFromKey(t.key))return void Lc().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}Lc().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[r,p,s]),g=(0,o.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{m()}finally{e.current=!1}}),[m]),h=(0,o.useCallback)((()=>{const{isDragging:e}=Lc().Ay.state;e&&g()}),[g]),y=(0,o.useCallback)((()=>{t.current=!0}),[]);(0,o.useEffect)((()=>(window.addEventListener("mousemove",l),Nt().default.addListener(c),a.isIOS&&window.addEventListener("touchend",y),window.addEventListener("keydown",h),window.addEventListener("keyup",h),Lc().Ay.addListener(d),window.addEventListener("scroll",fu,!0),window.addEventListener("resize",hu),Pt().RR.addListener(yu),uo().sf(),()=>{window.removeEventListener("mousemove",l),Nt().default.removeListener(c),a.isIOS&&window.removeEventListener("touchend",y),window.removeEventListener("keydown",h),window.removeEventListener("keyup",h),Lc().Ay.removeListener(d),window.removeEventListener("scroll",fu,!0),window.removeEventListener("resize",hu),Pt().RR.removeListener(yu)})),[a.isIOS,d,c,h,l,y])}function cu(){const e=au().default.state;e.isOpen&&!e.menuIsOpen&&au().default.reset()}function uu(e){return(Nt().default.state.droppableContainerStack||[]).indexOf(e)}function pu(e,t,n,o){var i,a;const r=au().default.state;if(r.isOpen&&r.menuIsOpen)return;const s=function(e){const{environment:t,target:n,x:o,y:i,rightMarginCommentActionsEnabled:a}=e;if(iu().A.state.isResizing||Lc().Ay.state.isDragging||Ae().default.state.isActive||Pt().RR.state)return;const{selectableRectMap:r}=Dc().default.state,s=tu().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!s)return;const l=r.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=r.get(e),p=ou().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),m=ou().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:p}),g=ou().mC(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===s&&n&&Qs().ux((0,au().getExpandedSelectableRect)(n,a,p,m,g),o,i)){for(const t of au().HOVER_REGIONS)Qs().ux((0,au().getHoverRegionOfRect)(n,t,p,m,g),o,i)&&u.push({selectable:e,hoveredRegion:t});Qs().ux((0,au().getExactSelectableRect)(n,a),o,i)&&c.push(e)}d=l.next()}const p=f().Ul(c,(e=>{const t=r.get(e);return t?-t.left:1/0})),m=p.find((e=>{const t=e.getNode();return!t||!p.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return m?{exactSelectable:m,nearbySelectables:u,container:s}:{nearbySelectables:u,container:s}}({environment:e,target:t,x:n,y:o,rightMarginCommentActionsEnabled:!0});if(!s)return void au().default.reset();const l=!r.isOpen||(null===(i=s.exactSelectable)||void 0===i?void 0:i.props.store)!==r.currentStore,d=r.isOpen&&(null===(a=s.exactSelectable)||void 0===a?void 0:a.props.store)===r.currentStore;var c,u;l?au().default.setState({...r,isOpen:!0,menuIsOpen:!1,container:s.container,nearbySelectables:s.nearbySelectables,currentStore:null===(c=s.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=s.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:o}):d&&au().default.setState({...r,nearbySelectables:s.nearbySelectables,mouseX:n,mouseY:o})}function mu(e,t,n){return Kc({device:n.device,target:e.target,points:t})}function gu(e){return(null==e?void 0:e.priority)??0}function fu(){uo().AP(),cu()}function hu(){uo().AP(),cu()}function yu(){const e=au().default.state,t=Pt().RR.state;e.isOpen&&!e.menuIsOpen&&t&&au().default.reset()}function vu(e){const{target:t,direction:n,optionKeyDown:o,environment:i,pageContext:a,canDragFn:r}=e;if(Se().A.state.isOpen&&!nr().default.state.open)return!1;if(Me().A.state.isOpen)return!1;const s=Lc().Ay.state,l=s.isDragging?s.draggedStores:[],d=!!s.isDragging&&s.isNativeDrag;let c,u,p,m=!1,g=!1;l.find((e=>{const t=eu().A.findOutlinerItemFromStore(e);return!!t&&(c=t,u=t.type,m=t.isTopLevelItem,!0)}));const f=(0,Bc().M)(t)?eu().A.findOutlinerItemFromStore(t.props.store):void 0,h=null==f?void 0:f.parentStore;var y;f&&(p=f.type,g=f.isTopLevelItem||"team"===(null===(y=f.parentStore)||void 0===y?void 0:y.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:o,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===Tc().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||o&&o.pointer.id===e.pointer.id&&i!==Lc().bH.Onto))return!0}return!1}({draggingOutlinerItem:c,selectableOutlinerItemParent:h,direction:n}))return!1;if(!(0,Bc().M)(t))return t.props.canAcceptDrop({direction:n,draggingStores:l,isNativeDrag:d});const v=t.props.store;if(v.pathIsDead())return!1;if((0,$s().dL)(v))return!1;if("suggest"===Zs().Uv.getMode(v))return!1;const b=(0,_c().UH)(v);if(b&&b.isInTrashStore.state)return!1;const x=v.getAssociatedCollectionStore();if(n===Lc().bH.Onto&&x){const e=x.id,t=(0,_c().UH)(v),n=null==t?void 0:t.collectionViewBlockStore(),o=null==t?void 0:t.collectionViewStore();if(n&&o&&"page"!==o.getType()){if(l.find((o=>{const i=o.getAssociatedCollectionStore(),a=(0,_c().UH)(o);return Boolean(o instanceof ee().Bv&&i&&i.id===e)||Boolean(a===t&&v.id!==n.id)})))return!1}}if(n!==Lc().bH.Onto){const e=(0,_c().UH)(v);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!l.find((t=>{const n=(0,_c().UH)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var S;const e=null===(S=v.getCollectionStore())||void 0===S?void 0:S.getSchema();if(Boolean(t.props.groupsPointer.find((t=>!(0,kc().wj)(t,(null==x?void 0:x.getSchema())??e))))){if(l.find((e=>{var n;const o=nu().T.findSelectableFromStore(e);return(null==o||null===(n=o.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,Ic().PZ)(o.props.groupsPointer,t.props.groupsPointer)})))return!1}}if((0,$c().qy)({targets:l,destination:v,direction:n,draggingOutlinerType:u}))return!1;if(o&&l.find((e=>e.isTypedCollectionViewBlock()||(0,Pc().sZ)(e))))return!1;if(f&&n!==Lc().bH.Onto&&!g&&!(0,ld().ecY)({environment:i,blocks:[f.store],publicEditMode:null==a?void 0:a.publicEditModeStore.state}))return!1;if(p&&d)return!1;if("bookmarks"===u&&m&&("bookmarks"!==p||!g||n===Lc().bH.Onto))return!1;if("bookmarks"===p&&g&&n!==Lc().bH.Onto&&("bookmarks"!==u||!m))return!1;if(c&&c.isTopLevelItem&&"team"===c.type&&c.parentStore&&c.parentStore.table===Tc().yK){const e=c.parentStore,t=ee().h4.createChildStore(e,{...e.pointer,table:Tc().yK});if(t&&!(0,Zc().dp)({teamStore:t,environment:i}))return!1}if(f&&f.isTopLevelItem&&"team"===f.type&&f.parentStore&&f.parentStore.table===Tc().yK){const e=f.parentStore,t=ee().h4.createChildStore(e,{...e.pointer,table:Tc().yK});if(t&&!(0,Zc().dp)({teamStore:t,environment:i}))return!1}const{currentSpaceViewStore:M}=J().default.state,A=p?Zc().Kv[p]:void 0;if(M&&f&&c&&A&&f.isTopLevelItem&&n!==Lc().bH.Onto&&c.type!==p){const{sortOption:e}=(0,Zc().RQ)({spaceViewStore:M,type:A});if("lastEdited"===e)return!1}if("shared"===p&&g&&n!==Lc().bH.Onto&&("shared"!==u||!m))return!1;if(p&&g&&n!==Lc().bH.Onto){if(l.find((e=>{const t=e.getType();return Boolean(!t||!$e().BJ[t])})))return!1}const{device:C}=i;if(p&&C.isMobile&&n===Lc().bH.Onto&&g)return!1;if(l.some((e=>Boolean(Jc().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Jc().A.findCollectionTemplatePickerItemFromStore(v)))return!1;if(n===Lc().bH.Onto&&v&&!(0,ld().p2L)({environment:i,blocks:[v],publicEditMode:null==a?void 0:a.publicEditModeStore.state}))return!1;if(!r(l))return!1;if(l.some((e=>e.isTransclusionType()))){if(v.findRecordStoreUIAncestor((e=>{if(e===v)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,$e().Mp)(t))})).ancestor)return!1}return!0}function bu(){const e=(0,i().Y0)(),t=(0,i().v3)(),{isMobile:n,isElectron:d}=e;(0,o.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]);const c=(0,a().K8)((()=>J().default.state.currentSpaceStore),[]);(0,o.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,o.useEffect)((()=>{function e(e){Ae().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:Ae().default.state.currentX,currentY:Ae().default.state.currentY,toggle:e.shiftKey}))}function n(e){Ae().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function o(e){Ae().default.state.isActive&&((0,O().Mb)(e)||e.preventDefault(),r().OG(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}}),[t]);const g=t.currentUser.isLoggedIn();return ne(c,g),du(),(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(gt,{}),(0,_.jsx)(l().Gc,{}),(0,_.jsx)(l().MC,{}),(0,_.jsx)(ce,{}),(0,_.jsx)(ke().A,{priority:-1,capture:!0,debugName:"AppComponents"}),g&&!n&&(0,_.jsx)(Kl,{}),g&&(0,_.jsx)(be().AuthSyncListener,{}),g&&(0,_.jsx)(lc,{}),g&&(0,_.jsx)(tn,{}),g&&(0,_.jsx)(on,{}),g&&(0,_.jsx)(je,{}),g&&(0,_.jsx)(Yn,{}),g&&(0,_.jsx)(ye,{}),(0,_.jsx)(Jt().A,{}),(0,_.jsx)(Xr,{}),(0,_.jsx)(p().Li,{}),(0,_.jsx)(bs,{}),(0,_.jsx)(cs,{}),(0,_.jsx)(Lo,{}),(0,_.jsx)(qt,{}),!n&&(0,_.jsx)(yl,{}),(0,_.jsx)(Xo,{}),(0,_.jsx)(as,{}),(0,_.jsx)(di().A,{}),(0,_.jsx)($t().A,{store:Se().A}),(0,_.jsx)($t().A,{store:Me().A}),(0,_.jsx)(s().DV,{}),(0,_.jsx)(Zr,{}),(0,_.jsx)(xe().Tm,{}),(0,_.jsx)(B,{}),(0,_.jsx)(Nn,{}),(0,_.jsx)(ve().Sd,{}),(0,_.jsx)(bc,{}),(0,_.jsx)(li,{}),(0,_.jsx)(pc,{}),(0,_.jsx)(Kt,{}),(0,_.jsx)(Hl().A,{}),(0,_.jsx)(re,{}),d&&(0,_.jsx)(u,{}),(0,_.jsx)(hn,{}),(0,_.jsx)(Zt().Y,{}),g&&(0,_.jsx)(Vd,{}),(0,_.jsx)(qo().nJ,{}),(0,_.jsx)(ze,{}),(0,_.jsx)(Xt().yQ,{}),g&&(0,_.jsx)(cn,{}),(0,_.jsx)(m().h,{})]})}},126617:(e,t,n)=>{n.d(t,{Y:()=>i});n(296540);const o={viewBox:"0 0 16 16",svg:(0,n(474848).jsx)("path",{d:"M3.2 6.725a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55"})},i=(0,n(340498).wt)("ellipsisSmall",o)},135154:(e,t,n)=>{n.d(t,{E:()=>i});n(898992),n(823215);var o=()=>n(953418);function i(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return(0,o().sl)(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}},136805:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>B});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(328347),l=()=>n(864896),d=()=>n(959013),c=()=>n(100622),u=()=>n(904671),p=()=>n(38337),m=()=>n(553965),g=()=>n(321172),f=()=>n(623275),h=()=>n(437487),y=()=>n(326589),v=()=>n(962730),b=()=>n(227440),x=()=>n(493823),S=()=>n(406699),M=()=>n(35392),A=()=>n(859428),C=()=>n(281401),w=()=>n(863059),j=n(474848);const k=(0,d().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function I(e){let{store:t,buttonPopupStore:s}=e;const l=(0,i().v3)(),{isMobile:d,isTablet:c}=(0,a().K8)((()=>({isMobile:l.device.isMobile,isTablet:l.device.isTablet})),[l]),p=(0,a().uB)(void 0,n(103674).A),m=(0,a().uB)(void 0,n(529183).Ay),v=(0,a().uB)(void 0,n(454354).A),b=(0,a().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(t,v)),[t,v]),x=(0,a().K8)((()=>(0,n(663590).FI)({disableLogging:!0})),[]),M=(0,a().K8)((()=>t.canAdmin()),[t]),A=(0,a().K8)((()=>!d&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(p,m)),[m,d,p]),{sudoModeStoreId:C}=(0,a().K8)((()=>{var e;return{sudoModeStoreId:null===(e=v.state.privatePageStore)||void 0===e?void 0:e.id}}),[v]),w=(0,a().K8)((()=>n(351360).default.state.currentSpaceStore),[]);(0,o.useEffect)((()=>{!function(e){var t;let{environment:n,store:o,sudoModeStore:i,canAdmin:a,currentSpaceStore:r}=e;null!==(t=i.state.privatePageStore)&&void 0!==t&&t.id&&i.state.privatePageStore.id!==o.id&&i.reset();a||u().B({environment:n,sudoModeStore:i,pageBlockId:o.id,currentSpaceStore:r})}({environment:l,sudoModeStore:v,store:t,canAdmin:M,currentSpaceStore:w})}),[M,l,t,v,C,w]),(0,o.useEffect)((()=>{h().Ay.setState({...h().Ay.state,isInitialized:!0})}));const k=(0,o.useCallback)((()=>{s.reset()}),[s]),I=(0,o.useCallback)((()=>{_({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m}),n(778417).IU({environment:l}),g().Tk(l),(0,y().g)()||n(224701).Ow(l)}),[s,p,m,l]),P=(0,a().K8)((()=>(0,n(67805).sL)({environment:l,store:t})),[l,t]),B=(0,o.useCallback)((e=>(0,j.jsx)(T,{buttonPopupEvents:e,handleClick:I,showIconForPublicPermission:P})),[I,P]),L=(0,o.useCallback)((async()=>{if(m.state.inviteTargets.length>0){return void(await g().T({environment:l,inviteTargetsStore:m})&&(g().XP(l),_({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m})))}const{permissionsInviteStore:e}=p.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,n(743260).iQ)({environment:l,permissionsInviteStoreState:e.state,from:"share_menu"})||(g().XP(l),_({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m}))}),[s,l,m,p]),R=(0,r().IS)((e=>({buttonPopup:{...d?{width:"100%"}:c?{width:460}:{width:x?f().$D:500,overflow:"hidden",...x&&{borderRadius:f().Sg,boxShadow:e.shadowMD,..."dark"===e.mode&&{border:`1px solid ${e.largePopupBorder}`}}}}})),[d,x,c]);return(0,j.jsx)(S().Ay,{popupType:d?S().z7.SlideUp:S().z7.Popup,forceInitialInbound:!0,buttonPopupStore:s,renderOrigin:B,originGap:d?void 0:8,style:R.buttonPopup,onClick:I,render:()=>(0,j.jsx)(n(482707).k,{buttonPopupStore:s,sudoModeStore:v,store:b,inviteTargetsStore:m,universalMemberInviteStore:p,onUpgradeButtonClick:k,location:d?"topbar_mobile":"topbar_share_button",onClose:L}),persistOnClose:A,onDismiss:L,onClose:L})}function T(e){let{buttonPopupEvents:t,handleClick:n,showIconForPublicPermission:s}=e;const{isMobile:l}=(0,i().Y0)(),c=(0,a().K8)((()=>!b().A.state.online),[]),u=(0,a().K8)((()=>(0,y().g)()),[]),p=(0,r().IS)((e=>({shortcut:{color:e.text.contrastSecondary}})),[]),g=(0,o.useCallback)((()=>c?(0,j.jsx)(d().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{children:u?(0,j.jsx)(d().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,j.jsx)(d().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,j.jsx)(M().A,{style:p.shortcut,name:"openShareMenu"})]})),[c,u,p.shortcut]);return(0,j.jsx)(A().A,{disableTooltip:l,renderTooltip:g,placement:v().W.Bottom,delayThreshold:400,render:e=>(0,j.jsx)(P,{events:(0,m().A)(e,t),handleClick:n,disabled:c,showIconForPublicPermission:s})})}function P(e){let{events:t,handleClick:n,disabled:o,showIconForPublicPermission:a}=e;const{isMobile:u}=(0,i().Y0)(),m=(0,d().tz)(),g=(0,r().IS)((e=>{const t=(0,C().aD)(e),n=(0,w().Hh)(e);return{mobileIconStyle:t.iconStyle,globeIconStyle:{...n.icon,fill:c().Ay.blue,paddingRight:4},shareButton:{...u?t.iconContainer:{marginRight:n.iconButton.marginRight,marginLeft:n.iconButton.marginRight}},popup:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}}),[u]);const f=function(e){return u?(0,l().Y)(g.mobileIconStyle):(0,j.jsxs)(j.Fragment,{children:[e&&(0,s().h)(g.globeIconStyle),(0,j.jsx)(d().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"})]})}(a);return(0,j.jsx)(x().p,{id:void 0,className:p().voG,...t,mobileFeedback:u,style:g.shareButton,"aria-label":m.formatMessage(k.share),disabled:o,disabledFeedback:o,children:f})}function _(e){let{buttonPopupStore:t,universalMemberInviteStore:n,inviteTargetsStore:o}=e;t.reset(),n.reset(),o.reset()}const B=o.memo(I)},136833:(e,t,n)=>{function o(e){return Date.now()-parseInt(e.timestamp)}n.d(t,{S:()=>o})},137840:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>z,useSortActions:()=>G});n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(582684),l=()=>n(29037),d=()=>n(126617),c=()=>n(813197),u=()=>n(617668),p=()=>n(946065),m=()=>n(116225),g=()=>n(959013),f=()=>n(416726),h=()=>n(899963),y=()=>n(246826),v=()=>n(317909),b=()=>n(664713),x=()=>n(47373),S=()=>n(722872),M=()=>n(396301),A=()=>n(37433),C=()=>n(963589),w=()=>n(655923),j=()=>n(112282),k=()=>n(575143),I=()=>n(667193),T=()=>n(351360),P=()=>n(966711),_=n(474848);const B=(0,g().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var L=()=>n(852678),R=()=>n(620149),D=()=>n(848237),O=()=>n(452558),N=()=>n(704152),E=()=>n(406699),F=()=>n(928600),U=()=>n(8980),V=()=>n(89924);const K=(0,g().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function z(e){const{type:t,spaceViewStore:n}=e,a=(0,i().v3)(),s=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),l=(0,o.useCallback)((()=>{L().A.setState({open:!0}),h().ye(a,{outliner_type:M().BP[t]})}),[a,t]),c=(0,o.useCallback)((()=>{L().A.setState({open:!1})}),[]),u=(0,g().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return(0,_.jsx)(E().Ay,{popupType:E().z7.Popup,alignmentToOrigin:E().yP.Start,renderOrigin:e=>(0,_.jsx)(N().A,{style:s.button,ariaLabel:u,...e,children:(0,_.jsx)(U().I,{icon:d().Y,size:"sm",color:a.device.isMobile?"tertiary":"secondary"})}),onClick:l,onClose:c,render:e=>(0,_.jsx)(H,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const W=(0,g().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}});function H(e){const{type:t,spaceViewStore:n,onClose:o}=e,d=(0,i().v3)(),b=(0,g().tz)(),C=(0,r().IS)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),L=(0,a().K8)((()=>(0,x().rY)(d)),[d]),N=(0,a().K8)((()=>(0,M().RQ)({spaceViewStore:n,type:t})),[n,t]),E=N.sortOption,U=N.truncationLimit,z="shared"===t&&L||"private"===t||"teamspaces"===t,H="private"===t||"shared"===t&&L,q=(0,a().K8)((()=>!R().l.state),[]),Q=(0,a().K8)((()=>{const{currentSpaceStore:e}=T().default.state;return!!e&&(0,A().sx)({environment:d,spaceStore:e})}),[d]),$=q&&"teamspaces"===t&&Q,Z=G({type:t,onSelect:o,spaceViewStore:n,outlinerLocation:"sidebar"}),J=function(e){const{type:t,spaceViewStore:n,onSelect:o}=e,s=(0,i().v3)(),d=(0,r().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,a().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return p().AQ.map((e=>(0,f().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{v().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:s,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);y().KY({transaction:o,store:i,value:e})}}),m().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),h().nT(s,{outliner_type:M().BP[t],option:e}),o()},render:t=>(0,_.jsx)(k().A,{...t,title:(0,_.jsx)(Y,{limit:e,withItems:!0}),right:c===e&&(0,l().checkmarkIcon)(d.icon),rightStyle:d.right})})))}({type:t,onSelect:o,spaceViewStore:n}),X=function(e){const{type:t,onSelect:n}=e,o=(0,a().K8)((()=>T().default.state.currentSpaceStore),[]),r=(0,a().K8)((()=>T().default.state.currentSpaceViewStore),[]),s=(0,a().K8)((()=>T().default.state.currentUserRootStore),[]),l=(0,g().tz)(),d=(0,i().v3)(),c=(0,I().p)(),u=(0,P().m)(),p=(0,a().K8)((()=>(0,x().i3)({environment:d,spaceStore:o,userRootStore:s})),[d,o,s]),m=(0,M().KP)({sidebarOrder:u,sidebarState:c,showLockedSidebar:p});if(!r)return[];const b=m.indexOf(t),S=0===b,A=b===m.length-1,C=(null==c?void 0:c.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const o=B[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[()=>C>1],closeParentMenu:!0,action:o=>{let{environment:i}=o;const a=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:o,visibleSidebarOrder:i}=e;const a=[...o],r=o.indexOf(t),s=i.indexOf(t);if("moveUp"===n&&s>0){const e=i[s-1];a[o.indexOf(e)]=t,a[r]=e}if("moveDown"===n&&s<i.length-1){const e=i[s+1];a[o.indexOf(e)]=t,a[r]=e}return a}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:u,visibleSidebarOrder:m});v().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{y().zv({store:r,data:{sidebar_order:a},transaction:e})}}),h().ub(i,{section:t,previous_order:u,new_order:a,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&S||"moveDown"===e&&A,i="moveUp"===e?j().s:w().v;return(0,_.jsx)(k().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(o),svg:i})}})}))}({type:t,onSelect:o}),ee=[(0,f().uk)({key:"sort",displayName:W.sort,analyticsName:W.sort.defaultMessage,validators:[()=>H],svg:s().C,right:b.formatMessage(K[E]),rightStyle:C.rightText,subActions:()=>[(0,f().gy)({key:"sort",render:e=>(0,_.jsx)(V().A,{...e}),actions:Z})]}),(0,f().uk)({key:"truncationLimit",displayName:W.truncationLimit,analyticsName:W.truncationLimit.defaultMessage,validators:[()=>z],svg:c().L,right:(0,_.jsx)(Y,{limit:U}),rightStyle:C.rightText,subActions:()=>[(0,f().gy)({key:"truncationLimit",render:e=>(0,_.jsx)(V().A,{...e}),actions:J})]}),...X],te=[(0,f().gy)({key:"all",render:e=>(0,_.jsx)(V().A,{...e}),actions:ee}),(0,f().gy)({key:"addTeam",render:e=>(0,_.jsx)(V().A,{...e}),actions:[(0,f().Ls)({key:"addTeam",displayName:W.addTeam,analyticsName:W.addTeam.defaultMessage,validators:[()=>$],svg:u().plusIcon,closeParentMenu:!0,action:()=>{(0,D().vn)("sidebar_team_section"),o()}})]})];return(0,_.jsx)(F().A,{menuType:S().gu.Popup,minWidth:220,children:(0,_.jsx)(O().A,{context:{blocks:[],environment:d,publicEditMode:void 0},sections:te,initialFocus:void 0})})}function G(e){const{type:t,spaceViewStore:n,onSelect:o,outlinerLocation:s}=e,d=(0,i().v3)(),c=(0,g().tz)(),{currentSpaceStore:u}=(0,a().O$)(T().default),p=d.currentUser.id,x=(0,C().X)("sidebar_add_new_pages_to_bottom"),S=(0,a().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).sortOption),[t,n]),A=(0,r().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=K[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{v().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);y().KY({transaction:o,store:i,value:e})}}),"manual"===e&&"shared"===t&&!x&&p&&u&&await b().C({environment:d,spaceId:u.id,userId:p}),m().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),h().Rf(d,{outliner_type:M().BP[t],outliner_location:s,option:e}),o()},render:t=>(0,_.jsx)(k().A,{...t,title:c.formatMessage(i),right:S===e&&(0,l().checkmarkIcon)(A.icon),rightStyle:A.right})})}))}function Y(e){const{limit:t,withItems:n}=e;return t===p().vw?(0,_.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,_.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,_.jsx)("span",{children:t})}},146594:(e,t,n)=>{n.d(t,{H:()=>a});var o=()=>n(645873);const i=new(o().O2)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(23806),n.e(9304),n.e(81141),n.e(72915),n.e(69689),n.e(43647),n.e(21377)]).then(n.bind(n,722143)))),a=(0,o()._h)(i,(e=>e.UpdateSidebarTabInfo))},149257:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),i=()=>n(959013),a=n(474848);const r=(0,i().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:l,isModalOpen:d,onDismiss:c}=e,[u,p]=(0,o.useState)(""),m=(0,n(484714).v3)(),g=(0,i().tz)(),f=async()=>{await n(350648).Ip({environment:m,teamId:l,message:u}),c()},h=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,a.jsx)(n(957986).A,{open:d,onDismiss:c,innerStyle:h.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:h.requestTitle,children:(0,a.jsx)(i().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,a.jsx)(n(898808).x,{style:h.icon,store:t,disabled:!0,size:22})}})}),(0,a.jsx)(n(623580).A,{textarea:!0,style:h.input,value:u,onChange:e=>{p(e.target.value)},placeholder:g.formatMessage(r.message_placeholder)}),(0,a.jsxs)("div",{style:h.footer,children:[(0,a.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,a.jsx)(i().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,a.jsx)(n(204063).A,{size:"lg",style:h.requestInvitesButton,onClick:f,children:(0,a.jsx)(i().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>v});n(898992),n(354520);var o=n(296540),i=()=>n(484714),a=()=>n(56366);const r="initial_handshake";var s=()=>n(798880),l=()=>n(959013),d=()=>n(496603),c=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),g=()=>n(179534),f=()=>n(214006),h=n(474848);const y=1;function v(){const e=(0,i().v3)(),t=(0,l().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,v=e.currentUser.isLoggedIn(),[b,x]=(0,o.useState)(null),[S,M]=(0,o.useState)({value:!1,count:0}),A=(0,a().K8)((()=>g().A.getTotalUnreadMentionsCount()),[]),C=(0,a().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(x(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{v&&(S.value||0===S.count||null==b||b.postMessage({version:y,name:"unreadCount",source:"notion",unreadCount:A}))}),[v,S.count,S.value,b,A]);const w=(0,o.useCallback)((async()=>{const e=d().hS(C,"userId"),n=await(0,c().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const o=n.getEmail()??"",i=n.getDisplayName(t)??"";return{id:e.userId,displayName:i,emailAddress:o}}));null==b||b.postMessage({version:y,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,C]);(0,o.useEffect)((()=>{v&&b&&(S.value||0===S.count)&&w()}),[v,w,S.count,S.value,b]),(0,o.useEffect)((()=>{e.currentUser.id&&(0,u().uj)(e.currentUser.id)&&(null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id,type:"mutation"}))}),[e.currentUser.id,b]),(0,o.useEffect)((()=>{v||null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"})}),[v,b]);const j=(0,o.useCallback)((e=>{if(e.data.version!==y)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)M((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(x((e=>(e&&(e.onmessage=j),e))),()=>{x((e=>(e&&(e.onmessage=null),e)))})),[j,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(r,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},171789:(e,t,n)=>{n.d(t,{A:()=>r});n(898992),n(354520),n(581454);var o=n(296540),i=n(474848);function a(){const[e,t]=(0,o.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,o.useEffect)((()=>{const e=new(n(496506).default)((()=>n(666429).Ay.state.currentItem),{debugName:"currentItemStore"});let o=null;function i(){const n=e.state;n&&o!==n.key?(t({type:"push",item:n}),o=n.key):n||t({type:"clear"})}return e.addListener(i),()=>{e.removeListener(i)}}),[]),(0,i.jsx)(n(625325).A,{open:e.length>0,zIndex:201,children:e.map((e=>(0,o.createElement)(s,{...e,key:e.item.key,dispatch:t})))})}const r=o.memo(a),s=o.memo((function(e){let{dispatch:t,isAnimatingOut:a,item:r}=e;const s=(0,n(401497).DP)(),l=(0,n(552871).L)(),d=(0,o.useCallback)((()=>{t({type:"delete",key:r.key})}),[t,r.key]),c=(0,o.useRef)(a);(0,o.useEffect)((()=>{if(!c.current&&a){const e=setTimeout(d,270);return()=>{d(),clearTimeout(e)}}c.current=a}),[a,d]);const u=r.position??"bottom",p="top"===u?{top:24}:{bottom:l};return(0,i.jsx)("div",{style:{...p,position:"fixed",left:0,width:"100%",display:"flex",zIndex:1e6,padding:4,pointerEvents:"none"},children:(0,i.jsxs)("div",{"aria-live":"polite",style:{background:s.tooltipBackground,color:s.text.contrastPrimary,borderRadius:8,padding:"11px 16px",boxShadow:s.shadowLG,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...r.style,animationName:`snackbar-slide-in-${u}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:a?"scale(0.95)":"scale(1)",opacity:a?0:1},onTransitionEnd:a?d:void 0,children:[r.label,r.helpUrl&&(0,i.jsx)(n(296798).A,{href:r.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:s.text.contrastPrimary},children:(0,n(133033).$)({fill:s.text.contrastSecondary})}),(0,i.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:r.right})]})})}))},178998:(e,t,n)=>{n.d(t,{Z:()=>c});var o=()=>n(416726),i=()=>n(878377),a=()=>n(972435),r=()=>n(227440),s=()=>n(540758),l=()=>n(670631);const d=(0,n(959013).YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}}),c=(0,o().fi)({key:"available offline",svg:n(973238).G,svgWhenEnabled:n(671089).x,displayName:d.name,label:a().A.formatMessage(d.name),isLoading:e=>{const t=void 0===l().A.state.offlinePages,n=s().B(e.id);return t||n&&l().A.state.isSlowWrite},isEnabled:e=>s().f(e.id),validators:[i().SQN("download_for_offline"),i().or([i().b8R,i().wHP])],action:(e,t,o,i)=>{n(589506).toggleExplicitlyOfflined({store:t,environment:e,analyticsFrom:i})},disabled:e=>!r().A.state.online,renderTooltip:()=>a().A.formatMessage(o().AY.unavailableOfflineTooltip),disableTooltip:e=>r().A.state.online||s().B(e.id)})},183804:(e,t,n)=>{n.d(t,{A:()=>l,C:()=>d});n(296540);var o=()=>n(562866),i=()=>n(725118),a=()=>n(803557),r=()=>n(437487),s=n(474848);function l(e){const{onInviteClick:t,onInviteComplete:n,buttonStyle:a,buttonContainerStyle:r}=e;return[{key:"slack_imports",render:()=>(0,s.jsx)(i().R,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,s.jsx)(o().$c,{type:"slack"}),buttonStyle:a,buttonContainerStyle:r}),action:()=>{}},{key:"google_imports",render:()=>(0,s.jsx)(o().aI,{inviteOrigin:"space_setting_google_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,s.jsx)(o().$c,{type:"google"}),buttonStyle:a,buttonContainerStyle:r}),action:()=>{}}]}function d(e){const{onClickAuthenticated:t,hideChevronIcon:n,containerStyle:i,buttonStyle:l,flowId:d}=e;return[{key:"slack_imports",render:()=>(0,s.jsx)(a().Xx,{onClickAuthenticated:()=>t(r().NL.Slack),title:(0,s.jsx)(o().$c,{type:"slack"}),containerStyle:i,buttonStyle:l,from:"share_menu",inviteOrigin:"page_share_modal",flowId:d,loadContacts:!0,hideChevronIcon:n}),action:()=>{}},{key:"google_imports",render:()=>(0,s.jsx)(a().KG,{onClickAuthenticated:()=>t(r().NL.Google),containerStyle:i,buttonStyle:l,from:"share_menu",inviteOrigin:"page_share_modal",flowId:d,loadContacts:!0,hideChevronIcon:n,buttonLabel:(0,s.jsx)(o().$c,{type:"google"})}),action:()=>{}}]}},192940:(e,t,n)=>{n.d(t,{h:()=>a});var o=()=>n(56366),i=()=>n(37433);function a(e){return(0,o().K8)((()=>{var t;return void 0===e?0:(null===(t=(0,i().PF)(e))||void 0===t?void 0:t.memberCountWithGuests)??0}),[e])}},195795:(e,t,n)=>{n.d(t,{A:()=>C});n(898992),n(672577),n(737550);var o=n(296540),i=()=>n(484714),a=()=>n(921385),r=()=>n(741496),s=()=>n(884107),l=()=>n(659602),d=()=>n(335722),c=()=>n(862292),u=()=>n(267430),p=()=>n(494043),m=()=>n(645873),g=()=>n(56366),f=()=>n(961581);var h=()=>n(695625),y=()=>n(407054),v=()=>n(508496),b=()=>n(732770),x=()=>n(871399),S=()=>n(502438),M=()=>n(527606),A=n(474848);function C(e){const t=(0,i().v3)(),{value:r}=(0,m().fJ)(l().g),{value:u}=(0,m().fJ)(d().S),{value:p}=(0,m().fJ)(c().T.formulas),{value:h}=(0,m().fJ)(s().R.clipboardActions),[y,v]=(0,o.useState)([]),x=(0,g().K8)((()=>f().A.state.initialRenderCompleted),[]);(0,o.useEffect)((()=>{(async()=>{if(x){const{lowPriActionsWithKeyboardShortcuts:e}=await n.e(15498).then(n.bind(n,28965));v(e)}})()}),[x]);const S=(0,o.useRef)(),C=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===S.current&&e.clientY===C.current||(S.current=e.clientX,C.current=e.clientY,b().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const w=(0,o.useMemo)((()=>[...a().D0,...y]),[y]),k=(0,o.useMemo)((()=>function(e,t,n,o,i,a){const r={};for(const s of a)for(const l of s.shortcuts)r[l]=r=>j(l,r,e,t,n,o,i,a);return r}(h,p,r,u,t,w)),[t,p,r,u,h,w]);return(0,A.jsx)(M().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:k})}function w(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(y().A.state.isActive&&!v().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function j(e,t,n,o,i,a,s,l){if(!w())return;const d=S().default.state.stores,c=S().default.state.pivot||d[0],m=c&&h().T.getRectFromStore(c),g=l.find((t=>!!t.shortcuts.some((t=>t===e))&&u().F6(t,{environment:s,blocks:d,originRect:m,publicEditMode:void 0})));if(g){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=y().A.state.isActive;g.action({environment:s,blocks:d,originRect:m,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",lazyDependencies:{clipboardActions:n,formulasModule:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}},t);const l=d[0];let c,u,h,S;var f;if(l)c=l.getType(),u=c?(0,p().Yt)(c,l.getFormat()):void 0,h=null===(f=l.getCollectionStore())||void 0===f?void 0:f.id,S=l.getParentCollectionIdUpToTwoLevels();(0,r().N)(s,{analyticsName:g.analyticsName,action_type:g.analyticsActionType,from:"keyboard_shortcut",block_id:null==l?void 0:l.id,block_type:c,is_toggleable:u,collection_id:h,parent_collection_id:S}),M={resetBlockMenuStore:e},b().A.setKeyboardMode(!0),x().default.reset(),v().default.checkGate({gateName:"block_menu_shortcut_fix"})&&M.resetBlockMenuStore&&y().A.reset()}var M}},201170:(e,t,n)=>{n.d(t,{HX:()=>a,Hi:()=>i().Hi,lR:()=>r});var o=()=>n(736026),i=()=>n(348337);function a(){o().A.setState({open:!0,submitted:!1,error:void 0})}function r(){o().A.setState({open:!1})}},201902:(e,t,n)=>{n.d(t,{M:()=>o});const o=(0,n(340498).xh)("page",{default:{loader:()=>n.e(82985).then(n.bind(n,982985))},small:{loader:()=>n.e(88931).then(n.bind(n,188931))},mini:{loader:()=>n.e(35189).then(n.bind(n,735189))},large:{loader:()=>n.e(86763).then(n.bind(n,686763))},extraLarge:{loader:()=>n.e(83295).then(n.bind(n,683295))}})},204552:(e,t,n)=>{n.d(t,{c:()=>i,x:()=>a});var o=()=>n(645873);const i=(0,o()._h)(new(o().O2)("UniversalQnaModals",(async()=>await Promise.all([n.e(23806),n.e(37353),n.e(55373),n.e(29151),n.e(16908),n.e(48315),n.e(847),n.e(5887),n.e(17989),n.e(56985),n.e(21627),n.e(82472),n.e(96345),n.e(75659),n.e(47858),n.e(51860),n.e(221),n.e(14358)]).then(n.bind(n,457974)))),(e=>e.UniversalQnaModals)),a=(0,o()._h)(new(o().O2)("SlackConnectionOptions",(async()=>await n.e(85873).then(n.bind(n,210230)))),(e=>e.SlackConnectionOptions))},211825:(e,t,n)=>{n.d(t,{G:()=>r});var o=()=>n(484714),i=()=>n(56366),a=()=>n(486130);function r(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,a()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},213799:(e,t,n)=>{n.d(t,{A:()=>k});n(581454);var o=n(296540),i=()=>n(17022),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(919709),d=()=>n(959013),c=()=>n(100622),u=()=>n(284371),p=()=>n(21869),m=()=>n(906590),g=()=>n(482287),f=()=>n(722872),h=()=>n(77272),y=()=>n(24157),v=()=>n(491073),b=()=>n(406699),x=()=>n(928600),S=()=>n(939740),M=()=>n(45552),A=()=>n(89924),C=n(474848);const w=o.Fragment;function j(e){let{parent:t,shouldShowUpdatedColorPicker:n,textSelectionColor:l,backgroundSelectionColor:u}=e;const y=(0,a().v3)(),{isMobile:b}=y.device,[w,j]=(0,o.useState)((()=>i().A.withListenerIgnored((()=>h().A.state.recentlyUsedColors)))),k=(0,o.useCallback)((e=>{m().Q(e,!n),g().po({environment:y,annotation:["h",h().A.getMostRecentlyUsedColor()]}),(0,p().s)(y,{action:"h",color:h().A.getMostRecentlyUsedColor()})}),[y,n]),I=(0,o.useCallback)(((e,t,o,i)=>({key:t||e,action:()=>{k(e),b&&o.close()},render:o=>(0,C.jsx)(v().Ay,{...o,color:e,overrideDisplayName:t,selected:i,shouldShowUpdatedColorPicker:n})})),[k,n,b]);let T;T=b?{menuType:f().gu.Modal,title:(0,C.jsx)(d().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:(0,C.jsx)(M().CancelMenuText,{}),onClickRight:()=>{t.close()}}:n?{menuType:f().gu.Popup,width:190}:{menuType:f().gu.Popup,width:220};const P=w.map((e=>I(e,void 0,t,!1))),_=(0,r().K8)((()=>h().A.getMostRecentlyUsedColor()),[]),B=c().N.map((e=>I(e,void 0,t,l||u?e===l:"default"===e))),L=c().AQ.map((e=>I(e,void 0,t,e===u))),R=(0,s().IS)((e=>({blockColorMenuItemContainer:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:4,paddingTop:0,paddingBottom:0,paddingLeft:8,paddingRight:8},sectionMenuItemOverride:{display:"block"}})),[]);return(0,C.jsx)(x().A,{...T,children:(0,C.jsx)(S().Ay,{type:S().Oh.Vertical,sections:[{key:0,items:n?P:[{key:0,action:()=>{k(_),b&&t.close()},render:e=>(0,C.jsx)(v().Ay,{...e,color:_,shortcuts:["toggleHighlight"]})}],render:e=>(0,C.jsx)(A().A,{...e,title:(0,C.jsx)(d().sA,{defaultMessage:"Recently used",id:"highlightSelectionButton.lastUsedSection.label"}),desktopStyle:R.sectionMenuItemOverride,children:n?(0,C.jsx)("div",{style:R.blockColorMenuItemContainer,children:e.children}):e.children})},{key:1,items:B,render:e=>(0,C.jsx)(A().A,{...e,title:(0,C.jsx)(d().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.colorSection.label"}),desktopStyle:R.sectionMenuItemOverride,children:n?(0,C.jsx)("div",{style:R.blockColorMenuItemContainer,children:e.children}):e.children})},{key:2,items:L,render:e=>(0,C.jsx)(A().A,{...e,title:(0,C.jsx)(d().sA,{defaultMessage:"Background color",id:"highlightSelectionButton.backgroundSection.label"}),desktopStyle:R.sectionMenuItemOverride,children:n?(0,C.jsx)("div",{style:{...R.blockColorMenuItemContainer,paddingBottom:8},children:e.children}):e.children})}],initialFocus:void 0})})}const k=function(e){const{disabled:t,style:i,blockStore:m}=e,g=(0,a().v3)(),f=(0,s().DP)(),h=(0,o.useCallback)((e=>{(0,p().s)(g,{action:"h"})}),[g]),x=(0,o.useCallback)((()=>{y().default.emit()}),[]),S=(0,n(963589).X)("updated_color_picker")&&!g.device.isMobile,{textSelectionColor:M,backgroundSelectionColor:A}=(0,r().K8)((()=>{if("editing"!==y().default.state.mode)return{textSelectionColor:void 0,backgroundSelectionColor:void 0};const e=(0,n(792002).x7)(["hf","hb"],y().default.state.multiSelection,y().default.state.forceExtendAnnotations),t=e.hf,o=e.hb;let i="default",a="default_background";if(t&&l().YuY(t))i=l().uIc(t);else if(m){const{block_color:e}=m.getFormat();e&&c().N.includes(e)&&(i=e)}return o&&l().YuY(o)&&(a=l().uIc(o)),{textSelectionColor:i,backgroundSelectionColor:a}}),[m]),k=(0,s().IS)((e=>{const t=(0,c().D$)(M??"default",e),n=(0,c().D$)(A??"default_background",e),o="default"!==M||void 0===n.background?t:n,i=(0,v().Nc)(A??"default_background",!1,e);return{colorIcon:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!g.device.isMobile&&{width:18,fontWeight:u().Wy.medium,marginBottom:2},...n,...t},colorIconCircle:S?{display:"inline-flex",alignItems:"center",justifyContent:"center",width:24,height:24,textAlign:"center",padding:8,margin:0,fontSize:16,borderRadius:6,fontWeight:u().Wy.medium,color:t.color,background:n.background,boxShadow:(0,v().Yr)(i,!1)}:{width:16,height:16,borderRadius:8,background:o.color??o.fill??o.background}}}),[M,A,g.device.isMobile,S]);return(0,C.jsx)(b().Ay,{popupType:g.device.isMobile?b().z7.SlideUp:b().z7.Popup,originGap:4,onClose:x,onClick:h,renderOrigin:e=>(0,C.jsx)(n(859428).A,{renderTooltip:()=>(0,C.jsxs)(w,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(d().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(n(35392).A,{style:{color:f.text.contrastSecondary},name:"toggleHighlight"})})]}),render:o=>(0,C.jsxs)(n(704152).A,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",borderRadius:6,...i},disabled:t,disabledFeedback:t,...(0,n(553965).A)(e,o),children:[g.device.isMobile?(0,C.jsx)("div",{style:k.colorIcon,children:(0,C.jsx)(d().sA,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"})}):(0,C.jsx)("div",{style:k.colorIconCircle,children:S?"A":""}),(0,n(668725).b)({width:10,marginLeft:4,fill:"dark"===f.mode?c().Ay.white:f.lightIconColor})]})}),render:e=>(0,C.jsx)(j,{parent:e,shouldShowUpdatedColorPicker:S,textSelectionColor:M,backgroundSelectionColor:A})})}},217827:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(821062);class i extends(()=>n(757695))().default{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,o().A)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,o().A)(this.instanceState,e)||this.setState(e)}}const a=new i;(0,n(604341).exposeDebugValue)("AutomationFocusStore",i)},218429:(e,t,n)=>{n.d(t,{l:()=>x});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(543906),l=()=>n(110750),d=()=>n(778417),c=()=>n(725614),u=()=>n(297872),p=()=>n(957986),m=()=>n(754002),g=()=>n(780054),f=()=>n(836251),h=()=>n(404141),y=()=>n(51367),v=()=>n(131448),b=n(474848);function x(e){const{messageKey:t,desktopRenderInner:n,desktopInnerStyle:o,desktopOnDismiss:d,phoneRenderInner:c,phoneInnerStyle:m}=e,x=(0,i().v3)(),M=(0,i().Y0)(),A=(0,r().IS)((e=>({modalStyle:{background:e.surface.wash,borderRadius:12,...o}})),[o]),C=(0,a().K8)((()=>{var e;const t=(0,l().Xz)(x.TabbedRouterStore.state);return"web"===t.type&&((null===(e=t.redirectedTo)||void 0===e?void 0:e.route)||t.route)}),[x.TabbedRouterStore]),w=(0,a().K8)((()=>!(M.isPhone&&(0,f().Al)(x)&&(!C||"page"!==C.name))&&!g().A.isAdminMode&&!h().A.state.open),[M.isPhone,x,C]),j=(0,a().K8)((()=>v().default.isVisible(t)),[t])&&w;return(0,s().A)((()=>{y().DL(x,{callout_key:t,is_forced:v().default.isForced(t),placement_key:"Modal"})}),j),j?M.isPhone?(0,b.jsx)(S,{messageKey:t,renderInner:c,innerStyle:m}):(0,b.jsx)(p().A,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:d,innerStyle:A.modalStyle,render:()=>(0,b.jsx)(u().A,{capture:!0,allowEsc:!0,render:n})}):null}function S(e){const{renderInner:t,innerStyle:n,messageKey:a}=e,r=(0,i().v3)(),s=(0,o.useCallback)((()=>{y().Sq(r,{callout_key:a,dismiss_type:"modal_background_clicked",placement_key:"Modal"})}),[r,a]),l=(0,o.useCallback)((()=>{y().Sq(r,{callout_key:a,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"})}),[r,a]);return(0,o.useEffect)((()=>{d().IU({environment:r}),c().blurActiveElement()}),[r]),(0,b.jsx)(m()._,{renderInner:t,innerStyle:n,onDismiss:s,onClosed:l})}},226916:(e,t,n)=>{n.d(t,{c:()=>v,t:()=>b});n(16280);var o=()=>n(908006),i=()=>n(388821),a=()=>n(919709),r=()=>n(970330),s=()=>n(669548),l=()=>n(606952),d=()=>n(317909),c=()=>n(62287),u=()=>n(389658),p=()=>n(972435),m=()=>n(129522),g=()=>n(351360),f=()=>n(508496),h=()=>n(75368);const y=(0,n(959013).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function v(e){var t,n,a;const{environment:d,store:p,viewType:y,transaction:v}=e,b=null===(t=p.getBlockTitleStore())||void 0===t?void 0:t.getValue();f().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&h().A.state.open&&h().A.setState({open:!1});const x=p.getSpaceId()??(null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id)??(null===(a=g().default.state.mainEditorCurrentBlockStore)||void 0===a?void 0:a.getSpaceId()),S=x?d.idCreator.getSpaceIdCreatorSync(x):void 0;s().j({environment:d,sourceBlockId:"root",targetBlockPointer:p.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().qP)({isInline:!1,viewType:y})),targetRecordCache:p.inMemoryRecordCache,transaction:v,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:d,block:p,blockType:"collection_view_page",transaction:v}),b&&l().KY({environment:d,store:p.getBlockTitleStore(),value:b,transaction:v}),o().default.afterNextFlush((()=>{const e=m().K.findCollectionViewBlockFromStore(p);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))})),r().v(d,{from:"template_picker",type:"collection_view_page",creating_block_id:p.id,is_full_screen:!0,view_type:y})}async function b(e){var t,o,l;const{environment:m,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:v}=await Promise.resolve().then(n.bind(n,339034)),{formEditorActions:b}=await v.load(),x=f.getSpaceId()??(null===(o=g().default.state.currentSpaceStore)||void 0===o?void 0:o.id)??(null===(l=g().default.state.mainEditorCurrentBlockStore)||void 0===l?void 0:l.getSpaceId()),S=x?m.idCreator.getSpaceIdCreatorSync(x):void 0;d().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:m,canUndo:!0,perform:e=>{var t;s().j({environment:m,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().mT)({isInline:!1,name:(0,a().w9s)(h)?(0,a().x9d)(p().A.formatMessage(y.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:m,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStore(),o=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema(),l=f;if(!o)throw new Error("Schema not found");const d=b.createCollectionFormEditorView({environment:m,transaction:e,collectionViewBlockStore:l,schema:o,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:m,transaction:e,collectionViewBlockStore:l,schema:o}),r().v(m,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==d?void 0:d.formId,view_id:l.id})}})}},233842:(e,t,n)=>{n.d(t,{u:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("notionCalendarLogo",{viewBox:"0 0 20 21",svg:(0,o.jsxs)("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_970_53429)",children:[(0,o.jsx)("path",{d:"M2.17141 17.1924C1.81019 17.1884 1.48919 17.0958 1.23979 16.8633C1.23979 16.8633 1.23899 16.8633 1.23819 16.8617C1.20922 16.8336 1.18187 16.8046 1.15613 16.7756C0.959022 16.5504 0.852023 16.2615 0.852023 15.9494L0.849609 3.0915C0.849609 2.34732 1.47712 1.67957 2.21968 1.63371L15.0636 0.838839C15.0918 0.83723 15.1191 0.836426 15.1473 0.836426C15.4683 0.836426 15.7675 0.952277 15.996 1.16789C16.0274 1.19766 16.0572 1.22823 16.0845 1.26041C16.1585 1.34488 16.2197 1.43821 16.268 1.53877C16.2205 1.43901 16.1585 1.34569 16.0845 1.26121C16.2768 1.48487 16.3822 1.76967 16.3822 2.07861V2.40766C16.3822 2.40766 16.3902 2.67717 16.1231 2.69487L16.1247 2.69648L4.3114 3.43664C3.44494 3.49055 2.741 4.24117 2.741 5.10925C2.741 5.10925 2.73617 16.9768 2.73537 16.9961C2.72652 17.1924 2.56481 17.1924 2.43127 17.1924H2.17141Z",fill:"black"}),(0,o.jsx)("path",{d:"M19.1589 18.1882C19.1589 18.2075 19.1573 18.2269 19.1556 18.2462C19.1275 18.6589 18.7984 19.0225 18.3938 19.0973C18.3857 19.0973 18.3777 19.0998 18.3696 19.0998L4.66812 19.9292H4.62548C4.35758 19.9155 4.10979 19.8126 3.91671 19.6307C3.7003 19.4272 3.57882 19.1488 3.56997 18.8439C3.56997 18.8319 3.56836 18.8198 3.56836 18.8069V5.19278C3.56836 5.17347 3.56836 5.15497 3.56997 5.13566C3.59974 4.6988 3.96498 4.31746 4.40102 4.2724C4.41229 4.2724 4.42355 4.26919 4.43481 4.26838L17.5531 3.44616L18.1436 3.40915C18.1653 3.40754 18.187 3.40674 18.2087 3.40674C18.4557 3.40674 18.6858 3.49604 18.862 3.66097C18.9851 3.77601 19.072 3.92002 19.1186 4.08012C19.1388 4.14851 19.1508 4.22011 19.1556 4.29332V13.1785L19.1589 18.1874V18.1882Z",fill:"black"}),(0,o.jsx)("path",{d:"M20.001 4.36907C20.001 3.86302 19.8023 3.3972 19.4402 3.0577C19.0782 2.71819 18.6011 2.54763 18.0967 2.57981L17.3928 2.62245C17.2166 2.62808 17.2246 2.49212 17.2246 2.49212V2.08583C17.2246 1.49692 16.9929 0.955478 16.5722 0.560458C16.1514 0.165437 15.5955 -0.0324757 15.009 0.00372785L2.16349 0.798596C0.97121 0.872612 0.000976562 1.90482 0.000976562 3.09953L0.00339008 15.9574C0.00339008 16.5455 0.235088 17.0878 0.655844 17.4836C1.04442 17.8488 1.54724 18.0468 2.08465 18.0468C2.12889 18.0468 2.55448 18.0387 2.55448 18.0387C2.70975 18.0387 2.73549 18.1103 2.73549 18.2439V18.9012C2.73549 19.4289 2.94547 19.9157 3.32278 20.2705C3.67113 20.5979 4.12246 20.7749 4.60436 20.7749C4.62366 20.7749 4.64217 20.7733 4.66148 20.7733C4.67113 20.7733 4.67998 20.7749 4.68963 20.7749C4.73147 20.7749 4.7733 20.7733 4.81594 20.7709L18.3477 19.9519C18.4081 19.9478 18.4668 19.9406 18.5255 19.931C19.3461 19.8304 19.9994 19.1071 19.9994 18.2728L19.9978 18.2648C19.9978 18.2415 20.001 18.2181 20.001 18.1948V4.36907ZM2.17153 17.1996C1.81031 17.1956 1.48931 17.1031 1.23991 16.8705C1.23991 16.8705 1.23911 16.8705 1.23831 16.8689C1.20934 16.8408 1.18199 16.8118 1.15625 16.7829C0.959142 16.5576 0.852143 16.2688 0.852143 15.9566L0.84973 3.09873C0.84973 2.35454 1.47724 1.68679 2.2198 1.64093L15.0637 0.846063C15.0919 0.844454 15.1192 0.84365 15.1474 0.84365C15.4684 0.84365 15.7677 0.959501 15.9961 1.17511C16.0275 1.20488 16.0573 1.23545 16.0846 1.26763C16.1587 1.35211 16.2198 1.44543 16.2681 1.546C16.2206 1.44624 16.1587 1.35291 16.0846 1.26844C16.2769 1.49209 16.3823 1.7769 16.3823 2.08583V2.41488C16.3823 2.41488 16.3904 2.6844 16.1233 2.7021L16.1249 2.70371L4.31152 3.44387C3.44506 3.49777 2.74112 4.24839 2.74112 5.11647C2.74112 5.11647 2.73629 16.984 2.73549 17.0033C2.72664 17.1996 2.56493 17.1996 2.43139 17.1996H2.17153ZM19.1635 18.1948C19.1635 18.2141 19.1619 18.2334 19.1603 18.2527C19.1321 18.6654 18.8031 19.0291 18.3984 19.1039C18.3904 19.1039 18.3823 19.1063 18.3743 19.1063L4.67274 19.9358H4.6301C4.3622 19.9221 4.11441 19.8191 3.92133 19.6373C3.70492 19.4338 3.58344 19.1554 3.57459 18.8505C3.57459 18.8384 3.57298 18.8263 3.57298 18.8135V5.19934C3.57298 5.18003 3.57298 5.16152 3.57459 5.14221C3.60436 4.70536 3.9696 4.32402 4.40564 4.27896C4.41691 4.27896 4.42817 4.27574 4.43943 4.27494L17.5577 3.45272L18.1482 3.41571C18.1699 3.4141 18.1916 3.4133 18.2134 3.4133C18.4603 3.4133 18.6904 3.5026 18.8666 3.66752C18.9897 3.78257 19.0766 3.92658 19.1233 4.08668C19.1434 4.15507 19.1554 4.22667 19.1603 4.29988V13.185L19.1635 18.194V18.1948Z",fill:"white"}),(0,o.jsx)("path",{d:"M17.1877 17.7582L5.7163 18.426C5.24727 18.459 4.83215 18.2997 4.84502 17.685V8.11764C4.84502 7.7894 5.11533 7.57942 5.4138 7.56413L17.3398 6.84891C17.6375 6.83362 17.8812 7.04924 17.8812 7.34771V16.932C17.8812 17.2828 17.7935 17.7341 17.1901 17.7574H17.1885L17.1877 17.7582Z",fill:"white"}),(0,o.jsx)("path",{d:"M8.39759 10.4651C7.83685 10.4997 7.64699 10.9277 7.64779 11.5858V11.7016C7.58102 11.7177 7.5247 11.7322 7.45712 11.7362C7.05326 11.7612 6.76203 11.4329 6.76123 10.844C6.76042 9.94293 7.56654 9.09577 9.10234 9.00003C10.47 8.91475 11.3453 9.57607 11.3469 10.7426C11.3469 11.6204 10.6196 12.2439 9.90282 12.4386C11.248 12.5045 11.8095 13.2551 11.8111 14.2141C11.8127 15.8546 10.614 16.7838 8.76445 16.8988L8.71939 16.9012C7.32921 16.9881 6.35334 16.4596 6.35254 15.5472C6.35254 15.0275 6.73227 14.5882 7.30427 14.552C7.34932 14.5488 7.39357 14.5577 7.43862 14.5553C7.55206 15.4837 8.18037 15.8256 8.80789 15.787C9.41288 15.7492 9.83846 15.3413 9.83846 14.7636V14.7403C9.83766 13.8392 9.08625 13.7942 7.9535 13.7491L7.77329 12.6743C8.8272 12.4812 9.35334 12.1369 9.35254 11.5134C9.35254 10.8432 8.98166 10.4273 8.3984 10.4643H8.39759V10.4651Z",fill:"black"}),(0,o.jsx)("path",{d:"M13.4544 10.0227C12.3338 10.3469 12.0868 9.85373 12.2091 9.33803C12.8816 9.18034 14.6298 8.65579 15.2911 8.41846L15.2992 15.3374L16.5212 15.5152C16.5212 15.9657 16.2638 16.2473 15.8044 16.2762C15.4231 16.2996 14.5373 16.3317 14.1117 16.3583C13.4504 16.3993 12.2396 16.4983 12.2396 16.4983C12.2058 16.4082 12.1946 16.3165 12.1946 16.2352C12.1946 16.0156 12.2839 15.7903 12.5751 15.6913L13.4601 15.4049L13.4536 10.0227H13.4544Z",fill:"black"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_970_53429",children:(0,o.jsx)("rect",{width:"20",height:"20.7752",fill:"white"})})})]})})},236190:(e,t,n)=>{n.d(t,{c:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("minus",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},236228:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(296540),i=()=>n(56366),a=n(474848);const r=function(e){const{disabled:t,type:r,tooltipLabel:s,children:l,style:d,onClick:c}=e,u=(0,n(484714).v3)(),p=(0,o.useCallback)((e=>{r!==n(919709).Ifu.TemporarySuggestionUnderline&&(n(482287).po({environment:u,annotation:[r]}),c&&c(),(0,n(21869).s)(u,{action:r}))}),[u,r,c]),m=(0,i().K8)((()=>t||"editing"!==n(24157).default.state.mode),[t]),g=(0,i().K8)((()=>Boolean((0,n(792002).B1)(r))),[r]),f=(0,n(401497).IS)((e=>({button:{display:"flex",alignItems:"center",fill:g?e.icon.uiBluePrimary:e.icon.primary,borderRadius:6,height:28,width:28,padding:6,...d}})),[g,d]);return(0,a.jsx)(n(859428).A,{renderTooltip:()=>s,render:e=>(0,a.jsx)(n(704152).A,{style:f.button,disabled:m,disabledFeedback:m,onClick:p,...e,children:l})})}},237829:(e,t,n)=>{n.d(t,{X:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})})},241504:(e,t,n)=>{n.r(t),n.d(t,{default:()=>je});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(604995),l=()=>n(416504),d=()=>n(959013),c=()=>n(722872),u=()=>n(691298),p=()=>n(117586),m=()=>n(594739),g=()=>n(805751),f=()=>n(928600),h=()=>n(89924),y=()=>n(244641),v=()=>n(595555),b=()=>n(662303),x=()=>n(597777),S=()=>n(100622),M=()=>n(534177),A=()=>n(284371),C=()=>n(541181),w=()=>n(807778),j=()=>n(704152),k=()=>n(493823),I=()=>n(498140),T=()=>n(971404),P=()=>n(886680);const _=Object.freeze({backgroundColor:S().Ay.blue,color:S().Ay.white}),B=Object.freeze({backgroundColor:S().Ay.blueWithAlpha(.43)});function L(e,t){switch(e){case p().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case p().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case p().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function R(e,t,n){return void 0===e||"relative"===e||"ll"===e?x().WA(U(n,t)):x().c1(e)}function D(e,t){return e&&(e!==x().jk||t)?x().B4(e):x()._g}function O(){return(0,T().X)(b().locale).time}function N(e,t,n){return(0,I().FM)(e,D(t,!1),n)}function E(e,t,n,o,i){return o.device.isMobile?(0,I().yc)(e,s().tr,t):(0,I().yc)(e,R(n,t,i),t)}function F(e,t,n,o){return!e||"number"==typeof e&&isNaN(e)?t&&(0,P().NN)(t)?function(e,t){var n,o;const i=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,a=(null==t||null===(o=t.getPropertyTypeSpecificConfig("date"))||void 0===o?void 0:o.includeTime)??!1,r=s().vF({timezone:(0,l().P)()});if(i&&a)return s().NC(r.startOf("day").valueOf(),r.startOf("day").valueOf(),(0,l().P)());if(i)return s().Mk(r.valueOf(),r.valueOf(),(0,l().P)());if(a)return s().Xo(r.startOf("day"));return e}(n,o):n:e}function U(e,t){return e||t.locale}function V(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,M().HB)(e)}var K=n(474848);function z(e){let{store:t,dateValue:n,disabled:c,firstDayOfWeek:u,onChangeValue:m}=e;const g=(0,i().v3)(),f=(0,a().K8)((()=>(0,w().D$)(g)),[g]),{focus:h,currentMonth:I}=(0,a().K8)((()=>({focus:t.state.focus,currentMonth:t.state.currentMonth})),[t]),T=(0,r().IS)((e=>({todayButton:{width:43,height:20},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:S().Ay.uiGray}})),[]),P=s().AA(n,(0,l().P)()),L=I||P.start,R=P.start.toJSDate(),D=h===p().xQ.StartDate||h===p().xQ.StartTime,O=(0,o.useCallback)(((e,o,i)=>{if(c)return;const a=y().c9.fromJSDate(e).setLocale(x().M5).toFormat(s().tr);if(i.shiftKey&&("date"===n.type||"datetime"===n.type)){const e=V(n,a);return null==m||m(e),void t.setState({...t.state,focus:p().xQ.EndDate})}let r;if(x().oM(n)||x().L3(n)){h===p().xQ.StartDate||h===p().xQ.StartTime?r={...n,start_date:a}:h===p().xQ.EndDate||h===p().xQ.EndTime?r={...n,end_date:a}:(0,M().HB)(h);const e=s().AA(r,(0,l().P)());e.end<e.start&&(x().oM(r)?r={...r,start_date:r.end_date,end_date:r.start_date}:x().L3(r)?r={...r,start_date:r.end_date,start_time:r.end_time,end_date:r.start_date,end_time:r.start_time}:(0,M().HB)(r),t.setState({...t.state,focus:h===p().xQ.StartDate||h===p().xQ.StartTime?p().xQ.EndDate:p().xQ.StartDate})),t.setState({...t.state,focus:h===p().xQ.StartDate||h===p().xQ.StartTime?p().xQ.EndDate:p().xQ.StartDate})}else r={...n,start_date:a};t.setState({...t.state,error:{...t.state.error,[h]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[h]:void 0}}),null==m||m(r)}),[n,c,h,m,t]),N=(0,o.useCallback)((e=>{t.setState({...t.state,currentMonth:y().c9.fromJSDate(e)})}),[t]),E=(0,o.useMemo)((()=>({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today",description:"Label for the button that selects today's date in the calendar"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month",description:"Aria label for the button that navigates to the previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month",description:"Aria label for the button that navigates to the next month"}})),[]),F=(0,o.useMemo)((()=>{if(P.end){const e=P.end.toJSDate();return{modifiers:{range:{from:R,to:e},...D?{end:e,start:R}:{start:R,end:e}},modifiersStyles:{range:{backgroundColor:S().Ay.blueWithAlpha(.15)},start:D?_:B,end:D?B:_}}}return{selected:R,modifiers:{start:R},modifiersStyles:{start:_}}}),[P.end,R,D]),U=(0,o.useCallback)((e=>(0,K.jsx)("div",{className:"notion-calendar-caption",children:(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,K.jsx)(v().$J,{displayMonth:e.displayMonth}),(0,K.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,K.jsx)(k().p,{onClick:e=>{N(y().c9.now().toJSDate()),O(y().c9.now().toJSDate(),{},e)},isGray:!0,style:{...T.button,...T.todayButton,fontSize:12,fontWeight:A().Wy.medium},children:(0,K.jsx)(d().sA,{...E.todayButtonLabel})}),(0,K.jsx)(j().A,{onClick:()=>N(y().c9.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...T.button,...T.navButtonSize},"aria-label":E.previousMonthLabel.defaultMessage,children:(0,K.jsx)(v().Bu,{style:T.navButton})}),(0,K.jsx)(j().A,{onClick:()=>N(y().c9.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...T.button,...T.navButtonSize},"aria-label":E.nextMonthLabel.defaultMessage,children:(0,K.jsx)(v()._l,{style:T.navButton})})]})]})})),[O,T.button,T.navButtonSize,T.todayButton,T.navButton,N,E.nextMonthLabel,E.previousMonthLabel,E.todayButtonLabel]);return f?(0,K.jsx)(C().n,{className:"notion-date-property-menu notranslate",components:{Caption:U},numberOfMonths:1,weekStartsOn:u,defaultMonth:L.toJSDate(),month:L.toJSDate(),locale:b().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:O,onMonthSelected:N,...F}):(0,K.jsx)(C().n,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:u,defaultMonth:L.toJSDate(),month:L.toJSDate(),locale:b().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:O,onMonthSelected:N,...F})}var W=()=>n(760217);function H(e){let{onChangeValue:t}=e;const n=(0,o.useCallback)((()=>{null==t||t(void 0)}),[t]);return(0,K.jsx)(W().A,{focused:!1,onClick:n,title:(0,K.jsx)(d().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}var G=()=>n(946548);function Y(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("date"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("daterange"===t.type){const e={type:"datetimerange",start_date:t.start_date,start_time:"00:00",end_date:t.end_date,end_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("datetime"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}else{const e={type:"daterange",start_date:t.start_date,end_date:t.end_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}}),[t,n]);return(0,K.jsx)(W().A,{focused:!1,onClick:i,title:(0,K.jsx)(d().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,K.jsx)(G().A,{on:"date"!==t.type&&"daterange"!==t.type,onClick:i})})}function q(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("datetimerange"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:t.start_time,time_zone:t.time_zone,reminder:t.reminder};null==n||n(e)}else if("daterange"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder};null==n||n(e)}else{const e=V(t);null==n||n(e)}}),[t,n]);return(0,K.jsx)(W().A,{focused:!1,onClick:i,title:(0,K.jsx)(d().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,K.jsx)(G().A,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:i})})}n(581454);const Q=(0,d().YK)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function $(e){const{reminder:t,shouldShowTime:n,intl:o,formatTime:i}=e;if(!t)return o.formatMessage(Q.none);if(x().fc(t)){const{unit:e,value:a,time:r}=t,s=i({start_time:r,time_format:"LT",humanReadable:!0,intl:o}),l=n?`(${s})`:"";return 0===a?o.formatMessage(Q.onTheDay,{formattedTimeText:l}):"day"===e?o.formatMessage(Q.daysBefore,{formattedTimeText:l,numberOfDays:a}):"year"===e?o.formatMessage(Q.yearsBefore,{formattedTimeText:l,numberOfYears:a}):"month"===e?o.formatMessage(Q.monthsBefore,{formattedTimeText:l,numberOfMonths:a}):o.formatMessage(Q.weeksBefore,{formattedTimeText:l,numberOfWeeks:a})}{const{unit:e,value:n}=t;return 0===n?o.formatMessage(Q.atTimeOf):"hour"===e?o.formatMessage(Q.hoursBefore,{numberOfHours:n}):o.formatMessage(Q.minutesBefore,{numberOfMinutes:n})}}var Z=()=>n(869190),J=()=>n(599987),X=()=>n(989423);var ee=()=>n(406699),te=()=>n(113474),ne=()=>n(939740);function oe(e){let{dateValue:t,onChangeValue:n}=e;const a=(0,i().v3)(),{device:r}=a,s=(0,d().tz)(),u=(0,o.useCallback)((e=>{e?x().fc(e)?null==n||n({...t,reminder:{...e,defaultTimeZone:(0,l().P)()}}):"datetime"!==t.type&&"datetimerange"!==t.type||null==n||n({...t,reminder:e}):null==n||n({...t,reminder:e}),function(e,t){X().vd(e,"set_reminder",{date:t.date,reminder:t.reminder})}(a,{date:t,reminder:e})}),[t,a,n]),p=(0,o.useCallback)((e=>(0,K.jsx)(te()._,{...e,icon:(0,J().P)({width:14}),title:(0,K.jsx)(d().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:r.isMobile,right:$({reminder:t.reminder,intl:s,formatTime:Z().fU})})),[t.reminder,r.isMobile,s]),m=(0,o.useCallback)((e=>{let n;n=r.isMobile?{menuType:c().gu.Modal,title:(0,K.jsx)(d().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,K.jsx)(d().sA,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:e.close}:{menuType:c().gu.Popup,width:250};const o=("date"===t.type||"daterange"===t.type?x().vK:x().SA).map((t=>{const n=$({reminder:t,shouldShowTime:!0,intl:s,formatTime:Z().fU});return{key:n,action:()=>{u(t),e.close()},render:e=>(0,K.jsx)(W().A,{...e,title:n})}}));return(0,K.jsx)(f().A,{...n,children:(0,K.jsx)(ne().Ay,{type:ne().Oh.Vertical,sections:[{key:"reminder section",render:e=>(0,K.jsx)(h().A,{...e}),items:o}],initialFocus:void 0})})}),[t.type,r.isMobile,s,u]);return(0,K.jsx)(ee().Ay,{popupType:r.isMobile?ee().z7.SlideUp:ee().z7.Popup,placementToOrigin:ee().sx.Right,renderOrigin:p,render:m})}function ie(e){let{dateValue:t,shouldShowReminder:n,shouldShowEndDateControl:o,shouldShowAllDayControl:a,onChangeValue:r}=e;return(0,i().Y0)().isMobile?n||o||a?(0,K.jsxs)(h().A,{topBorder:!0,children:[n&&(0,K.jsx)(oe,{dateValue:t,onChangeValue:r}),o&&(0,K.jsx)(q,{dateValue:t,onChangeValue:r}),a&&(0,K.jsx)(Y,{dateValue:t,onChangeValue:r})]}):null:(0,K.jsxs)(K.Fragment,{children:[n&&(0,K.jsx)(h().A,{topBorder:!0,children:(0,K.jsx)(oe,{dateValue:t,onChangeValue:r})}),(o||a)&&(0,K.jsxs)(h().A,{topBorder:!0,children:[o&&(0,K.jsx)(q,{dateValue:t,onChangeValue:r}),a&&(0,K.jsx)(Y,{dateValue:t,onChangeValue:r})]})]})}var ae=()=>n(304422),re=()=>n(933117);function se(e){let{dateFormat:t,onChangeDateFormat:n}=e;const i=(0,d().tz)(),a=t||x().vz,r=(0,o.useCallback)((e=>e),[]),s=(0,o.useCallback)((e=>{null==n||n(e)}),[n]),l=(0,o.useCallback)((e=>(0,K.jsx)(W().A,{...e,title:i.formatMessage(x().xz[e.value])})),[i]),c=(0,o.useCallback)((e=>(0,K.jsx)(te()._,{...e,focused:!1,title:(0,K.jsx)(d().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:a?i.formatMessage(x().xz[a]):(0,K.jsx)(d().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[a,i]),u=(0,o.useMemo)((()=>({menuTitle:i.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:x().wJ,getKey:r,selectedItem:a,onSelect:s,renderItem:l,renderOrigin:c})),[a,r,i,s,l,c]);return(0,K.jsx)(re().A,{...u})}function le(e){let{dateValue:t,timeFormat:n,onChangeTimeFormat:i}=e;const a=(0,d().tz)(),r="date"===t.type||"daterange"===t.type,s=D(n,!0),l=function(e){const t=D(e,!0),n=O();for(const o in n)if(n[o]===t)return o;return"12h"}(n),c=O(),u=(0,o.useCallback)((e=>e),[]),p=(0,o.useCallback)((e=>{const t=c[e];null==i||i(t)}),[i,c]),m=(0,o.useCallback)((e=>(0,K.jsx)(W().A,{...e,title:a.formatMessage(x().px[e.value])})),[a]),g=(0,o.useCallback)((e=>(0,K.jsx)(te()._,{...e,focused:!1,title:(0,K.jsx)(d().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:r,right:!r&&(s?a.formatMessage(x().px[l]):(0,K.jsx)(d().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[a,r,l,s]),f=(0,o.useMemo)((()=>({menuTitle:a.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:x().ZD,selectedItem:l,disabled:r,getKey:u,onSelect:p,renderItem:m,renderOrigin:g})),[u,a,r,p,m,g,l]);return(0,K.jsx)(re().A,{...f})}function de(e){const{dateValue:t,dateFormat:n,timeFormat:a,onChangeDateFormat:r,onChangeTimeFormat:u,onChangeValue:p}=e,m=(0,i().Y0)(),g=!T().V.includes(b().locale),y="date"===t.type||"daterange"===t.type,v="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().P)(),x=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const n={...t,time_zone:e};null==p||p(n)}}),[t,p]);return(0,K.jsxs)(K.Fragment,{children:[!y&&(0,K.jsx)(ae().G,{enableRecents:!0,placementToOrigin:ee().sx.Right,currentValue:v,onSelect:x,renderOrigin:e=>(0,K.jsx)(te()._,{...e,title:(0,K.jsx)(d().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!y&&s().GF(v),chevronType:"right"})}),(0,K.jsx)(ee().Ay,{popupType:m.isMobile?ee().z7.SlideUp:ee().z7.Popup,placementToOrigin:ee().sx.Right,renderOrigin:e=>(0,K.jsx)(W().A,{...e,title:(0,K.jsx)(d().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.label"}),focused:!1,showExtensionArrow:!0}),render:e=>{let o;return o=m.isMobile?{menuType:c().gu.Modal,title:(0,K.jsx)(d().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.title"}),right:(0,K.jsx)(d().sA,{defaultMessage:"Done",id:"datePropertyMenuFormatAndTimezone.dateFormat.doneButton"}),onClickRight:e.close}:{menuType:c().gu.Popup,width:250},(0,K.jsx)(f().A,{...o,children:(0,K.jsxs)(h().A,{children:[(0,K.jsx)(se,{dateFormat:n,onChangeDateFormat:r}),g&&(0,K.jsx)(le,{dateValue:t,timeFormat:a,onChangeTimeFormat:u})]})})}})]})}var ce=()=>n(720665),ue=()=>n(962730),pe=()=>n(623580),me=()=>n(859428);const ge=12;function fe(e){let{store:t,disabled:n,locale:c,format:u,dateFormat:m,timeFormat:g,dateValue:f,formQuestionStore:h,onChangeValue:y}=e;const v=(0,i().v3)(),{device:b,WindowSizeStore:S}=v,A=(0,d().tz)(),{focus:C,inputTemporaryValue:w,error:j}=(0,a().K8)((()=>({focus:t.state.focus,inputTemporaryValue:t.state.inputTemporaryValue,error:t.state.error})),[t]),{formQuestionHasEndDate:k,formQuestionIncludesTime:I}=(0,a().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==h||null===(e=h.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==h||null===(t=h.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[h]),T=(0,o.useMemo)((()=>s().AA(f,(0,l().P)(),U(c,A))),[f,c,A]),_=u&&(0,P().NN)(u)?I:"datetime"===f.type||"datetimerange"===f.type,B=u&&(0,P().NN)(u)?k:"daterange"===f.type||"datetimerange"===f.type,L=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startDate;if(!e)return;const n=E(e,A,m,v,c);if(!n)return p().dz.InvalidDate;const o={...f,start_date:n},i=s().Dz(o);if(!i)return p().dz.InvalidRange;t.setState({...t.state,currentMonth:i.start,error:{...t.state.error,[p().xQ.StartDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[p().xQ.StartDate]:void 0}}),null==y||y(o)}),[m,f,v,A,c,y,t]),R=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startTime;if(!e)return;const n=N(e,g,A);if(!n)return p().dz.InvalidTime;if(x().L3(f)){const{newDate:e,currentMonth:o}=s().uj({previous:f,updatedStartTime:n});t.setState({...t.state,currentMonth:o,error:{...t.state.error,[p().xQ.StartTime]:void 0,[p().xQ.EndDate]:void 0,[p().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[p().xQ.StartTime]:void 0}}),null==y||y(e)}else{if(!x().Ar(f))return p().dz.InvalidTime;{const e={...f,start_time:n},o=s().Dz(e);t.setState({...t.state,currentMonth:o.start,error:{...t.state.error,[p().xQ.StartTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[p().xQ.StartTime]:void 0}}),null==y||y(e)}}}),[f,A,y,t,g]),D=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endDate;if(!e)return;const n=E(e,A,m,v,c);if(!n)return p().dz.InvalidDate;if(!x().oM(f)&&!x().L3(f))return;const o={...f,end_date:n},i=s().Dz(o);if(!i)return p().dz.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[p().xQ.EndDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[p().xQ.EndDate]:void 0}}),null==y||y(o)}),[m,f,v,A,c,y,t]),O=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endTime;if(!e)return;const n=N(e,g,A);if(!n)return p().dz.InvalidTime;if(!x().L3(f))return;const o={...f,end_time:n},i=s().Dz(o);if(!i)return p().dz.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[p().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[p().xQ.EndTime]:void 0}}),null==y||y(o)}),[f,A,y,t,g]),F=(0,o.useCallback)((()=>{t.setState({...t.state,focus:p().xQ.StartDate,inputIsFocused:!0,currentMonth:T.start})}),[T.start,t]),V=(0,o.useCallback)((()=>{t.setState({...t.state,focus:p().xQ.StartTime,inputIsFocused:!0,currentMonth:T.start})}),[T.start,t]),z=(0,o.useCallback)((()=>{T.end&&t.setState({...t.state,focus:p().xQ.EndDate,inputIsFocused:!0,currentMonth:T.end})}),[T.end,t]),W=(0,o.useCallback)((()=>{T.end&&t.setState({...t.state,focus:p().xQ.EndTime,inputIsFocused:!0,currentMonth:T.end})}),[T.end,t]),H=(0,o.useCallback)((()=>{let e;if(t.state.focus===p().xQ.StartDate)e=L();else if(t.state.focus===p().xQ.StartTime)e=R();else if(t.state.focus===p().xQ.EndDate)e=D();else{if(t.state.focus!==p().xQ.EndTime)return(0,M().HB)(t.state.focus);e=O()}e?t.setState({...t.state,error:{...t.state.error,[t.state.focus]:e}}):t.setState({...t.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[D,O,L,R,t]),G=(0,o.useCallback)((e=>{t.setState({...t.state,inputTemporaryValue:{...t.state.inputTemporaryValue,[t.state.focus]:e.target.value||""}}),b.isAndroid&&H()}),[b.isAndroid,H,t]),[Y,q]=(0,a().K8)((()=>[b.isMobile?S.getSafePaddingLeftCSS(16):14,b.isMobile?S.getSafePaddingRightCSS(16):14]),[b.isMobile,S]),Q=(0,r().IS)((e=>({container:{paddingTop:b.isMobile?16:8,paddingBottom:b.isMobile?16:8,paddingLeft:Y,paddingRight:q,display:_?"block":"flex",...b.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:b.isMobile?e.popoverBackground:void 0}})),[b.isMobile,Y,q,_]);return(0,K.jsxs)("div",{style:Q.container,children:[(0,K.jsx)(he,{inputDateValue:w.startDate,inputTimeValue:w.startTime,rangeValue:T.start,disabled:n,dateError:j.startDate,timeError:j.startTime,isDateFocused:C===p().xQ.StartDate,isTimeFocused:C===p().xQ.StartTime,hasTime:_,hasEndDate:B,locale:c,dateFormat:m,timeFormat:g,onChange:G,onDateFocus:F,onTimeFocus:V,onBlur:H,onSubmit:H}),B&&(0,K.jsx)("div",{style:{width:12,height:8}}),T.end&&(0,K.jsx)(he,{inputDateValue:w.endDate,inputTimeValue:w.endTime,rangeValue:T.end,disabled:n,dateError:j.endDate,timeError:j.endTime,isDateFocused:C===p().xQ.EndDate,isTimeFocused:C===p().xQ.EndTime,hasTime:_,hasEndDate:B,locale:c,dateFormat:m,timeFormat:g,onChange:G,onDateFocus:z,onTimeFocus:W,onBlur:H,onSubmit:H})]})}function he(e){let{inputDateValue:t,inputTimeValue:n,rangeValue:a,disabled:l,dateError:c,timeError:u,isDateFocused:p,isTimeFocused:m,hasTime:g,hasEndDate:f,locale:h,dateFormat:y,timeFormat:v,onChange:b,onDateFocus:S,onTimeFocus:A,onBlur:C,onSubmit:w}=e;const j=(0,i().Y0)(),k=(0,d().tz)(),I=(0,M().O9)(c)||(0,M().O9)(u),T=p||m,P=(0,r().IS)((e=>({input:ye(j,e,I,T,f),separator:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})),[j,I,T,f]),_=(0,o.useCallback)((()=>L(c,k)),[c,k]),B=(0,o.useCallback)((()=>L(u,k)),[u,k]),O=(0,o.useCallback)((()=>{if(j.isMobile){const e=(0,ce().pN)(t)?a.toFormat(s().tr):t;return(0,K.jsx)(pe().A,{type:"date",format:pe().C.Transparent,value:e,onChange:b,onFocus:S,onBlur:C,onSubmit:w,disabled:l,size:1})}{const e=(0,ce().pN)(t)?a.toFormat(R(y,k,h)):t;return(0,K.jsx)(pe().A,{selectAll:!0,format:pe().C.Transparent,value:e,focusInitial:p,onChange:b,onFocus:S,onBlur:C,onSubmit:w,disabled:l,size:1})}}),[y,j.isMobile,l,C,b,S,w,t,k,p,h,a]),N=(0,o.useCallback)((()=>{if(j.isMobile){const e=(0,ce().pN)(n)?a.toFormat(x().GE):n;return(0,K.jsx)(pe().A,{type:"time",format:pe().C.Transparent,value:e,onChange:b,onFocus:A,onBlur:C,onSubmit:w,size:1,disabled:l})}{const e=(0,ce().pN)(n)?a.toFormat(D(v,!1)):n;return(0,K.jsx)(pe().A,{format:pe().C.Transparent,value:e,focusInitial:m,onChange:b,onFocus:A,onBlur:C,onSubmit:w,size:1,disabled:l})}}),[j.isMobile,l,C,b,w,A,n,m,a,v]);return(0,K.jsxs)("div",{style:P.input,children:[(0,K.jsx)(me().A,{renderTooltip:_,originGap:ge,forceVisibleState:(0,M().O9)(c),placement:ue().W.Left,render:O}),g&&(0,K.jsx)("div",{style:P.separator}),g&&(0,K.jsx)(me().A,{renderTooltip:B,originGap:ge,forceVisibleState:(0,M().O9)(u),placement:ue().W.Right,render:N})]})}function ye(e,t,n,o,i){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingLeft:8,paddingRight:8,flexBasis:"50%",flexGrow:1,fontSize:e.isMobile?16:14,...n?{background:S().Ay.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${S().Ay.red}`}:o&&i?{background:S().Ay.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${S().Ay.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var ve=()=>n(836251),be=()=>n(962036),xe=()=>n(64901);function Se(){return(0,i().Y0)().isMobile?(0,K.jsx)(xe().A,{href:(0,ve().xS)("guides.reminders"),analyticsFrom:"date_selector"}):(0,K.jsx)(be().A,{title:(0,K.jsx)(d().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,ve().xS)("guides.reminders"),analyticsFrom:"date_selector"})}var Me=()=>n(173979),Ae=()=>n(422464);function Ce(e){const{onChangeValue:t}=e,n=(0,d().tz)();return(0,K.jsx)(h().A,{title:(0,K.jsx)(d().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,K.jsx)(W().A,{title:(0,K.jsx)(Ae().W,{templateVariableType:e}),caption:(0,Me().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}function we(e){let{store:t,value:n,header:u,isTemplatePage:p,shouldShowReminder:g,shouldShowAllDayControl:y=!0,shouldShowEndDateControl:v=!0,shouldShowDateFormatControl:b=!0,canConfigureCollection:x,disabled:S,format:M,dateFormat:A,timeFormat:C,firstDayOfWeek:w,locale:j,formQuestionStore:k,onChangeValue:I,onChangeDateFormat:T,onChangeTimeFormat:P,onDismiss:_}=e;const B=(0,i().Y0)(),L=(0,o.useMemo)((()=>s().Ec((0,l().P)())),[]),R=(0,a().K8)((()=>F(n,M,L,k)),[n,M,L,k]),D=(0,a().K8)((()=>t.state.inputIsFocused),[t]),O=(0,r().IS)((e=>({calendar:{padding:B.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...B.isMobile&&{borderBottom:`1px solid ${e.regularDividerColor}`,background:e.popoverBackground}}})),[B.isMobile]),N=(0,o.useMemo)((()=>B.isMobile?{menuType:c().gu.Modal,title:(0,K.jsx)(d().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,K.jsx)(d().sA,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:g?(0,K.jsx)(Se,{}):void 0,onClickRight:_,header:(0,K.jsx)(fe,{store:t,disabled:S,locale:j,format:M,dateFormat:A,timeFormat:C,dateValue:R,formQuestionStore:k,onChangeValue:I})}:{menuType:c().gu.Popup,maxHeight:"none",width:270,header:u}),[B.isMobile,u,g,_,t,S,j,M,A,C,R,k,I]);return(0,K.jsxs)(f().A,{...N,children:[(0,K.jsx)(m().A,{show:D}),p&&(0,K.jsx)(Ce,{onChangeValue:I}),(0,K.jsxs)(h().A,{topBorder:!0,children:[!B.isMobile&&(0,K.jsx)(fe,{store:t,disabled:S,locale:j,format:M,dateFormat:A,timeFormat:C,dateValue:R,formQuestionStore:k,onChangeValue:I}),(0,K.jsx)("div",{style:O.calendar,children:(0,K.jsx)(z,{store:t,dateValue:R,firstDayOfWeek:w,disabled:S,onChangeValue:I})})]}),!S&&(0,K.jsx)(ie,{dateValue:R,shouldShowReminder:g,shouldShowEndDateControl:v,shouldShowAllDayControl:y,onChangeValue:I}),!S&&x&&b&&(0,K.jsx)(h().A,{topBorder:!0,children:(0,K.jsx)(de,{dateValue:R,dateFormat:A,timeFormat:C,onChangeDateFormat:T,onChangeTimeFormat:P,onChangeValue:I})}),!S&&(0,K.jsx)(h().A,{topBorder:!0,children:(0,K.jsx)(H,{onChangeValue:I})}),!S&&!B.isMobile&&g&&(0,K.jsx)(h().A,{topBorder:!0,children:(0,K.jsx)(Se,{})})]})}function je(e){const t=(0,a().uB)(void 0,p().Ay),n=(0,a().K8)((()=>t.state.inputIsFocused),[t]);return(0,u().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,K.jsx)(g().A,{debugName:"DatePropertyMenu",capture:n,allowEsc:!0,children:(0,K.jsx)(g().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,K.jsx)(we,{store:t,...e})})})}},271459:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>C});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(66913),l=()=>n(880922),d=()=>n(959013),c=()=>n(473227),u=()=>n(755199),p=()=>n(614415),m=()=>n(745766),g=()=>n(645873),f=()=>n(737230),h=()=>n(962730),y=()=>n(351360),v=()=>n(948914),b=()=>n(704152),x=()=>n(953006),S=n(474848);const M=(0,d().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function A(e){let{store:t,isVisible:n,compact:u,framerMotion:p}=e;const g=(0,i().v3)(),h=(0,d().tz)(),y=(0,a().K8)((()=>Boolean(v().A.state.isShowingTabBar)),[]),x=(0,a().K8)((()=>f().Ay.state.expanded),[]),A=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:0,height:28,background:e.accentColors.uiBlue[100],...(0,m().g)({noDrag:g.device.isElectron&&!y})},hoveredButton:{background:e.accentColors.uiBlue[200]},pressedButton:{background:e.accentColors.uiBlue[300]},suggestionIcon:{height:18,width:18,marginLeft:9,marginRight:7},text:{fontSize:14,lineHeight:1.428,marginRight:7},closeIcon:{height:14,width:14,fill:e.text.uiBlueSecondary,marginRight:9}})),[g.device.isElectron,y]),C=(0,o.useCallback)((()=>{c().PD({environment:g,navigableBlockStore:t,mode:"default",location:"stop_suggest_pill"})}),[g,t]),j=(0,o.useRef)(null),{AnimatePresence:k,motion:I}=p;return(0,S.jsx)(k,{children:n&&(0,S.jsxs)(I.div,{ref:j,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,S.jsxs)(b().A,{style:A.button,hoveredStyle:A.hoveredButton,pressedStyle:A.pressedButton,onClick:C,ariaLabel:h.formatMessage(M.stopSuggestRole),children:[(0,l().A)(A.suggestionIcon),(0,S.jsx)(k,{initial:x,children:!u&&!x&&(0,S.jsx)(I.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:A.text,children:(0,S.jsx)(d().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,s().V)(A.closeIcon)]},"button"),!u&&!x&&(0,S.jsx)(w,{store:t,origin:j})]})})}function C(e){const{value:t}=(0,g().fJ)(p().fM);return t?(0,S.jsx)(A,{...e,framerMotion:t}):null}function w(e){const{store:t,origin:n}=e,r=(0,d().tz)(),s=(0,i().v3)(),l=(0,a().K8)((()=>t.isCommentOnly()),[t]),c=(0,a().K8)((()=>{var e;return null===(e=y().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),p=l||!c,[m,g]=(0,o.useState)(p);return m?(0,S.jsx)(x().k,{origin:n,alignmentToOrigin:h().C.Center,placementToOrigin:"bottom",header:(0,S.jsx)(S.Fragment,{children:r.formatMessage(M.tooltip)}),content:l?r.formatMessage(M.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),u().eO({environment:s,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},273321:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(296540),i=()=>n(790748),a=()=>n(56366),r=()=>n(401497),s=()=>n(713998),l=()=>n(797809),d=()=>n(959013),c=()=>n(284371),u=()=>n(175499),p=()=>n(678553),m=()=>n(125565),g=()=>n(862292),f=()=>n(186445),h=()=>n(972435),y=()=>n(480289),v=()=>n(351360),b=()=>n(441467),x=()=>n(848565),S=()=>n(493319),M=()=>n(555776),A=()=>n(116008),C=()=>n(811879),w=()=>n(846583),j=()=>n(898495),k=()=>n(105157),I=n(474848);function T(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:T,shouldShowBottomDividerLine:P,shouldExpandDiscussionWidth:_,noBackgroundColors:B,onMouseEnter:L,onMouseLeave:R,onFocus:D,onBlur:O}=e,N=(0,a().K8)((()=>v().default.state.mainEditorCurrentBlockStore),[]),E=(0,a().K8)((()=>(0,f()._m)(t)),[t]),F=x().eQ,U=(0,a().K8)((()=>M().A.state.isActivelyComposing),[]),V=(0,a().K8)((()=>M().A.state.isHovered),[]),K=(0,o.useCallback)((()=>{null==L||L()}),[L]),z=(0,o.useCallback)((()=>{null==R||R()}),[R]),W=(0,o.useCallback)((()=>{null==D||D()}),[D]),H=(0,o.useCallback)((()=>{A().A.hasContent()?M().A.resetAllActiveSources():(A().A.reset(),M().A.reset()),null==O||O()}),[O]),G=(0,d().tz)(),Y=(0,o.useRef)(null);(0,i().b)(y().A,(()=>({getNode:()=>Y.current})),[]);const q=(0,r().IS)((e=>({menuDiscussionItem:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:t.device.isMobile?4:6,borderTop:!t.device.isMobile&&T?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!t.device.isMobile&&P?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:B?void 0:U?e.focusDiscussionBackground:V?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:x().FB},avatar:{marginTop:0,marginRight:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},attachIcon:{width:18,height:18,fill:e.mediumIconColor},text:{cursor:"text",lineHeight:"20px",paddingTop:4},attachmentContainer:{display:"flex",alignItems:"center"},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},commentAuthorPlaceholder:{marginRight:8,marginTop:2,height:F,width:F,borderRadius:20,flexShrink:0},container:{paddingTop:x().e4,paddingRight:16,paddingBottom:x().Wv,paddingLeft:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:c().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[F,t.device.isMobile,V,U,B,P,T]),Q=(0,o.useCallback)((async()=>{const e=await g().T.formulas.load();b().i5({environment:t,allowActionsWhileCommenting:!0,formulasModule:e})}),[t]),$=(0,a().K8)((()=>!A().A.state.open||"reaction"===A().A.state.content),[]),Z=(0,a().K8)((()=>{var e;return A().A.getBlockStore()??(null===(e=A().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),J=(0,a().K8)((()=>A().A.getPropertyId()),[]),X=(0,a().K8)((()=>{if(J){var e;const t=null===(e=A().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,s()._g)({schema:n,property:J})}}),[J]),ee=(0,a().K8)((()=>(0,l().RX)(h().A.getIntl()).title),[]),te=(0,a().K8)((()=>A().A.getDiscussionInputStore()),[]),ne=(0,a().K8)((()=>null==E?void 0:E.getDisplayName(G)),[E,G]),oe=(0,a().K8)((()=>null==Z?void 0:Z.getSpaceId()),[Z]),ie=(0,a().K8)((()=>b().Ek({environment:t})),[t]),ae=(0,a().K8)((()=>A().A.getType()),[]),re=(0,a().K8)((()=>null==Z?void 0:Z.getValue()),[Z]);if($||!ee||!E||!Z||!N||!te||!oe||!re&&"block"===ae||!ie&&"inline"===ae)return null;const se="inline"===ae||J,le="block"===ae&&!J?(0,I.jsx)(u().Ay,{blockValue:re,rootStore:Z,blockPreviewLocation:"comments_sidebar"}):se?(0,I.jsx)(u().vY,{value:{value:(null==ie?void 0:ie.context)??[],spaceId:oe},propertySchema:ee,labeled:!1,rootStore:Z,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,I.jsx)("div",{style:q.discussionContainer,ref:Y,onClick:null==n?void 0:n.onClick,onMouseEnter:K,onMouseLeave:z,children:(0,I.jsx)(p().A,{allowTextSelection:!0,style:q.menuDiscussionItem,title:(0,I.jsx)("div",{style:q.container,children:(0,I.jsxs)("div",{style:q.comment,children:[(0,I.jsxs)("div",{style:q.userRow,children:[(0,I.jsx)(C().E,{authorStore:E,avatarSize:F,avatarStyle:q.avatar,placeholderStyle:q.commentAuthorPlaceholder}),(0,I.jsxs)("div",{style:q.noOverflow,children:[(0,I.jsx)("span",{style:q.displayName,children:ne||(0,I.jsx)("span",{style:q.placeholder})}),(0,I.jsx)(m().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:q.draftLabel,children:(0,I.jsx)(d().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,I.jsxs)("div",{style:q.commentElementsBelowUserRow,children:[(0,I.jsx)("div",{style:q.commentContext,children:(0,I.jsxs)("div",{style:q.fullWidthFlex,children:[(0,I.jsx)(w().T,{}),X&&(0,I.jsx)(k().A,{propertySchema:X}),(0,I.jsx)("div",{style:q.smallTopPadding,children:le})]})}),(0,I.jsx)(j().A,{showAvatar:!1,parentStore:N,blockStore:Z,onSubmit:Q,discussionInputStore:te,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:S().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:_,dontMoveCursorToInputEndOnFocus:!0,onBlur:H,onFocus:W},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},273579:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(401497),r=n(474848);const s=(0,n(340498).wt)("thanksShield",{viewBox:"0 0 27 32",svg:(0,r.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var l=()=>n(959013);const d=["dmca_no_action"],c=(0,l().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var u=()=>n(100622),p=()=>n(496603),m=()=>n(284371),g=()=>n(449506),f=()=>n(901389),h=()=>n(201170),y=()=>n(186445),v=()=>n(135552),b=()=>n(972435),x=()=>n(722872),S=()=>n(836251),M=()=>n(227440),A=()=>n(736026),C=()=>n(716583),w=()=>n(297872),j=()=>n(623580),k=()=>n(928600),I=()=>n(678553),T=()=>n(939740),P=()=>n(728902),_=()=>n(864943),B=()=>n(89924),L=()=>n(690197),R=()=>n(719147),D=()=>n(327165);const O=(0,l().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const N=function(){const e=(0,i().K8)((()=>A().A.state.open),[]);return(0,r.jsx)(n(641514).A,{ariaLabel:b().A.formatMessage(O.dialogLabel),onDismiss:Y,render:()=>(0,r.jsx)(Z,{}),isOpen:e})};function E(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!d.includes(t)&&!("other_content_policy_violation"===t&&!n))}function F(){const{state:e}=A().A;if(e.open){const{reason:t,additionalInformation:n}=e;return E({reason:t,additionalInformation:n})}return!1}function U(e){let{modalState:t}=e;const{reason:n}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P().A,{title:(0,r.jsx)(l().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>A().A.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,r.jsx)(P().A,{title:b().A.formatMessage(c.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>A().A.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,r.jsx)(P().A,{title:b().A.formatMessage(c.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>A().A.setState({...t,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,r.jsx)(P().A,{title:(0,r.jsx)(l().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>A().A.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function V(e){const t=A().A.getState();if(!t.open)return;const{additionalInformation:n,reason:o}=t,i=(0,y().Gu)();if(null==i||!i.id||!o||!E({reason:o,additionalInformation:n}))return void f().f1((0,r.jsx)(l().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const a=await g().callApi({eventName:"reportPage",environment:e,data:{reason:o,page:i,additionalInformation:n}});"failed"===a.type?f().Qg(a):(A().A.setState({open:!1}),f().rG({message:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[s({width:32}),(0,r.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,r.jsx)(l().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function K(e){return{width:360,padding:24,fontSize:14,color:e.mediumTextColor}}function z(e,t){const{device:n}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:n.isMobile?16:"10px 12px",height:n.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:n.isMobile?16:14}}function W(e){let{isMobile:t=!1}=e;return(0,r.jsx)(l().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion's content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,r.jsx)("br",{}),contentpolicylink:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0,r.jsx)(L().A,{title:n,href:(0,S().xS)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginLeft:void 0},buttonStyle:{alignItems:"baseline",height:t?m().K_.UISmall.mobile:m().K_.UISmall.desktop,paddingLeft:"3px",paddingRight:"2px"},iconStyle:{alignSelf:"center",marginRight:"3px"},textSize:"small",isMobile:t})},clarification:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("i",{children:t})}}})}function H(){return(0,r.jsx)(l().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion's official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)(R().A,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:t})}}})}function G(){const e=(0,a().DP)();return(0,r.jsx)("div",{style:K(e),children:(0,r.jsx)(l().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function Y(){h().lR()}function q(){return(0,a().IS)((e=>({reportPageExplanation:{color:e.lightTextColor,background:e.contentBackground,border:`1px solid ${e.stroke.input}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:u().Ay.lightTextColor,padding:"5px",fontSize:m().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:m().Wy.medium}})),[])}function Q(e){let{modalState:t}=e;const n=(0,a().DP)(),i=(0,o().v3)(),s=q();if(!t.open)return null;const{reason:c}=t,m={menuType:x().gu.Modal,title:(0,r.jsx)(l().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,r.jsx)(l().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:Y};return(0,r.jsx)(k().A,{...m,children:(0,r.jsx)(T().Ay,{type:T().Oh.Vertical,initialFocus:void 0,sections:p().oE([{key:"help",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(B().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"help",render:()=>(0,r.jsx)(I().A,{title:(0,r.jsx)(W,{isMobile:!0}),textWrapperStyle:s.mobileDescription,shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(B().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"options",render:()=>(0,r.jsx)(U,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>c&&!d.includes(c)&&(0,r.jsx)(j().A,{textarea:!0,style:z(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:b().A.formatMessage(O.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===c}),onChange:e=>{A().A.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},"dmca_no_action"===c?{key:"explain_dmca",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(B().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"explain_dmca",render:()=>"dmca_no_action"===c&&(0,r.jsx)(I().A,{title:(0,r.jsx)(H,{}),textWrapperStyle:{...s.mobileDescription,background:n.accentColors.yellow[100],color:n.accentColors.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(B().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,o=F();return(0,r.jsx)(D().A,{...n,disabled:!o,title:(0,r.jsx)("div",{style:{color:o?u().Ay.red:u().Ay.uiGray},children:(0,r.jsx)(l().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||V})},action:()=>V(i)}]}])},"main list")})}function $(e){let{modalState:t}=e;const n=(0,a().DP)(),i=(0,o().v3)(),s=q();if(!t.open)return null;const{reason:c}=t,u="dmca_no_action"===c;return(0,r.jsx)(w().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,r.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,r.jsx)("div",{style:s.modalTitle,children:(0,r.jsx)(l().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,r.jsx)(C().A,{isMobile:!1,textSize:"small",styleKey:v().q.Yellow,style:u?s.reportPageBanner:{...s.reportPageExplanation,...s.reportPageBanner},children:u?(0,r.jsx)(H,{}):(0,r.jsx)(W,{})}),(0,r.jsx)("div",{children:(0,r.jsx)(U,{modalState:t})}),c&&!d.includes(c)&&(0,r.jsx)(j().A,{textarea:!0,style:z(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:b().A.formatMessage(O.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===c}),onChange:e=>{A().A.setState({...t,additionalInformation:e.target.value})}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,r.jsx)(_().A,{size:"lg",onClick:Y,style:{marginRight:12},children:(0,r.jsx)(l().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,r.jsx)(_().A,{color:"uiRed",size:"lg",onClick:()=>V(i),disabled:!F(),disabledFeedback:!0,children:(0,r.jsx)(l().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function Z(){const e=(0,o().v3)(),{device:t}=e,n=(0,i().K8)((()=>M().A.state.online),[]),a=(0,i().O$)(A().A);return n?a.open?t.isMobile?(0,r.jsx)(Q,{modalState:a}):(0,r.jsx)($,{modalState:a}):null:(0,r.jsx)(G,{})}},275193:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(591779),l=n(474848);const d=(0,n(340498).wt)("appDownload",{viewBox:"0 0 23 16",svg:(0,l.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var c=()=>n(66913),u=()=>n(861017),p=()=>n(959013),m=()=>n(284371),g=()=>n(579631),f=()=>n(449506),h=()=>n(435009),y=()=>n(597755),v=()=>n(112799),b=()=>n(346),x=()=>n(567121),S=()=>n(962730),M=()=>n(351360),A=()=>n(927080),C=()=>n(493823),w=()=>n(625830),j=()=>n(285790),k=()=>n(187485),I=()=>n(14235),T=()=>n(204063),P=()=>n(125565);function _(){const e=(0,i().v3)(),t=(0,p().tz)(),[n,_]=(0,o.useState)(!0),{isDesktopBrowser:B,os:L}=(0,i().Y0)(),R=(0,a().K8)((()=>e.RouterStore.state.route.name in u().b1),[e]),D=(0,a().K8)((()=>M().default.state.inAppCalloutStore),[]),O=(0,a().K8)((()=>D.getCalloutVisibility("desktop_preference_popup").canShow),[D]),N=e.currentUser.isLoggedIn(),E=(0,a().O$)(A().A),[F,U]=(0,o.useState)(!1),V=(0,a().K8)((()=>A().A.canPersistToLocalStorage()),[]),K=!F&&N&&void 0===E&&B&&("mac"===L||"windows"===L)&&R&&V&&O,[z,W]=(0,o.useState)(!1),H=K&&z,G=(0,o.useRef)(!1);(0,o.useEffect)((()=>{K&&!G.current&&(async function(e,t){const n=await f().callApi({eventName:"getDesktopAppRegistration",environment:e,data:{os:t}});return"data"in n&&n.data.isRegistered}(e,L).then((e=>{W(e)})),G.current=!0)}),[K,W,e,L]);const Y=(0,s().ZC)(H);(0,o.useEffect)((()=>{H&&!Y&&(g()._g(e),D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[H,Y,e,D]);const q=(0,b().n_)(),Q=(0,v().E)(),$=(0,r().IS)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m().Wy.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,l.jsx)(I().Ay,{popupType:I().nl.Popup,placementToOrigin:S().W.Bottom,alignmentToOrigin:S().C.Center,origin:(0,l.jsx)("div",{style:$.origin}),originGap:q?-x().ls/2:0,disableMouseCapture:!0,open:H,style:$.container,render:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:$.header,children:[(0,l.jsx)(P().A,{style:$.headerText,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,l.jsx)(j().A,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c().V,onClick:()=>{A().A.setState("never"),U(!0),g().e1(e)}})]}),(0,l.jsx)(k().A,{external:!0,onClick:()=>{Q.current&&(h().oo({environment:e,url:Q.current,openInNew:"tab"}),g().co(e))},children:(0,l.jsxs)(C().p,{isGray:!0,size:"xs",style:$.appDownloadButton,children:[d($.appDownloadIcon),(0,l.jsx)("span",{children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,l.jsxs)("div",{style:$.actions,children:[(0,l.jsxs)("div",{style:$.alwaysOpenLinks,children:[(0,l.jsx)(w().A,{checked:n,size:16,onClick:()=>{_(!n)}}),(0,l.jsx)(P().A,{isInline:!0,style:$.alwaysOpenLinksLabel,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]}),(0,l.jsx)(T().A,{style:$.alwaysOpenLinksButton,onClick:()=>{A().A.setState(n?"always":"never"),U(!0),h().eG({url:(0,y().P)(window.location.href),environment:e}),g().SS(e,{always_open_in_app:n})},children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},286611:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=n(474848);const l=(0,n(340498).wt)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,s.jsxs)("svg",{children:[(0,s.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var d=()=>n(959013),c=()=>n(284371),u=()=>n(755199),p=()=>n(351360);function m(){const[e,t]=(0,o.useState)(!1),r=(0,i().v3)(),s=(0,a().K8)((()=>p().default.state.currentUserSettingsStore),[]);return[(0,a().K8)((()=>{const t=n(508496).default.checkGate({gateName:"dictation_new_page_nux"}),o=null==s?void 0:s.getSettings(),i=Boolean(null==o?void 0:o.dismissed_dictation_new_page_nux);return t&&!i&&!e}),[s,e]),(0,o.useCallback)((()=>{s&&(t(!0),u().wG({environment:r,userSettingsStore:s,dismissed:!0}))}),[r,s,t])]}(0,n(604341).exposeDebugValue)("resetDictationTooltip",(e=>{const t=p().default.state.currentUserSettingsStore;t&&u().wG({environment:e,userSettingsStore:t,dismissed:!1})}));var g=()=>n(962730),f=()=>n(301948),h=()=>n(760217),y=()=>n(364280);const v=(0,o.forwardRef)((function(e,t){const{format:n,className:o,icon:i,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,locked:h,type:y}=e;return"collection-overlay"===n?(0,s.jsx)(x,{ref:t,className:o,icon:i,format:n,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,locked:h,type:y}):"phone-modal"===n?(0,s.jsx)(S,{ref:t,icon:i,format:n,title:a,isDefault:r,recurrence:l,focused:u,onClick:p}):"horizontal-new-page"===n?"dictation"===y?(0,s.jsx)(k,{ref:t,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:y}):(0,s.jsx)(w,{ref:t,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:y}):"horizontal-new-page-submenu"===n?(0,s.jsx)(j,{ref:t,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a}):(0,s.jsx)(A,{ref:t,focused:u,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,format:n,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c})}));function b(e){let{format:t,title:o,isDefault:i,recurrenceDisabled:a}=e;const u=(0,r().DP)();return"collection-overlay"!==t?(0,s.jsx)(s.Fragment,{children:o}):(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o,(0,s.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i&&(0,s.jsx)("span",{style:{fontSize:12,fontWeight:c().Wy.medium,color:u.mediumTextColor},children:(0,s.jsx)(d().sA,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),a&&l({width:14,height:12.25,color:n(100622).Ay.lightIconColor,marginLeft:8})]})]})}const x=(0,o.forwardRef)((function(e,t){let{className:n,icon:o,format:a,title:r,isDefault:l,recurrence:d,recurrenceDisabled:c,right:u,focused:p,onClick:m,onMouseMove:g,onMouseEnter:f,onMouseLeave:y,locked:v,type:x}=e;const S=(0,i().v3)(),{device:M}=S;return(0,s.jsx)(h().A,{ref:t,className:n,icon:o,title:(0,s.jsx)(b,{format:a,title:r,isDefault:l,recurrence:d,recurrenceDisabled:c}),right:u,focused:p,onClick:m,onMouseMove:g,onMouseEnter:f,onMouseLeave:y,showDragHandle:!M.isMobile&&!v,dragHandleDisabled:"empty_page"===x})})),S=(0,o.forwardRef)((function(e,t){let{icon:n,format:o,title:i,isDefault:a,recurrence:r,focused:l,onClick:d}=e;return(0,s.jsx)(h().A,{ref:t,icon:n?(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24},children:n}):null,title:(0,s.jsx)(b,{format:o,title:i,isDefault:a,recurrence:r}),focused:l,onClick:d,showDragHandle:!1})}));function M(e,t,o){const{device:i}=e;return{...n(799954).nE,display:"flex",alignItems:"center",flexGrow:1,height:i.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:o?t.mediumTextColor:t.lightTextColor}}const A=(0,o.forwardRef)((function(e,t){let{focused:o,onClick:l,onMouseMove:d,onMouseEnter:c,onMouseLeave:u,icon:p,format:m,title:g,isDefault:f,recurrence:h,recurrenceDisabled:y,right:v}=e;const x=(0,r().DP)(),S=(0,i().v3)(),A=(0,n(792485).S)(),C=(0,a().K8)((()=>{const e=null==A?void 0:A.publicEditModeStore.state;return(0,n(68465).ZE)(e)}),[A]);return(0,s.jsxs)(n(704152).A,{style:M(S,x,C),hovered:o,onClick:l,onMouseMove:d,onMouseEnter:c,onMouseLeave:u,hoveredStyle:{background:x.buttonHoveredBackground,color:x.regularTextColor},pressedStyle:{background:x.buttonPressedBackground},children:[(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:p}),(0,s.jsx)(b,{format:m,title:g,isDefault:f,recurrence:h,recurrenceDisabled:y}),v&&(0,s.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:v})]})})),C=(0,d().YK)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),w=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:l,onMouseEnter:d,onMouseLeave:u,icon:p,title:m,type:g,tooltipEvents:f}=e;const h=(0,i().v3)(),v=(0,r().IS)((e=>({item:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",background:e.assistantTintedActionButtonBackground,borderRadius:100,fontSize:13,fontWeight:c().Wy.medium},moreItem:{width:32,height:32,padding:0,justifyContent:"center"},itemFocused:{background:e.tint.regular},itemFilled:{borderColor:e.tint.regular,background:e.assistantTintedActionButtonBackground},itemFilledAndFocused:{background:e.tint.regular}})),[]),b=(0,a().K8)((()=>!h.device.isMobile&&("ai"===g||"dictation"===g)),[h.device.isMobile,g]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:l,onMouseEnter:d,onMouseLeave:u,...f||{},style:{...v.item,..."more"===g?v.moreItem:{},...b?v.itemFilled:{},...n?v.itemFocused:{},...b&&n?v.itemFilledAndFocused:{}},children:(0,s.jsxs)(y().fI,{gap:4,alignItems:"center",children:[p,m]})})})),j=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:l,icon:d,title:c}=e;const u=(0,r().IS)((e=>({item:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px"},itemFocused:{background:e.tint.regular,borderRadius:6}})),[]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:l,style:{...u.item,...n?u.itemFocused:{}},children:(0,s.jsxs)(y().fI,{gap:8,alignItems:"center",children:[d,c]})})})),k=(0,o.forwardRef)((function(e,t){const i=(0,o.useRef)(null),[a,l]=m(),c=(0,r().IS)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginLeft:"-4px"},badge:{background:e.accentColors.translucentGray[300],color:e.text.contrastSecondary,marginLeft:0,width:"fit-content"}})),[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(594607).B,{shouldShow:a,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,s.jsx)(n(953006).k,{style:{width:200},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"top",alignmentToOrigin:g().C.Center,header:(0,s.jsx)(f().A,{style:c.badge}),content:(0,s.jsx)(d().sA,{...C.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:l})}),(0,s.jsx)(n(859428).A,{disableTooltip:a,renderTooltip:()=>(0,s.jsxs)("div",{style:c.tooltipContainer,children:[(0,s.jsx)(f().A,{style:c.badge}),(0,s.jsx)(d().sA,{...C.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:g().W.Top,render:n=>(0,s.jsx)("div",{ref:i,children:(0,s.jsx)(w,{...e,ref:t,tooltipEvents:n})})})]})}))},291606:(e,t,n)=>{n.d(t,{AC:()=>a,dE:()=>s,Nw:()=>l,tn:()=>r});var o=()=>n(989423);const i=new(n(178624).R)({key:"offline_autosync_setting",namespace:n(419494).cd,important:!0,trackingType:"necessary"});function a(){return"on"===i.getState()}function r(e){let{environment:t}=e;const n=a()?"off":"on";(0,o().u4)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),i.setState(n)}function s(){return i.getState()}function l(e){i.setState(e)}},296431:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>y});n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(401497),r=()=>n(673724),s=()=>n(959013),l=()=>n(284371),d=()=>n(864943),c=()=>n(204063),u=()=>n(641514),p=()=>n(21140),m=()=>n(475355),g=()=>n(108414),f=()=>n(812941),h=n(474848);function y(){const e=(0,o().v3)(),t=(0,s().tz)(),n=(0,a().IS)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),y=(0,i().K8)((()=>g().A.state.open),[]);return(0,h.jsx)(u().A,{onDismiss:()=>{g().A.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:n.modal,children:(0,h.jsxs)(p().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,r().I)(n.loopIcon),(0,h.jsx)("div",{style:n.title,children:(0,h.jsx)(s().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:n.description,children:(0,h.jsx)(s().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c().A,{size:"lg",style:n.confirmButton,onClick:()=>{if(g().A.state.open){const{pageStore:n,flowId:o}=g().A.state;m().v4({environment:e,intl:t,page:n,flowId:o}),g().A.setState({open:!1})}},children:(0,h.jsx)(s().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d().A,{size:"lg",style:n.cancelButton,onClick:()=>g().A.setState({open:!1}),children:(0,h.jsx)(s().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(f().A,{message:(0,h.jsx)(s().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:y})}},301782:(e,t,n)=>{n.d(t,{CM:()=>p,UB:()=>u,zc:()=>c});n(898992),n(354520),n(581454);var o=()=>n(890409),i=()=>n(973647),a=()=>n(534177),r=()=>n(862292),s=()=>n(989423),l=()=>n(909470),d=()=>n(546461);function c(e){const{automationActionStore:t,automationStore:n,formulaAnalyticsModule:r,formulasModule:s,simpleFormulasModule:c}=e,u=t.getModel(),p=n??t.getParentStore();if(!u||!p)return;const m=p.getActionStores().map((e=>e.getModel())).filter(a().O9),g=(0,d().To)(p);let f=[];return g&&i().Q.isSuccess(g)&&(f=g.value.valueTypes),(0,o()._f)({automationActionModel:u,automationActionModels:m,formulaAnalyticsModule:r,formulasModule:s,simpleFormulasModule:c,formulaTypecheckContextValues:f,getRecordModel:t.getRecordModel,featureGates:(0,l().i)()})}function u(e,t){const{automationStore:n,automationActionStore:o}=t;n.isTriggerType("event")||p(((t,i,a)=>{const r=c({automationActionStore:o,automationStore:n,formulaAnalyticsModule:i,formulasModule:t,simpleFormulasModule:a});r&&(0,s().pM)(e,"automation_action_update",o.id,1,{automation_action:r,automation_action_id:o.id,automation_id:n.id})}))}function p(e){return Promise.all([r().T.formulas.load(),r().T.formulaAnalytics.load(),r().T.simpleFormulas.load()]).then((t=>{let[n,o,i]=t;e(n,o,i)})).catch((e=>{console.error("Error sending analytics for automations",e)}))}},308227:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(56366),i=()=>n(508496);function a(e){const{featureGateId:t,whenEnabled:n,whenDisabled:a,disableExposureLogging:r}=e,s=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,o().K8)((()=>i().default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:r});return s?n:a}},308228:(e,t,n)=>{n.d(t,{W:()=>s,m:()=>r});n(296540);var o=()=>n(959013),i=n(474848);const a=(0,o().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupAnOwner:{id:"getTeamRoleDisabled.makingAGroupAnOwner",defaultMessage:"Groups can’t be teamspace owners"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust team membership."}});function r(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}=e;return t||"owner"!==n?o&&"team_level_guest"===n?l(a.addingGuestsToDefaultTeam):!i&&"team_level_guest"===n||!t&&"team_level_guest"===n?l(a.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(a.upgradingAnOwnerAsNonOwner)}function s(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:s,originalTeamMemberInfo:d,onlyHasOneOwner:c,isUnowned:u,isMemberCurrentUser:p,canCurrentUserAddTeamMembers:m}=e;if("team_level_guest"===n&&"team_level_guest"!==d.type)return l(a.downgradingAMemberToAGuest);const g="owner"!==n&&"owner"===d.type;if(g&&!t)return l(a.downgradeToOwnerAsNonOwner);if(g&&c)return l("none"===n?"group"===d.entity_type?a.removeLastGroupOwner:a.removeLastUserOwner:"group"===d.entity_type?a.downgradeLastMakingAGroupAnOwner:a.downgradeLastUserOwner);if("none"===n&&o)return l(a.removingMemberFromDefaultTeam);return"group"===d.entity_type&&"team_level_guest"===n?l(a.makingAGroupATeamGuest):"owner"===n&&i&&"user"===d.entity_type&&u&&p||"owner"===n&&s&&p?{isDisabled:!1,disabledReason:void 0}:"none"===n?t||m&&"member"===d.type?{isDisabled:!1,disabledReason:void 0}:l(a.removingMemberAsMember):t?r({isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}):l(a.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,i.jsx)(o().sA,{...e})}}},310109:(e,t,n)=>{n.r(t),n.d(t,{getAllContextValues:()=>y,getContextValueForActionById:()=>b,getContextValuesForAction:()=>v,typecheckAutomation:()=>f,typecheckAutomationAsync:()=>h});n(944114),n(898992),n(581454),n(737550);var o=()=>n(496603),i=()=>n(973647),a=()=>n(534177),r=()=>n(999515),s=()=>n(977345),l=()=>n(329333),d=()=>n(638458),c=()=>n(322867),u=()=>n(281994),p=()=>n(648651),m=()=>n(103966);function*g(e){const{actionModels:t,automationModel:n,contextType:g,formulasModule:f,runtimeStats:h}=e,y={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}},v=performance.now();let b,x,S;if("button_block"===g||"button_property"===g){if(!n.isButtonType())return{error:new(c().N9)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,m().Z)(n.getTriggerType()).typecheck(e,t)}else if("event"===g){if(!n.isEventType())return{error:new(c().N9)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,m().Z)(n.getTriggerType()).typecheck(e,t)}else if("recurrence"===g){if(!n.isRecurrenceType())return{error:new(c().N9)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,m().Z)(n.getTriggerType()).typecheck(e,t)}else(0,a().HB)(e);if(i().Q.isFail(S))return S;y.valueTypes.push(...o().o8(S.value.valueTypes));for(const a of t){b=void 0,h&&(b=p().hs.getOrCreateAction(h,a.pointer,a.getType()));const t=(0,l().getActionRegistryItem)(a.getType());if(!t){x={error:new(c().oM)({actionId:a.id,message:`Unsupported action type: ${a.getType()}`})};break}const m=performance.now(),g=(0,d().Q)({automationModel:n,formulasModule:f,formulaValueTypes:y.valueTypes}),v=(0,u().HI)(yield*t.resolveExecutionDependencies(g,a));yield*r().q.fetchRecords(v.map((e=>e.pointer))),b&&(b.totalDependencies=v.length,b.getDependenciesDurationMs=Math.trunc(performance.now()-m));const S=t.typecheck(e,a),M=o().o8(y.valueTypes);if(y.actionInputValueTypes[a.id]=M,i().Q.isFail(S)){x=S;break}for(const e of S.value.valueTypes??[]){y.valueTypes.some((t=>(0,s().oH)(e,t)))||y.valueTypes.push(e)}S.value.validationFailures&&S.value.validationFailures.length>0&&(y.actionValidationFailures[a.id]=S.value.validationFailures)}const M=Math.trunc(performance.now()-v);return h&&(h.typecheckStartTime=v,h.typecheckDurationMs=M,h.typecheckSuccess=!(0,a().O9)(x)),x??{value:y}}function f(e){return r().q.runSync(e.getRecordModel,g(e))}async function h(e){return await r().q.runAsync(e.loadRecordModel,g(e))}function y(e){return i().Q.isFail(e)?[]:e.value.valueTypes.slice(0)}function v(e,t){return i().Q.isFail(e)?[]:e.value.actionInputValueTypes[t]??[]}function b(e,t,n){const o=v(e,t);return(0,s().IV)(o,n)}},311337:(e,t,n)=>{n.d(t,{y:()=>s});var o=()=>n(731320),i=()=>n(792415),a=()=>n(351360),r=()=>n(326589);function s(e){var t;if(!(0,r().g)())return!1;if(!e.currentUser.isLoggedIn())return!0;const n=null===(t=i().A.state.publicPageData)||void 0===t?void 0:t.spaceId;if(!e.currentUser.id||!n)return!1;const s=a().default.state.mainEditorCurrentBlockStore,l=!!s&&(0,o().qb)(e,s);return Boolean(l)}},315729:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>An,PeopleRow:()=>Sn,SettingToggle:()=>Cn,SidebarTeamModal:()=>Mn});n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(959013),l=()=>n(496603),d=()=>n(534177),c=()=>n(284371),u=()=>n(946141),p=()=>n(38337),m=()=>n(37433),g=()=>n(632709),f=()=>n(756279),h=()=>n(351360),y=()=>n(630116),v=()=>n(991249),b=()=>n(341974),x=()=>n(345578),S=(n(944114),()=>n(820579)),M=()=>n(340498),A=()=>n(100622),C=()=>n(436572),w=()=>n(317909),j=()=>n(297872),k=()=>n(623580),I=()=>n(204063),T=()=>n(859428),P=()=>n(125565),_=()=>n(972435),B=()=>n(213525),L=()=>n(962730),R=()=>n(848237),D=()=>n(605685),O=()=>n(43450);function N(e){return!(0,O().R)(e)}var E=()=>n(976519),F=()=>n(211825),U=()=>n(655784),V=()=>n(812941),K=()=>n(898808),z=()=>n(818787),W=()=>n(437622),H=()=>n(144707),G=n(474848);const Y=(0,s().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),q=(0,s().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function Q(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),o=g().p.Members,i=(0,a().K8)((()=>t.getTeamAccessLevel()),[t]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(z().BA,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,G.jsx)(H().u,{currentAccessLevel:i,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,G.jsx)($,{teamStore:t},"permissions")],onClick:()=>{g().A.state.open&&g().A.setState({...g().A.state,tab:o})},itemStyle:n.listItem})]})}function $(e){let{teamStore:t}=e;const n=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),o=(0,i().v3)(),s=(0,r().IS)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,a().K8)((()=>t.getTeamPermission()),[t]),d=(0,a().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,a().K8)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,W().GK)(o,n);return{spaceIcon:(0,G.jsx)(K().x,{disabled:!0,store:n,size:20,style:s.icon}),spaceName:e}}),[n,o,s.icon]),p=(0,a().K8)((()=>(0,G.jsx)(K().x,{disabled:!0,store:t,size:20,style:s.icon})),[t,s.icon]),m=(null==l?void 0:l.role)??"none",g=!(m===d.role),f=g?p:c,y=_().A.formatMessage(q[d.role],{showTeam:g,spaceName:u}),v=_().A.formatMessage(Y[m]);return(0,G.jsxs)("div",{style:s.row,children:[f,(0,G.jsxs)(P().A,{isSmall:!0,style:s.label,children:[g&&(0,G.jsxs)(G.Fragment,{children:[v,(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),y]})]})}var Z=()=>n(934999),J=()=>n(493823),X=()=>n(638743),ee=()=>n(657328),te=()=>n(118849),ne=()=>n(233510),oe=(n(898992),n(672577),()=>n(668725)),ie=()=>n(68263),ae=(n(354520),()=>n(433847));const re=["none","reader","comment_only","read_and_write","editor"],se=["reader","comment_only","read_and_write"],le=["reader","comment_only","read_and_write","editor"],de=["editor"];function ce(e){const t=function(e){var t,n;let{teamId:o,permissions:i}=e;const a=(null===(t=i.find((e=>(0,ie().Lg)(e))))||void 0===t?void 0:t.role)??"none",r=(null===(n=i.find((e=>(0,ie().gl)(e)&&e.team_id===o)))||void 0===n?void 0:n.role)??a,s=i.find((e=>(0,ie().un)(e)));return{spacePermission:{type:"space_permission",role:a},teamMemberPermission:{type:"explicit_team_permission",team_id:o,role:r},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:o,role:"editor"},...s&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:o,role:s.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:o}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},a={spacePermission:pe({roles:re,currentRole:o.role}),teamGuestPermission:se,teamMemberPermission:ue({roles:le,currentRole:n.role}),teamOwnerPermission:de},{visibility:r,space_member_join_access:s}=e.settings;return"team_members"===r&&(i.space_member_join_access=["invite_only"],a.spacePermission=["none"]),"self_join"===s&&(i.visibility=["space_members"],i.invite_access=["team_members"],a.spacePermission=a.spacePermission.filter((e=>"none"!==e))),e.is_default&&(a.teamMemberPermission=[o.role],a.spacePermission=[o.role]),{settingsOptions:i,permissionItemRoleOptions:a,currentTeamPermissionItems:t}}function ue(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ae().Pr)(e,n)))}function pe(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ae().Y1)(e,n)))}var me=()=>n(760217),ge=()=>n(406699),fe=()=>n(928600),he=()=>n(939740),ye=()=>n(89924),ve=()=>n(946548),be=()=>n(722872),xe=()=>n(553965);function Se(e){let{teamStore:t}=e;const n=(0,a().K8)((()=>t.getSettingsStore().getValue()),[t]),o=(0,a().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ce({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!o)return null;const i=[(0,G.jsx)(Ae,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,G.jsx)(Me,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar"),(0,G.jsx)(Ce,{teamStore:t},"toggleInviteLink")];return(0,G.jsx)(z().BA,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i,hideDividers:!0})}function Me(e){const{teamStore:t,disablePageEdits:n}=e,r=(0,i().v3)(),l=N(t),d=(0,a().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,o.useCallback)((e=>{w().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:r,canUndo:!0,perform:n=>{R().WC({environment:r,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[r,t]),u=(0,ie().p2)(d),p=[{option:!0,label:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&p.push({option:!1,label:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,G.jsx)(we,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:p,optionTooltip:u?void 0:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Ae(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:a}=e,r=(0,O().R)(t),l=(0,i().v3)(),d=(0,o.useCallback)((e=>{w().createAndCommit({userAction:"team.setInviteAccess",environment:l,canUndo:!0,perform:n=>{R().WC({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!r||n;return(0,G.jsx)(we,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),disabled:c,optionTooltip:c&&r&&(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:a,allOptions:[{option:"team_members",label:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,G.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function Ce(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().K8)((()=>(0,m().FQ)(t)),[t]),l=N(t),d=(0,r().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,G.jsxs)("div",{style:d.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(P().A,{children:(0,G.jsx)(s().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,G.jsx)(P().A,{isSmall:!0,style:d.subtitle,children:(0,G.jsx)(s().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,G.jsx)("div",{style:d.switcher,children:(0,G.jsx)(ve().A,{disabled:l,on:!o,onClick:()=>{w().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{R().WC({environment:n,store:t,update:{disable_invite_link:!o},transaction:e})}})}})})]})}function we(e){const{title:t,caption:n,currentOption:o,allOptions:a,disabled:s,optionTooltip:l}=e,d=(0,i().Y0)(),c=(0,r().IS)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=a.find((e=>e.option===o));return u?(0,G.jsxs)("div",{style:c.root,children:[(0,G.jsxs)("div",{style:c.title,children:[t,n&&(0,G.jsx)(P().A,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,G.jsx)(T().A,{style:c.tooltipWidth,placement:L().W.Top,alignment:L().C.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)(ge().Ay,{...e,disablePopup:s,popupType:d.isMobile?ge().z7.SlideUp:ge().z7.Popup,alignmentToOrigin:ge().yP.End,renderOrigin:t=>(0,G.jsxs)(J().p,{style:c.buttonStyle,disabled:s,...(0,xe().A)(e,t),children:[u.label,!s&&(0,oe().b)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:be().gu.ActionSheet}:{menuType:be().gu.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,G.jsx)(ye().A,{...e}),items:a.map((t=>{const n={key:t.option.toString(),render:e=>(0,G.jsx)(me().A,{...e,title:t.label,caption:t.caption,checkState:o===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,G.jsx)(fe().A,{...t,children:(0,G.jsx)(he().Ay,{type:he().Oh.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function je(e){let{teamStore:t}=e;const n=(0,r().IS)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Se,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(ke,{teamStore:t}),(0,G.jsx)(V().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function ke(e){let{teamStore:t}=e;const n=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),o=(0,i().v3)(),l=(0,ne().Z)(),d="enterprise",{organizationOverrides:c}=(0,X().n)({spaceId:null==n?void 0:n.id}),u=o.currentUser.id,p=(0,a().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(c.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(c.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(c.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,c]),m=(0,O().R)(t),g=(0,a().K8)((()=>(null==n?void 0:n.canAdmin())??!1),[n]),f=(0,r().IS)((()=>({switcher:{marginRight:0}})),[]);if(!n)return null;if(!u)return null;const y=e=>l||p[e].teamIsDisabled,v=e=>{if(!y(e))return!1;if(!m)return!1;if(p[e].isControlledByOrganization)return!1;const t=(e=>p[e].spaceIsDisabled&&p[e].teamIsDisabled)(e);return!t||g},b=e=>!y(e)&&g,x=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=p[e],a=!n;R()._B({environment:o,store:t,settingName:e,newTeamSettingValue:Pe(a),spaceSettingValue:void 0===i?void 0:Pe(i)})},S=e=>{if((e=>p[e].spaceIsDisabled)(e))return(e=>p[e].teamIsDisabled)(e)?(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},M=(0,G.jsx)(te().A,{subscriptionTier:d,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),A=(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),C=[(0,G.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:p.disable_public_access.teamIsDisabled,disabled:!v("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:b("disable_public_access"),secondCaption:S("disable_public_access"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable publishing sites and forms"}),!y("disable_public_access")&&M]}),tooltip:!y("disable_public_access")&&A,isLocked:p.disable_public_access.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:p.disable_guests.teamIsDisabled,disabled:!v("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:b("disable_guests"),secondCaption:S("disable_guests"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!y("disable_guests")&&M]}),tooltip:!y("disable_guests")&&A,isLocked:p.disable_guests.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:p.disable_export.teamIsDisabled,disabled:!v("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:b("disable_export"),secondCaption:S("disable_export"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!y("disable_export")&&M]}),tooltip:!y("disable_export")&&A,isLocked:p.disable_export.isControlledByOrganization,lockedTooltip:(0,ee().C)()})],w=(0,G.jsx)(s().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,G.jsx)(z().BA,{title:w,rows:C,hideDividers:!0})}function Ie(e){const t=(0,i().v3)(),n=(0,a().K8)((()=>(0,m().mN)(e.teamStore)),[e.teamStore]);return(0,G.jsx)(J().p,{style:e.style,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),onClick:async()=>await(async e=>{let{teamStore:n,teamName:o}=e;await R().Q8({environment:t,teamStore:n,teamName:o,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(P().A,{children:(0,G.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,G.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})}function Te(e){const t=(0,i().v3)(),n=(0,r().IS)((()=>({archiveLabel:{color:A().Ay.red}})),[]);return(0,G.jsx)(J().p,{style:e.style,isRed:!0,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:async()=>{e.disabled||await R().mm({environment:t,teamStore:e.teamStore,from:"sidebar_team_modal"})},...e.tooltipEvents,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(P().A,{style:n.archiveLabel,children:(0,G.jsx)(s().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,G.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Pe(e){return e?"disable":"allow"}const _e=(0,s().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Be(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),d=N(t),[c,u]=(0,o.useState)(void 0),[p,m]=(0,o.useState)(void 0),g=(0,r().IS)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,y]=(0,a().K8)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const v=f||"",b=y??"",x=b.length>0,S=null==c?void 0:c.trim(),M=null==p?void 0:p.trim(),A=""===S||(void 0===p||M===b.trim())&&(void 0===c||S===v.trim()),j=(0,G.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),k=(0,G.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,G.jsx)(K().x,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{w().createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:n,canUndo:!0,perform:n=>{R().n7({store:t,update:{icon:e},transaction:n})}})}}),d?(0,G.jsx)(P().A,{children:v}):(0,G.jsx)(Le,{value:c??v,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),T=(0,G.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),L=_().A.formatMessage(_e.noDescription),D=d?(0,G.jsx)(P().A,{isMultiline:!0,isSecondaryColor:!x,children:x?b:L}):(0,G.jsx)(Le,{value:void 0===p?b:p,onBlur:e=>{m(e)},onChange:e=>{m(e)},disabled:d,textarea:!0,autosize:!0,placeholder:L,style:g.description}),O=[(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(P().A,{isSmall:!0,children:j}),k]},"name"),(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(P().A,{isSmall:!0,children:T}),D]},"description")];return(0,G.jsxs)("div",{style:g.container,children:[(0,G.jsx)(z().BA,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:O}),!d&&(0,G.jsx)(I().A,{style:g.updateButton,disabled:A,size:"lg",onClick:async()=>{if(A)return;if(S&&S!==v.trim()){if(!(await(0,B().d$)({environment:n,spaceStore:l,teamName:S})))return}const{performResult:e,serverCommitResult:o}=w().createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,canUndo:!0,perform:e=>{R().n7({store:t,update:{name:S??v,description:M??b},transaction:e})}});try{await Promise.all([e,o])}catch(i){return}C().D6({label:(0,G.jsx)(s().sA,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,G.jsx)(s().sA,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,G.jsx)("br",{}),(0,G.jsx)(Q,{teamStore:t}),(0,G.jsx)(Re,{teamStore:t}),(0,G.jsx)(V().A,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Le(e){const{value:t,style:n,onBlur:i,onChange:a,placeholder:r,disabled:s}=e,[l,d]=(0,o.useState)(!1);return(0,G.jsx)(j().A,{capture:l,render:o=>(0,G.jsx)(k().A,{textarea:e.textarea,autosize:e.autosize,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),a&&a(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:r,disabled:s,value:t,style:n,...o})})}function Re(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:z().mZ,paddingBottom:z().mZ,paddingLeft:z().jN,paddingRight:z().jN}})),[]),[o,i]=(0,a().K8)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,O().R)(t),d=(0,F().G)(t),c=(0,E().q)(t.id),u=(0,D().c)(),p=c&&!u;if(void 0===o||!d)return null;const m=[],g=(0,G.jsx)(U().A,{buttonInternals:(0,G.jsx)(De,{isTeamOwner:l}),teamStore:t,placement:L().W.Bottom,alignment:L().C.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>(0,S().f)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default,transform:"rotate(-90deg)"}),isRed:!l});if(m.push(g),l)if(i)m.push((0,G.jsx)(Ie,{teamStore:t,teamName:o,style:n.buttonStyle}));else{const e=(0,G.jsx)(T().A,{disableTooltip:!p,placement:L().W.Bottom,alignment:L().C.Start,renderTooltip:()=>(0,G.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,G.jsx)(Te,{disabled:p,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});m.push(e)}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:{height:20,width:"100%"}}),(0,G.jsx)(z().BA,{title:(0,G.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:m,itemStyle:{padding:0,margin:0}})]})}function De(e){let{isTeamOwner:t}=e;const n=(0,r().IS)((()=>({label:{color:t?"inherit":A().Ay.red}})),[t]);return(0,G.jsxs)("div",{children:[(0,G.jsx)(P().A,{style:n.label,children:(0,G.jsx)(s().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,G.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(s().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Oe=()=>n(381138),Ne=()=>n(986863),Ee=()=>n(205618),Fe=()=>n(931956),Ue=()=>n(284331);function Ve(e){let{teamStore:t}=e;const n=(0,r().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),o=(0,s().tz)(),i=(0,a().K8)((()=>g().A.state.memberFilterQuery),[]),l=(0,a().uB)(void 0,Ee().A),d=(0,Fe().X)(t),c=(0,a().K8)((()=>d&&!(0,m().FQ)(t)),[t,d]);return(0,G.jsxs)("div",{style:n.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(Ne().u,{store:t,permissionsInviteStore:l,origin:(0,G.jsx)(T().A,{placement:L().W.Left,alignment:L().C.Start,textWrap:!0,renderTooltip:()=>d?(0,G.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,G.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,G.jsx)("div",{style:{width:220},children:(0,G.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,G.jsx)(I().A,{disabled:!d,size:"lg",onClick:()=>{l.setState({...l.state,modalOpen:!0})},...e,children:(0,G.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),c&&(0,G.jsx)(Ue().m,{store:t,isSmall:!0})]}),(0,G.jsx)(k().A,{placeholder:o.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i,onChange:e=>{g().A.setState({...g().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Oe().q)(n.searchIcon),showClearButton:!0,format:k().C.Small})]})}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var Ke=()=>n(467730),ze=()=>n(187174),We=()=>n(645873),He=()=>n(106628),Ge=()=>n(134217),Ye=()=>n(96689),qe=()=>n(695608),Qe=()=>n(34293),$e=()=>n(173783),Ze=()=>n(614505),Je=()=>n(453697),Xe=()=>n(820635),et=()=>n(646736),tt=()=>n(605402),nt=(n(16280),()=>n(831310)),ot=()=>n(901389),it=()=>n(802790),at=()=>n(47373),rt=()=>n(176983),st=()=>n(463830),lt=()=>n(700250),dt=()=>n(10984),ct=()=>n(597898),ut=()=>n(308228),pt=()=>n(418426),mt=(n(737550),()=>n(854150)),gt=()=>n(468006),ft=()=>n(912913),ht=()=>n(731320);function yt(e){const{teamStore:t,memberInfo:n,permissionItem:l,memberName:d,style:c,onMenuItemClicked:u,isPermissionOverridden:p}=e,m=(0,i().v3)(),g=(0,s().tz)(),f=(0,o.useMemo)((()=>new(st().A)),[]),y=(0,a().K8)((()=>t.getTeamPermission()),[t]),v=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),b=(0,a().K8)((()=>!("enterprise"===(null==v?void 0:v.getSubscriptionTier()))&&!p),[v,p]),x=(0,O().R)(t),S=b||!x,M=(0,a().K8)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),n=(0,G.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(o){const i=(null==y?void 0:y.role)===o?n:void 0;return(0,ae().or)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:o})?{role:o,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:i}:{role:o,tag:i}}))}),[y,g,t]);const A=(0,r().IS)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor},roleSelectButton:{marginRight:0,fontSize:12,color:e.mediumTextColor,visibility:p?void 0:"hidden"},disabledItem:{...c,color:e.lightTextColor}})),[c,p]),C=(0,G.jsxs)("div",{style:A.overrideTitle,children:[(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),b?(0,G.jsx)(te().A,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,G.jsx)(ft().Ay,{role:"owner"===n.type?"none":l.role,table:mt().yK,type:"user"===n.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===n.entity_type?"user_permission_item":"group_permission_item",disabled:S,buttonStyle:A.roleSelectButton,availableRoleItems:M,header:(0,G.jsx)(P().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,G.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){ot().ui({message:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:d,role:(0,ht().qZ)(e).toLowerCase()}}),description:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:ot().zw,items:[{label:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:o}=w().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:m,canUndo:!0,perform:o=>{R().b4({memberInfo:n,teamStore:t,transaction:o,environment:m,permissionRole:e})}});await o,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,gt().Q6)(e,n)))||await R().Zd({environment:m,teamStore:t,teamMemberInfos:[n],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:f,placementToOrigin:lt().UV.Right,alignmentToOrigin:lt().MY.End})]});return(0,G.jsx)(T().A,{placement:S?L().W.Right:L().W.Left,textWrap:!0,renderTooltip:()=>S&&!x?(0,G.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,G.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,G.jsx)(me().A,{...e,focused:!1,disabled:S,style:S?A.disabledItem:c,textWrapperStyle:{marginRight:0},onClick:()=>f.setState({open:!0}),title:C,icon:p?(0,G.jsx)("div",{style:{marginTop:8},children:(0,nt().o)({width:14})}):void 0})})}function vt(e){let{teamStore:t,memberInfo:n,permissionItem:o,memberName:r,isPermissionOverridden:l,disabled:c}=e;const u=(0,a().uB)(void 0,st().A),p=(0,i().v3)(),g=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),f=(0,a().K8)((()=>h().default.state.currentUserStore),[]),y=(0,a().K8)((()=>{const e=null==f?void 0:f.userId;return"user"===n.entity_type&&n.user_id===e}),[null==f?void 0:f.userId,n]),v=()=>u.setState({...u.state,open:!1}),b=(0,O().R)(t),x=(0,ct().P9)({name:"team_self_promotion",spaceId:null==g?void 0:g.id,userId:null==f?void 0:f.userId}),S=(0,a().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),M=(0,a().K8)((()=>{const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return e.length+n.length}),[t]),A=(0,pt().$)(t),C=0===M,j=async e=>{v();const o="owner"===e?(0,G.jsx)(s().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,G.jsx)(s().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type||"group"===n.entity_type){const e=async()=>{const{serverCommitResult:e}=w().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:e=>{R().D6({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e},o=async()=>{await R().z9({environment:p,teamStore:t,currentSpaceStore:g,from:"team_settings_members",action:"upgradeToOwner"})};C&&y?ot().ui({message:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:ot().zw,items:[{label:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await e()}}]}):y&&x&&S?await o():await e()}}else y&&b?ot().ui({message:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:ot().zw,items:[{label:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:k}]}):await k();else{const i=(0,m().p2)(n.user_id).length;ot().ui({message:(0,G.jsx)(G.Fragment,{children:i>1?(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:o,numberOfOtherTeams:i-1}}):(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:o}})}),showCancel:!0,keepFocus:!1,handleCancel:ot().zw,items:[{label:(0,G.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(g){const{serverCommitResult:o}=w().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:o=>{R().Nd({environment:p,userId:n.user_id,teamStore:t,transaction:o,spaceStore:g,newTeamRole:e})}});await o}}}]})}},k=async()=>{if("owner"!==n.type||"user"!==n.entity_type&&"group"!==n.entity_type){if("member"===n.type){const{serverCommitResult:e}=w().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{R().P8({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e}}else{const{serverCommitResult:e}=w().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{R().qS({memberInfo:n,teamStore:t,transaction:e,environment:p})}});await e}},I=async()=>{var e;const{entity_type:o}=n;switch(v(),o){case"group":const i=null===(e=tt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===e?void 0:e.group;if(!i)throw new Error("Permission group not found in space.");R().BQ({environment:p,teamStore:t,group:i});break;case"user":await R().fy({environment:p,teamStore:t,userId:n.user_id,from:"team_settings_member_table",userGroupsInTeam:A});break;default:(0,d().HB)(o)}};return(0,G.jsx)(ge().Ay,{buttonPopupStore:u,placementToOrigin:lt().UV.Bottom,renderOrigin:e=>(0,G.jsx)(xt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:o,memberInfo:n,disabled:c}),render:()=>(0,G.jsx)(bt,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:o,memberName:r,numberOfOwners:M,isMemberCurrentUser:y,onMenuItemClicked:j,onRemoveClicked:I,onSubMenuItemClicked:v}),popupType:ge().z7.Popup})}function bt(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:o,permissionItem:i,memberName:s,numberOfOwners:d,isMemberCurrentUser:u,onRemoveClicked:m,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const y=(0,a().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,at().Qd)()}),[]),v=(0,a().K8)((()=>t.isDefault()),[t]),b=(0,rt().J)(),x=(0,a().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,dt().OX)())}),[]),S=(0,O().R)(t),M=(0,Fe().X)(t),A=1===d,C=0===d,w=(0,r().IS)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:c().Wy.regular}}}),[]),j=(e,t,n)=>(0,ut().W)({isCurrentUserTeamOwner:S,role:e,isDefaultTeam:v,userIsSpaceAdmin:Boolean(b),userIsEnterpriseWorkspaceOwner:x,originalTeamMemberInfo:t,onlyHasOneOwner:A,isUnowned:C,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:n}),k=(e,t)=>{const{isDisabled:o,disabledReason:i}=j(e,t,M);return{key:e,action:()=>g(e),render:a=>{const r=!n&&t.type===e;return(0,G.jsx)(T().A,{disableTooltip:!o,placement:L().W.Right,textWrap:!0,renderTooltip:()=>i,render:t=>(0,G.jsx)("span",{...t,children:(0,G.jsx)(me().A,{...a,style:r?w.menuItem:w.indentedMenuItem,disabled:o,disabledFeedback:o,title:(0,G.jsx)(St,{type:e}),caption:At(e),shouldWrapCaption:!0,icon:r?(0,nt().o)({width:14}):void 0})})})}}},I=v&&"user"===o.entity_type,P="group"!==o.entity_type&&y,_=[{key:"teamRoles",items:l().oE([k("owner",o),k("member",o),P?k("team_level_guest",o):void 0,Ct({onRemoveClicked:m,styles:w,...j("none",o,M),isMemberInDefaultTeam:I}),..."owner"===o.type||C?[]:[{key:"divider",action:()=>{},render:()=>(0,G.jsx)(it().A,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,G.jsx)("span",{...e,children:(0,G.jsx)(yt,{teamStore:t,memberInfo:o,permissionItem:i,memberName:s,onMenuItemClicked:f,isPermissionOverridden:n,style:n?w.menuItem:w.indentedMenuItem})})}]]),render:e=>(0,G.jsx)(ye().A,{...e,topBorder:0!==e.index})}];return(0,G.jsx)(fe().A,{className:p().yw8,menuType:be().gu.Popup,children:(0,G.jsx)(he().Ay,{type:he().Oh.Vertical,initialFocus:void 0,sections:_})})}function xt(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:o,permissionItem:i,memberInfo:a}=e;const l=(0,r().IS)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:c().Wy.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:c().Wy.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d().HB)(e)}}(n);return Mt(e)}(a.type,o,i.role);return(0,G.jsxs)(J().p,{disabled:n,...t,children:[o&&(0,G.jsxs)("span",{style:l.overrideLabel,children:[(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,G.jsx)("span",{style:l.label,children:u}),!n&&(0,oe().b)(l.chevron)]})}function St(e){let{type:t}=e;const n=Mt(t);return(0,G.jsx)("div",{children:(0,G.jsx)("span",{children:n})})}function Mt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(s().sA,{...m().Y7[e].label});case"none":return;default:(0,d().HB)(e)}}function At(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(s().sA,{...m().Y7[e].caption});case"none":return;default:(0,d().HB)(e)}}function Ct(e){let{styles:t,isDisabled:n,disabledReason:o,onRemoveClicked:i,isMemberInDefaultTeam:a}=e;return{key:"remove",action:i,render:e=>(0,G.jsx)(T().A,{disableTooltip:!n,placement:L().W.Right,textWrap:!1,renderTooltip:()=>o,render:o=>(0,G.jsx)("span",{...o,children:(0,G.jsx)(me().A,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:n,disabledFeedback:!0,title:(0,G.jsx)(s().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var wt=()=>n(265665);function jt(e){const{icon:t,label:n,name:o,tag:i,style:a}=e,s=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...a},labelContainer:{display:"flex",flexDirection:"column",...c().RC,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[a]);return(0,G.jsxs)("div",{style:s.container,children:[t,(0,G.jsxs)("div",{style:s.labelContainer,children:[(0,G.jsxs)("div",{style:s.nameContainer,children:[(0,G.jsx)(wt().j,{style:s.name,children:o}),i]}),n&&(0,G.jsx)(P().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,G.jsx)(wt().j,{children:n})})]})]})}function kt(e){const{iconComponent:t,label:n,name:o,permissionRoleSelectComponent:i,tag:a,tooltip:s,style:l}=e,d=(0,r().IS)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,G.jsxs)("div",{style:d.permissionRow,children:[(0,G.jsx)(jt,{icon:t,name:o,tag:a,label:n,style:{minWidth:200,marginRight:6}}),(0,G.jsx)(T().A,{textWrap:!0,style:{width:210},disableTooltip:!s,placement:L().W.Left,renderTooltip:()=>s,render:e=>(0,G.jsx)("span",{...e,children:i})})]})}function It(e){const{type:t,store:n,permissionItem:o,memberInfo:l}=e,c=(0,i().v3)(),u=(0,s().tz)(),p="group"===t?e.permissionGroup:void 0,g="user"===t?e.userStore:void 0,f=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),y=(0,a().K8)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,et().sE)(f,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d().HB)(t)}}),[t,l,f]),v=(0,O().R)(n),b=(0,Fe().X)(n),x=(0,a().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,a().K8)((()=>{const e=c.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=f&&f.isDefined()&&n.isDefined()&&t&&e)&&(0,m().zC)({environment:c,teamStore:n,spaceStore:f})}),[c,f,n]),M=(0,a().K8)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return!!e.find((e=>(0,ie().Ds)(e)&&e.group_id===l.group_id));case"user":return!!e.find((e=>(0,ie().B2)(e)&&e.user_id===l.user_id));default:return!1}}),[l,n]),{name:A,label:C,icon:w,isSelfUserPermission:j}=(0,a().K8)((()=>{const e=c.currentUser.id;switch(t){case"group":return Pt({permissionGroup:p,spaceId:null==f?void 0:f.id});case"user":return function(e){var t;let{intl:n,userStore:o,currentUserId:i}=e;const a=void 0!==i&&(null==o||null===(t=o.getModel())||void 0===t?void 0:t.id)===i;return{name:(0,qe().c6)(n,null==o?void 0:o.getModel()),label:null==o?void 0:o.getEmail(),icon:(0,G.jsx)(Je().A,{avatarShouldShowShadow:!0,userStore:o,size:32}),isSelfUserPermission:a}}({intl:u,userStore:g,currentUserId:e});default:(0,d().HB)(t)}}),[c.currentUser.id,t,p,null==f?void 0:f.id,u,g]),k=(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,G.jsx)(vt,{teamStore:n,memberInfo:l,memberName:A,permissionItem:o,isPermissionOverridden:M,disabled:b&&"member"===l.type?!v&&M:!v&&!S||"team_level_guest"===l.type&&!x})}),I=(0,r().IS)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17},titleYouIndicator:{color:e.mediumTextColor}})),[]),T=(0,G.jsxs)("div",{style:{display:"flex",gap:4},children:[A,j&&(0,G.jsx)("span",{style:I.titleYouIndicator,children:(0,G.jsx)(s().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})})]});return(0,G.jsx)(kt,{style:I.row,tag:(0,ie().EH)(y)?(0,G.jsx)(Qe().A,{desktopStyle:I.pill,mobileStyle:I.pill,role:Tt(y)}):"group"===t?(0,G.jsx)("div",{style:I.pill,children:w}):void 0,permissionRoleSelectComponent:k,iconComponent:"group"===t?(0,G.jsx)($e().A,{size:32}):w,name:T,label:C})}function Tt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d().HB)(e)}}function Pt(e){var t;let{spaceId:n,permissionGroup:o}=e;const{name:i,icon:a}=o,r=(null===(t=tt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===o.group_id)))||void 0===t?void 0:t.memberCount)??0;return{name:i||(0,G.jsx)(s().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,G.jsx)(T().A,{placement:L().W.Bottom,alignment:L().C.Start,disableTooltip:0===r,renderTooltip:()=>(0,G.jsx)(Xe().Q,{group:o,limit:10,noMembersMessage:void 0}),render:e=>(0,G.jsxs)("div",{...e,children:[(0,G.jsx)(s().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,G.jsx)(s().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:r}})]})}),icon:a&&(0,G.jsx)(Ze().A,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:a&&n?{icon:a,pointer:{table:Ye().NX,id:n}}:void 0}),isSelfUserPermission:!1}}var _t=()=>n(689094),Bt=()=>n(224701);function Lt(e){let{teamStore:t,...n}=e;const l=(0,i().v3)(),d=(0,a().K8)((()=>{var e;return null===(e=h().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,s().tz)(),u=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),p=(0,o.useCallback)((e=>{C().D6({label:(0,G.jsx)(s().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),m=(0,o.useCallback)((async(e,n)=>{await R().Zd({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Bt().Ow(l):p(n)}),[l,p,t]),g=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"user",user_id:e.id},t)),[m]),f=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"group",group_id:e.group_id},t)),[m]),y=(0,a().K8)((()=>{if("groupToAdd"in n)return Pt({spaceId:d,permissionGroup:n.groupToAdd})}),[d,n]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,qe().c6)(c,e);return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(jt,{icon:(0,G.jsx)(Je().A,{userValue:e,size:32}),name:t,label:e.email}),Rt((()=>{g(e,t)}))]})}{if(!d||!y)return(0,G.jsx)(G.Fragment,{});const{groupToAdd:e}=n;return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(jt,{icon:(0,G.jsx)($e().A,{size:32}),name:y.name,label:y.label,tag:(0,G.jsx)("div",{style:u.pill,children:y.icon})}),Rt((()=>{f(e,y.name)}))]})}}function Rt(e){return(0,G.jsx)(J().p,{isBlue:!0,onClick:e,icon:_t().W,children:(0,G.jsx)(s().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Dt=()=>n(158359),Ot=()=>n(498474);function Nt(e){let{sortType:t,onChangeSortType:n}=e;const o=(0,r().IS)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",a=e=>{const o=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:o})};return(0,G.jsxs)("div",{style:o.container,children:[(0,G.jsx)(Et,{title:(0,G.jsx)(s().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>a("name")}),(0,G.jsx)(Et,{title:(0,G.jsx)(s().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>a("role")})]})}function Et(e){let{sortedType:t,title:n,onClick:o}=e;const i=(0,r().IS)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,G.jsxs)(J().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:o,children:["ascending"===t&&(0,Ot().q)(i.sortIcon),"descending"===t&&(0,Dt().P)(i.sortIcon),n]})}function Ft(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,r().IS)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:c().J.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),u=(0,s().tz)(),[p,f]=(0,o.useState)({column:"role",sortedAscending:!1}),y=(0,Fe().X)(t),v=(0,a().K8)((()=>t.getMemberInfoUsingSpaceMembers((0,Ge().L)())??[]),[t]),b=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),x=(0,a().K8)((()=>h().default.state.currentUserStore),[]),{permissionRowInfos:S,numNotShown:M}=(0,a().K8)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:n,intl:o}=e;if(""===n)return t;return(0,Ke().Ay)(n,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name||"";case"user":const{userStore:n}=e;return n.getSearchName(o);default:(0,d().HB)(t)}}))}({permissionRowInfos:(0,m().JS)({currentUserStore:x,currentSpaceStore:b,teamStore:t,members:v}),memberFilterQuery:g().A.state.memberFilterQuery,intl:u}),n=function(e){let{permissionRowInfos:t,sortType:n,intl:o}=e;const{column:i,sortedAscending:a}=n,r={permissionRowInfos:t,sortedAscending:a};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n}=e;const o=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const n=e.memberInfo.entity_type,o=t.memberInfo.entity_type;return i.indexOf(n)-i.indexOf(o)})).sort(((e,t)=>{const i=e.memberInfo.type,a=t.memberInfo.type,r=o.indexOf(i)-o.indexOf(a);return n?-r:r}))}(r);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n,intl:o}=e;return[...t].sort(((e,t)=>{const i=Ut(e,o)??"",a=Ut(t,o)??"";if(i===a)return 0;const r=i<a?-1:1;return n?-r:r}))}({...r,intl:o});(0,d().HB)(i)}({permissionRowInfos:e,sortType:p,intl:u}),o=g().A.state.limitMembers?n.slice(0,50):n;return{permissionRowInfos:o,numNotShown:e.length-o.length}}),[b,x,v,t,p,u]),A=(0,We().fJ)(He().T.searchActions),C=(0,a().K8)((()=>g().A.state.memberFilterQuery),[]),[w]=(0,ze().Yb)((async()=>{if(!y||null==C||!C.trim().length||"resolved"!==A.status)return[];const e=A.value;return[...(await e.searchVisibleSpaceUsers({environment:n,query:C,membersOnly:!0})).map((e=>({type:"user",value:e}))),...e.searchSpaceGroups({query:C,intl:u}).map((e=>({type:"group",value:e})))]}),[y,C,A.status,A.value,n,u]),j=(0,a().K8)((()=>{if("resolved"!==w.status)return[];const e=new Set(S.map(Kt));return w.value.filter((t=>!e.has("user"===t.type?t.value.id:t.value.group_id))).slice(0,5)}),[w.status,w.value,S]),k=Boolean(null==C?void 0:C.trim().length),I=S.length>0;return(0,G.jsxs)("div",{style:l.container,children:[(0,G.jsx)(Vt,{title:k?(0,G.jsx)(s().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,G.jsx)(Nt,{sortType:p,onChangeSortType:f}),rows:S,renderRow:e=>(0,G.jsx)(It,{store:t,...e})}),M>0&&(0,G.jsx)(J().p,{isGray:!0,size:"xs",style:l.showMore,onClick:()=>{g().A.update((e=>({...e,limitMembers:!1})))},children:(0,G.jsx)(s().sA,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:M}})}),j.length>0&&(0,G.jsx)(Vt,{title:(0,G.jsx)(s().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:j,renderRow:e=>"user"===e.type?(0,G.jsx)(Lt,{teamStore:t,memberToAdd:e.value}):(0,G.jsx)(Lt,{teamStore:t,groupToAdd:e.value})}),!I&&0===j.length&&(0,G.jsx)("div",{style:l.noResult,children:(0,G.jsx)(s().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Ut(e,t){const{type:n}=e;if("user"===n){const{userStore:n}=e;return n.getDisplayName(t)}if("group"===n){const{permissionGroup:t}=e;return t.name}(0,d().HB)(n)}function Vt(e){let{rows:t,renderRow:n,title:i}=e;const a=(0,r().IS)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,G.jsxs)(G.Fragment,{children:[i&&(0,G.jsx)(P().A,{isSmall:!0,children:i}),(0,G.jsx)("div",{style:a.membersList,children:t.map(((e,t)=>(0,G.jsxs)(o.Fragment,{children:[t>0&&(0,G.jsx)("div",{style:a.memberDivider}),n(e)]},t)))})]}):null}function Kt(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d().HB)(e)}}function zt(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,G.jsxs)("div",{style:n.content,children:[(0,G.jsx)(Ve,{teamStore:t}),(0,G.jsx)(Ft,{store:t})]})}var Wt=()=>n(278238);function Ht(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().tz)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,a().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=N(t),u=(0,a().K8)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:o.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[o]),p=(0,r().IS)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),m=l&&(0,G.jsx)(ft().Ay,{role:l.role,table:mt().yK,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:p.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,ie().B2)(t)||(0,ie().Ds)(t))&&(0,ae().dI)(e,t.role))).length>0){if(!(await(0,B().fT)()))return}w().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{R().HU({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:[]})}})}}),g=(0,a().K8)((()=>t.getName()),[t]),f=(0,a().K8)((()=>t.getIcon()),[t]),h=f&&Wt().T8(f.icon)?Wt().VA(f.icon):"gray",y=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,v=(0,G.jsx)(K().x,{disabled:!0,store:t,size:z().QT,icon:y});return m?(0,G.jsx)(kt,{permissionRoleSelectComponent:m,iconComponent:v,name:Gt(g)}):null}function Gt(e){return e?(0,G.jsx)(s().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(s().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Yt(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().DP)(),l=(0,s().tz)(),{teamPermissionItem:d,teamPermissions:c}=(0,a().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=N(t),p=(0,a().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),o=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,ae().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:o}}:{role:e,disabledInfo:void 0}}return[i("editor"),i("read_and_write"),i("comment_only"),i("reader")]}),[l,t]),m=d&&(0,G.jsx)(ft().Ay,{role:d.role,table:mt().yK,type:(0,ie().gl)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:o.mediumTextColor},availableRoleItems:p,onChange:async e=>{const o=c.filter((t=>((0,ie().B2)(t)||(0,ie().Ds)(t))&&(0,ae().dI)(e,t.role)));if(o.length>0){if(!(await(0,B().fT)()))return}w().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{R().xp({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:o})}})}}),{teamName:g}=(0,a().K8)((()=>({teamName:t.getName()})),[t]),f=(0,G.jsx)(K().x,{disabled:!0,store:t,size:z().QT});return(0,G.jsx)(kt,{permissionRoleSelectComponent:m,iconComponent:f,name:qt(g)})}function qt(e){return e?(0,G.jsx)(s().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(s().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Qt=()=>n(798880),$t=()=>n(482705);function Zt(e){const{teamStore:t,teamOwnerIds:n}=e,o=(0,r().DP)(),i=(0,a().K8)((()=>t.getName()),[t]),l=(0,a().K8)((()=>t.getTeamOwnerPermission()),[t]),d=(0,a().K8)((()=>h().default.state.currentUserStore),[]),c=(0,a().K8)((()=>d?n.map((e=>y().LU.createChildStore(d,{table:Qt().oo,id:e}))):[]),[d,n]);return(0,G.jsx)(kt,{tooltip:(0,G.jsx)(s().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,G.jsx)(ft().Ay,{role:"editor",table:mt().yK,type:l&&(0,ie().nl)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:o.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,G.jsx)($t().l,{teamStore:t,ownerStores:c,isSmall:!0}),name:Jt(i)})}function Jt(e){return e?(0,G.jsx)(s().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,G.jsx)(s().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Xt=()=>n(449552),en=()=>n(579627);function tn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),{iconComponent:r,spaceName:s}=(0,a().K8)((()=>{if(!o)return{iconComponent:void 0,spaceName:void 0};const e=(0,W().GK)(n,o);return{iconComponent:(0,G.jsx)(K().x,{disabled:!0,store:o,size:z().QT}),spaceName:e}}),[o,n]);return(0,G.jsx)(kt,{permissionRoleSelectComponent:(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,G.jsx)(on,{teamStore:t})}),iconComponent:r,name:nn(s)})}function nn(e){return e?(0,G.jsx)(s().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,G.jsx)(s().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function on(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().DP)(),d=(0,a().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=N(t),u=(0,a().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ce({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const p=u.permissionItemRoleOptions.spacePermission;if(1===p.length&&"none"===p[0])return(0,G.jsx)(T().A,{renderTooltip:()=>(0,G.jsx)(s().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Xt().g)({width:14,height:14,fill:o.timelineRed,marginRight:4}),(0,G.jsx)("div",{style:{fontSize:12.5,color:o.timelineRed,marginRight:8},children:(0,G.jsx)(s().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l().Ul(p,(e=>-ie().TE[e])).map((e=>({role:e})));return(0,G.jsx)(ft().Ay,{role:d.role,table:mt().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===p.length,buttonStyle:{fontSize:12.5,marginRight:0,color:o.mediumTextColor},availableRoleItems:e,onChange:e=>{const o={...d,role:e};w().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{en().bo({environment:n,store:t,permissionItems:[o],transaction:e})}})}})}}function an(e){let{teamStore:t}=e;const n=(0,a().K8)((()=>t.isDefault()),[t]),o=(0,a().K8)((()=>t.getOwnerUserIds()),[t]),i=(0,a().K8)((()=>{const e=h().default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,at().Qd)())}),[n]),s=(0,r().IS)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,G.jsxs)("div",{style:s.container,children:[(0,G.jsx)(Zt,{teamStore:t,teamOwnerIds:o},"0"),(0,G.jsx)(Yt,{teamStore:t},"1"),i&&(0,G.jsx)(Ht,{teamStore:t},"2"),!n&&(0,G.jsx)(tn,{teamStore:t},"3")]})}var rn=()=>n(838156);function sn(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(ln,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(rn().a,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,G.jsx)(zt,{teamStore:t})]})}function ln(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,a().K8)((()=>t.getName()),[t]),d=(0,r().IS)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,o.useCallback)(((e,o)=>{R().qH({environment:n,accessLevel:e,isDefault:o,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,a().K8)((()=>t.getTeamAccessLevel()),[t]),p=[(0,G.jsx)(H().u,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,G.jsx)(an,{teamStore:t},"permissions")];return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(z().BA,{title:(0,G.jsx)(s().sA,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:p,itemStyle:d.teamSettingsListItems}),(0,G.jsx)(V().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,G.jsx)(s().sA,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var dn=()=>n(192940),cn=()=>n(545805),un=()=>n(957986),pn=()=>n(16006),mn=()=>n(2143),gn=()=>n(994006),fn=()=>n(101919),hn=()=>n(987017),yn=()=>n(824160);function vn(e){return(0,G.jsx)(yn().A,{...e,children:(0,G.jsx)(s().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function bn(e){const{teamStore:t}=e,n=(0,a().K8)((()=>g().A.state.tab),[]);if(void 0===n)return null;switch(n){case g().p.General:return(0,G.jsx)(Be,{teamStore:t});case g().p.Members:return(0,G.jsx)(sn,{teamStore:t});case g().p.Security:return(0,G.jsx)(je,{teamStore:t});default:(0,d().HB)(n)}}function xn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:o,isDefined:i}=(0,a().K8)((()=>{const e=y().LU.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,G.jsx)(gn().A,{avatarShouldShowShadow:!0,userStore:o,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function Sn(e){const{userIds:t,label:n,hasMarginTop:o}=e,i=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]);return i?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(fn().A,{hasMarginTop:o,children:n}),t.map((e=>(0,G.jsx)(xn,{userId:e,currentSpaceStore:i},e)))]}):null}function Mn(){const e=(0,i().v3)(),t=(0,a().K8)((()=>h().default.state.currentSpaceStore),[]),n=(0,a().K8)((()=>h().default.state.currentSpaceViewStore),[]),o=(0,i().Y0)(),y=(0,r().IS)((e=>({modal:{width:o.isMobile?"auto":630,height:o.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c().Wy.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:c().Wy.regular,textTransform:"unset",fontSize:11}})),[o.isMobile]),{open:v,tab:S,teamStore:M}=(0,a().K8)((()=>{const{open:e,tab:t}=g().A.state;return{open:e,tab:t,teamStore:g().A.getTeamStore()}}),[]),A=(0,a().K8)((()=>null==M?void 0:M.getSettings()),[M]),C=(0,O().R)(M);if(!t||!n||!M)return null;const w=[g().p.General,g().p.Members,g().p.Security];return(0,G.jsx)(un().A,{open:v,innerStyle:y.modal,onDismiss:()=>{g().A.reset()},render:()=>v?(0,G.jsx)("div",{className:p().kYU,style:{height:"100%"},children:(0,G.jsx)("div",{style:y.modalWrap,children:(0,G.jsx)(cn().A,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l().D_,onLeft:l().D_,onRight:l().D_,onSelectAll:l().D_,onRedo:l().D_,onUndo:l().D_,onCut:l().D_,onCopy:l().D_,onPaste:l().D_,onKeypress:l().D_,onDelete:l().D_,onTab:l().D_,children:(0,G.jsxs)("div",{style:y.innerWrap,children:[(0,G.jsxs)("div",{style:y.header,children:[(0,G.jsx)(K().x,{disabled:!0,store:M,size:24,style:y.icon}),(0,G.jsx)(pn().A,{store:M,style:{fontSize:16,fontWeight:c().Wy.semibold}}),(0,m().tM)(A)&&(0,G.jsx)(x().A,{iconStyle:y.lockIcon}),(0,m().A2)({membership:M.getRawMembership()})&&(0,G.jsx)("div",{style:{gap:5,display:"flex"},children:(0,G.jsx)(vn,{desktopStyle:y.unownedPill,mobileStyle:y.unownedPill,innerStyle:y.unownedPillInner})}),(0,G.jsx)("div",{style:{flexGrow:1}}),(0,G.jsx)(b().z,{teamStore:M,onLeavingTeam:()=>g().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,G.jsx)(hn().Ay,{tabs:w.map((e=>function(e,t){switch(e){case g().p.General:return(0,G.jsx)(s().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g().p.Members:return(0,G.jsx)(An,{teamStore:t});case g().p.Security:return(0,G.jsx)(s().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d().HB)(e)}}(e,M))),selectedIndex:(0,d().O9)(S)?w.indexOf(S):1,onChange:t=>{v&&(u().Vg(e,{store:M,tab_old_value:S??g().p.General,tab_new_value:w[t]}),g().A.update((e=>e.open?{...e,tab:w[t]}:e)))},tabStyle:{marginLeft:-8},style:y.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,G.jsx)(mn().H,{type:f().A.Y,style:y.scroller,children:(0,G.jsx)("div",{style:y.contentWrap,children:(0,G.jsx)(bn,{currentSpaceStore:t,teamStore:M,userIsTeamOwner:C})})})]})})})}):null})}function An(e){let{teamStore:t}=e;const n=(0,dn().h)(t),o=(0,r().DP)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(s().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,G.jsx)("span",{children:" "}),(0,G.jsx)("div",{style:{color:o.lightTextColor},children:n})]})}function Cn(e){let{title:t,caption:n,secondCaption:o,on:a,disabled:s,tooltip:l,style:d,switcherStyle:c,onChange:u,shouldTriggerUpsell:p,upsellTier:m,isLocked:g,lockedTooltip:f}=e;const h=(0,i().v3)(),y=(0,r().IS)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:p?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18,...c}})),[p,d,c]);return(0,G.jsxs)("div",{style:y.root,onClick:()=>{if(p)return v().K(h,{from:"team_security_settings",upsell:{type:"product",product:m,limit:{type:"none"}},dontOpenPlansOnCancel:!0})},children:[(0,G.jsxs)("div",{style:y.title,children:[t,n&&(0,G.jsx)(P().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),o&&(0,G.jsx)(P().A,{isSmall:!0,children:o})]}),(0,G.jsx)("div",{style:y.switcherWrap,children:(0,G.jsx)(T().A,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)("div",{...e,children:(0,G.jsx)(ve().A,{on:a,disabled:s,onClick:u,isLocked:g,lockedTooltip:f})})})})]})}},315841:(e,t,n)=>{n.d(t,{Js:()=>r,Ns:()=>i,d:()=>a});var o=()=>n(645873);const i={publishSite:new(o().O2)("PublishSite",(async()=>await Promise.all([n.e(9304),n.e(81141),n.e(72915),n.e(69689),n.e(16345)]).then(n.bind(n,791328)))),publishedSiteSettings:new(o().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(9304),n.e(37353),n.e(55373),n.e(29151),n.e(16908),n.e(48315),n.e(847),n.e(5887),n.e(21627),n.e(82472),n.e(96345),n.e(75659),n.e(47858),n.e(81141),n.e(65638),n.e(72915),n.e(69689),n.e(2409),n.e(39301)]).then(n.bind(n,69857))))},a=(0,o()._h)(i.publishedSiteSettings,(e=>e.default)),r=(0,o()._h)(i.publishSite,(e=>e.default))},323063:(e,t,n)=>{n.d(t,{HO:()=>p,V5:()=>s,Vr:()=>l,gL:()=>d,qq:()=>u,vH:()=>c,z2:()=>m});n(16280),n(898992),n(354520),n(672577),n(581454),n(737550);var o=()=>n(720665),i=()=>n(762433),a=()=>n(47273),r=()=>n(979340);function s(e,t){return p(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=i().xp(e),o=i().xp(t);if(!n||!o)return!1;return r().o3[n]>r().o3[o]}(t,n)}))}function l(e,t,n){let{trialEnd:o,items:i}=t;const a=i.map((t=>{const o=t.price.product,i=t.price.unitAmount.currencyCode,a=function(e,t){let{interval:n,product:o,currency:i}=t;const a=e.find((e=>e.product===o&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===i));return g(a,`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}(e,{interval:n,product:o,currency:i});return{...t,price:a}}));return{trialEnd:o,items:a}}function d(e,t){const n=e.items.filter((e=>i().IE(e)!==t));return{...e,items:n}}function c(e,t){const n=e.items.filter((e=>i().IE(e)!==i().IE(t)));return{...e,items:n.concat([t])}}function u(e,t,n){const{product:o,interval:a,currency:r}=n,s=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(o),l=t.items.filter((e=>i().IE(e)!==i().Mr(s))),d=function(e,t){let{interval:n,product:o,currency:i}=t;const a=e.find((e=>e.price.product===o&&e.price.billingInterval===n&&e.price.unitAmount.currencyValue.currencyCode===i));return g(a,`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}(e,{interval:a,product:s,currency:r});return{...t,items:l.concat([d])}}function p(e,t){return(0,o().Z4)(e,(e=>i().IE(e)),t,(e=>i().IE(e)))}function m(e){const{prices:t,billingData:n,product:o}=e,r=i().Ry(n),s=i().lQ(n),l=a().yw(s),d=i().q8(n),c=l??d;return t.find((e=>e.product===o&&e.billingInterval===c&&e.unitAmount.currencyValue.currencyCode===r))}function g(e,t){if(null==e)throw new Error(t);return e}},324587:(e,t,n)=>{n.r(t),n.d(t,{addAutomationAction:()=>F,clearInvalidVariables:()=>H,createAutomation:()=>E,deleteAutomation:()=>Z,disableAutomation:()=>$,duplicateAutomation:()=>V,duplicateAutomationAction:()=>K,enableAutomation:()=>Q,insertEmptyTextInDuplicateBlockAction:()=>q,messages:()=>N,removeAutomationAction:()=>W,reorderAutomationActions:()=>z,restartAutomation:()=>U});n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(803949),n(581454);var o=n.n(n(794148)),i=()=>n(244641),a=()=>n(908006),r=()=>n(422540),s=()=>n(890409),l=()=>n(192845),d=()=>n(390527),c=()=>n(925551),u=()=>n(247331),p=()=>n(134025),m=()=>n(696706),g=()=>n(912720),f=()=>n(199378),h=()=>n(161479),y=()=>n(919709),v=()=>n(496603),b=()=>n(183558),x=()=>n(973647),S=()=>n(534177),M=()=>n(722101),A=()=>n(44729),C=()=>n(246826),w=()=>n(725614),j=()=>n(317909),k=()=>n(780054),I=()=>n(71584),T=()=>n(989423),P=()=>n(909470),_=()=>n(594794),B=()=>n(695625),L=()=>n(546461),R=()=>n(301782),D=()=>n(770586),O=()=>n(190019);const N=(0,n(959013).YK)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorRecordInTrash:{id:"automations.buttonTrigger.errorRecordInTrash",defaultMessage:"Button is editing a page in trash"}});function E(e){const{actionIds:t,automationId:n,automationName:i,environment:a,inMemoryRecordCache:r,parentPointer:s,transaction:l,trigger:d}=e,c=n??(0,_().Z1)({environment:a,table:g().yB,spaceId:s.spaceId}),u=C().eC({environment:a,inMemoryRecordCache:r??a.defaultRecordCache.inMemoryRecordCache,table:g().yB,transaction:l,value:{action_ids:t,alive:!0,id:c,parent_id:s.id,parent_table:s.table,properties:{name:i},space_id:s.spaceId,status:"active",trigger:d}});return o()(u.isTriggerType(d.type),"Trigger type mismatch"),u}function F(e){const{actionId:t,environment:n,intl:i,automationStore:r,actionType:l,transaction:d,insertionPoint:c,config:u,createDuplicateBlocksContainer:p=!0,builderType:h="sidebar"}=e,v=r.getSpaceId();if(!v)return;let x;if("duplicate_blocks"===l&&p){x=C().Wv({environment:n,inMemoryRecordCache:r.inMemoryRecordCache,transaction:d,type:"text"});const e=q({environment:n,contentStore:x.getContentStore(),transaction:d});a().default.afterNextFlush((()=>{const t=B().T.find((t=>m().L3.isEqual(t.props.store.pointer,e.pointer)));t&&w().setSelectionAtStart({store:t.props.store.getBlockTitleStore()})}))}const A=u??function(e){const{actionType:t,automationStore:n,intl:o}=e;if("modal_confirmation"===t)return{continue_button:{text:o.formatMessage(N.defaultContinueWorkflowMessage)},cancel_button:{text:o.formatMessage(N.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,y().x9d)(o.formatMessage(N.defaultConfirmationWorkflowText))}};if("define_variables"===t){const e=(0,b().Ay)();return{values:{[e]:{name:(0,D().v)(n.getActionStores(),o.formatMessage(f().xC)),value:{type:"simple",value:[[""]]}}},variableIds:[e]}}}({actionType:l,automationStore:r,intl:i})??{},j=C().eC({environment:n,inMemoryRecordCache:r.inMemoryRecordCache,table:f().SC,transaction:d,value:{id:t,type:l,parent_id:r.id,parent_table:g().yB,alive:!0,space_id:v,config:A,blocks:x?[x.id]:[]}});return x&&M().BC({transaction:d,parentStore:j.getKeyStore("blocks"),appendStore:x}),!c||"afterActionId"in c?M().BC({transaction:d,parentStore:r.getActionIdsStore(),appendStore:j,after:null==c?void 0:c.afterActionId}):"beforeActionId"in c?M().Hs({transaction:d,parentStore:r.getActionIdsStore(),prependStore:j,before:c.beforeActionId}):(0,S().HB)(c),G({transaction:d,automationStore:r}),(0,R().CM)(((e,t,o)=>{const i=(0,T().ik)(n),a=(0,R().zc)({automationActionStore:j,formulaAnalyticsModule:t,formulasModule:e,simpleFormulasModule:o});(0,S().O9)(a)&&(0,s().dW)(i,{automation_action:a,automation_action_id:j.id,automation_id:j.getParentId(),builder_type:h}),j.isDefined()&&(0,s().c_)(i,{automation_action_id:j.id,automation_action_type:j.getType(),automation_id:r.id,builder_type:h})})),o()(j.isType(l),"Action type mismatch"),j}function U(e){var t,n;const{automationStore:o,transaction:a}=e,r=o.getRecurrence();if(!r)return;const s=i().c9.now().plus({day:1}).startOf("day"),l={...r,start_date:s.toMillis(),end_condition:"date"===(null===(t=r.end_condition)||void 0===t?void 0:t.type)?{type:"date",end_at:(0,d().getNewEndTimestamp)(s,r.start_date,null===(n=r.end_condition)||void 0===n?void 0:n.end_at).toMillis()}:r.end_condition};C().zv({store:o,transaction:a,data:{status:"active"}}),C().zv({store:o.getKeyStore("trigger"),transaction:a,data:{recurrence:(0,d().convertFromUnpersistedRecurrenceConfig)(l)}})}function V(e){const{actorPointer:t,environment:n,includeParenting:o,sourceAutomationStore:i,targetAutomationId:a,transaction:r}=e,s=i.getParentStore();if(!s||!s.isReady())throw new Error("Automation parent store not ready");const l=i.getValue(),d=i.getSpaceId();if(!(0,S().O9)(l)||!(0,S().O9)(d))throw new Error("Undefined automation value or space id");const u={},p={...(0,v().mg)(l),id:a??(0,_().Z1)({environment:n,table:g().yB,spaceId:(0,h().e)(d)})};u[i.id]=p.id,(0,S().O9)(p.action_ids)&&(0,S().EI)(p.action_ids)&&p.action_ids.forEach((e=>u[e]=(0,_().Z1)({environment:n,table:f().SC,spaceId:(0,h().e)(d)})));const m=e=>{let{requested:t}=e;const n=u[t.id];return(0,S().O9)(n)?{...t,id:n}:t};(0,c().iN)({actor:t,duplicateRecord:p,options:{},mapper:m,originalRecord:l});const y=C().eC({environment:n,inMemoryRecordCache:i.inMemoryRecordCache,table:g().yB,transaction:r,value:p});o&&A().NI({childStore:y,parentStore:s,transaction:r});const b=i.getActionStores(),x=Promise.all(b.map((e=>{const t=u[e.id],{automationActionStore:o,onComplete:i}=K({environment:n,includeParenting:!1,mapper:m,sourceActionStore:e,targetAutomationActionId:t,transaction:r});return A().NI({childStore:o,parentStore:y,transaction:r}),i}))),M=x.then((e=>e.flat()));return{automationStore:y,onComplete:M}}function K(e){const{environment:t,includeParenting:n,insertionPoint:o,mapper:i,sourceActionStore:a,targetAutomationActionId:r,transaction:l}=e,d=a.getParentStore();if(!d||!d.isReady())throw new Error("Automation store is not ready");const u=a.getValue(),p=a.getSpaceId();if(!(0,S().O9)(u)||!(0,S().O9)(p))throw new Error("Undefined action value or space id");const m={...(0,v().mg)(u),id:r??(0,_().Z1)({environment:t,table:f().SC,spaceId:(0,h().e)(p)})},g=t.currentUser.id,y=a.inMemoryRecordCache.makeGetRecordRoleFn(g);(0,c().IH)({duplicateRecord:m,getRecordRole:y,originalRecord:u,mapper:e=>(null==i?void 0:i(e))??e.requested,options:{},originOptions:{baseUrl:k().A.domainBaseUrl,publicDomainName:k().A.publicDomainName},duplicateBlocks:!1});const b=C().eC({environment:t,inMemoryRecordCache:a.inMemoryRecordCache,table:f().SC,transaction:l,value:m});n&&(!o||"afterActionId"in o?A().NI({after:null==o?void 0:o.afterActionId,childStore:b,parentStore:d,transaction:l}):"beforeActionId"in o?A().Ti({before:null==o?void 0:o.beforeActionId,childStore:b,parentStore:d,transaction:l}):(0,S().HB)(o),G({transaction:l,automationStore:d}));const x=Promise.all(a.getBlockStores().map((e=>{const[n,o]=I().duplicateBlock({addCopyName:!1,baseUrl:k().A.domainBaseUrl,deepCopyTransclusionContainers:!1,environment:t,preferDuplicateLocation:"local",publicDomainName:k().A.publicDomainName,resolveTemplateVariables:!1,stores:[e],targetSpaceId:(0,h().e)(e.pointer.spaceId),transaction:l}),i=n[0];return A().NI({childStore:i,parentStore:b,transaction:l}),o}))),M=b.getModel();return(0,S().O9)(M)&&(0,R().CM)(((e,n,o)=>{const i=(0,T().ik)(t),a=(0,R().zc)({automationActionStore:b,formulaAnalyticsModule:n,formulasModule:e,simpleFormulasModule:o});(0,S().O9)(a)&&(0,s().dW)(i,{automation_action:a,automation_action_id:M.id,automation_id:M.parent_id,from:"duplicate"}),(0,s().c_)(i,{automation_action_id:M.id,automation_action_type:M.type,automation_id:d.id,from:"duplicate"})})),{automationActionStore:b,onComplete:x}}function z(e){const{environment:t,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:a,intl:r,newActionIds:s,transaction:l,from:d,movedActionId:c}=e;C().zv({store:n,transaction:l,data:{action_ids:s}}),G({automationStore:n,transaction:l});Y({automationStore:n,transaction:l,typecheckResult:(0,O().Z)({environment:t,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:a,intl:r})}),(0,T().u4)({environment:t,event:{eventName:"automation_action_move",eventProperties:{automation_id:n.id,automation_action_id:c,from:d}}})}function W(e){const{actionStore:t,automationStore:n,automationTypecheckModule:o,contextType:i,environment:a,formulasModule:r,intl:l,transaction:d}=e,c=(0,O().Z)({environment:a,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:r,intl:l});!function(e){const{automationActionStore:t,automationStore:n,environment:o,transaction:i,hasError:a=!1}=e;let r=t.getParentStore();if((0,S().O9)(n)){const e=t.getParentPointer();if(!(0,S().O9)(e))throw new Error("Automation action does not have a parent pointer");if(!m().L3.isEqual(e,n.pointer))throw new Error(`Automation action parent pointer does not match argument: ${m().L3.toKey(e)}, ${m().L3.toKey(n.pointer)}`);r=n}else if(!(0,S().O9)(r))throw new Error("Automation store is undefined");A().zz({childStore:t,parentStore:r,transaction:i});const l=t.getModel();(0,S().O9)(l)&&(0,R().CM)(((e,n,i)=>{const d=(0,T().ik)(o),c=(0,R().zc)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:e,simpleFormulasModule:i});(0,S().O9)(c)&&(0,s().YO)(d,{automation_action:c,automation_action_id:l.id,automation_id:l.parent_id,has_error:a}),(0,s().gW)(d,{automation_action_id:l.id,automation_action_type:l.type,automation_id:r.id,has_error:a})}))}({automationActionStore:t,environment:a,transaction:d,hasError:(x().Q.isSuccess(c)&&c.value.actionValidationFailures[t.id]||[]).length>0}),Y({automationStore:n,transaction:d,typecheckResult:c})}function H(e){const{environment:t,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:a,intl:r,transaction:s}=e;Y({automationStore:n,transaction:s,typecheckResult:(0,O().Z)({environment:t,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:a,intl:r})})}function G(e){const{automationStore:t,transaction:n}=e;t.getSpaceId()&&t.getActionStores().forEach(((e,t)=>{var o;if(!e.isDefined())return;const i=e.getModel();i.isType("open_page")&&"url"===(null===(o=i.getConfig())||void 0===o||null===(o=o.target)||void 0===o?void 0:o.type)&&!(0,r().cQ)(t)&&C().zv({store:e.getConfigStore(),transaction:n,data:{target:null}})}))}function Y(e){const{automationStore:t,transaction:n,typecheckResult:o}=e,i=t.getSpaceId(),a=t.getModel();if(i&&a&&!x().Q.isFail(o))for(const r of a.getActionIds()){const e=t.getRecordStore(t,{table:f().SC,id:r,spaceId:i});if(!e.isDefined())continue;const a=e.getModel(),s=new Set(o.value.actionInputValueTypes[r].map((e=>{if(e.kind===u().FormulaContextValueKind.Binding||e.kind===u().FormulaContextValueKind.ContextValue)return e.id;e.kind!==u().FormulaContextValueKind.ThisRow&&(0,S().HB)(e)})).filter(S().O9)),{value:d}=(0,l().G)({automationActionModel:a,baseUrl:k().A.domainBaseUrl,preventClearingConfig:!0,publicDomainName:k().A.publicDomainName,sourceSpaceId:i,visitors:{visitCollectionProperty:void 0,visitCollectionPropertyPointer:void 0,visitFormulaContextValue:e=>s.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormulaPageProperty:void 0,visitRecordPointer:void 0}}),c=p().op.update({pointer:e.pointer,path:["config"],args:d.getConfig()??{}});j().applyOperation({store:e,operation:c,transaction:n})}}function q(e){const{environment:t,contentStore:n,transaction:o}=e,i=C().Wv({environment:t,type:"text",inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,spaceId:n.pointer.spaceId});return M().BC({parentStore:n,appendStore:i,transaction:o}).childStore}function Q(e){const{automationStore:t,environment:n,transaction:o}=e;C().zv({store:t,data:{status:"active"},transaction:o});const i=t.getModel();(0,S().O9)(i)&&(0,R().CM)(((e,o,a)=>{const r=(0,L().To)(t);let l=[];r&&x().Q.isSuccess(r)&&(l=r.value.valueTypes);const d=(0,T().ik)(n),c=(0,s().sp)({automationModel:i,formulaAnalyticsModule:o,formulasModule:e,formulaTypecheckContextValues:l,getRecordModel:t.getRecordModel,featureGates:(0,P().i)(),simpleFormulasModule:a});(0,s().Ah)(d,c)}))}function $(e){const{automationStore:t,environment:n,status:o,transaction:i}=e,a=o??"disabled";C().zv({store:t,data:{status:a},transaction:i}),t.isTriggerType("recurrence")&&C().zv({store:t,data:{run_at:void 0},transaction:i});const r=t.getModel();(0,S().O9)(r)&&(0,R().CM)(((e,o,i)=>{const a=(0,L().To)(t);let l=[];a&&x().Q.isSuccess(a)&&(l=a.value.valueTypes);const d=(0,T().ik)(n),c=(0,s().sp)({automationModel:r,formulaAnalyticsModule:o,formulasModule:e,formulaTypecheckContextValues:l,getRecordModel:t.getRecordModel,featureGates:(0,P().i)(),simpleFormulasModule:i});(0,s().vN)(d,c)}))}function Z(e){const{automationStore:t,environment:n,transaction:o}=e;C().zv({store:t,data:{alive:!1},transaction:o});const i=t.getModel();(0,S().O9)(i)&&(0,R().CM)(((e,o,a)=>{const r=(0,L().To)(t);let l=[];r&&x().Q.isSuccess(r)&&(l=r.value.valueTypes);const d=(0,T().ik)(n),c=(0,s().sp)({automationModel:i,formulaAnalyticsModule:o,formulasModule:e,formulaTypecheckContextValues:l,getRecordModel:t.getRecordModel,featureGates:(0,P().i)(),simpleFormulasModule:a});(0,s().Iv)(d,c)}))}},338429:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(463830).A)},341974:(e,t,n)=>{n.d(t,{z:()=>v});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(284371),l=()=>n(437622),d=()=>n(37433),c=()=>n(515512),u=()=>n(211825),p=()=>n(959013),m=()=>n(493823),g=n(474848);const f=function(e){const{teamStore:t,from:r,navigateToTeamHomeOnJoin:s,style:l,hoveredStyle:d,icon:c,isRed:u}=e,f=(0,i().v3)(),h=(0,a().K8)((()=>n(351360).default.state.currentSpaceStore),[]),y=(0,o.useCallback)((async()=>{h&&await n(848237).e2({environment:f,teamStore:t,currentSpaceStore:h,from:r,andNavigateToTeamHome:s??!1})}),[h,f,t,r,s]);return(0,g.jsx)(m().p,{style:l,hoveredStyle:d,onClick:y,icon:c,isRed:u,children:(0,g.jsx)(p().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var h=()=>n(655784);const y=function(e){const{teamStore:t,style:i,hoveredStyle:r}=e,[s,l]=(0,o.useState)(!1),d=(0,a().K8)((()=>t.getName()),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m().p,{style:i,hoveredStyle:r,onClick:()=>l(!0),children:(0,g.jsx)(p().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,g.jsx)(n(149257).A,{teamStore:t,teamName:d,teamId:t.id,isModalOpen:s,onDismiss:()=>l(!1)})]})};function v(e){const{teamStore:t,style:n,hoveredStyle:o}=e,p=(0,i().v3)(),m=(0,c().Q)(),v=(0,u().G)(t),b=(0,a().K8)((()=>t.getTeamAccessLevel()),[t]),x=(0,r().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:s().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...n},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...o}})),[n,o]),S=(0,a().K8)((()=>(0,d().A2)({membership:t.getRawMembership()})&&(0,l().s7)(p)),[p,t]),M=!v&&"open"===b||S,A=!v&&"closed"===b;return m?null:v?(0,g.jsx)(h().A,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):M?(0,g.jsx)(f,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):A?(0,g.jsx)(y,{teamStore:t,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):null}},345578:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(449552),i=()=>n(959013),a=()=>n(859428),r=()=>n(962730),s=n(474848);function l(e){let{iconStyle:t}=e;return(0,s.jsx)(a().A,{textWrap:!0,style:{width:210},placement:r().W.Bottom,renderTooltip:()=>(0,s.jsx)(i().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,s.jsx)("div",{...e,children:(0,o().g)(t)})})}},350648:(e,t,n)=>{n.d(t,{D2:()=>M,Ip:()=>b,Jk:()=>x,YT:()=>S,e2:()=>y,g:()=>v});n(898992),n(354520);var o=()=>n(584262),i=()=>n(798880),a=()=>n(946141),r=()=>n(449506),s=()=>n(246826),l=()=>n(436572),d=()=>n(426116),c=()=>n(317909),u=()=>n(972435),p=()=>n(437622),m=()=>n(351360),g=()=>n(848237),f=()=>n(263928);const h=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function y(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const r=o.getSpaceId();if(!r)return;await g().rU({environment:t,teamId:o.id,spaceId:r,teamUserInfo:i,isSettingDefaultTeam:!1,inviterId:n})&&(a().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await v({environment:t,userId:n,teamStore:o}),l().D6({label:u().A.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function v(e){let{environment:t,userId:n,teamStore:i}=e;const a=m().default.state.currentUserRootStore,r=i.getSpaceId();if(!r||!a)return;const s=a.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await d().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:a,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await f().J({environment:t,spaceId:r,userId:n}),g().L0({environment:t,teamStore:i,shouldScroll:!0})}async function b(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await r().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(a().XQ(t,{teamId:n}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:u().A.formatMessage(h.requestTeamSuccessMessage)})}))):l().D6({label:u().A.formatMessage(h.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:n,accessRequestStore:o,status:r}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:i().oo,id:l});if(d){if("approved"===r){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await g().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i().oo,resolved_by_id:t.currentUser.id,status:r}})}}),a().GW(t,{store:n,resolution:r})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:a}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await d().tR({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:a,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:i,userSettingsStore:a,pageVisitSource:o().y8.BackForward})}async function M(e){let{environment:t,teamId:n}=e;const o=await r().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},363203:(e,t,n)=>{n.r(t),n.d(t,{AddOnUpgradeModal:()=>z,isCancellationStage:()=>re,isConfirmPurchaseStage:()=>ae,isLimitReachedStage:()=>ie});n(16280);var o=n(296540),i=()=>n(662303),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(148307),d=()=>n(869190),c=()=>n(66913),u=()=>n(738418),p=()=>n(762433),m=()=>n(323063),g=()=>n(786508),f=()=>n(166386),h=()=>n(959013),y=()=>n(100622),v=()=>n(534177),b=()=>n(284371),x=()=>n(901389),S=()=>n(197190),M=()=>n(331542),A=()=>n(204063),C=()=>n(641514),w=()=>n(719147),j=()=>n(836251),k=()=>n(351360),I=()=>n(57605),T=()=>n(1346),P=()=>n(224701),_=()=>n(601203),B=()=>n(991249),L=()=>n(65250),R=()=>n(30858),D=()=>n(134217),O=()=>n(972418),N=()=>n(847554),E=()=>n(830140),F=()=>n(981046),U=()=>n(749240),V=()=>n(517492),K=n(474848);function z(e){const{data:t}=e,n=(0,D().qc)(t),o=oe(),i=(0,r().K8)((()=>k().default.state.currentSpaceStore),[]),s=(0,O().lh)({spaceId:null==i?void 0:i.id}),l=D().Fq(t),d=(0,a().v3)(),{isOpen:u,addOnFeature:p}=(0,r().K8)((()=>{const{state:e}=E().A;return{isOpen:e.open,addOnFeature:e.addOnFeature}}),[]);return d.device.isMobileNative?(0,K.jsx)(C().A,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>T().qB(),render:()=>(0,K.jsx)("div",{style:o.mobileModal,children:(0,K.jsx)("div",{style:o.innerModalPadding,children:(0,K.jsx)(ne,{})})})}):(0,K.jsx)(C().A,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>T().qB(),render:()=>(0,K.jsx)("div",{style:ae()||ie()&&l&&n?o.largeModal:re()?o.cancellationModal:o.modal,children:(0,K.jsxs)("div",{style:re()?o.cancellationInnerModalPadding:o.innerModalPadding,children:[(0,K.jsx)(S().A,{onClick:()=>{T().qB()},style:o.cancelButton,hoveredStyle:o.hovered,children:(0,c().V)(o.closeIcon)}),ie()&&p&&(0,K.jsx)(W,{addOnFeature:p,canPurchaseAddOn:n,isSubscribed:l}),ae()&&p&&(0,K.jsx)(H,{addOnFeature:p,canPurchaseAddOn:n}),re()&&p&&(0,K.jsx)(te,{addOnFeature:p,canPurchaseAddOn:n,data:t,billingData:s})]})})})}function W(e){const{addOnFeature:t,canPurchaseAddOn:n,isSubscribed:o}=e,i=oe(),r=(0,a().v3)();return n&&o?(0,K.jsx)(H,{addOnFeature:t,canPurchaseAddOn:n}):(0,K.jsxs)(K.Fragment,{children:[(0,u().G)(i.icon),(0,K.jsx)(Y,{addOnFeature:t,canPurchaseAddOn:n}),(0,K.jsx)(q,{addOnFeature:t,canPurchaseAddOn:n}),(0,K.jsx)(A().A,{size:"lg",style:i.button,onClick:async()=>n?o?T().Hq(void 0):async function(e,t){await B().K(e,{from:"plans_page",upsell:{type:"product",product:t,limit:{type:"none"}}}),T().qB()}(r,t):T().qB(),children:n?(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function H(e){var t;const{addOnFeature:n,canPurchaseAddOn:o}=e,i=(0,a().v3)(),s=oe(),d=(0,r().O$)(U().subscriptionDataStoreInstance),c=(0,r().K8)((()=>E().A.state.open?E().A.state.coupon:null),[]),u=(0,r().K8)((()=>k().default.state.currentSpaceStore),[]),m=(0,O().lh)({spaceId:null==u?void 0:u.id});if(!u)return null;if(i.device.isMobileNative||(0,p().YF)(m))return null;let g;if(!d||"unsubscribed_admin"!==d.type&&"subscribed_admin"!==d.type||(g=d),(0,p().et)(m)){const e=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return x().f1(e),null}const f=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,D().qc)(d))return x().f1(f),null;const y=null===(t=g)||void 0===t||null===(t=t.customerData)||void 0===t?void 0:t.stripe;if(!y)return null;const b=(0,p().q8)(m)??"month",S=c?function(e){if("ai_fifty_percent"===e)return(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});(0,v().HB)(e)}(c):"year"===b?(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("img",{src:l().A.images.pricing.aiLogoPng,style:s.aiLogo}),(0,K.jsx)(Y,{addOnFeature:n,canPurchaseAddOn:o}),(0,K.jsx)(Q,{addOnFeature:n}),S?G(S):null,(0,K.jsx)($,{addOnFeature:n,interval:b,stripeData:y,spaceStore:u,billingData:m})]})}function G(e){const t=oe();return(0,K.jsx)(S().A,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,K.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function Y(e){const{addOnFeature:t,canPurchaseAddOn:n}=e,o=oe();let i;switch(t){case"ai":i=n?(0,K.jsx)(h().sA,{id:"subscriptionUpgradeModal.ai.addOn.title",defaultMessage:"Upgrade to unlimited AI"}):(0,K.jsx)(h().sA,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,K.jsx)("h3",{style:o.title,children:i})}function q(e){const{addOnFeature:t,canPurchaseAddOn:n}=e;let o;const i=oe();switch(t){case"ai":o=n?(0,K.jsx)(h().sA,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,K.jsx)(h().sA,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,K.jsx)("p",{style:i.paragraph,children:(0,K.jsx)("div",{style:i.text,children:o})})}function Q(e){const{addOnFeature:t}=e;let n;const o=oe();if(!(0,r().K8)((()=>k().default.state.currentSpaceStore),[]))return null;switch(t){case"ai":n=(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.description",defaultMessage:"Generate content, summarize key points, and find info across Notion and your connected apps"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,K.jsx)("p",{style:o.paragraph,children:(0,K.jsx)("div",{style:o.text,children:n})})}function $(e){const{addOnFeature:t,interval:n,stripeData:i,spaceStore:s,billingData:l}=e,d=oe(),c=(0,a().v3)(),u=(0,r().O$)(U().subscriptionDataStoreInstance),y=(0,N().b)(u),v=(0,p().Ry)(l)??"USD",{tax:b,coupon:x}=(0,r().K8)((()=>({tax:E().A.state.open?E().A.state.tax:0,coupon:E().A.state.open?E().A.state.coupon:void 0})),[]),S=(0,r().K8)((()=>F().A.getPrice(c,(e=>e.product===t&&e.billingInterval===n&&e.currencyCode===v))),[t,c,n,v]),C=(0,r().K8)((()=>F().A.getPrice(c,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===v))),[t,v,c]);if((0,o.useEffect)((()=>{!async function(){const e=x?(0,f().Pz)((0,g().Pq)(x)):void 0;if(S.result&&i&&null!=l&&l.address){const t=S.result.getCostPerBillingInterval({quantity:y,offer:e}).amount;await _().jO({environment:c,priceForTaxCalculation:t,address:l.address,customerId:(0,p().Rz)(l),vatId:i.vatId})}}()}),[c,i,S,y,x,l]),!S.isLoaded||!C.isLoaded)return(0,K.jsx)(M().A,{});if(!S.result||!C.result)return null;const k=S.result,B=x?(0,f().Pz)((0,g().Pq)(x)):void 0,R=k.getCostPerBillingInterval({quantity:y,offer:B}).withAddedAmount(b),D=C.result,O=D.getMonthlyUnitCost();let z=D.getMonthlyCost({quantity:y});"year"===n&&(z=z.withMultipliedAmount(12));const{addOnCostItem:W,addOnCostItemWithMembers:H}=(0,L().Mw)(t,y,n,(0,K.jsx)(V().v,{cost:O.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("p",{style:d.monthlyCostText,children:[(0,K.jsx)("h3",{style:d.title,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,K.jsxs)("div",{style:d.costSectionTitle,children:[(0,K.jsx)("div",{children:W}),(0,K.jsx)("div",{style:d.rightAlign,children:(0,K.jsx)(V().v,{cost:z.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,K.jsx)("div",{style:d.costSection,children:H}),(0,K.jsx)(Z,{cost:k.getCostPerBillingInterval({quantity:y}),fullCost:z}),(0,K.jsx)(J,{price:k,coupon:x,quantity:y}),(0,K.jsxs)("div",{style:d.costSection,children:[(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,K.jsx)("div",{style:d.rightAlign,children:(0,K.jsx)(V().v,{cost:{amount:b,currencyCode:v},trailingZeroDisplay:"auto"})})]}),(0,K.jsxs)("div",{style:d.totalCostSection,children:[(0,K.jsx)("h3",{style:d.title,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,K.jsx)("div",{style:d.rightAlign,children:(0,K.jsx)("h3",{style:d.title,children:(0,K.jsx)(V().v,{cost:R.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,K.jsx)("div",{style:d.perMonth,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:n}})})]}),(0,K.jsx)(A().A,{size:"lg",style:d.button,onClick:async()=>{const e=await I().A.awaitData(c,{spaceId:s.id});if(!e)throw new Error("Billing data not loaded");const t=(0,p().lQ)(e),n=(0,m().vH)(t,{price:k,quantity:y});await P().nV({environment:c,spaceStore:s,from:"add_on_upgrade_modal",desiredState:n,inAppOffer:x}),T().qB()},children:(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,K.jsx)("p",{style:d.termsOfService,children:(0,K.jsx)("div",{style:d.text,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,K.jsx)("br",{}),fairUsePolicies:e=>(0,K.jsx)(w().A,{href:(0,j().xS)("ai.fairUsePolicies"),children:e}),terms:e=>(0,K.jsx)(w().A,{href:(0,j().xS)("ai.terms"),children:e})}})})})]})}function Z(e){const t=oe(),{cost:n,fullCost:o}=e;if(n.amount===o.amount)return null;const i=o.minus(n),a=Math.floor(i.amount/o.amount*100);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{style:t.costSectionTitle,children:[(0,K.jsx)("div",{children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,K.jsx)("b",{children:e}),discountPercent:a}})}),(0,K.jsx)("div",{style:t.greenRightAlign,children:(0,K.jsx)(V().v,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,K.jsx)("div",{style:t.costSection,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function J(e){const t=oe(),{price:n,coupon:o,quantity:i}=e;if(!(0,f().J5)(o))return null;const a=n.getDiscountPerBillingInterval({quantity:i,coupon:o}).withMultipliedAmount(-1);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{style:t.costSectionTitle,children:[(0,K.jsx)("div",{children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,K.jsx)("b",{children:e}),percentage:(0,R().wu)(o)}})}),(0,K.jsx)("div",{style:t.greenRightAlign,children:(0,K.jsx)(V().v,{cost:a,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,K.jsx)("div",{style:t.costSection,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function X(e){const{addOnFeature:t}=e,n=oe(),o=(0,a().v3)();return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:n.buttonWithTopPadding,children:(0,K.jsx)(S().A,{style:n.redButton,hoveredStyle:{background:y().Ay.redWithAlpha(.8)},onClick:async()=>{const e=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=k().default.state.currentSpaceStore;if(!n)return x().f1(e);const i=await I().A.awaitData(o,{spaceId:n.id});if(!i)throw new Error("Billing data not loaded");const a=(0,p().lQ)(i),r=(0,m().gL)(a,t);await P().nV({environment:o,spaceStore:n,from:"add_on_upgrade_modal",desiredState:r}),T().qB()},children:(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,K.jsx)("div",{style:n.buttonWithTopPadding,children:(0,K.jsx)(S().A,{style:n.noButton,onClick:()=>T().qB(),children:(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ee(e){var t;const{billingData:n}=e,o=oe(),a=null==n||null===(t=n.subscription)||void 0===t||null===(t=t.currentPeriodEnd)||void 0===t?void 0:t.toMillis();return a?(0,K.jsx)("p",{style:o.paragraph,children:(0,K.jsx)("div",{style:o.text,children:(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,d().W_)(a,"long",i().locale),bold:e=>(0,K.jsx)("b",{children:e})}})})}):null}function te(e){const{addOnFeature:t,canPurchaseAddOn:n,billingData:o,data:i}=e,a=oe();if(!n)return null;let r;switch(t){case"ai":r=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.title.ai",defaultMessage:"Remove AI at the end of your billing period?"});break;case"sites_custom_hostnames":r=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.title.sites",defaultMessage:"Remove Custom domains at the end of your billing period?"});break;default:(0,v().HB)(t)}return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("h3",{style:a.cancellationTitle,children:r}),(0,K.jsx)(ee,{billingData:o}),(0,K.jsx)(X,{data:i,addOnFeature:t})]})}function ne(){const e=oe(),t=(0,a().v3)();let n=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(n=(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"Unlimited AI cannot be purchased on mobile."})),(0,K.jsxs)(K.Fragment,{children:[(0,u().G)(e.icon),(0,K.jsx)("h3",{style:e.title,children:(0,K.jsx)(h().sA,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"})}),(0,K.jsx)("p",{style:e.paragraph,children:(0,K.jsx)("div",{style:e.text,children:n})}),(0,K.jsx)(A().A,{size:"lg",style:e.button,onClick:()=>T().qB(),children:(0,K.jsx)(h().sA,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function oe(){return(0,s().IS)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:y().Ay.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:b().Wy.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[75],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ie(){return se("limit_reached")}function ae(){return se("confirm_purchase")}function re(){return se("cancel_plan")}function se(e){const t=E().A.state;if(t.open)return t.stage===e}},364811:(e,t,n)=>{n.d(t,{dl:()=>b,LV:()=>M});n(944114),n(296540);var o=n(474848);const i=(0,n(340498).wt)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,o.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})});var a=()=>n(317909),r=()=>n(89924),s=()=>n(878377),l=()=>n(437622),d=()=>n(869562),c=()=>n(351360),u=()=>n(356985),p=()=>n(599364),m=()=>n(654056),g=()=>n(416726),f=()=>n(910702);const h=(0,n(959013).YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),y=(0,g().Ls)({key:"remove pinned shared page",displayName:h.unpinName,analyticsName:h.unpinName.defaultMessage,svg:i,validators:[s().p9k,s().qKm,s().AU6(s().nGR)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:r}=c().default.state;i&&r&&(a().createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:o,canUndo:!0,perform:e=>{for(const n of t)d().unpinSharedPage({environment:o,transaction:e,spaceViewStore:i,userSettingsStore:r,store:n})}}),n(899963).Nj(o,{type:"shared",from:"sidebar_dropdown_menu"}))}}),v=(0,g().Ls)({key:"edit form",displayName:h.editFormName,analyticsName:h.editFormName.defaultMessage,svg:n(173019).r,validators:[s().kD4,s().$68],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const i=t[0],a=i.getFormBlockParentBlockStore();var r;a&&n(857783).uK({environment:o,store:a,collectionViewId:null===(r=i.getParentStore())||void 0===r?void 0:r.id,pageVisitSource:n(584262).y8.FormInternalPage})}}),b=(0,g().Ls)({key:"delete block without shortcuts",displayName:g().AY.moveToTrashName,analyticsName:g().AY.moveToTrashName.defaultMessage,svg:n(236262).I,isRed:!0,validators:[s().or([s()._fc,s().t7S,s().IuJ]),s().SvZ,s().AU6(s().xqI),s().AU6(s().Xjv(n(700500).xd.externalObjectInstancePage)),s().AU6(s().PfK),s().zrb,s().AU6(s().oy3),s().AU6(s().Po5)],closeParentMenu:!0,track:{actionName:"move_to_trash"},action:async(e,t,o)=>{let{blocks:i,environment:a}=t;await n(797265).Af({environment:a,blocks:i,shouldCheckSuggestEdit:!1,callback:e})}}),x=(0,g().Ls)({key:"leave shared page",displayName:h.leaveName,analyticsName:h.leaveName.defaultMessage,svg:n(818044).k,validators:[s().p9k,s().zq3],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;a().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,canUndo:!0,perform:e=>{d().leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),S=(0,g().uk)({key:"duplicate to workspace",displayName:h.duplicateToName,analyticsName:h.duplicateToName.defaultMessage,svg:n(212439).V,validators:[s()._fc,s().PaP,s().Km9,s().AU6(s().MIU),s().aAU],subActions:e=>{let{blocks:t,environment:i}=e;const{currentUserRootStore:a}=c().default.state;if(!a)return[];const s=t[0],d=n(186445).jU(a),u=[];for(const r of d){const e=r.getSpaceStore();if(e){const t=(0,l().GK)(i,e),a=(0,l().c2)(i,e);u.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await n(624550).w7({environment:i,store:s,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,i)=>{let{environment:r}=i;return(0,o.jsx)(n(760217).A,{title:t,icon:(0,o.jsx)(n(614505).A,{icon:a,isEmptyPage:!1,title:t,size:r.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,g().gy)({key:"duplicate-to",render:e=>(0,o.jsx)(r().A,{...e}),actions:u})]}}),M=[n(354406).LQ,{key:"outliner organization actions",render:e=>(0,o.jsx)(r().A,{...e}),actions:[u()._J,u().wy,y,x]},{key:"outliner available offline action",render:e=>(0,o.jsx)(r().A,{...e}),actions:[n(178998).Z]},{key:"outliner primary actions",render:e=>(0,o.jsx)(r().A,{...e}),actions:[p().ko,p().oc,u().O5,u().tA,m().As,m().nK,m().J8,m().lb,S,v,n(22913).U,n(137743).t,b]},{key:"turn page into",render:e=>(0,o.jsx)(r().A,{...e}),actions:[f().zk,f().wm,f().Js]},{key:"outliner navigation",render:e=>(0,o.jsx)(r().A,{...e}),actions:n(668491).YO}]},381495:(e,t,n)=>{n.r(t),n.d(t,{CloseTemplatesPopupComponent:()=>he,default:()=>se});var o=()=>n(624119),i=n(296540),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(292119),d=()=>n(380048),c=()=>n(212050),u=()=>n(959013),p=()=>n(209199),m=()=>n(284371),g=()=>n(112873),f=()=>n(901389),h=()=>n(413677),y=()=>n(436572),v=()=>n(824622),b=()=>n(37546),x=()=>n(202106);function S(){return"web-mobile"===(0,a().Y0)().deviceType}var M=()=>n(345737),A=()=>n(78219),C=()=>n(351360),w=()=>n(714818),j=()=>n(712505),k=()=>n(757695);class I extends k().default{getInitialState(){return{inMemoryRecordCache:new(n(221844).A)({name:"TemplateRecordCacheStore"})}}}var T=()=>n(112527),P=()=>n(704152),_=()=>n(285790),B=()=>n(331542),L=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(581454),()=>n(388821)),R=()=>n(861017),D=()=>n(179034),O=()=>n(824862),N=()=>n(798880),E=()=>n(919709),F=()=>n(449506),U=()=>n(276470),V=()=>n(620689),K=()=>n(437768),z=()=>n(780054),W=()=>n(484792),H=()=>n(186445),G=()=>n(396831);class Y extends k().default{getInitialState(){return{}}}const q=Y;var Q=()=>n(548821),$=()=>n(630116),Z=()=>n(134217),J=()=>n(749240),X=()=>n(2143),ee=()=>n(299772),te=()=>n(13679),ne=n(474848);const oe=function(e){let{style:t,disabled:o,disablePointerEvents:s,previewRootId:l,previewSpaceId:d,isPaidTemplate:c,requiresEmailCapture:p,userHasAcquiredTemplate:m,templateRecordCacheStore:g}=e;const f=(0,a().v3)(),h=(0,r().uB)(g,I),y=(0,r().uB)(void 0,q),v=(0,r().O$)(n(227440).A),b=(0,i.useCallback)(((e,n)=>(0,ne.jsx)(ae,{err:e,store:n,style:t,disabled:o,disablePointerEvents:s,isPaidTemplate:c,requiresEmailCapture:p,userHasAcquiredTemplate:m,pageTemplatePreviewStore:y})),[t,o,s,y,c,p,m]),x=(0,i.useCallback)((e=>{const{rootId:t,spaceId:n}=e;return async function(e,t,n,o,i){if(i){return new($().Bv)(n,{table:D().ev,id:e})}const a=await F().callApi({eventName:"loadBlockSubtree",environment:n,data:{block:{id:e,spaceId:t},shallow:!1}});if("failed"===a.type)throw a.error;const{currentSpaceStore:r}=C().default.state,s=J().subscriptionDataStoreInstance.state,{inMemoryRecordCache:l}=o.state;l.clearCache(),l.isTemplatePreview=!0;const d=new Set,c=new Set,u=L().RecordMapWithRole.create(a.data.subtreeRecordMap);for(const h of u){const{pointer:e,model:t,role:o}=h;if(!o)return;if(l.setModelAndRole({pointer:e,userId:n.currentUser.id},t,"editor"),(null==t?void 0:t.table)===D().ev){const e=t.getProperties();for(const t of Object.keys(e)){const n=(0,E().Fbh)(e[t]);for(const e of n)d.add(e);const o=(0,E().jgW)(e[t]);for(const e of o)c.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===N().oo?d.add(t.created_by_id):c.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===N().oo?d.add(t.last_edited_by_id):c.add(t.last_edited_by_id))}}if(s)for(const h of(0,Z().Be)(s))d.add(h.userId);const p=await Promise.all(Array.from(d).map((async e=>{if(r){const t=$().LU.createChildStore(r,{table:N().oo,id:e});await t.load();return t.getValue()}{const t=await(0,U().e)(n,{pointer:{table:N().oo,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const h of p)h&&l.setRecord({pointer:{table:N().oo,id:h.id},userId:n.currentUser.id},{role:"reader",value:h});const m=await Promise.all(Array.from(c).map((async e=>{if(r){const t=(0,$().Oo)(r,{table:O().GP,id:e,spaceId:r.id});await t.load();return t.getValue()}{const t=await(0,U().e)(n,{pointer:{table:O().GP,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const h of m)h&&l.setRecord({pointer:{table:O().GP,id:h.id,spaceId:h.space_id},userId:n.currentUser.id},{role:"reader",value:h});const{currentUserStore:g}=C().default.state;g&&(await g.load(),l.setRecord({pointer:g.pointer,userId:n.currentUser.id},{role:"editor",value:g.getValue()}));const f=new($().Bv)(n,{table:D().ev,id:e},{inMemoryRecordCache:l});return f}(t,n,f,h,o)}),[f,h,o]),S=(0,i.useCallback)((e=>function(e,t,n){const{device:o}=t,i=(0,R().parseRoute)({url:e,isMobile:o.isMobile,baseUrl:z().A.domainBaseUrl,publicDomainName:z().A.publicDomainName,protocol:z().A.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?n.setState({...n.state,navigatedRootId:i.peekViewBlockId}):n.setState({...n.state,navigatedRootId:i.blockId}))}(e,f,y)),[f,y]);return v.online?(0,ne.jsx)(W().B,{value:S,children:(0,ne.jsx)(n(251126).A,{request:{rootId:l,spaceId:d},performRequest:x,render:b})}):(0,ne.jsx)(W().B,{value:S,children:(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,ne.jsx)(n(125565).A,{isSmall:!0,children:(0,ne.jsx)(u().sA,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function ie(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function ae(e){let{store:t,style:n,disabled:o,disablePointerEvents:s,isPaidTemplate:l,requiresEmailCapture:d,userHasAcquiredTemplate:c,pageTemplatePreviewStore:p}=e;const m=(0,a().v3)(),g=(0,r().uB)(p,q),f=(0,r().K8)((()=>g.state.navigatedRootId),[g]),h=S(),v=(0,r().K8)((()=>t&&(0,H().fl)({environment:m,store:t})),[m,t]);if((0,i.useEffect)((()=>{const e=l&&!h,t=!l&&d&&!c;e&&y().D6({label:(0,ne.jsx)(u().sA,{defaultMessage:"Purchase is unavailable on this platform",id:"pageTemplatePreview.paidTemplate.message"}),durationMs:"keep"}),t&&y().D6({label:(0,ne.jsx)(u().sA,{defaultMessage:"Unable to get template on this platform",id:"pageTemplatePreview.requiresEmailCapture.message"}),durationMs:"keep"}),e||t||y().N2()}),[m,l,d,h,c]),t&&v){let e;return e=f?$().Bv.createChildStore(t,{table:D().ev,id:f}):t,(0,ne.jsx)("div",{style:n,children:(0,ne.jsx)(te().A,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=t;return(0,ne.jsx)(X().H,{style:ie(m),type:v,store:G().A,preventType:V().u5(m),...n,children:s?(0,ne.jsxs)("section",{inert:"",children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Q().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]}):(0,ne.jsxs)(ne.Fragment,{children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Q().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]})},e.id)}},e.id)})}return(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...n},children:(0,ne.jsx)(B().A,{legacySize:K().K})})}const re={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const se=function(){const e=(0,a().v3)(),t=(0,r().uB)(void 0,I),o=(0,i.useCallback)((()=>pe(e,t)),[e,t]),s=(0,i.useCallback)((()=>(0,ne.jsx)(me,{templateRecordCacheStore:t})),[t]),{device:l}=e,d=(0,r().O$)(w().A),c=(0,r().K8)((()=>C().default.state.currentSpaceViewStore),[]);return(0,i.useEffect)((()=>{d.open&&c&&n(317909).createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,canUndo:!0,perform:e=>{h().setTemplateVisited({item:d.item,spaceViewStore:c,transaction:e})}})}),[c,e,d.item,d.open]),l.isMobile?(0,ne.jsx)(n(14235).Ay,{open:d.open,render:s,forceFullScreenSlideUp:!0,onDismiss:o,popupType:n(377586).n.SlideUp}):null};function le(){return new Promise(((e,t)=>{f().ui({message:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function de(e){h().close(e),g().xl()}function ce(e){var t,n,o;let{modalState:i,templateRecordCacheStore:a}=e;const s=(0,r().uB)(a,I);return(0,ne.jsx)(oe,{disablePointerEvents:i.disablePointerEvents,previewRootId:i.item.previewRootId,previewSpaceId:i.item.spaceId,isPaidTemplate:!(null===(t=i.item.marketplaceTemplateMetadata)||void 0===t||!t.isPaidTemplate),requiresEmailCapture:!(null===(n=i.item.marketplaceTemplateMetadata)||void 0===n||!n.requiresEmailCapture),userHasAcquiredTemplate:!(null===(o=i.item.marketplaceTemplateMetadata)||void 0===o||!o.userHasAcquiredTemplate),style:re,templateRecordCacheStore:s,disabled:!0},i.item.previewRootId)}function ue(e,t,n){const{inMemoryRecordCache:o}=n.state,i=w().A.state,{currentSpaceViewStore:a,currentSpaceStore:r,mainEditorCurrentBlockStore:s}=C().default.state;if(i.open&&a&&r){const n=s&&s.isEmptyPage()?s:void 0,l=j().default.state.open&&j().default.state.targetStore&&j().default.state.targetStore.isEmptyPage()?j().default.state.targetStore:void 0;h().accept({environment:t,item:i.item,spaceStore:r,spaceViewStore:a,useRecordCache:e?o:void 0,initializeStore:i.createNewPage?void 0:n||l,isPrivate:i.isPrivate,acceptFrom:i.createNewPage?"sidebar":"newPage"})}}async function pe(e,t){const{inMemoryRecordCache:n}=t.state;if(y().N2(),n.appliedTransaction){await le()?ue(!0,e,t):de(e)}else de(e)}function me(e){var t,n,d,c;let{templateRecordCacheStore:m}=e;const g=(0,a().v3)(),f=(0,u().tz)(),h=(0,s().DP)(),j=S(),k=(0,r().K8)((()=>{var e;return(null===(e=C().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||p().q}),[]),I=(0,i.useCallback)((()=>async function(e,t){var n,o,i,a;const{inMemoryRecordCache:r}=t.state;if(r.appliedTransaction)return void ue(!!(await le()),e,t);const s=null===(n=w().A.state.item)||void 0===n||null===(n=n.marketplaceTemplateMetadata)||void 0===n?void 0:n.isPaidTemplate,l=null===(o=w().A.state.item)||void 0===o||null===(o=o.marketplaceTemplateMetadata)||void 0===o?void 0:o.marketplaceListingId,d=null===(i=w().A.state.item)||void 0===i||null===(i=i.marketplaceTemplateMetadata)||void 0===i?void 0:i.userHasAcquiredTemplate,c=null===(a=w().A.state.item)||void 0===a?void 0:a.id;if(w().A.state.open&&s&&l&&c&&!d)return M().A.setState({...M().A.state,from:"mobileApp",marketplaceListingId:l,templateId:c}),void w().A.setState({...w().A.state,isCheckout:!0});!d&&s||ue(!1,e,t)}(g,m)),[g,m]),P=(0,i.useCallback)((()=>pe(g,m)),[g,m]),_=(0,i.useCallback)((()=>{y().N2(),w().A.state.open&&w().A.setState({...w().A.state,isCheckout:!1}),M().A.setState({...M().A.state,isModalOpen:!1,from:void 0,marketplaceListingId:void 0,templateId:void 0,creatorId:void 0,customerId:void 0})}),[]),L=(0,r().O$)(w().A),R=(0,r().K8)((()=>A().A.state.duplicationStatus),[]);if(!L.open)return null;const D="duplicating"===R,O=null===(t=L.item.marketplaceTemplateMetadata)||void 0===t?void 0:t.isPaidTemplate,N=null===(n=L.item.marketplaceTemplateMetadata)||void 0===n?void 0:n.paidTemplatePrice,E=null===(d=L.item.marketplaceTemplateMetadata)||void 0===d?void 0:d.requiresEmailCapture,F=null===(c=L.item.marketplaceTemplateMetadata)||void 0===c?void 0:c.userHasAcquiredTemplate,U=(0,x().IT)(h,k);return(0,ne.jsx)(v().QA,{title:L.isCheckout?(0,ne.jsx)(u().sA,{defaultMessage:"Complete checkout",id:"pageTemplateModal.mobileModal.checkoutTitle"}):void 0,left:L.isCheckout?(0,ne.jsx)(fe,{handleClick:_}):(0,ne.jsx)(he,{handleClick:P,style:{marginLeft:20}}),right:L.isLoading?(0,ne.jsx)(B().A,{style:{marginRight:40}}):L.isCheckout?null:(0,ne.jsx)(ge,{handleClick:I,isDisabled:D||O&&!j||!O&&!!E&&!F,label:F?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.addAgain",defaultMessage:"Add again"}):O&&N?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.buyTemplate",defaultMessage:"Buy for <money></money>",values:{money:()=>(0,ne.jsx)(l().v,{cost:{amount:100*N,currencyCode:"USD"},intl:f,trailingZeroDisplay:"auto"})}}):void 0}),shouldRenderLeftDirectly:!0,shouldRenderRightDirectly:!0,onCancel:P,disableHeaderShadow:!0,forceFullScreenSlideUp:!0,children:L.isCheckout?(0,ne.jsx)(o().Elements,{stripe:(0,T().getStripe)(),options:U,children:(0,ne.jsx)(b().l,{})}):(0,ne.jsx)(ce,{templateRecordCacheStore:m,modalState:L})})}function ge(e){let{handleClick:t,isDisabled:n,label:o}=e;const i=(0,s().IS)((e=>({doneButton:{display:"flex",alignItems:"center",height:34,paddingLeft:14,paddingRight:14,marginRight:20,fontWeight:m().Wy.medium,color:n?e.text.secondary:e.text.primary,background:e.tint.regular,borderRadius:17}})),[n]);return(0,ne.jsx)(P().A,{mobileFeedback:!0,style:i.doneButton,onClick:t,disabled:n,children:o||(0,ne.jsx)(u().sA,{defaultMessage:"Use template",id:"pageTemplateModal.mobileModal.useTemplateButton.label"})})}function fe(e){let{handleClick:t}=e;const n=(0,u().tz)(),o=(0,s().IS)((e=>({iconButton:{borderRadius:17,width:34,height:34,marginLeft:20},icon:{width:20,height:20}})),[]);return(0,ne.jsx)(_().A,{icon:e=>(0,d().I)(o.icon),style:o.iconButton,isDarkIconColor:!0,onClick:t,ariaLabel:n.formatMessage({defaultMessage:"Back",id:"pageTemplateModal.mobileModal.checkout.backButton.label"})})}function he(e){let{handleClick:t,style:n,disabled:o}=e;const i=(0,s().DP)(),a=(0,u().tz)(),r={background:i.tint.regular,borderRadius:17,width:34,height:34,...n};return(0,ne.jsx)(_().A,{disabled:o,icon:e=>(0,c().u)({width:20,height:20}),style:r,isDarkIconColor:!0,onClick:t,ariaLabel:a.formatMessage({defaultMessage:"Close",id:"pageTemplateModal.mobileModal.closeButton.label"})})}},383286:(e,t,n)=>{n.d(t,{E:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("microphone",{viewBox:"0 0 17 25",svg:(0,o.jsx)("path",{d:"M0.20752 12.0743C0.20752 13.5496 0.511882 14.853 1.12061 15.9845C1.72933 17.116 2.57438 18.0219 3.65576 18.7023C4.73714 19.3826 5.98324 19.7908 7.39404 19.9269V22.129H3.45166C3.17236 22.129 2.93245 22.2257 2.73193 22.4191C2.53141 22.6196 2.43115 22.8595 2.43115 23.1388C2.43115 23.4109 2.53141 23.6437 2.73193 23.837C2.93245 24.0376 3.17236 24.1378 3.45166 24.1378H13.313C13.5923 24.1378 13.8322 24.0376 14.0327 23.837C14.2332 23.6437 14.3335 23.4109 14.3335 23.1388C14.3335 22.8595 14.2332 22.6196 14.0327 22.4191C13.8322 22.2257 13.5923 22.129 13.313 22.129H9.37061V19.9269C10.7814 19.7908 12.0239 19.3826 13.0981 18.7023C14.1795 18.0219 15.0246 17.116 15.6333 15.9845C16.242 14.853 16.5464 13.5496 16.5464 12.0743V9.94739C16.5464 9.66809 16.4461 9.43176 16.2456 9.2384C16.0522 9.04504 15.8159 8.94836 15.5366 8.94836C15.2573 8.94836 15.0174 9.04504 14.8169 9.2384C14.6164 9.43176 14.5161 9.66809 14.5161 9.94739V11.9991C14.5161 13.2166 14.2583 14.2837 13.7427 15.2003C13.2271 16.1098 12.5109 16.8152 11.5942 17.3165C10.6776 17.8178 9.60693 18.0685 8.38232 18.0685C7.16488 18.0685 6.09424 17.8178 5.17041 17.3165C4.24658 16.8152 3.52686 16.1098 3.01123 15.2003C2.50277 14.2837 2.24854 13.2166 2.24854 11.9991V9.94739C2.24854 9.66809 2.14827 9.43176 1.94775 9.2384C1.74723 9.04504 1.50374 8.94836 1.21729 8.94836C0.94515 8.94836 0.708822 9.04504 0.508301 9.2384C0.30778 9.43176 0.20752 9.66809 0.20752 9.94739V12.0743ZM8.38232 15.8448C9.10563 15.8448 9.75016 15.6766 10.3159 15.34C10.8888 14.9962 11.3364 14.5236 11.6587 13.922C11.9881 13.3204 12.1528 12.6222 12.1528 11.8273V4.59778C12.1528 3.80286 11.9881 3.10461 11.6587 2.50305C11.3364 1.90149 10.8888 1.43241 10.3159 1.09583C9.75016 0.752075 9.10563 0.5802 8.38232 0.5802C7.65902 0.5802 7.0109 0.752075 6.43799 1.09583C5.87223 1.43241 5.42464 1.90149 5.09521 2.50305C4.76579 3.10461 4.60107 3.80286 4.60107 4.59778V11.8273C4.60107 12.6222 4.76579 13.3204 5.09521 13.922C5.42464 14.5236 5.87223 14.9962 6.43799 15.34C7.0109 15.6766 7.65902 15.8448 8.38232 15.8448Z"})})},390492:(e,t,n)=>{n.d(t,{m:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("options",{viewBox:"0 0 17 15",svg:(0,o.jsx)("path",{d:"M11.287 4.484c.844 0 1.57-.53 1.875-1.265h2.57c.391 0 .72-.344.72-.758 0-.414-.329-.75-.72-.75h-2.57A2.023 2.023 0 0 0 11.287.437c-.852 0-1.578.532-1.875 1.274H1.045a.744.744 0 0 0-.742.75.75.75 0 0 0 .742.758h8.367a2.044 2.044 0 0 0 1.875 1.265Zm0-1.062c-.539 0-.96-.43-.96-.961 0-.547.421-.969.96-.969.547 0 .961.422.961.969a.95.95 0 0 1-.96.96ZM1.021 6.586c-.39 0-.718.336-.718.75 0 .406.328.75.718.75h2.657A2.03 2.03 0 0 0 5.56 9.359c.843 0 1.57-.523 1.875-1.273h8.273a.744.744 0 0 0 .742-.75.744.744 0 0 0-.742-.75H7.436A2.032 2.032 0 0 0 5.56 5.32c-.852 0-1.579.524-1.883 1.266H1.02Zm4.54 1.719a.964.964 0 0 1-.97-.97c0-.546.43-.96.97-.96.539 0 .96.414.96.96 0 .54-.421.97-.96.97Zm5.726 5.93c.852 0 1.578-.532 1.875-1.274h2.57c.391 0 .72-.336.72-.75a.734.734 0 0 0-.72-.75h-2.57a2.023 2.023 0 0 0-1.875-1.274c-.844 0-1.578.532-1.875 1.274H1.045a.744.744 0 0 0-.742.75c0 .406.328.75.742.75h8.367a2.023 2.023 0 0 0 1.875 1.273Zm0-1.063c-.539 0-.96-.43-.96-.961 0-.547.421-.961.96-.961a.94.94 0 0 1 .961.96.95.95 0 0 1-.96.962Z"})})},391435:(e,t,n)=>{n.d(t,{Z:()=>w});n(944114),n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(401497),r=()=>n(467730),s=()=>n(529324),l=()=>n(413267),d=()=>n(644161),c=()=>n(185078),u=()=>n(959013),p=()=>n(989423),m=()=>n(722872),g=()=>n(760217),f=()=>n(419357),h=()=>n(928600),y=()=>n(939740),v=()=>n(64e3),b=()=>n(460292),x=()=>n(89924),S=()=>n(662971),M=n(474848);const A=1,C=(0,u().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languages…"}});function w(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:r,sourceLanguage:s,detectedPageLanguage:l,preferredLanguage:c,subMenuPlacement:m,subMenuAlignment:f,pageId:h}=e,v=(0,i().v3)(),b=(0,u().tz)(),w="loading"===r.status,T=j(w),P=(0,a().IS)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},...T})),[T]);(0,o.useEffect)((()=>{if("pre_activation"===r.status){const e=setTimeout((()=>{(0,p().u4)({environment:v,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:h}}})}),750);return()=>clearTimeout(e)}}),[r.status,h,v]);const _=r.targetLanguage,B=I({disabled:w,filter:e=>s!==e,currentSelectedLanguage:r.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,M.jsx)(y().Ay,{initialFocus:A,type:y().Oh.Vertical,sections:[{key:"sourceLanguage",render:e=>(0,M.jsx)(x().A,{...e,title:b.formatMessage(C.sourceLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2},style:P.menuItemSectionBottomBorder}),items:[{key:s,render:(e,t)=>{let{onFocus:o}=t;return(0,M.jsx)(S().A,{...e,onFocus:o,disableDefaultClick:!0,placementToOrigin:m,alignmentToOrigin:f,renderOrigin:(e,t)=>(0,M.jsx)(g().A,{...e,disabled:w,buttonStyle:P.button,ref:t,title:b.formatMessage((0,d().Bj)(s)),caption:s===l?b.formatMessage(C.detectedLanguage):s===c?b.formatMessage(C.preferredLanguage):void 0}),renderExtension:e=>(0,M.jsx)(k,{disabled:w,extensionPopupButtonEvents:e,currentTargetLanguage:_,sourceLanguage:s,onSelectSourceLanguage:n})})},action:()=>{}}]},{key:"selectLanguage",render:e=>(0,M.jsx)(x().A,{...e,title:b.formatMessage(C.selectLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2}}),items:B}]})}function j(e){return(0,a().IS)((t=>({button:{color:e?t.lightTextColor:t.regularTextColor}})),[e])}function k(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:o,sourceLanguage:a,onSelectSourceLanguage:r}=e,{isMobile:s}=(0,i().Y0)(),l=I({disabled:o,filter:e=>e!==n,currentSelectedLanguage:a,onSelectLanguage:e=>{r({sourceLanguage:e})}}),d=s?{menuType:m().gu.ActionSheet,...t}:{menuType:m().gu.Popup,width:200,height:380,...t};return(0,M.jsx)(h().A,{...d,onClick:e=>{e.preventDefault()},children:(0,M.jsx)(y().Ay,{initialFocus:void 0,type:y().Oh.Vertical,sections:[{key:"originalLanguage",render:e=>(0,M.jsx)(x().A,{...e}),items:l}]})})}function I(e){const{disabled:t,filter:n,currentSelectedLanguage:a,onSelectLanguage:p}=e,m=(0,u().tz)(),{isMobile:h}=(0,i().Y0)(),[y,x]=(0,o.useState)(""),S=j(t),A=(0,o.useMemo)((()=>({key:"language-search-input",render:e=>(0,M.jsx)(f().Ay,{...e,disabled:t,placeholder:m.formatMessage(C.languageSearchPlaceholder),value:y,onChange:e=>x(e.target.value),autoFocus:!h,inputLeft:(0,M.jsx)(b().Q,{iconGroup:s().C,colorName:"lightGrayPrimary",variantName:"default"})}),action:()=>{}})),[y,t,m,h]),w=(0,o.useMemo)((()=>({key:"no-results",render:()=>(0,M.jsx)(v().A,{title:(0,M.jsx)(u().sA,{defaultMessage:"No results found.",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),k=(0,o.useMemo)((()=>{const e=[];for(const t of c().hr)if(n(t)){const n=m.formatMessage((0,d().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,m]),I=(0,o.useMemo)((()=>(0,r().Ay)(y,k,(e=>{let{languageName:t}=e;return t.toLowerCase()}))),[y,k]),T=(0,o.useMemo)((()=>I.map((e=>{let{languageCode:n,languageName:o}=e;return{key:n,render:e=>(0,M.jsx)(g().A,{...e,buttonStyle:S.button,disabled:t,title:o,right:a===n?(0,l().b)({width:14,height:14}):void 0}),action:()=>{t||p(n)}}}))),[I,t,a,p,S.button]);return 0===T.length?[A,w]:[A,...T]}},396831:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(17090).A)},418426:(e,t,n)=>{n.d(t,{$:()=>l});n(898992),n(354520),n(581454);var o=()=>n(484714),i=()=>n(56366),a=()=>n(468006),r=()=>n(605402),s=()=>n(486130);function l(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>{if(!e.isDefined())return[];return(0,a().ri)({rawMembers:e.getRawMembership(),groupsInSpace:r().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((n=>s()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(n.getGroupId())))}),[t,e])}},421682:(e,t,n)=>{n.d(t,{J:()=>W});n(16280),n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(728396),l=()=>n(251822),d=()=>n(145214),c=()=>n(439264),u=()=>n(218557),p=()=>n(953418),m=()=>n(170253),g=()=>n(978846),f=()=>n(970176),h=()=>n(316397),y=()=>n(933951),v=(n(18107),n(967357),n(898992),n(354520),()=>n(72645)),b=()=>n(155185),x=()=>n(959013),S=()=>n(285790),M=()=>n(859428),A=()=>n(38337),C=()=>n(104129),w=()=>n(962730),j=()=>n(160241),k=()=>n(3197),I=()=>n(937199),T=n(474848);const P=(0,x().YK)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),_=32;function B(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,x().tz)(),{layoutStore:n,addModuleHoverMenuStore:o,currentModuleSelection:i}=(0,I().LH)(),s=(0,a().K8)((()=>{if(o.state.isOpen)return o.state.moduleId}),[o]),l=(0,a().K8)((()=>{if(!s)return;const e=C().A.findModuleContainer({layoutStore:n,moduleId:s});return e?e.getNode():void 0}),[s,n]),c=(0,a().K8)((()=>{if(!i||"new_module"===i.type)return!1;const e=n.getModuleById(i.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[i,n]),u=(0,a().K8)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area].filter((e=>(0,b()._)(e))),a=0===i.length||(null===(t=i.at(-1))||void 0===t?void 0:t.id)===s;return o.state.isOpen&&!c&&!a}),[o,s,c,n,e.area]),p=(0,k().t)({area:e.area,afterModuleId:s}),m=(0,j().d)(),g=(0,r().IS)((e=>({bigRoundButton:{...m.button,width:_,height:_,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...m.buttonHovered},bigRoundButtonPressed:{...m.buttonPressed}})),[m]),f="form"===(0,a().K8)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(P.formLayoutAddModule):t.formatMessage(P.pageLayoutAddModule),h=l?l.offsetLeft-40:void 0,y=l?l.offsetTop+l.offsetHeight-4:void 0;return void 0===h||void 0===y?null:(0,T.jsx)(d().A,{visible:u,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",left:h,top:y},children:(0,T.jsx)(M().A,{placement:w().W.Left,renderTooltip:()=>f,render:e=>(0,T.jsx)(S().A,{...e,style:g.bigRoundButton,hoveredStyle:g.bigRoundButtonHovered,className:A().kew,pressedStyle:g.bigRoundButtonPressed,onClick:p,icon:v().b,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},isBlue:!0,ariaLabel:f})})})}var L=()=>n(21140),R=()=>n(612900),D=()=>n(817942);const O=(0,x().YK)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),N=o.forwardRef((function(e,t){const{area:o}=e,{layoutStore:i}=(0,I().LH)(),s=(0,a().K8)((()=>i.getLayoutType()),[i]),l=(0,x().tz)(),d=(0,j().d)(),c=(0,r().IS)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 16px 8px 12px",fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],color:e.accentColors.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,k().t)("views_main_tab_modules"===o?{area:o,viewsMainTabId:e.viewsMainTabId}:{area:o});if("form_conditional_modules"===o)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const p=(0,a().K8)((()=>{var t;const n=i.getModules();return("views_main_tab_modules"===o?(null===(t=n[o])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[o]).length>0}),[i,o,e.viewsMainTabId]);return"page_details"!==o||p?(0,T.jsx)(M().A,{renderTooltip:()=>l.formatMessage(O.addQuestionModuleTooltip),disableTooltip:"form"!==s,placement:w().W.Bottom,render:e=>(0,T.jsx)(S().A,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:v().b,iconStyle:{width:16,height:16},isBlue:!0,className:A().kew,ariaLabel:l.formatMessage(O.addPageModule),ref:t,...e})}):(0,T.jsxs)(n(197190).A,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(464699).b)({width:12,marginRight:4}),(0,T.jsx)(x().sA,{...O.addModuleToPanelButton})]})})),E=o.memo((function(e){var t;const{shouldShowTooltip:i}=(0,n(384130).J)(),{area:r}=e,s=i&&"page_main"===r,l=i&&"form_layout_schema"!==r,d=o.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:p,isPropertyTypeSearchInputDirtyStore:m}=(0,I().LH)(),g=(0,a().K8)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,a().K8)((()=>{var t;if("form_conditional_modules"===r)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===r?(null===(t=n[r])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[r]).length>0}),[u,r,e.viewsMainTabId]),[h,y]=o.useState(!1),v=o.useCallback((()=>{m.state||p(void 0)}),[m,p]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,T.jsx)(n(545805).A,{onUndo:v,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,T.jsx)(F,{})}):"placeholder"===(null==g?void 0:g.type)?null:s||l?(0,T.jsxs)(L().Ye,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:D().hg,children:[(0,T.jsx)(R().u,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>y(!0),children:(0,T.jsx)(N,{isEducationCalloutVisible:s,...e,ref:d})}),s&&h&&(0,T.jsx)(n(961842).C8,{buttonRef:d})]}):(0,T.jsx)(L().Ye,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:D().hg,children:(0,T.jsx)(N,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function F(){const e=(0,r().IS)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.accentColors.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.stroke.uiBlueSecondary}, inset 0px 0px 0px 1px ${e.stroke.uiBlueSecondary}`}})),[]);return(0,T.jsx)("div",{style:e.ghostPageModuleContainer,className:D().hg,children:(0,T.jsx)(R().u,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,T.jsx)("div",{style:e.ghostPageModule})})})}var U=()=>n(496603);const V=12;function K(){const{addModuleHoverMenuStore:e}=(0,I().LH)(),t=(0,h().z)(),n=(0,o.useCallback)((n=>{const o=C().A.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let i=null;for(const e of o){const o=e.getNode();if(!o)continue;const a=o.getBoundingClientRect();if(n.clientX>a.right||n.clientX<a.left&&a.left-n.clientX>300)continue;if(n.clientY<=a.bottom&&a.bottom-n.clientY<V||n.clientY>a.bottom&&n.clientY-a.bottom<V+t){i=e;break}}if(i)e.setState({isOpen:!0,moduleId:i.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),i=U().nF(n,30);return(0,o.useEffect)((()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)})),[i]),null}var z=()=>n(47762);function W(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,i().v3)(),{sessionId:v,layoutStore:b,currentModuleSelection:x,setModuleSelection:S,canEditLayout:M,layoutBuilderModuleSelectionStore:A}=(0,I().LH)(),C=(0,o.useRef)(null),w=(0,y().u)({layoutStore:b,pageStoreId:void 0}),j=(0,a().K8)((()=>b.isTabbedPageLayout()),[b]),k=(0,h().z)(),{nonMoveableHeaderModules:P,moveableModules:_,nonMoveableFooterModules:L}=(0,a().K8)((()=>{var n;const o="views_main_tab_modules"===t?(null===(n=w[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:w[t];return(0,l().jS)(t,o)}),[t,w,null==e?void 0:e.viewsMainTabId]),R=(0,a().K8)((()=>{const e=A.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,o=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&o.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&o.area!==t,isDraggingAnyModuleList:!0,dragArea:o}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,A]),O=_.map((e=>"form_layout_schema"===t?{key:e.id,draggable:"placeholder"!==e.type}:{key:e.id,draggable:!0})),N=(0,o.useMemo)((()=>new(m().A)),[]),F=(0,a().K8)((()=>N.state.isDragging),[N]),U=(0,a().K8)((()=>{var e;return null===(e=b.getModel())||void 0===e?void 0:e.getLayoutType()}),[b]);(0,o.useEffect)((()=>{C.current&&R.isDraggingIntoThisArea&&(0,p().$v)({element:C.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[R.isDraggingIntoThisArea,n]);const V=(0,o.useCallback)((n=>{const o="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};S({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:o,draggingModuleFinalArea:o})}),[t,e.viewsMainTabId,S]),W=(0,o.useCallback)((e=>{e&&S({type:"existing_module",moduleId:e,isDragging:!1})}),[S]),H=(0,o.useCallback)((()=>{const e=A.state,t=b.getLayoutType();t&&(0,s().H)(t)?S(void 0):null!=e&&e.isDragging&&A.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[A,S,b]),G=(0,o.useCallback)((e=>{const o=A.state,i=null!=o&&o.isDragging?o.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==i?void 0:i.area)&&(null!=e&&e.key&&i&&i.area!==t&&((0,g().E)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewsMainTabId}:{area:i.area}},moduleId:e.key,layoutStore:b,sessionId:v}),(0,f().z)({moduleId:e.key,layoutStore:b,environment:n})),H())}),[A,t,H,n,b,v]),Y=(0,o.useCallback)((o=>{let{key:i,endPosition:a,startPosition:r}=o;if(R.isDraggingFromThisAreaToOtherArea)return;const s=P.length,l="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,g().E)({environment:n,layoutStore:b,position:{type:"absolute",index:s+a,...l},moduleId:i,sessionId:v}),(0,f().z)({moduleId:i,layoutStore:b,environment:n})}),[R.isDraggingFromThisAreaToOtherArea,P.length,t,e.viewsMainTabId,n,b,v]),q=(0,r().IS)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:k,marginBottom:k},addButtonContainer:{paddingTop:"page_in_collection"===U?8:0,marginBottom:"form"===U?0:12,width:"100%"},dropzoneHalo:{background:u().to,height:u().NZ,marginTop:-u().NZ},hiddenModuleStyle:{display:"none"}})),[k,U]),Q=(0,o.useCallback)((e=>{const n="existing_module"===(null==x?void 0:x.type)&&x.moduleId===e,o=n&&F;return(0,T.jsx)(z().n,{active:n,pageModuleId:e,isDragging:o,area:t,style:o&&R.isDraggingFromThisAreaToOtherArea?q.hiddenModuleStyle:void 0},e)}),[R.isDraggingFromThisAreaToOtherArea,x,F,q.hiddenModuleStyle,t]),$=(0,o.useMemo)((()=>P.length?P.map((e=>Q(e.id))):null),[P,Q]),Z=(0,o.useMemo)((()=>L.length?L.map((e=>Q(e.id))):null),[L,Q]),J=(0,o.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),X=(0,o.useMemo)((()=>({buttonContainer:q.addButtonContainer})),[q.addButtonContainer]);if(!b)return null;let ee;return ee=!!M&&(!j||("views_main_tab_modules"===t||"page_details"===t)),(0,T.jsxs)(T.Fragment,{children:[$,!!O.length&&(0,T.jsx)(c().Ay,{forceDragKeyIndex:R.isDraggingFromThisAreaToOtherArea?O.length-1:void 0,className:D().hg,store:N,keys:O,direction:"vertical",onDraggingKeyChanged:V,onDrop:(e,t)=>{Y(t)},onDragCancel:H,onDragEnd:G,onClick:W,style:q.draggableList,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:Q,disabled:!M,...j?{}:{hoverCursorStyleOverride:R.isDraggingAnyModuleList?"grabbing":void 0}}),(0,T.jsx)(d().A,{visible:R.isDraggingIntoThisArea,initial:J.enter,animate:J.animate,exit:J.exit,skip:!R.isDraggingAnyModuleList,className:"layout-content",ref:C,style:q.dropzoneHalo}),ee&&(0,T.jsx)(E,{...e,styles:X}),"form"===U&&M&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(K,{}),(0,T.jsx)(B,{area:t})]}),Z]})}},422540:(e,t,n)=>{n.d(t,{$0:()=>h,Fx:()=>A,Ge:()=>m,I3:()=>u,Kj:()=>S,PP:()=>C,TK:()=>w,Yy:()=>c,aE:()=>j,cQ:()=>M,kH:()=>g,m7:()=>p,nq:()=>b,nv:()=>y,tj:()=>f});n(898992),n(354520),n(737550);var o=()=>n(496603),i=()=>n(534177),a=()=>n(970013),r=()=>n(651124),s=()=>n(349835),l=()=>n(390066);(0,i().u0)((e=>(0,i().O9)(e)&&(0,i().O9)(e.target)&&(0,i().O9)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target,custom_message:e.custom_message}}:{false:e}));const d={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1},c={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function u(e){return Boolean(d[e.type]&&!(0,a().UU)(e)&&(!(0,a().$M)(e)||void 0===(0,a().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:d,sourcePropertyIds:c}=e,p=(c??(0,i().uv)(n)).filter(((t,o,i)=>{const r=n[t];return!(!r||!u(r))&&(("relation"!==r.type||!e.restrictCrossSpace||!(0,a().o2)(e.spaceId,r))&&(!s||s([t,r],o,n)))}));if(0===p.length)return[];if(!t||!1===d)return p;const m=(0,l().L)(t,n,void 0,r().jf.Page).collection_page_properties||[];return o().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:n,sort:s}=e,d=(0,i().uv)(n).filter(((e,t,o)=>{const i=n[e];return!(!i||!(0,a().JY)(i))}));if(0===d.length)return[];if(!t||!1===s)return d;const c=(0,l().L)(t,n,void 0,r().jf.Page).collection_page_properties||[];return o().Ul(d,(e=>c.findIndex((t=>t.property===e))))}function g(e){return e.type===s().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===s().M9.TokenExpected?{type:e.type,token:e.token}:e.type===s().uW.MissingSchemaPropertyOnThisRow||e.type===s().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===s().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===s().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===s().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===s().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===s().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer}:e.type===s().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===s().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===s().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===s().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===s().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const f={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,geo_point:!1};function h(e){return Boolean(f[e.type])}function y(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:d}=e,c=(0,i().uv)(n).filter(((e,t,o)=>{var i;const r=n[e];return!(!r||!f[r.type])&&((!(0,a().$M)(r)||null===(i=(0,a().om)(r))||void 0===i||!i.auto_update_on_edit)&&(!s||s([e,r],t,n)))}));if(0===c.length)return[];if(!t||!1===d)return c;const u=(0,l().L)(t,n,void 0,r().jf.Page).collection_page_properties||[];return o().Ul(c,(e=>u.findIndex((t=>t.property===e))))}const v={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function b(e){return v[e.type]}const x={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function S(e){return x[e.type]}function M(e){return 0===e}function A(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function C(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function w(e){const{collectionSchema:t,property:n,type:o}=e,i=null==t?void 0:t[n];return!i||("action"===o?!u(i):!f[i.type])}function j(e){let{automationTrigger:t,collectionSchema:n}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:o,source:a,relativeDate:r}=t.event;if(void 0===a)return!1;const s="some"===o.type&&o.some,l="all"===o.type&&o.all;if((s||l||[]).some((e=>C({collectionSchema:n,property:e.property})||w({collectionSchema:n,property:e.property,type:"trigger"}))))return!1;const d="some"===o.type&&(!(0,i().O9)(o.some)||0===o.some.length),c="all"===o.type&&(!(0,i().O9)(o.all)||0===o.all.length);if(!e&&("none"===o.type||d||c)&&!r)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},423817:(e,t,n)=>{n.d(t,{J:()=>r});n(581454),n(296540);var o=()=>n(401497),i=()=>n(710149),a=n(474848);function r(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const n=(0,o().IS)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),r=[...Array(t)].map(((e,t)=>(0,a.jsxs)("div",{style:n.skeletonSection,children:[(0,a.jsx)(i().A,{style:n.skeletonCircle}),(0,a.jsxs)("div",{style:{width:"80%"},children:[(0,a.jsx)(i().A,{style:{width:"80%",...n.skeletonRect,marginTop:0}}),(0,a.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}}),(0,a.jsx)(i().A,{style:{width:"60%",...n.skeletonRect}}),(0,a.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}})]})]},t)));return(0,a.jsx)("div",{children:r})}},430395:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:n(206267).JW(),type:n(506090).p.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const i=new o},430923:(e,t,n)=>{n.d(t,{DV:()=>s,l7:()=>r,y7:()=>a});var o=()=>n(645873);const i={CollectionNewViewsPopupComponent:new(o().O2)("CollectionNewViewsPopupComponent",(async()=>await Promise.all([n.e(23806),n.e(96346),n.e(36192),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(67435),n.e(34576),n.e(62620)]).then(n.bind(n,93709)))),CollectionLinkExistingModal:new(o().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(23806),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(90825),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(38664),n.e(24587),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(67435),n.e(5887),n.e(70769),n.e(97965),n.e(83210),n.e(26090),n.e(10596),n.e(99346),n.e(5287)]).then(n.bind(n,901226)))),ModalOverlayCollectionView:new(o().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([n.e(84856),n.e(32413)]).then(n.bind(n,956436))))},a=(0,o()._h)(i.CollectionNewViewsPopupComponent,(e=>e.CollectionNewViewsPopupComponent)),r=(0,o()._h)(i.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),s=(0,o()._h)(i.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},441532:(e,t,n)=>{n.d(t,{y:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("androidShare",{viewBox:"0 0 15 15",svg:(0,o.jsx)("path",{d:"M11.9952,10.6024 C11.4229,10.6024 10.9108,10.8283 10.51928,11.1822 L5.15029999,8.05723 C5.18794999,7.88404 5.21806999,7.71084 5.21806999,7.53012 C5.21806999,7.3494 5.18794999,7.1762 5.15029999,7.00301 L10.45904,3.90813 C10.8657,4.28464 11.4003,4.51807 11.9952,4.51807 C13.2452,4.51807 14.2542,3.50904 14.2542,2.25904 C14.2542,1.00904 13.2452,0 11.9952,0 C10.7452,0 9.73614999,1.00904 9.73614999,2.25904 C9.73614999,2.43976 9.76626999,2.61295 9.80391999,2.78614 L4.49517999,5.88102 C4.08854999,5.50452 3.55391999,5.27108 2.95903999,5.27108 C1.70903999,5.27108 0.699999988,6.28012 0.699999988,7.53012 C0.699999988,8.78012 1.70903999,9.78916 2.95903999,9.78916 C3.55391999,9.78916 4.08854999,9.55572 4.49517999,9.17922 L9.85662999,12.3117 C9.81897999,12.4699 9.79638999,12.6355 9.79638999,12.8012 C9.79638999,14.0136 10.7828,15 11.9952,15 C13.2075,15 14.194,14.0136 14.194,12.8012 C14.194,11.5889 13.2075,10.6024 11.9952,10.6024 Z"})})},446242:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},448360:(e,t,n)=>{n.d(t,{W:()=>o});const o=n(757695).default.createValue(!1,{name:"AiPageTranslationCalloutStore"})},457190:(e,t,n)=>{n.d(t,{v:()=>s});var o=()=>n(835338),i=()=>n(848259),a=()=>n(246826),r=()=>n(317909);function s(e){const{environment:t,key:n,selectedKey:s,following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:p,from:m}=e;r().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{a().vt({environment:e.environment,table:o().Cy,args:{following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:p},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),l?i().KN(t,{from:"page_updates"}):i().tm(t,{from:"page_updates"}),s!==n&&i().EV(t,{from:m,navigableBlockId:c,oldSetting:s,newSetting:n})}},459240:(e,t,n)=>{n.d(t,{_:()=>c});n(296540);var o=()=>n(340498),i=n(474848);const a=(0,o().wt)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})}),r=(0,o().wt)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})});var s=()=>n(972435);const l=(0,n(959013).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"},form:{defaultMessage:"Form",id:"templatePickerHelpers.databaseTemplateNames.form"}});function d(e){const{environment:t,store:o,viewType:i}=e;n(317909).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(226916).c)({environment:t,store:o,viewType:i,transaction:e}),n(857783).uK({environment:t,store:o,pageVisitSource:n(584262).y8.LinkInPage});const a=o.getCollectionViewStores()[0];a&&(0,n(493260).F)(a.id,{viewType:i})}})}const c=[{name:s().A.formatMessage(l.table),type:"table",iconFn:n(29118).K,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"table"})},{name:s().A.formatMessage(l.board),type:"board",iconFn:n(34373).k,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"board"})},{name:s().A.formatMessage(l.list),type:"list",iconFn:n(50170).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"list"})},{name:s().A.formatMessage(l.timeline),type:"timeline",iconFn:n(880261).v,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"timeline"})},{name:s().A.formatMessage(l.calendar),type:"calendar",iconFn:a,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"calendar"})},{name:s().A.formatMessage(l.gallery),type:"gallery",iconFn:r,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"gallery"})}]},467935:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(584262),s=()=>n(133033),l=()=>n(959013),d=()=>n(148024),c=()=>n(857783),u=()=>n(836251),p=()=>n(351360);class m extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const g=new m;var f=()=>n(493823),h=()=>n(187485),y=()=>n(864408),v=n(474848);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(284371).Wy.bold,marginRight:"auto"},x={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},S={padding:"24px 36px 24px",minWidth:300};const M=function(){const e=(0,a().O$)(g);return(0,v.jsx)(n(957986).A,{open:e.open,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,v.jsxs)(o.Fragment,{children:[(0,v.jsxs)("div",{style:x,children:[(0,v.jsx)("div",{style:b,children:(0,v.jsx)(l().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,v.jsx)(A,{})]}),(0,v.jsx)("div",{children:(0,v.jsx)(w,{modalState:e})})]}),onDismiss:C})};function A(){const e=(0,i().v3)();return(0,v.jsx)(h().A,{href:(0,u().xS)("guides.import"),onClick:()=>d().FH(e,{from:"import"}),external:!0,children:(0,v.jsx)(f().p,{size:"sm",icon:s().$,isGray:!0,children:(0,v.jsx)(l().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function C(){g.setState({open:!1})}function w(e){let{modalState:t}=e;const n=(0,i().v3)(),{mainEditorCurrentBlockStore:o,currentSpaceStore:s,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,a().K8)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}=p().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}}),[]);return o&&s&&l&&d?(0,v.jsx)(y().A,{pageStore:t.open&&t.pageStore?t.pageStore:o,spaceStore:s,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.setState({open:!1}),c().uK({environment:t,store:e,pageVisitSource:r().y8.Import})}(e,n),readOnlyCreditButton:!1}):null}},487443:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(296540);var o=()=>n(56366),i=()=>n(401497),a=()=>n(433876),r=()=>n(284331),s=n(474848);function l(e){let{store:t,permissionsInviteStore:n,origin:l}=e;const d=(0,o().K8)((()=>n.state.modalOpen),[n]),c=()=>{n.reset()},u=(0,i().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,s.jsx)(a().A,{modalStyle:u.modal,open:d,onDismiss:c,renderContent:()=>(0,s.jsx)("div",{style:u.overlay,children:(0,s.jsx)(r().A,{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:c,onDismiss:c})}),origin:l})}},488999:(e,t,n)=>{n.d(t,{A:()=>r});n(898992),n(672577),n(737550);var o=()=>n(68263),i=()=>n(179034),a=()=>n(108944);function r(e){if(!e.getSpaceStore())return;const t=a().g7(e).slice().reverse().find((e=>{if(e.table===i().ev){if(e.getPermissionItems().some((e=>(0,o().vZ)(e))))return!0}return!1}));return t}},498047:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>eo});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(340498),l=n(474848);const d={viewBox:"0 0 20 20",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M3.608 10.442a.625.625 0 0 1 0-.884l5.4-5.4a.625.625 0 0 1 .884.884L4.934 10l4.958 4.958a.625.625 0 0 1-.884.884z"}),(0,l.jsx)("path",{d:"m14.508 4.158-5.4 5.4a.625.625 0 0 0 0 .884l5.4 5.4a.625.625 0 0 0 .884-.884L10.434 10l4.958-4.958a.625.625 0 0 0-.884-.884"})]})},c=(0,s().wt)("arrowChevronDoubleBackward",d);var u=()=>n(22634),p=()=>n(959013),m=()=>n(534177),g=()=>n(145214),f=()=>n(285790),h=()=>n(2143),y=()=>n(852302),v=()=>n(859428),b=()=>n(21140),x=()=>n(753199),S=()=>n(972435),M=()=>n(962730),A=()=>n(756279),C=()=>n(204521),w=()=>n(524165),j=()=>n(812412),k=()=>n(542371),I=()=>n(449476),T=()=>n(148307),P=()=>n(651124),_=()=>n(390066),B=()=>n(738418),L=()=>n(284371),R=()=>n(334261),D=()=>n(896628),O=()=>n(317909),N=()=>n(115552),E=()=>n(678553),F=()=>n(946548),U=()=>n(867159),V=()=>n(645873);const K={switchFromSimpleToTabbedLayoutActions:new(V().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,288143)))),switchFromTabbedToSimpleLayoutActions:new(V().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,434867)))),createRelationViewsModuleActions:new(V().O2)("createRelationViewsModuleActinos",(async()=>Promise.resolve().then(n.bind(n,957568)))),deleteViewsModuleDependenciesActions:new(V().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,658616))))};n(944114),n(581454);var z=()=>n(970013),W=()=>n(743176);const H=(0,s().wt)("propertyText",{viewBox:"0 0 26 17",svg:(0,l.jsx)("path",{d:"M0.066 16V15.296L1.342 14.79L6.688 1.282L7.436 1.172L8.206 0.952L13.266 14.79L14.762 15.274V16H9.108V15.274L10.978 14.768L9.636 10.918H4.268L2.992 14.504L5.104 15.274V16H0.066ZM6.974 3.372L4.752 9.598H9.174L6.996 3.372H6.974ZM18.5422 16.33C17.3762 16.33 15.9022 15.516 15.9022 13.756C15.9022 11.996 17.1782 11.204 19.4442 10.61L21.7102 10.016V8.872C21.6662 7.178 20.7862 6.298 19.6202 6.298C18.9602 6.298 18.4102 6.584 18.2342 6.694L18.1462 8.872C18.1462 8.872 17.5962 8.938 17.2662 8.938C16.5622 8.938 16.2102 8.586 16.2102 7.992C16.2102 6.98 18.1462 5.374 20.4122 5.374C22.6342 5.374 23.6022 6.386 23.6022 8.564V14.504C23.6022 14.944 23.7122 15.098 24.3282 15.098H25.4282V15.714C25.4282 15.714 24.1522 16.264 23.3382 16.264C22.2162 16.264 21.7542 15.494 21.7542 14.548H21.6882C20.4562 15.714 19.9282 16.33 18.5422 16.33ZM19.7082 14.834C20.7642 14.834 21.4462 14.042 21.7102 13.646V10.742L19.5982 11.446C18.5642 11.798 17.9042 12.216 17.9042 13.14C17.9042 14.262 18.7622 14.834 19.7082 14.834Z"})});var G=()=>n(381138),Y=()=>n(760217),q=()=>n(419357),Q=()=>n(939740),$=()=>n(89924),Z=()=>n(175116),J=()=>n(682146),X=()=>n(937199),ee=()=>n(369186),te=()=>n(183558),ne=()=>n(978846);function oe(e){const{propertyId:t,propertyType:n,environment:o,transaction:i,layoutStore:a,collectionStore:r,currentModuleSelection:s,sessionId:l,isPropertyCreation:d}=e,c=a.getModel(),u=r.getModel();if(!c||!u||"new_module"!==(null==s?void 0:s.type))return;const p={id:(0,te().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?p.config={property_person:{style:"compact"}}:"number"===n&&(p.config={property_number:{style:"large"}}),"form_conditional_modules"===s.area)return;const m=(0,ee().dI)({collectionModel:u,module:p});return(0,ne().UQ)({environment:o,transaction:i,layoutStore:a,position:"views_main_tab_modules"===s.area?{type:"area_relative",area:s.area,viewId:s.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:s.area,location:"end_moveable"},module:m,sessionId:l,isPropertyCreation:d}),p}function ie(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:a,setModuleSelection:r,sessionId:s}=(0,X().LH)(),{collectionStore:l}=(0,X().bi)();return(0,o.useCallback)((o=>{let{propertyType:i,isPropertyCreation:d}=o;const{performResult:c}=O().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const r=t.getModel(),c=l.getModel();if(!r||!c||"new_module"!==(null==a?void 0:a.type))return;return oe({propertyId:n(235191).IL({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:J().dC[i],propertyType:i,transaction:o}),propertyType:i,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:a,sessionId:s,isPropertyCreation:d})}});c&&r({type:"existing_module",moduleId:c.id,isDragging:!1})}),[e,r,t,l,a,s])}function ae(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:a,sessionId:r}=(0,X().LH)(),{collectionStore:s}=(0,X().bi)();return(0,o.useCallback)((o=>{const{propertyId:i,propertyType:l}=o,{performResult:d}=O().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:o=>oe({propertyId:i,propertyType:l,environment:e,transaction:o,layoutStore:t,collectionStore:s,currentModuleSelection:n,sessionId:r,isPropertyCreation:!1})});return d?(a({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,a,t,s,n,r])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var re=()=>n(713998),se=()=>n(778781),le=()=>n(248064);function de(e){return void 0!==e[1]}function ce(e){let{propertySortPriority:t,defaultCount:i,moreButtonStyle:r,moreButtonTitleStyle:s,isSearching:d}=e;const{layoutStore:c}=(0,X().LH)(),{collectionStore:u}=(0,X().bi)(),g=(0,le().h)(),f=(0,a().K8)((()=>{const e=c.getModules();return new Set((0,n(36682).Q)(e).filter(se().gx).map((e=>e.propertyId)))}),[c]),[h,y]=o.useState(!1);return(0,a().K8)((()=>{const e=u.getSchema();if(!c.getModel())return[];const o=(0,m().WP)(e).filter(de).sort(((e,n)=>{const o=e[1],i=n[1];return(t[o.type]??1/0)-(t[i.type]??1/0)})).map((e=>{let[t,o]=e;if(t!==z().rn&&!f.has(t))return(0,z().JY)(o)?{id:(0,te().Ay)(),type:`property_${o.type}`,propertyId:t,style:"compact"}:(0,z().AM)(o)?{id:(0,te().Ay)(),type:`property_${o.type}`,propertyId:t,style:"large"}:"formula"===o.type?{id:(0,te().Ay)(),type:`property_${o.type}`,propertyId:t,style:(0,n(708685).isNumberFormulaPropertySchema)(o)?"large":"small"}:"file"===o.type?{id:(0,te().Ay)(),type:`property_${o.type}`,propertyId:t,style:"landscape"}:{id:(0,te().Ay)(),type:`property_${o.type}`,propertyId:t}})).filter(m().O9).map((t=>{const o=(0,re()._g)({schema:e,property:t.propertyId});if(o)return{key:t.id,keywords:[o.name,J().dC[o.type]],render:e=>{let{ref:o,...i}=e;return(0,l.jsx)(n(63667).k,{...i,propertyId:t.propertyId})},action:()=>{g({layoutModule:t})}}})).filter(m().O9),a={keywords:[],key:"use-existing-property-show-more",render:e=>(0,l.jsx)(Y().A,{...e,buttonStyle:r,desktopTitleStyle:s,title:h?(0,l.jsx)(p().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,l.jsx)(p().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>y((e=>!e))};return o.length>i&&!d?[...h?o:o.slice(0,i),a]:o}),[g,u,c,f,t,i,h,r,s,d])}var ue=()=>n(478573);function pe(e){const{propertyId:t}=e,{collectionStore:n}=(0,X().bi)(),o=(0,r().DP)(),i=(0,a().K8)((()=>{const e=n.getSchema();return(0,re()._g)({schema:e,property:t})}),[n,t]);return i?(0,l.jsx)(ue().A,{...e,icon:(0,l.jsx)(W().Ay,{size:16,theme:o,icon:i.icon,type:i.type}),name:i.name}):null}function me(){const{layoutStore:e,currentModuleSelection:t}=(0,X().LH)(),{collectionStore:r}=(0,X().bi)(),s=(0,n(963589).X)("collection_view_module"),d=(0,i().v3)(),c=(0,le().h)(),u=(0,o.useCallback)((t=>{const o=(0,n(957568).createRelationViewsModule)({environment:d,collectionStore:r,relationPropertyId:t,layoutStore:e});o&&c({layoutModule:o})}),[c,r,e,d]),p=(0,a().K8)((()=>"new_module"===(null==t?void 0:t.type)&&"page_details"===t.area),[t]);return(0,a().K8)((()=>{if(!s||p)return[];const t=r.getSchema();if(!e.getModel())return[];return Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,z().nC)(n)&&(0,m().O9)(n.property)})).map((e=>{const n=(0,re()._g)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...o}=t;return(0,l.jsx)(pe,{...o,propertyId:e})},action:()=>{u(e)}}})).filter(m().O9)}),[s,p,r,e,u])}const ge=(0,p().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),fe={file:{icon:T().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:T().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:ge.propertyFileCaption}},ai_summary:{icon:T().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:T().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:ge.propertyAiSummaryCaption}},person:{icon:T().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:T().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:ge.propertyPersonCaption}},text:{icon:H,tooltip:{image:T().A.images.tooltips.blocks.textPng,caption:ge.propertyTextCaption}},number:{icon:T().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:T().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:ge.propertyNumberCaption}}},he={file:1,ai_summary:2,number:3,text:4,person:5},ye=o.memo((function(){const e=(0,i().v3)(),t=(0,r().DP)(),s=(0,p().tz)(),{currentModuleSelection:d,isPropertyTypeSearchInputDirtyStore:c}=(0,X().LH)(),u=(0,Z().ET)(),m="new_module"===(null==d?void 0:d.type)&&"page_details"===d.area,g=(0,a().K8)((()=>[...(0,J().xm)({collectionContextStore:u,environment:e}),"ai_summary"].sort(((e,t)=>(he[e]??1/0)-(he[t]??1/0)))),[u,e]),f=me(),[h,y]=(0,o.useState)(!1),[v,x]=(0,o.useState)(),S=(0,o.useCallback)((e=>{c.setState(!0),x(e.target.value)}),[c]);o.useEffect((()=>()=>{c.setState(!1)}),[c]);const M=ie(),A=ae(),C=(0,o.useMemo)((()=>({actionHandler:e=>M({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=fe[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=fe[e],o="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return o&&"string"!=typeof o?o({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,W().Yw)(t)}):(0,l.jsx)(W().Ay,{size:o?36:16,theme:t,type:e,icon:o,style:{fill:(0,z().hN)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,z().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{A({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[M,t,A]),w=(0,n(959733).g)(C),j=(0,r().IS)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:L().Wy.medium,marginLeft:8,paddingBottom:2},closeButton:{marginLeft:"auto",marginRight:4},searchInputContainer:{marginTop:8,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.mediumIconColor,width:10},moreButton:{marginLeft:0},moreButtonTitle:{margin:0,color:e.lightTextColor,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),k=(0,a().K8)((()=>{const e=v||h,t={keywords:[],key:"create-new-property-more",render:e=>(0,l.jsx)(Y().A,{...e,buttonStyle:j.moreButton,desktopTitleStyle:j.moreButtonTitle,title:h?(0,l.jsx)(p().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,l.jsx)(p().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>y((e=>!e))};return[...g.slice(0,e?void 0:5).map(w),...v?[]:[t]]}),[g,h,w,v,j.moreButton,j.moreButtonTitle]),I=ce({propertySortPriority:he,defaultCount:4,moreButtonStyle:j.moreButton,moreButtonTitleStyle:j.moreButtonTitle,isSearching:Boolean(v)}),T=(0,o.useMemo)((()=>{const e=[];return I.length>0&&e.push({key:"existing-properties",render:e=>(0,l.jsx)($().A,{title:s.formatMessage(ge.existingPropertiesSectionTitle),desktopTitleStyle:j.sectionTitle,...e}),items:I}),e.push({key:"create-new-properties",render:e=>(0,l.jsx)($().A,{title:s.formatMessage(ge.createNewPropertyModuleSectionTitle),desktopTitleStyle:j.sectionTitle,...e}),items:k}),f.length>0&&e.push({key:"related-collection-properties",render:e=>(0,l.jsx)($().A,{title:s.formatMessage(ge.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:j.sectionTitle,...e}),items:f}),e}),[k,I,s,f,j.sectionTitle]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b().Ye,{style:j.sidebarHeading,alignItems:"center",children:(0,l.jsx)(p().sA,{...m?ge.addToPanel:ge.addToPage})}),(0,l.jsx)(q().Ay,{focusInitial:!0,onChange:S,placeholder:s.formatMessage(ge.searchInputPlaceholder),showClearButton:!0,value:v||"",style:j.searchInputContainer,inputOuterStyle:j.searchInput,inputLeft:(0,G().q)(j.searchInputIcon),itemMarginLeft:0}),(0,l.jsx)(n(387881).j,{filterQuery:v,initialFocus:0,type:Q().Oh.Vertical,sections:T})]})}));var ve=()=>n(435930),be=(n(803949),()=>n(124672)),xe=()=>n(623186),Se=()=>n(171018),Me=(n(430670),n.n(n(844751))),Ae=()=>n(757695),Ce=()=>n(591779),we=()=>n(643707),je=()=>n(135154),ke=()=>n(953418);function Ie(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:r}=e,s=o.useMemo((()=>Ae().default.createValue("")),[]),[l,d]=o.useState([]),[c,u]=o.useState({}),[p,m]=o.useState(null),g=o.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(r);return n&&(e=e.filter((e=>!n.has(e)))),e}),[r,t,n]),f=(0,a().O$)(s),h=(0,Ce().lW)(f,100,((e,t)=>e===t));o.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of g){const o=r[n];o&&null!==Me().match(h,o.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[g,l,h,r]),o.useEffect((()=>{if(0===l.length)return void m(null);const e=null!==p?l[p]:null;e&&void 0!==c[e]?m(c[e]):m(0)}),[p,l,c]);const y=(0,i().v3)(),v=null!==p?l[p]:null;return o.useEffect((()=>{const e=document.getElementsByClassName(we().wT).item(0);e&&!(0,je().E)({element:e})&&(0,ke().uf)({el:e,environment:y,windowHeight:window.innerHeight,minEdgeDist:16})}),[y,v]),{searchInputValueStore:s,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:p,moveToNextSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p+1;m(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p-1;m(e>=0?e:l.length-1)}}}var Te=()=>n(530041);function Pe(e){let{propertyGroupId:t,pagePropertiesStore:n}=e;const{collectionStore:o}=(0,X().bi)(),i=(0,r().IS)((e=>({button:{color:e.text.secondary,paddingLeft:8,height:34},buttonIcon:{fill:e.icon.secondary,marginRight:8}})),[]);return(0,l.jsx)(Te().Xt,{style:i.button,iconStyle:i.buttonIcon,collectionStore:o,isInPeekRenderer:!1,propertyGroupId:t,pagePropertiesStore:n})}const _e=o.memo(Pe);n(16280);var Be=()=>n(158359),Le=()=>n(498474),Re=()=>n(957963),De=()=>n(735384),Oe=()=>n(919709),Ne=()=>n(496603),Ee=()=>n(493823),Fe=()=>n(406699),Ue=()=>n(57232),Ve=()=>n(805751),Ke=()=>n(623580),ze=()=>n(928600),We=()=>n(14235),He=()=>n(204063),Ge=()=>n(722872),Ye=()=>n(463830),qe=()=>n(395963);class Qe extends Ae().default{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const $e=new Qe;function Ze(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:s,isLastPropertyGroup:d,styles:c}=e,u=(0,a().uB)(void 0,Ye().A),m=(0,a().K8)((()=>$e.isRenameInputForcedOpenForGroup(n)),[n]),[g,f]=(0,o.useState)(m);(0,o.useEffect)((()=>{u.setState({...u.state,open:m})}),[u,m]);const h=(0,o.useCallback)((()=>{f(!1),$e.resetForceRenameInputOpen()}),[]),y=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{O().createAndCommit({environment:t,perform(t){(0,qe().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{O().createAndCommit({environment:t,perform(t){(0,qe().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),b=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{O().createAndCommit({environment:t,perform(t){(0,qe().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),x=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==c?void 0:c.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginRight:"auto",paddingLeft:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.mediumTextColor,fontWeight:500,padding:"0 8px 0 5px",display:"block",...L().RC},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[c]);return(0,l.jsx)("div",{style:x.container,children:(0,l.jsx)(Fe().Ay,{style:{width:268},onClose:h,popupType:We().nl.Popup,renderOrigin:e=>(0,l.jsxs)(Ee().p,{...e,style:x.titleContainer,children:[(0,l.jsx)(Ue().A,{iconSize:12,iconStyle:x.dragIcon}),(0,l.jsx)("div",{style:x.label,children:t})]}),buttonPopupStore:u,alignmentToOrigin:M().C.Start,render:e=>{return g?(0,l.jsx)(Je,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,l.jsx)(ze().A,{menuType:Ge().gu.Popup,children:(0,l.jsx)(Q().Ay,{type:Q().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,l.jsx)($().A,{...e}),items:(o=e.close,(0,Ne().oE)([{key:"rename",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,Re().j)(x.menuIcon),title:(0,l.jsx)(p().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{f(!0)}},!s&&{key:"move-up",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,Le().q)(x.menuIcon),title:(0,l.jsx)(p().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{v(n),o()}},!d&&{key:"move-down",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,Be().P)(x.menuIcon),title:(0,l.jsx)(p().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{b(n),o()}},{key:"delete",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,De().I)({width:16,height:16}),title:(0,l.jsx)(p().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,l.jsx)(p().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{y(n),o()}}]))}]})});var o}})})}function Je(e){let{propertyGroupId:t,afterSubmit:n,value:a}=e;const[s,d]=(0,o.useState)(a),c=(0,r().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),u=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)(((n,o)=>{const i=e.getNormalizedPropertyGroups();if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const a=i.map((e=>e.id===n?{...e,title:o}:e));O().createAndCommit({environment:t,perform(t){D().zA({stores:[e],update:{property_groups:a},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),m=(0,o.useCallback)((()=>{const e=(0,Oe().xV3)(s).trim();0!==e.length&&(u(t,e),n())}),[n,u,s,t]),g=(0,o.useCallback)((e=>{d(e.target.value)}),[]);return(0,l.jsx)(Ve().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,l.jsxs)("div",{style:c.container,children:[(0,l.jsx)(Ke().A,{style:c.input,onSubmit:m,selectAll:!0,value:s,onChange:g,focusInitial:!0}),(0,l.jsx)(He().A,{style:c.button,onClick:m,children:(0,l.jsx)(p().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var Xe=()=>n(387358),et=()=>n(439264),tt=()=>n(116854);function nt(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:i}=e,{collectionStore:r}=(0,X().bi)(),s=(0,a().K8)((()=>null==n?void 0:n.map((e=>e.property))),[n]),d=(0,o.useCallback)(((e,t)=>i({propertyId:e,rowIndex:t})),[i]),c=(0,xe().Od)({collectionStore:r,format:t});return s?(0,l.jsx)(et().Ay,{keys:s,onDrop:c,direction:"vertical",renderKey:d}):null}function ot(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:r}=e,s=(0,i().v3)(),{collectionStore:d}=(0,X().bi)(),c=(0,a().K8)((()=>d.getNormalizedPropertyGroups()??[]),[d]),u=(0,o.useMemo)((()=>Object.fromEntries(c.map((e=>[e.id,e])))),[c]),p=(0,a().K8)((()=>c.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,Xe().Op)(e.id)]}}))),[c]),g=(0,o.useCallback)((e=>{let{flattenedKeys:t,isSection:n}=e;return n?new Set(t.flatMap(((e,t)=>(0,m().O9)(u[e])?[]:[t]))):new Set(t.flatMap(((e,t)=>(0,Xe().k9)(e)?[t+1]:[])))}),[u]),f=(0,o.useCallback)((e=>{var o;return e.isSection?n({groupId:e.key,groupTitle:null===(o=u[e.key])||void 0===o?void 0:o.title,rowIndex:e.sectionIndex}):(0,Xe().k9)(e.key)?r((0,Xe().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[u,r,n,t]),h=(0,o.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,Xe().k9)(e))),o="string"==typeof e.key?e.key:e.key.key;return{id:o,title:null===(t=u[o])||void 0===t?void 0:t.title,propertyIds:n}}));O().createAndCommit({environment:s,perform(e){(0,qe().Yf)({collectionStore:d,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[d,s,u]);return(0,l.jsx)(tt().A,{direction:"vertical",sections:p,renderKey:f,onDrop:h,getInvalidDropIndices:g})}var it=()=>n(851979),at=()=>n(369);const rt=(0,s().wt)("eyelash",{viewBox:"0 0 16 16",svg:(0,l.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var st=()=>n(68350);function lt(e){let{collectionStore:t,pageStore:n,layoutModule:i,pagePropertiesStore:s,propertyId:d,draggable:c,rightButton:u,searchHighlighted:p}=e;const m=(0,a().K8)((()=>n.isNonEditableState()),[n]),{collectionSchema:g,collectionFormat:f,canEditCollection:h}=(0,a().K8)((()=>({collectionSchema:t.getSchema(),collectionFormat:t.getFormat(),canEditCollection:t.canEdit()})),[t]),y=(0,r().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingLeft:2}})),[]),v=(0,o.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),b=Boolean(p),x=Boolean(p&&p.active);return(0,l.jsxs)("div",{style:y.propertyRowContainer,children:[(0,l.jsx)(st().I,{schema:g,styleVariants:v,format:f,property:d,collectionStore:t,disabled:!1,locked:m,canConfigureCollection:h,isInPeekRenderer:!1,hideDragHandle:!c,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginRight:2},blockStore:n,pagePropertiesStore:s,layoutModule:i,forceHighlight:b,forceFocusedHighlight:x}),u?u():null]})}function dt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:r,collectionStore:s,pageStore:d,searchHighlighted:c}=e,u=(0,p().tz)(),m=(0,i().v3)(),g=(0,a().K8)((()=>s.getSchema()),[s]),h=(0,a().K8)((()=>(0,_().L)(s.getFormat(),g,void 0,P().jf.Collection)),[s,g]),y=g[t],v=(0,o.useCallback)((e=>{O().createAndCommit({environment:m,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{R().D7({property:t,visibility:e,store:s,format:h,transaction:n})}})}),[h,s,m,t]),b="show"===(null==n?void 0:n.visibility)?it().h:"hide_if_empty"===(null==n?void 0:n.visibility)?at().R:rt,x="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!y)return null;return(0,l.jsx)(lt,{pageStore:d,collectionStore:s,propertyId:t,pagePropertiesStore:r,draggable:!0,rightButton:()=>(0,l.jsx)(Fe().Ay,{popupType:We().nl.Popup,renderOrigin:e=>(0,l.jsx)(f().A,{ariaLabel:u.formatMessage(ut.visibilityToggleIconAriaLabel,{propertyName:y.name}),icon:b,isDarkIconColor:x,...e}),alignmentToOrigin:M().C.Start,render:e=>(0,l.jsx)(ct,{parentClose:e.close,setVisibilityOfProperty:v})}),searchHighlighted:c,layoutModule:e.layoutModule})}function ct(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,o.useMemo)((()=>[{key:0,render:e=>(0,l.jsx)($().A,{...e}),items:[{key:"always_show",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,it().h)({width:16,height:16}),title:(0,l.jsx)(p().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,l.jsx)(Y().A,{...e,icon:(0,at().R)({width:16,height:16}),title:(0,l.jsx)(p().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,l.jsx)(Y().A,{...e,icon:rt({width:16,height:16}),title:(0,l.jsx)(p().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,l.jsx)(ze().A,{menuType:Ge().gu.Popup,children:(0,l.jsx)(Q().Ay,{type:Q().Oh.Vertical,initialFocus:0,sections:i})})}const ut=(0,p().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),pt=(0,p().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not Found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function mt(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:i,moveToNextSearchMatch:s,moveToPreviousSearchMatch:d}=e,c=(0,a().O$)(t),u=(0,p().tz)(),m=o.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),s()):"ArrowUp"===e.key?d():"ArrowDown"===e.key&&s()}),[s,d]),g=(0,r().IS)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginRight:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.mediumIconColor,width:10},searchInputOuter:{background:e.white}})),[]),h=o.useMemo((()=>{if(""!==c)return(0,l.jsxs)(b().Ye,{alignItems:"center",gap:8,children:[(0,l.jsx)("div",{children:null!==n?`${n+1} of ${i.length}`:u.formatMessage(pt.notFound)}),null!==n&&(0,l.jsxs)(b().Ye,{gap:0,alignItems:"center",children:[(0,l.jsx)(f().A,{icon:Be().P,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(pt.arrowButtonDownAriaLabel),onClick:s}),(0,l.jsx)(f().A,{icon:Le().q,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(pt.arrowButtonUpAriaLabel),onClick:d})]})]})}),[c,n,i.length,u,g,s,d]);return(0,l.jsx)(q().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:m,placeholder:u.formatMessage(pt.filterPropertiesInputPlaceholder),showClearButton:!0,value:c,inputLeft:(0,G().q)(g.searchInputIcon),inputOuterStyle:g.searchInputOuter,inputRightStyle:g.searchMatchCount,inputRight:h})}function gt(e){const{module:t}=e,{layoutStore:n}=(0,X().LH)(),{collectionStore:i,pageStore:s}=(0,X().bi)(),d=(0,a().K8)((()=>n.getModules()),[n]),c=(0,a().K8)((()=>i.getSchema()),[i]),u=(0,a().K8)((()=>(0,_().L)(i.getFormat(),c,void 0,P().jf.Collection)),[i,c]),p=(0,o.useMemo)((()=>new Set((0,be().q)({modulesByArea:d,collectionSchema:c,collectionFormat:u}))),[u,d,c]),g=(0,o.useMemo)((()=>new(Se().YB)),[]),f=(0,a().K8)((()=>i.getNormalizedPropertyGroups()),[i]),y=(0,a().K8)((()=>{const e={};return null==f||f.forEach(((t,n)=>{e[t.id]=n})),e}),[f]),v=(0,xe().z7)({store:s,format:u,schema:c,collectionStore:i}),x=(0,o.useMemo)((()=>{const e={};return v.forEach((t=>e[t.property]=t)),e}),[v]),{searchInputValueStore:S,searchMatches:M,searchMatchesMap:C,activeSearchMatchIndex:w,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k}=Ie({mergedPropertiesMap:x,propertyGroups:f,propertyIdsToExclude:p}),I=(0,o.useCallback)((e=>{let{propertyId:n}=e;if(p.has(n))return null;const o=void 0!==C[n]&&null!==w?{active:n===M[w]}:void 0;return(0,l.jsx)(dt,{propertyId:n,propertyFormat:x[n],collectionStore:i,pagePropertiesStore:g,pageStore:s,searchHighlighted:o,layoutModule:t})}),[w,i,x,t,g,s,p,M,C]),T=(0,o.useCallback)((e=>{let{groupId:t,groupTitle:n}=e;const o=y[t],i=0===o,a=(0,m().O9)(f)&&o===f.length-1,r={container:i?void 0:{marginTop:20}};return(0,l.jsx)(Ze,{title:n,propertyGroupId:t,isFirstPropertyGroup:i,isLastPropertyGroup:a,styles:r})}),[y,f]),B=(0,o.useCallback)((e=>(0,l.jsx)(_e,{propertyGroupId:e,pagePropertiesStore:g})),[g]),L=Boolean(v.length&&v.length>p.size),R=(0,r().IS)((e=>({addPropertyButtonContainer:{marginLeft:2,paddingBottom:8},container:{marginTop:L?4:8,height:"100%",overflow:"visible hidden",marginLeft:-Qt,width:`calc(100% + ${2*Qt}px)`},searchInputContainer:{marginRight:Qt,marginLeft:Qt,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingLeft:6,paddingRight:6},listContainer:{padding:`0 ${Qt}px 56px`}})),[L]);return(0,l.jsxs)(b().wt,{style:R.container,children:[L&&(0,l.jsx)("div",{style:R.searchInputContainer,children:(0,l.jsx)(mt,{searchInputValueStore:S,activeSearchMatchIndex:w,searchMatches:M,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k})}),(0,l.jsx)(h().H,{type:A().A.Y,style:R.listContainer,children:Boolean(f)?(0,l.jsx)(ot,{renderPropertyRow:I,renderPropertyGroupRow:T,renderAddPropertyButton:B}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(nt,{collectionFormat:u,mergedProperties:v,renderPropertyRow:I}),(0,l.jsx)("div",{style:R.addPropertyButtonContainer,children:(0,l.jsx)(_e,{pagePropertiesStore:g})})]})})]})}var ft=()=>n(464699),ht=()=>n(115512);const yt=(0,p().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function vt(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)(),n=(0,p().tz)(),a=(0,r().IS)((e=>({button:{fontSize:(0,ht().ny)(t,"UISmall"),color:e.text.secondary,padding:8,fontWeight:L().Wy.medium},icon:{fill:e.icon.secondary,marginRight:4}})),[t]),s=(0,o.useCallback)((()=>{const o=n.formatMessage(yt.newSection),{performResult:i}=O().createAndCommit({environment:t,perform:t=>(0,qe().PA)({collectionStore:e,newGroupTitle:o,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&$e.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,l.jsx)(Ee().p,{icon:ft().b,onClick:s,style:a.button,iconStyle:a.icon,children:(0,l.jsx)(p().sA,{...yt.addSection})})}function bt(e){const{title:t}=e;return(0,l.jsxs)(b().Ye,{justifyContent:"space-between",children:[t,(0,l.jsx)(vt,{})]})}var xt=()=>n(686526),St=()=>n(59400),Mt=()=>n(525432);function At(e){return(0,l.jsx)("div",{style:{marginLeft:-8,marginRight:-8},children:e.children})}function Ct(e){let{module:t}=e;const{collectionStore:n}=(0,X().bi)(),i=(0,Z().ET)(),r=(0,a().K8)((()=>n.getSchema()),[n]),s=(0,a().K8)((()=>{if((0,se().gx)(t))return t}),[t]),d=(0,a().K8)((()=>s&&r[s.propertyId]),[s,r]);if((0,o.useEffect)((()=>{if(s)return xt().Ow({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1}),xt().dP({collectionSettingsStore:i.settingsStore,item:{type:"property",property:s.propertyId,formatKey:void 0}}),()=>{xt().os({collectionSettingsStore:i.settingsStore})}}),[i,s]),!d||!s)return null;const c=(0,l.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:L().Wy.medium},children:J().dC[d.type]});return(0,l.jsx)(At,{children:(0,l.jsx)(St().m$,{collectionContextStore:i,collectionSettingsStore:i.settingsStore,context:Mt().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:c,fullHeight:!0})})}n(672577);var wt=()=>n(487929);function jt(e){let{module:t}=e;const{collectionStore:n,pageStore:o}=(0,X().bi)(),i=(0,r().IS)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:L().J.UISmall.desktop,fontWeight:L().Wy.regular,color:e.text.secondary,marginLeft:8}})),[]);return(0,l.jsxs)("div",{style:i.configureContainer,children:[(0,l.jsx)("div",{style:i.configureDescription,children:(0,l.jsx)(p().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,l.jsx)(kt,{layoutModule:t,pageStore:o,collectionStore:n})]})}function kt(e){let{collectionStore:t,pageStore:n,layoutModule:r}=e;const s=(0,i().v3)(),d=(0,o.useMemo)((()=>new(Se().YB)),[]),{collectionPagePropertySections:c}=(0,a().K8)((()=>{const e=t.getSchema(),n=t.getFormat();return{collectionPagePropertySections:(0,wt().T)({format:n,schema:e,visibilityLevels:["inline","minimal"]})}}),[t]),u=c.map((e=>e.section)),p=(0,o.useCallback)((e=>{if(!c)return;const n=e.map((e=>{const t=c.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));O().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:s,canUndo:!0,perform:e=>{R().LK({environment:s,pageSectionFormats:n,store:t,transaction:e})}})}),[c,t,s]);return c.length?(0,l.jsx)(et().Ay,{direction:"vertical",keys:u,renderKey:e=>(0,l.jsx)(lt,{pageStore:n,collectionStore:t,propertyId:e,pagePropertiesStore:d,layoutModule:r,draggable:!0}),onDrop:e=>p(e)}):null}var It=()=>n(552445),Tt=()=>n(788941),Pt=()=>n(410730),_t=()=>n(447934),Bt=()=>n(33218);function Lt(e){const{environment:t,layoutModule:n,collectionStore:o,layoutStore:i,propertyId:a}=e,r=o.getSchema(),s=i.getModel(),l=null==s?void 0:s.getPageModuleAreaById(n.id);if(!l||!s||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let o,i=[...t??[]];return i.includes(e)?(i=i.filter((t=>t!==e)),o=!1):(i.push(e),i.length>Pt().U&&(i=(0,re().Vl)(i,n)),o=!0),{isNowPinned:o,pinnedPropertyIds:i}}(a,n.propertyIds,r),c={...n,propertyIds:d};O().createAndCommit({environment:t,perform(e){(0,_t().HD)({environment:t,transaction:e,property:a,layoutStore:i}),(0,Bt().UQ)({environment:t,transaction:e,layoutStore:i,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Rt=()=>n(557198);function Dt(e){let{module:t}=e;const{collectionStore:n,pageStore:s}=(0,X().bi)(),d=(0,i().v3)(),{layoutStore:c}=(0,X().LH)(),u=(0,a().K8)((()=>n.getSchema()),[n]),g=(0,a().K8)((()=>(0,_().L)(n.getFormat(),u,void 0,P().jf.Collection)),[n,u]),f=(0,o.useMemo)((()=>new(Se().YB)),[]),h=(0,o.useMemo)((()=>"normalizedTitleWithIcon"!==t.type?[]:(0,re().Vl)(t.propertyIds,u)),[t,u]),y=(0,o.useMemo)((()=>new Set(h)),[h]),x=(0,a().K8)((()=>{var e;return null===(e=g.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,z().NM)(e)&&!y.has(e)))}),[g.property_visibility,y]),S=(0,a().K8)((()=>(0,m().uv)(u)),[u]),A=(0,xe().z7)({store:s,format:g,schema:u,collectionStore:n,propertyIds:S}),C=(0,o.useMemo)((()=>{const e={};for(const t of A)e[t.property]=t;return e}),[A]),{searchInputValueStore:w,searchMatches:j,activeSearchMatchIndex:k,moveToNextSearchMatch:I,moveToPreviousSearchMatch:T,searchMatchesMap:B}=Ie({mergedPropertiesMap:C,propertyGroups:void 0,propertyIdsToExclude:void 0}),R=function(e){const t=(0,i().v3)(),{layoutStore:n}=(0,X().LH)();return(0,o.useCallback)((o=>{const i=n.getModel(),a=null==i?void 0:i.getPageModuleAreaById(e.id);if(!a||!i)return;const r={...e,propertyIds:o};O().createAndCommit({environment:t,perform(o){(0,Bt().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:a,moduleId:e.id},updatedModule:r})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),D=(0,r().IS)((e=>{const t={fontSize:L().J.UISmall.desktop,lineHeight:"24px",color:e.mediumTextColor,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginLeft:-Qt,width:`calc(100% + ${2*Qt}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${Qt+6}px 0`},scrollableContainer:{padding:`0 ${Qt}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginLeft:8},popoverMessage:{color:e.lightTextColor,fontSize:L().J.UISmall.desktop,marginTop:10},optionsContainer:{marginTop:24},optionsLabel:{...t,marginLeft:6,marginBottom:6},switcherButton:{marginRight:0},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),N=h.length?(0,l.jsx)(et().Ay,{keys:h,onDrop:R,direction:"vertical",renderKey:e=>(0,l.jsx)(Nt,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:f,searchHighlighted:null!==k&&void 0!==B[e]?{active:e===j[k]}:void 0})}):null,V=h.length>=Pt().U,K=x.map((e=>(0,l.jsx)(Nt,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1,pinButtonDisabled:V,pagePropertiesStore:f,searchHighlighted:null!==k&&void 0!==B[e]?{active:e===j[k]}:void 0},e))),W=Ot(t),H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.jsx)(Te().Xt,{...e,style:D.addPropertyButton,iconStyle:D.addPropertyButtonIcon,collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:f,onPropertyAdded:W,disabled:V})},{backlinksVisibility:G,updateBacklinksVisibility:Y}=(0,Rt().Ap)({store:n,format:g}),q=(0,p().tz)(),Q=(0,o.useCallback)((()=>{const e="show"===t.propertyLabels||!t.propertyLabels;O().createAndCommit({environment:d,perform(n){var o;const i=null===(o=c.getModel())||void 0===o?void 0:o.getPageModuleAreaById(t.id);i&&(0,Bt().UQ)({environment:d,transaction:n,layoutStore:c,position:{area:i,moduleId:t.id},updatedModule:{...t,propertyLabels:e?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[t,d,c]),$=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{...D.pinnedPropertiesLabel},children:(0,l.jsx)(p().sA,{...Et.pinnedPropertiesLabel})}),N,(0,l.jsx)("div",{style:{marginLeft:2},children:V?(0,l.jsx)(v().A,{placement:M().W.Left,render:e=>H(e),renderTooltip:()=>q.formatMessage(Et.maxPinnedPropertiesAddPropertyTooltip,{br:(0,l.jsx)("br",{})})}):H()}),K.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{...D.pinnedPropertiesLabel,marginTop:24},children:(0,l.jsx)(p().sA,{...Et.unpinnedPropertiesLabel})}),K]})]});return(0,l.jsxs)(b().wt,{style:D.container,children:[(0,l.jsx)("div",{style:D.propertySearchInputContainer,children:(0,l.jsx)(mt,{activeSearchMatchIndex:k,searchMatches:j,moveToNextSearchMatch:I,moveToPreviousSearchMatch:T,searchInputValueStore:w})}),(0,l.jsxs)("div",{style:D.scrollableContainer,children:[$,(0,l.jsxs)("div",{style:D.optionsContainer,children:[(0,l.jsx)("div",{style:D.optionsLabel,children:(0,l.jsx)(p().sA,{...Et.optionsLabel})}),(0,l.jsx)(E().A,{title:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:Q,right:(0,l.jsx)(F().A,{on:"show"===t.propertyLabels||void 0===t.propertyLabels}),rightStyle:D.switcherButton}),(0,l.jsx)(E().A,{right:(0,l.jsx)(U().p7,{currentVisibility:G,onSelect:Y}),rightStyle:D.switcherButton,title:(0,l.jsx)(p().sA,{...Et.showBacklinksOption})})]})]})]})}function Ot(e){const{layoutStore:t}=(0,X().LH)(),{collectionStore:n}=(0,X().bi)(),a=(0,i().v3)();return(0,o.useCallback)((o=>{Lt({environment:a,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:o})}),[a,e,n,t])}function Nt(e){let{layoutModule:t,propertyId:n,isPinned:o,pinButtonDisabled:i,...s}=e;const d=(0,p().tz)(),c=(0,r().DP)(),{collectionStore:u,pageStore:m}=(0,X().bi)(),g=(0,a().K8)((()=>u.getSchema()),[u])[n],h=Ot(t);if(!g)return null;const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.jsx)(f().A,{...e,disabled:i,ariaLabel:o?d.formatMessage(Et.toggleUnpinnedAriaLabel,{propertyName:g.name}):d.formatMessage(Et.togglePinnedAriaLabel,{propertyName:g.name}),icon:o?Tt().b:It().N,iconStyle:{fill:c.icon.primary},onClick:()=>h(n)})};return(0,l.jsx)(lt,{pageStore:m,collectionStore:u,propertyId:n,layoutModule:t,rightButton:()=>i?(0,l.jsx)(v().A,{placement:M().W.Left,render:e=>y(e),renderTooltip:()=>d.formatMessage(Et.maxPinnedPropertiesTooltip,{br:(0,l.jsx)("br",{})})}):y(),...s})}const Et=(0,p().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},noUnpinnedPropertiesMessage:{id:"pageLayout.configurePinnedProperties.noUnpinnedPropertiesMessage",defaultMessage:"No properties to pin"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"},showPropertyLabelsOption:{id:"pageLayout.configurePinnedProperties.showPropertyLabelsOption",defaultMessage:"Show property labels"}});var Ft=()=>n(180762);const Ut=o.memo((function(e){let{module:t}=e;const{moduleStateByIdStore:o}=(0,X().bi)(),i=(0,a().K8)((()=>{var e;return null===(e=o.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[o,t.id]),s=(0,a().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),d=(0,a().K8)((()=>null==i?void 0:i.settingsStore),[i]),c=(0,r().IS)((()=>({titleWrapper:{...Ht,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),u=(0,a().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===t.type&&i&&d&&u?(0,l.jsx)(At,{children:(0,l.jsx)(Z().p2.Provider,{value:i,children:(0,l.jsx)(St().m$,{collectionContextStore:i,collectionSettingsStore:d,context:Mt().Bd.ViewSettings})})}):(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:c.titleWrapper,children:(0,l.jsx)(p().sA,{...ve().s.viewsMain})}),(0,l.jsxs)("div",{style:c.viewsContainer,children:[(0,l.jsx)(Vt,{collectionContextStore:i,currentViewId:s,module:t}),"viewsMain"===t.type&&(0,l.jsx)(n(546418).ConfigureViewsMainModuleAddNewViewButtonWrapper,{renderOrigin:e=>(0,l.jsx)(Ee().p,{icon:n(689094).W,isGray:!0,...e,children:(0,l.jsx)(p().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})})]})]})}));function Vt(e){let{collectionContextStore:t,currentViewId:o,module:r}=e;const s=(0,i().v3)(),d=(0,a().K8)((()=>{if(!t)return[];const e=t.collectionViewBlockStore(),n=null==e?void 0:e.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[t]);return"editor"===r.type?(0,l.jsx)(Ee().p,{children:(0,l.jsx)("div",{style:{fontWeight:600},children:(0,l.jsx)(p().sA,{...ve().s.editor})})},"editor"):d&&t?(0,l.jsx)(l.Fragment,{children:d.map((e=>(0,l.jsx)(Ee().p,{icon:t=>(0,l.jsx)(n(745266).h,{viewIcon:e.icon,viewType:e.type,color:"regular",style:t}),onClick:()=>{(0,Ft().t)({environment:s,collectionContextStore:t,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),xt().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore})},children:(0,l.jsx)("div",{style:{fontWeight:e.id===o?600:void 0},children:void 0!==e.type?(0,n(519839).OO)({collectionViewName:e.name,collectionViewType:e.type}):(0,l.jsx)(p().sA,{...Kt.newView})})},e.id)))}):null}const Kt=(0,p().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"},back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}});function zt(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,X().bi)(),o=(0,a().K8)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),i=(0,a().K8)((()=>null==o?void 0:o.settingsStore),[o]);return t&&o&&i?(0,l.jsx)(At,{children:(0,l.jsx)(Z().p2.Provider,{value:o,children:(0,l.jsx)(St().m$,{collectionContextStore:o,collectionSettingsStore:i,context:Mt().Bd.ViewSettings})})}):null}function Wt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,X().LH)(),o=(0,a().K8)((()=>n.getModuleById(t)),[n,t]),i=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==o?void 0:o.type)&&"normalizedTitleWithIcon"!==(null==o?void 0:o.type)?{paddingBottom:80}:{height:"100%"}}})),[null==o?void 0:o.type]);return o?(0,l.jsxs)("div",{style:i.container,children:[(s=o,"viewsMain"!==s.type&&"editor"!==s.type&&!(0,se().gx)(s)&&(0,l.jsx)(Gt,{module:o})),(0,l.jsx)(Yt,{module:o})]}):null;var s}const Ht={fontWeight:L().Wy.medium,marginBottom:0,marginLeft:6,fontSize:16,lineHeight:"24px"};function Gt(e){const{module:t}=e,n=(0,l.jsx)("div",{style:Ht,children:(0,l.jsx)(p().sA,{...ve().s[t.type]})});return"properties"===t.type?(0,l.jsx)(bt,{title:n}):n}function Yt(e){const{module:t}=e;if((0,se().gx)(t))return(0,l.jsx)(Ct,{module:t});const{type:n}=t;switch(n){case"properties":return(0,l.jsx)(gt,{module:t});case"normalizedTitleWithIcon":return(0,l.jsx)(Dt,{module:t});case"relationsGroup":return(0,l.jsx)(jt,{module:t});case"views":return(0,l.jsx)(zt,{module:t});case"viewsMain":case"editor":return(0,l.jsx)(Ut,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":return null;default:(0,m().HB)(n)}return null}const qt=290,Qt=16;function $t(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,X().LH)(),{collectionStore:o,pageStore:i}=(0,X().bi)(),s=(0,a().K8)((()=>{const e=o.getFormat(),t=o.getSchema();return(0,_().L)(e,t,void 0,P().jf.Collection)}),[o]),d=(0,r().IS)((t=>({container:{padding:`8px ${Qt}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:qt,width:qt,maxWidth:qt},title:{fontSize:16,lineHeight:"24px",fontWeight:L().Wy.medium,margin:"0px 8px 0px 8px"},label:{fontSize:L().J.UISmall.desktop,fontWeight:L().Wy.medium,margin:"24px 8px 6px 8px",color:t.text.secondary},switcherButton:{marginRight:0}})),[e]),c=(0,a().K8)((()=>Boolean(o.getFormat().external_object_id)),[o]);return e?(0,l.jsxs)(h().H,{type:A().A.Y,style:d.container,children:["existing_module"===e.type&&(0,l.jsx)(Wt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,l.jsx)(ye,{})]}):(0,l.jsxs)("div",{style:d.container,children:[(0,l.jsx)("div",{style:d.title,children:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,l.jsx)(Zt,{collectionStore:o,layoutStore:t,sessionId:n,styles:d}),(0,l.jsx)("div",{style:d.label,children:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,l.jsx)(Xt,{disabled:c,collectionStore:o,normalizedCollectionFormat:s,styles:d}),(0,l.jsx)(Jt,{disabled:c,collectionStore:o,normalizedCollectionFormat:s,styles:d}),(0,l.jsx)(en,{layoutStore:t,styles:d}),(0,l.jsx)(tn,{pageStore:i,layoutStore:t,styles:d})]})}function Zt(e){const{collectionStore:t,layoutStore:n,sessionId:r,styles:s}=e,d=(0,i().v3)(),c=(0,a().K8)((()=>n.isTabbedPageLayout()),[n]),{value:u}=(0,V().fJ)(K.switchFromSimpleToTabbedLayoutActions),{value:g}=(0,V().fJ)(K.switchFromTabbedToSimpleLayoutActions),f=!u||!g,h=c?"tabbed":"simple",y=(0,o.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:T().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:T().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),v=(0,o.useCallback)((async e=>{u&&g&&("simple"===e?g.switchFromTabbedToSimpleLayout({environment:d,layoutStore:n}):"tabbed"===e?await u.switchFromSimpleToTabbedLayout({environment:d,layoutStore:n}):(0,m().HB)(e),(0,C().GF)({environment:d,layoutId:n.id,collectionId:t.id,sessionId:r,structure:e}))}),[u,g,d,n,t.id,r]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:s.label,children:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,l.jsx)(N().A,{disabled:f,options:y,selectedOption:h,onOptionSelected:v,height:"tall"})]})}function Jt(e){var t;const{disabled:n,collectionStore:a,normalizedCollectionFormat:r,styles:s}=e,d=(0,i().v3)(),c="section_hide"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",u=(0,o.useCallback)((e=>{const t=a.getFormat(),n=a.getSchema(),o=(0,_().L)(t,n,void 0,P().jf.Collection);R().OD({environment:d,pageSection:"comments",visibility:e,store:a,format:o})}),[a,d]);return(0,l.jsx)(E().A,{title:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"}),right:(0,l.jsx)(U().kS,{disabled:n,currentVisibility:c,onSelect:u}),rightStyle:s.switcherButton})}function Xt(e){var t;const n=(0,i().v3)(),{disabled:a,collectionStore:r,normalizedCollectionFormat:s,styles:d}=e,c="minimal"===(null===(t=s.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",u=(0,o.useCallback)((e=>{const t=r.getFormat(),o=r.getSchema(),i=(0,_().L)(t,o,void 0,P().jf.Collection);R().OD({environment:n,pageSection:"margin_comments",visibility:e,store:r,format:i})}),[r,n]);return(0,l.jsx)(E().A,{title:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,l.jsx)(U().J8,{disabled:a,currentVisibility:c,onSelect:u}),rightStyle:d.switcherButton})}function en(e){const{layoutStore:t,styles:n}=e,r=(0,i().v3)(),s=(0,a().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),d=(0,o.useCallback)((()=>{O().createAndCommit({environment:r,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;D().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,r]);return(0,l.jsx)(E().A,{title:(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"}),onClick:d,right:(0,l.jsx)(F().A,{on:s}),rightStyle:n.switcherButton})}function tn(e){const{pageStore:t,layoutStore:n,styles:s}=e,d=(0,i().v3)(),c=(0,a().K8)((()=>n.getFormatStore().getKeyValue("page_full_width")),[n]),u=(0,o.useCallback)((()=>{O().createAndCommit({environment:d,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{const o=!n.getFormatStore().getKeyValue("page_full_width");D().zA({stores:[n],update:{page_full_width:o},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&D().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,d,t]),m=(0,r().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,l.jsx)(E().A,{title:(0,l.jsxs)("div",{style:m.title,children:[(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,l.jsx)(v().A,{placement:M().W.Bottom,renderTooltip:()=>(0,l.jsx)(p().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,l.jsx)("div",{...e,children:(0,B().G)(m.icon)}),style:m.tooltip})]}),onClick:u,right:(0,l.jsx)(F().A,{on:Boolean(c)}),rightStyle:s.switcherButton})}var nn=()=>n(421682),on=()=>n(607810),an=()=>n(817942),rn=()=>n(604341),sn=()=>n(475140),ln=()=>n(179034),dn=()=>n(507807);function cn(e){var t;const{layoutStore:o,tabToFocus:i,moduleStateByIdStore:a,environment:r}=e,s=o.pointer,l=o.getModules(),d=(0,sn().EX)(l,(e=>"viewsMain"===e.type));if(!d||!(0,se().y6)(d.module))return;const{module:c}=d,u=null==a||null===(t=a.get(c.id))||void 0===t?void 0:t.collectionContextStore;if(!u)return;const p=n(148832).B.createChildStore(o,c.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;if("page"!==e.getType())return!1;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===s.id})):(0,m().HB)(i),g&&(0,Ft().t)({environment:r,collectionContextStore:u,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}var un=()=>n(792071),pn=()=>n(763824),mn=()=>n(414360),gn=()=>n(630116);async function fn(e){const{environment:t,layoutStore:n,blockPointer:o}=e,i=gn().Bv.createChildStore(n,o);if(await i.load(),!i.isCollectionView())return;const a=i.getCollectionViewStores();await(0,pn().lX)(a,25,(e=>e.load()));const r=a.filter((e=>"page"===e.getType()));if(r.length<=1)return;const s=n.getModules(),l=(0,sn().JO)(s,se().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=r.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=r.filter((e=>e!==c));0!==u.length&&O().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const a of u){var t,o;const r=null===(t=a.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,mn().T)({collectionViewBlockStore:i,collectionViewStore:a,transaction:e}),!r)continue;const s=(null===(o=n.getRawModules())||void 0===o||null===(o=o.views_main_tab_modules)||void 0===o?void 0:o[r])||[];for(const t of s.reverse())O().applyOperation({store:n,transaction:e,operation:un().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});O().applyOperation({store:n,transaction:e,operation:un().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:r})})}}})}const hn=o.memo((function(e){let{children:t,collectionStore:r,pageStore:s,sessionId:d,layoutBuilderModuleSelectionStore:c}=e;const u=(0,i().v3)(),p=(0,a().K8)((()=>{var e;return null===(e=n(351360).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),m=(0,a().K8)((()=>r.getSpaceId()),[r]),g=(0,o.useMemo)((()=>(null==s?void 0:s.id)??(0,n(594794).Z1)({environment:u,table:ln().ev,spaceId:m})),[u,null==s?void 0:s.id,m]),f=(0,o.useCallback)((e=>{var t;if(e.operation.pointer.id===g)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===g)throw new Error("Unexpected operation on temporary page.");return!0}),[g]),h=(0,dn().S)(n(342).oB,{canUndo:!1,shouldPersistOperation:s?void 0:f}),y=(0,a().K8)((()=>{if(s)return s.clone(h.cache);return O().createAndCommit({environment:u,perform(e){const t=n(246826).Wv({environment:u,type:"page",id:g,inMemoryRecordCache:h.cache,transaction:e});return O().applyOperation({store:t,operation:n(134025).op.update({pointer:{id:t.pointer.id,table:ln().ev,spaceId:t.pointer.spaceId},path:[],args:{parent_id:r.id,parent_table:r.table}}),transaction:e}),t},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[r,h.cache,u,s,g]),v=function(e,t){const r=(0,i().v3)(),s=(0,o.useMemo)((()=>new(n(441307).A)(r)),[r]),l=(0,dn().f)(e,t),d=(0,a().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,o.useEffect)((()=>{s.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[s,l,d]),s}(h,r),{unpersistedCollectionStore:b,unpersistedLayoutStore:x,modulesByArea:S}=(0,a().K8)((()=>{const e=v.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[v]),[M,A]=(0,o.useState)(void 0);(0,n(543906).A)((()=>{A((0,Ne().mg)(S))}),!!S);const C=(0,a().uB)(void 0,n(731120).A),w=o.useRef(!1);(0,a().K8)((()=>{p&&b&&!x&&(O().createAndCommit({environment:u,perform:e=>_t().$L({environment:u,transaction:e,collectionStore:b,userId:p}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),w.current=!0)}),[u,b,x,p]);const j=(0,o.useCallback)((async()=>{if(p&&x)return await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const o=n.getBlockChildrenPointers();for(const a of o){var i;null!==(i=n.getModel())&&void 0!==i&&i.isTabbedLayoutCollectionViewBlockPointer(a)&&await fn({environment:t,layoutStore:n,blockPointer:a})}}({environment:u,layoutStore:x}),(0,n(608893).O)({environment:u,layoutStore:x}),h.persist("PageLayoutEditorContext.updateLayout")}),[h,u,x,p]),k=(0,o.useCallback)((()=>{h.reset();const e=r.getLayoutStore();return!!e&&(O().createAndCommit({environment:u,perform(t){Bt().gL({environment:u,transaction:t,layoutStore:e,collectionStore:r})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[r,h,u]),I=(0,a().K8)((()=>c.getState()),[c]),T=(0,a().K8)((()=>y.isReady()&&(null==x?void 0:x.isReady())),[x,y]),[P,_]=(0,o.useState)([]),B=(0,o.useMemo)((()=>new(n(265515).G)),[]),L=(0,o.useCallback)((e=>{if(c.setState(e),x&&e&&"existing_module"===e.type&&e.moduleId){const t=null==x?void 0:x.getModules();if(!t)return;const n=(0,sn().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&cn({tabToFocus:{type:"contentTab"},layoutStore:x,moduleStateByIdStore:B,environment:u})}}),[u,c,B,x]),R=Ae().default.createValue(!1),D=(0,o.useMemo)((()=>x&&{layoutStore:x,collectionStore:b,currentModuleSelection:I,setModuleSelection:L,sessionId:d,addModuleHoverMenuStore:C,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:R,layoutBuilderModuleSelectionStore:c}),[x,b,I,L,d,C,R,c]),N=(0,o.useMemo)((()=>b&&{pageStore:y,hasUnsavedChanges:h.hasChanges,saveChanges:j,moduleIdsMovedFromSidebar:P,setModuleIdsMovedFromSidebar:_,isNewLayout:w.current,initialLayoutModulesByArea:M,resetLayoutToDefault:k,moduleStateByIdStore:B,collectionContextStore:v,collectionStore:b}),[b,y,h.hasChanges,j,P,M,k,B,v]);return T&&x&&D&&N?(0,l.jsx)(Z().RI,{value:v,children:(0,l.jsx)(X().Op.Provider,{value:D,children:(0,l.jsxs)(X().sf.Provider,{value:N,children:[(0,rn().isConsoleEnabled)()&&(0,l.jsx)(yn,{}),t]})})}):null}));function yn(){return(0,o.useEffect)((()=>()=>{(0,rn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,rn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,rn().exposeDebugValue)("baseLayoutEditorContext",(0,X().LH)()),(0,rn().exposeDebugValue)("pageLayoutEditorContext",(0,X().bi)()),null}var vn=n.n(n(32485)),bn=()=>n(212050),xn=()=>n(175947),Sn=()=>n(901389),Mn=()=>n(614505),An=()=>n(16006),Cn=()=>n(38337),wn=()=>n(948914),jn=()=>n(831310),kn=()=>n(668725),In=()=>n(245241),Tn=()=>n(331542),Pn=()=>n(64e3),_n=()=>n(305390),Bn=()=>n(553965),Ln=()=>n(135599);function Rn(e){let{collectionStore:t}=e;const n=(0,o.useRef)(null),[i,r]=o.useState(""),{pageStore:s}=(0,X().bi)(),{results:d,isResultsLoading:c}=(0,Ln().W)({type:In().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,disable:!1,filters:{parentId:t.id},searchQuery:i}),u=(0,a().K8)((()=>c?[{key:"loading",action:()=>{},render:e=>(0,l.jsx)(Pn().A,{...e,title:(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,l.jsx)(Tn().A,{})})})}]:0===d.length?[{key:"no_results",action:()=>{},render:e=>(0,l.jsx)(Pn().A,{...e,title:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:d.map((e=>{const t=(null==s?void 0:s.id)===e.id;return{key:e.id,render:n=>(0,l.jsx)(_n().A,{...n,store:e.store,hidePath:!0,right:t?(0,jn().o)({width:10}):null}),action:()=>{if(t)return;if(!I().A.state.isOpen||"layout-editor"!==I().A.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:I().A.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:I().A.state.sessionId,collectionStore:I().A.state.collectionStore};I().A.setState(n)}}}))),[null==s?void 0:s.id,c,d]),m=(0,l.jsx)($().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,l.jsx)(q().Ay,{ref:n,value:i,placeholder:S().A.formatMessage(On.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{r(e.target.value)},focusInitial:d.length>0||void 0})}),g=(0,l.jsx)(ze().A,{menuType:Ge().gu.Popup,header:m,width:300,children:(0,l.jsx)(Q().Ay,{type:Q().Oh.Vertical,style:{marginBottom:0},sections:[{key:"results",items:u,render:e=>(0,l.jsx)($().A,{...e})}],initialFocus:d.length>0?0:void 0})});return(0,l.jsx)(Fe().Ay,{popupType:Fe().z7.Popup,renderOrigin:e=>(0,l.jsx)(Dn,{...e,pageStore:s}),originGap:2,render:()=>g,onClose:()=>r("")})}function Dn(e){const{pageStore:t,...n}=e,o=(0,r().IS)((e=>({previewButton:{color:e.text.secondary,fontWeight:L().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{...L().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,l.jsx)(v().A,{placement:M().W.Right,renderTooltip:()=>(0,l.jsx)(p().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,l.jsxs)(Ee().p,{...(0,Bn().A)(e,n),style:o.previewButton,children:[(0,l.jsxs)("div",{style:o.previewLabelContainer,children:[(0,l.jsx)("div",{style:o.previewLabel,children:(0,l.jsx)(p().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,l.jsx)(An().A,{store:t,style:o.recordTitle})]}),(0,kn().b)(o.chevronDownIcon)]})})}const On=(0,p().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}}),Nn=(0,s().wt)("settingsNotificationsAndPersonal",{viewBox:"0 0 20 20",svg:(0,l.jsx)("path",{d:"M12.5361 7.54883C13.2744 7.54883 13.9033 7.09082 14.1631 6.44141H16.4258C16.7607 6.44141 17.0479 6.14746 17.0479 5.79199C17.0479 5.43652 16.7676 5.14258 16.4258 5.14258H14.1699C13.9102 4.49316 13.2744 4.03516 12.5361 4.03516C11.7979 4.03516 11.1621 4.49316 10.9023 5.14258H3.59473C3.23242 5.14258 2.95215 5.43652 2.95215 5.79199C2.95215 6.14746 3.23926 6.44141 3.59473 6.44141H10.9023C11.1621 7.09082 11.7979 7.54883 12.5361 7.54883ZM12.5361 6.62598C12.0713 6.62598 11.6953 6.25684 11.6953 5.79199C11.6953 5.31348 12.0713 4.95117 12.5361 4.95117C13.0078 4.95117 13.3701 5.31348 13.3701 5.79199C13.3701 6.25684 13.0078 6.62598 12.5361 6.62598ZM3.56738 9.40137C3.23242 9.40137 2.95215 9.68848 2.95215 10.0508C2.95215 10.3994 3.23926 10.6934 3.56738 10.6934H5.91211C6.16504 11.3428 6.80078 11.8076 7.5459 11.8076C8.27734 11.8076 8.91309 11.3428 9.17285 10.6934H16.4053C16.7607 10.6934 17.0479 10.4062 17.0479 10.0508C17.0479 9.68848 16.7676 9.40137 16.4053 9.40137H9.17285C8.91309 8.75195 8.27734 8.29395 7.5459 8.29395C6.80762 8.29395 6.17188 8.75195 5.91211 9.40137H3.56738ZM7.5459 10.8848C7.07422 10.8848 6.70508 10.5156 6.70508 10.0508C6.70508 9.57227 7.07422 9.20996 7.5459 9.20996C8.01758 9.20996 8.37988 9.57227 8.37988 10.0508C8.37988 10.5156 8.01758 10.8848 7.5459 10.8848ZM12.5361 16.0596C13.2744 16.0596 13.9102 15.6016 14.1699 14.9521H16.4258C16.7607 14.9521 17.0479 14.6582 17.0479 14.3027C17.0479 13.9404 16.7676 13.6533 16.4258 13.6533H14.1631C13.9102 13.0039 13.2744 12.5459 12.5361 12.5459C11.7979 12.5459 11.1621 13.0039 10.9023 13.6533H3.59473C3.23242 13.6533 2.95215 13.9473 2.95215 14.3027C2.95215 14.6582 3.23926 14.9521 3.59473 14.9521H10.9023C11.1621 15.6016 11.7979 16.0596 12.5361 16.0596ZM12.5361 15.1436C12.0713 15.1436 11.6953 14.7676 11.6953 14.3027C11.6953 13.8311 12.0713 13.4619 12.5361 13.4619C13.0078 13.4619 13.3701 13.8311 13.3701 14.3027C13.3701 14.7676 13.0078 15.1436 12.5361 15.1436Z"})});const En=function(){const e=(0,p().tz)(),t=(0,i().v3)(),{setModuleSelection:n,currentModuleSelection:a,layoutStore:s,sessionId:d}=(0,X().LH)(),c=void 0===a,u=(0,o.useCallback)((()=>{var e;null==n||n(void 0),(0,C().L3)({environment:t,layoutId:s.id,collectionId:null===(e=s.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"page_settings_button_click"})}),[n,t,s,d]),m=(0,r().IS)((e=>({button:{...c&&{background:e.state.hover}},icon:{width:18,height:18}})),[c]);return n?(0,l.jsx)(Ee().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),icon:Nn,iconStyle:m.icon,onClick:u,style:m.button,size:"lg",children:(0,l.jsx)(p().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null},Fn=(0,s().xh)("arrowUTurnLeft",{default:{loader:()=>n.e(3170).then(n.bind(n,903170))},small:{loader:()=>n.e(78136).then(n.bind(n,878136))},mini:{loader:()=>n.e(32972).then(n.bind(n,432972))},large:{loader:()=>n.e(67724).then(n.bind(n,467724))}});var Un=()=>n(701545),Vn=()=>n(112452),Kn=()=>n(7674),zn=()=>n(107683),Wn=()=>n(430102),Hn=()=>n(716108),Gn=()=>n(377586);const Yn={id:"pageLayoutAreas.page_main",defaultMessage:"main page",description:"Name for the main area of the page"},qn={id:"pageLayoutAreas.page_details",defaultMessage:"sidebar",description:"Name for the details sidebar"},Qn={id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form",description:"Name for the form area"},$n=(0,p().YK)({page_main:Yn,page_layout_schema:Yn,page_details:qn,page_info_layout_schema:qn,form_layout_schema:Qn,form_conditional_modules:Qn,views_main_tab_modules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab",description:"Name for the views main tab"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}});function Zn(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:s,initialLayoutModulesByArea:d,resetLayoutToDefault:c}=(0,X().bi)(),{sessionId:u,layoutStore:m}=(0,X().LH)(),g=(0,i().v3)(),f=(0,p().tz)(),[h,y]=(0,o.useState)(!1),v=(0,a().K8)((()=>m.getModules()),[m]),x=(0,r().IS)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:L().Wy.medium},saveButtonRevertItemTitle:{fontSize:L().J.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemSubtitle:{fontSize:L().J.UISmall.desktop,lineHeight:"16px",color:e.text.secondary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),S=(0,o.useCallback)((t=>{_t().Fv({environment:g}),C().do({environment:g,sessionId:u,collectionId:e.id,existingLayoutId:s?void 0:m.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:d,finalModulesByArea:v})}),[e.id,g,d,s,m.id,u,v]),A=(0,o.useCallback)((async()=>{if(t){y(!0);try{await n(),S(!0)}catch(e){if(y(!1),!(e instanceof Hn().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))Sn().f1(f.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:f.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))Sn().f1(f.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:f.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:f.formatMessage(ve().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?f.formatMessage($n.page_main):"page_info_layout_schema"===t.area?f.formatMessage($n.page_details):f.formatMessage($n.generic)};Sn().f1(f.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else{if("multiple_views_main_content_tabs"!==(null==t?void 0:t.type)){const e=f.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});return void Sn().f1(e)}Sn().f1(f.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}))}}}}else S(!1)}),[S,t,f,n]),w=(0,o.useCallback)((()=>{c(),C().kA({environment:g,context:"layout",sessionId:u,collectionId:e.id,layoutId:s?void 0:m.id}),k(!1),S(!0)}),[S,e.id,g,s,m.id,c,u]),[j,k]=o.useState(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Fe().Ay,{popupType:Gn().n.Popup,alignmentToOrigin:M().C.End,originGap:4,render:e=>(0,l.jsx)($().A,{style:x.saveButtonSectionMenuItem,children:(0,l.jsx)(Y().A,{onClick:()=>{k(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:x.saveButtonRevertItem,body:(0,l.jsxs)(b().Ye,{gap:10,children:[(0,Vn()._)(x.saveButtonRevertItemIcon),(0,l.jsxs)(b().wt,{children:[(0,l.jsx)("div",{style:x.saveButtonRevertItemTitle,children:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,l.jsx)("div",{children:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,l.jsx)(Wn().A,{style:x.saveButton,mainButtonStyle:x.saveButtonInner,title:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:A,disableDropdown:!1,icon:Un().p,iconStyle:x.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:h})}),j&&(0,l.jsx)(zn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>k(!1),areaConstraint:{width:{type:"min",length:300}},render:e=>{let{sizeRange:t}=e;return(0,l.jsx)(Kn().tf,{header:(0,l.jsx)(Kn().YA,{iconAndTitle:(0,l.jsx)(Kn().ZQ,{iconGroup:Fn,title:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,l.jsx)(Kn().aO,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:w}],secondaryButtons:[{buttonType:"dismiss",label:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:t})}})]})}function Jn(){const e=(0,i().v3)(),{device:t}=e,{isElectron:n,isElectronMac:s}=t,{sessionId:d,layoutStore:c}=(0,X().LH)(),{collectionStore:u,hasUnsavedChanges:m,isNewLayout:g,initialLayoutModulesByArea:f}=(0,X().bi)(),h=(0,a().K8)((()=>c.getModules()),[c]),y=(0,a().K8)((()=>!!n&&!wn().A.state.isShowingTabBar),[n]),v=(0,a().K8)((()=>(0,xn().ek)(s)),[s]),x=(0,o.useCallback)((async()=>{C().do({environment:e,sessionId:d,collectionId:u.id,existingLayoutId:g?void 0:c.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:f,finalModulesByArea:h});const t=()=>_t().Fv({environment:e});if(!m)return void t();const{accept:n}=await Sn().Gh({message:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.closeConfirmModal.content",defaultMessage:"Discard all layout changes?"}),acceptLabel:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.closeConfirmModal.discard",defaultMessage:"Discard"})});n&&t()}),[e,d,u.id,g,c.id,f,h,m]),S=(0,r().IS)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",margin:"8px 16px 8px 16px"},topbarPlaceholder:{minHeight:v,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",left:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},subtitle:{fontSize:L().J.UISmall.desktop,fontWeight:L().Wy.regular,color:e.text.secondary,alignSelf:"center"},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",...L().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[v]);return(0,l.jsxs)("header",{style:S.header,children:[y?(0,l.jsx)("div",{style:S.topbarPlaceholder,className:vn()({[Cn().N_7]:!0,[Cn().sbV]:!0})}):null,(0,l.jsxs)("div",{style:S.headerContent,children:[(0,l.jsx)("div",{style:S.titlePreviewContainer,children:(0,l.jsxs)("div",{style:S.titlePreviewElementContainer,children:[(0,l.jsx)(Xn,{collectionStore:u}),(0,l.jsx)(Rn,{collectionStore:u})]})}),(0,l.jsxs)(b().Ye,{style:S.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,l.jsx)("div",{style:S.pageSettingsButtonContainer,children:(0,l.jsx)(En,{})}),(0,l.jsxs)(b().Ye,{gap:8,alignItems:"center",style:S.rightButtons,children:[(0,l.jsx)(Ee().p,{onClick:x,icon:bn().u,size:"lg",children:(0,l.jsx)(p().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,l.jsx)(Zn,{})]})]})]})]})}function Xn(e){let{collectionStore:t}=e;const n=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:L().Wy.medium,width:"100%",...L().RC}})),[]),o=(0,a().K8)((()=>t.getIcon()),[t]);return(0,l.jsxs)("div",{style:n.container,children:[(0,l.jsx)(Mn().A,{icon:o,size:20,isEmptyPage:!1,disabled:!0}),(0,l.jsx)(An().A,{store:t})]})}function eo(e){const t=(0,r().IS)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%",marginTop:-20,minWidth:j().ok,zIndex:0,position:"relative"}})),[]),n=(0,a().K8)((()=>I().A.getState()),[]),i=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,s=(0,a().uB)(e.layoutBuilderModuleSelectionStore,k().A),d=n.isOpen&&"layout-editor"===n.mode;return(0,o.useEffect)((()=>{d&&s.setState(i?{type:"existing_module",moduleId:i,isDragging:!1}:void 0)}),[i,d,s]),n.isOpen&&"layout-editor"===n.mode?(0,l.jsxs)(hn,{...n,layoutBuilderModuleSelectionStore:s,children:[e.debugChildForTestsOnly,(0,l.jsxs)(g().A,{tag:b().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,l.jsx)(Jn,{}),(0,l.jsxs)(b().Ye,{style:t.innerContainer,children:[(0,l.jsx)(to,{}),(0,l.jsx)($t,{})]})]})]}):null}function to(){const{pageStore:e}=(0,X().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:s,sessionId:d}=(0,X().LH)(),c=(0,i().v3)(),u=(0,a().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),p=(0,a().K8)((()=>{const t=(0,j().dV)(c);switch(t){case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,m().HB)(t)}}),[c,e]),g=(0,a().K8)((()=>(0,w().oQ)(c).totalWidth),[c]),f=(0,a().K8)((()=>e.hasCover()),[e]),v=(0,r().IS)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.accentColors.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...u?{cursor:"grabbing"}:{}},mainPage:{flex:3,paddingTop:f?void 0:28},sidebarScroller:{borderLeft:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${w().MH}px ${w().uZ}px`,marginBottom:100,flex:1,minWidth:g,maxWidth:g,width:g,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"}})),[u,f,g]),[b,S]=(0,o.useState)(!0);return(0,l.jsxs)("div",{role:"presentation",style:v.container,onClick:e=>{(0,x().SQ)({event:e,context:x().y$.EditorClick,callback:()=>{var e;t(void 0),(0,C().L3)({environment:c,layoutId:s.id,collectionId:null===(e=s.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"background_click"})}})},children:[(0,l.jsx)(on().s,{area:"page_main",style:v.mainPageContainer,children:(0,l.jsx)(y().l,{children:(0,l.jsx)(h().H,{type:A().A.Y,style:v.mainPageScrollContainer,children:(0,l.jsx)("div",{style:v.mainPage,children:(0,l.jsx)(an().Mx,{type:p,children:(0,l.jsx)(nn().J,{area:"page_main"})})})})})}),b&&(0,l.jsx)(on().s,{area:"page_details",children:(0,l.jsxs)(h().H,{type:A().A.Y,style:v.sidebarScroller,children:[(0,l.jsx)(no,{isSidebarOpen:!0,setIsSidebarOpen:S}),(0,l.jsx)("div",{style:v.sidebar,children:(0,l.jsx)(nn().J,{area:"page_details"})})]})}),!b&&(0,l.jsx)(no,{isSidebarOpen:!1,setIsSidebarOpen:S})]})}function no(e){let{isSidebarOpen:t,setIsSidebarOpen:n}=e;const i=(0,r().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",right:t?void 0:4,left:t?4:void 0,top:4}})),[t]),a=(0,o.useCallback)((()=>{n((e=>!e))}),[n]);return(0,l.jsx)("div",{style:i.container,children:(0,l.jsx)(v().A,{renderTooltip:()=>t?(0,l.jsx)(p().sA,{...oo.hideSidebar}):(0,l.jsx)(p().sA,{...oo.showSidebar}),placement:M().W.Top,render:e=>(0,l.jsx)(f().A,{icon:t?u().O:c,...e,onClick:a,style:i.button,ariaLabel:t?S().A.formatMessage(oo.hideSidebar):S().A.formatMessage(oo.showSidebar)})})})}const oo=(0,p().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},500844:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>D});n(898992),n(354520),n(581454),n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(401497),r=()=>n(842599),s=()=>n(187174),l=()=>n(959013),d=()=>n(928600),c=()=>n(263919),u=()=>n(417555),p=()=>n(856952),m=()=>n(47373),g=()=>n(722872),f=()=>n(743260),h=()=>n(37433),y=()=>n(351360),v=()=>n(205618),b=()=>n(224701),x=()=>n(668725),S=()=>n(496603),M=()=>n(493823),A=()=>n(760217),C=()=>n(406699),w=()=>n(939740),j=()=>n(89924),k=()=>n(859428),I=()=>n(962730),T=()=>n(700250),P=()=>n(308228),_=()=>n(43450),B=n(474848);function L(e){const{selectedRole:t,allRoles:n,onChange:r,store:s,labelStyle:c}=e,{device:u}=(0,o().v3)(),p=(0,a().DP)(),m=(0,_().R)(s),f=(0,i().K8)((()=>{const{currentSpaceStore:e}=y().default.state;return null==e?void 0:e.canEditMembership()}),[]),v=(0,i().K8)((()=>s.isDefault()),[s]);return(0,B.jsx)(C().Ay,{popupType:u.isMobile?C().z7.SlideUp:C().z7.Popup,renderOrigin:e=>(0,B.jsxs)(M().p,{style:c,...e,children:[(0,B.jsx)(l().sA,{...h().Y7[t].label}),(0,x().b)({width:10,marginLeft:4,fill:p.lightIconColor})]}),placementToOrigin:T().UV.Bottom,render:e=>{const o=[{key:"roles",render:e=>(0,B.jsx)(j().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:o,disabledReason:i}=(0,P().m)({role:n,isCurrentUserTeamOwner:Boolean(m),userIsSpaceAdmin:Boolean(f),isDefaultTeam:v}),a={key:n,render:e=>(0,B.jsx)(k().A,{disableTooltip:!o,placement:I().W.Right,textWrap:!0,renderTooltip:()=>i,render:i=>(0,B.jsx)("span",{...i,children:(0,B.jsx)(A().A,{...e,checkState:S().n4(n,t),disabled:o,disabledFeedback:o,title:(0,B.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,B.jsx)(l().sA,{...h().Y7[n].label})}),caption:(0,B.jsx)("span",{style:{color:p.mediumTextColor},children:(0,B.jsx)(l().sA,{...h().Y7[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(n),e.close()}};return a}))}];let i;return i=u.isMobile?{menuType:g().gu.Modal,title:(0,B.jsx)(l().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,B.jsx)(l().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g().gu.Popup,width:264},(0,B.jsx)(d().A,{...i,children:(0,B.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:void 0,sections:o})})}})}const R="member";function D(e){const{store:t,onEmptySubmit:n}=e,r=(0,o().v3)();(0,s().Yb)((async()=>{await b().Ow(r)}),[]);const l=(0,i().uB)(e.permissionsInviteStore,v().A),u=(0,i().K8)((()=>Boolean(l.state.isFocused)),[l]),p=(0,i().K8)((()=>l.state.tokenQuery),[l]),m=(0,i().K8)((()=>u&&p.length>0),[u,p]),f=(0,a().IS)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function h(e){l.setState({...l.state,isFocused:e})}return(0,B.jsx)("div",{onFocus:()=>h(!0),onBlur:()=>h(!1),children:(0,B.jsx)(d().A,{menuType:g().gu.Popup,header:(0,B.jsx)(O,{store:t,permissionsInviteStore:l,onEmptySubmit:n}),scrollerStyle:f.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:m&&(0,B.jsx)("div",{style:f.permissionsInviteSearchRequest,children:(0,B.jsx)(c().A,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}function O(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:o}=e,s=(0,l().tz)(),d=(0,i().K8)((()=>Boolean(n.state.isFocused)),[n]),c=(0,i().K8)((()=>n.state.tokenQuery),[n]),m=(0,i().K8)((()=>n.state.inviteRole),[n]),g=(0,i().K8)((()=>n.state.inviteTargets),[n]),h=(0,a().IS)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function y(e){if(n.state.isInviteTargetsEmpty)return;const t=n.state.inviteTargets.filter((t=>t!==e));0===g.length?n.setState({...n.state,inviteTargets:[],inviteRole:R,isInviteTargetsEmpty:!0}):n.setState({...n.state,inviteTargets:t})}function v(e){n.setState({...n.state,isFocused:e})}const b=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,B.jsx)(u().A,{target:e,onClickRemove:y,role:m,shouldWrap:!0,style:h.inputTokenVerticalMargin,backgroundColor:(0,f().qv)(e)},t)}));return(0,B.jsx)(p().Ay,{focus:d,onClick:()=>v(!0),format:p().le.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:o,newInputValue:i}=(0,r().Ct)(t),a=o.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,f().mQ)({target:e,permissionsInviteStore:n}))),s=[...n.state.inviteTargets,...a];s.length>0?(n.setState({...n.state,inviteTargets:s,isInviteTargetsEmpty:!1,tokenQuery:i}),v(!(a.length>0))):n.setState({...n.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})},onEmptySubmit:o,type:"email",placeholder:s.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:b,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=R),n.setState(e)},focusAfterAnimation:!0,right:(0,B.jsx)(N,{store:t,permissionsInviteStore:n}),style:h.tokenMenuItem,inputStyle:h.inputTokenVerticalMargin,inputDivStyle:h.inputDiv,inputFullWidth:!0})}function N(e){const{store:t,permissionsInviteStore:n}=e,o=(0,i().K8)((()=>{const e=y().default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,m().Qd)()}),[]),r=(0,i().K8)((()=>n.state.inviteRole),[n]),s=(0,a().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return o?(0,B.jsx)(L,{store:t,selectedRole:r,allRoles:h().vm,onChange:l,labelStyle:s.teamRoleLabel}):(0,B.jsx)(L,{store:t,selectedRole:r,allRoles:h().H1,onChange:l,labelStyle:s.teamRoleLabel})}},507807:(e,t,n)=>{n.d(t,{S:()=>m,f:()=>g});n(944114);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(857639),s=(n(16280),()=>n(439180)),l=()=>n(630116),d=()=>n(317909);var c=()=>n(878423),u=()=>n(733539),p=()=>n(246125);function m(e,t){let{canUndo:n,shouldPersistOperation:m}=t;const g=(0,i().v3)(),f=(0,o.useRef)([]).current,h=(0,o.useCallback)((e=>{f.push(...e)}),[f]),y=(0,o.useCallback)((e=>{m&&!m(e)||h([e])}),[h,m]),v=(0,p().l)(e,{cacheFallback:g.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0,onOperationCallback:y});(0,o.useEffect)((()=>{c().A.initializeCache(e,v)}),[e,v]);const b=(0,o.useCallback)((()=>{u().default.reset(),c().A.clearCache(e)}),[e]);(0,o.useEffect)((()=>(u().default.reset(),()=>{u().default.reset(),c().A.expire(e)})),[e]);const x=(0,a().K8)((()=>u().default.state.undoStack.length>0),[]);(0,o.useEffect)((()=>{c().A.updateUnsavedCacheState(e,x)}),[e,x]);const S=(0,o.useCallback)((async e=>{if(0===f.length)return void 0;v.assertUnexpired(),function(e){for(const t of u().default.state.undoStack)for(const n of t.transactions)for(const t of n.stores)if(t.inMemoryRecordCache!==e&&!t.inMemoryRecordCache.isMockTextStore){const o=n.getUserActionForAnalyticsPurposesOnly(),i=t.inMemoryRecordCache.name,a=e.name,s=`Undoable user action "${o}" was applied to cache "${i}", but only operations in the cache "${a}" should be in the undo stack!`;(0,r().log)({from:"useLocalDraft",type:"invalidStoreInRevisionStack",level:"error",data:{message:s,miscDataToConvertToString:{userAction:o,inMemoryRecordCacheName:i,expectedInMemoryRecordCacheName:a}}})}}(v);const{serverCommitResult:t}=d().createAndCommit({environment:g,userAction:e,perform(e){!function(e){let{environment:t,transaction:n,operationsWithStores:o}=e;for(const{operation:i,store:a}of o){if(!(a instanceof l().pm))continue;const e=a.clone(t.defaultRecordCache.inMemoryRecordCache);(0,s().ph)(i)?d().applyCrdtTextOperation({store:a,operation:i,transaction:n,invertedOperation:void 0}):d().applyOperation({transaction:n,store:e,operation:i})}}({environment:g,transaction:e,operationsWithStores:f}),e.postSubmitCallbacks.push((e=>{e||(v.expire(),u().default.reset())}))},canUndo:n});return t}),[e,n,g,f,v]);return(0,o.useMemo)((()=>({cache:v,hasChanges:x,persist:S,reset:b})),[x,S,b,v])}function g(e,t){return(0,a().K8)((()=>t.clone(e.cache)),[t,e.cache])}},514799:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(484714),i=()=>n(56366),a=()=>n(185078),r=()=>n(910302);function s(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:a=!1}=e,s=(0,o().v3)();return(0,i().K8)((()=>n?r().bY({pageStore:t,environment:s,enabled:n,forceUpdate:a}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,s,n,a])}(e);return t&&!(0,a().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},515512:(e,t,n)=>{n.d(t,{Q:()=>l});var o=()=>n(484714),i=()=>n(56366),a=()=>n(437622),r=()=>n(351360),s=()=>n(749240);function l(){const e=function(){const e=(0,o().v3)();return(0,i().K8)((()=>{const t=r().default.state.currentSpaceStore,n=s().subscriptionDataStoreInstance.state;return t?a().IL(t)?n?{loading:!1,isUserTeamGuestOfSpace:a().Qx(e,n)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,i().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},518773:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(835338),i=()=>n(534177);function a(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,o().JY)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,o().gK)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,o().lx)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,o().gU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().HB)(e)}}},522246:(e,t,n)=>{n.d(t,{Y:()=>h});n(581454);var o=()=>n(56366),i=()=>n(636090),a=()=>n(187174),r=()=>n(519831),s=()=>n(630116),l=()=>n(449506);var d=()=>n(271372),c=()=>n(645873),u=()=>n(963589),p=()=>n(106628),m=()=>n(361330),g=()=>n(832820),f=()=>n(188669);function h(e){let{environment:t,spaceStore:n,joinedTeamIds:h,parentStore:y,moveToTargets:v,overrideDatabaseType:b}=e;const x=(0,o().K8)((()=>{const e=null==n?void 0:n.id;if(e)return function(e){if(!g().c.state)return;if(e!==g().c.state.spaceId)return;return g().c.state.typedDatabases}(e)}),[null==n?void 0:n.id]),S=(0,u().X)("typed_move_to_improved_default_results"),M=(0,c().fJ)(p().T.searchActions),[{value:A,status:C}]=(0,a().Yb)((async()=>{if(x)return x;if(!n||!y)return;const e=b??f().Ay.getDatabaseType();if(!e)return;if("resolved"!==M.status)return;const o=M.value;let a=[];if(S){const i=((await o.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:n,parentStore:n,collectionViewBlockStore:void 0,searchSessionId:f().Ay.state.isOpen?f().Ay.state.flowId:void 0})).results||[]).map((e=>s().md.createChildStore(y,{table:r().Vl,id:e})));a=(0,d().vl)({typedDatabases:i,blocksToFilterParents:v})}else{const o=await async function(e){let{environment:t,spaceId:n,databaseType:o,parentStore:i}=e;if(!n)return;const a=await l().callApi({eventName:"getTypedDatabases",environment:t,data:{spaceId:n,databaseType:o}});return"success"===a.type?a.data.result.map((e=>s().md.createChildStore(i,{table:r().Vl,id:e.collectionId}))):void 0}({environment:t,spaceId:n.id,databaseType:e,parentStore:y})??[];a=(0,d().gq)({environment:t,typedDatabases:o,spaceStore:n,joinedTeamIds:h})}return g().c.setState({typedDatabases:a,spaceId:n.id}),f().Ay.update((e=>({...e,variant:i().Xy}))),a}),[x,n,y,b,M.status,M.value,S,t,v,h],{debounce:m().tu,throttle:m().tu});return x?{success:!0,typedDatabases:x}:"resolved"===C&&A?{success:!0,typedDatabases:A}:{success:!1}}},526278:(e,t,n)=>{n.d(t,{w:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M2.411 9.79a.6.6 0 0 1 .147-.232l5.4-5.4a.625.625 0 1 1 .884.884L4.509 9.375H17a.625.625 0 1 1 0 1.25H4.509l4.333 4.333a.625.625 0 1 1-.884.884l-5.4-5.4a.62.62 0 0 1-.147-.651"})},i=(0,n(340498).wt)("arrowStraightLeft",o)},529324:(e,t,n)=>{n.d(t,{C:()=>o});const o=(0,n(340498).xh)("magnifyingGlass",{default:{loader:()=>n.e(1827).then(n.bind(n,901827))},small:{loader:()=>n.e(41805).then(n.bind(n,741805))},mini:{loader:()=>n.e(20283).then(n.bind(n,420283))},large:{loader:()=>n.e(61969).then(n.bind(n,861969))}})},532731:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>p,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>m});n(944114),n(898992),n(581454),n(908872);var o=()=>n(959013),i=()=>n(33301),a=()=>n(317909),r=()=>n(972435),s=()=>n(806638),l=()=>n(404141);const d=(0,o().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:r().A.formatMessage(d.empty),iconFn:n(47966).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}},u={name:r().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(948352).M)(e),shouldShow:()=>!0,onClick:e=>{(0,s().P)({environment:e})}},p={name:r().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(926329).b)(e),shouldShow:()=>!0,onClick:e=>{(0,s().P)({environment:e})}},m={name:r().A.formatMessage(d.import),type:"import",iconFn:n(555555).n,shouldShow:()=>!0,onClick:(e,t)=>{const o=n(206267).JW();n(522094).A.setState({flowId:o}),n(559926).kY(e,{from:"new_page",flowId:o}),l().A.setState({...l().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},g=(0,o().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:r().A.formatMessage(g.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().T({environment:e,store:t,transaction:n})}})}},{name:r().A.formatMessage(g.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},536612:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(959180))().A{}const i=new o},538075:(e,t,n)=>{n.d(t,{H8:()=>h,I7:()=>v,aE:()=>f});n(296540);var o=()=>n(66689),i=()=>n(413267),a=()=>n(959013),r=()=>n(534177),s=()=>n(416726),l=()=>n(457190),d=()=>n(436572),c=()=>n(575143),u=()=>n(351360),p=()=>n(518773),m=n(474848);const g=(0,a().YK)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function f(e){switch(e){case"Mentions":return g.repliesAndMentions;case"Comments":return g.comments;case"All":return g.allUpdates;case"Important":return g.importantUpdates;default:return}}function h(e){const{followSettingsKey:t,environment:n,blockStore:i,from:r}=e,s=y({key:"none",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:g.repliesAndMentions,environment:n,blockStore:i,from:r}),l=y({key:"comments",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:i,from:r}),d=y({key:"all",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:g.allUpdates,environment:n,blockStore:i,from:r}),c=i.getAssociatedCollectionStore();if(!c)return[l,s];const u=c.getDatabaseType();if(u===o().dC){return[d,y({key:"important",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:g.importantUpdates,environment:n,blockStore:i,from:r}),s]}if(u===o().Tw){return[d,y({key:"important",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:g.importantUpdates,environment:n,blockStore:i,from:r}),s]}return[d,y({key:"comments",selectedKey:t,title:(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:i,from:r}),s]}function y(e){const{key:t,title:n,caption:o,selectedKey:a,environment:r,blockStore:g,from:f,displayName:h}=e,y=v({key:t,userSelectedKey:a}),x={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,s().Ls)({key:t,displayName:h,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=u().default.state;if(e){const{following:n,followSettings:o}=(0,p().A)(t),i=e.id,s=g.id,c=g.getSpaceId();l().v({environment:r,following:n,followSettings:o,navigableBlockId:s,spaceId:c,userId:i,from:f,key:t,selectedKey:a}),"inbox"!==f&&"more_menu"!==f||d().rL({item:{label:b(t)},undoFunc:()=>{const{following:e,followSettings:n}=(0,p().A)(a);l().v({environment:r,following:e,followSettings:n,navigableBlockId:s,spaceId:c,userId:i,from:f,key:t,selectedKey:a})}})}},render:e=>(0,m.jsx)(c().A,{...e,title:n,caption:o,shouldWrapCaption:!0,right:y?(0,i().b)(x.icon):(0,m.jsx)("div",{style:x.icon}),rightStyle:x.right})}),title:n,isSelectedOption:y}}function v(e){const{key:t,userSelectedKey:n}=e;return"important"===n||"comments"===n?"important"===t||"comments"===t:t===n}function b(e){switch(e){case"none":return(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,m.jsx)(a().sA,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,r().HB)(e)}}},540459:(e,t,n)=>{n.d(t,{G:()=>d});n(296540);var o=()=>n(56366),i=()=>n(959013),a=()=>n(204063),r=()=>n(859428),s=()=>n(663590),l=n(474848);function d(e){const{tooltip:t,disabled:n,onClick:d}=e,c=(0,o().K8)((()=>(0,s().FI)()),[]);return(0,l.jsx)(r().A,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,l.jsx)(a().A,{size:"lg",style:{marginLeft:8,...c&&{borderRadius:6,paddingLeft:12,paddingRight:12}},disabled:n,onClick:d,...e,children:(0,l.jsx)(i().sA,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}},542371:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().default{getInitialState(){}}},546418:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddNewViewButtonWrapper:()=>B});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(908006),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(757695),d=()=>n(970013),c=()=>n(743176),u=()=>n(519831),p=()=>n(959013),m=()=>n(534177),g=()=>n(154017),f=()=>n(686526),h=()=>n(634339),y=()=>n(180762),v=()=>n(745266),b=()=>n(760217),x=()=>n(406699),S=()=>n(928600),M=()=>n(939740),A=()=>n(14235),C=()=>n(89924),w=()=>n(525432),j=()=>n(722872),k=()=>n(962730),I=()=>n(377586),T=()=>n(626318),P=()=>n(937199),_=n(474848);function B(e){let{renderOrigin:t,onClose:n}=e;const[i,s]=(0,o.useState)(!1),c=(0,o.useRef)(null),p=(0,a().v3)(),{layoutStore:g}=(0,P().LH)(),h=(0,o.useContext)(P().sf),v=null==h?void 0:h.moduleStateByIdStore,b=(0,r().K8)((()=>{var e;const t=g.getModuleByType("viewsMain");if(t)return null==v||null===(e=v.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[g,v]),S=(0,o.useCallback)(((e,t)=>{b&&((0,y().t)({environment:p,collectionContextStore:b,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),f().Ow({collectionContextStore:b,collectionSettingsStore:b.settingsStore,closeOnEscape:!1}))}),[p,b]),M=(0,r().K8)((()=>{var e;const t=null===(e=g.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===u().Vl)return t}),[g]),A=(0,r().K8)((()=>{const e=null==M?void 0:M.getNormalizedSchema();return Object.entries(e??{}).filter((e=>{let[t,n]=e;return(0,m().O9)(n)&&(0,d().nC)(n)&&n.property}))}),[M]),C=(0,o.useCallback)((()=>{s(!1),null==n||n()}),[n]),w=(0,o.useCallback)((()=>{s(!0)}),[s]),j=(0,o.useMemo)((()=>l().default.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),T=(0,o.useCallback)((()=>{const e=null==b?void 0:b.viewsModuleContextStore.getViewsModule();e&&f().R8({collectionSettingsStore:j,item:{type:"selectViewsModuleSource",module:e}})}),[null==b?void 0:b.viewsModuleContextStore,j]),B=(0,o.useCallback)((()=>{f().os({collectionSettingsStore:j})}),[j]),D=(0,o.useCallback)((()=>(0,_.jsx)(L,{setIsOpen:s,onClose:n,relations:A,setCurrentViewPointer:S,collectionModel:M,viewsMainModuleCollectionContextStore:b,openViewsCreationPopup:T})),[n,A,S,M,b,T]),O=(0,o.useCallback)((e=>t(e)),[t]);return b&&M?(0,_.jsxs)("div",{ref:c,children:[(0,_.jsx)(x().Ay,{alignmentToOrigin:k().C.Center,popupType:I().n.Popup,onClose:C,onClick:w,open:i,render:D,renderOrigin:O,disablePopup:!0}),(0,_.jsx)(R,{buttonRef:c,viewsMainModuleCollectionContextStore:b,viewsCreationMenuCollectionSettingsStore:j,openViewsCreationPopup:T,closeViewsCreationPopup:B})]}):null}function L(e){let{setIsOpen:t,onClose:n,relations:r,setCurrentViewPointer:l,collectionModel:d,viewsMainModuleCollectionContextStore:u,openViewsCreationPopup:m}=e;const{layoutStore:f,setModuleSelection:h}=(0,P().LH)(),y=(0,a().v3)(),x=(0,s().DP)(),A=(0,o.useMemo)((()=>{if(0!==r.length)return{key:0,items:[],render:e=>(0,_.jsx)(C().A,{...e,title:(0,_.jsx)(p().sA,{...D.relatedToDatabase,values:{database:null==d?void 0:d.getName()}}),children:r.map((e=>{let[t,o]=e;return(0,_.jsx)(b().A,{title:null==o?void 0:o.name,icon:(0,_.jsx)(c().Ay,{size:16,theme:x,icon:null==o?void 0:o.icon,type:"relation"}),focused:!1,onClick:()=>{if(!u)return;const{viewsMainModule:e,collectionViewPointer:a}=(0,T().ZX)({environment:y,layoutStore:f,relationPropertyId:(null==o?void 0:o.property)??t,targetCollectionPointer:(null==o?void 0:o.collection_pointer)??(null==d?void 0:d.pointer),viewName:null==o?void 0:o.name,viewIcon:null==o?void 0:o.icon});e&&h({type:"existing_module",moduleId:e.id,isDragging:!1}),a&&(i().default.afterNextFlush((()=>{l(a,null==e?void 0:e.id),null==n||n()})),u&&(0,g().b)({environment:y,view_type:"table",collectionContextStore:u}))}},t)}))})}}),[u,d,y,f,n,r,l,h,x]),w=(0,o.useMemo)((()=>{const e=r.length>0;return{key:1,items:[],render:t=>(0,_.jsx)(C().A,{...t,topBorder:e,children:(0,_.jsx)(b().A,{title:(0,_.jsx)(p().sA,{...D.linkExistingDatabase}),icon:(0,_.jsx)(v().h,{color:"regular",viewType:"table"}),onClick:()=>{m()},focused:!1},"link_existing_database")})}}),[m,r.length]);return(0,_.jsx)(S().A,{menuType:j().gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,_.jsx)(M().Ay,{initialFocus:void 0,sections:[A,w].filter((e=>void 0!==e)),type:M().Oh.Vertical})})}function R(e){var t;let{buttonRef:n,viewsMainModuleCollectionContextStore:o,viewsCreationMenuCollectionSettingsStore:i,closeViewsCreationPopup:a}=e;const s=(0,r().K8)((()=>i.state.open),[i]);return(0,_.jsx)(A().Ay,{open:s,popupType:I().n.Popup,render:()=>(0,_.jsx)(h()._,{context:w().Bd.TopbarFilterPopup,collectionContextStore:o,collectionSettingsStore:i,hideDesktopHeader:!0}),originRect:null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:k().C.Center,placementToOrigin:k().W.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:()=>{a()}})}const D=(0,p().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDatabase:{defaultMessage:"Link existing database",id:"pageLayout.configureViews.linkAnExistingDatabase"},newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"},newRelation:{defaultMessage:"New relation",id:"pageLayout.configureViews.newRelation"},back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}})},546461:(e,t,n)=>{n.d(t,{EC:()=>S,To:()=>x,YC:()=>M,or:()=>b,u:()=>v});n(16280);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(496506),s=()=>n(322867),l=()=>n(959013),d=()=>n(534177),c=()=>n(813297),u=()=>n(862292),p=()=>n(698331),m=()=>n(645873),g=()=>n(190019),f=n(474848);const h=new WeakMap,y=(0,o.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});y.displayName="AutomationContext";function v(e){const{automationStore:t,children:n,contextType:o}=e,v=(0,i().v3)(),b=(0,l().tz)(),{value:x}=(0,m().fJ)(u().T.formulas),{value:S}=(0,m().fJ)(c().QV.automationTypecheck),M=(0,a().K8)((()=>{if(!x)return{error:new(s().N9)("Missing formulas dependency")};if(!S)return{error:new(s().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:n,automationTypecheckModule:o,contextType:i,formulasModule:a,intl:s}=e,l=h.get(n);if(l)return l;{const e=new(r().default)((()=>{const e=n.getTriggerType();let r=i;return(0,d().O9)(e)&&(0,p().x2)(e)&&(r=(0,p().H8)(e)),(0,g().Z)({environment:t,automationStore:n,automationTypecheckModule:o,contextType:r,formulasModule:a,intl:s})}),{debugName:"automationContextTypecheckResultCachedStore"});return h.set(n,e),e}}({environment:v,automationStore:t,automationTypecheckModule:S,contextType:o,formulasModule:x,intl:b});return e.state}),[v,t,S,o,x,b]);return(0,f.jsx)(y.Provider,{value:{automationStore:t,typecheckResult:M,contextType:o,defined:!0},children:n})}function b(e){const{automationStore:t,children:n}=e,o=(0,a().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,f.jsx)(v,{automationStore:t,contextType:(0,p().H8)(o??"event"),children:n})}function x(e){var t;return null===(t=h.get(e))||void 0===t?void 0:t.state}function S(){const e=o.useContext(y);if(!1===e.defined)throw new Error("No automation context found!");return e}function M(){return o.useContext(y)}},577466:(e,t,n)=>{n.d(t,{B:()=>a});var o=()=>n(401497),i=()=>n(100622);function a(e){return(0,o().IS)((t=>({wrapper:{background:e?(0,i().qh)(e,t).color:t.surface.wash,borderRadius:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[e])}},585849:(e,t,n)=>{n.d(t,{n:()=>a,w:()=>i});var o=()=>n(919709);function i(e){if(!e)return;const t=o().RQ(e),n=o().uPN(t[0])[0];if(!n||!o().zpJ(n))return;const i=n[1];return{lat:i.lat,lon:i.lon}}function a(e){if(!e)return[];const t=o().bxH(e);return[o().wmz(t)]}},601203:(e,t,n)=>{n.d(t,{Kz:()=>A,Qe:()=>v,dn:()=>b,gM:()=>C,jO:()=>x,qu:()=>S});n(898992),n(354520),n(581454);var o=()=>n(251111),i=()=>n(762433),a=()=>n(643819),r=()=>n(622963),s=()=>n(496603),l=()=>n(534177),d=()=>n(449506),c=()=>n(780054),u=()=>n(351360),p=()=>n(506090),m=()=>n(134217),g=()=>n(830140),f=()=>n(430395),h=()=>n(981046),y=()=>n(749240);async function v(e){var t;let{environment:n,billingData:a,billingInterval:s,vatId:c,addOn:g,onlyShowAddOn:f}=e;const v=p().A.state,b=y().subscriptionDataStoreInstance.state;if(!v.open||!b)return;const x=(null==a?void 0:a.address)??v.temporaryAddress;if(!(0,o().Z)(x))return;p().A.update((e=>({...e,calculatingTax:!0})));const S=s??v.temporaryBillingInterval??"year",A=g??v.addOnFeature,C=f??v.onlyShowAddOn,w=null===(t=u().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!w)return;const j=await(0,m().$)(n,w,b),{planAmount:k,promoInfo:I,accountBalance:T}=(0,m().TQ)({memberCount:j,promo:v.appliedPromo,currencyCode:h().A.selectedCurrencyCode,data:b,addOnFeature:A,onlyShowAddOn:C,subscriptionTier:v.subscriptionTier,taxAmount:v.taxAmount,calculatingTax:v.calculatingTax,billingInterval:S,coupon:v.coupon}),P=Math.max(0,k-I.amount+T),_=[v.subscriptionTier,v.addOnFeature].map((e=>{switch(e){case void 0:return;case"ai":case"sites_custom_hostnames":return e;default:return(0,r()._y)(e)}})).map((e=>{const t=h().A.getPrice(n,(t=>t.product===e&&t.billingInterval===s));return null==t?void 0:t.result})).map(M).filter(l().O9),B=await d().callApi({eventName:"calculateTax",environment:n,data:{address:x,lineItems:_,price:P,vatId:c??v.vatApplicable?v.temporaryVatCode:void 0,customerId:(0,i().Rz)(a)}});if("failed"===B.type)p().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=B.data;e.valid?p().A.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):p().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function b(e,t){var n;const r=f().A.state,s=y().subscriptionDataStoreInstance.state;if(!r.open||!s)return;const l=r.temporaryAddress;if(!(0,o().Z)(l))return;f().A.update((e=>({...e,calculatingTax:!0})));const c=(null===(n=r.totalUpgradeCost)||void 0===n?void 0:n.amount)||0,u=await d().callApi({eventName:"calculateTax",environment:e,data:{address:l,price:c,vatId:r.vatApplicable?r.temporaryVatCode:void 0,customerId:(0,i().Rz)(t)}});if("failed"===u.type)f().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=u.data;e.valid?f().A.update((t=>({...t,taxAmount:a().W.fromValue({amount:e.taxAmount,currencyCode:h().A.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):f().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function x(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:i,vatId:a}=e,r=g().A.state,s=await d().callApi({eventName:"calculateTax",environment:t,data:{address:o,customerId:i,vatId:a,price:n}});if("failed"===s.type);else{const e=s.data;e.valid&&r.open&&g().A.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function S(e){const{environment:t,billingData:n,stripeData:a,taxableAmount:r,lineItems:s}=e,{address:l}=null!=n&&n.address?{address:null==n?void 0:n.address}:e,c=(null==a?void 0:a.vatId)??(n?(0,i().t_)(n,"vat"):void 0);if(!l||!(0,o().Z)(l))return;const u=(0,i().Rz)(n),p=await d().callApi({eventName:"calculateTax",environment:t,data:{address:l,price:r.amount,vatId:c,customerId:u,lineItems:s}});if("failed"===p.type)return;const m=p.data;return m.valid?m.taxAmount:void 0}function M(e){if(!e)return;if(void 0===e.unitAmount)return;const t=c().A.pricing[e.product];return"productId"in t?{amount:e.unitAmount.amount,productId:t.productId}:void 0}function A(e){const t=c().A.pricing[e.price.product];if("productId"in t)return{amount:e.price.unitAmount.amount*e.quantity,productId:t.productId}}function C(e){let{line:t,defaultProductId:n=c().A.pricing.plus.productId}=e;const o=(0,s().xu)(t.discount_amounts??[],"amount"),i=t.price?"string"==typeof(a=t.price.product)?a:a.id:n;var a;return{amount:t.amount-o,productId:i}}},607810:(e,t,n)=>{n.d(t,{s:()=>r});var o=n(296540),i=()=>n(120997),a=n(474848);const r=o.memo((function(e){let{area:t,viewsMainTabId:r,children:s,className:l,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:u}=(0,n(937199).LH)(),p=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&("page_main"===t&&u.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:r}:{area:t}}}))}),[t,c,u,r]),m=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,u]);return(0,a.jsx)("div",{onMouseEnter:p,onMouseLeave:m,className:l,style:d,children:s})}))},608893:(e,t,n)=>{n.d(t,{O:()=>s});n(18107),n(967357);var o=()=>n(857639),i=()=>n(134025),a=()=>n(190674),r=()=>n(317909);function s(e){var t;const{environment:n,layoutStore:s}=e;if((0,a().k)(s.getModules()))return;if(!s.getModel())return;const l=null===(t=s.getFormat())||void 0===t?void 0:t.previousViewsMainCollectionViewBlockPointer;if(!l)return;const d=s.getBlockChildren();d.length>1||d.at(0)!==l.id&&((0,o().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:s.pointer,expectedChildId:l.id,actualChildId:d.at(0)}}),r().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{r().applyOperation({store:s,transaction:e,operation:i().op.update({pointer:s.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),r().applyOperation({store:s,transaction:e,operation:i().op.set({pointer:s.pointer,path:["blocks"],args:[]})})}}))}},613735:(e,t,n)=>{n.d(t,{b:()=>r});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(278238),i=()=>n(945778),a=()=>n(267419);function r(e){let{icon:t,theme:n}=e;if(t)return(0,i().A)(t)?a().A.state.emojiByColorProcessed[t]:(0,o().T8)(t)?function(e){var t;let{uri:n,theme:i}=e;const a=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return s.has(e)}(a))return;return o().l8[i.mode][a]}({uri:t,theme:n}):void 0}const s=new Set((0,n(534177).uv)(o().l8.light))},614344:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>$});n(898992),n(823215),n(354520),n(672577),n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(792485),r=()=>n(56366),s=()=>n(401497),l=()=>n(590856),d=()=>n(29118),c=()=>n(30626),u=()=>n(383286),p=()=>n(284611),m=()=>n(169606),g=()=>n(959013),f=()=>n(534177),h=()=>n(160568),y=()=>n(246826),v=()=>n(33301),b=()=>n(317909),x=()=>n(178658),S=()=>n(938987),M=()=>n(226916),A=()=>n(459240),C=()=>n(828634),w=()=>n(549500),j=()=>n(862835),k=()=>n(508496);function I(){return(0,r().K8)((()=>(0,j().h)()&&k().default.checkGate({gateName:"meeting_notes"})),[])}var T=()=>n(68465),P=()=>n(972435),_=()=>n(478726),B=()=>n(963589),L=()=>n(806638),R=()=>n(962730),D=()=>n(377586),O=()=>n(970585),N=()=>n(611371),E=()=>n(338907),F=()=>n(913454),U=()=>n(32454),V=()=>n(155004),K=()=>n(364280),z=()=>n(939740),W=()=>n(14235),H=()=>n(125565),G=()=>n(532731),Y=()=>n(286611),q=n(474848);const Q=8;function $(e){const{store:t,context:n,menuListStore:k,editorWidth:B}=e,O=X(),$=(0,_().L5)(n),ne=(0,s().IS)((e=>({root:{background:$?e.peekModalBackground:e.contentBackground,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"}})),[$]),[oe,ie]=function(e){const t=(0,i().v3)(),n=(0,r().K8)((()=>"editor"===e.getRole()),[e]),o=function(){const e=(0,g().tz)(),t=(0,s().DP)();return{name:e.formatMessage(J.tableTemplateTitle),type:"database",iconFn:e=>(0,d().K)({...e,fill:t.regularIconColor}),isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{if((0,E().zx)()){const n=t.getParentStore();if(n&&(0,F().isCollectionTemplateParentStore)(n))return void(0,U().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,U().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:n=>{"accepted_template"!==n.type&&"accepted_empty_collection"!==n.type||b().createAndCommit({environment:e,canUndo:!1,perform:e=>{y().zv({store:t,transaction:e,data:{alive:!1}})},userAction:"clean_up_empty_new_page"})}})}else{var n;null===(n=A()._.find((e=>"table"===e.type)))||void 0===n||n.onClick(e,t)}}}}(),c=function(e){const{environment:t,store:n}=e,o=(0,g().tz)(),i=(0,a().S)(),s=(0,r().K8)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),l=(0,r().K8)((()=>(0,T().ZE)(s)),[s]);return{name:o.formatMessage(J.askAi),type:"ai",iconFn:e=>(0,q.jsx)(S().UY,{}),shouldShow:()=>l,onClick:()=>{b().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{v().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,x().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:t,store:e}),f=function(e){const t=(0,g().tz)(),n=(0,s().DP)(),o=(0,r().K8)((()=>(0,j().h)()),[]),i=I(),a=X();return{name:e?"":t.formatMessage(J.dictate),type:"dictation",iconFn:t=>(0,u().E)({...t,width:10,...e?{height:16,marginTop:"2px",marginBottom:"2px",marginLeft:"2px",marginRight:"-6px"}:{},fill:a?n.icon.primary:"dark"===n.mode?n.accentColors.red[700]:n.accentColors.red[400]}),shouldShow:()=>o&&!i,onClick:async(e,t)=>{const{dictationActions:n}=await w().$O.load();n.startDictation({environment:e,blockStore:t,from:"horizontal_template_picker",includeSystemAudio:!1})}}}(!0),h=function(){const e=(0,g().tz)(),t=(0,s().DP)(),n=I();return{name:e.formatMessage(J.transcription),type:"transcription",iconFn:e=>(0,p().b)({...e,fill:t.regularIconColor}),shouldShow:()=>n,onClick:async(e,t)=>{const{transcriptionNewPageActions:n}=await w().$O.load();n.appendTranscriptionBlockToPage({environment:e})}}}(),C=function(e){const t=(0,i().v3)(),n=(0,g().tz)(),o=(0,s().DP)();return{name:n.formatMessage(J.formTemplateTitle),type:"quick-form",iconFn:e=>(0,l().y)({...e,fill:o.regularIconColor}),shouldShow:()=>!0,onClick:async()=>{await(0,M().t)({environment:t,store:e})}}}(e),k=function(e){const{isTablet:t}=(0,i().Y0)();return{name:P().A.formatMessage(G().KQ.templates),type:"templates",iconFn:e=>(0,m().s)(e),shouldShow:()=>!t,onClick:e=>{(0,L().P)({environment:e})}}}(),_=[f,c,h,o,...n?[C]:[],k].filter((e=>e.shouldShow(t))),B=[...A()._,ee,G().zD];return[_,B]}(t),[ae,re]=function(e){const{store:t,editorWidth:n,initialVisible:a,initialOverflow:r}=e,l=(0,i().v3)(),d=(0,g().tz)(),u=X(),p=(0,s().IS)((e=>({icon:{width:16,marginLeft:2,marginRight:2,fill:e.lightIconColor}})),[]),[m,y]=o.useState(void 0),[v,b]=o.useState([]),[x,S]=o.useState(void 0),[M,A]=o.useState(a.length);(0,o.useEffect)((()=>{if(!(n&&v.every(f().O9)&&x))return;let e=0,t=0;for(;t<a.length&&(e+=v[t]+Q,!(e+x>n+24));)t++;A(t)}),[v,n,a.length,x]);const w=a.slice(0,M).map(((e,n)=>{const o={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:o=>{var i;let{ref:a,...r}=o;return(0,q.jsx)(C().EE,{onSizeChange:e=>{if(v[n]===e.width)return;const t=[...v];t[n]=e.width,b(t)},children:(0,q.jsx)("div",{children:(0,q.jsx)(Y().A,{...r,focused:m===n,onMouseEnter:o=>{var i;null===(i=e.onMouseEnter)||void 0===i||i.call(e,l,t),y(n)},onMouseLeave:n=>{var o;null===(o=e.onMouseLeave)||void 0===o||o.call(e,l,t),y(void 0)},format:"horizontal-new-page",title:(0,q.jsx)(H().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,p.icon),locked:!1})})})},action:n=>{(0,N().EF)(l)&&(h().ki(l,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(l,t))}};return o})),[j,k]=o.useState(!1),I=M,T={key:"more",render:e=>{let{ref:n,...o}=e;return(0,q.jsx)(W().Ay,{origin:(0,q.jsx)(C().EE,{onSizeChange:e=>S(e.width),children:(0,q.jsx)("div",{children:(0,q.jsx)(Y().A,{...o,focused:m===I,onMouseEnter:e=>{y(I)},onMouseLeave:e=>{y(void 0)},format:"horizontal-new-page",title:u?null:(0,q.jsx)(H().A,{children:d.formatMessage(J.more)}),type:"more",icon:(0,c()._)(p.icon),locked:!1})})}),alignmentToOrigin:R().C.Start,placementToOrigin:R().W.Top,originGap:4,open:j,popupType:D().n.Popup,onDismiss:()=>k(!1),render:()=>{const e=(0,E().zx)()?r:r.filter((e=>"table"!==e.type));return(0,q.jsx)(te,{store:t,items:[...a.slice(M),...e]})}})},action:e=>{h().ki(l,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more"}),k(!0)}};return[w,T]}({store:t,editorWidth:B,initialVisible:oe,initialOverflow:ie});return(0,q.jsx)(V().s,{allowSelectionWithin:!1,children:(0,q.jsx)(z().Ay,{type:z().Oh.Horizontal,store:k,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Z,{isInPeekView:$}),(0,q.jsx)("div",{style:ne.root,children:(0,q.jsxs)(K().VP,{gap:12,children:[(0,q.jsx)(H().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:O?(0,q.jsx)(g().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,q.jsx)(g().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,q.jsx)("div",{style:{cursor:"pointer"},children:(0,q.jsx)(K().fI,{gap:Q,children:e.children})})]},e.key)})]}),items:[...ae,re]}]})})}function Z(e){const t=(0,s().IS)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.peekModalBackground:t.contentBackground} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,q.jsx)("div",{style:t.fade})}const J=(0,g().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},dictate:{defaultMessage:"Dictate",id:"newpage.templates.dictateIntoNewPage"},transcription:{defaultMessage:"Meet",id:"newpage.templates.transcription"},more:{defaultMessage:"More",id:"newpage.templates.more"},quickTemplatePlaceholder:{defaultMessage:"...",id:"newpage.templates.quickTemplatePlaceholder"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function X(){const e=(0,i().v3)(),{isTablet:t}=(0,i().Y0)(),n=(0,B().X)("tablet_refresh_template_pills_gate");return!(!t||!n)||!e.device.isMobile}const ee={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function te(e){const{store:t,items:n}=e,a=(0,i().v3)(),r=(0,o.useMemo)((()=>new(O().A)),[]),l=(0,s().IS)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:16,marginLeft:2,marginRight:2,fill:e.regularIconColor},divider:{height:1,background:e.stroke.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(a))).map((e=>{const n={key:e.name,render:t=>{var n;let{ref:o,...i}=t;return"divider"===e.type?(0,q.jsx)("div",{style:l.divider}):(0,q.jsx)(Y().A,{...i,format:"horizontal-new-page-submenu",title:(0,q.jsx)(H().A,{children:e.name}),type:e.type,icon:null===(n=e.iconFn)||void 0===n?void 0:n.call(e,l.icon),locked:!1})},action:n=>{(0,N().EF)(a)&&(h().ki(a,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(a,t))}};return n}));return(0,q.jsx)(z().Ay,{type:z().Oh.Vertical,store:r,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,q.jsx)("div",{style:l.menu,children:(0,q.jsx)(K().VP,{children:e.children},e.key)}),items:d}]})}},617014:(e,t,n)=>{n.d(t,{I:()=>H});n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(100622),l=()=>n(496603),d=()=>n(401996),c=()=>n(856952),u=()=>n(529183),p=()=>n(717162),m=()=>n(663590),g=()=>n(437487),f=()=>n(381374),h=()=>n(842599),y=()=>n(126818),v=()=>n(167355),b=()=>n(75846),x=()=>n(949306),S=()=>n(234194),M=()=>n(792071),A=()=>n(798880),C=()=>n(959013),w=()=>n(534177),j=()=>n(84817),k=()=>n(704152),I=()=>n(460292),T=()=>n(554509),P=()=>n(859428),_=()=>n(453697),B=()=>n(698449),L=()=>n(962730),R=()=>n(308227),D=n(474848);const O=(0,C().YK)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guest:{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},overGeneralGuestLimit:{id:"inviteTargetToken.overGeneralGuestLimit.tooltip",defaultMessage:"This workspace has reached its guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function N(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:i}=e,r=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,w().HB)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,w().HB)(t.reason);if("member_request"===t.type)return"red";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,w().HB)(t.reason)}else(0,w().HB)(t)}(t,n),s=(0,C().tz)(),l=F(r),d=(0,o.useCallback)((()=>{i(t)}),[t,i]),c=(0,a().K8)((()=>(0,m().FI)()),[]),u=function(e){const{inviteTarget:t,defaultAddability:n,intl:o,isRedesignEnabled:i}=e,a=(0,p().K0)(t),r=t.type;if("group"===r)return;if("invalidUser"===r)return o.formatMessage(O.invalidUser,{text:t.value.text});if(!a)return;if("existingUser"!==r&&"newUser"!==r)return(0,w().HB)(r);if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return o.formatMessage(O.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return o.formatMessage(O.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return o.formatMessage(O.disabledByAdmins);if("not_authorized_domain"===n.reason)return o.formatMessage(O.notAuthorizedDomain,{email:a});if("invalid_email"===n.reason)return o.formatMessage(O.invalidUser,{text:"unknown"});(0,w().HB)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?o.formatMessage(O.autojoinMember,{email:a,domain:(0,h().zN)(a)}):"guests_disabled"===n.reason?o.formatMessage(O.guestsDisabledMember,{email:a}):"over_internal_guest_limit"===n.reason?a:(0,w().HB)(n.reason);if("member_request"===n.type)return o.formatMessage(O.disabledByAdmins);if("member_page_add"===n.type)return a;if("guest"===n.type)return i?o.formatMessage(O.guestV2,{email:a}):o.formatMessage(O.guest,{email:a});if("guest_request"===n.type)return o.formatMessage(O.guestRequest);if("guest_page_add"===n.type)return i?o.formatMessage(O.guestV2,{email:a}):o.formatMessage(O.guest,{email:a});(0,w().HB)(n)}({inviteTarget:t,defaultAddability:n,intl:s,isRedesignEnabled:c});return(0,D.jsx)(P().A,{placement:L().W.Top,renderTooltip:()=>u,disableTooltip:!u,render:e=>(0,D.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,D.jsxs)(j().Y1,{gap:2,style:l.token,borderRadius:c?4:3,padding:"2px 4px",width:"hug",children:[(0,D.jsxs)(j().Y1,{align:"center-left",borderRadius:3,direction:"horizontal",gap:4,width:"hug",children:[(0,D.jsx)(E,{inviteTarget:t,tokenColor:r}),(0,D.jsx)(T().D,{colorName:U(r),styleName:"UIRegular-14px/Regular",customStyles:l.label,children:W(t,s)}),(0,D.jsx)(k().A,{hoveredStyle:l.removeButtonHovered,pressedStyle:l.removeButtonPressed,onClick:d,children:(0,D.jsx)(I().Q,{iconGroup:x().Q,colorName:"secondary",variantName:"mini"})})]}),(0,D.jsx)(R().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,D.jsx)("div",{style:{marginLeft:24,paddingBottom:2},children:(0,D.jsx)(T().D,{colorName:"secondary",styleName:"UISmall-12px/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function E(e){const{inviteTarget:t,tokenColor:n}=e,o=F(n);switch(n){case"green":return(0,D.jsx)(I().Q,{iconGroup:y().g,colorName:"greenPrimary",variantName:"default"});case"yellow":return(0,D.jsx)(I().Q,{iconGroup:b().u,colorName:"yellowPrimary",variantName:"default"});case"red":return(0,D.jsx)(I().Q,{iconGroup:v().F,colorName:"uiRedPrimary",variantName:"default"});case"gray":return"existingUser"===t.type?(0,D.jsx)(j().Y1,{align:"center",width:20,height:20,children:(0,D.jsx)(_().A,{userValue:t.value,size:16})}):(0,D.jsx)("div",{style:o.iconCircle,children:(0,S().M)(o.icon)});default:(0,w().HB)(n)}}function F(e){return(0,r().IS)((t=>({token:V(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function U(e){switch(e){case"green":return"greenPrimary";case"yellow":return"yellowPrimary";case"red":return"uiRedPrimary";case"gray":return"grayPrimary";default:(0,w().HB)(e)}}function V(e,t){return{background:K(e,t),border:z(e,t)}}function K(e,t){switch(e){case"green":return t.fill.greenPrimary;case"yellow":return t.fill.yellowSecondary;case"red":return t.tint.uiRed;case"gray":return t.legacyDefaultSelectColor;default:(0,w().HB)(e)}}function z(e,t){switch(e){case"red":return`1px dashed ${t.stroke.uiRedPrimary}`;case"green":case"yellow":case"gray":return;default:(0,w().HB)(e)}}function W(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return M().Bj6.fromValue(A().oo,e.value).getDisplayName(t);case"group":return(0,B().Pf)({intl:t,groupName:e.value.name});default:(0,w().HB)(n)}}function H(e){const{addabilities:t,disabled:n,metadata:p,focus:h,onFocus:y,onInputChanged:v,onSubmit:b,placeholder:x,right:S,showEmptyError:M,setAutoFocusInput:A}=e,C=(0,i().v3)(),w=(0,i().Y0)(),j=(0,a().uB)(e.inviteTargetsStore,u().Ay),k=(0,a().K8)((()=>j.state.inviteTargets),[j]),I=function(e){const{focus:t,disabled:n,hasTokens:o}=e,i=(0,a().K8)((()=>(0,m().FI)()),[]);return(0,r().IS)((e=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:i?{alignSelf:"flex-start"}:{},inputOuterStyle:{borderRadius:i?6:4,...t&&!i&&{background:"none"},...n&&{background:e.inputBackground,color:e.mediumTextColor,fill:s().Ay.white,opacity:.4},...i&&{alignItems:"flex-start"}},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{...!o&&{padding:2}},warningMessage:{color:"#DE5550"}})),[o,i,t,n])}({focus:h,disabled:n,hasTokens:k.length>0}),T=(0,a().K8)((()=>j.state.tokenQuery),[j]),P=(0,a().K8)((()=>(0,m().FI)()),[]),{inputFieldText:_}=(0,a().K8)((()=>({inputFieldText:j.state.tokenQuery.trim()})),[j]),B=(0,o.useCallback)((e=>{d().S({inviteTargetsStore:j,targetToRemove:e})}),[j]);return k?(0,D.jsx)(c().Ay,{focus:h,focusAfterAnimation:!0,onClick:()=>{w.isMobile||null==y||y()},format:c().le.Share,value:T,onChange:e=>{if(P&&0===_.length){const e=g().Ay.state;g().Ay.setState({...e,tab:g().QC.Share,display:g().pP.Invite,focus:g().yZ.Search,source:e.display===g().pP.Invite?e.source:g().NL.Notion,emailMessage:e.display===g().pP.Invite?e.emailMessage:""}),null==A||A(!1)}d().P({environment:C,event:e,inviteTargetsStore:j,inviteOrigin:p.inviteOrigin,flowId:p.inviteFlowId,onInputChanged:v})},type:"email",tokens:k.map(((e,n)=>(0,D.jsx)(N,{inviteTarget:e,onClickRemove:B,defaultAddability:G(e,t)},n))),disabled:n,autoComplete:"off",placeholder:x,onRemoveLastToken:()=>{j.setState({...j.state,inviteTargets:j.state.inviteTargets.slice(0,-1)})},right:S,rightWrapStyle:I.inputRightItemStyle,showBorder:!0,inputStyle:I.inputInnerStyle,inputAndTokenWrapRightStyle:I.inputAndTokenWrapRight,style:I.inputOuterStyle,onSubmit:b,inputFullWidth:!0,message:(0,D.jsx)(f().p,{invalidInvites:(0,l().oE)(k.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:M,styles:I.warningMessage})}):null}function G(e,t){const n=(0,p().K0)(e);if(n)return null==t?void 0:t[n]}},617941:(e,t,n)=>{n.d(t,{A:()=>s,J:()=>a});var o=n(296540),i=n(474848);const a=16;function r(e){let{icon:t,style:o,size:r=a}=e;return(0,i.jsx)(n(854672).A,{type:"notion_icon",size:r,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:o})}const s=o.memo(r)},650843:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>s});n(296540);var o=()=>n(167355),i=()=>n(840071),a=()=>n(113414),r=n(474848);function s(e){const{errorId:t}=e;return(0,r.jsx)(i().L,{iconGroup:o().F,errorId:t,children:(0,r.jsx)(a().g,{})})}},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var o=n(296540),i=()=>n(56366),a=()=>n(959013),r=()=>n(743260),s=()=>n(299545),l=()=>n(417555),d=()=>n(856952),c=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:m,handleInputChange:g,handleInputSubmit:f,defaultRoleForNonBot:h,right:y,focus:v,handleFocus:b}=e,x=(0,i().K8)((()=>0!==(0,n(731320).Qo)()),[]),S="share_menu"===t||"add_members"===t,M="add_members"===t,[A,C]=(0,i().$y)(u),w=(0,n(484714).v3)(),{device:j}=w,k=(0,a().tz)(),{tokenQuery:I}=A,T=(0,n(101749).N)(p),P=A.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,r().yi)(e),s="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=i?T:void 0,u={key:t,target:e,onClickRemove:m,role:A.inviteRole,shouldWrap:S,showInfoIcon:Boolean(d)};return S&&s?(0,c.jsx)(n(859428).A,{placement:n(962730).W.Top,disableTooltip:M,renderTooltip:()=>i?d||(0,c.jsx)(a().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:s}}):s,render:n=>(0,o.createElement)("span",{...n,key:t},(0,c.jsx)(l().A,{...u,backgroundColor:(0,r().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})}));return(0,c.jsx)(d().Ay,{focus:j.isMobile?void 0:v,focusInitial:j.isMobile,focusAfterAnimation:!0,onClick:()=>{j.isMobile||null==b||b()},format:d().le.Share,value:I,onChange:g,type:"email",tokens:P,disabled:!1,autoComplete:"off",placeholder:S?x?k.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):k.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,s().Yu)(p)||(0,s().nw)(p)?k.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):k.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...A};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=h),C(A)},right:y,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:w.device.isMobile?0:A.isInviteTargetsEmpty?7:6,paddingBottom:w.device.isMobile||S?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:j.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:A.isInviteTargetsEmpty?3:0,paddingBottom:0,...v&&{background:"none"}}}})}},655784:(e,t,n)=>{n.d(t,{A:()=>c});n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(959013),s=()=>n(496603),l=()=>n(418426),d=n(474848);const c=function(e){const{teamStore:t,from:c,onLeavingTeam:u,style:p,hoveredStyle:m,icon:g,isRed:f,placement:h,alignment:y,buttonInternals:v}=e,b=(0,i().v3)(),x=(0,a().K8)((()=>n(351360).default.state.currentSpaceStore),[]),S=(0,l().$)(t),M=(0,o.useCallback)((async()=>{if(!x)return;await n(848237).JC({environment:b,teamStore:t,from:c,userGroupsInTeam:S})&&(null==u||u())}),[x,b,t,c,S,u]),A=(0,d.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),C=function(e){let{teamStore:t}=e;const n=(0,i().v3)(),o=n.currentUser.id,{isDefaultTeam:c}=(0,a().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),u=(0,l().$)(t),p=(0,a().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return Boolean(o&&t.isOwner(o)&&e.length+n.length===1)}),[t,o]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:n,userGroupsInTeam:o}=e;if(t)return(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(n)return(0,d.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(o.length>0)return(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:s().oE(o.map((e=>e.name))).join()}})}({isDefaultTeam:c,isOnlyTeamOwner:p,userGroupsInTeam:u})}({teamStore:t}),w=Boolean(C),j=w?C:A;return(0,d.jsx)(n(859428).A,{style:w?{width:240}:void 0,disableTooltip:!Boolean(j),renderTooltip:e=>(0,d.jsx)("div",{...e,children:j}),textWrap:w,placement:h,alignment:y,render:e=>(0,d.jsx)(n(493823).p,{...e,style:p,hoveredStyle:m,onClick:M,disabled:w,disabledFeedback:w,icon:g,isRed:f,children:v||(0,d.jsxs)(d.Fragment,{children:[(0,n(831310).o)({width:12.5,marginRight:4}),(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},667193:(e,t,n)=>{n.d(t,{p:()=>r});var o=()=>n(484714),i=()=>n(56366),a=()=>n(186445);function r(){const e=(0,o().v3)();return(0,i().O$)((0,a().rp)(e))}},673898:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{active:!1,stringValue:""}}}const i=new o},673964:(e,t,n)=>{n.d(t,{j:()=>a});var o=()=>n(953418),i=()=>n(129522);function a(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=i().K.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,o().vq)(t,{edgeDist:0,animate:!1})}}}},680777:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>p,default:()=>m});n(296540);var o=()=>n(56366);const i=(0,n(340498).xh)("importIntoNewFile",{default:{loader:()=>n.e(51997).then(n.bind(n,651997))},small:{loader:()=>n.e(84479).then(n.bind(n,84479))},mini:{loader:()=>n.e(44881).then(n.bind(n,444881))},large:{loader:()=>n.e(86359).then(n.bind(n,986359))}});var a=()=>n(959013),r=()=>n(41432),s=()=>n(404141),l=()=>n(7674),d=()=>n(107683),c=n(474848);function u(){r().A.setState({open:!1})}function p(){const e=(0,o().O$)(r().A);return(0,c.jsx)(d().s,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,c.jsx)(l().tf,{header:(0,c.jsx)(l().YA,{iconAndTitle:(0,c.jsx)(l().ZQ,{iconGroup:i,title:(0,c.jsx)(a().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(a().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(a().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{s().A.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const m=p},683881:(e,t,n)=>{n.d(t,{A:()=>O});n(944114),n(898992),n(354520),n(672577),n(581454),n(737550);var o=n.n(n(844751)),i=n(296540),a=()=>n(484714),r=()=>n(56366),s=()=>n(970013),l=()=>n(713998),d=()=>n(784892),c=()=>n(206267),u=()=>n(519831),p=()=>n(959013),m=()=>n(496603),g=()=>n(183558),f=()=>n(534177),h=()=>n(193722),y=()=>n(519839),v=()=>n(175116),b=()=>n(476492),x=()=>n(722872),S=()=>n(857437),M=()=>n(970585),A=()=>n(760217),C=()=>n(439264),w=()=>n(928600),j=()=>n(939740),k=()=>n(64e3),I=()=>n(45552),T=()=>n(89924),P=()=>n(753199),_=()=>n(399762),B=n(474848);const L=i.forwardRef((function(e,t){var o;const{locked:i,option:r,actionMenuOpen:s,property:l,collectionId:c,analyticsFrom:u,onChange:p,onCloseActionMenu:g,focused:f,propertySchema:h,onOpenActionMenu:y}=e,v=(0,n(401497).DP)(),b=(0,a().v3)();return(0,B.jsx)(n(545805).A,{debugName:"SelectPropertyMenuItem",capture:s,onEnter:m().D_,children:(0,B.jsx)(n(859428).A,{renderTooltip:e=>(0,B.jsxs)("div",{...e,style:n(673730).Q$,children:[(0,B.jsx)("div",{children:r.value}),(0,B.jsx)("div",{style:{color:v.text.contrastSecondary},children:r.description})]}),placement:n(962730).W.Left,disableTooltip:!(null!==(o=r.description)&&void 0!==o&&o.length),render:o=>(0,B.jsx)(A().A,{...(0,n(553965).A)(o,e),ref:t,title:(0,B.jsx)(_().O,{format:b.device.isMobile?d().NY.Large:d().NY.Medium,value:r.value,color:r.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!i&&(0,B.jsx)(R,{property:l,collectionId:c,analyticsFrom:u,onChange:p,onCloseActionMenu:g,actionMenuOpen:s,focused:f,option:r,propertySchema:h,onOpenActionMenu:y})})})})}));function R(e){let{property:t,collectionId:o,analyticsFrom:i,onChange:r,onCloseActionMenu:s,actionMenuOpen:l,focused:d,option:c,propertySchema:u,onOpenActionMenu:p}=e;const m=(0,a().v3)(),{device:g}=m;return(0,B.jsx)(n(823882).h,{open:l,origin:(0,B.jsx)(n(911706).A,{onClick:e=>function(e,t,n){(0,P().SQ)({event:e,context:P().y$.MenuListClick,callback:()=>t(n.value)})}(e,p,c),isMobile:g.isMobile,style:{opacity:d||g.isMobile?1:0}}),option:c,propertySchema:u,property:t,collectionId:o,analyticsFrom:i,onChange:r,onClose:s})}var D=()=>n(856952);function O(e){const{allowMultiple:t,analyticsFrom:n,autofillExplanation:g,bulkAutofillButton:A,canConfigureCollection:C,collectionId:P,disabled:L,insertChar:R,onAccept:O,onChange:E,onDismiss:U,property:K,schema:H,value:G}=e,Y=(0,a().v3)(),{device:q}=Y,Q=(0,p().tz)(),$=(0,i.useRef)(void 0),Z=(0,v().ET)(),J=(0,r().uB)(void 0,M().A),[X,ee]=(0,S().$)(),[te,ne]=(0,i.useState)(""),[oe,ie]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{z(H,K,$),R&&ne(R)}),[R,K,H]);const ae=(0,i.useCallback)((e=>function(e){const{change:t,allowMultiple:n,analyticsFrom:o,collectionContextStore:i,collectionId:a,createSelectColorRef:r,environment:l,onChange:d,property:p,schema:m,setInputValue:g}=e;g("");const v=m[p];if(!v)return;if(!s().lx(v))return;const x=v.options||[];let S;if("removeToken"===t.type)S={type:"selectPropertyMenuUpdateRemoveOption",removeOption:t.removedToken};else if("addTokens"===t.type){let e;n?(e=t.newTokens,S={type:"selectPropertyMenuUpdateAddOptions",addOptions:e}):(e=t.newTokens.length>0?[t.newTokens[t.newTokens.length-1]]:[],S={type:"selectPropertyMenuUpdateReplaceOptions",options:e});const s=e.find((e=>!x.find((t=>t.value===e))));if(s){const e={id:c().JW(),value:s,color:r.current};let t;t="alphabetical"===v.auto_sort_options||"reverse_alphabetical"===v.auto_sort_options?[(0,y().og)({collectionId:a,property:p,propertySchema:v,newOption:e,isAscending:"alphabetical"===v.auto_sort_options})]:[{pointer:{table:u().Vl,id:a},command:"keyedObjectListAfter",path:["schema",p,"options"],args:{value:e}}],S.schemaOperations=t,z(m,p,r),(0,h().L)(l,{...(0,b().sl)(i),property_type:v.type,action:"select_add_option",from:o})}}else(0,f().HB)(t);d(S)}({allowMultiple:t,analyticsFrom:n,collectionContextStore:Z,collectionId:P,createSelectColorRef:$,environment:Y,onChange:E,property:K,schema:H,setInputValue:ne,...e})),[t,n,Z,P,Y,E,K,H]),re=(0,i.useCallback)((e=>m().oE(G.map((t=>{const n=(0,l().jy)(e,t);if(n)return(0,B.jsx)(_().O,{value:n.value,color:n.color,showRemoveButton:!L,isSingle:!0,format:q.isMobile?d().NY.Large:d().NY.Medium,shouldShrink:!0,onClickRemove:()=>{ae({change:{type:"removeToken",removedToken:t}})},showEllipsis:!0},n.id)})))),[q.isMobile,L,ae,G]),se=(0,i.useCallback)((e=>{ie(e)}),[]),le=H[K];if(!le)return null;if(!s().lx(le))return null;const de=le.options||[],ce=function(e,t,n){const i=t.map((e=>e.value));let a;if(e){a=o().filter(e,i).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&n&&a.push(e.trim().replace(/,/g,""))}else a=i;return a}(te,de,C),ue=re(de),pe=le.select_ai_inference,me=0===ce.length,ge=(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(D().Ay,{focus:q.isMobile?void 0:!oe,focusAfterAnimation:!0,format:D().le.Select,tokens:ue,tokenWrapStyle:{padding:"3px 5px",gap:6},placeholder:null!=pe&&pe.auto_update_on_edit?Q.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):Q.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{G.length>0&&ae({change:{type:"removeToken",removedToken:G[G.length-1]}})},value:te,disabled:L,hideInput:!1,onChange:e=>ne(e.target.value),dontShowBorderBottom:q.isAndroid,...X,suppressFocusRing:!0}),g]});let fe;return fe=q.isMobile?{menuType:x().gu.Modal,title:le.name,right:(0,B.jsx)(I().DoneMenuText,{}),onClickRight:U,header:ge,footer:A}:{menuType:x().gu.Popup,header:ge,tokenInputHeader:!0,footer:A},L?(0,B.jsx)(w().A,{...fe}):(0,B.jsx)(w().A,{...fe,children:me?(0,B.jsx)(T().A,{title:C?(0,B.jsx)(F,{}):(0,B.jsx)(N,{}),children:q.isMobileNative&&(0,B.jsx)(k().A,{title:(0,B.jsx)(N,{})})}):(0,B.jsx)(j().Ay,{type:j().Oh.Vertical,initialFocus:te.length>0?0:void 0,sections:[{key:1,render:e=>(0,B.jsx)(V,{collectionId:P,property:K,schema:H,onChange:E,canConfigureCollection:C,menuListStore:J,args:e,tokens:ce}),items:W({analyticsFrom:n,canConfigureCollection:C,collectionId:P,createSelectColorRef:$,handleOnTokenInputChange:ae,handleSetOpenPropertyActionMenu:se,onChange:E,openPropertyActionMenu:oe,options:de,property:K,schema:H,tokens:ce,value:G})}],onAccept:(e,t,n)=>{O(n)},store:J,comboboxProps:ee})})}function N(){return(0,B.jsx)(p().sA,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function E(){return(0,B.jsx)(p().sA,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function F(){return(0,B.jsx)(p().sA,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function U(e){let{props:t,newOption:n,token:o}=e;const i=(0,a().v3)(),{device:r}=i;return(0,B.jsx)(A().A,{...t,title:(0,B.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,B.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,B.jsx)(p().sA,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,B.jsx)(_().O,{value:n.value,color:n.color,showRemoveButton:!1,isSingle:!0,format:r.isMobile?d().NY.Large:d().NY.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function V(e){let{args:t,tokens:n,collectionId:o,property:a,schema:r,onChange:l,canConfigureCollection:d,menuListStore:c}=e;const p=(0,i.useCallback)((e=>function(e,t,n,o,i,a){const r=(0,y().os)({newOptions:e,collectionId:t,property:n,schema:o});if(r){const e=o[n];e&&s().lx(e)&&"manual"!==(e.auto_sort_options||"manual")&&r.push({pointer:{table:u().Vl,id:t},command:"update",path:["schema",n],args:{auto_sort_options:"manual"}}),i({type:"selectPropertyMenuUpdateSchema",schemaOperations:r})}a.reset()}(e,o,a,r,l,c)),[o,a,r,l,c]);return d?(0,B.jsx)(T().A,{...t,title:(0,B.jsx)(F,{}),children:(0,B.jsx)(C().Ay,{direction:"vertical",keys:n,renderKey:e=>t.children[n.indexOf(e)],onDrop:p})}):(0,B.jsx)(T().A,{...t,title:(0,B.jsx)(E,{}),children:t.children})}function K(e){let{analyticsFrom:t,canConfigureCollection:n,collectionId:o,handleSetOpenPropertyActionMenu:r,onChange:l,openPropertyActionMenu:d,option:c,property:u,props:p,schema:g,value:f}=e;const h=(0,a().Y0)(),y=(0,i.useMemo)((()=>c.value===d),[d,c.value]),v=g[u];return v&&s().lx(v)?(0,B.jsx)(L,{...p,option:c,showDragHandle:n&&!h.isMobile,locked:!n,property:u,analyticsFrom:t,collectionId:o,onChange:e=>function(e,t,n,o,i){const a=n[t];if(!a)return;if(!s().lx(a))return;const r=a.options||[],l=[...r];let d;const c=o.filter((e=>{const t=r.find((t=>t.value===e));return!t||l.some((e=>e.id===t.id))}));d=m().n4(c,o)?{type:"selectPropertyMenuUpdateSchema",schemaOperations:e}:{type:"selectPropertyMenuUpdateReplaceOptions",options:c,schemaOperations:e};i(d)}(e,u,g,f,l),actionMenuOpen:y,propertySchema:v,onCloseActionMenu:r,onOpenActionMenu:r}):null}function z(e,t,n){const o=e[t];if(!o)return;if(!s().lx(o))return;const i=o.options||[],a=(0,s().Zd)(i);n.current=a}function W(e){const{analyticsFrom:t,canConfigureCollection:n,collectionId:o,createSelectColorRef:i,handleOnTokenInputChange:a,handleSetOpenPropertyActionMenu:r,onChange:s,openPropertyActionMenu:l,options:d,property:c,schema:u,tokens:p,value:m}=e;return p.map((e=>{const p=d.find((t=>t.value===e));return{key:e,render:a=>{if(p)return(0,B.jsx)(K,{analyticsFrom:t,canConfigureCollection:n,collectionId:o,handleSetOpenPropertyActionMenu:r,onChange:s,openPropertyActionMenu:l,option:p,property:c,props:a,schema:u,value:m});{const t={id:(0,g().Ay)(),value:e,color:i.current};return(0,B.jsx)(U,{props:a,newOption:t,token:e})}},action:()=>{m.includes(e)||a({change:{type:"addTokens",newTokens:[e]}})}}}))}},687039:(e,t,n)=>{n.d(t,{A:()=>s,V:()=>a});n(898992),n(430670);var o=n(296540),i=n(474848);const a={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function r(e){return e.src?(0,i.jsx)("img",{style:e.style,src:e.src}):null}const s=o.forwardRef((function(e,t){const a=(0,n(401497).DP)(),s=o.useRef(e);s.current=e,o.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const o=document.getElementById(e.src),i=new n.Player(o);return i?(i.on("play",(e=>{var t,n;null===(t=(n=s.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=s.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=s.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,s.current.src]);const l=function(e,t){const o=(0,n(534177).WP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${o}`}(s.current.src,{texttrack:s.current.defaultTextTrack,playsinline:!1,...s.current.options}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderStyle:"solid",borderColor:a.tableDividerColor,borderWidth:"0 0 1px 0"};return(0,i.jsxs)(n(25500).A,{ratio:s.current.aspectRatioOverride??9/16,children:[(0,i.jsx)(r,{style:d,src:s.current.preloadThumbnailSrc}),(0,i.jsx)("iframe",{ref:t,id:s.current.src,className:s.current.className,allowFullScreen:!0,src:l,style:{...d,...s.current.style}})]})}))},687110:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>v,TopbarPageAnalyticsOptOutMenu:()=>y,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(959013),r=()=>n(72234),s=()=>n(836251),l=()=>n(962730),d=()=>n(377586),c=()=>n(351360),u=()=>n(364280),p=()=>n(14235),m=()=>n(719147),g=()=>n(702723),f=n(474848);const h=n(757695).default.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function y(){const e=(0,o().v3)(),t=(0,i().K8)((()=>h.state.isOpen),[]),n=(0,i().K8)((()=>h.state.rect),[]),r=(0,i().K8)((()=>c().default.state.mainEditorCurrentBlockStore),[]);return r?(0,f.jsx)(p().Ay,{popupType:e.device.isMobile?d().n.SlideUp:d().n.Popup,alignmentToOrigin:l().C.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u().VP,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(a().sA,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(v,{store:r})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function v(e){const t=(0,o().v3)(),n=(0,i().K8)((()=>{const e=c().default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),l=(0,i().K8)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g().A,{type:"dropdown",currentOption:l?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(a().sA,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(a().sA,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:n=>{"do_not_record"===n?r().Oy(t,e.store.id):r().F3(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(a().sA,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(a().sA,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(m().A,{external:!0,href:(0,s().xS)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},695490:(e,t,n)=>{n.d(t,{L:()=>p,LX:()=>y,Li:()=>g,Sh:()=>h,V6:()=>a,VT:()=>s,Yk:()=>f,_n:()=>d,cm:()=>i,fA:()=>c,fs:()=>x,iD:()=>m,kb:()=>r,l:()=>v,rD:()=>u,w_:()=>S,xX:()=>l,yA:()=>b});var o=()=>n(645873);const i=new(o().O2)("menus",(async()=>{const[{default:e},{TopbarPageAnalyticsOptOutMenu:t},{default:o},{default:i},{default:a},{default:r},{default:s},{default:l},{default:d},{default:c},{default:u},{SidebarTeamModal:p},{SidebarCreateTeamModal:m},{CreateTeamFromPageConfirmModal:g},{CollectionTypedDatabaseMigrationModal:f},{default:h},{default:y},{default:v}]=await Promise.all([Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,977802)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,687110)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,467935)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,742784)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,381495)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,952305)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,70463)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,946576)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,996594)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,241504)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,273579)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,315729)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,83842)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,296431)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,952451)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,275193)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,756710)),Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,680777))]);return{CustomizePageMenuRenderer:e,TopbarPageAnalyticsOptOutMenu:t,ImportModal:o,ExportModal:i,PageTemplateModal:a,GoogleAuthPromptModal:r,StudentNotEligibleModal:s,CookieModal:l,ForkPagePopup:d,DatePropertyMenu:c,ReportPageModal:u,SidebarCreateTeamModal:m,SidebarTeamModal:p,CreateTeamFromPageConfirmModal:g,CollectionTypedDatabaseMigrationModal:f,OpenInDesktopAppPopup:h,BlockMenu:y,ImportIntoNewPageModal:v}})),a=(0,o()._h)(i,(e=>e.CustomizePageMenuRenderer)),r=(0,o()._h)(i,(e=>e.TopbarPageAnalyticsOptOutMenu)),s=(0,o()._h)(i,(e=>e.PageTemplateModal)),l=(0,o()._h)(i,(e=>e.ImportModal)),d=(0,o()._h)(i,(e=>e.ExportModal)),c=(0,o()._h)(i,(e=>e.ReportPageModal)),u=(0,o()._h)(i,(e=>e.GoogleAuthPromptModal)),p=(0,o()._h)(i,(e=>e.StudentNotEligibleModal)),m=(0,o()._h)(i,(e=>e.CookieModal)),g=(0,o()._h)(i,(e=>e.BlockMenu)),f=(0,o()._h)(i,(e=>e.ForkPagePopup)),h=(0,o()._h)(i,(e=>e.CollectionTypedDatabaseMigrationModal)),y=(0,o()._h)(i,(e=>e.SidebarCreateTeamModal)),v=(0,o()._h)(i,(e=>e.SidebarTeamModal)),b=(0,o()._h)(i,(e=>e.CreateTeamFromPageConfirmModal)),x=(0,o()._h)(i,(e=>e.OpenInDesktopAppPopup)),S=(0,o()._h)(i,(e=>e.ImportIntoNewPageModal))},696384:(e,t,n)=>{n.d(t,{V:()=>a,h:()=>i});var o=()=>n(91669);function i(){o().z.setState({isOpen:!0})}function a(){o().z.setState({isOpen:!1})}},698331:(e,t,n)=>{n.d(t,{$X:()=>a,H8:()=>r,x2:()=>i});var o=()=>n(534177);function i(e){return"event"===e||"recurrence"===e}function a(e){const t=e.getTrigger();return(0,o().O9)(t)&&i(t.type)}function r(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,o().HB)(e)}},704907:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(296540),i=()=>n(56366),a=()=>n(433847),r=()=>n(959013),s=()=>n(901389),l=()=>n(579627),d=()=>n(247123),c=()=>n(878377),u=()=>n(108944),p=()=>n(125565),m=n(474848);const g=function(e){let{store:t}=e;const g=(0,n(401497).DP)(),f=(0,n(484714).v3)(),h=(0,o.useMemo)((()=>({environment:f,blocks:[t],publicEditMode:void 0})),[f,t]),y=(0,i().K8)((()=>c().Uo6([c().Ezz,c().AU6(c().p2L)])(h)),[h]),v=(0,i().K8)((()=>c().Uo6([c()._mr,c().AU6(c().Km9)])(h)),[h]);if(y){const{device:e}=f;return(0,m.jsx)("div",{style:{backgroundColor:g.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${g.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,m.jsxs)(n(704152).A,{disabled:!v,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),o=u().KA(e),i=o?a().wD(u().E(o)):[],c=a().Cd(e.getModel(),n,i),p={type:"restore",permissionChanges:c},{accept:g}=await s().Gh({message:(0,d().r6)(p),acceptLabel:(0,d().QU)(p),cancelLabel:(0,m.jsx)(r().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,m.jsx)(d().f2,{openState:p})});g&&l().YD({environment:t,store:e})}(t,f),children:[(0,m.jsx)(p().A,{isMultiline:!0,isSmall:!0,children:(0,m.jsx)(r().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),v&&(0,m.jsx)(p().A,{style:{marginTop:6,fontWeight:n(284371).Wy.semibold},children:(0,m.jsx)(r().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})}return null}},705630:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>T});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(589407),l=()=>n(340498),d=()=>n(959013),c=()=>n(741496),u=()=>n(989423);var p=()=>n(778417),m=()=>n(645873);const g=new(m().O2)("topbarMoreMenu",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,764180)))),f=(0,m()._h)(g,(e=>e.TopbarMoreMenu));var h=()=>n(494043),y=()=>n(448360),v=()=>n(351360),b=()=>n(816013),x=()=>n(318890),S=()=>n(594607),M=()=>n(953006),A=n(474848);function C(e){const{originRef:t}=e,n=(0,r().IS)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.text.uiBluePrimary}})),[]);return(0,A.jsx)(S().U,{calloutId:"ai_page_translation",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:(0,A.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingLeft:4,paddingRight:4},children:[(0,x().K)(n.aiTranslateIcon),(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{y().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{y().W.reset()},nextButtonContent:(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var w=()=>n(406699),j=()=>n(612900),k=()=>n(782473);function I(e){let{originRef:t}=e;return(0,A.jsx)(S().U,{calloutId:"wiki_promo",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:k().Sw}})})}function T(e){let{buttonPopupStore:t,store:n,isLastButton:s}=e;const l=(0,i().v3)(),{device:d}=l,[m,g]=(0,o.useState)(void 0),x=(0,o.useRef)(null),S=(0,o.useCallback)((()=>{b().r.reset(),y().W.reset(),p().IU({environment:l});const e=x.current;e&&g(e.getBoundingClientRect()),function(e){u().vd(e,"open_more_menu")}(l)}),[x,l]),M=(0,a().K8)((()=>b().r.state.showConvertTooltip),[]),k=(0,a().O$)(y().W),T=(0,r().IS)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.surface.wash}})),[]),P=(0,A.jsxs)(A.Fragment,{children:[M?(0,A.jsx)(I,{originRef:x}):k?(0,A.jsx)(C,{originRef:x}):null,(0,A.jsx)(w().Ay,{popupType:d.isMobile?w().z7.BottomSheet:w().z7.Popup,buttonPopupStore:t,renderOrigin:e=>(0,A.jsx)(L,{ref:x,buttonPopupEvents:e,isLastButton:s}),onClick:S,render:()=>(0,A.jsx)(f,{blockStore:n,onClickOriginRect:m,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:o}=v().default.state;if(o){const t=o.getType();var i;if(t)(0,c().N)(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:o.id,block_type:t,is_toggleable:(0,h().Yt)(t,o.getFormat()),collection_id:null===(i=o.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels(),form_id:o.getFirstFormIdInCollectionViewBlock()})}e.closeParentMenu&&B(t)}(e,t,l),handleDismiss:()=>B(t)}),originGap:d.isElectronWindows?12:8,forceInitialInbound:!0,style:d.isMobile?T.mobilePopupStyle:{width:240,maxHeight:"80vh"}})]}),_=(0,a().K8)((()=>v().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return k&&_?(0,A.jsx)(j().u,{shape:"square",borderRadius:6,children:P}):P}const P=(0,d().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function _(e,t,o){const{device:i}=e;if(!i.isMobile){const{iconButton:{width:e,height:o}}=(0,n(863059).Hh)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:o,borderRadius:6}}const a=n(508496).default.checkGate({gateName:"tablet_refresh_gate"}),r=(0,n(281401).aD)(t).iconContainer;return o?{...r,marginLeft:i.isTablet&&a?-6:void 0,marginRight:0}:{...r,marginLeft:i.isTablet&&a?-6:void 0,marginRight:i.isTablet&&a?-6:void 0}}function B(e){e.setState({...e.state,open:!1})}const L=o.forwardRef((function(e,t){let{buttonPopupEvents:o,isLastButton:a}=e;const c=(0,r().DP)(),u=(0,i().v3)(),{device:p}=u,m=(0,d().tz)();return(0,A.jsx)(n(859428).A,{renderTooltip:()=>u.currentUser.isLoggedIn()?(0,A.jsx)(d().sA,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,A.jsx)(d().sA,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:n(962730).W.Bottom,originGap:p.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,A.jsx)(n(704152).A,{ref:t,style:_(u,c,a),mobileFeedback:p.isMobile,className:n(38337).ug9,ariaLabel:m.formatMessage(P.actions),...(0,n(553965).A)(o,e),children:p.isMobile?(0,s().L)({height:l().lD.lg,width:l().lD.lg,fill:c.icon.primary}):(0,s().L)({width:l().Ev.lg,height:l().Ev.lg,fill:c.icon.primary})})})}))},706513:(e,t,n)=>{n.d(t,{r:()=>B});n(898992),n(354520),n(672577),n(581454);var o=n.n(n(844751)),i=n(296540),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(713998),d=()=>n(784892),c=()=>n(390492),u=()=>n(959013),p=()=>n(496603),m=()=>n(534177),g=()=>n(686526),f=()=>n(673964),h=()=>n(886680),y=()=>n(673730),v=()=>n(722872),b=()=>n(553965),x=()=>n(857437),S=()=>n(962730),M=()=>n(831194),A=()=>n(760217),C=()=>n(928600),w=()=>n(939740),j=()=>n(45552),k=()=>n(89924),I=()=>n(859428),T=()=>n(399762),P=()=>n(856952),_=n(474848);function B(e){var t;const{propertySchema:n,blockPropertyValueOverlayStore:B,onChange:L}=e,{device:R}=(0,a().v3)(),[D,O]=i.useState(e.initialValue??""),[N,E]=i.useState(""),F=(0,s().DP)(),U=(0,u().tz)(),V=(0,r().K8)((()=>{const e=B.state;if(e.isOpen)return e.collectionContextStore}),[B]),K=(0,r().K8)((()=>(null==V?void 0:V.permissionScopesStore.state.canConfigureCollection)&&"collectionPage"!==(null==V?void 0:V.contextType)),[V]),z=(0,r().K8)((()=>{const e=B.state;return!!e.isOpen&&(0,h().br)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[B]),W=z?[]:n.options??[],H=(0,l().jy)(W,D),G=n.groups??[],Y=H&&G.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(H.id)})),[q,Q]=(0,x().$)(),$=H?[(0,_.jsx)(T().q,{value:H.value,color:H.color,groupColor:null==Y?void 0:Y.color,isSingle:!0,format:R.isMobile?d().NY.Large:d().NY.Medium,onClickRemove:()=>{O(""),L(void 0,void 0)},showRemoveButton:void 0===n.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:S().W.Left,hideTooltip:!(null===(t=H.description)||void 0===t||!t.length)},"status")]:[],Z=z?null:(0,_.jsx)(P().Ay,{focus:!R.isMobile||void 0,focusAfterAnimation:!0,format:P().le.Select,tokens:$,tokenWrapStyle:{padding:"3px 5px",gap:6},placeholder:U.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:p().lQ,value:N,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{E(e.target.value)},dontShowBorderBottom:R.isAndroid,...q,suppressFocusRing:!0});let J;if(J=R.isMobile?{menuType:v().gu.Modal,title:n.name,right:(0,_.jsx)(j().DoneMenuText,{}),onClickRight:e.onDismiss,header:Z}:{menuType:v().gu.Popup,header:Z,tokenInputHeader:!0},e.disabled)return(0,_.jsx)(C().A,{...J});let X=W;if(""!==N){const e=o().filter(N,W.map((e=>e.value))).map((e=>e.original));X=W.filter((t=>e.includes(t.value)))}const ee=G.map((e=>{const t=X.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(m().O9),te=ee.length>1,ne=z?[{items:G.map((t=>({key:t.name,render:e=>(0,_.jsx)(A().A,{...e,disabledFeedback:!0,focused:e.focused,title:(0,_.jsx)(M().RS,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,_.jsx)(k().A,{...e})}]:ee.map(((t,n)=>{let{group:o,groupOptions:i}=t;return{items:i.map((t=>{const n=e.shouldDisableOption?e.shouldDisableOption(t.id):{disabled:!1};return{key:t.value,render:e=>{var i;return(0,_.jsx)(I().A,{disableTooltip:n.disabled&&!(null!==(i=t.description)&&void 0!==i&&i.length),placement:S().W.Left,renderTooltip:e=>n.disabled?n.disableReasonMessage:(0,_.jsxs)("div",{...e,style:y().Q$,children:[(0,_.jsx)("div",{children:t.value}),(0,_.jsx)("div",{style:{color:F.text.contrastSecondary},children:t.description})]}),render:i=>{var a;return(0,_.jsx)(A().A,{...(0,b().A)(i,e),disabled:n.disabled,disabledFeedback:!0,focused:e.focused,title:(0,_.jsx)(T().q,{...i,value:t.value,color:t.color,hideTooltip:!(null===(a=t.description)||void 0===a||!a.length),tooltipPlacement:S().W.Left,groupColor:o.color,showRemoveButton:!1,isSingle:!0,format:R.isMobile?d().NY.Large:d().NY.Medium}),isTokenTitle:!0})}})},action:()=>{e.onChange(t.value,void 0)}}})),key:`group-${n}`,render:e=>(0,_.jsx)(k().A,{...e,topBorder:e.index>0,title:te&&(0,_.jsx)(M().RS,{group:o,showColor:!1,style:{fontSize:12}})})}})),oe=V&&K?{items:[{key:"edit property",render:e=>(0,_.jsx)(A().A,{...e,title:(0,_.jsx)(u().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,c().m)({width:14})}),action:()=>{const t=V.settingsStore;V.collectionStore()&&(e.onDismiss(),(0,f().j)({collectionContextStore:V}),g().Ow({collectionContextStore:V,collectionSettingsStore:t}),g().a2({collectionSettingsStore:t,item:{type:"property",formatKey:V.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,_.jsx)(k().A,{...e,topBorder:e.index>0})}:void 0;return(0,_.jsx)(C().A,{...J,children:(0,_.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:N.length>0?0:void 0,sections:p().oE([...ne,oe]),onAccept:(t,n,o)=>{e.onAccept(o)},comboboxProps:Q})})}},712493:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(296540);var o=()=>n(148307),i=()=>n(959013),a=()=>n(795750),r=n(474848);function s(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,r.jsx)(a().C,{...e,message:n})}const l=(0,i().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,i().tz)();return(0,r.jsx)(s,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),heroMedia:{src:o().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},715011:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),i=()=>n(959013),a=()=>n(409268),r=n(474848);function s(e){const t=(0,o.useMemo)((()=>(0,a().s)(e.store)),[e.store]);return(0,r.jsx)(i().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},715392:(e,t,n)=>{n.d(t,{W:()=>i});var o=()=>n(666144);const i=new(n(848776).U)((e=>{let{userId:t,spaceId:n}=e;return`${t}-${n}`}),(async function(e,t){var i;let{userId:a,spaceId:r}=t;const[s,l]=await Promise.all([o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:n(798880).oo,id:a},userId:a}),o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,n(848538).i1)({userId:a,spaceId:r}),userId:a})]),d=null===(i=n(351360).default.state.currentSpaceViewStore)||void 0===i||null===(i=i.getModel())||void 0===i?void 0:i.first_joined_space_time,c=null==s?void 0:s.value,u=null==l?void 0:l.value;if(c&&u&&d)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,first_joined_space_time:d}}));n(604341).exposeDebugValue("UserOnSpaceStore",i)},717162:(e,t,n)=>{n.d(t,{K0:()=>a,qw:()=>i});var o=()=>n(534177);function i(e){const{currentMembersAndGuests:t,inviteTarget:n}=e,o=a(n);if(!o)return;const i=function(e){const{email:t,currentMembersAndGuests:n}=e;return n.memberEmails.has(t)?"member":n.guestEmails.has(t)?"guest":void 0}({email:o,currentMembersAndGuests:t});return{email:o,currentRole:i}}function a(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,o().HB)(t)}}},720263:(e,t,n)=>{n.d(t,{A:()=>b});var o=n(296540),i=()=>n(484714),a=()=>n(401497),r=()=>n(965998),s=()=>n(959013),l=()=>n(21869),d=()=>n(441467),c=()=>n(862292),u=()=>n(980914),p=()=>n(205682),m=()=>n(77238),g=()=>n(24157),f=()=>n(704152),h=()=>n(35392),y=()=>n(859428),v=n(474848);function b(e){const t=(0,i().v3)(),{isMobile:n}=(0,i().Y0)(),b=(0,a().IS)((e=>({keyboardShorcut:{color:e.text.contrastSecondary}})),[]),x=async()=>{let n;const o=g().default.state;if("empty"!==o.mode){n=u().wg();const i=await c().T.formulas.load();d().hN({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,property_id:p().A.state.isOpen?p().A.state.property:m().A.state.isOpen?m().A.state.property:void 0,formulasModule:i})}(0,l().s)(t,{action:"comment",from:n?"simple_table_cell":void 0})};return(0,v.jsx)(y().A,{renderTooltip:()=>(0,v.jsxs)(o.Fragment,{children:[(0,v.jsx)("div",{children:(0,v.jsx)(s().sA,{defaultMessage:"Comment",id:"inlineCommentButton.tooltip"})}),(0,v.jsx)("div",{children:(0,v.jsx)(h().A,{style:b.keyboardShorcut,name:"comment"})})]}),render:t=>(0,v.jsxs)(f().A,{style:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:x,ariaLabel:e.ariaLabel,...t,children:[(0,r().M)({width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}),!n&&!e.iconOnly&&(0,v.jsx)(s().sA,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"})]})})}},728051:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>ne});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(584262),s=()=>n(179034),l=()=>n(75756),d=n(474848);const c={viewBox:"0 0 20 20",svg:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,d.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},u=(0,n(340498).wt)("arrowRightIntoRectangle",c);var p=()=>n(589407),m=()=>n(748054),g=()=>n(864896),f=()=>n(959013),h=()=>n(348337),y=()=>n(575143),v=()=>n(89924),b=()=>n(878377),x=()=>n(492414),S=()=>n(351360),M=()=>n(599364),A=()=>n(416726),C=()=>n(100622);const w=(0,f().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),j=(0,A().Ls)({key:"action report page",displayName:w.reportPageName,analyticsName:w.reportPageName.defaultMessage,validators:[b().sc7,b().Env,b().Kwf,b().AU6(b().kD4)],closeParentMenu:!0,render:e=>(0,d.jsx)(y().A,{...e,style:{color:C().Ay.red},svg:m().M,svgStyle:{fill:C().Ay.red},title:(0,d.jsx)(f().sA,{...w.reportPageName})}),action:e=>{let{blocks:t,environment:o}=e;n(201170).HX()}}),k=(0,f().YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),I=(0,A().Ls)({key:"log in",displayName:k.signUpOrLogInName,analyticsName:k.signUpOrLogInName.defaultMessage,svg:u,validators:[b().AU6(b().M3g),b().IrU,b().AU6(b().ZVI)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;n(452939).Tv(t),await n(729283).VE(t,{utmContent:"sign_up_or_log_in",nextRoute:n(427704).JZ.login})}}),T=(0,A().Ls)({key:"view original page",displayName:k.viewOriginalPageName,analyticsName:k.viewOriginalPageName.defaultMessage,svg:n(47218).C,validators:[b().ZVI],closeParentMenu:!0,action:e=>{let{blocks:t}=e;const n=(0,x().Ay)({store:t[0],preferPublicLink:!0,pageVisitSource:r().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${n}`,"_blank")}}),P=(0,A().Ls)({key:"report form",displayName:k.reportFormName,analyticsName:k.reportFormName.defaultMessage,svg:m().M,validators:[b().Env,b().kD4],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().Hi(t,n[0].id)}}),_=(0,A().Ls)({key:"ios share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().wHP,b().un6],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=t[0],i=o.getNavigableBlockStore();if(i){const e=(0,x().Ay)({store:i,scrollToBlockId:i.id===o.id?void 0:o.id,fullyQualified:!0,pageVisitSource:r().y8.NativeShareLink,embedded:!1});n.mobileNative&&n.mobileNative.share(e)}}}),B=(0,A().Ls)({key:"web share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().rr0],closeParentMenu:!0,action:async e=>{let{blocks:t}=e;const n=t[0],o=n.getNavigableBlockStore();if(o){const e=(0,x().Ay)({store:o,scrollToBlockId:o.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:r().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),L=(0,A().Ls)({key:"android share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:n(441532).y,validators:[b().vXb,b().wHP,b().m01],closeParentMenu:_.closeParentMenu,action:_.action}),R=(0,A().Fw)({key:"copy link",displayName:A().AY.copyLinkName,analyticsName:A().AY.copyLinkName.defaultMessage,svg:n(742852).w,shortcuts:["copyLinkToBlock"],validators:[b().M3g,b().vXb,b().AU6(b().wHP),b().AU6(b()._fc)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,n)=>{let{lazyDependencies:o,...i}=t;const{clipboardActions:a}=o;a&&a.copyLinkToBlock({...i,event:n,callback:e})}}),D=(0,A().Ls)({key:"edit page",displayName:k.editPageName,analyticsName:k.editPageName.defaultMessage,svg:n(105819).x,validators:[b().vXb,b()._fc,b().Wci,b().AU6(b().V5t),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().T7(t,n[0].id)}}),O=(0,A().Ls)({key:"comment page",displayName:k.commentPageName,analyticsName:k.commentPageName.defaultMessage,svg:n(49621).h,validators:[b().vXb,b()._fc,n(930545).tm,b().AU6(b().M3g),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().aL(t,n[0].id)}}),N=(0,A().Ls)({key:"fork page",displayName:k.duplicatePageName,analyticsName:k.duplicatePageName.defaultMessage,svg:n(764781).V,validators:[b().vXb,b().FrL,b()._fc,b().K1R],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:o,environment:i}=e;n(624550).Ul({environment:i,store:t[0],originRect:o})}});function E(e){return(0,A().Ls)({key:"more actions menu",displayName:k.topbarMobileMoreActionsMenu,analyticsName:k.topbarMobileMoreActionsMenu.defaultMessage,svg:p().L,validators:[b().vXb,b().FrL,b()._fc],closeParentMenu:!0,action:e})}const F=(0,A().Ls)({key:"back to my content",displayName:k.backtoNotionName,analyticsName:k.backtoNotionName.defaultMessage,svg:n(426388).S,validators:[b().M3g,b().FrL],closeParentMenu:!0,action:(e,t)=>{let{environment:o}=e;const{currentUserRootStore:i,currentUserSettingsStore:a}=S().default.state;i&&a&&n(426116).t9({environment:o,userRootStore:i,userSettingsStore:a,pageVisitSource:r().y8.SwitchSpace})}}),U=(0,A().Ls)({key:"cookie settings",displayName:l().LS.cookieSettingsLabel,analyticsName:l().LS.cookieSettingsLabel.defaultMessage,validators:[b().AU6(b().ibx)],closeParentMenu:!1,render:e=>(0,d.jsx)(n(455215).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:o,...i}=e;return(0,d.jsx)(y().A,{...i,...t,title:n(972435).A.formatMessage(l().LS.cookieSettingsLabel),svg:n(212727).gearIcon})}}),action:()=>{}}),V=(0,A().Ls)({key:"search page",displayName:k.search,analyticsName:k.search.defaultMessage,svg:n(207207).J,validators:[b().vXb,b().FrL,b()._fc,b().Kg6],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(260488)._N({environment:t,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});const K=[(0,A().gy)({key:"user",render:e=>(0,d.jsx)(v().A,{...e}),actions:[F,I,T]}),(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(v().A,{...e}),actions:[j,P,U]})],z=[(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(v().A,{...e}),actions:[j,U]})];var W=()=>n(741496),H=()=>n(435009),G=()=>n(722872),Y=()=>n(494043),q=()=>n(311337),Q=()=>n(578872),$=()=>n(411671),Z=()=>n(630116),J=()=>n(452558),X=()=>n(928600),ee=()=>n(614505),te=()=>n(16006);function ne(e){let{blockStore:t,onDismiss:n,isPublicShareLink:l}=e;const c=(0,i().v3)(),{isMobile:u}=c.device,p=(0,a().K8)((()=>$().A.getMode(c,t)),[c,t]),m=(0,a().K8)((()=>t.isFormBlock()),[t]),[g,f]=(0,o.useState)(u&&!m?"initialActions":"more"),h={environment:c,blocks:[t],publicEditMode:p,analyticsFrom:"topbar_more_menu"};let b;b=u?{menuType:G().gu.ActionSheet}:{menuType:G().gu.Popup,width:210,maxHeight:"80vh"};const C=(0,o.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=S().default.state;if(t){const n=t.getType();var o;if(n)(0,W().N)(c,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,Y().Yt)(n,t.getFormat()),collection_id:null===(o=t.getCollectionStore())||void 0===o?void 0:o.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[c,n]),w=(0,a().K8)((()=>{var e;if(!u)return;const n=t.getSpaceStore();if(!n)return;const o=Q().GN(t),i=null==o||null===(e=o.getSiteStore())||void 0===e||null===(e=e.getHeader())||void 0===e?void 0:e.customItems;if(!i)return;return{key:"custom nav",render:e=>(0,d.jsx)(v().A,{...e}),actions:i.filter((e=>"block"===e.type)).map((e=>{const o=Z().Bv.createChildStore(n,{table:s().ev,id:e.blockId}),i=o.getIcon(),a=(0,x().Ay)({store:o,preferPublicLink:!0,pageVisitSource:r().y8.SiteCustomHeader});return{key:e.blockId,analyticsName:e.blockId,displayName:e.blockId,searchName:e.blockId,render:e=>(0,d.jsx)(y().A,{...e,left:i&&(0,d.jsx)(ee().A,{icon:i,store:t,disabled:!0,isEmptyPage:o.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,d.jsx)(te().A,{store:o,maxLength:30})}),action:()=>{H().oo({environment:c,url:a})},closeParentMenu:!0}}))}}),[c,u,t]),j=(k=()=>{f("more")},(0,A().gy)({key:"page",render:e=>(0,d.jsx)(v().A,{...e}),actions:[V,N,O,D,R,M().oc,_,L,E(k)]}));var k;const I=function(e){return(0,A().gy)({key:"page",render:e=>(0,d.jsx)(v().A,{...e}),actions:[B,_,L,E(e)]})}((()=>{f("more")})),T=(0,a().K8)((()=>(0,q().y)(c)),[c]);if("initialActions"===g){const e=w?[w,j]:[j];return(0,d.jsx)(X().A,{...b,children:(0,d.jsx)(J().A,{sections:T?[I]:e,onAccept:C,context:h})})}return(0,d.jsx)(X().A,{...b,children:(0,d.jsx)(J().A,{sections:l?z:K,context:h})})}},731120:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1}}}},736026:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},748868:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(401497),i=()=>n(959013),a=()=>n(939740),r=()=>n(89924),s=n(474848);const l=function(e){const{importListItems:t}=e,l=(0,n(56366).uB)(void 0,n(970585).A),d=(0,o().IS)((e=>({InviteDropdownMenu:{background:e.cardContentBackground,width:265,borderRadius:8},helpIcon:{width:14,height:14,fill:e.icon.secondary},helpSection:{color:e.text.secondary,fontSize:12,padding:"0 8px",width:"100%"}})),[]),c={key:"all_import_sections",render:e=>(0,s.jsx)(r().A,{...e,title:(0,s.jsx)(i().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:t},u={key:"help_section",render:e=>(0,s.jsx)(r().A,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>p,action:()=>{}}]},p=(0,s.jsx)(n(187485).A,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,n(836251).xS)("guides.publicAPI"),external:!0,children:(0,s.jsx)(n(493823).p,{icon:n(133033).$,iconStyle:d.helpIcon,style:d.helpSection,children:(0,s.jsx)(i().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,s.jsx)(n(928600).A,{menuType:n(722872).gu.Popup,children:(0,s.jsx)(a().Ay,{type:a().Oh.Vertical,store:l,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[c,u],style:d.InviteDropdownMenu})})}},751237:(e,t,n)=>{n.r(t),n.d(t,{AiAssistantIntroModal:()=>H,useAssistantIntroModalStyles:()=>Y,useIdleFaceAsset:()=>Q,useSetLastExposedToQnaAtTimestamp:()=>ne});n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(852507),r=()=>n(56366),s=()=>n(401497),l=()=>n(654777),d=()=>n(449552),c=()=>n(959013),u=()=>n(534177),p=()=>n(284371),m=()=>n(352097),g=()=>n(246826),f=()=>n(201938),h=()=>n(435009),y=()=>n(317909),v=()=>n(576590),b=()=>n(140022),x=()=>n(501305),S=()=>n(577454),M=()=>n(146535),A=()=>n(737497),C=()=>n(656633);var w=()=>n(581495),j=()=>n(614415),k=()=>n(645873),I=()=>n(465425),T=()=>n(218429),P=()=>n(351360),_=()=>n(430483),B=()=>n(84817),L=()=>n(296798),R=()=>n(509657),D=()=>n(204063),O=()=>n(125565),N=()=>n(719147),E=n(474848);const F=24,U=254,V=170,K=(0,c().YK)({shareDataTitle:{defaultMessage:"You’re in control of your data",id:"AiAssistantWelcomeModal.intro.titleShareData"},shareDataHeader:{defaultMessage:"By default, Notion does not train on your content",id:"AiAssistantWelcomeModal.intro.shareDataHeader"},shareDataDescription:{defaultMessage:"But, if you’d like to help improve our models and features, please opt-in below:",id:"AiAssistantWelcomeModal.intro.shareDataDescription"},welcomeTitle:{defaultMessage:"Meet the new Notion AI",id:"AiAssistantWelcomeModal.intro.title"},subtitle:{defaultMessage:"One AI tool that does it all. Search, generate, analyze, and chat—right inside Notion.",id:"AiAssistantWelcomeModal.intro.subtitle"},findInSlack:{defaultMessage:"Find in Slack",id:"AiAssistantIntroModal.findInSlack"},findInGoogleDrive:{defaultMessage:"Find in Google Drive",id:"AiAssistantIntroModal.findInGoogleDrive"},attachFile:{defaultMessage:"Analyze PDF",id:"AiAssistantIntroModal.attachPDF"}}),z=[{id:m().Fi.searchQnA.id,label:m().Fi.searchQnA,icon:n(864153).l,color:"blue"},{id:m().Fi.chatKeyPoints.id,label:m().Fi.chatKeyPoints,icon:n(50170).u,color:"green"},{id:m().Fi.brainstormIdeas.id,label:m().Fi.brainstormIdeas,icon:n(602084).q,color:"green"},{id:m().Fi.writeCode.id,label:m().Fi.writeCode,icon:n(262865).l,color:"green"},{id:m().Fi.draftDiagram.id,label:m().Fi.draftDiagram,icon:n(79133).B,color:"purple"},{id:"attachment",label:K.attachFile,icon:n(819713).j},{id:m().Fi.draftTable.id,label:m().Fi.draftTable,icon:n(29118).K,color:"purple"},{id:m().Fi.draftMeetingAgenda.id,label:m().Fi.draftMeetingAgenda,icon:n(173019).r,color:"purple"},{id:m().Fi.translate.id,label:m().Fi.translate,icon:n(318890).K,color:"green"},{id:m().Fi.improveWriting.id,label:m().Fi.improveWriting,icon:n(985608)._,color:"purple"},{id:"findInGoogleDrive",label:K.findInGoogleDrive,icon:n(284030).u},{id:"findInSlack",label:K.findInSlack,icon:n(751109).z}],W=z.concat(z).concat(z);function H(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{let{source:n}=t;const{currentUserSettingsStore:o}=P().default.state;o&&((0,b().trackAssistantIntroModalClose)(e,{source:n}),(0,v().setAssistantOnboardingPhase)(e,{phase:"tooltip",transactionUserAction:"AiAssistantIntroModal.dismissModal",userSettingsStore:o}),I().a(e,"ai_assistant_announcement"))}),[e]);return ne(),(0,E.jsx)(T().l,{messageKey:"ai_assistant_announcement",desktopRenderInner:()=>(0,E.jsx)(J,{onDismiss:t}),phoneRenderInner:()=>null})}function G(){const e=Y();return(0,E.jsxs)("div",{style:e.rowItemWrapper,children:[(0,E.jsx)("div",{style:e.rowItemIconWrapper,children:(0,d().g)(e.rowItemIcon)}),(0,E.jsxs)("div",{style:e.textWrapper,children:[(0,E.jsx)("div",{style:e.sharedataTitle,children:(0,E.jsx)(c().sA,{...K.shareDataHeader})}),(0,E.jsx)(O().A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,E.jsx)(c().sA,{...K.shareDataDescription})})]})]})}function Y(){const e=oe();return(0,s().IS)((t=>({...e,rowItemWrapper:{display:"flex",alignItems:"start",marginBottom:12},rowItemIconWrapper:{color:t.accentColors.uiBlue[600],background:t.accentColors.uiBlue[100],display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100,marginRight:8},rowItemIcon:{height:30,width:30,padding:8},sharedataTitle:{fontWeight:p().Wy.medium,fontSize:14,marginBottom:4},textWrapper:{display:"flex",flexDirection:"column",maxWidth:"100%"},icon:{width:16,height:16,marginTop:2},sparklesIcon:{fill:t.accentColors.translucentGray[800],width:14},contentWrapper:{paddingLeft:24,paddingRight:26,width:424},assistantIntroHeaderWrapper:{height:200},title:{fontSize:25,fontWeight:700,paddingBottom:8},subtitle:{fontSize:p().J.UIRegular.desktop,fontWeight:p().Wy.regular,color:t.text.secondary},body:{fontWeight:400,fontSize:14,color:t.text.secondary},faceImg:{pointerEvents:"none",width:72,height:72,boxShadow:t.shadowSM,borderRadius:100,flexGrow:0},imgWrap:{display:"flex",alignItems:"center",paddingTop:40,paddingBottom:30,paddingLeft:24},spacer:{marginTop:20,marginBottom:20},footer:{paddingTop:8,paddingBottom:24,marginTop:20},simpleFooter:{paddingBottom:24},helpTitle:{fontSize:14,fontWeight:600},consentButton:{fontWeight:600,height:"36px"},firstSelector:{fontWeight:400,border:"none"},lastSelector:{fontWeight:400,border:"none"},introAnimationWrapper:{height:294,overflowY:"hidden",maskImage:"linear-gradient(to bottom, rgba(0, 0, 0,0) 24px, rgba(0, 0, 0) 50%, rgba(0,0,0,0) 265px"},introAnimationWrapperLeapStep:{height:140,marginTop:8},faceWrapper:{alignContent:"center",paddingLeft:2},faceWrapperLeapStep:{height:"100%",alignContent:"center",paddingLeft:2,paddingTop:40,paddingBottom:30},skillListWrapper:{display:"flex",flexDirection:"column",gap:8,marginLeft:24,overflowY:"hidden"},pillWrapper:{display:"flex",alignItems:"start",padding:"8px 16px 8px 12px",borderRadius:18,backgroundColor:t.tint.regular,color:t.text.primary,fontSize:14,flexWrap:"nowrap",fontWeight:p().Wy.medium,gap:8,width:"fit-content"},blue:{color:t.accentColors.uiBlue[500]},green:{color:t.accentColors.green[500]},purple:{color:t.accentColors.purple[500]}})),[e])}function q(e){const{label:t,icon:n,color:o}=e,i=Y(),a=o?i[o]:{},{value:r}=(0,k().fJ)(j().fM);if(!r)return null;const{motion:s}=r;return(0,E.jsxs)(s.div,{style:i.pillWrapper,children:[n({...i.icon,...a}),(0,E.jsx)(c().sA,{...t})]})}function Q(){const e=(0,s().DP)();return(0,o.useMemo)((()=>"dark"===e.mode?M():A()),[e])}function $(e){const t=Y(),{phase:n}=e,o="welcome"===n,i=Q(),{value:a}=(0,k().fJ)(j().fM);if(!a)return null;const{motion:r}=a;return(0,E.jsx)("div",{style:o?t.introAnimationWrapper:t.introAnimationWrapperLeapStep,children:(0,E.jsxs)(B().Y1,{gap:0,direction:"horizontal",height:"fill",align:o?"center":"center-left",children:[(0,E.jsx)(r.div,{layoutId:"face",style:t.faceWrapper,children:(0,E.jsx)("img",{style:t.faceImg,src:i,alt:"Notion AI logo"})}),(0,E.jsx)(r.div,{initial:{y:45},animate:{y:-45*(z.length-1)},transition:{repeat:1/0,duration:22,ease:"linear"},style:{...t.skillListWrapper,opacity:o?1:0},children:W.map(((e,t)=>(0,E.jsx)(q,{label:e.label,icon:e.icon,color:e.color},e.id+t)))})]})})}function Z(e){const{environment:t}=e,n=_().zD.getNavigationTargetForTryAssistantNowButton();switch(n){case"fullPage":h().oo({environment:t,url:"/chat"});break;case"corner":(0,x().openAssistantRightHandSideMenu)({environment:t,from:"assistant_intro_modal"});break;case"writer":f().f({environment:t,prefill:void 0});break;default:(0,u().HB)(n)}}function J(e){const{onDismiss:t}=e,n=(0,i().v3)(),[a,s]=(0,o.useState)("welcome"),l=(0,r().K8)((()=>{const e=P().default.state.currentSpaceStore,t=P().default.state.currentSpaceViewStore;return!(!e||!t)&&function(e){var t;const{environment:n,assistantFeatureGateStore:o,currentSpaceViewStore:i,currentSpaceStore:a}=e;return!(!i||!a)&&!!a.canAdmin()&&!(0,C().vp)(n,a.id)&&!Boolean(null===(t=i.getSettings())||void 0===t?void 0:t.has_user_seen_leap_modal)&&!Boolean(a.getSettings().enable_ai_training)&&o.isWorkspaceLeapEligible()}({environment:n,assistantFeatureGateStore:_().zD,currentSpaceStore:e,currentSpaceViewStore:t})}),[n]),d=(0,o.useCallback)((()=>{l?s("leap"):((0,b().trackAssistantIntroModalTryNow)(n,{}),t({source:"tryNow"}),Z({environment:n}))}),[l,n,t]),u=(0,o.useCallback)((()=>{if(t({source:"closeButton"}),l){const e=P().default.state.currentSpaceViewStore;if(!e)return;y().createAndCommit({userAction:"AiAssistantIntroModal.updateLeapModalSeen",environment:n,canUndo:!0,perform:t=>{y().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),has_user_seen_leap_modal:!0}},transaction:t})}})}}),[t,l,n]),p=(0,o.useCallback)((()=>{S().assistantAnalyticsActions.trackLeapDismissed(n),u()}),[n,u]);(0,o.useEffect)((()=>{const e=Date.now();return()=>{const t=Date.now();(0,b().trackAssistantIntroModalRead)(n,{reading_time:t-e})}}),[]);const m=Y(),g=(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($,{phase:"welcome"}),(0,E.jsx)("div",{style:m.title,children:(0,E.jsx)(c().sA,{...K.welcomeTitle})}),(0,E.jsx)("div",{style:m.subtitle,children:(0,E.jsx)(c().sA,{...K.subtitle})}),(0,E.jsxs)(B().Y1,{align:"center",direction:"horizontal",gap:"auto",style:m.footer,children:[(0,E.jsx)(te,{}),(0,E.jsx)(B().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,E.jsx)(D().A,{color:"black",size:"xl",onClick:d,children:(0,E.jsx)(c().sA,{defaultMessage:"Try it",id:"AssistantIntroMessage.intro.signup.nextMessage"})})})]})]});return(0,E.jsxs)("div",{children:[(0,E.jsx)(w().Rz,{onDismiss:u}),(0,E.jsx)(B().Y1,{gap:0,children:(0,E.jsx)("div",{style:m.contentWrapper,children:"leap"===a?(0,E.jsx)(X,{onDismiss:p}):g})})]})}function X(e){const{onDismiss:t}=e,[n,r]=(0,o.useState)(),l=void 0===n,d=(0,i().v3)(),p=(0,o.useCallback)((e=>{r(e),S().assistantAnalyticsActions.trackLeapPreferenceSelect(d,{will_share:e})}),[d]),m=(0,o.useCallback)((e=>{const t=P().default.state.currentSpaceStore;t&&y().createAndCommit({userAction:"AiAssistantIntroModal.updateWorkspaceShouldTrain",environment:d,canUndo:!0,perform:n=>{g().zv({store:t,data:{settings:{...t.getSettings(),enable_ai_training:e}},transaction:n})}})}),[d]),f=(0,o.useCallback)((()=>{(0,u().O9)(n)&&(m(n),S().assistantAnalyticsActions.trackLeapSubmit(d,{will_share:n})),t(),Z({environment:d})}),[d,t,n,m]);(0,a().l)((()=>{S().assistantAnalyticsActions.trackLeapPresented(d)}));const h=Y(),v=(0,s().IS)((()=>({...h,skip:{fontSize:14,padding:"0px 12px",height:36,display:"flex",alignItems:"center",cursor:l?"default":"pointer",opacity:l?.4:1},titleLeap:{marginBottom:12}})),[l,h]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($,{phase:"leap"}),(0,E.jsx)("div",{style:{...v.title,...v.titleLeap},children:(0,E.jsx)(c().sA,{...K.shareDataTitle})}),(0,E.jsx)(G,{}),(0,E.jsxs)(B().Y1,{direction:"vertical",children:[(0,E.jsx)(R().a,{style:v.firstSelector,label:(0,E.jsx)(c().sA,{defaultMessage:"Share data to help improve Notion AI",id:"AiAssistantWelcomeModal.admin.shareData"}),onChange:()=>{},isSelected:!0===n,onClick:()=>p(!0),value:"share_data",selectType:"radio"}),(0,E.jsx)(R().a,{style:v.lastSelector,label:(0,E.jsx)(c().sA,{defaultMessage:"Do not share data",id:"AiAssistantWelcomeModal.admin.doNotShareData"}),onChange:()=>{},selectType:"radio",isSelected:!1===n,onClick:()=>p(!1),value:"do_not_share_data"})]}),(0,E.jsxs)(B().Y1,{align:"center",direction:"horizontal",gap:"auto",style:v.footer,children:[(0,E.jsx)(ee,{}),(0,E.jsx)(B().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,E.jsx)(D().A,{color:"black",size:"xl",onClick:f,disabled:l,children:(0,E.jsx)(c().sA,{defaultMessage:"Confirm",id:"AssistantIntroMessage.intro.signup.confirmMessage"})})})]})]})}function ee(){const e=(0,s().DP)(),t=(0,i().v3)(),n=(0,o.useCallback)((e=>{S().assistantAnalyticsActions.trackLeapLinkClick(t,{link:e})}),[t]);return(0,E.jsx)("div",{style:{color:e.mediumTextColor,fontSize:12,width:256},children:(0,E.jsx)("div",{children:(0,E.jsx)(c().sA,{defaultMessage:"If you choose to share data, you are agreeing to these <terms>Terms</terms>. <learnmore>Learn more</learnmore>",id:"AiAssistantIntroModal.AdminAgreeToTerms",values:{terms:e=>(0,E.jsx)(N().A,{onClick:()=>n("terms"),external:!0,href:"https://www.notion.so/notion/Notion-AI-Learning-and-Early-Access-Program-Terms-0c55d702d0154a788d9e70c4ee396399",children:e}),learnmore:e=>(0,E.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"2px"},children:[(0,E.jsx)(N().A,{onClick:()=>n("faq"),external:!0,href:"https://www.notion.so/help/notion-ai-leap-program-faqs",children:e}),(0,l().X)({width:14,height:14})]})}})})})}function te(){const e=oe(),t=(0,i().v3)(),n=(0,o.useCallback)((()=>{(0,b().trackLearnMoreAboutAssistantClicked)(t,{})}),[t]);return(0,E.jsx)("div",{style:e.learnMoreCopy,children:(0,E.jsxs)(L().A,{onClick:n,style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://www.notion.so/help/guides/everything-you-can-do-with-notion-ai",external:!0,children:[(0,E.jsx)(c().sA,{defaultMessage:"Learn more",id:"AiAssistantIntroModal.LearnMoreAboutAssistantButton"}),(0,l().X)({width:14,height:14,marginTop:2,marginLeft:4})]})})}function ne(){const e=(0,o.useRef)(!1),t=(0,i().v3)();(0,r().K8)((()=>{const{currentUserSettingsStore:n}=P().default.state;if(!n||!n.isReady())return;if(!_().zD.showRemindersToUseQnA())return;const o=n.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,u().O9)(o)||e.current||(e.current=!0,(0,v().setLastExposedToQnaAtToCurrentTimestamp)(t,{userSettingsStore:n}))}),[t])}function oe(){return(0,s().IS)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.mediumTextColor},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:F,paddingRight:F},introTitle:{fontWeight:p().Wy.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:p().Wy.medium},sparklesIcon:{width:14},stubPng:{width:"100%",height:U},smallVariantVideoStubPng:{width:"100%",height:V}})),[])}},755170:(e,t,n)=>{n.d(t,{A:()=>y});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(284371),l=()=>n(859428),d=()=>n(115512),c=()=>n(962730),u=()=>n(665579),p=()=>n(534177),m=n(474848);const g=function(e){let{additionalStyles:t,transitionMs:o,force:i,children:a}=e;const s=(0,n(827912).j)(),l=(0,r().IS)((()=>{let e;switch(i){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=s?1:0;break;default:(0,p().HB)(i)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,p().O9)(o)?o:200}ms ease-in`,...t}}}),[t,i,s,o]);return(0,m.jsx)("div",{style:l.hoverStyle,children:a})};var f=()=>n(617941);function h(e){let{icon:t,title:n,tooltip:o,hasRightElement:a,iconContainerStyle:u}=e;const p=(0,i().v3)(),g=(0,r().IS)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,d().ny)(p,"UISmall"),fontWeight:s().Wy.medium,color:e.text.secondary,fill:e.mediumIconColor,flexShrink:0,maxWidth:a?200:"100%"},title:{...s().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:f().J,height:f().J,marginRight:8,marginTop:1,...u}})),[p,u,a]);return n?(0,m.jsx)(l().A,{renderTooltip:()=>o,disableTooltip:!o,placement:c().W.Top,alignment:c().C.Start,render:e=>(0,m.jsxs)("div",{style:g.panelTitleAndIcon,...e,children:[(0,m.jsx)("div",{style:g.panelIconContainer,children:t}),(0,m.jsx)("span",{style:g.title,children:n})]})}):null}const y=function(e){let{children:t,title:s,icon:l,tooltip:d,iconContainerStyle:c,panelStyle:p,headerStyle:f,rightStyle:y,actions:v,right:b,disableRightFadeIn:x,disableActionsFadeIn:S,hideWrapStyle:M,actionsGap:A}=e;const C=(0,i().WS)(),w=Boolean(s),j=Boolean(b),k=(0,a().uB)(void 0,n(620090).B),I=(0,a().uB)(void 0,n(1248)._),T=(0,o.useMemo)((()=>({isHoveredOnPanelStore:k,sizeStore:I})),[k,I]),P=(0,o.useCallback)((()=>k.setState(!0)),[k]),_=(0,o.useCallback)((()=>k.setState(!1)),[k]),B=(0,o.useCallback)((e=>{e.width<u().Xy?I.setState("narrow"):I.setState("wide")}),[I]),L=(0,r().IS)((e=>({tile:{userSelect:"none",WebkitUserSelect:"none"},panel:M?{}:{paddingLeft:12,paddingRight:12,...(0,u().V$)({isPhone:C,theme:e}),...p},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:n(69447).nh,marginLeft:u().Fq,...f},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:A??6,paddingLeft:6}})),[C,M,p,f,A]),R=(w||j)&&(0,m.jsxs)("div",{style:L.headerContainer,children:[(0,m.jsx)(h,{title:s,icon:l,tooltip:d,hasRightElement:j,iconContainerStyle:c}),(j||v)&&(0,m.jsxs)("div",{style:L.rightActions,children:[j&&(0,m.jsx)(g,{force:x?"forceShow":void 0,additionalStyles:y,children:b}),v&&(0,m.jsx)(g,{force:S?"forceShow":void 0,additionalStyles:L.actions,children:v})]})]});return(0,m.jsx)(n(273923).R.Provider,{value:T,children:(0,m.jsxs)("div",{style:L.tile,onMouseEnter:P,onMouseLeave:_,children:[R,(0,m.jsx)(n(828634).EE,{onSizeChange:B,children:(0,m.jsx)("div",{style:L.panel,children:t})})]})})}},756710:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(854150),r=()=>n(959013),s=()=>n(496603),l=()=>n(534177),d=()=>n(356985),c=()=>n(89924),u=n(474848);const p=[{key:"block in comment menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[n(254452).z,d().b2,d().qI]}];var m=()=>n(364811),g=()=>n(599364);const f=[{key:"page mention context menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[...n(668491).YO,g().oc,g().ko]}];var h=()=>n(741496),y=()=>n(901265),v=()=>n(186445),b=()=>n(476492),x=()=>n(722872),S=()=>n(836251),M=()=>n(494043),A=()=>n(857437),C=()=>n(691298),w=()=>n(696746),j=(n(581454),()=>n(933152)),k=()=>n(764781),I=()=>n(236262),T=()=>n(637433),P=()=>n(100622),_=()=>n(416726),B=()=>n(896628),L=()=>n(317909),R=()=>n(878377),D=()=>n(972435),O=()=>n(919878);const N=(0,r().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),E=(0,_().fi)({key:"simple table header column",displayName:N.simpleTableHeaderColumn,label:D().A.formatMessage(N.simpleTableHeaderColumn),svg:n(696575).X,validators:[R().p2L,R().AU6(R().wFE),R().xCr,R().z5D],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>B().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),F=(0,_().fi)({key:"simple table header row",displayName:N.simpleTableHeaderRow,label:D().A.formatMessage(N.simpleTableHeaderRow),svg:n(464291).p,validators:[R().p2L,R().AU6(R().wFE),R().nRE],isEnabled:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const o=t.getParentBlockStore();null!=o&&o.isType("table")&&B().zA({stores:[o],update:{table_block_column_header:!o.getFormat().table_block_column_header},transaction:n})}}),U=(0,_().Ls)({key:"insert column left",displayName:N.simpleTableInsertColumnLeft,analyticsName:N.simpleTableInsertColumnLeft.defaultMessage,svg:n(526278).w,validators:[R().p2L,R().AU6(R().vEP),R().xCr,R().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,canUndo:!0,perform:e=>{O().T4({environment:t,transaction:e})}})}}),V=(0,_().Ls)({key:"insert column right",displayName:N.simpleTableInsertColumnRight,analyticsName:N.simpleTableInsertColumnRight.defaultMessage,svg:n(940563).P,validators:[R().p2L,R().AU6(R().vEP),R().xCr,R().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,canUndo:!0,perform:e=>{O().sf({environment:t,transaction:e})}})}}),K=(0,_().Fw)({key:"duplicate columns",displayName:_().AY.duplicateName,analyticsName:_().AY.duplicateName.defaultMessage,svg:k().V,validators:[R().p2L,R().AU6(R().vEP),R().xCr,R().Pqm],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,canUndo:!0,perform:e=>{O().V0({transaction:e})}})}}),z=(0,_().Fw)({key:"delete columns",displayName:_().AY.deleteName,analyticsName:_().AY.deleteName.defaultMessage,svg:I().I,validators:[R().p2L,R().AU6(R().vEP),R().xCr,R().Jt9,R().Pqm],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,canUndo:!0,perform:e=>{O().LL({environment:t,transaction:e})}})}}),W=(0,_().Ls)({key:"clear column contents",displayName:N.simpleTableClearContents,analyticsName:N.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[R().p2L,R().AU6(R().vEP),R().xCr,R().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),H=(0,_().Ls)({key:"insert row above",displayName:N.simpleTableInsertRowAbove,analyticsName:N.simpleTableInsertRowAbove.defaultMessage,svg:n(112282).s,validators:[R().p2L,R().AU6(R().vEP),R().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,canUndo:!0,perform:e=>{O().pW({environment:t,transaction:e})}})}}),G=(0,_().Ls)({key:"insert row below",displayName:N.simpleTableInsertRowBelow,analyticsName:N.simpleTableInsertRowBelow.defaultMessage,svg:n(655923).v,validators:[R().p2L,R().AU6(R().vEP),R().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,canUndo:!0,perform:e=>{O().pc({environment:t,transaction:e})}})}}),Y=(0,_().Fw)({key:"duplicate rows",displayName:_().AY.duplicateName,analyticsName:_().AY.duplicateName.defaultMessage,svg:k().V,validators:[R().p2L,R().AU6(R().vEP),R().Hcy],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,canUndo:!0,perform:e=>{O().n2({environment:t,transaction:e})}})}}),q=(0,_().Fw)({key:"delete rows",displayName:_().AY.deleteName,analyticsName:_().AY.deleteName.defaultMessage,svg:I().I,validators:[R().p2L,R().AU6(R().vEP),R().ZLr,R().Hcy],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,canUndo:!0,perform:e=>{O().pf({environment:t,transaction:e})}})}}),Q=(0,_().Ls)({key:"clear row contents",displayName:N.simpleTableClearContents,analyticsName:N.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[R().p2L,R().AU6(R().vEP),R().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),$=[R().p2L,R().AU6(R().vEP),R().xCr,R().Pqm],Z=[R().p2L,R().AU6(R().vEP),R().Hcy];function J(e,t,o,i){const a=i||(0,n(27178).qo)(e),r=(0,_().Ls)({key:`color ${o||e}`,displayName:a,analyticsName:a.defaultMessage,fuzzySearchKeywords:(0,_().Mf)(e),validators:"column"===t?$:Z,action:t=>{let{blocks:n,environment:o}=t;L().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:o,canUndo:!0,perform:t=>{O().wW(o,e,t)}})},closeParentMenu:!0,render:t=>(0,u.jsx)(n(491073).Ay,{...t,color:e,overrideDisplayName:r.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,_().Kg)(n,e,o)}});return r}const X=(0,_().gy)({key:"simple table column background color actions",title:_().AY.backgroundSection,overrideSearchTitle:_().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[...P().AQ.map((e=>J(e,"column")))]}),ee=(0,_().gy)({key:"simple table column text color actions",title:_().AY.colorSection,overrideSearchTitle:_().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[...P().N.map((e=>J(e,"column")))]}),te=(0,_().gy)({key:"simple table row background color actions",title:_().AY.backgroundSection,overrideSearchTitle:_().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[...P().AQ.map((e=>J(e,"row")))]}),ne=(0,_().gy)({key:"simple table row text color actions",title:_().AY.colorSection,overrideSearchTitle:_().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[...P().N.map((e=>J(e,"row")))]}),oe=(0,_().uk)({key:"set column color",displayName:_().AY.colorName,analyticsName:_().AY.colorName.defaultMessage,svg:j().M,validators:$,subActions:()=>[{key:0,title:D().A.formatMessage(N.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ee.actions},{key:1,title:D().A.formatMessage(N.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:X.actions}]}),ie=(0,_().uk)({key:"set row color",displayName:_().AY.colorName,analyticsName:_().AY.colorName.defaultMessage,svg:j().M,validators:Z,subActions:()=>[{key:0,title:D().A.formatMessage(N.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ne.actions},{key:1,title:D().A.formatMessage(N.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:te.actions}]}),ae=[(0,_().gy)({key:"column section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[E,oe,U,V,K,W,z]}),(0,_().gy)({key:"row section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[F,ie,H,G,Y,Q,q]})];var re=()=>n(962730),se=()=>n(377586),le=()=>n(351360),de=()=>n(407054),ce=()=>n(630116),ue=()=>n(502438),pe=()=>n(704907),me=()=>n(819493),ge=()=>n(452558),fe=()=>n(419357),he=()=>n(545805),ye=()=>n(928600),ve=()=>n(45552),be=()=>n(14235),xe=()=>n(962036);function Se(){const e=(0,o().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,u.jsx)(Me,{}):(0,u.jsx)(Ae,{})}function Me(){const e=(0,i().O$)(de().A);return(0,C().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,u.jsx)(Ae,{})}function Ae(){const e=(0,o().Y0)(),t=(0,i().O$)(de().A);return(0,u.jsx)(be().Ay,{popupType:e.isPhone?se().n.BottomSheet:se().n.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ie,placementToOrigin:re().W.Bottom,alignmentToOrigin:re().C.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,u.jsx)(Ce,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function Ce(){var e;const t=(0,o().v3)(),n=(0,o().WS)(),c=(0,x().Tf)(),g=(0,i().O$)(de().A),v=null===(e=g.stores)||void 0===e?void 0:e[0],S=(0,i().K8)((()=>null==v?void 0:v.isCollectionView()),[v]),C=(0,i().K8)((()=>g.isActive?function(e){switch(e){case"default":return d().JS;case"simple_table":return ae;case"page_mention":return f;case"sidebar_outliner":return m().LV;case"comment_media":return p;case"block_in_collection_timeline_view":return d().bH;case"block_in_collection":return d().SH;default:(0,l().HB)(e)}}(null==g?void 0:g.actionSectionGroupKey):[]),[g]),[w,j]=(0,A().$)();if(!g.isActive||!v)return null;const{originBlockRect:k,inputValue:I,publicEditMode:T}=g||{},P={environment:t,blocks:g.stores,originRect:k,publicEditMode:T,analyticsFrom:g.analyticsFrom},_=g.showInput&&(0,u.jsx)(ke,{inputComboboxProps:w}),B=n?{menuType:x().gu.Modal,title:(0,u.jsx)(r().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:c?void 0:(0,u.jsx)(ve().DoneMenuText,{}),onClickRight:c?void 0:Ie,header:_}:{menuType:x().gu.Popup,width:265,header:_};return(0,u.jsx)(he().A,{debugName:"BlockMenu",capture:!0,onBackspace:s().D_,children:(0,u.jsxs)(ye().A,{...B,children:[(0,u.jsx)(ge().A,{filter:I,context:P,sections:C,onAccept:e=>function(e,t){const n=de().A.state;if(!n.isActive)return;const{stores:o}=ue().default.state,{analyticsFrom:i,collectionContextStore:r}=n,s=o[0];if(s){const n=s.getParentTable(),o=s.getType();if(o&&n){let l;if(n===a().yK){const e=s.getParentId(),{currentSpaceStore:t}=le().default.getState();t&&void 0!==e&&(l=ce().h4.createChildStore(t,{table:a().yK,id:e}))}const d=(0,b().sl)(r)||{};(0,h().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:s.id,block_type:o,parentTeamStore:l,is_toggleable:(0,M().Yt)(o,s.getFormat()),parent_collection_id:s.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&y().VN()}(e,t),initialFocus:I?0:void 0,comboboxProps:g.showInput?j:void 0}),!I&&(0,u.jsx)(je,{}),!I&&(0,u.jsx)(pe().A,{store:v}),!I&&S&&(0,u.jsx)(we,{})]})})}function we(){const[e,t]=(0,i().K8)((()=>{const e=de().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,v().sj)(t.id)]}),[]);return e?t?(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(r().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:w().hI,analyticsFrom:"block_menu"})}):(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(r().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,S().xS)("guides.database"),analyticsFrom:"block_menu"})}):null}function je(){const e=(0,o().v3)(),t=(0,i().O$)(de().A),n=(0,i().K8)((()=>e.currentUser.isLoggedIn()),[e]),a=(0,i().K8)((()=>t.isActive&&1===t.stores.length&&(0,v().sj)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||a?null:(0,u.jsx)(me().$,{store:t.stores[0],isPageMoreButton:!1}):null}function ke(e){const t=(0,r().tz)(),n=(0,o().WS)(),a=(0,i().O$)(de().A);if(!a.isActive||n)return null;const{inputValue:s}=a;return(0,u.jsx)(c().A,{isInput:!0,children:(0,u.jsx)(fe().Ay,{value:s,onChange:Te,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,...e.inputComboboxProps})})}function Ie(){y().VN()}function Te(e){de().A.state.isActive&&de().A.setState({...de().A.state,inputValue:e.target.value})}},764180:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>Xt});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(381138),l=()=>n(959013),d=()=>n(284371),c=(n(16280),n(18107),n(967357),n(898992),n(672577),n(581454),n(737550),()=>n(662303)),u=()=>n(584262),p=()=>n(700500),m=()=>n(857639),g=()=>n(112665),f=()=>n(104077),h=()=>n(274570),y=()=>n(340498),v=n(474848);const b=(0,y().wt)("fontStyleMono",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M6.817 12 6.08 9.513H3.017L2.28 12H1.192l2.675-8.725h1.388L7.93 12zM4.605 4.388h-.113L3.267 8.6H5.83zm10.008 7.399q0 1.338-.75 2.1-.75.763-2.088.763-1.45 0-2.313-.888l.588-.687q.676.7 1.737.7 1.825 0 1.825-1.925v-1.075h-.05q-.625 1.2-1.987 1.2-1.175 0-1.85-.875-.675-.888-.675-2.412t.675-2.4q.675-.888 1.85-.888 1.361 0 1.988 1.2h.05V5.55h1zm-2.65-.7q.7 0 1.175-.35t.475-.974v-2.15q0-.626-.476-.975-.474-.35-1.175-.35-.862 0-1.35.525-.487.524-.487 1.412v.925q0 .888.488 1.412.487.526 1.35.526Z"})})}),x=(0,y().wt)("fontStyleSans",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"m.76 12 3.248-8.807h.842v1.422h-.348L1.914 12H.761Zm1.472-2.52.341-.935h3.98l.342.934H2.232ZM7.188 12 4.6 4.615V3.193h.494L8.341 12zm4.557 2.32q-.793 0-1.385-.226a2.26 2.26 0 0 1-.947-.63 1.86 1.86 0 0 1-.433-.94l.012-.005h1.099l.006.006q.085.373.513.61.427.244 1.135.244.885 0 1.38-.402.5-.398.5-1.123v-1.331h-.098a2.24 2.24 0 0 1-1.22 1.007q-.39.128-.843.128-.848 0-1.47-.403a2.7 2.7 0 0 1-.953-1.123q-.336-.714-.336-1.635v-.013q0-.922.336-1.635.342-.72.964-1.13.623-.415 1.484-.415.464 0 .854.147t.69.415q.305.269.506.64h.074V5.42h1.062v6.488q0 .733-.36 1.276a2.27 2.27 0 0 1-1.014.836q-.66.3-1.556.3m-.049-3.602q.61 0 1.044-.28.44-.288.671-.788.238-.5.238-1.153v-.013q0-.653-.238-1.16a1.84 1.84 0 0 0-.671-.793q-.434-.287-1.044-.287t-1.037.287a1.83 1.83 0 0 0-.647.794 2.9 2.9 0 0 0-.22 1.16v.012q0 .653.22 1.153.225.5.646.787.428.282 1.038.281"})})}),S=(0,y().wt)("fontStyleSerif",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.29 12v-.416l.753-.299 3.16-7.982.441-.065.455-.13 2.99 8.177.884.286V12h-3.34v-.429l1.104-.299-.793-2.275H2.772l-.754 2.119 1.248.455V12zm4.08-7.462L3.058 8.217h2.613L4.384 4.538h-.013Zm10.764 2.106-1.482-.078-.013.039c.325.273.663.754.663 1.443 0 1.417-1.287 2.327-2.587 2.327q-.488 0-.936-.156c-.3.234-.455.455-.455.65 0 .182.182.429.48.442l2.458.143c1.287.078 1.859.65 1.859 1.456 0 1.079-1.391 2.405-3.81 2.405-1.234 0-2.352-.52-2.352-1.469 0-.481.325-1.027.949-1.365l.312-.169v-.026l-.923-.884c.26-.663.546-.988 1.027-1.391C9.726 9.647 9.297 9.01 9.297 8.1c0-1.417 1.105-2.379 2.496-2.379.598 0 1.014.143 1.534.325l1.807-.195zM11.87 9.816c.689 0 1.248-.611 1.248-1.599 0-1.391-.624-1.989-1.404-1.989-.767 0-1.222.572-1.222 1.56 0 1.274.533 2.028 1.378 2.028m1.274 2.691-2.457-.156c-.195.208-.56.689-.56 1.157 0 .481.43 1.157 1.795 1.157 1.599 0 2.262-.767 2.262-1.365 0-.455-.3-.741-1.04-.793"})})});var M=()=>n(426388),A=()=>n(735790),C=()=>n(11356);const w={viewBox:"0 0 20 20",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("g",{clipPath:"url(#clip0_9208_17166)",children:(0,v.jsx)("path",{d:"M8.125 14.75c0-.345.28-.625.625-.625h10.1a.625.625 0 1 1 0 1.25H8.75a.625.625 0 0 1-.625-.625M7 9.375a.625.625 0 1 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zm-1.75-4.75a.625.625 0 1 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zM2.9 9.375a.625.625 0 1 0 0 1.25h1.5a.625.625 0 1 0 0-1.25zM.525 5.25c0-.345.28-.625.625-.625h1.5a.625.625 0 0 1 0 1.25h-1.5a.625.625 0 0 1-.625-.625m4.125 8.875a.625.625 0 1 0 0 1.25h1.5a.625.625 0 1 0 0-1.25z"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_9208_17166",children:(0,v.jsx)("path",{d:"M20 0v20H0V0z"})})})]})},j=(0,y().wt)("tableOfContents",w),k={viewBox:"0 0 20 20",svg:(0,v.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},I=(0,y().wt)("textSmall",k),T=(0,y().wt)("textStyleIcon",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.74 13.097c-.355 0-.574-.212-.574-.554 0-.116.02-.226.075-.37l3.206-8.55q.226-.625.862-.623c.437 0 .717.212.875.629l3.206 8.538a1 1 0 0 1 .075.37c0 .34-.233.56-.595.56-.355 0-.533-.137-.663-.52l-.882-2.413H2.292l-.882 2.413c-.13.383-.307.52-.67.52m1.887-3.972h3.356l-1.66-4.6h-.035zm9.604 4.02c-1.449 0-2.454-.875-2.454-2.181 0-1.272.964-2.071 2.694-2.167l2.208-.123v-.588c0-.957-.636-1.552-1.702-1.552-.89 0-1.47.37-1.853 1.162-.103.192-.267.274-.479.274-.293 0-.519-.199-.519-.5 0-.143.055-.307.13-.478.39-.882 1.463-1.449 2.748-1.449 1.736 0 2.83.964 2.83 2.454v4.56c0 .369-.232.594-.56.594-.322 0-.554-.225-.554-.567v-.902h-.028c-.423.888-1.408 1.463-2.46 1.463Zm.28-.95c1.204 0 2.168-.855 2.168-1.942v-.725l-2.065.13c-1.073.069-1.654.554-1.654 1.279 0 .752.629 1.257 1.552 1.257Z"})})});var P=()=>n(931075),_=()=>n(100622),B=()=>n(496603),L=()=>n(473227),R=()=>n(896628),D=()=>n(696384),O=()=>n(44729),N=()=>n(246826),E=()=>n(857783),F=()=>n(435009),U=()=>n(317909),V=()=>n(519839),K=()=>n(575143),z=()=>n(147294),W=()=>n(89924),H=()=>n(553965),G=()=>n(962730),Y=()=>n(704152),q=()=>n(939740),Q=()=>n(859428),$=()=>n(125565);function Z(e,t){return e.isFiltering?function(e){return(0,v.jsx)(K().A,{...e,title:e.caption,caption:void 0})}(e):function(e,t){let{id:n,caption:a,focused:s,isActive:l,onClick:d,onMouseDown:c,onMouseEnter:u,onMouseLeave:p,role:m,style:g,tooltip:f,ignoreLocalHoverState:h,disallowTabbing:y}=e;const b=(0,i().Y0)(),{isMenuListFocusVisible:x}=(0,o.useContext)(q().VU),S=(0,r().IS)((e=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...b.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:l?_().Ay.blue:"inherit",...s&&x&&{boxShadow:e.outlineBlueInputBoxShadow}}})),[l,b,x,s]);return(0,v.jsx)(Q().A,{renderTooltip:()=>f,placement:G().W.Bottom,delayThreshold:80,render:e=>{const o=(0,H().A)(e,{onMouseEnter:u,onMouseLeave:p}),{onMouseDown:i,...r}=o;return(0,v.jsx)(Y().A,{...r,id:n,role:m,ref:t,mobileFeedback:b.isMobile,onClick:d,onMouseDown:o.onMouseDown||c,hovered:s,style:S.button,ignoreLocalHoverState:h,disallowTabbing:y,className:"notranslate",children:(0,v.jsxs)("div",{style:S.optionItem,children:[(0,v.jsx)("div",{style:{...g,height:25},children:"Ag"}),(0,v.jsx)($().A,{isSmall:!0,style:{marginTop:4},children:a})]})})}})}(e,t)}const J=o.forwardRef(Z);const X=function(e){const{children:t}=e,n=(0,i().v3)(),{mobileStyle:o,desktopStyle:a}=(0,r().IS)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,v.jsx)(W().A,{...e,children:(0,v.jsx)("div",{style:n.device.isMobile?o:a,children:t})})};var ee=()=>n(53528),te=()=>n(534177),ne=()=>n(470928);function oe(e){const{intl:t,blockStore:n}=e,o=(0,ne().i1)(n);if("none"!==o.type){if("expired"===o.type)return t.formatMessage(ie.expiredVerification);if("verified"===o.type){if(o.isIndefinite)return t.formatMessage(ie.indefiniteVerification);{const e=o.dateTimeRange.end,n=(0,ee().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(ie.verificationWithEndDate,{date:n})}}(0,te().HB)(o)}}const ie=(0,l().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var ae=()=>n(546692),re=()=>n(877235),se=()=>n(416726),le=()=>n(910302),de=()=>n(5580),ce=()=>n(514799),ue=()=>n(722872),pe=()=>n(430483),me=()=>n(227440),ge=()=>n(77246),fe=()=>n(928600),he=()=>n(45552),ye=()=>n(662971),ve=()=>n(391435);function be(e){const{blockStore:t,menuListItemProps:n,title:s,onFocus:d,closeParentMenu:c}=e,u=(0,i().v3)(),p=(0,r().DP)(),m=(0,ue().Tf)(),g=(0,a().K8)((()=>pe().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:f}=(0,ce().H)({pageStore:t,enabled:g}),h=(0,de().n)(),[y,b]=(0,o.useState)(void 0),x=y??f??h,{isTranslating:S,editorModeConfigTranslateState:M}=(0,a().K8)((()=>{const e=ge().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:x}}}),[t,x]),A=(0,a().K8)((()=>!me().A.state.online),[]),C=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;b(t)}),[]),w=(0,o.useCallback)((e=>{const{targetLanguage:n}=e;le().Z9({pageStore:t,environment:u}),le().Ww({pageStore:t,targetLanguage:n,sourceLanguage:x,environment:u,triggeredFrom:"action_menu"}),c()}),[t,x,u,c]),j=(0,a().K8)((()=>(0,se().cz)(p,S)),[S,p]);return"pre_activation"!==M.status||A?(0,v.jsx)(K().A,{...n,title:s,badge:(0,v.jsx)(z().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1}),svg:re().H,right:j,onClick:()=>{le().DL({pageStore:t,environment:u,triggeredFrom:"action_menu"}),c()},disabled:A,disabledFeedback:A,tooltipText:A?(0,v.jsx)(l().sA,{...se().AY.unavailableOfflineTooltip}):void 0}):(0,v.jsx)(ye().A,{...n,disableDefaultClick:!0,onFocus:d,focused:n.focused,disableCloseOnEnter:!0,renderExtension:(e,n)=>{const o=u.device.isMobile?{menuType:ue().gu.Modal,right:m?void 0:(0,v.jsx)(he().DoneMenuText,{}),left:m?(0,v.jsx)(he().MobileModalBackButton,{}):void 0,onClickRight:m?void 0:n.close,onClickLeft:m?n.close:void 0,shouldRenderMobileRefresh:m,paddingTop:m?10:void 0,title:s,...e}:{menuType:ue().gu.Popup,height:480,...e};return(0,v.jsx)(fe().A,{...o,onClick:e=>{e.stopPropagation()},children:(0,v.jsx)(ve().Z,{onSelectTargetLanguage:w,onSelectSourceLanguage:C,editorModeConfigTranslateState:M,sourceLanguage:x,detectedPageLanguage:f,preferredLanguage:h,subMenuPlacement:G().W.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,v.jsx)(K().A,{...e,ref:t,title:s,badge:(0,v.jsx)(z().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1}),svg:re().H,right:j})})}var xe=()=>n(126818),Se=()=>n(313784),Me=()=>n(644161),Ae=()=>n(68263),Ce=()=>n(185544),we=()=>n(780054),je=()=>n(71584),ke=()=>n(34542),Ie=()=>n(989423),Te=()=>n(972435),Pe=()=>n(976721),_e=()=>n(928074),Be=()=>n(525700),Le=()=>n(351360),Re=()=>n(508496),De=()=>n(406859),Oe=()=>n(436572),Ne=()=>n(812182);const Ee="template_translation_toast",Fe="Template size too large";async function Ue(e){const{environment:t,pageStore:n,targetLanguage:o,sourceLanguage:i}=e,{currentSpaceStore:a}=Le().default.state;if(!Re().default.checkGate({gateName:"translate_template_top_bar"}))throw new Error("Translate template is not enabled");if(!o||!i||null==a||!a.id)return;const r=Te().A.getIntl(),s=await(0,ke().oC)(t,n.id),l=null==s?void 0:s.name,d=performance.now();!function(e){const{intl:t,toastProps:n={},isMobile:o=!1}=e;if(o)return void Oe().D6({label:t.formatMessage({id:"inApp.template.translation.started.toast.mobile.message",defaultMessage:"Template is being translated. We will let you know when it's ready to use."}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}});Ne().HK({id:Ee,title:t.formatMessage({id:"inApp.template.translation.started.toast.title",defaultMessage:"Template is being translated"}),message:t.formatMessage({id:"inApp.template.translation.started.toast.message",defaultMessage:"We will let you know when it's ready to access"}),presentationType:"transient",icon:Se().S,...n})}({intl:r});const c=De().M.getStateForBlock(n.id),p=await new Promise((e=>{U().createAndCommit({userAction:"translateTemplateActions.translateTemplateBlock",environment:t,canUndo:!0,perform:s=>{const d=n.getParentStore();if(!d)throw new Error("Cannot duplicate with no parent store found");const p=s.getUserActionForAnalyticsPurposesOnly();m().log({level:"info",from:"translateTemplateActions",type:"translateTemplateBlockStart",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i}}}),(0,Ie().u4)({environment:t,event:{eventName:"translate_template_block",eventProperties:{duplicate_to:"parent",page_id:n.id,source_language:i,target_language:o,triggered_from:"topbar_more_action"}}}),De().M.setStateForBlock(n.id,{...c,mode:"translate",status:"loading",sourceLanguage:i,targetLanguage:o});const[g,f]=je().duplicateBlock({environment:t,stores:[n],addCopyName:!1,transaction:s,deepCopyTransclusionContainers:!0,targetSpaceId:null==a?void 0:a.id,resolveTemplateVariables:!n.isInsideTemplate(),baseUrl:we().A.domainBaseUrl,publicDomainName:we().A.publicDomainName,preferDuplicateLocation:"server",shouldTranslate:!0,targetLanguage:o,sourceLanguage:i}),h=g[0];return"block"===d.table?O().NI({parentStore:d,childStore:h,transaction:s,after:n.id}):"space"===d.table&&Le().default.state.currentSpaceViewStore&&Ce().yM({environment:t,spaceStore:a,spaceViewStore:Le().default.state.currentSpaceViewStore,pageStore:h,isPrivate:!0,location:{type:"append",after:n.id},transaction:s}),f.then((a=>{var s,d;"error"===a.status?(Ve({intl:r,templateName:l,blockLimitError:null===(s=a.error)||void 0===s?void 0:s.message.includes(Fe)}),De().M.clearStateForBlock(n.id),m().log({level:"error",from:"translateTemplateActions",type:"translateTemplateBlockError",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i,errorMessage:null===(d=a.error)||void 0===d?void 0:d.message}}}),e({success:!1,userAction:p})):(!function(e){const{sourceLanguage:t,targetLanguage:n,intl:o,environment:i,blockStores:a,toastProps:r={},isMobile:s=!1,templateName:l}=e,d=o.formatMessage((0,Me().Bj)(t)),c=o.formatMessage((0,Me().Bj)(n));if(s)return Oe().N2(),void Oe().AC({blockToOpenStore:a[0],onOpenBlock:()=>{E().uK({environment:i,store:a[0],pageVisitSource:u().y8.Duplicate})},item:{label:o.formatMessage({id:"inApp.template.translation.finished.toast.mobile.message",defaultMessage:"Template is ready"}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}}});Ne().HK({id:Ee,title:o.formatMessage({id:"inApp.template.translation.finished.toast.title",defaultMessage:"Template is ready"}),message:d&&c&&l?o.formatMessage({id:"inApp.template.translation.finished.toast.templateName.message",defaultMessage:"''{templateName}'' has been translated from {sourceLanguage} to {targetLanguage}. View your template to continue editing."},{sourceLanguage:d,targetLanguage:c,templateName:l}):o.formatMessage({id:"inApp.template.translation.finished.toast.message",defaultMessage:"Template has been added to your workspace"}),presentationType:"persistent",iconGroup:xe().g,iconGroupColorName:"greenPrimary",iconGroupVariant:"default",actions:{primary:{title:o.formatMessage({id:"inApp.template.translation.finished.toast.seeTemplate.button",defaultMessage:"See template"}),onAction:()=>{E().uK({environment:i,store:a[0],pageVisitSource:u().y8.Duplicate}),Ne().UW(Ee)}}},...r})}({environment:t,blockStores:g,sourceLanguage:i,targetLanguage:o,intl:r,templateName:l}),De().M.clearStateForBlock(n.id),m().log({level:"info",from:"translateTemplateActions",type:"translateTemplateBlockSuccess",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i}}}),e({success:!0,duplicateStore:h,userAction:p}))})).catch((t=>{Ve({intl:r,templateName:l}),De().M.clearStateForBlock(n.id),m().log({level:"error",from:"translateTemplateActions",type:"translateTemplateBlockError",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i,error:t}}}),e({success:!1,userAction:p})})),{duplicateStore:h,onComplete:f}}})}));if(p.success&&p.duplicateStore){var g;Ke({environment:t,success:!0,time:performance.now()-d,user_action:p.userAction,page_block_id:p.duplicateStore.id,source_language:i,target_language:o});const e=_e().dR({store:p.duplicateStore,environment:t}).mostPermissivePublicItem,{permissionItem:n,from:a}=e,r=(0,Ae().Yi)(a),s=!(null===(g=Le().default.state.currentSpaceStore)||void 0===g?void 0:g.getDisableMoveToSpace())&&n.allow_duplicate;Be().d8({environment:t,type:"site",store:p.duplicateStore}),await(0,Pe().Hc)({oldPermissionItem:n,newPermissionItem:{...n,role:"reader",allow_duplicate:s},wasInherited:r!==p.duplicateStore.id,environment:t,store:p.duplicateStore,sudoModeStore:void 0})}else!1===p.success&&Ke({environment:t,success:!1,time:performance.now()-d,user_action:p.userAction})}function Ve(e){const{intl:t,toastProps:n={},isMobile:o=!1,templateName:i,blockLimitError:a}=e;o?Oe().D6({label:t.formatMessage({id:"inApp.template.translation.error.toast.mobile.message",defaultMessage:"Template translation failed. Please try again."}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}}):Ne().HK({id:Ee,title:t.formatMessage({id:"inApp.template.translation.error.toast.title",defaultMessage:"Template translation failed"}),message:i?a?t.formatMessage({id:"inApp.template.translation.blockLimitError.toast.templateName.message",defaultMessage:"Unable to translate ''{templateName}'' – template size exceeds limit"},{templateName:i}):t.formatMessage({id:"inApp.template.translation.error.toast.templateName.message",defaultMessage:"Unable to translate ''{templateName}''. Please try again."},{templateName:i}):t.formatMessage({id:"inApp.template.translation.error.toast.message",defaultMessage:"Please try again."}),presentationType:"transient",icon:Se().S,...n})}function Ke(e){(0,Ie().u4)({environment:e.environment,event:{eventName:"translate_template_duration",eventProperties:{time:e.time,success:e.success,user_action:e.user_action,total_blocks:e.total_blocks,page_block_id:e.page_block_id,source_language:e.source_language,target_language:e.target_language}}})}function ze(e){const{blockStore:t,menuListItemProps:r,title:s,onFocus:l,closeParentMenu:d}=e,c=(0,i().v3)(),u=(0,ue().Tf)(),p=(0,n(963589).X)("translate_template_top_bar"),{detectedLanguage:m}=(0,ce().H)({pageStore:t,enabled:p}),g=(0,de().n)(),[f,h]=(0,o.useState)(void 0),y=f??m??g,{translateState:b}=(0,a().K8)((()=>{const e=De().M.getStateForBlock(t.id);return"translate"===(null==e?void 0:e.mode)?{isTranslating:!0,translateState:e}:{isTranslating:!1,translateState:{mode:"translate",status:"pre_activation",sourceLanguage:y}}}),[t,y]),x=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;h(t)}),[]),S=(0,o.useCallback)((async e=>{const{targetLanguage:n}=e;await Ue({pageStore:t,targetLanguage:n,sourceLanguage:y,environment:c}),d()}),[t,y,c,d]);return(0,v.jsx)(ye().A,{...r,disableDefaultClick:!0,onFocus:l,focused:r.focused,disableCloseOnEnter:!0,renderExtension:(e,n)=>{const o=c.device.isMobile?{menuType:ue().gu.Modal,right:u?void 0:(0,v.jsx)(he().DoneMenuText,{}),left:u?(0,v.jsx)(he().MobileModalBackButton,{}):void 0,onClickRight:u?void 0:n.close,onClickLeft:u?n.close:void 0,shouldRenderMobileRefresh:u,paddingTop:u?10:void 0,title:s,...e}:{menuType:ue().gu.Popup,...e};return(0,v.jsx)(fe().A,{...o,onClick:e=>{e.stopPropagation()},children:(0,v.jsx)(ve().Z,{onSelectTargetLanguage:S,onSelectSourceLanguage:x,editorModeConfigTranslateState:b,sourceLanguage:y,detectedPageLanguage:m,preferredLanguage:g,subMenuPlacement:G().W.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,v.jsx)(K().A,{...e,ref:t,title:s,badge:void 0,svg:n(841224).Q})})}var We=()=>n(878377),He=()=>n(597755),Ge=()=>n(492414),Ye=()=>n(538075),qe=()=>n(178998),Qe=()=>n(869562),$e=()=>n(737230),Ze=()=>n(404141),Je=()=>n(795179),Xe=()=>n(763884);const et=(0,l().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),tt=(0,se().fi)({key:"ai_co_editing",displayName:et.aiCoEditingName,label:Te().A.formatMessage(et.aiCoEditingName),svg:n(824375).X,isEnabled:e=>Xe().A.get({userId:e.environment.currentUser.id,key:"ai_co_editing_always_on"}),validators:[We().AU6(We().Kq2),We().p2L,We().AU6(We().oy3),We().AU6(We().ln6),()=>pe().zD.isAiEnabled(),We().SQN("ai_co_editing")],action:(e,t,n)=>{const o="ai_co_editing"===ge().Uv.getMode(t)?"default":"ai_co_editing",i=Xe().A.get({userId:e.currentUser.id,key:"ai_co_editing_always_on"});Xe().A.set({userId:e.currentUser.id,key:"ai_co_editing_always_on",value:!i}),L().PD({environment:e,navigableBlockStore:t,mode:o,location:"page_more_actions"})}});var nt,ot,it=()=>n(356985),at=()=>n(621327),rt=()=>n(654056),st=()=>n(354406),lt=()=>n(137743),dt=()=>n(364811),ct=()=>n(910702),ut=()=>n(921385);const pt=(0,l().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Page verification"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"},translateTemplate:{id:"action.translateTemplate",defaultMessage:"Localize template"}});function mt(e){const{environment:t,intl:n,context:o,isFiltering:i}=e,{device:a}=t,r=o.blocks[0],s=r.getFollowSettingsKey(),l=Ye().H8({followSettingsKey:s,environment:t,blockStore:r,from:"more_menu"}),d=!r.isPost()&&!r.isPostCollectionBlock(),c=!r.isPost()&&!r.isPostCollectionBlock(),u=!a.isMobile&&!r.isPost()&&!r.isPostCollectionBlock();return r.isPersonProfile()?[(0,se().gy)({key:"topbar primary actions",render:e=>(0,v.jsx)(W().A,{...e}),actions:[ut().p6,It]})]:[i?vt(t,r.getFormat().page_font||"default"):ht,(0,se().gy)({key:"page style and layout",render:e=>(0,v.jsx)(W().A,{...e,topBorder:!1}),actions:(0,B().oE)([bt,c?xt:void 0,d?At:void 0,u?Wt:void 0,kt])}),(0,se().gy)({key:"viewing of page content",render:e=>(0,v.jsx)(W().A,{...e}),actions:[qe().Z,tt,St,it().fg,it().Fh,it().cy]}),st().LQ,(0,se().gy)({key:"editing of page content",render:e=>(0,v.jsx)(W().A,{...e}),actions:[Ct,at().DI,wt,jt]}),(0,se().gy)({key:"undo",render:e=>(0,v.jsx)(W().A,{...e}),actions:[ut().tN]}),(0,se().gy)({key:"topbar primary actions",render:e=>(0,v.jsx)(W().A,{...e}),actions:[it().qQ,it().Zk,Rt({environment:t,intl:n,blockStore:r}),ut().p6,It,Tt,rt().TR,rt().kl,rt().J8,rt().lb,lt().t,dt().dl]}),(0,se().gy)({key:"topbar import actions",render:e=>(0,v.jsx)(W().A,{...e}),actions:[Kt,it().TD,zt]}),(0,se().gy)({key:"topbar wiki actions",render:e=>(0,v.jsx)(W().A,{...e}),actions:(0,B().oE)([ct().H0,ct().hk])}),Vt(),Ut(t,l),(0,ae().A)(o),(0,se().gy)({key:"topbar view options",render:e=>(0,v.jsx)(W().A,{...e}),actions:[Pt,_t,Bt,Lt]})]}function gt(e){return(0,se().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[We().or([We().AU6(We().Kq2),We().Afv]),We().p2L,We().AU6(We().oy3),...e.extraValidators],render:(t,n)=>{const o=n.blocks[0].getFormat().page_font,i=e.font===o||!e.font&&!o;return(0,v.jsx)(J,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,checkState:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,n,o)=>{let{blocks:i,environment:a}=n;const{serverCommitResult:r}=U().createAndCommit({userAction:"actionRegistry.createFontAction",environment:a,canUndo:!0,perform:t=>{R().zA({stores:i,update:{page_font:e.font},transaction:t}),function(e,t){Ie().vd(e,"change_font_type",t)}(a,{type:e.font||"default"})}});r.then(t)}})}const ft=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return gt({displayName:pt.fontDefaultName,caption:(0,v.jsx)(l().sA,{...pt.fontDefaultCaption}),font:void 0,tooltip:(0,v.jsx)(l().sA,{...pt.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:d().vc(c().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:x})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return gt({displayName:pt.fontSerifName,caption:(0,v.jsx)(l().sA,{...pt.fontSerifCaption}),font:"serif",tooltip:(0,v.jsx)(l().sA,{...pt.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:d().vc(c().locale).serif},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:S})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return gt({displayName:pt.fontMonoName,caption:(0,v.jsx)(l().sA,{...pt.fontMonoCaption}),font:"mono",tooltip:(0,v.jsx)(l().sA,{...pt.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:d().vc(c().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:b})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return gt({displayName:pt.fontComicName,caption:(0,v.jsx)(l().sA,{...pt.fontComicCaption}),font:"comic",tooltip:(0,v.jsx)(l().sA,{...pt.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:d().vc(c().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[We().or([We().SQN("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],ht=(0,se().gy)({key:"font section",title:void 0,render:e=>(0,v.jsx)(X,{...e}),actions:ft.map((e=>e.action({isFiltering:!1})))});function yt(e){return(0,se().gy)({key:"font extension menu",render:e=>(0,v.jsx)(W().A,{...e}),actions:ft.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function vt(e,t){const n=(0,_().O4)({theme:e.ThemeModeStore.state}),o=ft.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,se().gy)({key:"textStyleAction",render:e=>(0,v.jsx)(W().A,{...e}),actions:[(0,se().uk)({key:"font style section",displayName:pt.textFontStyle,analyticsName:pt.textFontStyle.defaultMessage,svg:T,right:(0,v.jsx)(v.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.lightTextColor,marginRight:5},width:300,validators:[We().or([We().AU6(We().Kq2),We().Afv]),We().p2L,We().AU6(We().oy3)],subActions:()=>[yt(t)],initialFocus:o,hideSubActions:!0,fuzzySearchKeywordsArray:[pt.fontDefaultName,pt.fontSerifName,pt.fontMonoName]})]})}const bt=(0,se().fi)({key:"small text",displayName:pt.fontSmallTextKeywords,label:Te().A.formatMessage(pt.fontSmallTextLabel),svg:I,isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[We().AU6(We().FrL),We().or([We().AU6(We().Kq2),We().Afv]),We().p2L,We().AU6(We().oy3)],track:{actionName:"set_text_size"},action:(e,t,n)=>R().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{Ie().vd(t,"change_font_size",{type:e?"small":"large"})}}),xt=(0,se().fi)({key:"full width",displayName:pt.fullWidthLabel,svg:n(665589).l,label:Te().A.formatMessage(pt.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[We().AU6(We().tpB),We().AU6(We().Kq2),We().p2L,We().AU6(We().oy3)],track:{actionName:"set_width"},action:(e,t,n)=>{R().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{Ie().vd(t,"change_page_width",{type:e?"full_width":"default_width"})}}),St=(0,se().fi)({key:"page lock",displayName:pt.lockPageName,label:Te().A.formatMessage(pt.lockPageName),svg:n(90907).h,isEnabled:e=>e.isLocked(),validators:[We().AU6(We().Kq2),We().p2L,We().AU6(We().oy3)],action:(e,t,n)=>N().zv({store:t.getFormatStore(),data:{block_locked:!t.isLocked(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),Mt=[We().AU6(We().Kq2),We().p2L,We().AU6(We().oy3),We().AU6(We().FrL),We().or([We().wTm])],At=(0,se().fi)({key:"floating table of contents",displayName:pt.floatingTableOfContents,svg:j,label:Te().A.formatMessage(pt.floatingTableOfContents),isEnabled:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:Mt,action:(e,t,n)=>{var o;const i="off"!==(null===(o=t.getModel())||void 0===o?void 0:o.getFloatingTableOfContentsState());N().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,Ie().u4)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),Ct=(0,se().Ls)({key:"suggest edits",displayName:pt.suggestEditsName,analyticsName:pt.suggestEditsName.defaultMessage,badge:(0,v.jsx)(z().E,{newBadgeKey:"suggested_edits_topbar_more_actions",didUserEngage:Boolean(null===(nt=Le().default.state.currentUserSettingsStore)||void 0===nt||null===(nt=nt.getSettings())||void 0===nt?void 0:nt.dismissed_suggest_mode_tooltip)}),validators:[We().AU6(We().ln6),We().AU6(We().FrL),We().or([We().AU6(We().Kq2),We().Afv]),We().$9,We().AU6(We().oy3)],render:(e,t)=>{const o="suggest"===ge().Uv.getMode(t.blocks[0]),i=(0,_().O4)({theme:t.environment.ThemeModeStore.state});return(0,v.jsx)(K().A,{...e,title:(0,v.jsx)(l().sA,{...pt.suggestEditsName}),svg:n(209416).a,right:(0,se().cz)(i,o)})},action:e=>{const t="suggest"===ge().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&Je().A.reset(),L().PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),wt=(0,se().Ls)({key:"translate",displayName:pt.translate,analyticsName:"open_translate_bar_from_topbar",validators:[We().yI5,We().pxM],closeParentMenu:!0,render:(e,t,n)=>{let{onFocus:o}=n;const i=t.blocks.at(0);if(i)return(0,v.jsx)(be,{onFocus:o,closeParentMenu:()=>{Je().A.reset()},blockStore:i,menuListItemProps:e,title:(0,v.jsx)(l().sA,{...pt.translate})})},action:()=>{}}),jt=(0,se().Ls)({key:"translate template",displayName:pt.translateTemplate,analyticsName:"open_translate_template_bar_from_topbar",validators:[We().wpj,We().or([We().pxM,We().Kq2]),We().AU6(We().oy3),We().AU6(We().Po5)],closeParentMenu:!0,render:(e,t,n)=>{let{onFocus:o}=n;const i=t.blocks.at(0);if(i)return(0,v.jsx)(ze,{onFocus:o,closeParentMenu:()=>{Je().A.reset()},blockStore:i,menuListItemProps:e,title:(0,v.jsx)(l().sA,{...pt.translateTemplate})})},action:()=>{}}),kt=(0,se().Ls)({key:"customize page",displayName:pt.customizePageLabel,analyticsName:pt.customizePageLabel.defaultMessage,svg:A().M,validators:[We().AU6(We().wTm),We().VNy,We().AU6(We().oy3),We().or([We().AU6(We().Kq2),We().Afv]),We().or([We().FrL,We().AU6(We().omD),We().UC4]),We().AU6(We().Po5)],closeParentMenu:!0,render:e=>(0,v.jsx)(K().A,{...e,title:(0,v.jsx)(l().sA,{...pt.customizePageLabel}),svg:A().M}),action:e=>{n(334261).ho({originRect:e.originRect})}}),It=(0,se().Fw)({key:"copy link to block non-desktop",displayName:se().AY.copyLinkNavigableTypeName,analyticsName:se().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(742852).w,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[We().M3g,We().vXb,We().AU6(We().b8R),We().AU6(We().oy3),We().AU6(We().Po5)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,n)=>{let{lazyDependencies:o,...i}=t;const{clipboardActions:a}=o;a?a.copyLinkToBlock({...i,callback:e,event:n}):m().log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),Tt=(0,se().Fw)({key:"duplicate",displayName:se().AY.duplicateName,analyticsName:se().AY.duplicateName.defaultMessage,svg:n(764781).V,validators:[We()._fc,We().p2L,We().MIU,We().omD,We().AU6(We().Xjv(p().xd.externalObjectInstancePage)),We().AU6(We().UC4),We().AU6(We().PfK),We().AU6(We().oy3)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,t,o)=>{let{environment:i}=t;const a=n(186445).ao();if(!a)return;const r=a.getAssociatedCollectionStore();if(!r)return;if(!(0,n(611371).EF)(i))return;const s=new(n(441307).A)(i);if(s.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:r}),(0,n(405417).ls)(a,s))return void(await n(60867).HF({environment:i,blocks:[a],collectionContextStore:s,callback:e}));const{duplicateBlock:l}=await(0,n(855801).D6)(),{serverCommitResult:d}=U().createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:i,canUndo:!0,perform:e=>{const[t,o]=l({environment:i,stores:[a],addCopyName:(0,n(53664).A)(a),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!a.isInsideTemplate(),targetSpaceId:(0,n(161479).e)(r.pointer.spaceId),baseUrl:we().A.domainBaseUrl,publicDomainName:we().A.publicDomainName,preferDuplicateLocation:"local"}),s=t[0];O().X$({childStore:s,parentStore:r,transaction:e}),a.isTemplate()&&n(722101).BC({parentStore:r.getTemplatePagesStore(),appendStore:s,transaction:e}),E().uK({environment:i,store:s,pageVisitSource:u().y8.Duplicate})}});d.then(e)},disabled:()=>!me().A.state.online,renderTooltip:()=>Te().A.formatMessage(se().AY.unavailableOfflineTooltip),disableTooltip:()=>me().A.state.online}),Pt=(0,se().Ls)({key:"open in mac app",displayName:pt.openinMacAppName,analyticsName:pt.openinMacAppName.defaultMessage,svg:M().S,validators:[We().vXb,We().AU6(We().ibx),We().AU6(We().FrL),We().cX8,We().AU6(We().Po5)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,Ge().Ay)({store:n[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});F().eG({url:(0,He().P)(i),environment:o})}}),_t=(0,se().Ls)({key:"open in windows app",displayName:pt.openinWindowsAppName,analyticsName:pt.openinWindowsAppName.defaultMessage,svg:M().S,validators:[We().vXb,We().AU6(We().ibx),We().AU6(We().FrL),We().uFH,We().AU6(We().Po5)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,Ge().Ay)({store:n[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});F().eG({url:(0,He().P)(i),environment:o})}}),Bt=(0,se().Ls)({key:"open in ios app",displayName:pt.openiniOSAppName,analyticsName:pt.openiniOSAppName.defaultMessage,svg:M().S,validators:[We().vXb,We().AU6(We().ibx),We().un6,We().AU6(We().Po5)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,Ge().Ay)({store:n[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});F().eG({url:i,environment:o})}}),Lt=(0,se().Ls)({key:"open in android app",displayName:pt.openinAndroidAppName,analyticsName:pt.openinAndroidAppName.defaultMessage,svg:M().S,validators:[We().vXb,We().AU6(We().ibx),We().m01,We().AU6(We().Po5)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,Ge().Ay)({store:n[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});F().eG({url:i,environment:o})}});function Rt(e){const{environment:t,intl:n,blockStore:o}=e,i=(0,_().O4)({theme:t.ThemeModeStore.state});return(0,se().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:pt.pageVerification,render:e=>(0,v.jsx)(K().A,{...e,svg:g().J,title:(0,v.jsx)(l().sA,{...pt.pageVerification}),right:(0,v.jsx)("div",{style:{color:i.lightTextColor,marginRight:0},children:oe({intl:n,blockStore:o})}),rightStyle:{marginRight:5},showExtensionArrow:!0}),validators:[We().FrL,e=>We().p2L(e),()=>(0,ne().Io)(),()=>{var e;const t=null===(e=Le().default.state.currentSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,P().Xi)(t))}],closeParentMenu:!1,action:()=>{D().h()}})}const Dt=(0,se().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:pt.pageUpdates,svg:h().y,validators:[n(930545).tm,We().FrL],closeParentMenu:!0,action:()=>{n(338429).A.setState({open:!0})},disabled:()=>!me().A.state.online}),Ot=(0,se().Ls)({key:"action page history",displayName:pt.pageHistoryName,analyticsName:pt.pageHistoryName.defaultMessage,svg:C().G,validators:[We().or([We().hfc,We().Xmj]),We()._fc,We().M3g,We().AU6(We().vP$),We().AU6(We().PfK),We().AU6(We().Qp$),We().AU6(We().Po5)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;return n(82926).WE({environment:t,blockStore:o[0],from:"topbar"})},render:(e,t)=>{let{onClick:o,key:i,...a}=e,{environment:r}=t;return(0,v.jsx)(n(643908).A,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:o,alwaysAllowClick:!0,render:(e,t)=>{const n=!me().A.state.online;return(0,v.jsx)(K().A,{...(0,H().A)(a,e),title:Te().A.formatMessage(pt.pageHistoryNewName),svg:C().G,dontShrinkRight:!0,right:t,tooltipText:n?Te().A.formatMessage(se().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},i)}}),Nt=(0,se().Ls)({key:"view analytics",displayName:pt.viewAnalyticsName,analyticsName:pt.viewAnalyticsName.defaultMessage,svg:n(489538).o,validators:[We().JYi,We().AU6(We().Po5)],closeParentMenu:!0,action:e=>{Qe().handleSidebarButtonClick(e.environment,e.blocks[0],$e().tF.Updates,"more_menu"),$e().Ay.setState({...$e().Ay.state,updatesSubTab:$e().VE.Analytics})},disabled:()=>!me().A.state.online,renderTooltip:()=>Te().A.formatMessage(se().AY.unavailableOfflineTooltip),disableTooltip:()=>me().A.state.online}),Et=(0,se().Ls)({key:"view updates and analytics",displayName:pt.viewUpdatesAndAnalyticsName,analyticsName:pt.viewUpdatesAndAnalyticsName.defaultMessage,validators:[We().JYi,We().AU6(We().Po5)],svg:h().y,closeParentMenu:!0,badge:(0,v.jsx)(z().E,{newBadgeKey:"new_updates_top_bar_entrypoint",didUserEngage:Boolean(null===(ot=Le().default.state.currentUserSettingsStore)||void 0===ot||null===(ot=ot.getSettings())||void 0===ot?void 0:ot.opened_new_top_bar_updates_entrypoint)}),action:e=>{const{currentUserSettingsStore:t}=Le().default.state;t&&U().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(755199).mJ({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),Qe().handleSidebarButtonClick(e.environment,e.blocks[0],$e().tF.Updates,"more_menu")},disabled:()=>!me().A.state.online,renderTooltip:()=>Te().A.formatMessage(se().AY.unavailableOfflineTooltip),disableTooltip:()=>me().A.state.online});function Ft(e,t){var n;const o=(0,_().O4)({theme:e.ThemeModeStore.state});return(0,se().uk)({key:"notifications",displayName:pt.notifyMe,analyticsName:pt.notifyMe.defaultMessage,svg:f().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:o.lightTextColor,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[We().AU6(We().oy3),We().AU6(We().Po5)],subActions:()=>[(0,se().gy)({key:"notifications",render:e=>(0,v.jsx)(W().A,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,B().oE)(t.map((e=>{let{action:t}=e;return t.displayName?Ye().aE(t.displayName):void 0})))})}function Ut(e,t){return(0,se().gy)({key:"notifyMe",render:e=>(0,v.jsx)(W().A,{...e}),actions:[Ft(e,t)]})}function Vt(){const e="on"===Re().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0});return(0,se().gy)({key:"editorActions",render:e=>(0,v.jsx)(W().A,{...e}),actions:(0,B().oE)([Dt,e?Et:Nt,Ot])})}const Kt=(0,se().Ls)({key:"open import modal",displayName:pt.importName,analyticsName:pt.importName.defaultMessage,svg:n(820579).f,validators:[We().IRu,We().p2L,We().AU6(We().Xjv(p().xd.externalObjectInstancePage)),We().AU6(We().PfK),We().AU6(We().oy3)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,o=!1;if(1===t.length){const[e]=t;o=e.isCollectionView()}o?n(41432).A.setState({open:!0}):Ze().A.setState({...Ze().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})},disabled:()=>!me().A.state.online,renderTooltip:()=>Te().A.formatMessage(se().AY.unavailableOfflineTooltip),disableTooltip:()=>me().A.state.online}),zt=(0,se().Ls)({key:"export block",displayName:pt.exportName,analyticsName:pt.exportName.defaultMessage,validators:[We().M3g,We().y9r,We().AU6(We().Po5)],closeParentMenu:!0,render:e=>{const t=!me().A.state.online;return(0,v.jsx)(K().A,{...e,svg:n(419178).Q,title:(0,v.jsx)(l().sA,{...pt.exportName}),tooltipText:t?(0,v.jsx)(l().sA,{...se().AY.unavailableOfflineTooltip}):(0,v.jsx)(l().sA,{...pt.exportCaption}),disabled:t,disabledFeedback:t})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];if(!i.isDefined())return;let a=!0;const r=(0,V().UH)(t[0]);if(r){const e=null==r?void 0:r.collectionStore();null!=e&&e.isPageTreeCollection()&&(a=!1)}n(201549).Ss({environment:o,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:a})}}),Wt=(0,se().Ls)({key:"open page layout editor",displayName:pt.openPageLayoutEditor,analyticsName:pt.openPageLayoutEditor.defaultMessage,validators:[We().wTm],closeParentMenu:!0,render:function(e){return(0,v.jsx)(K().A,{...e,svg:n(167170)._,title:(0,v.jsx)(n(21140).Ye,{children:(0,v.jsx)(l().sA,{...pt.openPageLayoutEditor})})})},action:function(e){let t,o,i,a,{environment:r,blocks:s}=e;for(const n of s)if(n.isCollectionView()){const e=n.getCollectionStore();if(e){t=n,o=e;const r=(0,V().UH)(n);i=null==r?void 0:r.collectionViewStore(),a="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){t=n,o=e,a="customize_page_button_in_three_dot_menu";break}}if(!o||!t||!a)throw new Error("Could not edit page layout: Could not find collection");n(447934).nh({environment:r,blockStore:t,collectionStore:o,collectionViewStore:i,from:a})}});var Ht=()=>n(836251),Gt=()=>n(857437),Yt=()=>n(819493),qt=()=>n(452558),Qt=()=>n(419357),$t=()=>n(678553),Zt=()=>n(962036),Jt=()=>n(715011);function Xt(e){const{blockStore:t,onClickOriginRect:n,handleAccept:c,handleDismiss:u}=e,p=(0,i().v3)(),m=(0,i().Y0)(),g=(0,l().tz)(),[f,h]=(0,o.useState)(""),[y,b]=(0,Gt().$)(),x=(0,a().K8)((()=>({environment:p,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu"})),[p,t,n]),{initialSections:S,filterSections:M}=(0,a().K8)((()=>({initialSections:mt({environment:p,intl:g,context:x,isFiltering:!1}),filterSections:mt({environment:p,intl:g,context:x,isFiltering:!0})})),[p,g,x]),A=(0,a().K8)((()=>0===f.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,f]),C=(0,a().K8)((()=>0===f.length&&t.canEdit()&&!t.isPersonProfile()),[t,f.length]),w=(0,a().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),j=(0,r().IS)((e=>({caption:{color:e.lightTextColor},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.accentColors.gray[500]}})),[]),k=(0,a().K8)((()=>m.isMobile||t.isPersonProfile()),[m,t]),I=(0,v.jsxs)(v.Fragment,{children:[A&&!C&&(0,v.jsx)($t().A,{caption:(0,v.jsx)("span",{style:j.caption,children:(0,v.jsx)(l().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,v.jsx)(Jt().A,{store:t})}})})}),C&&(0,v.jsx)("div",{style:{marginBottom:1},children:(0,v.jsx)(Yt().$,{store:t,isPageMoreButton:!0,showWordCount:A})})]}),T=m.isMobile?{menuType:ue().gu.Modal,title:(0,v.jsx)(l().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:j.menuPropIcon,onClickRight:u,titleOuterStyle:{fontSize:17,fontWeight:d().Wy.bold},paddingTop:10,shouldRenderMobileRefresh:!0}:{menuType:ue().gu.Popup,maxHeight:"80vh"};return(0,v.jsxs)(fe().A,{...T,children:[k?(0,v.jsx)(qt().A,{sections:S,onAccept:c,context:x}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(W().A,{isInput:!0,children:(0,v.jsx)(Qt().Ay,{value:f,onChange:e=>h(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:g.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,inputLeft:(0,s().q)({...j.icon}),showClearButton:!0,...y})}),(0,v.jsx)(qt().A,{sections:S,filterSections:M,onAccept:c,context:x,filter:f,showNoResultsMessage:!0,initialFocus:f.length>0?0:void 0,comboboxProps:b})]}),(A||C)&&(m.isMobile?(0,v.jsx)(v.Fragment,{children:I}):(0,v.jsx)(W().A,{topBorder:!0,children:I})),w&&(0,v.jsx)(en,{})]})}function en(){return(0,v.jsx)(W().A,{topBorder:!0,children:(0,v.jsx)(Zt().A,{title:(0,v.jsx)(l().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Ht().xS)("guides.database"),analyticsFrom:"topbar_more_button"})})}},766024:(e,t,n)=>{n.d(t,{A:()=>W});n(898992),n(354520),n(672577),n(581454);var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(959013),s=()=>n(496603),l=()=>n(901389),d=()=>n(383594),c=()=>n(892632),u=()=>n(972435),p=()=>n(722872),m=()=>n(663173),g=()=>n(274652),f=()=>n(439264),h=()=>n(805751),y=()=>n(928600),v=()=>n(45552),b=()=>n(89924),x=(n(944114),()=>n(401497)),S=()=>n(304740),M=()=>n(522419),A=()=>n(641007),C=()=>n(147588),w=()=>n(437219),j=()=>n(235116),k=()=>n(35622),I=()=>n(465741);class T extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const P=T;var _=()=>n(911706),B=()=>n(760217),L=()=>n(406699),R=()=>n(623580),D=()=>n(939740),O=()=>n(14235),N=()=>n(360083),E=n(474848);function F(e){const{disabled:t,store:n,name:r,url:s,onChange:l,onDelete:d}=e,c=S().rS({url:e.url}),u=(0,o.useRef)(null),p=(0,i().v3)(),{device:m}=p,g=(0,a().uB)(void 0,P),f=(0,a().O$)(g),h=(0,o.useCallback)((e=>{if(!f.open)return;g.setState({...f,inputValue:e});const t=M().SB({title:e,source:s});l({url:s,name:t})}),[g,f,l,s]),y=(0,o.useCallback)((()=>{g.setState({open:!0,inputValue:r})}),[g,r]),v=(0,o.useCallback)((()=>{g.setState({open:!1})}),[g]),b=(0,o.useCallback)((()=>{d(s)}),[d,s]),T=(0,o.useCallback)((()=>{const e=()=>{w().uR(p,{url:s,from:"FilePropertyMenuItem"}),j().KE(p,{url:s,download:!0,downloadName:r,permissionRecord:n.pointer})};n.getCreatedById()===A().xY.id?(0,I().TW)({propertyType:"file",onConfirm:e}):e()}),[p,r,s,n]),_=(0,o.useCallback)((()=>{j().OG(p,{url:s,type:"file",from:"view_original",downloadName:r,permissionRecord:n.pointer})}),[p,r,n.pointer,s]),R=(0,o.useCallback)((()=>{if(!u.current)return;const e=u.current.getBoundingClientRect(),t=e.width/e.height;k().o9({environment:p,renderFullScreenNode:()=>(0,E.jsx)(N().A,{url:s,isAuthenticated:!0,permissionRecord:n.pointer,width:window.innerWidth,render:(e,t)=>(0,E.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,blockStore:n,imageUrl:s})}),[p,n,s]),D=(0,o.useCallback)((()=>{if(f.open)return(0,E.jsx)(K,{url:e.url,inputValue:f.inputValue,isOpen:f.open,handleFileRename:h,handleCloseRenamePopover:v})}),[f,v,h,e.url]),F=(0,x().IS)((()=>({imageInner:{display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},imageInnerWrapper:{flex:"auto",overflow:"hidden"}})),[]),V=(0,E.jsx)(U,{fileIsImage:c,fileUrl:s,disabled:t,handleOpenFullscreenPreviewOfFile:R,handleDownloadFile:T,handleViewOriginalFile:_,handleOpenRenamePopover:y,handleDeleteFile:b});return c?(()=>{const n=(0,E.jsx)(N().A,{url:s,isAuthenticated:!0,permissionRecord:e.store.pointer,width:300,render:(e,t)=>(0,E.jsx)("div",{style:F.imageInnerWrapper,children:(0,E.jsx)("img",{src:t,style:F.imageInner,onClick:R,ref:u})})}),o={paddingTop:m.isMobile?12:8,paddingBottom:m.isMobile?12:8,alignItems:"flex-start"};return(0,E.jsx)(B().A,{focused:!1,showDragHandle:!t&&!m.isMobile,style:o,title:n,right:V,dontShrinkRight:!0})})():(()=>{const t=(0,E.jsx)(B().A,{focused:!1,showDragHandle:!e.disabled&&!m.isMobile,onClick:_,title:r,icon:(0,E.jsx)("div",{style:{width:m.isMobile?16:14},children:(0,C().Y)()}),right:V,dontShrinkRight:!0});return(0,E.jsx)(O().Ay,{open:f.open,popupType:m.isMobile?L().z7.SlideUp:L().z7.Popup,origin:t,render:D,onDismiss:v})})()}function U(e){const{disabled:t,fileIsImage:n,fileUrl:a,handleOpenFullscreenPreviewOfFile:r,handleDownloadFile:s,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c}=e,u=(0,i().v3)(),{isMobile:p}=u.device,m=(0,o.useCallback)((e=>(0,E.jsx)(_().A,{isMobile:p,...e})),[p]),g=(0,o.useCallback)((e=>(0,E.jsx)(V,{fileIsImage:n,fileUrl:a,disabled:t,parent:e,handleOpenFullscreenPreviewOfFile:r,handleDownloadFile:s,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c})),[n,a,t,r,s,l,d,c]);return(0,E.jsx)(L().Ay,{popupType:p?L().z7.SlideUp:L().z7.Popup,renderOrigin:m,render:g})}function V(e){const{parent:t,disabled:n,fileUrl:a,fileIsImage:s,handleOpenFullscreenPreviewOfFile:l,handleDownloadFile:d,handleViewOriginalFile:c,handleOpenRenamePopover:u,handleDeleteFile:m}=e,g=(0,i().v3)(),{isMobile:f,isNative:h}=g.device,v=(0,o.useMemo)((()=>{const e=[];s&&e.push({key:"fullscreen",render:e=>(0,E.jsx)(B().A,{...e,title:(0,E.jsx)(r().sA,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:l});return(M()._J(a)||h)&&e.push({key:"download",render:e=>(0,E.jsx)(B().A,{...e,title:(0,E.jsx)(r().sA,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:d}),e.push({key:"original",render:e=>(0,E.jsx)(B().A,{...e,title:(0,E.jsx)(r().sA,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>c()}),n||s||e.push({key:"rename",render:e=>(0,E.jsx)(B().A,{...e,title:(0,E.jsx)(r().sA,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:u}),n||e.push({key:"delete",render:e=>(0,E.jsx)(B().A,{...e,title:(0,E.jsx)(r().sA,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:m}),e}),[n,s,a,m,l,u,c,d,h]),x=(0,o.useMemo)((()=>[{key:"section",render:e=>(0,E.jsx)(b().A,{...e}),items:v}]),[v]),S=f?{menuType:p().gu.ActionSheet}:{menuType:p().gu.Popup,width:200};return(0,E.jsx)(y().A,{...S,children:(0,E.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:0,onAccept:t.close,sections:x})})}function K(e){const{url:t,handleFileRename:n,handleCloseRenamePopover:a,isOpen:r,inputValue:s}=e,l=(0,i().v3)(),{device:d}=l,c=(0,o.useCallback)((e=>{const t=e.target.value;n(t)}),[n]),u=(0,x().IS)((e=>({renameInputWrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},renameInput:{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]),m=d.isMobile?{menuType:p().gu.ActionSheet}:{menuType:p().gu.Popup,width:380};return r?(0,E.jsx)(y().A,{...m,children:(0,E.jsx)("div",{style:u.renameInputWrapper,children:(0,E.jsx)(R().A,{style:u.renameInput,value:s,placeholder:M().Jt(t),onChange:c,onSubmit:a,focusInitial:!0,selectAll:!0})})}):null}const z=function(e){return(0,E.jsx)(n(678553).A,{title:(0,E.jsxs)("div",{style:{display:"flex"},children:[(0,E.jsx)(n(331542).A,{style:{marginTop:1,marginRight:6}}),(0,E.jsx)(n(773382).A,{percentage:e.progressPercent})]})})};function W(e){const{store:t,uploadFiles:n,value:s,disabled:f,onChange:x,onDismiss:S}=e,M=H(s),A=(0,i().v3)(),C=(0,o.useRef)(),w=(0,o.useRef)(null),j=(0,a().uB)(void 0,m().A),{isLoading:k,progressPercent:I}=(0,a().O$)(j),T=(0,o.useCallback)((e=>{j.setState({isLoading:!0,progressPercent:0}),C.current=e}),[j]),P=(0,o.useCallback)((e=>{const{progressPercent:t}=e;j.setState({...j.state,progressPercent:t})}),[j]),_=(0,o.useCallback)((e=>{if(!C.current)return;const t=C.current.map(((t,n)=>{const o=e[n];return{name:t.name||o,url:o}}));x({value:[...t,...s]}),j.reset()}),[j,x,s]),B=(0,o.useCallback)((()=>{j.reset(),l().f1((0,E.jsx)(r().sA,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))}),[j]),L=(0,o.useCallback)((e=>{d().I(),j.setState({isLoading:!0,progressPercent:0}),C.current=[e]}),[j]),R=(0,o.useCallback)((e=>{if(!C.current)return;const t=C.current[0];if(!t)return;const n={name:t.name||e,url:e};x({value:[...s,n]}),j.reset(),d().I()}),[j,x,s]),D=(0,o.useCallback)((e=>{const t={name:e,url:e};x({value:[...s,t]}),j.reset(),d().I()}),[j,x,s]),O=(0,o.useCallback)((()=>{const e=w.current;if(!(e&&e instanceof Element))return;const n=u().A.getIntl();d().W(A,{originRect:e.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:n.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:e=>{c().QM({environment:A,file:e[0],bucket:"secure",record:t.pointer,onStart:L,onProgress:P,onComplete:R,onError:B})}},{type:"embed",onChange:D}]})}),[A,D,R,L,B,P,t.pointer]),N=(0,o.useCallback)((()=>{O()}),[O]),F=()=>{d().I()};(0,o.useEffect)((()=>((()=>{const{device:e}=A;n?c().Zn({environment:A,files:n,bucket:"secure",record:t.pointer,onBatchStart:T,onBatchProgress:P,onBatchComplete:_,onBatchError:B}):H(s)&&!e.isMobile&&O()})(),F)),[]);const U=A.device.isMobile?{menuType:p().gu.Modal,title:(0,E.jsx)(r().sA,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,E.jsx)(v().DoneMenuText,{}),onClickRight:S}:{menuType:p().gu.Popup};return(0,E.jsx)(h().A,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,E.jsxs)(y().A,{...U,children:[(0,E.jsx)(Q,{value:s,disabled:f,store:t,onChange:x}),(0,E.jsxs)(b().A,{topBorder:!M&&!f,desktopStyle:{...M&&{paddingTop:3,paddingBottom:3}},children:[k&&(0,E.jsx)(z,{progressPercent:I}),!k&&!f&&(0,E.jsx)(g().A,{focused:!1,onClick:N,title:(0,E.jsx)(r().sA,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:w})]})]})})}function H(e){return 0===e.length}function G(e,t,n){n({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function Y(e,t,n){n({value:t.filter((t=>t.url!==e))})}function q(e){let{url:t,value:n,disabled:o,store:a,onChange:r}=e;const s=(0,i().v3)(),{device:l}=s,d=n.find((e=>e.url===t));if(d){const e=d.url,t=d.name;return l.isMobile?(0,E.jsx)(b().A,{children:(0,E.jsx)(F,{store:a,name:t,url:e,onDelete:e=>Y(e,n,r),onChange:e=>G(e,n,r),disabled:o})}):(0,E.jsx)(F,{store:a,name:t,url:e,onDelete:e=>Y(e,n,r),onChange:e=>G(e,n,r),disabled:o})}return null}function Q(e){let{value:t,disabled:n,store:a,onChange:r}=e;const l=(0,i().v3)(),{device:d}=l,c=s().oE(t.map((e=>e.url)));return 0===c.length?null:d.isMobile||n?(0,E.jsx)(o.Fragment,{children:c.map((e=>(0,E.jsx)(q,{url:e,value:t,disabled:n,store:a,onChange:r},e)))}):(0,E.jsx)(b().A,{children:(0,E.jsx)(f().Ay,{direction:"vertical",keys:c,renderKey:e=>(0,E.jsx)(q,{url:e,value:t,disabled:n,store:a,onChange:r}),onDrop:e=>function(e,t,n){t({value:s().Ul(n,(t=>{const n=t.url;return n?e.indexOf(n):1/0}))})}(e,r,t)})})}},768935:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>ye});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(148307),l=()=>n(959013),d=()=>n(534177),c=()=>n(134696),u=()=>n(701763),p=()=>n(542056),m=()=>n(743260),g=()=>n(299545),f=()=>n(852507),h=()=>n(38337),y=()=>n(224701),v=()=>n(204063),b=()=>n(159026),x=n(474848);const S=function(e){const{permissionsInviteStore:t,onInviteClick:r,inviteOrigin:s,sudoModeStore:d}=e,c=(0,i().v3)(),u=(0,l().tz)(),m=(0,n(58293).r)(),[g,f]=(0,o.useState)(!1),h=(0,a().uB)(void 0,b().Ay),y=(0,a().K8)((()=>t.state.inviteTargets.length>0),[t]),S=(0,o.useCallback)((e=>{e||n(436572).D6({label:(0,x.jsx)(l().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[]),M=(0,o.useCallback)((async()=>{if(m){f(!0);try{await p().kW({environment:c,store:m,sudoModeStore:d,permissionsInviteStore:t,contextualInviteStore:h,onInviteClick:r,onInviteComplete:S,inviteOrigin:s,intl:u})}catch(e){}finally{f(!1)}}}),[h,c,u,s,r,t,m,d,S]);return(0,x.jsx)(v().A,{onClick:M,disabled:!y||g,children:(0,x.jsx)(l().sA,{id:"spacePermissionsInviteButton.label",defaultMessage:"Send invite"})})};var M=()=>n(554509),A=()=>n(10984);const C=function(e){const{permissionsInviteStore:t}=e,i=(0,a().K8)((()=>(0,A().dL)()),[]),s=(0,o.useCallback)((()=>{t.reset()}),[t]),d=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between"}})),[]);return(0,x.jsxs)("div",{style:d.container,children:[(0,x.jsxs)("div",{style:d.header,children:[(0,x.jsx)(M().D,{styleName:"Heading-17px/Semibold",children:(0,x.jsx)(l().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Invite members"})}),(0,x.jsx)(n(398208).A,{onClose:s})]}),(0,x.jsx)(n(125565).A,{isSecondaryColor:!0,isMultiline:!0,children:i?(0,x.jsx)(l().sA,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}):(0,x.jsx)(l().sA,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."})})]})};n(944114),n(581454);var w=()=>n(668725),j=()=>n(760217),k=()=>n(406699),I=()=>n(928600),T=()=>n(939740),P=()=>n(14235),_=()=>n(89924),B=()=>n(747788),L=()=>n(103448),R=()=>n(722872),D=()=>n(553965),O=()=>n(731320),N=()=>n(962730),E=()=>n(991249),F=()=>n(643908),U=()=>n(134217);function V(e){const{permissionsInviteStore:t}=e,n=(0,i().v3)(),s=(0,a().K8)((()=>{const e=(0,A().AI)();return(0,U().fk)(e)}),[]);(0,f().l)((()=>{s||t.setState({...t.state,isInviteTargetsEmpty:!0,inviteTargets:[],inviteRole:"read_and_write"})}));const d=(0,a().K8)((()=>t.state.inviteRole?t.state.inviteRole:s?"editor":"read_and_write"),[s,t]),c=(0,a().K8)((()=>{const e=["editor"];return(0,O().Qu)()&&e.push("membership_admin"),s||e.push("read_and_write"),e}),[s]),u=(0,o.useCallback)((e=>{p().lf({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),m=(0,r().IS)((e=>({menuItem:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},dropdownButton:{display:"flex",minHeight:34,margin:0,width:"100%"},dropdownButtonContent:{display:"flex",alignItems:"center"},selectedRole:{width:"100%",color:e.mediumTextColor},downIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function g(e){const t=c.map((t=>({key:t,render:e=>{var n;const o=(0,B().R)({type:"space_permission",table:"space",role:t,isRemovable:!1,isCurrentUser:!1});return(0,x.jsx)(j().A,{title:o.label.defaultMessage,caption:null===(n=o.caption)||void 0===n?void 0:n.defaultMessage,shouldWrapCaption:!0,...e})},action:()=>{u(t),e.close()}})));return s&&t.push({key:"read_and_write",render:e=>(0,x.jsx)(K,{menuListItemProps:e}),action:()=>{e.close()}}),t}return(0,x.jsx)(k().Ay,{popupType:P().nl.Popup,sameWidthAsOrigin:!0,render:e=>(0,x.jsx)(I().A,{menuType:R().gu.Popup,children:(0,x.jsx)(T().Ay,{type:T().Oh.Vertical,initialFocus:void 0,sections:[{key:"roles",render:e=>(0,x.jsx)(_().A,{...e}),items:g(e)}]})}),renderOrigin:e=>(0,x.jsx)(j().A,{style:m.menuItem,buttonStyle:m.dropdownButton,title:(0,x.jsxs)("div",{style:m.dropdownButtonContent,children:[(0,x.jsx)("div",{style:m.selectedRole,children:(0,x.jsx)(M().D,{styleName:"UIRegular-14px/Regular",children:(0,x.jsx)(l().sA,{...(0,B().R)({type:"space_permission",table:"space",role:d,isRemovable:!1,isCurrentUser:!1}).label})})}),(0,w().b)(m.downIcon)]}),focused:!1,...e})})}function K(e){let{menuListItemProps:t}=e;const n=(0,i().v3)(),a=(0,r().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleLabel:{marginRight:6}})),[]),d="space_permission_settings",c="plus",u=(0,o.useCallback)((()=>{(0,E().K)(n,{from:d,upsell:{type:"product",product:c,limit:{type:"none"}}})}),[n]),p=(0,x.jsx)(L().A,{imageURL:s().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,x.jsx)(l().sA,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,x.jsx)(l().sA,{defaultMessage:"Upgrade to add non-admin members",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.title"})});return(0,x.jsx)(F().A,{requireUpgradeToTier:c,renderUpgradeTooltip:()=>p,analyticsName:d,tooltipPlacement:N().W.Left,render:(e,n)=>{var o;const{focused:i,...r}=(0,D().A)(t,e),s=(0,B().R)({type:"space_permission",table:"space",role:"read_and_write",isRemovable:!1,isCurrentUser:!1});return(0,x.jsx)(j().A,{...r,title:(0,x.jsxs)("div",{style:a.titleContainer,children:[(0,x.jsx)("div",{style:a.titleLabel,children:s.label.defaultMessage}),n]}),caption:null===(o=s.caption)||void 0===o?void 0:o.defaultMessage,shouldWrapCaption:!0,focused:i})},onClick:u})}const z=function(e){const t=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8},roleText:{color:e.mediumTextColor}})),[]);return(0,x.jsxs)("div",{style:t.container,children:[(0,x.jsx)(M().D,{styleName:"UISmall-12px/Medium",customStyles:t.roleText,children:(0,x.jsx)(l().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Role"})}),(0,x.jsx)(V,{...e})]})};const W=function(e){const{inviteOrigin:t,onInviteClick:a,permissionsInviteStore:s}=e,l=(0,i().v3)();(0,f().l)((async()=>{await y().Ow(l)}));const d=(0,o.useCallback)((()=>{s.setState({...s.state,inputFocus:"none"})}),[s]),c=(0,r().IS)((()=>({container:{maxWidth:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"},footer:{display:"flex",justifyContent:"end"},description:{}})),[]);return(0,x.jsx)("div",{style:c.container,onClick:d,className:h().bFE,children:(0,x.jsx)(n(7674).tf,{header:(0,x.jsx)(C,{permissionsInviteStore:s}),footer:(0,x.jsx)("div",{style:c.footer,children:(0,x.jsx)(S,{inviteOrigin:t,onInviteClick:a,permissionsInviteStore:s})}),children:(0,x.jsxs)("div",{style:c.body,children:[(0,x.jsx)(n(334013).A,{permissionsInviteStore:s}),(0,x.jsx)(z,{permissionsInviteStore:s})]})})})};var H=()=>n(183804),G=()=>n(406792),Y=()=>n(749240),q=()=>n(433876),Q=()=>n(100622),$=()=>n(496603),Z=()=>n(836251),J=()=>n(437622),X=()=>n(11978),ee=()=>n(406999),te=()=>n(630116),ne=()=>n(972418),oe=()=>n(962036),ie=()=>n(912913),ae=()=>n(654856),re=()=>n(263919);function se(e){const{store:t,permissionsInviteStore:s,membersOnly:d,onUpgradeButtonClick:c,upgradeButtonName:u,inviteOrigin:m,onInviteClick:v}=e,b=(0,i().v3)();(0,f().l)((async()=>{await y().Ow(b)}));const S=(0,a().K8)((()=>(0,g().Yu)(t)),[t]),M=(0,o.useCallback)((async()=>{await p().iS({environment:b,permissionsInviteStore:s,from:"share_menu"})}),[b,s]),A=(0,r().IS)((()=>({right:{color:Q().Ay.blue}})),[]);return(0,x.jsxs)(I().A,{menuType:R().gu.Modal,title:S?(0,x.jsx)(l().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,x.jsx)(l().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,x.jsx)("div",{style:A.right,children:(0,x.jsx)(l().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,x.jsx)(n(45552).CancelMenuText,{}),onClickLeft:M,onClickRight:v,header:(0,x.jsx)(le,{...e,inviteOrigin:m,onInviteClick:v}),className:h().bFE,children:[(0,x.jsx)(_().A,{title:(0,x.jsx)(l().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,x.jsx)(ue,{store:t,onUpgradeButtonClick:c,upgradeButtonName:u,permissionsInviteStore:s})}),(0,x.jsx)("div",{children:(0,x.jsx)(de,{store:t,permissionsInviteStore:s,membersOnly:d})}),(0,x.jsx)(ce,{})]})}function le(e){const{store:t,isSubscribed:n,onInviteClick:r,permissionsInviteStore:s,inviteOrigin:l}=e,d=(0,i().v3)(),u=(0,a().K8)((()=>m().LC({environment:d,store:t,isSubscribed:n})),[d,t,n]),g=(0,a().K8)((()=>{const e=s.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[s]),f=(0,X().O)(),h=(0,ne().lI)({spaceId:f}),y=(0,o.useMemo)((()=>$().sg((()=>{c().D2(d,{invite_flow_id:s.state.flowId,billingData:h,invite_origin:l})}),1e3)),[d,s,l,h]),v=(0,o.useCallback)((async e=>{y(),await p().Pp({environment:d,event:e,permissionsInviteStore:s})}),[y,d,s]),b=(0,o.useCallback)((e=>{p().St({targetToRemove:e,permissionsInviteStore:s,defaultRoleForNonBot:u})}),[u,s]);return(0,x.jsx)(ae().A,{permissionsInviteStore:s,store:t,handleClickRemoveToken:b,handleInputChange:v,handleInputSubmit:r,origin:"share_modal",defaultRoleForNonBot:u,focus:g,handleFocus:()=>{}})}function de(e){const{store:t,permissionsInviteStore:n,membersOnly:o}=e,i=(0,a().K8)((()=>(0,g()._p)(t)),[t]),r=(0,a().K8)((()=>t instanceof te().Bv&&(0,J().hN)(t.getSpaceStore())),[t]);return(0,x.jsx)(re().A,{permissionsInviteStore:n,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:i,shouldShowGroups:i,sectionRenderLimit:10,membersOnly:o,guestsMustBeRequested:r})}function ce(){return(0,x.jsx)(_().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,x.jsx)(oe().A,{title:(0,x.jsx)(l().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,Z().xS)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function ue(e){const t=(0,i().v3)(),{store:n,onUpgradeButtonClick:s,upgradeButtonName:l,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,a().K8)((()=>{const{inviteRole:e}=d.state;return{inviteRole:e,table:n.table}}),[d,n.table]),m=(0,a().K8)((()=>(0,ee().qs)(d.state)),[d]),f=(0,a().K8)((()=>(0,g()._p)(n)?n.getType():void 0),[n]),h=(0,a().K8)((()=>(0,g().Yu)(n)&&!n.canAdmin()),[n]),y=(0,o.useCallback)((e=>{p().lf({environment:t,newRole:e,permissionsInviteStore:d})}),[t,d]),v=(0,r().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:Q().Ay.uiGray}})),[]);return m||!c?null:(0,x.jsx)(ie().Ay,{disabled:h,role:c,table:u,type:"user_permission",blockType:f,isInvite:!0,onUpgradeButtonClick:s,upgradeButtonName:l,buttonStyle:v.button,isMenuItem:!0,onChange:y})}const pe=o.memo(se);var me=()=>n(430102),ge=()=>n(748868);function fe(e){const{store:t,origin:c,sudoModeStore:u,onInviteComplete:f,onInviteClick:h}=e,v=(0,i().v3)(),{isMobile:S}=v.device,M=(0,l().tz)(),C=(0,a().K8)((()=>{var e;return null===(e=n(351360).default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),w=(0,n(714300).l)({spaceId:C}),j=(0,a().uB)(e.permissionsInviteStore,n(986229).A),k=(0,a().K8)((()=>j.state.modalOpen),[j]),I=e.analyticsFrom,T=(0,a().uB)(void 0,b().Ay),P=(0,o.useCallback)((async()=>{const e=G().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await p().kW({environment:v,store:t,sudoModeStore:u,permissionsInviteStore:j,contextualInviteStore:T,onInviteClick:h,onInviteComplete:f,inviteOrigin:I,intl:M}),G().default.DO_NOT_USE_measureLegacy(e,{environment:v})}),[v,t,u,j,T,h,f,I,M]);(0,o.useEffect)((()=>{k&&!(0,d().O9)(Y().subscriptionDataStoreInstance.state)&&y().Ow(v)}),[v,k]);const _=(0,a().K8)((()=>Boolean(t.canEditMembership())),[t]),B=(0,a().K8)((()=>_&&(0,g().Yu)(t)&&(0,d().O9)(Y().subscriptionDataStoreInstance.state)&&!A().El()),[_,t]),R=(0,a().K8)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:o}=e;if(!n&&(0,g().Yu)(t))return(0,x.jsx)(l().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,x.jsx)(l().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(o)return(0,x.jsx)(L().A,{imageURL:s().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,x.jsx)(l().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,x.jsx)(l().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:_,showUpgrade:B})),[_,B,t]),D=(0,o.useCallback)((()=>async function(e,t,n,o){const i=await(0,m().iQ)({environment:e,permissionsInviteStoreState:n.state,from:o??((0,g().Yu)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(v,t,j,e.analyticsFrom)),[v,t,j,e.analyticsFrom]),O=(0,o.useCallback)((()=>S?(0,x.jsx)(pe,{...e,onInviteClick:P,inviteOrigin:I,permissionsInviteStore:j,billingData:w}):(0,x.jsx)(W,{inviteOrigin:I,onInviteClick:P,permissionsInviteStore:j})),[S,e,P,I,j,w]),N=(0,r().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,g().Yu)(t)?(0,x.jsx)(q().A,{open:k,onDismiss:D,renderContent:O,modalStyle:N.modal,origin:(0,x.jsx)(n(859428).A,{renderTooltip:()=>R,disableTooltip:_,render:t=>(0,x.jsx)(he,{permissionsInviteStore:j,tooltipEvents:t,actionEnabled:_,showUpgrade:B,buttonInner:c,...e,...t})})}):(0,x.jsx)(q().A,{open:k,onDismiss:D,renderContent:O,origin:null})}function he(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:a,store:s,isSubscribed:d,enableInviteDropdown:p,onInviteClick:g,onInviteComplete:f,upgradeButtonName:h,onUpgradeButtonClick:y,shouldGrow:b,buttonStyle:S,permissionsInviteStore:M,buttonInner:A}=e;const C=(0,i().v3)(),w=(0,r().IS)((()=>({dropdownButton:{flex:b?1:0,...S},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[S,b]),j=(0,o.useCallback)((()=>function(e,t,n,o){(0,m().LH)({environment:e,permissionsInviteStore:o,store:t,renderInShareModal:!1,isSubscribed:n}),u().CW(e,{type:"invite"}),c().vX(e,{type:"invite",from:"settings_modal"})}(C,s,d,M)),[C,s,d,M]),I=(0,o.useCallback)((()=>n?function(e,t,n){E().K(t,{from:e,upsell:{type:"product",product:"plus",limit:{type:"none"}}}),n&&n(),u().CW(t,{type:"upgrade"})}(h,C,y):j()),[C,j,y,n,h]);if(A)return(0,x.jsx)("div",{onClick:j,children:A});const T=(0,H().A)({onInviteClick:g,onInviteComplete:f,buttonStyle:w.importListButton,buttonContainerStyle:w.importListButtonContainer});return p?(0,x.jsx)(k().Ay,{popupType:P().nl.Popup,alignmentToOrigin:k().yP.End,placementToOrigin:k().sx.Bottom,render:()=>(0,x.jsx)(ge().A,{importListItems:T}),originGap:12,renderOrigin:e=>(0,x.jsx)(me().A,{disabled:!a&&!n,style:w.dropdownButton,title:(0,x.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}),onClick:I,onDropdownClick:e.onClick,color:"blue"})}):(0,x.jsx)(v().A,{size:"lg",onClick:I,disabled:!a&&!n,style:w.dropdownButton,...t,children:(0,x.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const ye=o.memo(fe)},770586:(e,t,n)=>{n.d(t,{v:()=>o});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(908872);function o(e,t){const n=e.reduce(((e,t)=>{if(t.isType("define_variables")){var n;const o=null===(n=t.getModel())||void 0===n?void 0:n.getVariables();if(o)for(const t of Object.values(o))e.add(t.name)}return e}),new Set),o=t.replace(/\s*\d+$/,"");let i=1,a=`${o} ${i}`;for(;n.has(a);)a=`${o} ${i}`,i++;return a}},775812:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(496603),i=()=>n(383594),a=()=>n(962730),r=()=>n(377586),s=n(474848);const l=function(){const e=(0,n(484714).v3)(),{device:t}=e,i=(0,n(56366).O$)(n(969141).A);return(0,s.jsx)(n(14235).Ay,{popupType:t.isMobile?r().n.SlideUp:r().n.Popup,open:i.isActive,originRect:i.isActive?i.originRect:void 0,originGap:i.isActive?i.originGap:void 0,placementToOrigin:a().W.Bottom,alignmentToOrigin:a().C.Center,preventScaleTransition:!0,onDismiss:d,render:()=>{if(i.isActive)return(0,s.jsx)(n(545805).A,{debugName:"MediaMenu",capture:!0,onUp:o().D_,onDown:o().D_,children:(0,s.jsx)(n(126090).Ay,{...i,onCancel:d})})},trapFocus:!0})};function d(){i().I()}},777849:(e,t,n)=>{n.d(t,{A:()=>f});var o=n(296540),i=()=>n(56366),a=()=>n(401497),r=()=>n(919709),s=()=>n(959013),l=()=>n(448619),d=()=>n(792002),c=()=>n(569777),u=()=>n(24157),p=()=>n(35392),m=n(474848);const g={display:"flex",alignItems:"center",borderRadius:6,padding:6,width:28,height:28};const f=function(e){let{style:t,children:o,disabled:s,onClick:p}=e;const f=(0,a().DP)(),v=(0,n(484714).v3)(),b=(0,i().K8)((()=>h(f)),[f]),x=(0,i().K8)((()=>function(e){if(e)return!0;if("editing"!==u().default.state.mode&&!c().A.isOpen())return!0;const t={[r().Ifu.User]:r().Ifu.User,[r().Ifu.Page]:r().Ifu.Page,[r().Ifu.CustomEmoji]:r().Ifu.CustomEmoji,[r().Ifu.Comment]:r().Ifu.Comment,[r().Ifu.Bot]:r().Ifu.Bot,[r().Ifu.Date]:r().Ifu.Date,[r().Ifu.ExternalObjectInstance]:r().Ifu.ExternalObjectInstance,[r().Ifu.TemporaryPage]:r().Ifu.TemporaryPage,[r().Ifu.TemplateVariable]:r().Ifu.TemplateVariable,[r().Ifu.FormulaPageProperty]:r().Ifu.FormulaPageProperty,[r().Ifu.FormulaContextValue]:r().Ifu.FormulaContextValue,[r().Ifu.Group]:r().Ifu.Group,[r().Ifu.Team]:r().Ifu.Team,[r().Ifu.Citation]:r().Ifu.Citation,[r().Ifu.LinkMention]:r().Ifu.LinkMention,[r().Ifu.AssistantInstructionsCollection]:r().Ifu.AssistantInstructionsCollection,[r().Ifu.GeoPoint]:r().Ifu.GeoPoint};for(const n of Object.values(t))if((0,d().y_)(n))return!0;return!1}(s)),[s]);return(0,m.jsx)(n(859428).A,{renderTooltip:()=>(0,m.jsx)(y,{}),render:e=>(0,m.jsx)(n(704152).A,{style:{...g,...b.equationButton,...t},disabled:x,disabledFeedback:x,onClick:e=>function(e,t,n){l().Wx({environment:t,analyticsFrom:"rich_text_menu"}),n&&n(e)}(e,v,p),...e,children:o})})};function h(e){return{equationButton:{fill:(0,d().B1)(r().Ifu.Equation)?e.blueColor:e.icon.primary},keyboardShortcut:{color:e.text.contrastSecondary}}}function y(){const e=(0,a().DP)(),t=(0,i().K8)((()=>h(e)),[e]);return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("div",{children:(0,m.jsx)(s().sA,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Mark as equation"})}),(0,m.jsx)("div",{children:(0,m.jsx)(p().A,{style:t.keyboardShortcut,name:"openEquationMenu"})})]})}},779496:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(296540),i=()=>n(56366),a=()=>n(959013),r=()=>n(125565),s=()=>n(698449),l=n(474848);function d(e){let{inviteTarget:t,isRedesignEnabled:o,isMobile:d,captionOverride:c}=e;const u=(0,a().tz)(),p=(0,i().K8)((()=>n(351360).default.state.currentSpaceStore),[]),m=(0,i().K8)((()=>(0,s().Pf)({groupName:t.value.name,intl:u})),[t,u]),g=(0,i().K8)((()=>{if(p&&t.value.icon)return{pointer:{table:p.table,id:p.id},icon:t.value.icon}}),[p,t]),f=(0,i().K8)((()=>(0,s().xQ)({groupId:t.value.group_id})),[t]),h=(0,n(401497).IS)((()=>({container:(0,n(623275).sH)({isRedesignEnabled:o,isMobile:d}),titleContainer:{display:"flex",alignItems:"center",paddingTop:o?void 0:8,paddingBottom:o?void 0:8,marginLeft:o?void 0:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[d,o]);return(0,l.jsxs)("div",{style:h.titleContainer,children:[(0,l.jsx)(n(946928).A,{groupIcon:null==g?void 0:g.icon,isRedesignEnabled:o,spaceId:t.value.space_id}),(0,l.jsxs)("div",{style:h.groupInfoContainer,children:[(0,l.jsxs)("div",{style:h.nameAndIconContainer,children:[(0,l.jsx)(r().A,{style:h.groupNameLabel,children:m}),!o&&Boolean(null==g?void 0:g.icon)&&(0,l.jsx)(n(614505).A,{disabled:!0,bucket:"public",title:m,icon:g,size:18,isEmptyPage:!1})]}),(0,l.jsx)(r().A,{isSmall:!0,style:h.groupMembersLabel,children:c||(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,l.jsx)(a().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:f}})]})})]})]})}const c=o.memo(d)},780243:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(919709),l=()=>n(959013),d=()=>n(21869),c=()=>n(501666),u=()=>n(792002),p=()=>n(711319),m=()=>n(24157),g=()=>n(704152),f=()=>n(35392),h=()=>n(859428),y=n(474848);function v(e){const t=(0,r().DP)(),n=(0,i().v3)(),v=(0,a().K8)((()=>(0,u().B1)(s().Ifu.Link)),[]),b=(0,a().K8)((()=>function(e){if(e)return!0;if("editing"!==m().default.state.mode&&!p().A.state.open)return!0;if((0,u().y_)(s().Ifu.User)||(0,u().y_)(s().Ifu.Bot)||(0,u().y_)(s().Ifu.Date)||(0,u().y_)(s().Ifu.Page)||(0,u().y_)(s().Ifu.Group))return!0;return!1}(e.disabled)),[e.disabled]);return(0,y.jsx)(h().A,{renderTooltip:()=>(0,y.jsxs)(o.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l().sA,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(f().A,{style:{color:t.text.contrastSecondary},name:"openLinkMenuOrOpenSearch"})})]}),render:o=>(0,y.jsx)(g().A,{style:{display:"flex",alignItems:"center",borderRadius:6,paddingLeft:7,paddingRight:6,...v&&{color:t.blueColor},whiteSpace:"nowrap",...e.style},disabled:b,disabledFeedback:b,...o,onClick:()=>function(e){c().fi({type:"focusOnly",focus:!0}),(0,d().s)(e,{action:s().Ifu.Link})}(n),children:e.children})})}},782473:(e,t,n)=>{n.d(t,{Nu:()=>r,Sw:()=>o,gO:()=>i,j$:()=>a});const o=220,i=24,a=-7,r=-3},788941:(e,t,n)=>{n.d(t,{b:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("pinFilled",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},794831:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(919709),s=()=>n(496603),l=()=>n(6027),d=()=>n(508496),c=()=>n(24157);function u(e){const{store:t}=e;return function(e){const t=(0,i().v3)(),[n,u]=(0,o.useState)("uninitialized"),[p,m,g,f,h]=(0,a().K8)((()=>{var n,o;return e.pathIsDead()||"on"!==d().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),r().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(o=e.getCover())||void 0===o?void 0:o.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,o.useEffect)((()=>{"storeReady"===n?u("generateImage"):p&&u("storeReady")}),[p,m,g,f,h]);const y=(0,o.useMemo)((()=>(0,s().sg)((()=>{u("storeReady"),l().F({environment:t,store:e})}),5e3)),[t,e]);(0,a().K8)((()=>{"generateImage"===n&&(c().default.state,y())}),[n,y])}(t),null}},795750:(e,t,n)=>{n.d(t,{C:()=>_});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(543906),s=()=>n(297872),l=()=>n(957986),d=()=>n(404141),c=()=>n(465425),u=()=>n(51367),p=()=>n(131448),m=()=>n(401497),g=n(474848);const f={viewBox:"0 0 16 16",svg:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("path",{d:"M6.898 5.025a.575.575 0 1 0 0 1.15h2.114l-3.969 3.968a.575.575 0 0 0 .814.814l3.968-3.969v2.114a.575.575 0 0 0 1.15 0V5.6a.575.575 0 0 0-.575-.575z"}),(0,g.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},h=(0,n(340498).wt)("arrowUpRightSquareSmall",f);var y=()=>n(84817),v=()=>n(313633),b=()=>n(296798),x=()=>n(8980),S=()=>n(554509),M=()=>n(204063);const A=480,C=16/9,w=16;function j(e){const{heroMedia:t,heroElement:n,width:o}=e,i=(0,m().IS)((()=>({heroContainer:{width:o,marginLeft:-w,marginTop:-w,...t?{position:"relative",aspectRatio:C,overflow:"hidden"}:{}}})),[t,o]);return(0,g.jsx)("div",{style:i.heroContainer,children:t?(0,g.jsx)(k,{src:t.src,alt:t.alt,type:t.type}):n})}function k(e){const{alt:t,src:n,type:o}=e,i=(0,m().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===o?(0,g.jsx)("img",{src:n,style:i.media,alt:t}):(0,g.jsx)("video",{title:t,src:n,style:i.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function I(e){const{title:t,body:n,badge:o}=e,i=(0,m().IS)((e=>({container:{paddingRight:8,paddingBottom:12,paddingLeft:8,paddingTop:24},body:{maxWidth:380}})),[]);return(0,g.jsxs)(y().Y1,{style:i.container,gap:4,children:[(0,g.jsxs)(y().Y1,{direction:"horizontal",align:"center-left",width:"hug",gap:8,children:[(0,g.jsx)(S().D,{styleName:"UITitle-26px/Bold",colorName:"primary",children:t}),o]}),(0,g.jsx)(S().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",customStyles:i.body,children:n})]})}function T(e){const{link:t,secondary:n,primary:o}=e,i=(0,m().IS)((e=>({container:{marginTop:16,height:40},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",display:"flex",alignItems:"center",gap:2},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"}})),[]);let a=(0,g.jsx)("div",{});t&&(a=(0,g.jsxs)(b().A,{onClick:t.onClick,style:i.link,external:t.external,children:[(0,g.jsx)(S().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:t.text}),t.external?(0,g.jsx)(x().I,{icon:h,size:"sm",color:"secondary"}):void 0]}));const r=n?(0,g.jsx)(b().A,{onClick:n.onClick,style:i.secondary,external:n.external,children:(0,g.jsx)(S().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n.text})}):void 0,s=o?(0,g.jsx)(M().A,{color:"black",size:"lg",onClick:o.onClick,children:o.text}):void 0;return(0,g.jsxs)(y().Y1,{style:i.container,direction:"horizontal",align:"center",gap:"auto",children:[a,(0,g.jsxs)(y().Y1,{direction:"horizontal",gap:8,align:"center",width:"hug",children:[r,s]})]})}function P(e){const{title:t,body:n,badge:o,heroMedia:i,heroElement:a,primary:r,secondary:s,link:l,onDismiss:d,width:c}=e,u=c||A,p=(0,m().IS)((e=>({container:{width:u,padding:w,position:"relative",backgroundColor:e.surface.wash}})),[u]);return(0,g.jsxs)(y().Y1,{style:p.container,direction:"vertical",children:[i||a?(0,g.jsx)(j,{heroMedia:i,heroElement:a,width:u}):void 0,(0,g.jsx)(I,{title:t,body:n,badge:o}),(0,g.jsx)(T,{primary:r,secondary:s,link:l}),(0,g.jsx)(v().A,{onClick:d})]})}function _(e){const{message:t}=e,n=(0,i().v3)(),m=(0,a().K8)((()=>!d().A.state.open&&!n.device.isMobile),[n]),f=(0,a().K8)((()=>m&&p().default.isVisible(t.key)),[t,m]);(0,r().A)((()=>{u().DL(n,{callout_key:t.key,placement_key:"Modal"})}),f);const h=(0,o.useCallback)((()=>{u().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),c().OX(n,t)}),[n,t]),y=(0,o.useCallback)(((e,o)=>()=>{u().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==o||o()}),[n,t]);let v;var b;e.primary&&(v={...e.primary,onClick:y("primary_cta",null===(b=e.primary)||void 0===b?void 0:b.onClick)});let x;var S;e.secondary&&(x={...e.secondary,onClick:y("secondary_cta",null===(S=e.secondary)||void 0===S?void 0:S.onClick)});let M;var A;e.link&&(M={...e.link,onClick:y("learn_more",null===(A=e.link)||void 0===A?void 0:A.onClick)});return f?(0,g.jsx)(l().A,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:h,render:()=>(0,g.jsx)(s().A,{capture:!0,allowEsc:!0,render:()=>(0,g.jsx)(P,{...e,onDismiss:h,primary:v,secondary:x,link:M})})}):null}},807926:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},814429:(e,t,n)=>{n.d(t,{A:()=>S});var o=n(296540),i=()=>n(56366),a=()=>n(401497),r=()=>n(148307),s=()=>n(831310),l=()=>n(798880),d=()=>n(100622),c=()=>n(534177),u=()=>n(704152),p=()=>n(854672),m=()=>n(619338),g=()=>n(870092),f=()=>n(623275),h=()=>n(623742),y=n(474848);function v(e,t){let{store:o,isInvited:i,isRedesignEnabled:r,disabled:s,spaceVisibleUserMap:l,inviteTarget:d,id:c,focused:u,onClick:p,onAuxClick:m,onMouseEnter:g,role:h,disallowTabbing:v,ignoreLocalHoverState:S,isMobile:M}=e;const A=(0,a().IS)((()=>({container:(0,f().sH)({isRedesignEnabled:r,isMobile:M})})),[M,r]);return(0,y.jsx)(n(760217).A,{ref:t,buttonStyle:A.container,title:"group"===d.type?(0,y.jsx)(n(779496).A,{inviteTarget:d,isRedesignEnabled:r,isMobile:M}):(0,y.jsx)(b,{store:o,inviteTarget:d,isRedesignEnabled:r,spaceVisibleUserMap:l,isMobile:M}),disabled:s,right:!s&&(0,y.jsx)(x,{onClick:p,checked:i,isRedesignEnabled:r}),id:c,focused:u,onClick:p,onAuxClick:m,onMouseEnter:g,role:h,disallowTabbing:v,ignoreLocalHoverState:S})}function b(e){let{store:t,inviteTarget:n,isRedesignEnabled:s,isMobile:d,spaceVisibleUserMap:u}=e;const v=(0,i().K8)((()=>"existingUser"===n.type?(0,m().p)({spaceVisibleUserMap:u,userId:n.value.id,store:t}):void 0),[n,u,t]),b=(0,o.useMemo)((()=>"existingUser"===n.type?{actorStore:g().L.createChildStore(t,{table:l().oo,id:n.value.id}),avatar:void 0}:"newUser"===n.type?{actorStore:void 0,avatar:{email:n.value.email,..."slack"===n.source||"google"===n.source?{name:n.value.name,avatarUrl:n.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,c().HB)(n)),[n,t]),x=(0,a().IS)((()=>({container:(0,f().sH)({isRedesignEnabled:s,isMobile:d}),cellMemberAvatarContainer:s?{}:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[d,s]);return(0,y.jsx)(h().A,{isLarge:!0,...b,containerStyle:x.cellMemberAvatarContainer,avatarBadge:(()=>{const e=(()=>{if("newUser"!==n.type)return null;switch(n.source){case"slack":return r().A.images.externalIntegrations.slackIconPng;case"google":return r().A.images.externalIntegrations.googleGIconPng;default:return null}})();return e?(0,y.jsx)(p().A,{type:"image_url",imageURL:e,size:18,style:x.iconBox,imageStyle:x.iconBoxImage}):null})(),spaceRole:v})}function x(e){const{checked:t,isRedesignEnabled:n}=e,o=(0,a().IS)((e=>{const o=o=>{if(!n)return t?{background:d().Ay.blue,borderColor:d().Ay.blue}:{background:"transparent",borderColor:e.buttonPressedBackground};switch(o){case"default":return{background:t?e.checkboxBackground:"transparent",borderColor:t?e.checkboxBackground:e.icon.tertiary};case"hovered":return{background:t?e.checkboxHoveredBackground:e.uncheckedCheckboxHoveredBackground,borderColor:t?e.checkboxHoveredBackground:e.icon.tertiary};case"pressed":return{background:t?e.checkboxPressedBackground:e.uncheckedCheckboxPressedBackground,borderColor:t?e.checkboxPressedBackground:e.icon.tertiary};default:return(0,c().ub)(o),{}}};return{circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:n?18:22,height:n?18:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,...o("default"),marginRight:6},hovered:o("hovered"),pressed:o("pressed"),checkIcon:{height:n?9:12,width:n?9:12,color:"white"}}}),[t,n]);return(0,y.jsx)(u().A,{onClick:e.onClick,style:o.circleCheckmark,hoveredStyle:o.hovered,pressedStyle:o.pressed,children:t&&(0,s().o)(o.checkIcon)})}const S=o.memo(o.forwardRef(v))},816013:(e,t,n)=>{n.d(t,{r:()=>o});const o=n(757695).default.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},819493:(e,t,n)=>{n.d(t,{$:()=>M,b:()=>A});n(898992),n(908872),n(296540);var o=()=>n(662303),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(764880),l=()=>n(869190),d=()=>n(959013),c=()=>n(777092),u=()=>n(921855),p=()=>n(972435),m=()=>n(963589),g=()=>n(962730),f=()=>n(706965),h=()=>n(678553),y=()=>n(89924),v=()=>n(859428),b=()=>n(125565),x=()=>n(715011),S=n(474848);function M(e){let{isPageMoreButton:t,hideTopBorder:n,store:o,wordCountStores:l,showWordCount:c}=e;const u=(0,a().K8)((()=>A(o)),[o]),{device:m}=(0,i().v3)(),M=(0,a().K8)((()=>m.isPhone),[m]),w=p().A.getIntl(),j=(0,r().IS)((()=>({menuItem:{paddingTop:M?8:n?0:6,paddingBottom:M?8:16}})),[n,M]);return u&&!u.canAccess?null:(0,S.jsx)(y().A,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,S.jsx)(h().A,{style:u?void 0:j.menuItem,shouldWrapTitle:!0,title:u?(0,S.jsx)(v().A,{placement:g().W.Right,render:e=>(0,S.jsxs)("div",{...e,children:[c&&(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,S.jsx)(d().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,S.jsx)(x().A,{store:o})}})}),l&&(0,S.jsx)(C,{stores:l}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,s().lR)(w,u.lastEditedBy):void 0}})}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,style:{marginBottom:c?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,S.jsx)(f().A,{store:o,compactFormat:!0})}):void 0,loading:!u})})}function A(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),a=e.getLastEditedTime(),r=p().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&a&&i){const s=(0,c().vt)({parentStore:e,pointer:t}),d=(0,l().jE)(n,o().locale,r),u=(0,c().vt)({parentStore:e,pointer:i}),p=(0,l().jE)(a,o().locale,r);if(!u)return;return{canAccess:!0,createdBy:s,createdTime:d,lastEditedBy:u,lastEditedTime:p}}}function C(e){const{stores:t}=e,n=(0,m().X)("selectable_word_count"),o=(0,a().K8)((()=>n?w(t):0),[n,t]);return n?(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:o}})}):null}function w(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+w(t.getContentStores())}),0)}},832820:(e,t,n)=>{n.d(t,{D:()=>i,c:()=>o});const o=n(757695).default.createValue(void 0,{name:"CachedTypedDatabasesStore"});function i(e){const t=o.state;t&&o.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},840071:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var o=()=>n(84817),i=()=>n(577466),a=()=>n(434663),r=n(474848);function s(e){let{backgroundColor:t,iconGroup:n,children:s,errorId:l}=e;const d=(0,i().B)(t),c={wrapper:{...d.wrapper,background:t?d.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,r.jsx)(o().Y1,{style:c.wrapper,align:"center",children:(0,r.jsx)(a().r,{direction:"vertical",iconGroup:n,overrideSize:()=>48,errorId:l,children:s})})}},841224:(e,t,n)=>{n.d(t,{Q:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("language",{viewBox:"0 0 64 64",svg:(0,o.jsx)("path",{d:"m20,19.24l2.16,5.76h-4.32l2.16-5.76Zm5.95,4.62c2.49-3.27,6.07-5.64,10.5-6.87-2.61-5.68-8.42-8.99-16.45-8.99C8.89,8,2,14.32,2,24.5c0,5.19,1.8,9.37,5.03,12.22l-5.03,5.03,1.5,2.25c4.06,0,7.8-1.36,10.81-3.63,1.74.41,3.64.63,5.69.63.82,0,1.61-.05,2.39-.11-.25-1.39-.39-2.85-.39-4.39,0-2.73.43-5.23,1.22-7.5h-6.88l-1.12,3h-4.22l6-16h6l2.95,7.86Zm18.05,13.46c.99-.9,1.84-1.99,2.4-3.32h-4.79c.56,1.33,1.41,2.42,2.4,3.32Zm12.97,11.4l5.03,5.03-1.5,2.25c-4.06,0-7.8-1.36-10.81-3.63-1.74.41-3.64.63-5.69.63-11.11,0-18-6.32-18-16.5s6.89-16.5,18-16.5,18,6.32,18,16.5c0,5.19-1.8,9.37-5.03,12.22Zm-3.97-18.72h-7v-3h-4v3h-7v4h2.49c.58,1.97,1.68,3.86,3.22,5.52-2.76,1.36-5.38,1.74-5.38,1.74l1.4,3.75c2.78-.5,5.21-1.48,7.26-2.78,2.05,1.3,4.49,2.29,7.26,2.78l1.4-3.75s-2.62-.38-5.38-1.74c1.55-1.66,2.64-3.55,3.22-5.52h2.49v-4Z"})})},867159:(e,t,n)=>{n.d(t,{J8:()=>g,kS:()=>m,p7:()=>p});n(296540);var o=()=>n(484714),i=()=>n(401497),a=()=>n(668725),r=()=>n(959013),s=()=>n(493823),l=()=>n(406699),d=()=>n(74263),c=()=>n(26517),u=n(474848);function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().vG[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().Bb[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().qg,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().PP[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const t=(0,o().Y0)(),{buttonPopupStore:n,currentVisibilityLabel:r,renderVisibilityLevelsMenu:d,disabled:c}=e,p=t.isMobile?l().z7.SlideUp:l().z7.Popup,m=(0,i().IS)((e=>({chevronDownIcon:{width:10,marginLeft:4,marginRight:4,fill:e.lightIconColor},currentVisibilityLabel:{color:e.mediumTextColor,paddingRight:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().Ay,{popupType:p,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(s().p,{style:m.currentVisibilityLabel,disabled:c,...e,children:[r,(0,a().b)(m.chevronDownIcon)]}),render:d})}},869120:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>L});var o=n(296540),i=()=>n(662303),a=()=>n(484714),r=()=>n(56366),s=()=>n(401497),l=()=>n(237829),d=()=>n(233842),c=()=>n(262462),u=()=>n(959013),p=()=>n(284371),m=()=>n(40970),g=()=>n(755636),f=()=>n(633457),h=()=>n(802790),y=()=>n(296798),v=()=>n(204063),b=()=>n(125565),x=()=>n(687039),S=()=>n(780054),M=()=>n(581495),A=()=>n(836251),C=()=>n(465425),w=()=>n(51367),j=()=>n(218429),k=()=>n(351360),I=()=>n(865241),T=()=>n(645200),P=()=>n(694498),_=()=>n(19606),B=n(474848);function L(){const e=(0,a().v3)(),t=(0,s().IS)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:p().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.mediumTextColor,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.mediumTextColor},successTitle:{fontSize:25,fontWeight:p().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:p().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,o.useEffect)((()=>{const t=()=>{I().A.state.isVisible&&P().A.state.isConnectingCalendar&&(P().A.setState({isConnectingCalendar:!1}),f().oX({environment:e}))};return I().A.addListener(t),()=>{I().A.removeListener(t)}}),[e]);const n=(0,r().K8)((()=>P().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),L=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=k().default.state;t&&(w().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),C().a(e,"notion_calendar_launch_promo"),T().MR({environment:e,userSettingsStore:t}),P().A.setState({signupCtaAttribution:void 0}))}),[e]),D=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=k().default.state;t&&n&&(w().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),C().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),O=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=k().default.state;t&&n&&(w().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&C().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),N=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=k().default.state;t&&(w().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),C().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),E=(0,r().K8)((()=>k().default.state.currentUserSettingsStore),[]),F=(0,r().K8)((()=>{const e=null==E?void 0:E.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[E]),U=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M().Rz,{onClick:L}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.successCheckmark,children:(0,l().X)(t.successCheckmarkIcon)}),(0,B.jsx)("div",{style:t.successTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,B.jsxs)("div",{style:t.downloadContainer,children:[(0,B.jsxs)("div",{style:t.downloadContent,children:[(0,B.jsx)("div",{style:t.downloadTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,B.jsx)("div",{style:t.downloadButtonContainer,children:(0,B.jsx)(v().A,{style:t.downloadButton,onClick:()=>{m().Lt(e,{cta:"download"}),g().f({environment:e,url:S().A.calendar.downloadUrl}),N()},children:(0,B.jsx)(u().sA,{..._().z.downloadApp})})})]}),(0,B.jsx)("div",{style:t.notionCalendarLogo,children:(0,d().u)(t.notionCalendarLogoIcon)})]})]})]}),V=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(x().A,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:x().V[i().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,B.jsx)(M().Rz,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:L}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.title,children:(0,B.jsx)(u().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,B.jsxs)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,B.jsx)(u().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,B.jsx)(h().A,{size:1,style:t.divider}),(0,B.jsxs)("div",{style:t.footer,children:[(0,B.jsxs)(y().A,{external:!0,href:(0,A().xS)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,B.jsx)(u().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,c().M)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]}),(0,B.jsx)(_().A,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{m().be(e,{cta:"open_calendar"}),D()},onGetNotionCalendarClick:()=>{m().be(e,{cta:"get_calendar"}),O()},onDownloadClick:()=>{m().be(e,{cta:"download"}),N()}})]})]});return(0,B.jsx)(j().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,B.jsx)(R,{launchModalPhase:F,renderChild:()=>"connected_notion_calendar"===F?U():V()}),desktopInnerStyle:t.container,desktopOnDismiss:L,phoneRenderInner:()=>null})}function R(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,a().v3)();return(0,o.useEffect)((()=>{"connected_notion_calendar"===t?m().Y8(i):m().aq(i)}),[i,t]),n()}},910702:(e,t,n)=>{n.d(t,{zk:()=>w,wm:()=>A,Js:()=>k,H0:()=>T,hk:()=>P});n(296540);var o=()=>n(3284),i=()=>n(919709),a=()=>n(959013),r=()=>n(317909),s=()=>n(67103),l=()=>n(401497),d=()=>n(553965),c=()=>n(962730),u=()=>n(575143),p=()=>n(515918),m=()=>n(859428),g=n(474848);function f(e){let{menuListItemProps:t,title:n,caption:o,icon:i,disabled:a,tooltipText:r,showNewBadge:s}=e;const f=(0,l().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(m().A,{placement:c().W.Right,disableTooltip:!r,renderTooltip:()=>r,render:e=>(0,g.jsx)(u().A,{...(0,d().A)(t,e),style:f.menuItem,title:n,caption:o,captionStyle:o?f.caption:void 0,svg:i,disabled:a,disabledFeedback:a,right:s&&(0,g.jsx)(p().A,{})})})}var h=()=>n(878377),y=()=>n(37433),v=()=>n(10984),b=()=>n(416726),x=()=>n(843005);const S=(0,a().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function M(e,t){return(0,b().Ls)({key:"turn page into team",displayName:t,analyticsName:S.createTeamFromPageFullName.defaultMessage,svg:o().Q,validators:e,closeParentMenu:!0,render:(e,o)=>{const r=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===i().q4_(t.getTitleValue()).length)return(0,g.jsx)(a().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,y().fm)(t).accessLevel&&!(0,v().HO)())return(0,g.jsx)(a().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:o.environment,blockStore:o.blocks[0]});return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(a().sA,{...t}),caption:(0,g.jsx)(a().sA,{...S.createTeamFromPageCaption}),disabled:Boolean(r),tooltipText:r,icon:n(234748).I})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];n(475355).Vs({environment:o,page:i})}})}const A=M([h().Uo6([h().w2Y,h().AU6(h().d2I)])],S.createTeamFromPageFullName),C=M([h().w2Y],S.createTeamFromPageName),w=(0,b().uk)({key:"turn into teamspace or wiki",displayName:x().DZ.turnIntoSection,analyticsName:x().DZ.turnIntoSection.defaultMessage,svg:o().Q,validators:[h().w2Y,h().d2I],subActions:()=>[(0,b().gy)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(89924).A,{...e}),actions:[C,I]})],width:300});function j(e,t){return(0,b().Ls)({key:"turn page into wiki",displayName:t,analyticsName:S.turnPageIntoWikiFullName.defaultMessage,svg:o().Q,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;"bottom_right"===n(508496).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(816013).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:o[0]}):r().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{s().hJ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})},render:e=>(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(a().sA,{...t}),disabled:!1,icon:o().Q,tooltipText:(0,g.jsx)(a().sA,{...S.turnPageIntoWikiCaption})})})}const k=j([h().Uo6([h().d2I,h().AU6(h().w2Y)]),h().AU6(h().oy3)],S.turnPageIntoWikiFullName),I=j([h().d2I],S.turnPageIntoWikiName);const T=j([h().d2I,h().AU6(h().oy3)],S.turnPageIntoWikiFullName),P=(0,b().Ls)({key:"undo turn page into wiki",displayName:S.undoTurnPageIntoWikiName,analyticsName:S.undoTurnPageIntoWikiName.defaultMessage,svg:n(454503).D,validators:[h().vXb,h().VNy,h().AU6(h().ln6),h().Afv,h().Km9,h().AU6(h().oy3)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:o}=e;const{accept:l}=await n(901389).Gh({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a().sA,{defaultMessage:'Turn "{pageName}" back into a normal page?',id:"action.undoTurnIntoWiki.message",values:{pageName:i().q4_(o[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});l&&r().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{s().nQ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})}})},916833:(e,t,n)=>{n.d(t,{z:()=>o});const o=(0,n(340498).xh)("arrowUpCircled",{default:{loader:()=>n.e(32296).then(n.bind(n,632296))},small:{loader:()=>n.e(25406).then(n.bind(n,825406))},mini:{loader:()=>n.e(50086).then(n.bind(n,850086))},large:{loader:()=>n.e(73718).then(n.bind(n,73718))}})},928421:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>zo});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(959013),l=()=>n(778417),d=()=>n(725614),c=()=>n(805751),u=()=>n(928600),p=()=>n(45552),m=()=>n(125565),g=()=>n(64901),f=()=>n(38337),h=()=>n(722872),y=()=>n(836251),v=()=>n(645873),b=()=>n(58293),x=()=>n(646736),S=()=>n(284371),M=()=>n(987017),A=()=>n(115512),C=()=>n(641212),w=()=>n(219249),j=()=>n(463830),k=n(474848);function I(e){const{store:t,calculatedPermissions:n,permissionItemArgs:o,onClose:l}=e,d=(0,i().Y0)(),g=(0,a().K8)((()=>d.isMobile),[d.isMobile]),y=function(e){return(0,r().IS)((t=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:e?t.surface.page:void 0}})),[e])}(g),v=(0,a().uB)(void 0,j().A),b=d.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:(0,k.jsx)(m().A,{isMobile:d.isMobile,style:y.title,children:(0,k.jsx)(s().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:y.topbarStyle,right:(0,k.jsx)(p().DoneMenuText,{}),onClickRight:l,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return(0,k.jsx)(u().A,{...b,className:f().NXe,children:(0,k.jsx)(c().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,k.jsx)(T,{store:t,isMobile:g,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:v})})})}function T(e){let{store:t,isMobile:n,calculatedPermissions:a,permissionItemArgs:c,buttonPopupStore:u}=e;const p=(0,i().v3)(),m=function(e){const t=(0,i().v3)();return(0,r().IS)((n=>({tabStyle:{color:n.lightTextColor,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:S().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:(0,A().ny)(t,"UIRegular"),fontWeight:S().Wy.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[t,e])}(n),g=[(0,k.jsx)(o.Fragment,{children:(0,k.jsx)(s().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:p}),d().clear({preventDismissMobileKeyboard:!0,environment:p})}),[p]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(M().Ay,{...m,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,k.jsx)(w().T5,{store:t,calculatedPermissions:a,permissionItemArgs:c}),(0,k.jsx)(C().A,{store:t,buttonPopupStore:u,calculatedPermissions:a,permissionItemArgs:c})]})}var P=()=>n(326589),_=()=>n(315841),B=()=>n(159026),L=()=>n(103674),R=()=>n(726360),D=()=>n(663590),O=()=>n(928074),N=()=>n(437487),E=()=>n(134696),F=()=>n(495867),U=()=>n(437622),V=()=>n(534177),K=()=>n(440209),z=()=>n(475355);async function W(e,t,n,o,i){if(i.state.inviteStage===B().d5.closed||i.state.inviteStage===B().d5.share_page)return;const{selection:a}=i.state;switch(a){case B().NJ.request_workspace_member:E().RH(e,{...F().nE(e,i),from:"share_menu"}),await F().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:o});break;case B().NJ.workspace_member:E()._u(e,F().nE(e,i));const r=(0,U().s7)(e),s=!(0,K().Um)({environment:e,isUserWorkspaceOwner:r})||i.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&s){i.setState({...i.state,inviteStage:B().d5.closed});if(!(await z().oH({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await F().Lg({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:o});break;case B().NJ.page_guest:case B().NJ.unselected:case B().NJ.closed:E().l8(e,F().nE(e,i)),i.reset();break;default:(0,V().HB)(a)}}n(581454);var H=()=>n(449552),G=()=>n(926401),Y=()=>n(234194),q=()=>n(792071),Q=()=>n(798880),$=()=>n(84817),Z=()=>n(554509),J=()=>n(864943),X=()=>n(581495),ee=()=>n(305837),te=()=>n(453697);function ne(e){let{users:t}=e;const n=(0,r().IS)((e=>({avatarsContainer:{marginLeft:"16px",display:"flex"},avatarWrapper:{marginLeft:"-16px"},upgradeWrapper:{alignSelf:"end",marginLeft:"-14px",borderRadius:"50%",background:e.surface.wash},upgradeIcon:{height:16,width:16,fill:e.icon.uiBluePrimary}})),[]);return(0,k.jsxs)("div",{style:n.avatarsContainer,children:[t.slice(0,10).map(((e,t)=>(0,k.jsx)("div",{style:n.avatarWrapper,children:(0,k.jsx)(te().A,{userValue:e,size:40})},t))),(0,k.jsx)("div",{style:n.upgradeWrapper,children:(0,ee().H)(n.upgradeIcon)})]})}function oe(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:o,blockStore:l,paysPerSeat:d}=e,c=(0,i().v3)(),u=(0,s().tz)(),p=(0,a().K8)((()=>o.state.inviteStage===B().d5.request_workspace),[o]),m=(0,a().K8)((()=>t.map((e=>{const t=o.state.invitedEmailToUserIdMap[e];return q().Bj6.fromValue(Q().oo,{id:t,email:e,version:1})}))),[o,t]),g=(0,r().IS)((e=>({icon:{width:16,height:16,fill:e.icon.secondary},cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,k.jsxs)("div",{className:f().NXe,children:[(0,k.jsx)(X().Rz,{onClick:()=>o.reset()}),(0,k.jsxs)($().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,k.jsxs)($().Y1,{gap:20,children:[(0,k.jsx)("div",{style:g.facepileContainer,children:(0,k.jsx)(ne,{users:m})}),(0,k.jsxs)($().Y1,{gap:8,children:[(0,k.jsx)(Z().D,{styleName:"Heading-17px/Semibold",children:(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,k.jsxs)($().Y1,{gap:20,children:[(0,k.jsx)(Z().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:d?p?(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,k.jsxs)($().Y1,{gap:14,children:[(0,k.jsxs)($().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,H().g)(g.icon),(0,k.jsx)(Z().D,{styleName:"UIRegular-14px/Regular",children:(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,k.jsxs)($().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,G().n)(g.icon),(0,k.jsx)(Z().D,{styleName:"UIRegular-14px/Regular",children:(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,k.jsxs)($().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,Y().M)(g.icon),(0,k.jsx)(Z().D,{styleName:"UIRegular-14px/Regular",children:(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,k.jsxs)($().Y1,{direction:"horizontal",gap:10,children:[(0,k.jsx)(J().A,{size:"lg",style:g.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:B().NJ.page_guest})}(o),await W(c,n,l,u,o)},children:(0,k.jsx)(s().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,k.jsx)(J().A,{size:"lg",style:g.cta,onClick:async()=>{o.state.inviteStage===B().d5.share_workspace&&function(e){e.setState({...e.state,selection:B().NJ.workspace_member})}(o),o.state.inviteStage===B().d5.request_workspace&&function(e){e.setState({...e.state,selection:B().NJ.request_workspace_member})}(o),await W(c,n,l,u,o)},children:p?(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,k.jsx)(s().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function ie(e){const{spaceStore:t,blockStore:o}=e,r=(0,i().v3)(),s=(0,n(714300).l)({spaceId:t.id}),l=(0,a().K8)((()=>(0,n(37433).L3)(r,s)),[r,s]),d=(0,a().uB)(e.contextualInviteStore,B().Ay),c=n(762433).OK(s),u=(0,a().K8)((()=>d.getGuestEmails()),[d]),p=(0,a().K8)((()=>(0,U().hN)(t)),[t]);return(0,n(852507).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:B().NJ.page_guest})}(d,l),E().bT(r,F().nE(r,d))})),u.length?(0,k.jsx)(oe,{contextualInviteStore:d,spaceStore:t,blockStore:o,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:p}):null}const ae=o.memo(ie);var re=()=>n(340498);const se=(0,re().wt)("wifiSlash",{viewBox:"0 0 32 32",svg:(0,k.jsx)("path",{d:"M5.33984 5.32812L8.04688 8.04688C6.17969 8.8125 4.50781 9.97656 3.03125 11.5391C2.90625 11.6719 2.75781 11.7422 2.58594 11.75C2.42188 11.75 2.27734 11.6836 2.15234 11.5508L0.5 9.89844C0.390625 9.78125 0.332031 9.65625 0.324219 9.52344C0.324219 9.38281 0.371094 9.25391 0.464844 9.13672C1.08984 8.39453 1.8125 7.70312 2.63281 7.0625C3.46094 6.41406 4.36328 5.83594 5.33984 5.32812ZM13.6719 6.91016L10.3203 3.54688C10.9688 3.42187 11.5938 3.32812 12.1953 3.26562C12.8047 3.20313 13.4023 3.17188 13.9883 3.17188C15.8086 3.17188 17.5703 3.42969 19.2734 3.94531C20.9844 4.46094 22.5469 5.17188 23.9609 6.07812C25.375 6.97656 26.5625 7.99609 27.5234 9.13672C27.6172 9.25391 27.6641 9.38281 27.6641 9.52344C27.6641 9.65625 27.6016 9.78125 27.4766 9.89844L25.8359 11.5391C25.7109 11.6719 25.5664 11.7422 25.4023 11.75C25.2383 11.75 25.0977 11.6914 24.9805 11.5742C23.543 10.0898 21.9141 8.94531 20.0938 8.14062C18.2812 7.33594 16.2852 6.91016 14.1055 6.86328C14.0352 6.86328 13.9609 6.86719 13.8828 6.875C13.8125 6.88281 13.7422 6.89453 13.6719 6.91016ZM10.6016 10.5781L13.7773 13.7656C13.0273 13.7812 12.2969 13.9023 11.5859 14.1289C10.875 14.3555 10.207 14.6641 9.58203 15.0547C8.96484 15.4375 8.42188 15.8828 7.95312 16.3906C7.82031 16.5312 7.67188 16.6094 7.50781 16.625C7.34375 16.6328 7.19141 16.5703 7.05078 16.4375L5.21094 14.6328C5.10156 14.5234 5.03906 14.4023 5.02344 14.2695C5.01562 14.1367 5.0625 14.0117 5.16406 13.8945C5.78906 13.1602 6.56641 12.5039 7.49609 11.9258C8.43359 11.3398 9.46875 10.8906 10.6016 10.5781ZM22.0859 15.3242L17.3398 10.5781C18.4492 10.8594 19.4922 11.2969 20.4688 11.8906C21.4453 12.4844 22.2344 13.1523 22.8359 13.8945C22.9219 14.0117 22.9609 14.1367 22.9531 14.2695C22.9531 14.4023 22.8945 14.5234 22.7773 14.6328L22.0859 15.3242ZM14 16.9531C14.8281 16.9531 15.5898 17.1367 16.2852 17.5039C16.9805 17.8711 17.5312 18.3125 17.9375 18.8281C18.0312 18.9453 18.0703 19.0742 18.0547 19.2148C18.0391 19.3555 17.9766 19.4766 17.8672 19.5781L15.0078 22.3438C14.7734 22.5703 14.582 22.7227 14.4336 22.8008C14.293 22.8867 14.1484 22.9297 14 22.9297C13.8594 22.9297 13.7188 22.8867 13.5781 22.8008C13.4375 22.7227 13.2461 22.5703 13.0039 22.3438L10.1328 19.5781C10.0312 19.4844 9.96484 19.3789 9.93359 19.2617C9.91016 19.1367 9.93359 19.0234 10.0039 18.9219C10.4102 18.375 10.9688 17.9102 11.6797 17.5273C12.3906 17.1445 13.1641 16.9531 14 16.9531ZM23.8906 21.7812L4.09766 2C3.91797 1.82812 3.82812 1.60938 3.82812 1.34375C3.82812 1.07812 3.91797 0.855469 4.09766 0.675781C4.26953 0.496094 4.48828 0.410156 4.75391 0.417969C5.01953 0.417969 5.24219 0.507813 5.42188 0.6875L25.2031 20.4688C25.3906 20.6484 25.4844 20.8672 25.4844 21.125C25.4844 21.3828 25.3906 21.6016 25.2031 21.7812C25.0312 21.9609 24.8164 22.0508 24.5586 22.0508C24.3008 22.0508 24.0781 21.9609 23.8906 21.7812Z"})});var le=()=>n(529183),de=()=>n(749240),ce=()=>n(440339),ue=()=>n(962277);function pe(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:o}=e,{permissionItem:i}=n;return(0,a().K8)((()=>(0,ue().W)(i)),[i])?(0,k.jsx)(_().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,k.jsx)(_().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location})}n(898992),n(354520);var me=()=>n(842599),ge=()=>n(196131),fe=()=>n(411387),he=()=>n(545805),ye=()=>n(792223),ve=()=>n(366858),be=()=>n(535279),xe=()=>n(108944),Se=()=>n(963589),Me=()=>n(970585),Ae=()=>n(308227),Ce=()=>n(616092),we=()=>n(597898),je=()=>n(717162),ke=()=>n(623275),Ie=()=>n(43013);var Te=()=>n(343247),Pe=()=>n(529601),_e=()=>n(622963),Be=()=>n(751735),Le=()=>n(920773),Re=()=>n(460292),De=()=>n(364499),Oe=()=>n(404141),Ne=()=>n(805403);function Ee(e){const{spaceId:t,userId:n,spaceModel:o,spaceUserModel:i,teamModel:l,domains:d,blockStore:c}=e,u=(0,s().tz)(),p=(0,we()._X)({name:"internal_guests",spaceId:t,userId:n,amount:1}),m=(0,De().o)({store:c}),g=(0,we().P9)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,r().IS)((e=>{const t=p&&!(0,fe().e2)(p),n=t?20:5,o=t?e.accentColors.orange[100]:"transparent",i=t?e.accentColors.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${o}, ${o} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Be().X4)(e.accentColors.orange[400],.15):(0,Be().X4)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[p]),h=(0,a().K8)((()=>{var e;const t=(0,_e()._y)((null===(e=de().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Ne().qY[t].label}),[]),y=(0,a().K8)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),v=(0,a().K8)((()=>null==i?void 0:i.isMember()),[i]);let b;b=y?"You are a workspace owner":v?"You are a member":"You are a guest";const x=(0,a().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!o&&o.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==o?void 0:o.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=o&&o.getSettings().disable_membership_requests)}]),[o]),S=(0,a().K8)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),M=(0,a().K8)((()=>{if(!o||!d||!i)return;const{autojoinDomains:e}=(0,Pe().SJ)({space:o,spaceUser:i,domains:d});return e}),[o,i,d]),A=(0,a().K8)((()=>{if(!o||!i)return;const{type:e}=(0,Pe().yQ)({space:o,spaceUser:i,team:l,publicPageDataGuestSetting:m});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,V().HB)(e)}}),[o,i,l,m]),C=(0,a().K8)((()=>{if(!o||!d||!i)return;const{type:e}=(0,Pe().SJ)({space:o,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,V().HB)(e)}}),[o,i,d]),w=(0,a().K8)((()=>{if(!o||!i||!d)return!1;return"can_add"===(0,Pe().SJ)({space:o,spaceUser:i,domains:d}).type}),[o,i,d]),j=(0,a().K8)((()=>{if(!p)return;const e=p.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return w?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,V().HB)(e)}}),[p,g,w]),I=(0,a().K8)((()=>{if(!p)return"Guest limit data is unavailable";if("cumulative"===p.limit.type){const{current:e,total:t}=p.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[p]),T=e=>{Oe().A.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,k.jsxs)($().Y1,{gap:10,style:f.container,children:[(0,k.jsxs)($().Y1,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,k.jsx)(Le().p,{onClick:()=>T("security"),style:f.button,children:(0,k.jsxs)($().Y1,{gap:4,children:[(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),x.map(((e,t)=>(0,k.jsxs)($().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,k.jsx)(Fe,{isEnabled:e.isEnabled}),(0,k.jsx)(Z().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,k.jsxs)($().Y1,{gap:4,children:[(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),S.map(((e,t)=>(0,k.jsxs)($().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,k.jsx)(Fe,{isEnabled:e.isEnabled}),(0,k.jsx)(Z().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,k.jsx)(Le().p,{onClick:()=>T("billing"),style:f.button,children:(0,k.jsxs)($().Y1,{gap:4,children:[(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${u.formatMessage(h)} plan`}),(0,k.jsx)(Z().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:I})]})}),(0,k.jsx)(Le().p,{onClick:()=>T("settings"),style:f.button,children:(0,k.jsxs)($().Y1,{gap:4,children:[(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==M?void 0:M.map((e=>(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==M?void 0:M.length)&&(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,k.jsxs)($().Y1,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Medium",children:b}),(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:C}),(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:A}),(0,k.jsx)(Z().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:j})]})]})}function Fe(e){const{isEnabled:t}=e,n=(0,r().IS)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,k.jsx)(Re().Q,{iconGroup:Te().d,variantName:"mini",colorName:"secondary"}):(0,k.jsx)($().Y1,{width:14,height:14,align:"center",children:(0,k.jsx)("div",{style:n.circle})})}var Ue=()=>n(148307),Ve=()=>n(617871);const Ke=(0,re().wt)("squareAndArrowDown",{viewBox:"0 0 20 20",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M6.063 16.817c-.739 0-1.297-.186-1.675-.56-.379-.374-.568-.928-.568-1.661V7.869c0-.729.19-1.28.568-1.654.378-.378.936-.568 1.675-.568h1.866v1.347H6.145c-.32 0-.563.084-.732.253-.164.164-.246.413-.246.745v6.487c0 .333.082.582.246.746.169.168.413.252.732.252h7.704c.314 0 .556-.084.724-.252.173-.165.26-.413.26-.745V7.991c0-.332-.087-.58-.26-.745-.168-.169-.41-.253-.724-.253h-1.77V5.647h1.858c.739 0 1.297.19 1.675.568.379.374.568.925.568 1.654v6.727c0 .729-.19 1.28-.568 1.654-.378.378-.936.567-1.675.567H6.064ZM10 12.387a.715.715 0 0 1-.24-.04.832.832 0 0 1-.245-.171L7.218 9.96a.567.567 0 0 1-.171-.403c0-.16.052-.29.157-.39.11-.1.244-.15.403-.15a.54.54 0 0 1 .424.184l.957 1.019.445.499L9.364 9.7V2.62c0-.168.062-.314.185-.437A.629.629 0 0 1 10 1.997c.173 0 .321.062.444.185a.588.588 0 0 1 .192.437v7.082l-.069 1.019.438-.5.957-1.018a.554.554 0 0 1 .424-.184c.155 0 .287.05.396.15.114.1.171.23.171.39 0 .15-.06.284-.178.403l-2.296 2.215a.758.758 0 0 1-.24.17.715.715 0 0 1-.239.042Z"})})});var ze=()=>n(803557),We=()=>n(449506),He=()=>n(493823),Ge=()=>n(406699),Ye=()=>n(854672),qe=()=>n(2143),Qe=()=>n(748868),$e=()=>n(47373),Ze=()=>n(183804),Je=()=>n(787766),Xe=()=>n(756279),et=()=>n(377586),tt=()=>n(351360),nt=()=>n(53137),ot=()=>n(321172),it=()=>n(456328),at=()=>n(623580);function rt(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:o,maxLength:i}=e,a=(0,r().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,k.jsx)("div",{style:a.container,children:(0,k.jsxs)("div",{style:a.warning,children:[t&&(0,k.jsx)(s().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,k.jsx)(s().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const st=100;function lt(e){const{open:t,focus:n,value:o,maxLength:i,onFocus:a,onChange:l,onCancel:d}=e,c=(0,s().tz)(),u=o.length/i>=.8,p=(0,it().BS)(o),m=u||p,g=(0,r().IS)((e=>({container:{maxHeight:t?st:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,k.jsxs)("div",{style:g.container,children:[m&&(0,k.jsx)(rt,{value:o,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:p}),(0,k.jsx)(at().A,{textarea:!0,focusInitial:!1,format:at().C.Transparent,placeholder:f,maxlength:i,focus:n,value:o,onFocus:a,onChange:l,inputStyle:g.input,onCancel:d})]})}n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),n(803949),n(908872),n(737550);var dt=()=>n(467730),ct=()=>n(122555),ut=()=>n(535845),pt=()=>n(438265),mt=()=>n(97835),gt=()=>n(889154),ft=()=>n(68263),ht=()=>n(179034),yt=()=>n(848538),vt=()=>n(854150),bt=()=>n(701763),xt=()=>n(542056),St=()=>n(760217),Mt=()=>n(939740),At=()=>n(64e3),Ct=()=>n(614505),wt=()=>n(16006),jt=()=>n(89924),kt=()=>n(859428),It=()=>n(747788),Tt=()=>n(267155),Pt=()=>n(553965),_t=()=>n(743260),Bt=()=>n(423657),Lt=()=>n(423817),Rt=()=>n(962730),Dt=()=>n(21735),Ot=()=>n(630116),Nt=()=>n(715392),Et=()=>n(134217),Ft=()=>n(10984),Ut=()=>n(98866),Vt=()=>n(72388),Kt=()=>n(913348),zt=()=>n(984804),Wt=()=>n(328347);function Ht(e){const{publicPermission:t}=e,n=(0,r().IS)((e=>({banner:{...(0,ke().kJ)({theme:e,inheritanceBannerEnabled:!1}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},icon:{height:16,width:16,color:e.icon.secondary},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.text.uiBluePrimary,fontWeight:S().Wy.medium}})),[]),o=t.permissionItem.role;return ft().Tt(o)?(0,k.jsxs)("div",{style:n.banner,children:[(0,k.jsxs)("div",{style:n.content,children:[(0,k.jsx)("div",{style:n.iconContainer,children:(0,Wt().h)(n.icon)}),(0,k.jsx)(m().A,{style:n.label,isMultiline:!0,children:(0,k.jsx)(Gt,{role:o})})]}),(0,k.jsx)(He().p,{size:"sm",style:n.manageButton,onClick:()=>N().Ay.setState({...N().Ay.state,display:N().pP.Publish,tab:N().QC.Publish}),children:(0,k.jsx)(s().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]}):null}function Gt(e){const{role:t}=e;switch(t){case"read_and_write":return(0,k.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,k.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,k.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,V().HB)(t)}}var Yt=()=>n(623742),qt=()=>n(814429),Qt=()=>n(198463),$t=()=>n(851727),Zt=()=>n(304243),Jt=()=>n(560653),Xt=()=>n(99162);function en(e){var t,n;const{store:o,shouldShowSlackOnly:l,shouldShowGoogleOnly:d,calculatedPermissions:c,permissionItemArgs:u,tokenQuery:p,showShimmer:g,error:f,ready:h,result:y}=e,v=(0,i().v3)(),b=(0,a().uB)(e.inviteTargetsStore,le().Ay),x=(0,a().K8)((()=>N().Ay.state.display===N().pP.Invite&&N().Ay.state.focus&&"message"===N().Ay.state.focus),[]),S=(0,a().uB)(e.menuListStore,Me().A),M=(0,Ut().x)(),A=(0,a().K8)((()=>$e().YA()),[]),C=(0,a().K8)((()=>(0,D().FI)()),[]),w=(0,r().IS)((e=>({sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingLeft:8,paddingRight:8,paddingBottom:8},keepTypingMessage:{paddingLeft:ke().rL,paddingRight:ke().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginTop:2,color:e.icon.tertiary}})),[]),j=(0,a().K8)((()=>o.getSpaceId()),[o]),I=(0,Vt().V)(j,(null==y?void 0:y.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)))??[]),T=c.pagePermissionUIModel,{inPageTargets:P,notInPageTargets:_,filteredImportedContacts:B}=(0,a().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[]}=y??{inviteUsers:[],inviteGroups:[],importedContacts:[]},i=[...e,...t],a=[],r=[],s=new Set;i.forEach((e=>{"group"!==e.type&&s.add(e.value.email.toLowerCase());const t=Boolean(_t().wF({store:o,target:e}));if("existingUser"===e.type&&!Boolean(e.spaceRole)){let t;if(Dt().A.state.shouldUseEdgeCache){var n;const i=null===(n=Nt().W.getData(v,{userId:e.value.id,spaceId:o.getSpaceId()}))||void 0===n?void 0:n.membership_type;t=i?(0,yt().$N)(i):void 0}else{var i;t=null===(i=M.get(e.value.id))||void 0===i?void 0:i.role}e.spaceRole=t||"not_in_space"}const l=(0,O().NV)({inviteTarget:e,store:o,calculatedPermissions:c,isRedesignEnabled:C,userToGroupMap:I});void 0!==l&&(t||ft().Tt(l.permissionItem.role??"none"))&&"newUser"!==e.type?l&&a.push({inviteTarget:e,...l}):"newUser"!==e.type&&r.push(e)}));const l=n.filter((e=>!s.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:r,filteredImportedContacts:l}}),[y,o,c,I,C,v,M]),{isValidEmail:L,isEmailInTargets:R}=(0,a().K8)((()=>{const e=(0,me().qh)(p);return{isValidEmail:(0,me().DT)(e),isEmailInTargets:[...P.map((e=>{let{inviteTarget:t}=e;return t})),..._].some((t=>"group"!==t.type&&t.value.email===e))}}),[p,P,_]),E=(0,a().K8)((()=>b.state.inviteTargets.length>0),[b]),F=L&&!R,U=c.showRestrictedPermissionBanner,K=!l&&!d&&_.length>0&&(0===p.length||0===(null==y?void 0:y.tokenQuery.length)),z=!l&&!d&&p.length>0&&Boolean(null==y||null===(t=y.tokenQuery)||void 0===t?void 0:t.length)&&P.length>0,W=!l&&!d&&_.length>0&&p.length>0&&Boolean(null==y||null===(n=y.tokenQuery)||void 0===n?void 0:n.length),H=B.filter((e=>"slack"===e.source)),G=B.filter((e=>"google"===e.source)),Y=A&&H.length>0,q=G.length>0,$={key:"imported slack contacts",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!h}),items:tn({filteredContacts:H,isRedesignEnabled:C,environment:v,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:S,importContactType:"slack"})},Z={key:"imported google contacts",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!h}),items:tn({filteredContacts:G,isRedesignEnabled:C,environment:v,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:S,importContactType:"google"})},J=F||!K&&!z&&!W&&!Y&&!q&&!l&&!d&&p.length>0,X=(0,a().K8)((()=>{const e=de().subscriptionDataStoreInstance.state,{currentSpaceStore:t}=tt().default.state;return t&&e?Et().Ye(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Ot().LU.createChildStore(t,{table:Q().oo,id:n.userId}).getEmail();return e&&(0,me().zN)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),ee=(0,Bt().A)(o);if(f)return(0,k.jsx)(Tt().z,{loading:!h,children:(0,k.jsx)(At().A,{title:(0,k.jsx)(s().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!h&&g)return(0,k.jsx)(Lt().J,{areaHeight:window.innerHeight});const te={key:"user results",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,loading:!h,title:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:mn({tokenQuery:p,possibleDomains:X,shouldShowAutoFillEmail:J,isGuestInviteRequestRequired:ee.isGuestRequestRequired,environment:v,inviteTargetsStore:b,menuListStore:S,styles:w})},ne={key:"suggested",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h}),items:_.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const n=be().P4({target:e,inviteTargetsStore:b});return(0,k.jsx)(qt().A,{...t,isRedesignEnabled:C,isMobile:v.device.isMobile,disabled:!1,inviteTarget:e,isInvited:n,spaceVisibleUserMap:M,store:o})},action:()=>on({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"suggested"})})))},oe={key:"in page",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:C?(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}):(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!h}),items:P.map(((e,t)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:a}=e,{type:r}=n;if("existingUser"===r){if(!!a&&a.length>1)return{key:n.value.id,render:e=>(0,k.jsx)(sn,{...e,isRedesignEnabled:C,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:a,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:U}),action:()=>{}};{const e=T.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:a=>C?(0,k.jsx)(sn,{...a,isRedesignEnabled:C,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:U}):(0,k.jsx)(St().A,{...a,itemMarginLeft:0,itemMarginRight:0,title:(0,k.jsx)(zt().A,{store:o,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:M,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,k.jsx)(sn,{...e,isRedesignEnabled:C,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:U}),action:()=>on({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"in_page"})}}}if("group"===r){if(!!a&&a.length>1)return{key:n.value.id,render:a=>(0,k.jsx)(sn,{...a,isRedesignEnabled:C,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:U}),action:()=>{}};{const e=T.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));return e?{key:n.value.id,render:t=>(0,k.jsx)(St().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,k.jsx)(Kt().A,{store:o,groupPermission:e,spaceId:o.getSpaceId(),showInherited:!0,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,k.jsx)(sn,{...e,isRedesignEnabled:C,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:U}),action:()=>on({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"in_page"})}}}(0,V().HB)(r)}))},ie={key:"not in page",render:e=>(0,k.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:p.length>0&&(C?(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}):(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"})),loading:!h}),items:_.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>(0,k.jsx)(qt().A,{...t,disabled:!1,isRedesignEnabled:C,isMobile:v.device.isMobile,inviteTarget:e,isInvited:be().P4({target:e,inviteTargetsStore:b}),spaceVisibleUserMap:M,store:o}),action:()=>on({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"not_in_page"})})))};let ae=[];if(F&&ae.push(te),K&&ae.push(ne),z&&ae.push(oe),W&&ae.push(ie),Y&&ae.push($),q&&ae.push(Z),l&&(ae=[$],0===$.items.length))return(0,k.jsx)(cn,{styles:w,importContactType:"slack"});if(d&&(ae=[Z],0===Z.items.length))return(0,k.jsx)(cn,{styles:w,importContactType:"google"});if(0===ae.length){if(ae=[te],0===p.length&&!E)return(0,k.jsx)(un,{styles:w});if(0===p.length&&E)return(0,k.jsx)("div",{style:w.keepTypingMessage,children:(0,k.jsx)(m().A,{isSecondaryColor:!0,isSmall:!0,children:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ht,{publicPermission:c.mostPermissivePublicItem}),(0,k.jsx)(Mt().Ay,{type:Mt().Oh.Vertical,initialFocus:p.length>0?0:void 0,sections:ae,store:S,disableKeyboard:x})]})}function tn(e){const{filteredContacts:t,isRedesignEnabled:n,environment:o,inviteTargetsStore:i,blockStore:a,spaceVisibleUserMap:r,tokenQuery:s,menuListStore:l,importContactType:d}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,k.jsx)(qt().A,{...t,isRedesignEnabled:n,isMobile:o.device.isMobile,disabled:!1,inviteTarget:e,isInvited:be().P4({target:e,inviteTargetsStore:i}),spaceVisibleUserMap:r,store:a}),action:()=>{be().P4({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(E().kH(o,{invite_token_query:s,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,Ft().AI)(),type:nn(d)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),l.unsetFocus())}})))}function nn(e){return"google"===e?"google_contacts":"slack"===e?"slack":void(0,V().HB)(e)}function on(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:o,rank:i,tokenQuery:a,environment:r,type:s}=e;be().lW({inviteTargetsStore:n,inviteTarget:t})&&E().kH(r,{invite_token_query:a,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,Ft().AI)(),type:s}),o.unsetFocus()}const an=o.forwardRef((function(e,t){const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u,isRedesignEnabled:p}=e,m=(0,i().v3)(),[g,f]=(0,o.useState)(!1),h=(0,a().K8)((()=>s.getSpaceId()),[s]),y=(0,a().K8)((()=>c&&c.length>0),[c]),v=(0,o.useCallback)((()=>{if(y){const e=!1===g;f(!g),e&&bt().lD(m,{share_menu_session_id:N().Ay.state.sessionId,type:"group",group_id:l.value.group_id})}}),[m,y,g,f,l]),b=(0,r().IS)((e=>({buttonMenuItem:(0,ke().sH)({isRedesignEnabled:p,isMobile:m.device.isMobile}),permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:S().Wy.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[m.device.isMobile,p]);return(0,k.jsx)(kt().A,{delayThreshold:0,placement:Rt().W.Left,textWrap:!0,style:b.tooltip,renderTooltip:()=>(0,k.jsx)(ln,{blockStore:s,blockPermissionItem:d}),render:o=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{...o,children:(0,k.jsx)(St().A,{...e,buttonStyle:b.buttonMenuItem,...(0,Pt().A)(e,{onClick:v}),ref:t,title:(0,k.jsx)(n(779496).A,{inviteTarget:l,isRedesignEnabled:p,isMobile:m.device.isMobile,captionOverride:y&&g?(0,k.jsx)(dn,{}):void 0}),right:(0,k.jsx)(It().Y,{type:d.type,table:ht().ev,disabled:!0,icon:y?g?ut().B:pt().d:void 0,role:d.role??"none",isCurrentUser:!1,buttonStyle:b.permissionRoleButton})})}),y&&g&&(0,k.jsx)("div",{style:b.expandablePermissionList,children:null==c?void 0:c.map(((t,n)=>{const o=t.permissionItem.type;let i=null;switch(o){case"space_permission":i=(0,k.jsx)($t().A,{store:s,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_permission":i=(0,k.jsx)(Jt().A,{store:s,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,k.jsx)(Kt().A,{spaceId:h,store:s,groupPermission:t,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,V().HB)(o)}return(0,k.jsx)("div",{style:b.roundedPermissionItem,children:i},n)}))})]})})})),rn=o.forwardRef((function(e,t){const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,spaceVisibleUserMap:u,permissionItemArgs:p}=e,m=(0,i().v3)(),[g,f]=(0,o.useState)(!1),h="existingUser"===l.type?Ot().LU.createChildStore(s,{table:Q().oo,id:l.value.id}):void 0,y=(0,a().K8)((()=>"none"===l.spaceRole?(0,n(619338).p)({spaceVisibleUserMap:u,userId:l.value.id,store:s}):(0,Yt().v)(l.spaceRole)),[l,u,s]),v=(0,a().K8)((()=>s.getSpaceId()),[s]),b=(0,a().K8)((()=>c&&c.length>0),[c]),x=(0,o.useCallback)((()=>{const e=!1===g;f(!g),e&&bt().lD(m,{share_menu_session_id:N().Ay.state.sessionId,type:"user",userId:l.value.id})}),[m,g,f,l]),M=(0,r().IS)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:S().Wy.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:ke().zr},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,k.jsx)(kt().A,{delayThreshold:0,placement:Rt().W.Left,textWrap:!0,style:M.tooltip,renderTooltip:()=>(0,k.jsx)(ln,{blockStore:s,blockPermissionItem:d}),render:n=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{...n,children:(0,k.jsx)(St().A,{...e,...(0,Pt().A)(e,{onClick:x}),ref:t,title:(0,k.jsx)(Yt().A,{isLarge:!0,actorStore:h,containerStyle:M.cellMemberAvatarContainer,spaceRole:y,caption:b&&g?(0,k.jsx)(dn,{}):void 0}),right:(0,k.jsx)(It().Y,{type:d.type,table:ht().ev,disabled:!0,icon:b?g?ut().B:pt().d:void 0,role:d.role??"none",isCurrentUser:!1,buttonStyle:M.permissionRoleButton})})}),b&&g&&(0,k.jsx)("div",{style:M.expandablePermissionList,children:null==c?void 0:c.map(((t,n)=>{const o=t.permissionItem.type;let i=null;switch(o){case"space_permission":i=(0,k.jsx)($t().A,{store:s,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_owner_permission":i=(0,k.jsx)(Xt().A,{store:s,blockTeamOwnerPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,k.jsx)(Jt().A,{store:s,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":i=(0,k.jsx)(Zt().A,{store:s,blockTeamGuestPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,k.jsx)(Kt().A,{store:s,spaceId:v,groupPermission:t,permissionItemArgs:p,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":i=(0,k.jsx)(zt().A,{store:s,userPermission:t,permissionItemArgs:p,spaceVisibleUserMap:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,V().HB)(o)}return(0,k.jsx)("div",{style:M.roundedPermissionItem,children:i},n)}))})]})})})),sn=o.forwardRef((function(e,t){const{inviteTarget:n}=e,o=n.type,i=(0,a().K8)((()=>(0,D().FI)()),[]);switch(o){case"group":return i?(0,k.jsx)(Qt().Ay,{...e,inviteTarget:n}):(0,k.jsx)(an,{...e,ref:t,inviteTarget:n});case"existingUser":return i?(0,k.jsx)(Qt().Ay,{...e,inviteTarget:n}):(0,k.jsx)(rn,{...e,ref:t,inviteTarget:n});default:(0,V().HB)(o)}}));function ln(e){const{blockStore:t,blockPermissionItem:n}=e,o=(0,i().v3)(),l=(0,a().K8)((()=>tt().default.state.currentSpaceStore),[]),d=(0,a().K8)((()=>{if(l)return(0,U().c2)(o,l)}),[o,l]),c=(0,a().K8)((()=>{const e=n.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Ot().h4.createChildStore(t,{table:vt().yK,id:n.team_id})}}),[t,n]),u=(0,a().K8)((()=>null==c?void 0:c.getIcon()),[c]),p=(0,r().IS)((()=>({container:{fontWeight:S().Wy.bold,...S().RC},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),m=n.type;return"space_permission"===m?(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,k.jsxs)("span",{style:p.container,children:[d&&(0,k.jsx)(Ct().A,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:p.recordIcon}),l&&(0,k.jsx)(wt().A,{store:l,style:p.recordTitle})]})}}):"explicit_team_owner_permission"===m?(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,k.jsxs)("span",{style:p.container,children:[u&&(0,k.jsx)(Ct().A,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,k.jsx)(wt().A,{store:c,style:p.recordTitle})]})}}):"explicit_team_permission"===m?(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,k.jsxs)("span",{style:p.container,children:[u&&(0,k.jsx)(Ct().A,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,k.jsx)(wt().A,{store:c,style:p.recordTitle})]})}}):"explicit_team_guest_permission"===m?(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,k.jsxs)("span",{style:p.container,children:[u&&(0,k.jsx)(Ct().A,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,k.jsx)(wt().A,{store:c,style:p.recordTitle})]})}}):"group_permission"===m?(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===m||"exclusive_user_permission"===m||"public_permission"===m||"trusted_domain_permission"===m||"restricted_permission"===m||"deleted_permission"===m||"team_permission"===m||"team_owner_permission"===m||"bot_permission"===m?(0,k.jsx)(k.Fragment,{children:ft().Tt(n.role??"none")&&(0,k.jsx)(s().sA,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,V().HB)(m)}function dn(){return(0,k.jsx)(s().sA,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function cn(e){const{styles:t,importContactType:n}=e,o="google"===n?"Google account":"Slack workspace";return(0,k.jsxs)("div",{style:t.zeroState,children:[(0,gt().G)(t.zeroStateIcon),(0,k.jsxs)("div",{style:t.zeroStateText,children:[(0,k.jsx)("div",{style:{fontWeight:S().Wy.semibold,marginBottom:4},children:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,k.jsx)("div",{children:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:o}})})]})]})}function un(e){const{styles:t}=e;return(0,k.jsxs)("div",{style:t.zeroState,children:[(0,mt().x)(t.zeroStateIcon),(0,k.jsxs)("div",{style:t.zeroStateText,children:[(0,k.jsx)("div",{style:{fontWeight:S().Wy.semibold,marginBottom:4},children:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,k.jsx)("div",{children:(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function pn(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:o}=e;const i=(0,dt().Ay)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,o),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function mn(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:o,shouldShowAutoFillEmail:i,environment:a,inviteTargetsStore:r,menuListStore:l,styles:d}=e;return pn({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,k.jsx)(St().A,{icon:(0,mt().x)({width:20,height:20}),title:(0,k.jsx)(gn,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:o}),caption:o?(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,ct().p)(d.arrowUpLeftIcon),...t}),action:async()=>{const o=(0,me().qh)(e.tokenQuery);if(!(0,me().DT)(o)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(be().P4({target:t,inviteTargetsStore:r})||r.setState({inviteTargets:[...r.state.inviteTargets,t],tokenQuery:""}))}const i=await xt().Ah(a,[o]);if(!i.length)return;const s=i[0];be().P4({target:s,inviteTargetsStore:r})||(E().kH(a,{invite_token_query:t,selected_user_token:s,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,Ft().AI)(),type:"autofill"}),r.setState({inviteTargets:[...r.state.inviteTargets,s],tokenQuery:""}),l.unsetFocus())}})))}function gn(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:o}=e;return o?(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,k.jsx)(s().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const fn=function(e){const t=(0,i().v3)(),r=(0,s().tz)(),[l,d]=(0,o.useState)(!0),c=(0,a().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),u=(0,a().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=nt().A.completeSlackAuthentications.state.length>0&&$e().YA(),n=nt().A.externalAuthentications.state.filter((e=>e.integration_id===Ve().E8)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly]),[{value:p,status:m}]=(0,n(187174).Yb)((async()=>({...await xt().hQ({query:c,sectionLimit:u,membersOnly:e.membersOnly,environment:t,intl:r}).finally((()=>d(!1))),tokenQuery:c})),[t,r,e.membersOnly,c,u],{debounce:40});return(0,k.jsx)(en,{...e,tokenQuery:c,showShimmer:l,ready:"pending"!==m&&"idle"!==m,error:"rejected"===m,result:p})};function hn(e){const t=(0,i().v3)(),n=(0,a().uB)(e.inviteTargetsStore,le().Ay),r=(0,a().K8)((()=>n.state.inviteTargets),[n]),{display:s,source:l,focus:d,emailMessage:c}=(0,a().K8)((()=>{const{display:e}=N().Ay.state;return e===N().pP.Invite?N().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),u=(0,a().K8)((()=>tt().default.state.currentSpaceStore),[]),p=s===N().pP.Invite&&r.length>0,m=(0,a().K8)((()=>l===N().NL.Notion&&0===r.length&&(0,$e().YA)()),[r.length,l]),g=(0,a().O$)(nt().A.completeSlackAuthentications),f=(0,a().K8)((()=>l===N().NL.Notion&&0===r.length&&(0,$e().MT)(!0)),[r.length,l]),h=(0,a().K8)((()=>nt().A.externalAuthentications.state.filter((e=>e.integration_id===Ve().E8))),[]),y=(0,a().K8)((()=>(0,D().FI)()),[]),[v,b]=(0,o.useState)(!1),x=p&&!m,S=(0,o.useCallback)((()=>{n.reset()}),[n]);(0,o.useEffect)((()=>{if(u&&!v&&(m||f)){if(m)for(const e of g)We().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:u.id,integrationId:Ve().zG,importContactType:"slack"}}).catch((e=>{}));if(f)for(const e of h)We().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:u.id,integrationId:Ve().E8,importContactType:"google"}}).catch((e=>{}));b(!0)}}),[m,f]);const M=xn({scrollerMarginBottom:x?st:0});return s!==N().pP.Invite?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(qe().H,{type:Xe().A.Y,style:M.scroller,children:(0,k.jsx)(fn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:l===N().NL.Slack,shouldShowGoogleOnly:l===N().NL.Google,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),(0,k.jsx)(yn,{shouldShowSlackImportContactsButton:m,shouldShowGoogleImportContactsButton:f,emailMessage:c,inviteTargetsStore:n,isRedesignEnabled:y,emailMessageOpen:x,flowId:e.flowId}),(0,k.jsx)(lt,{open:p&&!m,focus:d===N().yZ.Message,value:c,onFocus:()=>{l&&s===N().pP.Invite&&N().Ay.setState({...N().Ay.state,focus:N().yZ.Message,tab:N().QC.Share,display:s,source:l,emailMessage:c})},onChange:e=>{N().Ay.setState({...N().Ay.state,focus:d,tab:N().QC.Share,display:s,source:l,emailMessage:e.target.value})},onCancel:async()=>{await ot().T({environment:t,inviteTargetsStore:n})&&(ot().XP(t),S())},maxLength:1e3})]})}function yn(e){const{shouldShowSlackImportContactsButton:t,shouldShowGoogleImportContactsButton:n,emailMessage:o,inviteTargetsStore:i,isRedesignEnabled:a,emailMessageOpen:r,flowId:s}=e,l=xn({scrollerMarginBottom:r?st:0}),d=(0,Je().Hc)(),c=e=>{N().Ay.setState({...N().Ay.state,tab:N().QC.Share,display:N().pP.Invite,focus:N().yZ.Search,source:e,emailMessage:o}),i.setState({...i.state,tokenQuery:""})};if(t&&n){const e=(0,Ze().C)({onClickAuthenticated:c,hideChevronIcon:a,containerStyle:d.importListButtonContainer,buttonStyle:d.importListButton,flowId:s});return(0,k.jsx)(Ge().Ay,{popupType:et().n.Popup,alignmentToOrigin:Ge().yP.Start,placementToOrigin:Ge().sx.Left,render:()=>(0,k.jsx)(Qe().A,{importListItems:e}),originGap:12,renderOrigin:e=>(0,k.jsx)("div",{style:l.importContactsContainer,children:(0,k.jsx)(He().p,{style:l.importContactsButton,onClick:e.onClick,children:(0,k.jsx)("div",{style:d.labelContainer,children:a?(0,k.jsx)(vn,{}):(0,k.jsx)(bn,{})})})})})}return t?(0,k.jsx)(ze().Xx,{onClickAuthenticated:()=>c(N().NL.Slack),title:a?(0,k.jsx)(vn,{}):(0,k.jsx)(bn,{}),containerStyle:l.importContactsContainer,buttonStyle:a?l.importContactsButtonV2:l.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:s,loadContacts:!0,hideChevronIcon:a}):null}function vn(){const e=(0,r().IS)((e=>({integrationName:{display:"flex"},importContactsButtonTitle:{display:"flex",alignItems:"center",color:e.regularTextColor,gap:8},arrowDownIcon:{height:20,width:20}})),[]);return(0,k.jsxs)("div",{style:e.importContactsButtonTitle,children:[(0,k.jsx)("div",{style:e.integrationName,children:Ke(e.arrowDownIcon)}),(0,k.jsx)(s().sA,{defaultMessage:"Import contacts",id:"importContactsButton.importContacts.label"})]})}function bn(){const e=(0,r().IS)((()=>({integrationName:{display:"flex"},integrationIcon:{marginRight:4}})),[]),t=(0,k.jsxs)("div",{style:e.integrationName,children:[(0,k.jsx)(Ye().A,{type:"image_url",imageURL:Ue().A.images.externalIntegrations.slackIconPng,size:18,imageStyle:e.integrationIcon}),(0,k.jsx)(s().sA,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,k.jsx)(s().sA,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:t}})}function xn(e){let{scrollerMarginBottom:t}=e;return(0,r().IS)((e=>({scroller:{flexGrow:1,marginBottom:t},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.regularTextColor}})),[t])}var Sn=()=>n(100622),Mn=()=>n(912913),An=()=>n(891078),Cn=()=>n(107683),wn=()=>n(49210),jn=()=>n(42476),kn=()=>n(7674),In=()=>n(204063),Tn=()=>n(592674),Pn=()=>n(868146);function _n(e){const{email:t}=e;return(0,k.jsx)(te().A,{avatar:{email:t},size:28})}function Bn(e){const{children:t}=e,n=(0,r().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,k.jsxs)("div",{style:n.wrapper,children:[t,(0,k.jsx)("div",{style:n.shield,children:(0,k.jsx)(Re().Q,{iconGroup:Pn().u,colorName:"secondary",variantName:"mini"})})]})}function Ln(e){const{rows:t,internalDomains:n}=e,o=(0,r().IS)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,k.jsx)(qe().H,{type:Xe().A.Y,style:o.inviteTargetList,children:(0,k.jsx)($().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,k.jsx)(Rn,{email:e.email,internalDomains:n},e.email);case"existing":return(0,k.jsx)(Dn,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,V().HB)(t)}}))})})}function Rn(e){const{email:t,internalDomains:n}=e,o=(0,ge().C7)(t,n);return(0,k.jsx)(On,{avatar:o?(0,k.jsx)(Bn,{children:(0,k.jsx)(_n,{email:t})}):(0,k.jsx)(_n,{email:t}),name:t,email:t})}function Dn(e){const{userStore:t,internalDomains:n}=e,o=(0,s().tz)(),{name:i,email:r}=(0,a().K8)((()=>({name:t.getDisplayName(o),email:t.getEmail()})),[t,o]);if(!i||!r)return null;const l=(0,ge().C7)(r,n);return(0,k.jsx)(On,{avatar:l?(0,k.jsx)(Bn,{children:(0,k.jsx)(te().A,{userStore:t,size:28})}):(0,k.jsx)(te().A,{userStore:t,size:28}),name:i,email:r})}function On(e){const{avatar:t,name:n,email:o}=e;return(0,k.jsxs)($().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,k.jsxs)($().Y1,{gap:2,children:[(0,k.jsx)(Z().D,{styleName:"Body-14px/Medium",children:n}),(0,k.jsx)(Z().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:o})]})]})}function Nn(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,V().HB)(t)}}function En(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:r,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i().v3)(),u=(0,s().tz)(),[p,m]=(0,a().K8)((()=>[n.id,n.getName()]),[n]),g=(0,a().K8)((()=>null==r?void 0:r.getUserId()),[r]),f=(0,a().K8)((()=>{var e;return(null===(e=Tn().A.getData(c,{spaceId:p}))||void 0===e?void 0:e.filter((e=>e.hasGuests)).map((e=>e.domain)))??[]}),[c,p]),h=(0,we()._X)({name:"internal_guests",spaceId:p,userId:g,amount:0}),y=(0,o.useCallback)((()=>{const e=t.map(Nn).filter(V().O9);l(e)}),[t,l]);return h&&f?(0,k.jsx)(he().A,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:y,children:(0,k.jsx)(kn().tf,{header:(0,k.jsx)(kn().YA,{iconAndTitle:(0,k.jsx)(kn().ZQ,{iconGroup:jn().A,iconColorName:"secondary",title:u.formatMessage(Un.title,{spaceName:m,guestLimit:h.limit.total})}),description:u.formatMessage(Un.description,{domain:f[0].url,p:e=>(0,k.jsx)(Z().D,{colorName:"uiBluePrimary",children:(0,k.jsx)("p",{children:e})})})}),footer:(0,k.jsx)(Fn,{rowCount:t.length,onClickAddMembers:y,onClickManageGuests:d}),children:(0,k.jsx)(Ln,{rows:t,internalDomains:f})})}):null}function Fn(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:o}=e,i=(0,s().tz)(),a=i.formatMessage(Un.addMember,{rowCount:t});return(0,k.jsxs)($().Y1,{gap:16,children:[(0,k.jsxs)($().Y1,{gap:8,children:[(0,k.jsx)(In().A,{"aria-label":a,onClick:n,style:{height:32},children:a}),(0,k.jsx)(J().A,{size:"lg","aria-label":i.formatMessage(Un.manageGuestsInSettings),onClick:o,children:i.formatMessage(Un.manageGuestsInSettings)})]}),(0,k.jsx)("div",{style:{textAlign:"center"},children:(0,k.jsx)(Z().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(Un.billingNotice)})})]})}const Un=(0,s().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},upgradeButton:{id:"addAsMembersModal.addMembersButton",defaultMessage:"{guestCount, plural, one {Add as member} other {Add as {guestCount} members}}"},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(16280);var Vn=()=>n(857639),Kn=()=>n(319625),zn=()=>n(763824),Wn=()=>n(901389),Hn=()=>n(436572),Gn=()=>n(402390),Yn=()=>n(579627),qn=()=>n(972435);async function Qn(e){const{environment:t,email:n}=e,o=await We().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===o.type){const e=o.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,o=await We().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,Gn().H)(qn().A.getIntl())}});if("failed"===o.type)throw o.error;return o.data.userId}({environment:t,email:n})}async function $n(e){const{blockPermissionItem:t,blockStore:n,environment:o,metadata:i,sudoModeStore:a}=e;await Yn().J4({environment:o,store:n,sudoModeStore:a,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var Zn=()=>n(31082);const Jn=(0,s().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function Xn(e){const{environment:t,intl:n,internalDomains:o,destination:i,invites:a,metadata:r,sudoModeStore:s,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:o,metadata:i,sudoModeStore:a,contextualInviteStore:r}=e,s=(await(0,zn().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:o}=e,{blockStore:i,spaceStore:a}=o,{defaultAddability:r}=t;try{switch(r.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:a,defaultAddability:r}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:s}=a,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=o,{inviteOrigin:p}=i,m=await Qn({environment:t,email:s});if(!m)throw new Error("Invitee user not found");const g={type:"user_permission",role:c,user_id:m},f={type:"user_permission",role:l,user_id:m};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:o,inviteOrigin:i,spacePermissionItem:a,spaceStore:r,sudoModeStore:s}=e;if(t.user_id!==a.user_id)throw new Error("User IDs for block and space permission items must match");if(!r.isTeamsEnabled()&&!(await z().oH({environment:o,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.");await Yn().J4({environment:o,store:r,sudoModeStore:s,permissionItems:[a],invite:{inviteOrigin:i}}),await Yn().J4({environment:o,store:n,sudoModeStore:s,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:p,spacePermissionItem:g,spaceStore:u});const h="member"===r.type&&"over_internal_guest_limit"===r.reason;return{type:"createdMember",invite:n,inviteeUserId:m,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:a,internalDomain:r}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:s}=a,{spaceStore:l}=o,{inviteMessage:d}=i,c=await Qn({environment:t,email:s});if(!c)throw new Error("Invitee user not found");await async function(e){const{environment:t,spaceStore:n,inviteeUserId:o,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const a=await We().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:o,spaceId:n.id,message:i}});if("failed"===a.type)throw a.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==r;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:a}=e,{invitee:r}=n;if(void 0===r)throw new Error("Expected invite.invitee to be defined");const{email:s}=r,{blockRole:l,blockStore:d}=o,c=await Qn({environment:t,email:s});if(!c)throw new Error("Invitee user not found");const u={type:"user_permission",role:l,user_id:c};return await $n({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:a}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:a}=n.invitee,{blockRole:r,blockStore:s,spaceStore:l}=o,{inviteMessage:d}=i,c={id:s.id,spaceId:l.id},u=await Qn({environment:t,email:a});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:o,inviteeUserId:i,inviteMessage:a}=e,r=await We().callApi({eventName:"requestAccess",environment:o,data:{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:a}}});if("failed"===r.type)throw r.error}({block:c,blockRole:r,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:a}=e,{blockRole:r,blockStore:s}=o;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:r,group_id:l.group_id};return await $n({blockPermissionItem:d,blockStore:s,environment:t,metadata:i,sudoModeStore:a}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,V().HB)(r)}}catch(l){var s;const e=(0,Kn().A)(l).message,o={miscDataToConvertToString:{message:e,spaceId:a.id,blockId:i.id,actorUserId:n.currentUser.id,inviteeEmail:null===(s=t.invitee)||void 0===s?void 0:s.email,defaultAddabilityType:r.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),Vn().log({level:d?"info":"error",from:"processInvite",type:c,data:o});const u=qn().A.formatMessage(Jn[c]);return void(d?Wn().rG({message:u}):Wn().f1(u))}}({environment:t,invite:e,destination:o,metadata:i,sudoModeStore:a})))).filter(V().O9);if(r){const e={};for(const t of s)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);r.setState({...r.state,invitedEmailToUserIdMap:e})}return s}({destination:i,environment:t,invites:a,metadata:r,sudoModeStore:s,contextualInviteStore:l});if((0,Zn().Bw)({destination:i,environment:t,internalDomains:o,inviteResults:d,metadata:r}),0===d.length)return!1;return(0,D().FI)()?Hn().D6({label:eo({invites:a,intl:n})}):Hn().D6({label:n.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"})}),!0}function eo(e){var t;const{invites:n,intl:o}=e,i=null===(t=n[0].invitee)||void 0===t?void 0:t.email;i||o.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const a=n.length-1;return n.filter((e=>{var t;return"member"!==(null===(t=e.invitee)||void 0===t?void 0:t.currentRole)})).length===n.length?a<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:a}):a<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:a})}function to(e){e.reset(),N().Ay.setState({...N().Ay.state,tab:N().QC.Share,display:N().pP.MainShareMenu,source:N().mc.ShareTopbarButton})}async function no(e){const{addAsMembersResult:t,destination:n,environment:o,internalDomains:i,intl:a,invites:r,inviteTargetsStore:s,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",Oe().A.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(to(s),await Xn({destination:n,environment:o,internalDomains:i,invites:r,intl:a,metadata:l})):(0,V().HB)(t))}async function oo(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:o,metadata:i,invites:a,environment:r,internalDomains:s,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:p}=e,m=a.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=a.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(m){const e=a.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:o}=t;switch(o){case"existingUser":return{type:"existing",userStore:new(Ot().LU)(n,{table:Q().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,V().HB)(o)}}({environment:r,inviteTarget:e.inviteTarget}))).filter(V().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:o}=e;return await wn().T.showAsyncModal((e=>(0,k.jsx)(Cn().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,k.jsx)(En,{inviteUserListRows:t,spaceStore:n,spaceUserStore:o,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await no({addAsMembersResult:n,destination:t,environment:r,internalDomains:s,intl:l,invites:a,inviteTargetsStore:d,metadata:i})}else{to(d);if(!(await Xn({destination:t,environment:r,internalDomains:s,intl:l,invites:a,metadata:i,sudoModeStore:p,contextualInviteStore:n})))return;const e=a.map((e=>e.invitee)).filter(V().O9);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:o,invitees:i,spaceStore:a}=e,r=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:r}),F().BY({environment:o,spaceStore:a,contextualInviteStore:t})}({contextualInviteStore:n,environment:r,spaceStore:c,defaultAddabilities:o,invitees:e})}}var io=()=>n(540459),ao=()=>n(617014),ro=()=>n(133507);function so(e){const{onClick:t,featureAvailability:n}=e;return(0,k.jsx)(kt().A,{disableTooltip:!1,renderTooltip:()=>(0,k.jsx)(ro().j,{featureAvailability:n}),render:e=>(0,k.jsx)(In().A,{size:"lg",style:{marginLeft:8},onClick:t,...e,children:(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const lo=1e3;function co(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:p,spaceRole:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,y=(0,i().v3)(),v=(0,s().tz)(),b=(0,r().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:Sn().Ay.uiGray}})),[]),[x,S]=(0,o.useState)("editor"),[M,A]=(0,o.useState)(!1),C=(0,a().K8)((()=>(0,D().FI)()),[]),{source:w,focus:j,emailMessage:I,display:T}=(0,a().K8)((()=>{const{display:e}=N().Ay.state;return e===N().pP.Invite?N().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),P=(0,a().K8)((()=>t.getType()),[t]),{inviteTargets:_,inputFieldText:B}=(0,a().K8)((()=>({inviteTargets:(0,be().U1)({inviteTargetsStore:c,includeInputFieldText:!0}),inputFieldText:c.state.tokenQuery.trim()})),[c]),L=async()=>{if(!M&&l&&d)if(0===_.length&&C){const e=N().Ay.state;N().Ay.setState({...e,tab:N().QC.Share,display:N().pP.Invite,focus:N().yZ.Search,source:e.display===N().pP.Invite?e.source:N().NL.Notion,emailMessage:e.display===N().pP.Invite?e.emailMessage:""})}else{A(!0);try{const e={blockRole:x,blockStore:t,spaceRole:m,spaceStore:g};await oo({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:y,internalDomains:d,intl:v,invites:u,inviteTargetsStore:c,metadata:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{A(!1)}}},R=(0,Pe().sf)(u.map((e=>e.invitee)).filter(V().O9)),O=(0,a().K8)((()=>f.getUserId()),[f]),F=(0,we()._X)({name:"guests",spaceId:g.id,userId:O,amount:R}),U=(0,a().K8)((()=>t.canEditMembership()),[t]),K=(0,An().i0)(t),z=(0,An().ty)(t),W=Object.values(l??{}).some((e=>"none"===e.type||"member_request"===e.type)),H=I.length>lo,G=M||!U||K||z,[Y,q]=(0,o.useState)(!G);return(0,k.jsx)(kt().A,{disableTooltip:U&&!K&&!z,placement:Rt().W.Left,renderTooltip:()=>U?K?(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):z?(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:C?(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}):(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people"}),render:e=>(0,k.jsxs)("div",{style:{display:"flex"},...e,children:[(0,k.jsx)(ao().I,{inviteTargetsStore:c,metadata:p,focus:j===N().yZ.Search||C&&T===N().pP.MainShareMenu&&Y,setAutoFocusInput:q,addabilities:l,disabled:G,onFocus:()=>{N().Ay.setState({...N().Ay.state,tab:N().QC.Share,display:N().pP.Invite,focus:N().yZ.Search,source:w||N().NL.Notion,emailMessage:I||""}),E().Wd(y,{source:w||N().NL.Notion})},onSubmit:()=>{B.length>0||L()},placeholder:v.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:C&&B.length>0&&N().Ay.getState().display===N().pP.Invite||_.length>0?(0,k.jsx)(Mn().Ay,{disabled:!U||K||z,role:x,table:"block",type:"user_permission",blockType:P,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:b.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>S(e)}):void 0}),F&&(0,we().N9)(F,{available:()=>(0,k.jsx)(io().G,{tooltip:I.length>lo?(0,k.jsx)(s().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!U||K||z||W||H,onClick:L}),unavailable:e=>(0,k.jsx)(so,{featureAvailability:e,onClick:()=>{N().Ay.setState({...N().Ay.state,tab:N().QC.Share,display:N().pP.Invite,focus:void 0,source:w||N().NL.Notion,emailMessage:I||""}),xt().D6({environment:y,upgradeButtonName:"user_permission_item"})}})})]})})}var uo=()=>n(704152),po=()=>n(347930);const mo=function(e){const{store:t}=e,{isMobile:o}=(0,i().Y0)(),l=(0,a().K8)((()=>t.canEditMembership()),[t]),d=(0,a().K8)((()=>(0,D().FI)()),[]),c=(0,An().i0)(t),u=(0,An().ty)(t),p=(0,r().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:it().Y3},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden",...d?{background:e.tint.regular,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:o?36:30}:{}},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...S().RC},iconContainer:{fill:e.icon.secondary,marginRight:8},blueButton:{minWidth:it().CO}})),[o,d]);return(0,k.jsx)(kt().A,{renderTooltip:()=>u?(0,k.jsx)(s().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,k.jsx)(s().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:l&&!c&&!u,render:t=>(0,k.jsxs)("div",{style:p.buttonContainer,...t,children:[(0,k.jsx)(n(531337).A,{onClick:e.onClick,disabled:!l||c||u,style:p.inputButton,children:(0,k.jsx)("div",{style:p.inputContent,children:o&&d?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:p.iconContainer,children:(0,n(381138).q)({height:16,width:16})}),(0,k.jsx)(s().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,k.jsx)(s().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!o&&(0,k.jsx)(In().A,{size:"lg",onClick:e.onClick,disabled:!l||c||u,style:p.blueButton,children:(0,k.jsx)(s().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function go(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,i().v3)(),c=(0,i().WS)(),u=(0,a().uB)(void 0,L().A),p=(0,a().K8)((()=>u.state.permissionsInviteStore),[u]),m=(0,a().K8)((()=>u.stage),[u]),g=(0,a().K8)((()=>p.state.modalOpen),[p]),f=(0,a().K8)((()=>(0,D().FI)()),[]),h=(0,a().K8)((()=>t.canAdmin()),[t]),y=(0,a().K8)((()=>{const e=de().subscriptionDataStoreInstance.state;return Boolean(e&&Et().Fq(e))}),[]),v=(0,a().K8)((()=>(0,O().Xh)({store:t})),[t]),b=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",minHeight:f?0:52,marginBottom:f?16:void 0},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[f]),x=(0,o.useCallback)(((e,t)=>{e&&t>0&&Hn().D6({label:(0,k.jsx)(s().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:c?b.requestedUsersToast:void 0})}),[c,b.requestedUsersToast]);return m!==B().d5.closed||c&&!h?null:(0,k.jsx)(uo().A,{mobileFeedback:!0,disabled:!0,style:b.button,children:(0,k.jsxs)("div",{style:b.buttonInner,children:[g&&(0,k.jsx)(po().H,{store:t,disabled:!h,membersOnly:v,isSubscribed:y,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:b.modalButton,permissionsInviteStore:p,onInviteComplete:x,analyticsFrom:"mobile_invite"}),(0,k.jsx)(mo,{store:t,onClick:()=>(0,_t().LH)({environment:d,permissionsInviteStore:p,store:t,isSubscribed:y,renderInShareModal:!1})})]})})}var fo=()=>n(179030);function ho(e){const{spaceName:t,domainUrl:n}=e,o=(0,s().tz)();return(0,k.jsx)(fo().l,{tint:"gray",iconGroup:jn().A,label:o.formatMessage(yo.label,{spaceName:t}),description:o.formatMessage(yo.description,{domain:n}),display:"inline"})}const yo=(0,s().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}‘ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});var vo=()=>n(695608),bo=()=>n(496603),xo=()=>n(698449),So=()=>n(605402),Mo=()=>n(704262),Ao=()=>n(583705),Co=()=>n(296798),wo=()=>n(186445),jo=()=>n(731320),ko=()=>n(898808),Io=()=>n(485952);const To=(0,s().YK)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function Po(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,a().K8)((()=>(0,wo()._m)(n)),[n]),d=(0,a().K8)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,a().K8)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,jo().zt)({userId:l.id,store:t}),o=function(e){let{environment:t,calculatedPermission:n,store:o}=e;const i=(0,xe().pp)(o)||tt().default.state.currentSpaceStore;if(!i)return null;if((0,ft().Ds)(n)){const e=(0,U().RF)({groupId:n.group_id}),t=null==e?void 0:e.name;return t?(0,k.jsxs)(k.Fragment,{children:[(0,Ao().$)({width:18,marginRight:5}),t]}):null}if((0,ft().eu)(n)){var a;const e=n.team_id||(null===(a=(0,xe().Uo)(o))||void 0===a?void 0:a.id);if(!e)return null;const t=Ot().h4.createChildStore(i,{table:vt().yK,id:e,spaceId:i.id});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ko().x,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,k.jsx)(Io().i,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,ft().Lg)(n))return(0,ft().Ni)(n)?(0,k.jsx)(s().sA,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ko().x,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,U().GK)(t,i)]});if((0,ft().W8)(n))return(0,k.jsx)(Co().A,{underline:!0,inline:!0,onClick:()=>{N().Ay.setState({...N().Ay.state,display:N().pP.Publish,tab:N().QC.Publish})},children:(0,k.jsx)(s().sA,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:n,calculatedPermission:e,store:t});return{role:e.role,attribution:o}}),[l,t,n]),{userId:p,spaceId:g}=(0,a().K8)((()=>({userId:t.userId,spaceId:t.getSpaceId()})),[t]),f=(0,we().P9)({name:"block_read_and_write_role",spaceId:g,userId:p}),h=(0,a().K8)((()=>!!c&&(f&&!(0,ft().p2)(c))),[c,f]);(0,o.useEffect)((()=>{c&&bt().VJ(n,{share_menu_session_id:N().Ay.state.sessionId,role:c})}),[]);const y=(0,r().IS)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:h?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:h?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.lightTextColor},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[h]),[v,b]=(0,o.useState)(!1),[x,S]=(0,o.useState)(!1),M=(0,o.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const o=await We().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0}});"success"===o.type&&o.data.request?(b(!0),bt().T_(n,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:o.data.requestId})):"failed"===o.type&&"UserRateLimitResponse"===(null===(e=o.body)||void 0===e?void 0:e.name)&&S(!0)}),[n,c,t]);if(!(0,ft().PW)(c))return null;const A=function(e){switch(e){case"editor":return To.fullAccess;case"read_and_write":return To.editor;case"content_only_editor":return To.contentEditor;case"comment_only":return To.commenter;case"reader":return To.reader;case"none":case"membership_admin":return null;default:(0,V().HB)(e)}}(c);return A?(0,k.jsx)(kt().A,{delayThreshold:0,renderTooltip:()=>(0,k.jsx)(s().sA,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,k.jsxs)("div",{style:y.container,...e,children:[(0,k.jsxs)("div",{style:y.bannerBodyContainer,children:[(0,k.jsx)(te().A,{userStore:l,size:20,style:y.icon}),(0,k.jsx)(m().A,{style:y.bannerLabel,isMultiline:!0,children:(0,k.jsx)(s().sA,{...A,values:{hasAttribution:Boolean(u),attribution:(0,k.jsx)("span",{style:y.attribution,children:u})}})})]}),h&&(0,k.jsx)("div",{style:y.requestAccessContainer,children:(0,k.jsx)(uo().A,{style:v||x?y.pendingAccessRequestButton:y.accessRequestButton,onClick:M,disabled:v||x,children:v?(0,k.jsx)(s().sA,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):x?(0,k.jsx)(s().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,k.jsx)(s().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:Rt().W.Left}):null}var _o=()=>n(891368),Bo=()=>n(555857),Lo=()=>n(631523);function Ro(e){const{store:t,permissionItemArgs:n}=e,{showTeamPermission:o,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:a,mostPermissiveAncestorTeamMemberItem:r,mostPermissiveAncestorTeamGuestItem:s,mostPermissiveTrustedDomainItem:l,mostPermissiveSpaceItem:d,pagePermissionUIModel:c,mostPermissivePublicItem:u,showSitePublicPermission:p,showPublicShareLinkPermission:m,showTrustedDomainPermission:g,showRestrictedPermissionBanner:f}=e.calculatedPermissions,h=Number(o)+Number(i)+Number(p);return(0,k.jsxs)(k.Fragment,{children:[p&&u&&(0,k.jsx)(Bo().P,{store:t,publicPermissionItem:u,permissionItemArgs:n}),o&&a&&r&&(0,k.jsx)(Lo().A,{store:t,blockTeamOwnerPermission:a,blockTeamMemberPermission:r,blockTeamGuestPermission:s,permissionItemArgs:n}),i&&(0,k.jsx)($t().A,{store:t,spacePermission:d,publicPermission:u,showPublicShareLinkPermission:m,trustedDomainPermission:l,showTrustedDomainPermission:g,permissionItemArgs:n,fromPermissionWrapper:"permission_list",isRestricted:f}),(0,k.jsx)(Do,{store:t,pagePermissions:c,numberPermissionsAlreadyRendered:h,permissionItemArgs:n})]})}function Do(e){const t=(0,s().tz)(),n=(0,a().K8)((()=>{const e=tt().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:o,pagePermissions:i,numberPermissionsAlreadyRendered:r,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:p,mostPermissiveUserPermissions:m}=i,g=(0,Ut().x)(),f=(0,a().K8)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:n}=e,o={};return t.forEach((t=>{o[t.permissionItem.user_id]=(0,k.jsx)(zt().A,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:n,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),o}({store:o,mostPermissiveUserPermissions:m,permissionItemArgs:l,spaceVisibleUserMap:g}):[];return bo().oE(Object.keys(e).map((n=>{const i=Ot().LU.createChildStore(o,{table:Q().oo,id:n}),a=i.getModel();if(!i.isReady()||a)return{title:(0,vo().c6)(t,a),permissionItem:e[n]}})))}),[c,m,l,o,t,g]),h=function(e){const{store:t,mostPermissiveTeamPermissions:n,permissionItemArgs:o}=e;return n.map((e=>ft().nl(e.permissionItem)?(0,k.jsx)(Xt().A,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):ft().un(e.permissionItem)?(0,k.jsx)(Zt().A,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,k.jsx)(Jt().A,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:o,mostPermissiveTeamPermissions:p,permissionItemArgs:l}),y=(0,a().K8)((()=>{const e=n?function(e){const{spaceId:t,mostPermissiveGroupPermissions:n}=e,o={},i=new Set(So().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return n.forEach((n=>{const a=n.permissionItem.group_id;i.has(a)&&(o[a]=(0,k.jsx)(Kt().A,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),o}({store:o,spaceId:n,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):{};return Object.entries(e).map((e=>{let[n,o]=e;const i=So().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n));return{title:i?(0,xo().Pf)({intl:t,groupName:i.group.name}):"",permissionItem:o}}))}),[t,u,l,n,o]),v=[...f,...y];v.sort(((e,t)=>e.title.localeCompare(t.title)));const b=h.concat(v.map((e=>e.permissionItem))),x=b.length;if(0===x)return null;if(x>5-r){const e=Math.max(2-r,0);return(0,k.jsxs)(k.Fragment,{children:[d&&(0,k.jsx)(_o().G0,{}),b.slice(0,e),(0,k.jsx)(Mo().A,{permissions:b.slice(e,-1)}),b[x-1]]})}return(0,k.jsxs)(k.Fragment,{children:[d&&(0,k.jsx)(_o().G0,{}),b]})}function Oo(e,t){return e.from.table===ht().ev&&e.from.blockId===t.id}const No=function(e){const t=(0,i().v3)(),{device:s}=t,{store:l,permissionItemArgs:d,calculatedPermissions:c}=e,{sudoModeStore:u}=d,{permissionItemsCount:p,pagePermissionUIModel:m,showRestrictedPermissionBanner:g}=c,f=(0,a().K8)((()=>{const e=tt().default.state.currentSpaceStore;if(!e)return!0;if(l.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const o=(0,xe().fU)(l);for(const i of o)if((0,n(299545)._p)(i)&&i.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[l,t]);let h=null;const y=(0,a().K8)((()=>(0,O().Hb)({store:l,showRestrictedPermissionBanner:g})),[l,g]),{canAccessParent:v}=(0,a().K8)((()=>(0,O().iG)({store:l})),[l]),b={...c};if(!y&&v){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:n,mostPermissiveTeamPermissions:o,mostPermissiveUserPermissions:i}=t,[a,r]=bo().jB(n,(t=>Oo(t,e))),[s,l]=bo().jB(o,(t=>Oo(t,e))),[d,c]=bo().jB(i,(t=>Oo(t,e))),u={...t,mostPermissiveGroupPermissions:r,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},p={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:s,mostPermissiveUserPermissions:d};return[u,p]}(l,m);b.pagePermissionUIModel=e,h=(0,k.jsx)(Do,{store:l,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:d,showHeader:!0})}const x=(0,a().K8)((()=>!(0,O().Aj)({store:l})),[l]),S=s.isMobile?Xe().A.None:Xe().A.Y,M=(0,r().IS)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===p?void 0:1===p?60:90}})),[s,p]);return(0,o.useEffect)((()=>{bt().Fn({environment:t,calculatedPermissions:c})}),[]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(qe().H,{style:M.scroller,type:S,children:[!f&&(0,k.jsx)(Po,{store:l}),(0,k.jsx)(n(955307).A,{store:l,showRestrictedPermissionBanner:g,showPermissionInheritanceBanner:!1,sudoModeStore:u}),!y&&p>0&&(0,k.jsx)(_o().Ay,{store:l}),(0,k.jsx)(Ro,{store:l,calculatedPermissions:b,permissionItemArgs:d}),h,x&&(0,k.jsx)(n(342826).A,{store:l})]}),!s.isMobile&&(0,k.jsx)(C().A,{store:l,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:b,permissionItemArgs:d})]})};function Eo(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:s,permissionItemArgs:l,spaceStore:d,spaceUserStore:c,subscriptionDataStore:u}=e,p=(0,i().Y0)(),m=p.isMobile,{spaceId:g,spaceName:f,userId:h,spaceModel:y}=(0,a().K8)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),userId:c.getUserId(),spaceModel:d.getModel()})),[d,c]),v=(0,a().K8)((()=>(0,xe().Uo)(t)),[t]),[b,x]=(0,a().K8)((()=>[null==c?void 0:c.getModel(),null==v?void 0:v.getModel()]),[c,v]),S=(0,a().K8)((()=>N().Ay.state.display),[]),M=(0,a().K8)((()=>(0,D().FI)()),[]),A=function(e,t){return(0,r().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:t?530:540}})),[t])}(0,M),C=(0,a().uB)(void 0,Me().A),j=(0,a().K8)((()=>n.state.flowId),[n]),I=function(e){const t=(0,i().Y0)();return(0,o.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==N().pP.MainShareMenu||N().Ay.setState({...N().Ay.state,tab:N().QC.Share,display:N().pP.Invite,focus:N().yZ.Search,source:N().NL.Notion,emailMessage:""})}),[t,e])}(S),T=(0,Ie().K)(u),P=(0,a().K8)((()=>(0,be().U1)({inviteTargetsStore:s,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:(0,je().qw)({currentMembersAndGuests:T,inviteTarget:e})}))).filter(V().O9)),[s,T]),_=(0,Ce().mF)({space:d,spaceUser:c,team:v,invitees:P.map((e=>e.invitee)).filter(V().O9),store:t}),B=(0,ve().A)(d),L=P.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&B&&(0,ge().C7)(e.email,B))),R=(0,we()._X)({name:"internal_guests",spaceId:g,userId:h,amount:L.length}),O=(0,we().P9)({name:"non_admin_members",spaceId:g,userId:h})?"read_and_write":"editor",E=(0,ye().r1)({spaceStore:d}),F=(0,a().K8)((()=>{const e=N().Ay.state,t=e.display===N().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),U=(0,a().K8)((()=>_?P.map((e=>{const{inviteTarget:t,invitee:n}=e,o=null==n?void 0:n.email;let i,a;return"group"===t.type?a={type:"group"}:o?(i=(0,ge().CH)(o,B??[]),a=_[o]??{type:"none",reason:"other"}):a={type:"none",reason:"other"},{defaultAddability:a,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[P,_,B]),K=(0,fe().Vi)(R,(()=>{if(!f)return;if(E)return;const e=L[0];if(!e)return;const t=(0,me().zN)(e.email);return t?(0,k.jsx)(ho,{spaceName:f,domainUrl:t}):void 0})),z=(0,Se().X)("share_menu_inheritance_banner");return(0,k.jsx)(he().A,{debugName:"ShareMenuShareTab",capture:!0,onTab:I,children:(0,k.jsxs)("div",{style:A.container,children:[(0,k.jsxs)($().Y1,{direction:"vertical",gap:16,padding:M?m?`0 ${ke().u6}px 0px ${ke().u6}px`:`0 ${ke().rL}px 8px ${ke().rL}px`:"0 14px 8px 14px",children:[p.isMobile?(0,k.jsx)(go,{store:t,permissionItemArgs:l}):(0,k.jsx)(co,{blockStore:t,contextualInviteStore:n,defaultAddabilities:_,internalDomains:B,invites:U,inviteTargetsStore:s,metadata:F,spaceRole:O,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),K]}),S===N().pP.MainShareMenu&&!M&&(0,k.jsx)(No,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l}),S===N().pP.MainShareMenu&&M&&(0,k.jsx)(w().Ay,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l,showPermissionInheritanceBanner:z}),S===N().pP.Invite&&!p.isMobile&&(0,k.jsx)(hn,{store:t,inviteTargetsStore:s,menuListStore:C,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:j}),(0,k.jsx)(Ae().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,k.jsx)(Ee,{domains:B,spaceId:g,spaceModel:y,userId:h,spaceUserModel:b,teamModel:x,blockStore:t}),whenDisabled:null})]})})}const Fo=function(e){const{store:t,sudoModeStore:o}=e,i=(0,a().K8)((()=>o.state.changePermissionsEnabled),[o]),l=(0,a().K8)((()=>o&&o.shouldUserHaveAccessToPrivatePageBlock()&&!o.doesUserAlreadyHaveEditorAccess(t.pointer)&&o.state.privatePageStore),[o,t]),d=(0,r().IS)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:S().Wy.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return l?(0,k.jsxs)("div",{style:d.container,children:[(0,k.jsx)(m().A,{isMultiline:!0,children:(0,k.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,k.jsx)("b",{children:t})}}})}),(0,k.jsxs)(J().A,{size:"lg",disabled:i,style:d.button,onClick:()=>{o.setState({...o.state,changePermissionsEnabled:!0})},children:[(0,n(126553).x)(d.icon),i?(0,k.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,k.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function Uo(e){const t=(0,a().K8)((()=>N().Ay.state.tab),[]);switch(t){case N().QC.Share:return(0,k.jsx)(Eo,{...e,blockStore:e.store,subscriptionDataStore:de().subscriptionDataStoreInstance});case N().QC.Publish:return(0,k.jsx)(pe,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,V().HB)(t)}}function Vo(){const e=(0,i().Y0)(),t=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:S().Wy.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,k.jsxs)("div",{style:t.container,children:[se(t.iconStyle),(0,k.jsx)("div",{style:t.offlineMessageHeadline,children:(0,k.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,k.jsx)(s().sA,{defaultMessage:"You're offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,k.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,k.jsx)(s().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const Ko=function(e){const{store:t,permissionItemArgs:o}=e,s=(0,i().Y0)(),l=(0,a().uB)(e.inviteTargetsStore,le().Ay),d=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),c=(0,a().K8)((()=>n(227440).A.state.online),[]);return(0,k.jsxs)("div",{style:d.container,children:[o.sudoModeStore&&(0,k.jsx)(Fo,{store:t,sudoModeStore:o.sudoModeStore}),!s.isMobile&&(0,k.jsx)(ce().aR,{inviteTargetsStore:l,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),c?(0,k.jsx)(Uo,{inviteTargetsStore:l,...e}):(0,k.jsx)(Vo,{})]})};function zo(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:l,location:d}=e,S=(0,i().v3)(),M=(0,i().Y0)();(0,v().fJ)(_().Ns.publishSite),(0,v().fJ)(_().Ns.publishedSiteSettings);const A=(0,a().uB)(e.universalMemberInviteStore,L().A),w=(0,a().K8)((()=>A.state.contextualInviteStore),[A]),j=(0,R().H)(),T=(0,b().r)(),E=(0,x().HI)(),F=(0,a().K8)((()=>(0,D().FI)()),[]),U=(0,a().K8)((()=>O().dR({store:t,environment:S,trustedDomainsStore:j})),[S,t,j]),V=(0,a().K8)((()=>w.state.inviteStage),[w]),K=(0,a().K8)((()=>N().Ay.state.tab),[]),z=(0,r().IS)((e=>({title:{fontSize:F?16:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:F&&M.isMobile?e.surface.page:void 0},backChevronIcon:{fill:e.icon.primary}})),[M.isMobile,F]),W=(0,o.useMemo)((()=>({onUpgradeButtonClick:l,sudoModeStore:n,location:d})),[l,n,d]),H=(0,a().K8)((()=>(0,P().g)()),[]);if(!T)return H?(0,k.jsx)(I,{calculatedPermissions:U,store:t,permissionItemArgs:W,onClose:e.onClose}):null;if(!M.isMobile&&(V===B().d5.share_workspace||V===B().d5.request_workspace))return(0,k.jsx)(ae,{blockStore:t,spaceStore:T,contextualInviteStore:w});const G=M.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:F?(0,k.jsx)(m().A,{isMobile:M.isMobile,style:z.title,children:(0,k.jsx)(s().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}):(0,k.jsx)(m().A,{isMobile:M.isMobile,style:z.title,children:(0,k.jsx)(s().sA,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,k.jsx)(ce().zM,{mostPermissivePublicItem:U.mostPermissivePublicItem}),left:(0,k.jsx)(g().A,{href:(0,y().xS)("guides.sharing"),analyticsFrom:"sharing"}),footer:K===N().QC.Share&&(0,k.jsx)(C().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:U,permissionItemArgs:W}),topbarStyle:z.topbarStyle,right:(0,k.jsx)(p().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return E?(0,k.jsx)(u().A,{...G,className:f().NXe,children:(0,k.jsx)(c().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,k.jsx)(Wo,{store:t,spaceStore:T,spaceUserStore:E,permissionItemArgs:W,calculatedPermissions:U,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:w})})}):null}function Wo(e){let{store:t,spaceStore:n,spaceUserStore:a,permissionItemArgs:r,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p}=e;const m=(0,i().v3)();return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:m}),d().clear({preventDismissMobileKeyboard:!0,environment:m})}),[m]),(0,k.jsx)(Ko,{store:t,spaceStore:n,spaceUserStore:a,permissionItemArgs:r,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p})}},940433:(e,t,n)=>{n.d(t,{F:()=>y});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(66689),s=()=>n(636090),l=()=>n(416504),d=()=>n(187174),c=()=>n(799829),u=()=>n(959013),p=()=>n(449506),m=()=>n(175116),g=()=>n(706513),f=n(474848);const h=(0,u().YK)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function y(e){const{blockPropertyValueOverlayStore:t}=e,n=(0,i().v3)(),y=(0,m().ET)(),v=(0,a().O$)(y.normalizedSchemaStore),b=function(e){let{sprintCollectionStore:t,environment:n,normalizedBlockSchema:o}=e;const[{value:i,status:a}]=(0,d().Yb)((async()=>{var e;if(!t)return;const i=t.getSchema(),a=t.getFormat().app_config_uri;if(!a||a!==s().av)return;const d=(0,c().qk)(i,a).includes("last"),u=c().n$[a],m=u.current.reducer.get(o),g=u.next.reducer.get(o),f=u.last.reducer.get(o);if(!m||!g)return;const h={userId:n.currentUser.id,userTimeZone:(0,l().P)(),searchQuery:void 0,reducers:{[r().Xk]:m,[r().tO]:g,...d&&f?{[r().el]:f}:{}},currentPageInRelatedCollection:void 0},y=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],v=t.getSpaceId();if(!y)return;const b=await p().callApi({eventName:"queryCollection",environment:n,data:{source:{type:"collection",id:t.id,spaceId:v},collectionView:{id:y.id,spaceId:v},loader:h},tracking:{src:"sprint_status_overlay_check"}});if("success"!==b.type)return;const x=b.data.result.reducerResults[r().Xk],S=b.data.result.reducerResults[r().tO];if("results"!==x.type||"results"!==S.type)return;const M=x.blockIds.length>0,A=S.blockIds.length>0;if(!d)return{hasCurrentSprint:M,hasNextSprint:A,hasLastSprint:!1};const C=b.data.result.reducerResults[r().el];if("results"!==C.type)return;return{hasCurrentSprint:M,hasNextSprint:A,hasLastSprint:C.blockIds.length>0}}),[n,o,t]);if("resolved"!==a||!i)return;return i}({sprintCollectionStore:(0,a().K8)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:n,normalizedBlockSchema:v}),x=(0,u().tz)(),S=(0,o.useCallback)((e=>void 0===b&&[r().tO,r().Xk,r().el].includes(e)?{disabled:!0}:e===r().tO&&null!=b&&b.hasNextSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToNextTooltip)}:e===r().Xk&&null!=b&&b.hasCurrentSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToCurrentTooltip)}:e===r().el&&null!=b&&b.hasLastSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToLastTooltip)}:{disabled:!1}),[b,x]);return(0,f.jsx)(g().r,{...e,shouldDisableOption:S})}},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>l,xw:()=>r});var o=()=>n(416504),i=()=>n(317909),a=()=>n(755199);function r(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),a=null==i?void 0:i.time_zone,r=(0,o().P)();a!==r&&s({environment:t,userSettingsStore:n,timeZone:r})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{a().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{a().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},946576:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(296540),i=()=>n(484714),a=()=>n(401497),r=()=>n(75756),s=()=>n(959013),l=()=>n(284371),d=()=>n(673998),c=()=>n(991385),u=()=>n(799089),p=()=>n(455215),m=()=>n(493823),g=()=>n(204063),f=n(474848);function h(){const e=(0,i().v3)().currentUser.id;(0,o.useEffect)((()=>{if(!e)return;(0,c().S)(e);const t=window.setInterval((()=>{(0,c().S)(e)}),n(720665).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(56366).K8)((()=>u().A.state.open),[]),a=x();return(0,f.jsx)(n(641514).A,{onDismiss:n(496603).lQ,render:()=>(0,f.jsx)("div",{style:a.modal,children:(0,f.jsxs)(n(21140).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:a.image,src:n(148307).A.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:a.title,children:(0,f.jsx)(s().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:a.description,children:(0,r().Qq)(d().N6,"banner")}),(0,f.jsx)(y,{}),(0,f.jsx)(v,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function y(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(g().A,{size:"lg",style:e.acceptAllButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(s().sA,{...r().LS.acceptAllButtonLabel})})}function v(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(m().p,{size:"lg",isGray:!0,style:e.moreOptionsButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(s().sA,{...r().LS.rejectAllButtonLabel})})}function b(){const e=x();return(0,f.jsx)(p().A,{hasDismissButton:!0,onDismiss:()=>{u().A.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(m().p,{...t,size:"lg",isGray:!0,style:e.moreOptionsButton,children:(0,f.jsx)(s().sA,{...r().LS.moreOptionsButtonLabel})})})}function x(){return(0,a().IS)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const S=o.memo(h)},948352:(e,t,n)=>{n.d(t,{M:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("templatesColor",{viewBox:"0 0 20 20",svg:(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z",fill:"#3C9ED7"}),(0,o.jsx)("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z",fill:"#E7595E"}),(0,o.jsx)("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z",fill:"#F5BC4E"})]})})},952305:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(401497),r=()=>n(148307),s=()=>n(959013),l=()=>n(284371),d=()=>n(209660),c=()=>n(963575),u=()=>n(931432),p=()=>n(493823),m=()=>n(957986),g=()=>n(204063),f=n(474848);function h(){const e=(0,o().Y0)(),t=(0,i().K8)((()=>u().A.state.open),[]),n=()=>{u().A.state.open&&u().A.state.onDecline&&u().A.state.onDecline(),u().A.setState({open:!1})},h=()=>{u().A.state.open&&u().A.state.onConfirm(),u().A.setState({open:!1})},y=()=>{n(),d().Ow({currentTab:"connected_apps"})},v=(0,a().IS)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l().Wy.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(m().A,{open:t,innerStyle:v.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsxs)("div",{style:v.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r().A.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(s().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(s().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(g().A,{size:"lg",onClick:h,children:(0,f.jsx)(s().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:c().A.vertical.tiny},children:(0,f.jsx)(p().p,{isGray:!0,size:"xs",showUnderline:!0,onClick:y,children:(0,f.jsx)(s().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]}),onDismiss:n})}},952451:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>re});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(401497),s=()=>n(66689),l=()=>n(959013),d=()=>n(346705),c=(n(581454),()=>n(148307)),u=n(474848);const p=(0,n(340498).wt)("drawing",{viewBox:"0 0 12 12",svg:(0,u.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})});var m=()=>n(370446),g=()=>n(284371),f=()=>n(972435),h=()=>n(755170),y=()=>n(997415),v=()=>n(854672),b=()=>n(132389),x=()=>n(125565);const S=(0,l().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),M=[{icon:"📅",taskName:f().A.formatMessage(S.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})},{icon:"📚",taskName:f().A.formatMessage(S.dummyTask2),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:f().A.formatMessage(S.dummyTask3),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:f().A.formatMessage(S.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})},{icon:"🚧",taskName:f().A.formatMessage(S.dummyTask5),status:"Not Started",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:f().A.formatMessage(S.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})}],A={Blocked:"red","In Progress":"blue","Not Started":"gray"};function C(){const e=k();return(0,u.jsx)(h().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,u.jsx)("div",{style:{paddingLeft:4},children:(0,u.jsx)(v().A,{type:"app_package_asset",size:18,icon:c().A.images.appPackages.taskDbIconSvg})}),children:(0,u.jsx)("div",{style:e.dummyAssignedToMe,children:(0,u.jsx)(w,{})})})}function w(){const e=M.map(((e,t)=>(0,u.jsx)(j,{row:e},t)));return(0,u.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function j(e){let{row:t}=e;const n=k();return(0,u.jsxs)("div",{style:n.eachTask,children:[(0,u.jsxs)("div",{style:n.taskName,children:[(0,u.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,u.jsx)(x().A,{style:n.taskTitle,children:t.taskName})]}),(0,u.jsx)("div",{style:n.taskStatus,children:(0,u.jsx)(y().X,{type:"status",value:f().A.formatMessage(S[t.status]),color:A[t.status],groupColor:void 0})}),(0,u.jsx)(b().A,{size:8}),(0,u.jsxs)("div",{style:n.location,children:[(0,u.jsx)("span",{style:n.locationIndicator,children:f().A.formatMessage(S.locationIndicator)}),(0,u.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function k(){return(0,r().IS)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...g().RC},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4,maxWidth:48,...g().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(898992),n(354520),n(803949),n(737550);var I=()=>n(584262),T=()=>n(151744),P=()=>n(743176),_=()=>n(668725),B=()=>n(689094),L=()=>n(100622),R=()=>n(128427),D=()=>n(436572),O=()=>n(317909),N=()=>n(521358),E=()=>n(617254),F=()=>n(313892),U=()=>n(895876),V=()=>n(609429),K=()=>n(722872),z=()=>n(696746),W=()=>n(700250),H=()=>n(666429),G=()=>n(920773),Y=()=>n(760217),q=()=>n(406699),Q=()=>n(928600),$=()=>n(939740),Z=()=>n(204063),J=()=>n(89924),X=()=>n(690197);function ee(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,p=(0,i().v3)(),m=(0,l().tz)(),{isPhone:g,isMobileNative:f}=(0,i().Y0)(),h=(0,a().K8)((()=>g&&f),[g,f]),y=function(e){return(0,r().IS)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.mediumTextColor,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:L().Ay.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.lightTextColor},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.lightTextColor},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.lightTextColor}})),[e])}(g),v=(0,r().DP)(),[S,M]=(0,o.useState)(!1),A=(0,a().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),C=(0,a().K8)((()=>F().YH((0,E().appConfigs)(),n)),[n]),w=(0,a().K8)((()=>{if(A&&C)return F().DH(C,A)}),[C,A]),j=(0,o.useCallback)(((e,t)=>{const n=t.type;return F().Kb(e,t,A??{}).map((e=>{let[t,o]=e;return{key:t,title:null==o?void 0:o.name,icon:(0,u.jsx)(P().Ay,{size:16,style:y.propertyIcon,theme:v,icon:null==o?void 0:o.icon,type:(null==o?void 0:o.type)||n})}}))}),[v,y.propertyIcon,A]),k=(0,a().K8)((()=>{const e=Object.keys(C||{}).filter((e=>void 0!==(null==C?void 0:C[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(C||{}).forEach((e=>{let[n,o]=e;if(!o)return;const i=null==w?void 0:w[n];if(i)return void(t[n]=i);0===j(n,o).length&&(t[n]=T().Ul)})),t}),[C,w,j]),[ee,oe]=(0,o.useState)(k),ie=(0,o.useMemo)((()=>Object.entries(ee).some((e=>{let[t,n]=e;if(t===s().yx.Status){const e=null==A?void 0:A[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[A,ee]),ae=(0,o.useCallback)((e=>{const t=null==C?void 0:C[e],n={width:16,height:16,marginRight:10};if(!t)return null;const o=[...j(e,t),{key:T().Ul,title:m.formatMessage(te.createNew),icon:(0,B().W)({width:n.width,fill:y.propertyIcon.fill}),type:void 0}],i=ee[e],a=null==A?void 0:A[i||""],r=!i&&S,d=e===s().yx.Status;let c=null;return i===T().Ul?c=(0,B().W)(n):a&&(c=P().Yp[null==a?void 0:a.type](n)),(0,u.jsx)(q().Ay,{popupType:g?q().z7.SlideUp:q().z7.Popup,renderOrigin:t=>(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)(x().A,{isMultiline:!0,style:y.perPropertyInstruction,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:m.formatMessage(ne[e])}})}),(0,u.jsx)(Y().A,{disabled:1===o.length,disabledFeedback:!0,focused:!1,right:(0,u.jsxs)("div",{style:y.propertyMappingDropdown,children:[r?(0,u.jsx)("span",{style:y.requiredPropertyError,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,_().b)({...y.chevronDownIconEnabled,...r?{fill:L().Ay.red}:{}})]}),rightStyle:{marginRight:g?14:8},title:(0,u.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,i===T().Ul?m.formatMessage(te.createNew):a?a.name:m.formatMessage(te.select)]}),titleStyle:i?{display:"flex",alignItems:"center"}:y.propertyMappingTitle,itemMarginLeft:8,style:{...y.propertyMappingMenu,...r?{borderColor:L().Ay.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ie&&(0,u.jsx)(x().A,{isSmall:!0,isMultiline:!0,children:(0,u.jsx)("div",{style:y.propertyConversionCallout,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:W().UV.Bottom,alignmentToOrigin:W().MY.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,u.jsx)(J().A,{...e,topBorder:0!==e.index}),items:o.map((n=>{const o={key:n.key,render:t=>(0,u.jsx)(Y().A,{...t,icon:n.icon,title:n.title,checkState:ee[e]===n.key}),action:()=>{oe({...ee,[e]:n.key}),M(!1),t.close()}};return o}))}],i=g?{menuType:K().gu.ActionSheet}:{menuType:K().gu.Popup,width:250};return(0,u.jsx)(Q().A,{...i,children:(0,u.jsx)($().Ay,{type:$().Oh.Vertical,initialFocus:void 0,sections:n})})}},e)}),[C,j,m,y,ee,A,S,ie,g]),re=(0,o.useCallback)((()=>{var e,o;const i=t.collectionStore(),a=t.collectionViewBlockStore();if(!i||!a)return;const r=(0,z().XH)("main"),c=null==r||null===(e=r.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==r?void 0:r.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast}),g=(0,z().XH)("myTasks"),f=null==g||null===(o=g.getModel())||void 0===o?void 0:o.getRenderUrl({getRecordModel:null==g?void 0:g.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(ee)?M(!0):O().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:p,canUndo:!0,perform:e=>{N().bC({environment:p,collectionViewBlockStore:a,collectionStore:i,databaseType:n,propertyMapping:{...ee},typedPropertySchemas:{...C},transaction:e}),d().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===s().dC&&(V().e.locallyMutatedTasksDatabase=!0),(0,R().Y)({environment:p,database_type:n,property_mapping:ee,collectionContextStore:t});const o=h?(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,U().$O)(n),databaseName:i.getName()||m.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:y.a,href:f,children:e})}}):(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,U().$O)(n),databaseName:i.getName()||m.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:y.a,href:c,children:e})}});D().rL({item:{label:o,durationMs:H().LX},undoFunc:()=>{O().createAndCommit({environment:p,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{N().Fr({environment:p,collectionContextStore:t,transaction:e})}})}})}})}),[t,ee,p,n,C,h,m,y.a]);return(0,u.jsxs)("div",{style:c,children:[(0,u.jsxs)("div",{style:y.formTitle,children:[g?(0,u.jsx)("span",{style:y.emojiTitle,children:"📋"}):null,(0,u.jsx)(x().A,{style:y.propertyMappingInstructions,isMultiline:!0,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),g?(0,u.jsx)(b().A,{size:16}):null,Object.entries(k).map((e=>{let[t,n]=e;return ae(t)})),(0,u.jsxs)("div",{style:y.buttons,children:[(0,u.jsx)(Z().A,{style:y.submitMigrationButton,onClick:re,children:(0,u.jsx)(l().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,U().$O)(n)}})}),g?(0,u.jsx)(G().p,{style:y.closeButton,onClick:()=>d().A.reset(),children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,u.jsx)(X().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,U().$O)(n)}}),analyticsFrom:"set_database_type",href:z().hI,style:y.learnMore,buttonStyle:y.learnMoreButton})]})]})}const te=(0,l().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ne={[s().yx.Status]:te.taskStatus,[s().yx.Assign]:te.taskAssignee,[s().yx.DueDate]:te.taskDueDate};var oe=()=>n(957986),ie=()=>n(754002);const ae=32;function re(){const e=ce(),t=(0,i().Y0)(),n=(0,a().O$)(d().A);return n.isModalOpen?t.isPhone?(0,u.jsx)(ie()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,u.jsx)(de,{collectionContextStore:n.collectionContextStore})}):(0,u.jsx)(oe().A,{open:!0,onDismiss:()=>d().A.reset(),innerStyle:e.desktopInner,render:()=>(0,u.jsx)(le,{collectionContextStore:n.collectionContextStore})}):null}const se=450;function le(e){const t=ce();return(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,u.jsxs)("div",{style:t.title,children:[(0,u.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,u.jsx)(x().A,{isMultiline:!0,style:t.previewTitle,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,u.jsx)(b().A,{size:36}),(0,u.jsx)(C,{}),(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:s().dC,containerStyle:t.form})]})}function de(e){const t=ce();return(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:s().dC,containerStyle:t.phoneForm})}function ce(){return(0,r().IS)((e=>({desktopInner:{width:768,height:se,padding:ae},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:se,background:e.surface.wash,position:"absolute",top:-ae,right:-ae,padding:ae,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:ae}})),[])}},957568:(e,t,n)=>{n.r(t),n.d(t,{createRelationViewsModule:()=>m});var o=()=>n(970013),i=()=>n(206267),a=()=>n(179034),r=()=>n(869558),s=()=>n(183558),l=()=>n(44729),d=()=>n(246826),c=()=>n(317909),u=()=>n(594794),p=()=>n(630116);function m(e){const{environment:t,layoutStore:n,collectionStore:m,relationPropertyId:g}=e,f=m.getSchema(),h=g?f[g]:void 0;if(!h||!(0,o().nC)(h))return;const y=h.collection_pointer;if(!y)return;const v=h.property;if(!v)return;const b=p().md.createChildStore(m,y);if(!b)return;const x=b.getParentBlockStore();if(!x)return;const{performResult:S}=c().createAndCommit({environment:t,perform:e=>{const{inMemoryRecordCache:o}=x,p=d().Wv({environment:t,type:"collection_view",inMemoryRecordCache:o,transaction:e}),m=x.getSpaceId(),g=(0,s().Ay)(),f=(0,u().JH)({environment:t,table:r().Gy,spaceId:m}).id,y=p.pointer,S={id:f,type:"table",parent_id:y.id,parent_table:a().ev,space_id:m,alive:!0,name:h.name,format:{collection_pointer:b.pointer,property_filters:[{id:i().JW(),filter:{property:v,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],subitem_display_mode:"disabled",hide_linked_collection_name:!0}};c().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listAfter",args:{id:f}},transaction:e}),l().NI({childStore:p,parentStore:n,transaction:e}),d().eC({environment:t,table:r().Gy,value:S,inMemoryRecordCache:o,transaction:e});return{id:g,type:"views",collection_view_block_pointer:{...y,spaceId:m}}},canUndo:!0,userAction:"viewsModuleActions.createRelationViewsModule"});return S}},961842:(e,t,n)=>{n.d(t,{C8:()=>r,QN:()=>a});var o=()=>n(645873);const i={TopbarLayoutInfoButtonEducationTooltip:new(o().O2)("TopbarLayoutInfoButtonEducationTooltip",(()=>Promise.all([n.e(23806),n.e(86090)]).then(n.bind(n,484482)))),BuilderAddModuleButtonEducationTooltip:new(o().O2)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(63538).then(n.bind(n,889989))))},a=(0,o()._h)(i.TopbarLayoutInfoButtonEducationTooltip,(e=>e.default),{renderLoading:(e,t)=>t.children}),r=(0,o()._h)(i.BuilderAddModuleButtonEducationTooltip,(e=>e.default))},966711:(e,t,n)=>{n.d(t,{m:()=>a});var o=()=>n(56366),i=()=>n(396301);function a(){return(0,o().K8)((()=>(0,i().VR)()),[])}},971320:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},977802:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var o=n(296540),i=()=>n(484714),a=()=>n(56366),r=()=>n(334261),s=()=>n(449195),l=()=>n(377586),d=()=>n(351360),c=()=>n(796249),u=()=>n(712505),p=()=>n(401497),m=()=>n(651124),g=()=>n(390066),f=()=>n(576250),h=()=>n(315564),y=()=>n(965998),v=()=>n(340498),b=n(474848);const x={viewBox:"0 0 16 16",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("g",{clipPath:"url(#clip0_9208_17165)",children:(0,b.jsx)("path",{d:"M.9 3.685a.625.625 0 1 0 0 1.25h1a.625.625 0 1 0 0-1.25zm3 0a.625.625 0 1 0 0 1.25h7.8a.625.625 0 0 0 0-1.25zm-1.3 3.7a.625.625 0 1 0 0 1.25h1a.625.625 0 1 0 0-1.25zm10.8 0H5.6a.625.625 0 1 0 0 1.25h7.8a.625.625 0 1 0 0-1.25m1.7 3.68H7.3a.625.625 0 0 0 0 1.25h7.8a.625.625 0 1 0 0-1.25m-10.8 0a.625.625 0 0 0 0 1.25h1a.625.625 0 1 0 0-1.25z"})}),(0,b.jsx)("defs",{children:(0,b.jsx)("clipPath",{id:"clip0_9208_17165",children:(0,b.jsx)("path",{d:"M16 0v16H0V0z"})})})]})},S=(0,v().wt)("tableOfContentsSmall",x),M=(0,v().wt)("unlocked",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M2.49023 14.7227H8.89551C9.94824 14.7227 10.4746 14.1963 10.4746 13.0479V8.20801C10.4746 7.22363 10.085 6.69727 9.29883 6.57422V4.83105C9.29883 3.22461 10.3174 2.35645 11.541 2.35645C12.7646 2.35645 13.79 3.22461 13.79 4.83105V6.28711C13.79 6.76562 14.0703 7.01855 14.4395 7.01855C14.8018 7.01855 15.082 6.7793 15.082 6.28711V4.96094C15.082 2.36328 13.3525 1.1123 11.541 1.1123C9.72949 1.1123 8 2.36328 8 4.96094V6.54004H2.49023C1.43066 6.54004 0.911133 7.06641 0.911133 8.20801V13.0479C0.911133 14.1963 1.43066 14.7227 2.49023 14.7227ZM2.68848 13.5059C2.3877 13.5059 2.2373 13.3623 2.2373 13V8.25586C2.2373 7.89355 2.3877 7.76367 2.68848 7.76367H8.7041C9.00488 7.76367 9.14844 7.89355 9.14844 8.25586V13C9.14844 13.3623 9.00488 13.5059 8.7041 13.5059H2.68848ZM7.99316 21.1123C6.5918 21.1123 5.2793 21.8779 4.75293 23.375L5.78516 24.4141C5.94922 23.0811 6.87891 22.3564 7.99316 22.3564C9.2168 22.3564 10.2422 23.2246 10.2422 24.8311V26.54H7.9248L9.1416 27.7637H11.0078C11.3086 27.7637 11.4521 27.8936 11.4521 28.2559V30.0742L12.7783 31.4072V28.208C12.7783 27.2031 12.3682 26.6768 11.541 26.5674V24.9609C11.541 22.3633 9.81152 21.1123 7.99316 21.1123ZM13.749 35.126C13.9609 35.3379 14.3164 35.3379 14.5215 35.126C14.7266 34.9072 14.7334 34.5723 14.5215 34.3535L2.46973 22.3154C2.25781 22.1035 1.90918 22.0967 1.69043 22.3154C1.48535 22.5205 1.48535 22.876 1.69043 23.0811L13.749 35.126ZM4.79395 34.7227H11.1992C11.5 34.7227 11.7598 34.6816 11.9785 34.5928L10.8711 33.4922C10.8096 33.499 10.7549 33.5059 10.6865 33.5059H4.99219C4.69141 33.5059 4.54102 33.3623 4.54102 33V28.2559C4.54102 27.9004 4.68457 27.7637 4.97852 27.7637H5.14258L4.04883 26.6631C3.48828 26.8818 3.21484 27.3809 3.21484 28.208V33.0479C3.21484 34.1963 3.73438 34.7227 4.79395 34.7227Z"})});var A=()=>n(959013),C=()=>n(284371),w=()=>n(896628),j=()=>n(246826),k=()=>n(317909),I=()=>n(989423),T=()=>n(722872),P=()=>n(557198),_=()=>n(493823),B=()=>n(678553),L=()=>n(89924),R=()=>n(946548),D=()=>n(867159);const O=function(e){let{store:t,locked:o}=e;const s=(0,i().v3)(),l=(0,A().tz)(),d=(0,a().uB)(void 0,n(455425).A),{device:c}=s,u=(0,a().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);let p;p=c.isMobile?{menuType:T().gu.Modal,right:(0,b.jsx)(n(45552).DoneMenuText,{}),onClickRight:r().VN,title:l.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:T().gu.Popup,minWidth:300};const f=(0,a().K8)((()=>function(e,t){const n=e.getFormat();if(!t)return{};const o=(0,g().L)(n,t,void 0,m().jf.Collection);return o}(t,t.getSchema())),[t]),h=(0,a().K8)((()=>d.state.justUnlocked),[d]);return(0,b.jsxs)(n(928600).A,{...p,children:[(o||h)&&(0,b.jsx)(K,{lockStore:d}),(0,b.jsx)(N,{store:t,locked:o,lockStore:d,format:f,isSyncedCollection:u,device:c})]})};function N(e){let{format:t,isSyncedCollection:n,store:o,locked:i,lockStore:r,device:l}=e;const d=(0,a().K8)((()=>o.getSchema()),[o]),c=function(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}(t),{pageSectionVisibility:u}=c,p=(0,a().K8)((()=>(0,s().vk)(u)),[u]),m=(0,a().K8)((()=>o.isCollectionView()),[o]),g=!l.isMobile&&!m;if(!d||!o)return null;if(!c)return null;if(!u)return null;const f={topLevelDiscussions:!n,backLinks:!0,floatingTableOfContents:g,pageComments:!n},h={locked:i,store:o,format:t},y=(0,b.jsxs)(b.Fragment,{children:[f.backLinks&&(0,b.jsx)(F,{...h}),f.topLevelDiscussions&&(0,b.jsx)(E,{pageVisibility:u.comments,...h}),f.floatingTableOfContents&&(0,b.jsx)(U,{pageVisibility:u.comments,...h,store:o}),f.pageComments&&(0,b.jsx)(V,{pageVisibility:p,...h})]});return(0,b.jsx)(L().A,{style:{opacity:i?.5:1},children:(0,b.jsx)("div",{style:{marginLeft:8},children:y})})}function E(e){let{pageVisibility:t,locked:n,store:a,format:s}=e;const l=(0,i().v3)(),d="section_show"===t,c=(0,o.useCallback)((()=>{const e="section_show"===t?"section_hide":"section_show";r().OD({environment:l,pageSection:"comments",visibility:e,store:a,format:s})}),[l,s,t,a]),u=(0,p().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]);return(0,b.jsx)(B().A,{title:(0,b.jsx)(A().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"}),icon:(0,y().M)({height:16,width:16}),right:(0,b.jsx)("div",{style:u.switcherButtonContainer,children:(0,b.jsx)(R().A,{disabled:n,on:d,onClick:c})})})}function F(e){let{locked:t,store:n,format:o}=e;const{backlinksVisibility:i,updateBacklinksVisibility:a}=(0,P().Ap)({store:n,format:o});return(0,b.jsx)(B().A,{title:(0,b.jsx)(A().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,f().y)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,b.jsx)(D().p7,{currentVisibility:i,onSelect:a,disabled:t})})}function U(e){let{pageVisibility:t,locked:n,store:r,format:s}=e;const l=(0,p().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]),d=(0,i().v3)(),c=(0,a().K8)((()=>{var e;return"off"!==(null===(e=r.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[r]),u=(0,o.useCallback)((()=>{k().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{j().zv({store:r.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,I().u4)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[r,d,c]);return(0,b.jsx)(B().A,{title:(0,b.jsx)(A().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:S({height:16,width:16}),right:(0,b.jsx)("div",{style:l.switcherButtonContainer,children:(0,b.jsx)(R().A,{disabled:n,on:c,onClick:u})})})}function V(e){let{pageVisibility:t,locked:n,store:o,format:a}=e;const s=(0,i().v3)();return(0,b.jsx)(B().A,{title:(0,b.jsx)(A().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,y().M)({height:16,width:16}),right:(0,b.jsx)(D().J8,{currentVisibility:t,disabled:n,onSelect:e=>{r().OD({environment:s,pageSection:"margin_comments",visibility:e,store:o,format:a})}})})}function K(e){let{lockStore:t}=e;const n=(0,p().DP)(),r=(0,i().v3)(),l=(0,o.useCallback)((()=>function(e,t){const n=s().SE();if(!n)return!1;const o=n.getParentBlockStore();o&&(k().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:e,canUndo:!0,perform:t=>{w()._l({environment:e,store:o,isLocked:!s().ln(),transaction:t})}}),t.setState({justUnlocked:!t.state.justUnlocked}))}(r,t)),[r,t]),d=(0,a().K8)((()=>t.state.justUnlocked),[t]);return(0,b.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${n.regularDividerColor}`,borderBottom:`1px solid ${n.regularDividerColor}`,background:n.surface.wash,color:n.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,b.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:d?M({height:12,width:12,fill:n.mediumIconColor}):(0,h().S)({height:12,width:12,fill:n.mediumIconColor})}),d?(0,b.jsx)(A().sA,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,b.jsx)(A().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,b.jsx)(_().p,{style:{fontSize:12,color:n.mediumTextColor,fontWeight:C().Wy.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:l,children:d?(0,b.jsx)(A().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,b.jsx)(A().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}const z=function(){const e=(0,i().v3)(),{device:t}=e,o=(0,a().O$)(c().A);return(0,b.jsx)(n(14235).Ay,{popupType:t.isMobile?l().n.SlideUp:l().n.Popup,alignmentToOrigin:n(962730).C.Center,open:o.isOpen,render:()=>(0,b.jsx)(W,{}),originRect:o.isOpen?o.rect:void 0,onDismiss:()=>r().VN(),trapFocus:!0})};function W(){const e=(0,a().O$)(c().A),t=(0,a().K8)((()=>u().default.state.open&&u().default.state.targetStore||d().default.state.mainEditorCurrentBlockStore),[]),n=(0,a().K8)((()=>s().ln()),[]);return e.isOpen&&t?(0,b.jsx)(O,{store:t,locked:n}):null}},986863:(e,t,n)=>{n.d(t,{u:()=>a});var o=()=>n(645873);const i=new(o().O2)("teamPermissionsInviteWithModal",(async()=>await Promise.all([n.e(23806),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(49889),n.e(97727),n.e(55373),n.e(29151),n.e(16908),n.e(62475),n.e(3151),n.e(98629),n.e(58550),n.e(22900),n.e(85128),n.e(95555),n.e(90409),n.e(63077),n.e(74562),n.e(95794),n.e(46414),n.e(8184),n.e(99353),n.e(52681),n.e(14518),n.e(17713),n.e(28271),n.e(17254),n.e(4422),n.e(59794),n.e(67435),n.e(75355),n.e(48315),n.e(47123),n.e(847),n.e(5887),n.e(70769),n.e(97965),n.e(17989),n.e(3965),n.e(38911),n.e(9034),n.e(52012),n.e(56985),n.e(50142),n.e(20838),n.e(21627),n.e(88860),n.e(83210),n.e(26090),n.e(82472),n.e(96345),n.e(10596),n.e(73285),n.e(75659),n.e(78846),n.e(47858),n.e(13324),n.e(51860),n.e(15724),n.e(81141),n.e(27274),n.e(99346),n.e(92448),n.e(65638),n.e(72915),n.e(28721),n.e(69689),n.e(23463),n.e(25426),n.e(6463),n.e(91056),n.e(26483),n.e(29333),n.e(5396),n.e(1440),n.e(34576),n.e(95810),n.e(89109),n.e(3560),n.e(77169),n.e(24071),n.e(68610),n.e(67064),n.e(49978),n.e(3720),n.e(47762),n.e(85475),n.e(11740),n.e(97996),n.e(5066),n.e(35299),n.e(68117),n.e(14267),n.e(33731),n.e(30016),n.e(14410),n.e(49471),n.e(31185),n.e(75681)]).then(n.bind(n,487443)))),a=(0,o()._h)(i,(e=>e.TeamPermissionsInviteWithModal))},996594:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M,getSpaceViewMenuItems:()=>A});n(944114),n(296540);var o=()=>n(484714),i=()=>n(56366),a=()=>n(959013),r=()=>n(624550),s=()=>n(34542),l=(n(898992),n(354520),()=>n(496603));var d=()=>n(722872),c=()=>n(437622),u=()=>n(719431),p=()=>n(377586),m=()=>n(351360),g=()=>n(520257),f=()=>n(760217),h=()=>n(928600),y=()=>n(939740),v=()=>n(45552),b=()=>n(614505),x=()=>n(89924),S=n(474848);const M=function(){const e=(0,o().v3)(),{device:t}=e,a=(0,i().O$)(g().A);return(0,S.jsx)(n(14235).Ay,{popupType:t.isMobile?p().n.SlideUp:p().n.Popup,open:a.open,render:()=>(0,S.jsx)(C,{}),originGap:8,onDismiss:r().Ew,originRect:a.originRect,enableRounding:!0})};function A(e,t){const{device:n}=e,{currentUserRootStore:o}=m().default.state;if(!o)return[];const{editableStores:i}=function(e){const t=l().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),o=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:o.length,editableStores:o}}(o),a=[];for(const r of i){const o=r.getSpaceStore();if(null!=o&&o.isReady()&&o.canEdit()){const i=(0,c().GK)(e,o),l=(0,c().c2)(e,o);a.push({key:r.id,action:async()=>{await s().Fq({environment:e,blockStore:t,spaceStore:o,spaceViewStore:r})},render:e=>(0,S.jsx)(f().A,{title:i,icon:(0,S.jsx)(b().A,{icon:l,isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return a}function C(){const e=(0,o().v3)(),{device:t}=e,n=(0,i().O$)(g().A),s=(0,i().K8)((()=>m().default.state.currentUserRootStore),[]),l=(0,i().K8)((()=>n.store?A(e,n.store):[]),[e,n]);if(!n.open||!s)return null;const c=[{key:"spaces",render:e=>(0,S.jsx)(x().A,{title:t.isMobile?void 0:(0,S.jsx)(a().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:l},{key:"logout",render:e=>(0,S.jsx)(x().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>u().logout(e),render:e=>(0,S.jsx)(w,{...e})}]}];let p;return p=t.isMobile?{menuType:d().gu.Modal,title:(0,S.jsx)(a().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,S.jsx)(v().CancelMenuText,{}),onClickRight:r().Ew}:{menuType:d().gu.Popup},(0,S.jsx)(h().A,{...p,children:(0,S.jsx)(y().Ay,{type:y().Oh.Vertical,sections:c,initialFocus:1})})}function w(e){const t=(0,i().K8)((()=>{const{currentUserStore:e}=m().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,S.jsx)(f().A,{caption:(0,S.jsx)(a().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}}}]);