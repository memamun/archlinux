(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14267,35599],{3197:(e,t,o)=>{"use strict";o.d(t,{t:()=>s});var n=o(296540),i=()=>o(183558),r=()=>o(248064),a=()=>o(384130),l=()=>o(937199);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,l().LH)(),s=(0,r().h)(),{dismissTooltip:c}=(0,a().J)();return(0,n.useCallback)((()=>{var n;"form"===(null===(n=o.getModel())||void 0===n?void 0:n.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,i().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&c())}),[o,e,s,t,c])}},38e3:(e,t,o)=>{"use strict";o.d(t,{$:()=>p,Q:()=>g});o(16280);var n=()=>o(179034),i=()=>o(869558),r=()=>o(44729),a=()=>o(246826),l=()=>o(317909),s=()=>o(594794),c=()=>o(972435),d=()=>o(630116),u=()=>o(435930);function p(e){const{environment:t,layoutStore:o,transaction:n,options:i}=e,{inMemoryRecordCache:l}=o,s=o.getSpaceId(),c=o.getParentPointer();if(!c||"collection"!==c.table)throw new Error("Invalid state: no collection pointer");if(!s)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const d=a().Wv({environment:t,type:"collection_view",inMemoryRecordCache:l,transaction:n});r().NI({childStore:d,parentStore:o,transaction:n});const{collectionViewStore:u}=g({environment:t,transaction:n,layoutStore:o,collectionViewBlockStore:d,options:i});return{collectionViewStore:u,collectionViewBlockStore:d}}function g(e){const{environment:t,transaction:o,layoutStore:r,collectionViewBlockStore:p,options:g}=e,{inMemoryRecordCache:m}=r,f=r.getParentPointer();if(!f||"collection"!==f.table)throw new Error("Invalid state: no collection pointer");const y=r.getSpaceId();if(!y)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const S=(0,s().JH)({environment:t,table:i().Gy,spaceId:y}),h={id:S.id,type:"page",parent_id:p.pointer.id,parent_table:n().ev,space_id:y,alive:!0,name:c().A.formatMessage(u().s.editor),format:{collection_pointer:f,hide_linked_collection_name:!0}};return null!=g&&g.viewsTabId&&(h.format={...h.format,page_layout_pointer:{...r.pointer,views_main_tab_id:g.viewsTabId}}),a().eC({environment:t,table:i().Gy,value:h,inMemoryRecordCache:m,transaction:o}),l().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listBefore",args:{id:S.id}},transaction:o}),{collectionViewStore:d().pS.createChildStore(p,S)}}},39039:(e,t,o)=>{"use strict";o.d(t,{gZ:()=>h,j7:()=>f,tx:()=>S});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),a=()=>o(534177),l=()=>o(374562),s=()=>o(313892),c=()=>o(760217),d=()=>o(972435),u=()=>o(760578),p=o(474848);const g=(0,o(959013).YK)({property:{id:"customizeMenu.propertyMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# property} other {# properties}} to {databaseName}"},view:{id:"customizeMenu.viewMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# view} other {# views}} to {databaseName}"}}),m={property:g.property,collection_view:g.view,collection:void 0,sub_external_collection:void 0,collection_view_block:void 0,page_template:void 0,block:void 0,database_template:void 0};function f(e){const{collectionContextStore:t,buttonMenuItemProps:o,feature:a,caption:l,onClick:s,isDisabled:d,icon:u,right:g}=e,m=(0,n().Y0)(),f=(0,i().K8)((()=>t.databaseType),[t]),S=(0,r().IS)((()=>({menuItem:{display:"flex",paddingTop:m.isMobile?12:6,paddingBottom:m.isMobile?12:6,alignItems:"center",opacity:d?.4:void 0},featureName:{fontSize:m.isMobile?16:13},featureCaption:{fontSize:m.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"},featureTextWrapper:{lineHeight:m.isMobile?"20px":"18px"}})),[m,d]);return(0,p.jsx)(c().A,{...o,style:S.menuItem,icon:u,dontShrinkIcon:!0,title:(0,p.jsxs)("div",{style:S.featureTextWrapper,children:[(0,p.jsx)("div",{style:S.featureName,children:y(a,f)}),(0,p.jsx)("div",{style:S.featureCaption,children:l})]}),disabled:d,onClick:s,right:!d&&g})}function y(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().mv)({feature:"subitem",databaseType:t});return d().A.formatMessage(o,e)}return e.name}function S(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().I_)({feature:"subitem",databaseType:t});return d().A.formatMessage(o,e)}return e.description}function h(e,t){if(e.uri!==(0,l().md)().uri&&e.uri!==(0,l().J4)().uri&&((0,s().lK)(e)||(0,s().u1)(e))){const o={property:0,collection_view:0,collection:0,sub_external_collection:0,collection_view_block:0,page_template:0,block:0,database_template:0};for(const t of e.dependencies)t.type in o&&o[t.type]++;let n="";for(const e of(0,a().uv)(m))if(o[e]>0){const i=m[e];if(!i)continue;n+=`${d().A.formatMessage(i,{dependencyCount:o[e],databaseName:t})}\n`}return n}}},50170:(e,t,o)=>{"use strict";o.d(t,{u:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("collectionList",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},56516:(e,t,o)=>{"use strict";o.d(t,{GS:()=>Re,CJ:()=>Pe,is:()=>Ue,Ct:()=>Ke,Ay:()=>Ie});o(16280),o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(651124),s=()=>o(582684),c=()=>o(202017),d=()=>o(566910),u=()=>o(212727),p=()=>o(200582),g=()=>o(340498),m=o(474848);const f={viewBox:"0 0 20 20",svg:(0,m.jsx)("path",{d:"M2.7 7.519c0 .39.421.633.757.436L6.05 6.437a.506.506 0 0 0 0-.874L3.457 4.045a.503.503 0 0 0-.757.436zm5.8-2.144a.625.625 0 1 0 0 1.25H16a.625.625 0 1 0 0-1.25zm0 8a.625.625 0 1 0 0 1.25H16a.625.625 0 1 0 0-1.25zm-5.043 2.58a.503.503 0 0 1-.757-.436V12.48c0-.39.421-.633.757-.436l2.593 1.518a.506.506 0 0 1 0 .874z"})},y=(0,g().wt)("listToggle",f);var S=()=>o(406533);const h={viewBox:"0 0 20 20",svg:(0,m.jsx)("path",{d:"M3.925 2.95a.55.55 0 1 0 0 1.1h12.15a.55.55 0 1 0 0-1.1zm0 7.767a.55.55 0 0 0 0 1.1h12.15a.55.55 0 1 0 0-1.1zm-.55-4.234a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1h-1.8a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm4.625-1.1a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6zm3.625-1.7a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1h-1.8a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm-9.55 6.667a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6zm3.625-1.7a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1H9.1a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm4.625-1.1a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6z"})},v=(0,g().wt)("squareGridBelowLines",h);var x=()=>o(969523),C=()=>o(959013),b=()=>o(534177),w=()=>o(284371),j=()=>o(208459),A=()=>o(436696),_=()=>o(686526),M=()=>o(980151),k=()=>o(317909),I=()=>o(837570),T=()=>o(654062),P=()=>o(315564),B=()=>o(916727),R=()=>o(125565);function V(e){const{style:t}=e,o=(0,a().DP)(),n=(0,i().WS)(),r=(0,m.jsx)("div",{style:{marginTop:1},children:(0,P().S)({width:14,marginRight:8,height:void 0})}),l=(0,m.jsx)(R().A,{style:{color:o.regularTextColor,lineHeight:w().K_.UISmall.desktop},isSmall:!0,children:(0,m.jsx)(C().sA,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,m.jsx)(B().F,{icon:r,title:l,style:n?{backgroundColor:o.surface.wash,boxShadow:o.shadow2XS,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,m.jsx)(R().A,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,m.jsx)(C().sA,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var F=()=>o(201440),K=()=>o(901389),D=()=>o(89924);(0,C().YK)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});var L=()=>o(95347),O=()=>o(186445),E=()=>o(682146),z=()=>o(726483),N=()=>o(972435),U=()=>o(731320),H=()=>o(760578),W=()=>o(37433),G=()=>o(963589),q=()=>o(162674),Y=()=>o(885749),$=()=>o(665579),Q=()=>o(610101),Z=()=>o(351360),J=()=>o(557336),X=()=>o(705602),ee=(o(581454),()=>o(896628));const te=function(e){let{collectionContextStore:t}=e;const n=(0,i().v3)(),a=(0,r().O$)(t.normalizedFormatStore),s=(0,r().O$)(t.isFullScreenStore),c=(0,r().K8)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),d=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,l().i3)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),u=(0,r().O$)(t.permissionScopesStore);return a.collection_group_by||"feed"===c||!s&&"calendar"!==c?(0,m.jsx)(o(828973).A,{title:(0,m.jsx)(C().sA,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:d,popupStyle:{minWidth:190},options:l().X9.map((e=>({key:e,type:"button",title:(0,m.jsx)(C().sA,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;k().createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,canUndo:!0,perform:t=>{ee().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),(0,A().X)({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,n,t),disabled:!u.canConfigureBlock,icon:o(655923).v}):null};var oe=()=>o(735695),ne=()=>o(497222),ie=()=>o(812480),re=()=>o(614525),ae=()=>o(364871),le=()=>o(236262),se=()=>o(797265);const ce=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),{collectionViewBlockStore:a,permissionScopes:l,isLinkedCollectionView:s}=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return{collectionViewBlockStore:e,permissionScopes:t.permissionScopesStore.state,isLinkedCollectionView:null==e?void 0:e.isLinkedCollectionView()}}),[t]),c=(0,r().K8)((()=>l.canConfigureBlock),[l.canConfigureBlock]),d=(0,r().K8)((()=>1===(null==a?void 0:a.getCollectionViewIds().length)),[a]);if(!a||!c)return null;const u=s&&d?(0,m.jsx)(C().sA,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithOneViewButton.title"}):s?(0,m.jsx)(C().sA,{defaultMessage:"Delete all views",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithMultipleViewsButton.title"}):(0,m.jsx)(C().sA,{defaultMessage:"Delete database",id:"database.viewSettings.mainTab.deleteDatabaseButton.title"});return(0,m.jsx)(ne().A,{icon:le().I,title:u,isRed:!0,onClick:()=>function(e,t,o){var n;const i=t.collectionViewBlockStore();if(!i)return;const r=i.isLinkedCollectionView();(0,A().X)({environment:e,collectionContextStore:t,action:"click_delete_database",original_view_type:null===(n=t.collectionViewStore())||void 0===n?void 0:n.getType()}),K().ui({showCancel:!0,keepFocus:!1,message:r?(0,m.jsx)(C().sA,{defaultMessage:"Are you sure you want to delete this linked view?",id:"database.viewSettings.mainTab.deleteLinkedDatabaseConfirm.text"}):(0,m.jsx)(C().sA,{defaultMessage:"Are you sure you want to delete this database?",id:"database.viewSettings.mainTab.deleteDatabaseConfirm.text"}),items:[{label:(0,m.jsx)(C().sA,{defaultMessage:"Delete",id:"database.viewSettings.deleteDatabaseButton.text"}),color:"red",onAccept:async()=>{await se().Af({environment:e,blocks:[i],shouldCheckSuggestEdit:!0})}}]})}(n,t)})};var de=()=>o(340643),ue=()=>o(704640),pe=()=>o(230751),ge=()=>o(594952),me=()=>o(617668),fe=()=>o(836251),ye=()=>o(937199),Se=()=>o(3197),he=()=>o(112698),ve=()=>o(597898),xe=()=>o(95441),Ce=()=>o(58488);function be(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,r().K8)((()=>t.collectionViewStore()),[t]),i=(0,r().K8)((()=>{if(!n)throw new Error("No CollectionViewStore found");return n.getFormBlockStore()}),[n]),a=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.getCollectionViewIds().length>1}),[t]);return n&&i?(0,m.jsxs)(Ce().I,{children:[(0,m.jsxs)(D().A,{children:[(0,m.jsx)(we,{}),(0,m.jsx)(Re,{collectionSettingsStore:o,collectionContextStore:t}),(0,m.jsx)(je,{collectionSettingsStore:o})]}),(0,m.jsxs)(D().A,{topBorder:!0,children:[a&&(0,m.jsx)(Ae,{collectionSettingsStore:o,collectionContextStore:t,collectionViewStore:n,formBlockStore:i}),(0,m.jsx)(_e,{})]})]}):null}function we(){const{canEditLayout:e}=(0,ye().LH)(),t=(0,Se().t)({area:"form_layout_schema"});return(0,m.jsx)(ne().A,{icon:me().plusIcon,title:(0,m.jsx)(C().sA,{id:"formEditSettings.newQuestion.title",defaultMessage:"New question"}),onClick:t,disabled:!e})}function je(e){let{collectionSettingsStore:t}=e;const{userId:o,spaceId:n}=(0,r().K8)((()=>{var e,t;return{userId:null===(e=Z().default.state.currentUserStore)||void 0===e?void 0:e.id,spaceId:null===(t=Z().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),i=(0,ve()._X)({name:"form_customization",spaceId:n,userId:o}),a="unavailable"===(null==i?void 0:i.type)&&i.upsell;return(0,m.jsx)(ne().A,{onClick:()=>{_().a2({collectionSettingsStore:t,item:{type:"formCustomizeSettings"}})},icon:ge().I,title:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",height:20},children:[(0,m.jsx)(C().sA,{defaultMessage:"Customize form",id:"formEditSettings.customizeForm.title"}),a&&(0,m.jsx)(he().B,{upsell:i.upsell,analyticsName:"forms_customize_settings",desktopStyle:{marginLeft:5}})]}),showChevron:!0})}function Ae(e){let{collectionContextStore:t,collectionSettingsStore:o,collectionViewStore:r,formBlockStore:a}=e;const{canEditLayout:l}=(0,ye().LH)(),s=(0,i().v3)(),c=(0,n.useCallback)((async()=>{await _().nl({environment:s,collectionContextStore:t,collectionViewStore:r,collectionSettingsStore:o,additionalBlocksToDelete:[a],from:"view_settings"})}),[s,t,r,o,a]);return(0,m.jsx)(ne().A,{icon:le().I,title:(0,m.jsx)(C().sA,{id:"formEditSettings.deleteForm.title",defaultMessage:"Delete form"}),onClick:c,disabled:!l})}function _e(){return(0,m.jsx)(xe().A,{title:(0,m.jsx)(C().sA,{defaultMessage:"Learn about forms",id:"formEditSettings.learnAboutForms.title"}),href:(0,fe().xS)("guides.forms"),analyticsFrom:"form_edit_settings"})}var Me=()=>o(448701);const ke=o(757695).default.createClass(!1,{name:"ShowViewDescriptionStore"});const Ie=function(e){const{collectionContextStore:t,collectionViewStore:a,selectViewNameInitial:l,collectionSettingsStore:s}=e,c=(0,i().v3)(),d=(0,r().uB)(void 0,ke),u=(0,r().K8)((()=>t.isInHomeWidgetStore.state),[t]),p=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,O().sj)(o)}),[t]),g=(0,n.useCallback)((e=>function(e,t,o,n){const i=null==n?void 0:n.getFormat().description;if(!n||e===i)return;k().createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,canUndo:!0,perform:t=>{(0,T().F)({collectionViewStore:n,update:{format:{...n.getFormat(),description:e}},transaction:t})}}),(0,A().X)({environment:t,collectionContextStore:o,action:"set_description"})}(e,c,t,a)),[c,t,a]),f=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),y=(0,r().K8)((()=>a.isDefined()),[a]),{description:S}=(0,r().K8)((()=>a.getFormat()),[a]),h=(0,r().K8)((()=>a.getType()),[a]),v=(0,r().O$)(d),x=(0,r().K8)((()=>"viewsMain"===t.viewsModuleContextStore.getViewModuleType()),[t]);if(!y||!f)return null;const b=(0,m.jsx)(o(395859).A,{collectionViewStore:a,collectionContextStore:t,showViewDescriptionStore:d,selectViewNameInitial:l});if("page"===h)return(0,m.jsxs)(oe().Ay,{...e,title:(0,m.jsx)(C().sA,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[b,v&&(0,m.jsx)(X().y,{initialDescription:S,handleSaveDescription:g})]});let w;if("chart"===h)w=(0,m.jsx)(o(309920).X,{collectionSettingsStore:s});else if("form_editor"===h)w=(0,m.jsx)(be,{collectionContextStore:t,collectionSettingsStore:s});else{if(u)return(0,m.jsx)(He,{collectionContextStore:t,collectionSettingsStore:s,viewNameInput:b});w=(0,m.jsx)(Ne,{collectionContextStore:t,collectionSettingsStore:s,isMyTasks:p,isConfiguringViewsMainModule:x})}return(0,m.jsxs)(oe().Ay,{...e,title:"form_editor"===h?(0,m.jsx)(C().sA,{defaultMessage:"Form options",id:"database.viewSettings.formTab.title"}):(0,m.jsx)(C().sA,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,m.jsx)(Pe,{collectionContextStore:t}),b,v&&(0,m.jsx)(X().y,{initialDescription:S,handleSaveDescription:g}),w]})};function Te(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function Pe(e){let{collectionContextStore:t}=e;return(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,m.jsx)(V,{})}function Be(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,r().O$)(o.currentSubitemFormatStoreForCollectionStore),i=(0,r().K8)((()=>o.databaseType),[o]),a=(0,r().K8)((()=>(0,J().QZ)({feature:"subitem",collectionContextStore:o})),[o]),l=(0,r().K8)((()=>function(e,t){const o=t.permissionScopesStore.state,n=(0,b().O9)(e),i=o.canConfigureBlock;return n||i}(n,o)),[o,n]),s=(0,r().K8)((()=>function(e){let t;return t=e?H().Ic.relationFeatureOnMessage:H().Ic.relationFeatureOffMessage,N().A.formatMessage(t)}(a)),[a]);return(0,m.jsx)(ne().A,{icon:y,title:(0,m.jsx)(C().sA,{...(0,H().mv)({feature:"subitem",databaseType:i})}),showChevron:!0,right:s,onClick:()=>{_().a2({collectionSettingsStore:t,item:{type:"subitemV2",from:"view_options"}})},disabled:!l})}function Re(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>(0,z().aS)(t)),[t]),l=(0,r().O$)(t.aliveAutomationCountStore),s=(0,r().K8)((()=>(0,z().rc)({collectionStore:t.collectionStore()})),[t]);return a?(0,m.jsx)(ne().A,{icon:p().m,onClick:()=>{const e=j().H(o);!s||l>0?_().a2({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings",from:e}}):I().h({environment:n,mode:"create_automation",collectionContextStore:t,collectionSettingsStore:o,from:e})},right:l>0?l:(0,m.jsx)(C().sA,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,m.jsx)(C().sA,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function Ve(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,a=(0,i().v3)(),l=(0,r().K8)((()=>Te(t)),[t]),s="board"===l?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().O$)(t.normalizedFormatStore)[s.groupByKey],u=(0,r().O$)(t.permissionScopesStore);return"calendar"!==l?(0,m.jsx)(ne().A,{icon:"board"===l?x().q:v,title:(0,m.jsx)(C().sA,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:(0,ie().hU)(d?c[d.property]:void 0),onClick:()=>{var e;(0,A().X)({environment:a,collectionContextStore:t,action:"click_group",original_view_type:l,property_type:d?null===(e=c[d.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),_().a2({collectionSettingsStore:o,item:d?{type:"group",...s}:{type:"groupByProperty",...s}})},disabled:n||!d&&!u.canConfigureBlock}):null}function Fe(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,a=(0,i().v3)(),l=(0,r().K8)((()=>Te(t)),[t]),s=(0,r().O$)(t.normalizedSchemaStore),c=(0,r().O$)(t.normalizedFormatStore).collection_group_by,d={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},u=(0,r().O$)(t.permissionScopesStore);return"board"===l?(0,m.jsx)(ne().A,{icon:v,title:(0,m.jsx)(C().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:(0,ie().hU)(c?s[c.property]:void 0),onClick:()=>{var e;(0,A().X)({environment:a,collectionContextStore:t,action:"click_subgroup",original_view_type:l,property_type:c?null===(e=s[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),_().a2({collectionSettingsStore:o,item:c?{type:"group",...d}:{type:"groupByProperty",...d}})},disabled:n||!c&&!u.canConfigureBlock}):null}function Ke(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,a=(0,i().v3)(),l=(0,r().K8)((()=>t.collectionViewStore()),[t]),s=(0,r().K8)((()=>null==l?void 0:l.getType()),[l]);return l&&s?(0,m.jsx)(ne().A,{disabled:n,icon:E().Vw[s],title:(0,m.jsx)(C().sA,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:E().to[s],onClick:()=>{(0,A().X)({environment:a,collectionContextStore:t,action:"click_layout"}),_().a2({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function De(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,a=(0,i().v3)(),s=(0,r().O$)(t.normalizedFormatStore),d=(0,r().K8)((()=>Te(t)),[t]),u=(0,r().K8)((()=>(0,l().u9)(d)),[d]);if("chart"===d||"form_editor"===d)return(0,m.jsx)(m.Fragment,{});const p=((u?s[u]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,m.jsx)(ne().A,{icon:c().n,disabled:n,title:(0,m.jsx)(C().sA,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,m.jsx)(C().sA,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:p}}),onClick:()=>{(0,A().X)({environment:a,collectionContextStore:t,action:"click_properties"}),_().a2({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function Le(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>t.currentSortsStore.state.length),[t]);return(0,m.jsx)(ne().A,{icon:s().C,title:(0,m.jsx)(C().sA,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:a>0?(0,m.jsx)(C().sA,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:a},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,m.jsx)(C().sA,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{(0,A().X)({environment:n,collectionContextStore:t,action:"click_sort"}),0===a?_().a2({collectionSettingsStore:o,item:{type:"createSort"}}):_().a2({collectionSettingsStore:o,item:{type:"sort"}})}})}function Oe(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r().O$)(t.permissionScopesStore),i=(0,r().K8)((()=>t.collectionStore()),[t]),a=(0,r().K8)((()=>null==i?void 0:i.isSyncedCollection()),[i]),l=(0,r().K8)((()=>t.contextType),[t]);return(0,r().K8)((()=>n.canConfigureCollection),[n])||a||"collectionTypedView"===l?null:(0,m.jsx)(Be,{collectionSettingsStore:o,collectionContextStore:t})}function Ee(e){const t=(0,i().v3)(),o=(0,r().K8)((()=>{const e=Z().default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,O().sj)(e.id))}),[]),n=(0,r().K8)((()=>{if(!(0,W().nk)())return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,O().sj)(t.id))}),[e.collectionContextStore]),l=(0,a().IS)((e=>({icon:ze(e).iconStyles,title:ze(e).menuItemStyles})),[]);if(!n)return null;const s=o?"home_tasks":"home_tile_tasks";return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(F().CollectionTasksEmptyStateModal,{from:s}),(0,m.jsx)(ne().A,{showChevron:!1,icon:S().T,iconStyle:l.icon,title:(0,m.jsx)(C().sA,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:l.title,onClick:()=>{Q().A.setState(!0),(0,q().bS)({environment:t,from:s})}})]})}function ze(e){const t=(0,$().EI)(e);return{menuItemStyles:{color:t.text},iconStyles:{fill:t.icon}}}function Ne(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:n,isConfiguringViewsMainModule:r}=e;const a=(0,i().v3)(),{device:l}=a,s=(0,G().X)("delete_database_from_view_settings")&&!r,c=(0,G().X)("collection_mobile_load_limits");return(0,m.jsxs)(m.Fragment,{children:[l.isMobile?(0,m.jsxs)(D().A,{topBorder:!0,children:[(0,m.jsx)(pe().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:r}),(0,m.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(De,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ue().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Le,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ve,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Re,{collectionContextStore:t,collectionSettingsStore:o}),c?null:(0,m.jsx)(te,{collectionContextStore:t})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(D().A,{children:[(0,m.jsx)(pe().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:r}),(0,m.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,m.jsxs)(D().A,{topBorder:!0,children:[(0,m.jsx)(De,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ue().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Le,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ve,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Re,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(te,{collectionContextStore:t})]})]}),(0,m.jsx)(Ue,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsxs)(D().A,{topBorder:!0,children:[(0,m.jsx)(Me().A,{collectionContextStore:t}),(0,m.jsx)(re().A,{collectionContextStore:t}),(0,m.jsx)(de().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ae().A,{collectionContextStore:t,collectionSettingsStore:o}),n&&(0,m.jsx)(Ee,{collectionContextStore:t}),s&&(0,m.jsx)(ce,{collectionContextStore:t,collectionSettingsStore:o})]})]})}function Ue(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,L().C5)(t),i=(0,a().IS)((e=>({title:{display:"flex",alignItems:"center"}})),[]),l=(0,r().K8)((()=>{const e=t.permissionScopesStore.state;if(!(e.canConfigureCollection||e.canConfigureBlock))return!0;const o=t.collectionStore();return!o||((0,U().qe)(o)||(0,U().X6)(o))}),[t]);return(0,m.jsx)(D().A,{topBorder:!0,children:(0,m.jsx)(ne().A,{icon:u().gearIcon,title:(0,m.jsx)("div",{style:i.title,children:(0,m.jsx)("div",{style:w().RC,children:(0,m.jsx)(C().sA,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.mainTab.customizeButton.title",values:{databaseName:n}})})}),caption:(0,m.jsx)("div",{children:(0,m.jsx)(C().sA,{defaultMessage:"Change settings, add new features",id:"database.viewSettings.mainTab.customizeButton.caption"})}),shouldWrapCaption:!0,showChevron:!0,onClick:()=>{_().a2({collectionSettingsStore:o,item:{type:"customize"}})},disabled:l})})}function He(e){let{collectionContextStore:t,collectionSettingsStore:o,viewNameInput:n}=e;const l=(0,i().v3)(),s=(0,C().tz)(),c=(0,a().IS)((()=>({container:{minWidth:oe().vE},nameInput:{paddingBottom:0}})),[]),u=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,O().sj)(o)}),[t]),p=(0,r().K8)((()=>u?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[u]);return(0,m.jsxs)("div",{style:c.container,children:[(0,m.jsx)(D().A,{style:c.nameInput,children:n}),(0,m.jsx)(D().A,{children:(0,m.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o})}),(0,m.jsxs)(D().A,{topBorder:!0,children:[(0,m.jsx)(De,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ue().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Le,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ve,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,m.jsxs)(D().A,{topBorder:!0,children:[!u&&(0,m.jsx)(pe().A,{collectionContextStore:t,collectionSettingsStore:o}),!u&&(0,m.jsx)(ae().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ne().A,{icon:d().e,title:s.formatMessage(Y().uF.hide),showChevron:!1,onClick:()=>{Z().default.state.currentSpaceViewStore&&M().WO({environment:l,currentSpaceViewStore:Z().default.state.currentSpaceViewStore,...p})}}),u&&(0,m.jsx)(Ee,{collectionContextStore:t})]})]})}},58488:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});o(296540);var n=()=>o(56366),i=()=>o(348241),r=()=>o(175116),a=()=>o(937199),l=o(474848);function s(e){const{children:t}=e,o=(0,r().ET)(),s=(0,n().O$)(o.formsBaseLayoutEditorContextValueStore),c=(0,n().O$)(o.formsSpecificLayoutEditorContextValueStore);return s&&c?(0,l.jsx)(a().Op.Provider,{value:s,children:(0,l.jsx)(i().zi.Provider,{value:c,children:t})}):null}},62616:(e,t,o)=>{"use strict";o.d(t,{c:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M10 2.375c-1.778 0-3.415.256-4.63.69-.604.216-1.138.488-1.532.82-.391.331-.713.784-.713 1.347q0 .157.032.304h-.032v9.232c0 .563.322 1.016.713 1.346.394.333.928.605 1.532.82 1.215.435 2.852.691 4.63.691s3.415-.256 4.63-.69c.604-.216 1.138-.488 1.532-.82.391-.331.713-.784.713-1.347V5.536h-.032q.031-.147.032-.304c0-.563-.322-1.016-.713-1.346-.394-.333-.928-.605-1.532-.82-1.215-.435-2.852-.691-4.63-.691M4.375 5.232c0-.053.028-.188.27-.391.238-.201.62-.41 1.146-.599 1.047-.374 2.535-.617 4.209-.617s3.162.243 4.21.617c.526.188.907.398 1.146.599.24.203.269.338.269.391s-.028.188-.27.391c-.238.202-.62.41-1.146.599-1.047.374-2.535.617-4.209.617s-3.162-.243-4.21-.617c-.526-.188-.907-.397-1.146-.599-.24-.203-.269-.338-.269-.39m11.25 1.718V10c0 .053-.028.188-.27.391-.238.201-.62.41-1.146.599-1.047.374-2.535.617-4.209.617s-3.162-.243-4.21-.617c-.526-.188-.907-.398-1.146-.599-.24-.203-.269-.338-.269-.391V6.95c.297.17.633.32.995.45 1.215.433 2.852.69 4.63.69s3.415-.257 4.63-.69c.362-.13.698-.28.995-.45m-11.25 7.818v-3.05c.297.17.633.32.995.449 1.215.434 2.852.69 4.63.69s3.415-.256 4.63-.69c.362-.13.698-.279.995-.45v3.05c0 .054-.028.189-.27.392-.238.201-.62.41-1.146.599-1.047.374-2.535.617-4.209.617s-3.162-.243-4.21-.617c-.526-.188-.907-.398-1.146-.599-.24-.203-.269-.338-.269-.391"})},i=(0,o(340498).wt)("collection",n)},63667:(e,t,o)=>{"use strict";o.d(t,{k:()=>m});o(296540);var n=()=>o(56366),i=()=>o(401497),r=()=>o(713998),a=()=>o(743176),l=()=>o(859428),s=()=>o(682146),c=()=>o(553965),d=()=>o(962730),u=()=>o(937199),p=()=>o(478573),g=o(474848);function m(e){const{propertyId:t}=e,{collectionStore:o}=(0,u().LH)(),m=(0,i().DP)(),f=(0,n().K8)((()=>{if(!o)return;const e=o.getSchema();return(0,r()._g)({schema:e,property:t})}),[o,t]);if(!f)return null;const y=f.type;return(0,g.jsx)(l().A,{textWrap:!0,placement:d().W.Left,renderTooltip:()=>e.tooltip,disableTooltip:!e.tooltip,render:t=>(0,g.jsx)(p().A,{...(0,c().A)(t,e),icon:(0,g.jsx)(a().Ay,{size:16,theme:m,icon:f.icon,type:y}),name:f.name,subText:s().dC[y],disabled:e.disabled})})}},95347:(e,t,o)=>{"use strict";o.d(t,{C5:()=>ee,NE:()=>X,Ro:()=>Y,ff:()=>Z,hw:()=>J,jk:()=>Q,rD:()=>K,wG:()=>O});o(944114),o(898992),o(823215),o(354520),o(672577),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(66689),s=()=>o(151744),c=()=>o(455348),d=()=>o(959013),u=()=>o(209199),p=()=>o(496603),g=()=>o(154017),m=()=>o(686526),f=()=>o(36629),y=()=>o(317909),S=()=>o(767435),h=()=>o(617254),v=()=>o(248823),x=()=>o(328327),C=()=>o(326224),b=()=>o(117293),w=()=>o(374562),j=()=>o(646668),A=()=>o(313892),_=()=>o(557336),M=()=>o(180762),k=()=>o(972435),I=()=>o(71304),T=()=>o(351360),P=()=>o(666429),B=()=>o(455338),R=()=>o(234675),V=()=>o(739222);const F=(0,d().YK)({databaseNamePlaceholder:{id:"customizeMenu.databaseNamePlaceholder",defaultMessage:"database"}});function K(e){return(0,r().K8)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getDatabaseType();return o?(0,A().lS)((0,h().appConfigs)(),o):void 0}),[e])}function D(e){const{collectionFormat:t,feature:o}=e,n=t.app_config_uri;return o.collectionUri===n&&o.dependencies.some((e=>"property"===e.type&&e.collectionUri===n&&(0,s().LE)(e.uri)))}function L(e){const{environment:t,collectionStore:o,collectionFormat:n,collectionViewBlockStore:i,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;if(r.uri===(0,w().Bd)().uri)return!1;const a=r.dependencies[0];return a.collectionViewBlockUri===i.getFormat().app_config_uri&&a.collectionUri===n.app_config_uri&&(0,A().Hb)({environment:t,viewDependency:a,collectionStore:o})}function O(e,t){const o=(0,i().v3)(),n=K(e),a=[(0,w().md)(),(0,w().J4)(),...j().v],s=(0,V().bz)(e);return(0,r().K8)((()=>{var t,i;if(!n){return q([...a,...s],l().iH)}const r=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat(),c=null===(i=e.collectionStore())||void 0===i?void 0:i.getSchema(),d=e.collectionStore(),u=e.collectionViewBlockStore();if(!(r&&c&&d&&u))return[];const g={};n.allFeatures.forEach((e=>{(0,A().$n)(e)&&e.variants.every((e=>Boolean(n.allFeatures.find((t=>t.uri===e&&(0,A().lK)(t)&&D({collectionFormat:r,feature:t}))))))&&(g[e.uri]=e.variants)}));const m=Object.values(g).flat(),f=[];for(const e of n.allFeatures)if(!f.find((t=>t.uri===e.uri)))if(!m.find((t=>t===e.uri))&&(0,A().lK)(e)){const t=D({collectionFormat:r,feature:e}),n=L({environment:o,collectionStore:d,collectionFormat:r,collectionViewBlockStore:u,feature:e});(t||n)&&f.push(e)}else(0,A().$n)(e)&&Boolean(g[e.uri])&&f.push(e);const y=[...a,...s,...f];return q(p().hS(y,"uri"),e.databaseType)}),[n,e,a,s,o])}const E={[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[V().YX.uri]:3,[(0,j().nr)().uri]:4,[(0,j().uo)().uri]:5,[(0,j().Rh)().uri]:6,[(0,j().rr)().uri]:7,[V().iF]:8,[V().Bm]:9,[V().js]:10,[V().nu]:11},z={[(0,w().qK)().uri]:1,[(0,w().md)().uri]:2,[(0,w().J4)().uri]:3,[V().YX.uri]:4,[(0,w().mh)().uri]:5,[(0,w().e3)().uri]:6,[(0,w().AG)().uri]:7,[(0,j().nr)().uri]:8,[(0,j().uo)().uri]:9,[(0,j().Rh)().uri]:10,[(0,j().rr)().uri]:11,[(0,w().Bd)().uri]:12,[(0,w().wB)().uri]:13,[(0,w().Q2)().uri]:14,[(0,w().bM)().uri]:15,[(0,w().kr)().uri]:16,[(0,w().Xq)().uri]:17,[V().RH.uri]:18,[V().Bm]:19,[V().iF]:20,[V().js]:21,[V().nu]:22},N={[(0,C().uj)().uri]:1,[(0,w().md)().uri]:2,[(0,w().J4)().uri]:3,[(0,C().KS)().uri]:4,[(0,j().nr)().uri]:5,[(0,j().uo)().uri]:6,[(0,j().Rh)().uri]:7,[(0,j().rr)().uri]:8,[(0,C().XP)().uri]:9,[(0,C().EQ)().uri]:10,[(0,C().t_)().uri]:11,[(0,C().$k)().uri]:12,[(0,C().Tb)().uri]:13,[V().Bm]:14,[V().js]:15,[V().nu]:16},U={[V().RH.uri]:1,[(0,b().HS)().uri]:2,[(0,w().md)().uri]:3,[(0,w().J4)().uri]:4,[(0,C().KS)().uri]:5,[(0,j().nr)().uri]:6,[(0,j().uo)().uri]:7,[(0,j().Rh)().uri]:8,[(0,j().rr)().uri]:9,[(0,b().f9)().uri]:10,[V().Bm]:11,[V().js]:12,[V().nu]:13},H={[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[(0,x().$$)().uri]:3,[(0,x().mU)().uri]:4,[(0,x().PA)().uri]:5,[(0,x().Ub)().uri]:6,[(0,x().mU)().uri]:7,[(0,x().AN)().uri]:8,[(0,j().nr)().uri]:9,[(0,j().uo)().uri]:10,[(0,j().Rh)().uri]:11,[(0,j().rr)().uri]:12,[V().Bm]:13,[V().js]:14,[V().nu]:15},W={[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[(0,v().ft)().uri]:3,[(0,v().Li)().uri]:4,[(0,j().nr)().uri]:7,[(0,j().uo)().uri]:8,[(0,j().Rh)().uri]:9,[(0,j().rr)().uri]:10,[V().Bm]:11,[V().js]:12,[V().nu]:13},G={[l().iH]:E,[l().dC]:z,[l().Tw]:N,[l().av]:U,[l().TC]:H,[l().yH]:W};function q(e,t){if(!t)return e;const o=G[t];return o?e.filter((e=>void 0!==o[e.uri])).sort(((e,t)=>(o[e.uri]??1/0)-(o[t.uri]??1/0))):e}function Y(e,t){const o=K(e);return(0,r().K8)((()=>{const n=e.collectionStore(),i=e.collectionViewBlockStore(),r=[],a=[];if(!n||!i)return{addedFeatures:r,suggestedFeatures:a};for(const l of t)$({collectionContextStore:e,feature:l,appConfig:o})?r.push(l):a.push(l);return{addedFeatures:r,suggestedFeatures:a}}),[t,o,e])}function $(e){const{collectionContextStore:t,feature:o,appConfig:n}=e;if((0,R().l)(o))return o.isFeatureAdded(o,t);if((0,A().lK)(o)||(0,A().u1)(o))return Q({collectionContextStore:t,feature:o});return Z(o,null==n?void 0:n.allFeatures).some((e=>Q({collectionContextStore:t,feature:e})))}function Q(e){const{collectionContextStore:t,feature:o}=e,n=t.collectionStore();if(o.uri===(0,w().md)().uri)return Boolean(t.currentSubitemFormatStoreForCollectionStore.state);if(o.uri===(0,w().J4)().uri){const e=(0,_().QZ)({feature:"timeline_arrows_by",collectionContextStore:t});return Boolean(e)}const i=c().u9.derivePropertyUris((null==n?void 0:n.getSchema())??{},null==n?void 0:n.getPropertyMapping());return o.dependencies.some((e=>{const o="property"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n,propertyUris:i}=e,r=null===(t=o.collectionStore())||void 0===t?void 0:t.getDatabaseType();if(n.collectionUri===r)return(0,s().LE)(n.uri)&&i.has(n.uri);if((0,s().XA)(n.collectionUri))return(0,s().M7)(n.uri)&&i.has(n.uri);return!1}({dependency:e,collectionContextStore:t,propertyUris:i}),n="collection_view"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n}=e,i=o.collectionViewBlockStore(),r=null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;if(!i||!r)return!1;var a,l;return n.collectionUri===r?n.collectionViewBlockUri===i.getFormat().app_config_uri&&n.uri in((null===(a=i.getFormat())||void 0===a?void 0:a.app_uri_map)??{}):!!(0,s().XA)(n.collectionUri)&&n.uri in((null===(l=i.getFormat())||void 0===l?void 0:l.app_uri_map)??{})}({dependency:e,collectionContextStore:t});return o||n}))}function Z(e,t){return p().oE(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,A().lK)(o))return o})))}function J(e,t){const o=(0,i().v3)(),a=function(e){const t=(0,i().v3)(),o=K(e),a=(0,r().K8)((()=>T().default.state.currentSpaceViewStore),[]),l=(0,r().K8)((()=>e.collectionViewBlockStore()),[e]);return(0,n.useCallback)(((n,i)=>{if(!l||!o||!a)return;const r=l.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==n.dependencies.length)return;const s=n.dependencies[0];y().createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:t,canUndo:!0,perform:c=>{var d;S().applyTypedFeatures({environment:t,spaceViewStore:a,appParentStore:r,appUri:o.uri,features:[{type:"simple",featureUri:n.uri}],appCollectionViewBlockStores:[l],createOrModify:"modify",transaction:c});const u=((null===(d=l.getFormat())||void 0===d?void 0:d.app_uri_map)??{})[s.uri];(0,M().t)({environment:t,collectionContextStore:e,collectionViewId:u,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),(0,g().b)({environment:t,collectionContextStore:e,view_type:s.value.type,view_config_uri:n.uri,feature:{id:u,from:i,type:n.uri}})}})}),[l,o,a,t,e])}(e);return(0,n.useCallback)((async n=>{if(n.uri===(0,w().md)().uri)m().a2({collectionSettingsStore:t,item:{type:"subitemV2",from:"customize_menu"}});else if(n.uri===(0,w().J4)().uri)m().a2({collectionSettingsStore:t,item:{type:"dependencies",from:"customize_menu"}});else{const t=n.dependencies[0];"collection_view"===t.type||"collection_view_block"===t.type||"sub_external_collection"===t.type?(a(n,"customize_menu"),P().Ay.setState({...P().Ay.state,shouldReset:!1}),(0,B().t)({featureName:n.name})):(await f().h3({environment:o,feature:n,collectionContextStore:e,addFeatureFrom:"customize_menu"}),(0,B().t)({featureName:n.name}))}}),[o,e,t,a])}function X(){return(0,a().IS)((()=>({featureIconWrapper:{height:28,width:28,padding:"6px 0px",borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto"}})),[])}function ee(e){const t=(0,i().v3)(),o=(0,d().tz)();return(0,r().K8)((()=>{var n;const i=(null===(n=T().default.state.currentUserSettingsStore)||void 0===n||null===(n=n.getSettings())||void 0===n?void 0:n.preferred_locale)||u().q;if("ja-JP"===i||"ko-KR"===i)return"";const r=e.collectionStore();return null!=r&&r.getName()?(0,I().tS)({environment:t,intl:o,store:r,untitledFallback:F.databaseNamePlaceholder}):k().A.formatMessage(F.databaseNamePlaceholder)}),[t,o,e])}},116089:(e,t,o)=>{"use strict";o.d(t,{x:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M10.55 3a.55.55 0 0 0-1.1 0v2a.55.55 0 0 0 1.1 0zM8.47 8.47a.75.75 0 0 1 1.06 0l.897.896-1.06 1.06-.897-.896a.75.75 0 0 1 0-1.06m1.603 2.664 6.647 6.646a.75.75 0 1 0 1.06-1.06l-6.646-6.647zM10.55 15a.55.55 0 0 0-1.1 0v2a.55.55 0 0 0 1.1 0zm-3.697-1.853a.55.55 0 0 1 0 .777L5.44 15.34a.55.55 0 1 1-.778-.778l1.415-1.415a.55.55 0 0 1 .777 0m8.485-8.486a.55.55 0 0 1 0 .778l-1.415 1.414a.55.55 0 1 1-.777-.777L14.56 4.66a.55.55 0 0 1 .777 0M5.55 10a.55.55 0 0 1-.55.55H3a.55.55 0 1 1 0-1.1h2a.55.55 0 0 1 .55.55m12 0a.55.55 0 0 1-.55.55h-2a.55.55 0 1 1 0-1.1h2a.55.55 0 0 1 .55.55M6.853 6.853a.55.55 0 0 1-.778 0L4.661 5.44a.55.55 0 1 1 .778-.778l1.414 1.415a.55.55 0 0 1 0 .777"})},i=(0,o(340498).wt)("magicWand",n)},135599:(e,t,o)=>{"use strict";o.d(t,{W:()=>U});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454),o(737550);var n=o(296540),i=()=>o(395361),r=()=>o(484714),a=()=>o(56366),l=()=>o(721908),s=()=>o(474424),c=()=>o(591779),d=()=>o(206267),u=()=>o(207289),p=()=>o(519831),g=()=>o(245241),m=()=>o(959013),f=()=>o(496603),y=()=>o(973647),S=()=>o(534177),h=()=>o(720665),v=()=>o(449506),x=()=>o(518362),C=()=>o(989423),b=()=>o(148777),w=()=>o(825972),j=()=>o(71304),A=()=>o(780865),_=()=>o(470928),M=()=>o(722038),k=()=>o(406792),I=()=>o(106628),T=()=>o(361330),P=()=>o(109054),B=()=>o(351360),R=()=>o(227440),V=()=>o(508496),F=()=>o(968172),K=()=>o(20199),D=()=>o(558407),L=()=>o(630116),O=()=>o(645873),E=()=>o(963589),z=()=>o(531770);function N(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,d().JW)(),isResultsLoading:!1}}function U(e){var t;const{searchQuery:o,limit:d,source:U,type:G,ancestorId:q,disable:Y,overrideSpaceStore:$,overrideSearchSessionId:Q,usePrefetch_EXPERIMENTAL:Z,isTitleOnly:J=!0}=e,X=(0,r().v3)(),ee=(0,m().tz)(),te=(0,c().ZC)(o),oe=(0,c().ZC)(e.filters),ne=(0,n.useRef)({number:0,query:""}),ie=(0,n.useCallback)((e=>{const t=ne.current.query.trim(),o=e.trim();""!==o&&t!==o&&(ne.current.number+=1,ne.current.query=o)}),[]),re=(0,i().Y)(ie,T().ab),ae=(0,n.useRef)(!0),le=(0,a().K8)((()=>R().A.state.online),[]),se=(0,a().K8)((()=>e.isLocalOnlyMode||!le),[le,e.isLocalOnlyMode]),ce=(0,M().y)(),[de,ue]=(0,n.useState)(N()),pe=(0,a().K8)((()=>Q&&Q!==de.searchSessionId?(ue((e=>({...e,searchSessionId:Q}))),Q):de.searchSessionId),[de,Q]),ge=(0,E().X)("unified_find_cache_query_gen"),me=(0,E().X)("quick_find_highlights_enabled"),{searchLocalResults:fe,searchServerResults:ye,isResultsLoading:Se,numTotalLocalResults:he,numTotalServerResults:ve}=(0,a().K8)((()=>({searchLocalResults:de.localResults,searchServerResults:de.serverResults,isResultsLoading:de.isResultsLoading,numTotalLocalResults:de.numTotalLocalResults,numTotalServerResults:de.numTotalServerResults})),[de]),xe=(0,a().K8)((()=>{if(se||Se&&ae.current)return fe;let e=function(e){const{localResults:t,serverResults:o}=e,n=t.map((e=>e.store.id)),i=new Set(n),r=o.filter((e=>!i.has(e.store.id)));return[...t,...r]}({localResults:fe,serverResults:ye});return G===g().Vz.CollectionsInSpace&&(e=W(e)),e}),[se,Se,fe,ye,G]),Ce=(0,a().K8)((()=>$||B().default.state.currentSpaceStore),[$]),be=(0,a().K8)((()=>"on"===V().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),we=(0,a().K8)((()=>se&&le&&Boolean(Z)),[se,le,Z]),je=(0,a().K8)((()=>(0,A().Er)(X).hasPublicAccessPermission),[X]),Ae=(0,n.useMemo)((()=>{const t={navigableBlockContentOnly:J,...e.filters};return(0,g().N2)(t)}),[e.filters,J]),_e=(0,n.useMemo)((()=>{var t;return function(e){const{blockTypes:t,queryType:o}=e;switch(o){case g().Vz.CollectionsInSpace:return["collection_view","collection_view_page"];case g().Vz.BlocksInCollection:return["page","collection_view_page"];case g().Vz.BlocksInSpace:default:return[...t??[]]}}({blockTypes:null===(t=e.filters)||void 0===t?void 0:t.blockTypes,queryType:G})}),[null===(t=e.filters)||void 0===t?void 0:t.blockTypes,G]),Me=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,localCacheMetadata:i,query:r}=t;k().default.measure(e,{environment:X,data:{start_time:e.startTime,success:o,surface:U,num_results:n,search_session_id:pe,local_cache_metadata:i,local_cache_readiness_timings:(0,b().Yp)(),query_length:r.length}})}),[X,U,pe]),ke=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,query:i}=t;k().default.measure(e,{environment:X,data:{start_time:e.startTime,success:o,surface:U,num_results:n,search_session_id:pe,search_session_flow_number:ne.current.number,query_length:i.length}})}),[X,U,pe]),Ie=(0,a().K8)((()=>K().A.state.localSearchableBlocksCache),[]),Te=(0,O().fJ)(I().T.searchActions),Pe=(0,n.useCallback)((e=>{const t=k().default.mark("rum.local_quick_search_query"),{query:o,spaceStore:n}=e,i=ce&&!le&&(0,S().Xk)(g().Iy,U);if("resolved"!==Te.status)return;const r=G===g().Vz.CollectionsInSpace;let a=[];0===o.length&&r&&(a=function(e){const{spaceStore:t,environment:o}=e,n=(0,x().F)({currentUserId:o.currentUser.id,spaceId:t.id}).map((e=>{const o=L().md.createChildStore(t,{table:p().Vl,id:e}).getParentBlockStore();if(null==o?void 0:o.pathIsAccessibleAndAlive())return o}));return(0,f().oE)(n)}({environment:X,spaceStore:n}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[g().Ni.Local],featureGroups:[],serverEventProperties:void 0}))));const l=(0,b().PE)({environment:X,overrideCurrentUserId:X.currentUser.id,overrideSpaceId:n.id,overrideLocalSearchableBlocksCache:Ie}),s=(0,z().S6)({environment:X,parentStore:n,isOnline:le,requestInput:{query:{text:o,filters:{...Ae,blockTypes:_e,isOfflineOnly:i},sort:{field:"relevance"}},limit:se?d:Math.min(d,5)},localSearchCache:Ie,shouldUseNewRerankerDebugOverrideEnabled:be,shouldLimitLocalResultsWhenOnline:!se,hasPublicAccessPermission:je}),c=we?H({query:o,serverResults:We.current}):[],u=s&&y().Q.unwrapOr(s,void 0),m=(null==u?void 0:u.results)??[],h=(null==u?void 0:u.total)??0;let v=f().hS([...a,...m,...c],(e=>e.id));v=r?W(v):v,ue((e=>e.query!==o?e:(qe.current=v.map((e=>e.id)),Me(t,{query:o,isSuccess:Boolean(u),totalResultsCount:h,localCacheMetadata:l}),re(o),{...e,localResults:v,isResultsLoading:!se&&e.isResultsLoading,numTotalLocalResults:h})))}),[ce,le,U,Te.status,G,X,Ae,_e,se,d,be,je,we,Me,re,Ie]),Be="mini_quick_find"===U?40:T().GR,Re=(0,i().Y)(Pe,Be),Ve=(0,n.useCallback)((e=>{v().callApi({eventName:"warmSearchQueryCache",environment:X,data:{spaceId:(null==Ce?void 0:Ce.id)??"",query:e.query,searchSessionId:pe}})}),[X,Ce,pe]),Fe=(0,i().Y)(Ve,200),Ke=(0,n.useCallback)((e=>{const{result:t,isMetaClick:n,context:i}=e,r=(0,j().Qe)(t.store,ee,X,!1),a=(0,P().u)({query:o,resultText:r??"",isLastQueryTermPartialMatchOK:!0}),l=B().default.state.currentSpaceStore,s=Boolean(null==l?void 0:l.getSettings().enable_ai_training);(0,C().u4)({environment:X,event:{eventName:"select_search_item",eventProperties:{sources:t.sources,localSources:Array.from(t.localSource||new Set),searchSessionId:pe,aiSessionId:void 0,searchSessionFlowNumber:ne.current.number,context:i,queryStringLength:o.length,isTitleMatch:a,queryIfLeap:s?o:void 0,totalSearchResultCount:he+ve,numLocalResults:fe.length,numTotalLocalResults:he,isMobile:X.device.isMobile,isMetaClick:n,hasFilters:Boolean(Ae),originalPosition:t.originalPosition,selectedItemIndex:t.originalPosition,selectedSearchResultMetadata:{blockId:t.id,blockType:t.store.getModel().type},searchSource:U,verificationState:(0,_().i1)(t.store)}}})}),[X,he,ve,fe,o,pe,ne,Ae,U,ee]),De=te===o,Le=f().n4(oe,e.filters),Oe=Boolean(te&&!o),Ee=Le&&De,ze=!Y&&Ce&&!Ee,Ne=Oe||!Le,Ue=(0,n.useRef)(!1),He=(0,n.useRef)([]),We=(0,n.useRef)([]),Ge=(0,n.useRef)([]),qe=(0,n.useRef)([]),Ye=(0,a().K8)((()=>{if("mention_menu"!==U)return;return D().A.getMentionedIds(X.currentUser.id)}),[X.currentUser.id,U]),$e=(0,n.useCallback)((async e=>{const t=k().default.mark("rum.server_quick_search_query"),{query:o,spaceStore:n,size:i}=e,r=n.id;if(se&&!we)return;const a=!ae.current&&Le?He.current:[],l=we?H({query:o,serverResults:We.current}):[];if(we&&(o.length<=1||l.length>=5||Ge.current.some((e=>e===o))))return;Ge.current.push(o);const c=await v().callApi({eventName:"search",environment:X,data:{...G===g().Vz.BlocksInAncestor?{type:G,ancestorId:q??"",spaceId:r}:{type:G,collectionId:(null==Ae?void 0:Ae.parentId)??"",spaceId:r},query:o,spaceId:r,limit:"mini_quick_find"===U?10:i+1,filters:Ae,sort:{field:"relevance"},source:U,searchSessionId:pe,searchSessionFlowNumber:ne.current.number,recentlyMentionedPageIds:Ye,recentPagesForBoosting:(0,w().cs)(F().A.getWithoutSubscribing(r)),excludedBlockIds:f().sb([...a.map((e=>e.id)),...qe.current||[],...We.current.map((e=>e.id))]),ignoresHighlight:!me||"mini_quick_find"!==U}});if(!c||"failed"===c.type)return;const d=c.data.total,p=(0,h().MU)((0,S().WP)(c.data.trackEventProperties).map((e=>{let[t,o]=e;return[`server-${t}`,o]}))),m=c.data.results.slice(0,i).map(((e,t)=>{const o=L().Bv.createChildStore(n,{id:e.id,spaceId:e.spaceId,table:"block"}),i=we?function(e){const{result:t,store:o,environment:n}=e;if(t.terms)return t.terms;const i=o.getModel();if(!i)return[];const r=n.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(n.currentUser.id),a=(0,u().KM)((0,s().g)({blockValue:i,getRecordValue:r}).text);if(!a)return[];return(0,P().N)(a)}({environment:X,store:o,result:e}):e.terms;return{store:o,originalPosition:t,...e,serverEventProperties:p,terms:i}}));Ue.current=!(d<=i);const y=[...a,...m];He.current=y,We.current=f().hS([...we?m:[],...We.current],(e=>e.id)),we||(ue((e=>e.query!==o?e:(ke(t,{query:o,isSuccess:"success"===c.type,totalResultsCount:d}),{...e,serverResults:y,isResultsLoading:!1,numTotalServerResults:d}))),re(o))}),[se,we,Le,X,G,q,Ae,U,pe,Ye,qe,re,ke,me]),Qe=(0,n.useCallback)((e=>{!Y&&Ce&&Ue.current&&!Se&&le&&(ue((e=>({...e,isResultsLoading:!0}))),Ue.current=!1,ae.current=!1,$e({query:o,spaceStore:Ce,size:e??20}))}),[Ce,Y,$e,le,Se,o]),Ze="mini_quick_find"===U?100:T().ab,Je=(0,l().d)(Qe,Ze),Xe=(0,i().Y)($e,we?0:T().ab);return(0,n.useEffect)((()=>{Ne&&(ue((e=>({...N(),searchSessionId:e.searchSessionId}))),We.current=[],Ge.current=[]),ze&&(ae.current=!0,ue((e=>({...e,isResultsLoading:!0,query:o}))),Re({query:o,spaceStore:Ce}),Xe({query:o,spaceStore:Ce,size:d}),"mini_quick_find"===U&&ge&&Fe({query:o}))}),[Ce,Re,Xe,Fe,d,o,ze,Ne,U,ge]),{results:xe,isResultsLoading:Se,searchSessionId:pe,fetchAdditionalServerResultsOnChange:!Y&&!se&&Ue.current&&Ee?Je:void 0,searchSessionFlowNumber:ne.current.number,hasMoreResults:Ue.current,searchAnalytics:{trackSelectSearchItem:Ke}}}function H(e){const{query:t,serverResults:o}=e;return t?o.filter((e=>(0,P().u)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function W(e){const t=new Set;return e.filter((e=>{const o=e.store.getCollectionViewSourceCollectionStore();return!(!o||t.has(o.id))&&(t.add(o.id),!0)}))}},147361:(e,t,o)=>{"use strict";o.d(t,{r:()=>T});o(581454);var n=o(296540),i=()=>o(401497),r=()=>o(451306),a=()=>o(496603),l=()=>o(534177),s=()=>o(690471),c=()=>o(259464);o(16280);class d{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>d.timestep?(t-=d.timestep,e=d.timestep):(e=t,t=0);const[o,n]=this.rk4(this.currentValue,this.velocity,e);this.velocity=n,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){const n=e,i=t,r=this.computeAccel(n,i,0),a=e+.5*i*o,l=t+.5*r*o,s=this.computeAccel(a,l,o/2),c=e+.5*l*o,d=t+.5*s*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(i+2*l+2*d+g),t+o/6*(r+2*s+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*d.stiffnessMultiplier*(this.endValue-e)-this.damping*d.dampingMultiplier*t}}d.stiffnessMultiplier=1e-5,d.dampingMultiplier=.005,d.timestep=1e3/60;const u=d;function*p(e,t){const o=new u;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*g(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*m(e){for(const[t,o]of a().yU(e,e.slice(1)))(0,l().O9)(t)&&(0,l().O9)(o)&&(yield*p(t,o))}function*f(e,t){let o=0;for(;!(0,l().O9)(t)||o<t;){o+=(yield e)}}function*y(e){let t=0;for(;;){const o={};for(const n of(0,l().uv)(e)){const i=e[n].next(t);if(i.done)return;o[n]=i.value}t=yield o}}var S=()=>o(402838),h=o(474848);const v="inactive-task-filter",x="active-task-filter",C="mouse-cursor-filter",b=80,w=24,j=8,A=10,_=264,M=110,k=b/2;function*I(e){yield*y({x:e,opacity:f(1)})}function T(e){const{mode:t}=e,o=(0,i().IS)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:M+2}})),[1]),r=(0,n.useRef)(null),a=(0,S().s)(r),l=a?a.width-2:_;return(0,h.jsx)("div",{style:o.wrap,ref:r,children:(0,h.jsx)(P,{mode:t,sceneWidth:l})})}function P(e){const{mode:t,sceneWidth:o}=e,d=(0,i().IS)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:s().cC},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),u=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*I(m([o/2,o/2+b/2+b/4,o/2-b/2-b/4,o/2]))},preserve_gap:function*(){for(;;)yield*I(m([o/2,o/2+b/2,o/2-b/2,o/2]))},consume_gap:function*(){for(;;){yield*I(m([o/2,o/2-b/2,o/2+b/2,o/2+b]));const e=500;yield*y({x:f(o/2+b),opacity:g(1,0,e)}),yield*y({x:f(o/2),opacity:g(0,1,e)})}}})),[o]),{x:p,opacity:S}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),a=r-o;o=r;const l=t.next(a);l.done||i(l.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(u[t??"none"]),v={x:o/2-2*b,y:A},x={x:p-b/2,y:A+w+j},C={x:o/2+b,y:A+2*(w+j)},_={x:x.x+b/2,y:x.y+w/2};return(0,l().O9)(t)&&("consume_gap"===t?(v.x=Math.min(v.x,x.x-b),C.x=Math.max(C.x,x.x+b)):"preserve_gap"===t?(v.x=v.x+p-o/2,C.x=C.x+p-o/2):(0,l().HB)(t)),(0,h.jsxs)("svg",{style:d.svgContainer,children:[a().y1(o/2-2*b,o,k).map(((e,t)=>(0,h.jsx)(R,{startPoint:{x:e,y:0},endPoint:{x:e,y:M}},t))),(0,h.jsx)(c().A,{startPoint:{x:x.x+b,y:x.y+w/2},endPoint:{x:C.x-2,y:C.y+w/2},...(0,r().AH)(d.svgArrowTheme,x.x+b>C.x?d.invalidArrow:void 0,{opacity:S}),showArrowHead:!0}),(0,h.jsx)(c().A,{startPoint:{x:v.x+b,y:v.y+w/2},endPoint:{x:x.x-2,y:x.y+w/2},...(0,r().AH)(d.svgArrowTheme,x.x<v.x+b?d.invalidArrow:void 0,{opacity:S}),showArrowHead:!0}),(0,h.jsx)(B,{point:v,opacity:S}),(0,h.jsx)(B,{point:x,active:!0,opacity:S}),(0,h.jsx)(B,{point:C,opacity:S}),(0,h.jsx)(V,{point:_,opacity:S}),(0,h.jsx)(F,{})]})}function B(e){const{point:t,active:o,opacity:n}=e,r=(0,i().DP)(),a=o?"dark"===r.mode?"#28456C":"#E7F3F8":r.buttonBackground;return(0,h.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,h.jsx)("rect",{filter:`url(#${o?x:v})`,width:b,height:w,x:"4",y:"2",fill:a,rx:"3"})})}function R(e){const{startPoint:t,endPoint:o}=e,n=(0,i().DP)(),r="dark"===n.mode?n.accentColors.gray[300]:"#E3E2E0";return(0,h.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:r,strokeDasharray:"3 4"})}function V(e){const{point:t,opacity:o}=e;return(0,h.jsxs)("g",{filter:`url(#${C})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,h.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,h.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function F(){return(0,h.jsxs)("defs",{children:[(0,h.jsxs)("filter",{id:v,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,h.jsxs)("filter",{id:x,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,h.jsxs)("filter",{id:C,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}},148079:(e,t,o)=>{"use strict";o.d(t,{A:()=>d});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),a=()=>o(413267),l=()=>o(959013),s=()=>o(250202),c=o(474848);function d(e){const{menuProps:t,property:o,defaultProperty:r,checkState:a,propertySchema:l,collectionContextStore:d,handleDefaultPropertySelect:p,handlePropertySelect:g,...m}=e,f=((0,n().WS)(),(0,i().O$)(d.permissionScopesStore));return(0,c.jsx)(s().G,{...t,disabled:!f.canConfigureBlock,propertySchema:l,format:s().e.Name,onClick:()=>p(o),right:(0,c.jsx)(u,{property:o,checkState:o===r,collectionContextStore:d,defaultProperty:void 0})})}function u(e){const{property:t,defaultProperty:o,checkState:s,collectionContextStore:d}=e,u=(0,n().WS)(),p=(0,i().K8)((()=>{var e;return null===(e=d.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[d]),g=(0,r().IS)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("div",{style:{...g.defaultText},children:t===o&&(0,c.jsx)(l().sA,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:p}})}),s&&(0,c.jsx)("div",{style:{...u?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:u?16:14,flexShrink:0},children:(0,a().b)()})]})}},167068:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var n=o(296540),i=o(474848);function r(e){let{...t}=e;const n=(0,o(959013).tz)(),r=(0,o(401497).IS)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:24,width:24},threeDotIcon:{width:12,height:12,fill:e.mediumIconColor}})),[]),a=n.formatMessage({defaultMessage:"View options",id:"PersonalHomePanel.moreDropdownButton.tooltip"});return(0,i.jsx)(o(704152).A,{ariaLabel:a,style:r.buttonStyle,mobileFeedback:!1,...t,children:(0,o(30626)._)(r.threeDotIcon)})}const a=n.memo(r)},210314:(e,t,o)=>{"use strict";o.d(t,{u:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("unsync",{viewBox:"0 0 30 30",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,n.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})},230751:(e,t,o)=>{"use strict";o.d(t,{A:()=>b});o(898992),o(672577);var n=o(296540),i=()=>o(56366),r=()=>o(651124),a=o(474848);const l={viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M3.5 3.099c-.621 0-1.125.504-1.125 1.125v9.026A2.625 2.625 0 0 0 5 15.875h9.944a2.625 2.625 0 0 0 2.625-2.625V7.495a2.625 2.625 0 0 0-2.625-2.625H9.067L7.962 3.513A1.13 1.13 0 0 0 7.09 3.1zm.125 4.465V4.349H7.03l1.105 1.356c.214.263.534.415.872.415h5.937c.76 0 1.375.616 1.375 1.375v.069zm0 1.1h12.694v4.586c0 .76-.616 1.375-1.375 1.375H5c-.76 0-1.375-.616-1.375-1.375z"})},s=(0,o(340498).wt)("folder",l);var c=()=>o(959013),d=()=>o(496603),u=()=>o(638013),p=()=>o(686526),g=()=>o(556048),m=()=>o(21140),f=()=>o(989423),y=()=>o(635676),S=()=>o(504836),h=()=>o(351360),v=()=>o(53137),x=()=>o(497222);function C(e){let{environment:t,collectionStore:o,collectionSettingsStore:l,flowId:C}=e;const b=(0,i().K8)((()=>null==o?void 0:o.getFormat()),[o]),w=(0,i().K8)((()=>{var e;return!0===(null===(e=h().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.seen_jira_sync_source_tooltip)}),[]),{bot_id:j,synced_collection_external_url:A,external_collection_type:_}=b||{},M=_?y().l[_]:"",k=(0,i().K8)((()=>Boolean(v().A.externalAuthentications.state.find((e=>e.id===j&&e.user_id===t.currentUser.id)))),[j,t]),I=(0,n.useRef)(null);return(0,i().K8)((()=>(0,S().Sd)()),[])&&_===r().uO.Jira&&b.sync_state&&!w?(0,a.jsxs)("div",{ref:I,style:{boxShadow:u().p.outlineBlueInputBoxShadow.light,borderRadius:6},children:[(0,a.jsx)(x().A,{icon:s,onClick:()=>{(0,f().u4)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"source_option_click",flowId:C,identifier:A,botId:j,isSyncOwner:k}}}),p().a2({collectionSettingsStore:l,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,a.jsxs)(m().Ye,{alignItems:"center",children:[(0,a.jsx)("img",{style:{height:12,width:12,marginRight:6},src:M,alt:"External intergration icon"}),(0,a.jsx)(c().sA,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,d().ZH)(_)}})]}),showChevron:!0,title:(0,a.jsx)(c().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})}),(0,a.jsx)(g().C8,{origin:I})]}):(0,a.jsx)(x().A,{icon:s,onClick:()=>{(0,f().u4)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"source_option_click",flowId:C,identifier:A,botId:j,isSyncOwner:k}}}),p().a2({collectionSettingsStore:l,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,a.jsxs)(m().Ye,{alignItems:"center",children:[(0,a.jsx)("img",{style:{height:12,width:12,marginRight:6},src:M,alt:"External intergration icon"}),(0,a.jsx)(c().sA,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,d().ZH)(_)}})]}),showChevron:!0,title:(0,a.jsx)(c().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}const b=function(e){let{collectionContextStore:t,collectionSettingsStore:n,disabled:r}=e;const l=(0,o(484714).v3)(),d=(0,i().K8)((()=>t.collectionStore()),[t]),u=(0,i().K8)((()=>null==d?void 0:d.isExternalSyncedCollection()),[d]),g=(0,i().O$)(t.permissionScopesStore),m=(0,i().K8)((()=>(0,S().pB)()),[]),f=(0,i().K8)((()=>t.collectionViewBlockStore()),[t]),y=(0,i().K8)((()=>o(666803).Ay.getFlowId()),[]),h=(0,i().K8)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),n=t.collectionViewStore();if(!e||!o||!n)return!1;if(e.isSyncedCollection())return!0;if(e.isSystemCollection())return!1;return void 0===o.getCollectionViewSourceCollectionStore()}),[t]),v=(0,i().K8)((()=>null==d?void 0:d.getIcon()),[d]);return m&&u&&d&&g.canConfigureBlock?(0,a.jsx)(C,{environment:l,collectionStore:d,collectionSettingsStore:n,flowId:y}):d&&f&&h?(0,a.jsx)(x().A,{icon:s,title:(0,a.jsx)(c().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,a.jsxs)(a.Fragment,{children:[v&&(0,a.jsx)(o(614505).A,{icon:v,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,a.jsx)(o(16006).A,{store:d})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},disabled:!g.canConfigureBlock||r,onClick:()=>{(0,o(436696).X)({environment:l,collectionContextStore:t,action:"click_source"}),p().a2({collectionSettingsStore:n,item:{type:"source"}})}}):null}},234675:(e,t,o)=>{"use strict";o.d(t,{R:()=>n,l:()=>i});const n="custom_component";function i(e){return!("dependencies"in e)&&e.collectionUri===n}},245500:(e,t,o)=>{"use strict";var n=()=>o(645873);const i={WorkflowTemplatesBuilderNotInProd:new(n().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([o.e(75134),o.e(63077),o.e(46414),o.e(14518),o.e(39600),o.e(94611)]).then(o.bind(o,213183)))),CollectionItemNameConfigMenuItemNotInProd:new(n().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await o.e(12062).then(o.bind(o,120364))))};(0,n()._h)(i.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,n()._h)(i.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},248064:(e,t,o)=>{"use strict";o.d(t,{h:()=>s});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(978846),l=()=>o(937199);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,l().LH)(),c=(0,i().v3)(),d=(0,r().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),u="form"===d?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,n.useCallback)((n=>{const{layoutModule:i,transaction:r}=n;if(!e.getModel()||!u||"form_conditional_modules"===u)return;let l;if("form"===d)l=n.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;l="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,a().UQ)({environment:c,sessionId:s,layoutStore:e,position:l,module:i,transaction:r,isPropertyCreation:!1}),o({type:"existing_module",moduleId:i.id,isDragging:!1})}),[u,t,c,e,d,s,o])}},274570:(e,t,o)=>{"use strict";o.d(t,{y:()=>r});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.625 5.725a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},r=(0,o(340498).wt)("clock",i)},283860:(e,t,o)=>{"use strict";o.d(t,{A:()=>d});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(148307),a=()=>o(959013),l=()=>o(284371),s=()=>o(132389),c=o(474848);function d(e){const t=(0,a().tz)(),o=function(e){const{isMobile:t}=(0,n().Y0)(),o=t?18:14,r=1,a=6,s=20;return(0,i().IS)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:s,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:a,borderBottomRightRadius:6,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${s}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...l().RC},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.lightTextColor,...l().RC},githubPrInfoMain:{padding:"0px 4px",fontFamily:l().Tf.githubMono,background:t.cardPressedBackground,borderRadius:a,color:t.regularTextColor,verticalAlign:"text-bottom",...l().RC}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(s().A,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(u.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(s().A,{size:2}),t.formatMessage(u.prTitle)]})}),p=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r().A.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(s().A,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(u.open)})]}),(0,c.jsx)(s().A,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(u.mergeInto),(0,c.jsx)(s().A,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(u.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(s().A,{size:12}),p]})}const u=(0,a().YK)({dismissButtonAriaLabel:{defaultMessage:"A button to dismiss the user education preview.",id:"database.viewSettings.githubConfigTab.preview.dismissButtonAriaLabel"},idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},309920:(e,t,o)=>{"use strict";o.d(t,{X:()=>Ko});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(282339),s=()=>o(901610),c=()=>o(566910),d=()=>o(959013),u=()=>o(89924),p=()=>o(175116),g=()=>o(351360),m=()=>o(322638),f=(o(16280),o(581454),()=>o(804773)),y=()=>o(340498),S=o(474848);const h=(0,y().wt)("collectionChartDonutSelected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{d:"M12.75 3.03079C17.1223 3.39148 20.6085 6.87768 20.9692 11.25H18.4069C18.0637 8.28709 15.7129 5.93628 12.75 5.59314V3.03079Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),v=(0,y().wt)("collectionChartDonutSelectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M12.75 3.03a9.002 9.002 0 018.22 8.22h-2.563a6.453 6.453 0 00-5.657-5.657V3.031z"}),(0,S.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),x=(0,y().wt)("collectionChartDonutUnselected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),C=(0,y().wt)("collectionChartDonutUnselectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),b=(0,y().wt)("collectionChartHorizontalBarSelected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{d:"M20.25 20H4.75V18H20.25V20Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),w=(0,y().wt)("collectionChartHorizontalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M20.25 20H4.75v-2h15.5v2z"}),(0,S.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),j=(0,y().wt)("collectionChartHorizontalBarUnselected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),A=(0,y().wt)("collectionChartHorizontalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),_=(0,y().wt)("collectionChartLineSelected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02037 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),M=(0,y().wt)("collectionChartLineSelectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),k=(0,y().wt)("collectionChartLineUnselected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02038 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),I=(0,y().wt)("collectionChartLineUnselectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),T=(0,y().wt)("collectionChartVerticalBarSelected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{d:"M18.75 20.25V4.75H21.25V20.25H18.75Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),P=(0,y().wt)("collectionChartVerticalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M18.75 20.25V4.75h2.5v15.5h-2.5z"}),(0,S.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})}),B=(0,y().wt)("collectionChartVerticalBarUnselected",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),R=(0,y().wt)("collectionChartVerticalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,S.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})});var V=()=>o(534177),F=()=>o(704152),K=()=>o(859428),D=()=>o(962730);const L={light:{column:{unselected:B,selected:T},bar:{unselected:j,selected:b},line:{unselected:k,selected:_},donut:{unselected:x,selected:h}},dark:{column:{unselected:R,selected:P},bar:{unselected:A,selected:w},line:{unselected:I,selected:M},donut:{unselected:C,selected:v}}};function O(e){let{chartConfig:t,disabled:o}=e;const n=(0,i().WS)(),a=(0,r().K8)((()=>{if(!t)return;const e=t.type;if("placeholder"===e)throw new Error("Should not happen");return e}),[t]);return(0,S.jsx)("div",{style:{display:"flex",marginLeft:10,marginRight:10,...n?{marginTop:10}:{}},children:(0,V().uv)(L.light).map((e=>(0,S.jsx)(E,{chartType:e,currentlySelectedChartType:a,disabled:o},e)))})}function E(e){let{chartType:t,currentlySelectedChartType:o,disabled:l}=e;const s=(0,p().ET)(),c=(0,i().v3)(),u=(0,i().Y0)(),g=(0,d().tz)(),y=(0,a().DP)(),{itemRef:h,isTabbable:v,onKeyDown:x}=(0,f().e)(),C=(0,a().IS)((e=>({button:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:6,margin:6,padding:6,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,position:"relative",width:"calc(20% - 12px)",height:0,paddingTop:0,paddingBottom:"calc(20% - 12px)",...u.isMobile?{width:50,height:50,paddingBottom:void 0}:{},...u.isPhone?{background:e.popoverBackground}:{}},selectedButton:{...u.isPhone?{background:e.popoverBackground}:{},boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:24,height:24,position:"absolute",top:8,...u.isMobile?{width:30,height:30}:{}},moreIcon:{width:18,height:18,position:"absolute",top:12,...u.isMobile?{width:26,height:26}:{},fill:e.lightIconColor}})),[u]),b=(0,r().K8)((()=>s.normalizedSchemaStore.state),[s]),w=(0,n.useCallback)((e=>{const t=s.collectionViewStore(),o=null==t?void 0:t.getChartConfig();t&&o&&(0,m().QJ)(e,o,c,t,s,b)}),[s,c,b]),j="dark"===y.mode?"dark":"light";let A=L[j][t].unselected(C.icon);return t===o&&(A=L[j][t].selected(C.icon)),(0,S.jsx)(K().A,{placement:D().W.Top,alignment:D().C.Center,renderTooltip:e=>g.formatMessage(m().FZ[t]),render:e=>(0,n.createElement)(F().A,{...e,ref:h,key:t,style:{...C.button,...t===o&&C.selectedButton},onClick:()=>{w(t)},onKeyDown:x,disallowTabbing:!v,disabled:l||t===o,disabledFeedback:l,ariaLabel:g.formatMessage(m().FZ[t])},A)})}o(944114),o(898992),o(672577),o(803949);var z=()=>o(594013),N=()=>o(100594),U=()=>o(499755),H=()=>o(67657),W=()=>o(921598),G=()=>o(713998);const q={viewBox:"0 0 20 20",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{d:"M12.25.125a.625.625 0 0 0-.625.625v7a.625.625 0 0 0 .625.625h7c.345 0 .625-.28.625-.625A7.625 7.625 0 0 0 12.25.125m.625 7v-5.72a6.38 6.38 0 0 1 5.72 5.72z"}),(0,S.jsx)("path",{d:"M10 2.375A7.625 7.625 0 1 0 17.625 10 .625.625 0 0 0 17 9.375h-6.375V3A.625.625 0 0 0 10 2.375M3.625 10c0-3.31 2.523-6.03 5.75-6.345V10a.625.625 0 0 0 .625.625h6.345A6.376 6.376 0 0 1 3.625 10"})]})},Y=(0,y().wt)("chartPieCutout",q);var $=()=>o(765974),Q=()=>o(979251),Z=()=>o(496603),J=()=>o(284371),X=()=>o(436696),ee=()=>o(246826),te=()=>o(317909),oe=()=>o(476492),ne=()=>o(656881),ie=(o(354520),o(737550),o.n(o(844751))),re=()=>o(743176),ae=()=>o(965134),le=()=>o(413267),se=()=>o(760217),ce=()=>o(406699),de=()=>o(811979),ue=()=>o(419357),pe=()=>o(928600),ge=()=>o(939740),me=()=>o(64e3),fe=()=>o(662971),ye=()=>o(722372),Se=()=>o(525432),he=()=>o(722872),ve=()=>o(553965),xe=()=>o(463830),Ce=()=>o(497222);const be="search-item",we="default",je="aggregate",Ae="distinct",_e={main_property:[we],aggregation_property:[we,je,Ae],y_axis_stacked_groups:[we]},Me=["sum","average","min","max","median"];function ke(e){return"unique"===e||"sum"===e||"average"===e||"min"===e||"max"===e||"median"===e}function Ie(e){switch(e.type){case"none":case"record_count":return e.type;case"property_group":{const t=e.groupByOption??"undefined";return`group:${e.property}-${t}`}case"aggregation":return`aggregation:${e.property}-${e.aggregation??"undefined"}`;default:(0,V().HB)(e)}}function Te(e){const{collectionContextStore:t,selectedProperty:o,properties:l,callsite:s,handlePropertySelect:c,originProps:p,disabled:g,rightStyle:f,...y}=e,h=(0,i().v3)(),v=(0,i().Y0)(),x=(0,d().tz)(),[C,b]=n.useState(""),w=(0,r().uB)(void 0,xe().A),j=(0,r().O$)(w),A=(0,r().K8)((()=>t.normalizedSchemaStore.state),[t]),_=(0,r().K8)((()=>l.length>Se().R8),[l.length]),M=(0,r().K8)((()=>{const e=Z().$z(l,(e=>e.sectionName));return _e[s].map((t=>{const o=e[t]??[];return[...o.filter((e=>"none"===e.key.type)),...o.filter((e=>"none"!==e.key.type)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))]}))}),[l,s]),k=(0,r().K8)((()=>{if(C.length>0){return M.map((e=>ie().filter(C,e,{extract:e=>e.name}).map((e=>{let{original:t}=e;return t}))))}return M}),[C,M]),I=(0,a().IS)((e=>({propertyIcon:{theme:e,fill:e.regularIconColor}})),[]);function T(){if(!o)return(0,S.jsx)(d().sA,{...m().G_.none});const e=e=>{for(let t=0;t<e.length;t++){const n=e[t];if(Ie(n.key)===Ie(o))return n}},t=e(l);if(t)return"property_group"===t.key.type&&t.sectionName===Ae?(0,S.jsx)("span",{style:J().RC,children:`${t.name} (${(0,m().TQ)({aggregation:{property:t.key.property,aggregator:"unique"},databaseType:void 0,intl:x})})`}):(0,S.jsx)("span",{style:J().RC,children:t.name});const n=(t=>{for(let o=0;o<t.length;o++){const n=t[o];if(n.subMenuItems){const t=e(n.subMenuItems);if(t)return{subMenuItem:t,menuItem:n}}}})(l);return n?(0,S.jsx)("span",{style:J().RC,children:`${n.menuItem.name} (${n.subMenuItem.name})`}):(0,S.jsx)(d().sA,{...m().G_.none})}function P(e){const{key:t,name:n,subMenuItems:i}=e;let r;if("record_count"===t.type)r=(0,ae().i)({width:16,height:16,marginRight:-2});else if("property_group"===t.type){const e=(0,G()._g)({schema:A,property:t.property});r=e?(0,S.jsx)(re().Ay,{type:e.type,icon:e.icon,size:16,theme:I.propertyIcon.theme,style:{fill:I.propertyIcon.fill}}):void 0}if(i&&i.length>0){return{key:n,render:(e,t)=>(0,S.jsx)(fe().A,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,S.jsx)(se().A,{...e,ref:t,title:n,icon:r}),renderExtension:(e,o)=>{let n;return n=v.isMobile?{menuType:he().gu.ActionSheet}:{menuType:he().gu.Popup,width:200},(0,S.jsx)(pe().A,{...n,...e,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,S.jsx)(u().A,{...e}),items:Z().oE(null==i?void 0:i.map(P))}],onAccept:t.onAccept})})}}),action:()=>null}}const a=o&&Ie(o)===Ie(t);let l=n;"aggregation"===t.type&&(l="value"===t.aggregation?x.formatMessage(m().bg.chartAggregateByValues):"unique"===t.aggregation?x.formatMessage(Pe.distinctValues):ye().zY[t.aggregation]);const s={key:n,render:e=>(0,S.jsx)(se().A,{...e,title:l,icon:r,right:a?(0,le().b)({width:14,height:14}):void 0}),action:t=>{c(e)}};return s}return(0,S.jsx)(de().A,{focused:!1,buttonPopupStore:w,alignmentToOrigin:ce().yP.End,placementToOrigin:ce().sx.Bottom,popupType:v.isMobile?ce().z7.SlideUp:ce().z7.Popup,onClose:()=>{b((()=>""))},renderOrigin:e=>(0,S.jsx)(Ce().A,{...(0,ve().A)(e,y),showChevron:!0,rotateChevron:j.open,icon:p.icon,title:p.title,right:T(),disabled:g,rightStyle:f}),render:e=>{const t=h.device.isMobile?{menuType:he().gu.ActionSheet}:{menuType:he().gu.Popup,width:250,maxHeight:400},o=[];if(_){const e={key:be,items:[{key:be,render:(e,t)=>(0,S.jsx)(ue().Ay,{...e,value:C,onChange:e=>{b((()=>e.target.value))},focusInitial:!0,placeholder:x.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.searchPlaceholder",defaultMessage:"Search properties..."})}),action:e=>{}}],showNoResultMessage:!0,render:e=>(0,S.jsx)(u().A,{isInput:!0,...e})};o.push(e)}if(k.some((e=>e.length>0)))k.forEach((e=>{if(0===e.length)return;const t=e[0].sectionName,n={key:t,items:e.map(P).filter(V().O9),render:e=>(0,S.jsx)(u().A,{...e,topBorder:t!==we})};o.push(n)}));else{const e=x.formatMessage(m().bg.noResultsMenuItem),t={key:e,items:[{key:`${e}-item`,action:()=>{},render:e=>(0,S.jsx)(me().A,{title:(0,S.jsx)(d().sA,{...m().bg.noResultsMenuItem})})}],render:e=>(0,S.jsx)(u().A,{...e})};o.push(t)}return(0,S.jsx)(pe().A,{...t,children:(0,S.jsx)(ge().Ay,{initialFocus:0,type:ge().Oh.Vertical,sections:o,onAccept:t=>{t.key!==be&&e.close()}})})}})}const Pe=(0,d().YK)({distinctValues:{id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.distinctValues",defaultMessage:"Distinct values"}});function Be(e){var t;const{environment:o,menuItem:n,chartConfig:i,collectionSchema:r,collectionViewStore:a,collectionContextStore:l,mainPropertyId:c}=e,{key:d,sectionName:u}=n,p=(0,z().o_)({property:c,collectionSchema:r,hideEmptyGroups:"donut"===i.type||Boolean(null===(t=i.chartFormat)||void 0===t?void 0:t.axisHideEmptyGroups)});if(!p)return;let g=(0,Z().mg)(i);const m="groups_reducer"===g.dataConfig.type?g.dataConfig.groupBy:p;if(m){if("property_group"===d.type){if(u!==Ae)return;"donut"===g.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"unique",property:d.property}}}:g=(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"unique",property:d.property}})}"donut"===g.type?"record_count"===d.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"count"}}}:"aggregation"===d.type&&("value"===d.aggregation?g.dataConfig={type:"results_reducer",nameProperty:c,valueProperty:d.property}:g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:d.aggregation,property:d.property}}}):"record_count"===d.type?g=(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"count"}}):"aggregation"===d.type&&(g="value"===d.aggregation?(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"results_reducer",groupBy:m,valueProperty:d.property}):(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:d.aggregation,property:d.property}})),te().createAndCommit({userAction:(0,s().m)(g)?"chartSettings.setYAxis":"chartSettings.setDonutSlice",environment:o,canUndo:!0,perform:e=>{ee().zv({store:a.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:l,action:(0,s().m)(g)?"charts_y_axis_what_to_show":"charts_donut_slice_value",charts_analytics_context:(0,oe().nL)(l)})}}var Re=()=>o(812480);function Ve(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),f=(0,a().IS)((e=>({errorIcon:(0,m().FE)(e)})),[]),y=(0,m().k1)(),h=(0,r().K8)((()=>u.collectionViewStore()),[u]),v=(0,r().K8)((()=>u.normalizedSchemaStore.state),[u]),x=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),C=(0,r().K8)((()=>{if("groups_reducer"===(null==x?void 0:x.type)){const e=x.groupBy;return(0,W().sj)(e)||(0,W().Ik)(e)?{type:"property_group",property:e.property,groupByOption:e.groupBy}:{type:"property_group",property:x.groupBy.property}}if("results_reducer"===(null==x?void 0:x.type))return{type:"property_group",property:x.nameProperty}}),[x]),b=(0,r().K8)((()=>{const e={icon:Q().j};return o&&(0,l().lc)(o)?{icon:$().b,iconStyle:f.errorIcon}:e}),[o,f.errorIcon]),w=(0,r().K8)((()=>{const e=(0,V().WP)(v),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,W().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Re().eD[e]),sectionName:we})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Re().WK[e]),sectionName:we})))});else{if(!(0,W().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we})}})),t}),[v,g]),j=n.useCallback((e=>{var o;const{key:n}=e,{property:i,groupByOption:r}=n;if(!t||!h)return;const a=v[i],l=(0,z().o_)({property:i,collectionSchema:v,hideEmptyGroups:!0});if(!a||!l)return;const s=Object.keys(v),d="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:s.find((e=>{const t=v[e];return Boolean(t&&(0,z().Iw)(t))})),p={aggregator:"count"},g=Z().mg(t);if(a&&(0,z().tH)(a)&&d)g.dataConfig={type:"results_reducer",nameProperty:i,valueProperty:d};else if(r){const e=(0,N().xS)({property:i,propertySchema:a,groupByOption:r,hideEmptyGroups:!0});e&&(g.dataConfig={type:"groups_reducer",groupBy:e,aggregationConfig:{aggregation:p}})}else if(l){const e="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.aggregation:p;g.dataConfig={type:"groups_reducer",groupBy:l,aggregationConfig:{aggregation:e}};const o="formula"===l.type?l.groupBy.sort:l.sort;g.chartFormat={...t.chartFormat,mainSort:a&&(0,U().e0)(a)?U().S0.yDescending:(0,U().gN)(o)}}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:g,sort:null===(o=g.chartFormat)||void 0===o?void 0:o.mainSort}),te().createAndCommit({userAction:"chartSettings.setDonutGroupBy",environment:c,canUndo:!0,perform:e=>{ee().zv({store:h.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_donut_property",charts_analytics_context:(0,oe().nL)(u)})}),[v,h,c,t,u]);return(0,S.jsx)(K().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,l().lc)(o),renderTooltip:e=>o?(0,S.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,S.jsx)(Te,{...e,collectionContextStore:u,selectedProperty:C,properties:w,handlePropertySelect:j,originProps:{title:(0,S.jsx)("span",{children:(0,S.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:b.icon},callsite:"main_property",disabled:s,rightStyle:y.whatToShowRightText})})}function Fe(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),f=(0,a().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:y().Ev.default,height:y().Ev.default,marginLeft:4}})),[]),h=(0,m().k1)(),v=(0,r().K8)((()=>g.collectionViewStore()),[g]),x=(0,r().K8)((()=>g.databaseType),[g]),C=(0,r().K8)((()=>g.normalizedSchemaStore.state),[g]),b=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),w=(0,r().K8)((()=>{if(b)return"groups_reducer"===b.type?b.groupBy.property:b.nameProperty}),[b]),j=(0,r().K8)((()=>w?C[w]:void 0),[w,C]),A=(0,r().K8)((()=>{if(b)if("groups_reducer"===b.type){const e=null==b?void 0:b.aggregationConfig.aggregation;if((0,H().Iq)(e))return{type:"record_count"};if(ke(e.aggregator)){const t=(0,G()._g)({schema:C,property:e.property});if(!t)return;return(0,N().JW)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===b.type&&b.valueProperty)return{type:"aggregation",property:b.valueProperty,aggregation:"value"}}),[C,b]),_=(0,r().K8)((()=>{if(!b||!j)return[];const e=[];(0,V().WP)(C).forEach((t=>{let[o,n]=t;if(!n||o===w||!(0,W().Eg)(n))return;const i=[];(0,z().Iw)(n)&&(0,z().tH)(j)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().bg.chartAggregateByValues),sectionName:je});const r=(0,N().JW)(n);if(r){Me.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().TQ)({aggregation:t,databaseType:x,intl:c})||"",sectionName:je};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().TQ)({aggregation:{aggregator:"unique",property:o},databaseType:x,intl:c})||"",sectionName:je};i.push(e)}const a={key:{type:"property_group",property:o},name:n.name,sectionName:r?je:Ae,subMenuItems:i};e.push(a)}));return[{key:{type:"record_count"},name:(0,m().TQ)({aggregation:{aggregator:"count"},databaseType:x,intl:c})||"",sectionName:"default"},...e]}),[b,j,C,x,c,w]),M=(0,r().K8)((()=>o&&(0,l().dG)(o)?()=>(0,$().b)(f.errorIcon):Y),[o,f.errorIcon]),k=n.useCallback((e=>{v&&t&&w&&Be({environment:u,menuItem:e,chartConfig:t,collectionSchema:C,collectionViewStore:v,collectionContextStore:g,mainPropertyId:w})}),[t,C,v,u,w,g]);return(0,S.jsx)(K().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,l().dG)(o),renderTooltip:e=>o?(0,S.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,S.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:o?void 0:A,properties:_,handlePropertySelect:k,originProps:{title:(0,S.jsx)("span",{style:J().RC,children:(0,S.jsx)(d().sA,{...m().bg.chartSliceDonutAggregation})}),icon:M},callsite:"aggregation_property",disabled:s,rightStyle:h.donutSliceValueRightText})})}var Ke=()=>o(496506),De=(o(964979),o(814603),o(147566),o(198721),()=>o(148307)),Le=()=>o(620586),Oe=()=>o(252051),Ee=()=>o(972435),ze=()=>o(884107),Ne=()=>o(901389),Ue=()=>o(436572);function He(e){return{width:Oe().o0+Oe().eq+Oe().PB,height:Oe().p0+Oe().jQ+Oe().PB}}async function We(e){const{environment:t,previewCanvas:o,chartStore:n}=e,{chart:i,responsiveChartOptions:r,exportBackgroundColor:a}=n.state;if(o)if("png"===e.format){const c=o.toDataURL("image/png");if("copy"===e.type){const d=await ze().R.clipboardActions.load();async function u(){const e=await fetch(c);return await e.blob()}const p=new ClipboardItem({"image/png":u()});try{await navigator.clipboard.write([p]),Ue().D6({label:Ee().A.formatMessage(d.clipboardMessages.copiedImageToClipboard)})}catch(s){Ne().f1(Ee().A.formatMessage(d.clipboardMessages.copyImageError))}}else if(t.device.isMobileNative){var l;null===(l=t.mobileNative)||void 0===l||l.showLightBoxV2({url:c,downloadName:`${Ee().A.formatMessage(Oe().jV.chart)}.png`,type:"image",from:"chart",state:"url_ready"})}else{const g=document.createElement("a");g.href=c,g.download=`${Ee().A.formatMessage(Oe().jV.chart)}.png`,g.click()}}else if("svg"===e.format){if("copy"===e.type)return;null==i||i.exportChartLocal({type:"image/svg+xml",filename:Ee().A.formatMessage(Oe().jV.chart)},{...(0,Oe().j2)(a),...r??{}})}else(0,V().HB)(e.format)}var Ge=()=>o(331542),qe=()=>o(45552),Ye=()=>o(864943),$e=()=>o(204063),Qe=()=>o(532564),Ze=()=>o(898486),Je=()=>o(62856),Xe=()=>o(11978),et=()=>o(597898);const tt=290,ot=8,nt=14;const it=function(e){const t=(0,d().tz)(),n=(0,i().Y0)();return n.isMobile&&n.isAndroid?null:(0,S.jsx)(de().A,{focused:!1,popupType:n.isMobile?ce().z7.SlideUp:ce().z7.Popup,placementToOrigin:D().W.Top,alignmentToOrigin:D().C.Center,render:e=>(0,S.jsx)(rt,{menuParent:e}),renderOrigin:n=>(0,S.jsx)(Ce().A,{...n,showChevron:!0,disabled:e.disabled,title:t.formatMessage(Oe().jV.exportChart),icon:o(820579).f})})};function rt(e){var t;const o=(0,i().v3)(),l=(0,d().tz)(),s=(0,Qe().V)(),c=(0,p().ET)(),g=(0,Xe().O)(),m=(0,et().P9)({name:"watermarkless_chart_export",spaceId:g,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id}),f=n.useRef(null),{isLoading:y,hasError:h,exportDisabled:v}=(0,r().K8)((()=>({isLoading:"loading"===s.state.previewCanvasState,hasError:"error"===s.state.previewCanvasState,exportDisabled:"loading"===s.state.previewCanvasState||"error"===s.state.previewCanvasState})),[s]),x=(0,r().K8)((()=>Le().Q1.filter((e=>!(!m&&"none"===e)))),[m]),C=(0,a().IS)((e=>{const t=o.device.isMobile;return{copyButton:{height:t?36:32,fontSize:t?16:14},downloadButton:{height:t?36:32,fontSize:t?16:14,display:"flex",justifyContent:"center",marginTop:8,background:e.contentBackground}}}),[o]),b=o.device.isMobile?{menuType:he().gu.Modal,title:l.formatMessage(Oe().jV.exportChart),right:(0,S.jsx)(qe().DoneMenuText,{}),onClickRight:e.menuParent.close}:{menuType:he().gu.Popup,width:tt},w=[{key:"preview",render:e=>(0,S.jsx)(at,{...e,previewCanvasRef:f,isLoading:y,hasError:h}),items:[]},{key:"background",render:e=>(0,S.jsx)(u().A,{...e,title:l.formatMessage(Oe().jV.exportChartBackground),mobileTitleStyle:{lineHeight:void 0},disableMobileBorders:!0,children:(0,S.jsx)("div",{style:{display:"flex",justifyContent:"space-between",paddingLeft:nt+3,paddingRight:nt+3,paddingTop:ot,paddingBottom:ot},children:e.children})}),items:x.map((e=>({key:e,render:t=>(0,S.jsx)(st,{menuListItemProps:t,disabled:v,colors:x,color:e}),action:()=>{s.setState({...s.state,exportBackgroundColor:e})}})))},{key:"export",render:e=>(0,S.jsx)(u().A,{...e,topBorder:!0,disableMobileBorders:!0,children:(0,S.jsx)("div",{style:{display:"flex",flexDirection:"column",padding:"8px 14px",paddingTop:8},children:e.children})}),items:[{key:"copyPng",render:e=>(0,S.jsx)($e().A,{...e,style:C.copyButton,disabled:v,children:l.formatMessage(Oe().jV.copyPng)}),action:async()=>{await We({environment:o,previewCanvas:f.current,chartStore:s,type:"copy",format:"png"}),(0,X().X)({environment:o,collectionContextStore:c,action:"charts_export_copy_png",charts_analytics_context:(0,oe().nL)(c)})}},{key:"downloadPng",render:e=>(0,S.jsx)(Ye().A,{...e,size:"lg",style:C.downloadButton,disabled:v,disabledFeedback:v,children:l.formatMessage(Oe().jV.downloadPng)}),action:async()=>{await We({environment:o,previewCanvas:f.current,chartStore:s,type:"download",format:"png"}),(0,X().X)({environment:o,collectionContextStore:c,action:"charts_export_download_png",charts_analytics_context:(0,oe().nL)(c)})}},{key:"downloadSvg",render:e=>o.device.isMobile?null:(0,S.jsx)(Ye().A,{...e,size:"lg",style:C.downloadButton,disabled:v,disabledFeedback:v,children:l.formatMessage(Oe().jV.downloadSvg)}),action:async()=>{await We({environment:o,previewCanvas:f.current,chartStore:s,type:"download",format:"svg"})}}]}];return(0,S.jsx)(pe().A,{...b,children:(0,S.jsx)(ge().Ay,{initialFocus:0,type:ge().Oh.Vertical,sections:w})})}function at(e){const t=(0,d().tz)(),o=(0,a().DP)(),i=(0,Qe().V)(),l=(0,r().K8)((()=>i.state.exportBackgroundColor),[i]),s=(0,Je().A)(!0,Oe().Yp,0,!1);n.useEffect((()=>{const t=new(Ke().default)((()=>({chart:i.state.chart,exportBackgroundColor:i.state.exportBackgroundColor,responsiveChartOptions:i.state.responsiveChartOptions})),{debugName:"chartDrawingStateStore"});function n(){const n=e.previewCanvasRef.current;n&&function(e,t,o,n){const{chart:i,responsiveChartOptions:r,exportBackgroundColor:a}=t;o((()=>{}));const l=e.getContext("2d");if(!i||!l)return;let s;setTimeout((()=>{o((e=>void 0===e?"loading":e))}),Oe().Yp);try{s=i.getSVG({...(0,Oe().j2)(a),...r??{}})}catch(S){return console.error(S),void o((()=>"error"))}const c=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),d=URL.createObjectURL(c),u=new Image,p=new Image,g=new Image,m=new Promise(((e,t)=>{"gradient"===a?(u.onload=()=>e(u),u.onerror=()=>t(new Error("Failed to load gradient image")),u.src="light"===n.mode?De().A.images.charts.chartsExportGradientLightPng:De().A.images.charts.chartsExportGradientDarkPng):e(u)})),f=new Promise(((e,t)=>{p.onload=()=>e(p),p.onerror=()=>t(new Error("Failed to load chart image")),p.src=`data:image/svg+xml;charset=utf-8;base64,${btoa(unescape(encodeURIComponent(s)))}`})),y=new Promise(((e,t)=>{g.onload=()=>e(g),g.onerror=()=>t(new Error("Failed to load chart image")),g.src="light"===n.mode?De().A.images.charts.chartsExportLogoLightPng:De().A.images.charts.chartsExportLogoDarkPng}));Promise.all([m,f,y]).then((t=>{let[i,r,s]=t;URL.revokeObjectURL(d);const c=He();if(e.width=c.width*Oe().Zz,e.height=c.height*Oe().Zz,l.scale(Oe().Zz,Oe().Zz),"gradient"===a?l.drawImage(i,0,0,e.width,e.height):"none"===a?(l.fillStyle=n.contentBackground,l.fillRect(0,0,e.width,e.height)):(l.fillStyle=(0,Le().NF)(n,a,!1),l.fillRect(0,0,e.width,e.height)),"none"!==a&&(l.strokeStyle=n.regularDividerColor,l.fillStyle=n.contentBackground,l.shadowColor="dark"===n.mode?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0.07)",l.shadowBlur=24,l.shadowOffsetY=8,l.beginPath(),l.roundRect(Oe().iq,Oe().XC,e.width/Oe().Zz-Oe().eq,e.height/Oe().Zz-Oe().jQ,12),l.stroke(),l.fill(),l.shadowColor="transparent"),"none"!==a){const e=Ee().A.formatMessage(Oe().jV.madeWithNotion);l.font=`14px ${J().Tf.sans}`;const t=c.width/2+Oe().ev+Oe().kC,o=c.height-Oe().XC/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=n.lightTextColor,l.fillText(e,t,o);const i=l.measureText(e),r=c.width/2-i.width/2,a=o-Oe().kC/2;l.drawImage(s,0,0,s.width,s.height,r,a,Oe().kC,Oe().kC)}"none"===a?l.drawImage(r,Oe().AI,Oe().AI):l.drawImage(r,Oe().iq+Oe().AI,Oe().XC+Oe().AI),o((()=>"success"))})).catch((()=>{o((()=>"error"))}))}(n,t.state,i.updatePreviewState,o)}return n(),t.addListener(n),()=>{t.removeListener(n)}}),[e.previewCanvasRef,i,o]);const c=(0,a().IS)((t=>{const o=tt-2*nt,n=He(),i=o*(n.height/n.width);return{container:{width:`calc(100% - ${2*nt})`,height:e.isLoading||e.hasError?i:void 0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:ot,marginLeft:nt,marginRight:nt,border:`1px solid ${t.regularDividerColor}`,borderRadius:6,fontSize:12,color:t.lightTextColor},canvas:{width:"100%",borderRadius:6,display:e.isLoading||e.hasError?"none":"block"}}}),[e.hasError,e.isLoading,l]);return(0,S.jsx)(u().A,{title:t.formatMessage(Oe().jV.exportChartPreview),disableMobileBorders:!0,mobileTitleStyle:{lineHeight:void 0},children:(0,S.jsxs)("div",{style:c.container,children:[(0,S.jsx)("canvas",{style:c.canvas,ref:e.previewCanvasRef}),s&&e.isLoading&&(0,S.jsx)(Ge().A,{}),e.hasError&&(0,S.jsx)("span",{children:t.formatMessage(Ze().k1.generic_error)})]})})}const lt=10;function st(e){const t=(0,d().tz)(),o=(0,Qe().V)(),n=(0,i().Y0)(),l=(0,r().K8)((()=>e.color===o.state.exportBackgroundColor),[o,e.color]),s=(0,a().IS)((t=>({button:{position:"relative",width:`calc((100%  / ${e.colors.length}) - ${lt}px)`,height:n.isMobile?36:28,borderRadius:4,boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 3px ${t.regularDividerColor}`,background:(0,Le().NF)(t,e.color,!1)},selectedButton:{boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 4px ${t.blueColor}`},hoveredStyle:{background:(0,Le().NF)(t,e.color,!0)},pressedStyle:{background:(0,Le().NF)(t,e.color,!1)}})),[n.isMobile,e.color,e.colors.length]);return(0,S.jsx)(F().A,{...e.menuListItemProps,style:{...s.button,...l?s.selectedButton:{}},hoveredStyle:s.hoveredStyle,pressedStyle:s.pressedStyle,ariaLabel:t.formatMessage((0,Le().nH)(e.color)),disabled:e.disabled,disabledFeedback:e.disabled})}var ct=()=>o(757695),dt=()=>o(844698),ut=()=>o(708685),pt=()=>o(582684),gt=()=>o(686526),mt=()=>o(75544),ft=()=>o(622281),yt=()=>o(417591),St=()=>o(941814),ht=()=>o(818367);const vt=(0,d().YK)({alphabetical:{defaultMessage:"{propertyName} A  Z",id:"charts.settings.sort.alphabetical"},reverseAlphabetical:{defaultMessage:"{propertyName} Z  A",id:"charts.settings.sort.reverseAlphabetical"},chronological:{defaultMessage:"Old  New",id:"charts.settings.sort.chronological"},reverseChronological:{defaultMessage:"New  Old",id:"charts.settings.sort.reverseChronological"},lowHigh:{defaultMessage:"{propertyName} Low  High",id:"charts.settings.sort.lowHigh"},highLow:{defaultMessage:"{propertyName} High  Low",id:"charts.settings.sort.highLow"},ascending:{defaultMessage:"{propertyName} Ascending",id:"charts.settings.sort.ascending"},descending:{defaultMessage:"{propertyName} Descending",id:"charts.settings.sort.descending"},manual:{defaultMessage:"Manual",id:"charts.settings.sort.manual"},advanced:{defaultMessage:"Advanced",id:"charts.settings.sort.advanced"}});function xt(e,t){const o=null==e?void 0:e.type;if(!o)return t?vt.ascending:vt.descending;if(t)switch(o){case"formula":switch((0,ut().getFormulaPropertySchemaResultType)(e)){case"date":return vt.chronological;case"text":return vt.alphabetical;case"number":return vt.lowHigh;default:return vt.ascending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return vt.alphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return vt.chronological;case"number":return vt.lowHigh;default:return vt.ascending}switch(o){case"formula":switch((0,ut().getFormulaPropertySchemaResultType)(e)){case"date":return vt.reverseChronological;case"text":return vt.reverseAlphabetical;case"number":return vt.highLow;default:return vt.descending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return vt.reverseAlphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return vt.reverseChronological;case"number":return vt.highLow;default:return vt.descending}}var Ct=()=>o(396671),bt=()=>o(963589),wt=()=>o(352377),jt=()=>o(828973);function At(e){let{chartConfig:t,chartError:o,disabled:a,sortType:l}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),f=(0,yt().Y)({chartConfig:t,chartError:o,collectionContextStore:u}),{collectionViewStore:y,databaseType:h,collectionSettingsStore:v,numberOfSorts:x}=(0,r().K8)((()=>({collectionViewStore:u.collectionViewStore(),databaseType:u.databaseType,collectionSettingsStore:u.settingsStore,numberOfSorts:u.currentSortsStore.state.length})),[u]),C=(0,r().K8)((()=>u.normalizedSchemaStore.state),[u.normalizedSchemaStore]),b=(0,m().uB)(t,C),{stackedPropertySchema:w,stackedGroupBy:j}=(0,r().K8)((()=>{var e;if("results_reducer"===(null==t?void 0:t.dataConfig.type)||"donut"===(null==t?void 0:t.type))return{stackedPropertySchema:void 0,stackedGroupBy:void 0};const o=null==t||null===(e=t.dataConfig.aggregationConfig.stackOptions)||void 0===e?void 0:e.groupBy,n=null==o?void 0:o.property;return n?{stackedPropertySchema:(0,G()._g)({schema:C,property:n}),stackedGroupBy:o}:{stackedPropertySchema:void 0,stackedGroupBy:void 0}}),[t,C]),A=(0,r().K8)((()=>"stacked"===l?w:b),[b,l,w]),_=(0,r().K8)((()=>!A||"formula"!==A.type||(0,N().Yp)(A)),[A]),M=(0,r().K8)((()=>{var e,o;if(null!=t&&null!==(e=t.chartFormat)&&void 0!==e&&e.mainSort&&"main"===l)return t.chartFormat.mainSort;if("groups_reducer"===(null==t||null===(o=t.dataConfig)||void 0===o?void 0:o.type)){var n;const e="stacked"===l&&j?j:null==t||null===(n=t.dataConfig)||void 0===n?void 0:n.groupBy,o=(0,W().Kq)(e);return"formula"===e.type&&"formula"===(null==b?void 0:b.type)?(0,N().Yp)(b)||(0,N().Yp)(b)?(0,U().gN)(o):N().Rb[l]:(0,U().gN)(o)}return N().Rb[l]}),[t,b,l,j]),k=(0,m().Zv)(t,C),I=(0,r().K8)((()=>{var e;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type)){const e=null==t?void 0:t.dataConfig.aggregationConfig.aggregation;return(0,m().TQ)({aggregation:e,databaseType:h,intl:g})}return null==k?void 0:k.name}),[t,h,g,k]),T=(0,m().k1)(),P=n.useCallback(((e,o)=>{if(!(y&&t&&b&&_))return;const n=Z().mg(t);if("stacked"===l&&"groups_reducer"===n.dataConfig.type&&(0,s().m)(n)){var i;const t=null===(i=n.dataConfig.aggregationConfig.stackOptions)||void 0===i?void 0:i.groupBy;t&&("formula"===t.type?t.groupBy.sort=Mt(e,t.groupBy.type):t.sort=Mt(e,t.type))}if("main"===l&&(n.chartFormat={...n.chartFormat,mainSort:e},"groups_reducer"===n.dataConfig.type&&n.dataConfig.groupBy)){const t=n.dataConfig.groupBy;"formula"===t.type?t.groupBy.sort=Mt(e,t.groupBy.type):t.sort=Mt(e,t.type)}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:n,sort:e}),te().createAndCommit({userAction:"chartSettings.setMainSort",environment:c,canUndo:!0,perform:e=>{ee().zv({store:y.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_x_axis_sort",charts_analytics_context:(0,oe().nL)(u)}),e!==U().S0.manual&&o&&o.close(),e===U().S0.resultsAdvanced&&(0===x?gt().a2({collectionSettingsStore:v,item:{type:"createSort"}}):gt().a2({collectionSettingsStore:v,item:{type:"sort"}}))}),[y,t,b,_,l,c,u,x,v]);if(!_||!A)return null;const B=[];B.push({key:U().S0.xAscending,type:"button",title:g.formatMessage(xt(A,!0),{propertyName:A.name})}),B.push({key:U().S0.xDescending,type:"button",title:g.formatMessage(xt(A,!1),{propertyName:A.name})});const R=[];R.push({key:U().S0.yAscending,type:"button",title:g.formatMessage(vt.lowHigh,{propertyName:I})}),R.push({key:U().S0.yDescending,type:"button",title:g.formatMessage(vt.highLow,{propertyName:I})});const V=[];"groups_reducer"===(null==t?void 0:t.dataConfig.type)&&null!=A&&A.type&&(0,m().Iq)(A)&&V.push({key:U().S0.manual,type:"button",title:g.formatMessage(vt.manual)});return!("checkbox"===(null==A?void 0:A.type)||"person"===(null==A?void 0:A.type)||"formula"===(null==A?void 0:A.type)&&("checkbox"===(0,ut().getFormulaPropertySchemaResultType)(A)||"person"===(0,ut().getFormulaPropertySchemaResultType)(A)))&&V.push(...B),"stacked"!==l&&(0,U().e0)(A)&&V.push(...R),"results_reducer"===(null==t?void 0:t.dataConfig.type)&&V.push({key:U().S0.resultsAdvanced,type:"button",title:g.formatMessage(vt.advanced)}),(0,S.jsx)(jt().A,{title:(0,S.jsx)(d().sA,{...m().bg.chartSortBy}),selectedKey:M,options:V,icon:pt().C,iconStyle:{transform:"main"===l?"rotate(-90deg)":void 0},onChange:P,disabled:a,disableParentClose:!0,rightStyle:T.sortByRightText,children:f&&t&&(0,S.jsx)(_t,{groupedChartReducer:f,sortType:l,chartConfig:t})})}function _t(e){let{groupedChartReducer:t,sortType:o,chartConfig:n}=e;const i=(0,p().ET)(),a=(0,bt().X)("collection_group_reducer_visible"),l=(0,r().K8)((()=>{var e;return null===(e=n.chartFormat)||void 0===e?void 0:e.mainSort}),[n]),c=(0,r().K8)((()=>{const e=i.normalizedFormatStore.state;return(0,W().H2)(e,"chart_config","stacked"===o?"chart_subgroups":"collection_groups")}),[o,i]),d=(0,r().K8)((()=>"main"===o?(0,St().hk)():(0,St().H4)()),[o]),u=(0,r().K8)((()=>ct().default.createClass(d,{name:"GroupsLimitStore"})),[d]),g=(0,r().uB)(void 0,u),m=(0,r().K8)((()=>(0,ht().x)()),[]),f=(0,mt().A)({id:dt().jJ,reducer:t,collectionContextStore:i,debounceWait:m}),y=(0,r().K8)((()=>{var e;if(!f||!(0,s().m)(n)||"groups_reducer"!==n.dataConfig.type)return!1;const t=(0,ft().AY)({groupedDataConfig:n.dataConfig,hideEmptyGroups:Boolean(null===(e=n.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups),mainSort:l});return"datetime"===t||"linear"===t}),[f,n,l]),h=(0,r().K8)((()=>{if(f&&("main"!==o||"manual"!==l))return(0,ft().CL)({chartConfig:n,sortType:o,groupedChartReducerResults:f})}),[f,o,l,n]),[v,x]=(0,Ct().d)({collectionContextStore:i,groupBy:c,groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",reducerResult:f,groupsLimit:d,renderGroupsFromAggregationArgs:h,removeUncategorized:y}),C=(0,r().K8)((()=>{const e=c?(0,W().Kq)(c):void 0;return"manual"!==(null==e?void 0:e.type)||"main"===o&&("y-ascending"===l||"y-descending"===l)}),[l,c,o]);return c?a?(0,S.jsx)(wt().L,{collectionContextStore:i,groupBy:c,groupByKey:"chart_config",groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupsDisplayState:v,disableReorder:C}):(0,S.jsx)(Re().Rb,{collectionContextStore:i,groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupByKey:"chart_config",groupsLimitStore:g,groupsDisplayState:v,disableHideAll:!0,disableLoadMore:!0,disableReorder:C}):null}function Mt(e,t){switch(e){case U().S0.manual:return{type:"manual"};case U().S0.xAscending:return{type:"ascending"};case U().S0.xDescending:return{type:"descending"};case U().S0.yAscending:case U().S0.yDescending:default:return(0,W()._o)(t)||"number"===t?{type:"ascending"}:{type:"manual"}}}var kt=()=>o(638045),It=()=>o(202017);const Tt=(0,y().wt)("chartGridLine",{viewBox:"0 0 20 20",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("circle",{cx:"4",cy:"10",r:"1"}),(0,S.jsx)("circle",{cx:"8",cy:"10",r:"1"}),(0,S.jsx)("circle",{cx:"12",cy:"10",r:"1"}),(0,S.jsx)("circle",{cx:"16",cy:"10",r:"1"})]})}),Pt={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M14.424 5.248c1.181-1.18 3.201-.344 3.201 1.326V14c0 1.036-.84 1.875-1.875 1.875H4.25A1.875 1.875 0 0 1 2.375 14v-1.959c0-.497.198-.974.55-1.326l2.54-2.54a1.875 1.875 0 0 1 2.65 0l1.25 1.25c.244.243.64.243.884 0zm1.951 1.326a.625.625 0 0 0-1.067-.442l-4.175 4.176a1.875 1.875 0 0 1-2.652 0L7.232 9.059a.625.625 0 0 0-.884 0l-2.54 2.54a.63.63 0 0 0-.183.442V14c0 .345.28.625.625.625h11.5c.345 0 .625-.28.625-.625z"})},Bt=(0,y().wt)("graphArea",Pt),Rt={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M8.455 16.066c-.367.422-.855.747-1.473.747-.838 0-1.426-.584-1.83-1.227-.414-.658-.743-1.54-1.028-2.484-.28-.925-.53-1.957-.777-2.968l-.02-.084c-.255-1.046-.505-2.066-.782-2.962a.625.625 0 1 1 1.194-.37c.29.94.55 1.998.802 3.036l.017.067c.249 1.024.493 2.028.763 2.92.277.92.568 1.67.889 2.18.329.523.59.642.772.642.136 0 .308-.063.53-.318q.344-.394.683-1.226c.45-1.109.817-2.605 1.198-4.167l.008-.035c.371-1.52.757-3.103 1.246-4.306.246-.606.537-1.163.898-1.577.367-.422.855-.747 1.473-.747.837 0 1.422.586 1.824 1.228.412.657.74 1.54 1.024 2.482.276.913.526 1.93.77 2.929l.03.123c.256 1.046.508 2.066.788 2.961a.625.625 0 1 1-1.193.373c-.294-.94-.555-1.998-.81-3.037l-.026-.109c-.247-1.01-.489-1.998-.755-2.878-.278-.92-.568-1.67-.887-2.18-.33-.526-.587-.641-.765-.641-.136 0-.309.062-.53.317q-.345.394-.683 1.226c-.45 1.109-.817 2.605-1.198 4.167l-.008.035c-.371 1.52-.757 3.103-1.246 4.306-.247.606-.537 1.163-.898 1.577"})},Vt=(0,y().wt)("lineCurve",Rt);var Ft=()=>o(594952);const Kt={viewBox:"0 0 20 20",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{d:"M11 5.938a1 1 0 1 1-2 0 1 1 0 0 1 2 0m1.166 1.896A1 1 0 1 0 13.58 6.42a1 1 0 0 0-1.415 1.414M14.063 11a1 1 0 1 1 0-2 1 1 0 0 1 0 2M7.834 7.835A1 1 0 1 0 6.42 6.42a1 1 0 0 0 1.414 1.415"}),(0,S.jsx)("path",{d:"M2.988 7a7.627 7.627 0 1 1 8.853 10.4l-.042.01-.042.005c-1.061.115-2.019-.829-1.804-1.962l.262-1.38a1.188 1.188 0 0 0-1.282-1.402l-2.025.199c-2.848.28-5.044-2.462-4.148-5.18l.185-.563.015-.05.012-.04zm1.164.457-.02.062-.185.562c-.613 1.86.89 3.737 2.84 3.546l2.023-.2a2.437 2.437 0 0 1 2.633 2.881l-.261 1.38c-.05.262.16.493.408.487a6.375 6.375 0 1 0-7.438-8.718"})]})},Dt=(0,y().wt)("paintPalette",Kt);var Lt=()=>o(922189);const Ot={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M15.875 4.5a2.125 2.125 0 0 0-2.125-2.125h-7.5A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125zm-2.125-.875c.483 0 .875.392.875.875v4.875h-9.25V4.5c0-.483.392-.875.875-.875zm-8.375 7h9.25V15.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})},Et=(0,y().wt)("rectangleSplit2Vertical",Ot);var zt=()=>o(467248);const Nt={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M11.72 4.403a.625.625 0 1 0-1.04.694l2.804 4.205v3.223a.625.625 0 0 0 1.25 0V9.21l2.742-4.113a.625.625 0 0 0-1.04-.694L14.078 7.94zm-7.543.037a.625.625 0 1 0-1.016.729l2.504 3.496-2.504 3.496a.625.625 0 1 0 1.016.728l2.257-3.151 2.257 3.15a.625.625 0 1 0 1.016-.727L7.203 8.665l2.504-3.496a.625.625 0 1 0-1.016-.728L6.434 7.59zM2.25 14.625a.625.625 0 1 0 0 1.25h.005a.625.625 0 0 0 0-1.25zm1.933 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.005a.625.625 0 0 0 0-1.25z"})},Ut=(0,y().wt)("textXYunderline",Nt);var Ht=()=>o(966098),Wt=()=>o(946548),Gt=()=>o(755735),qt=()=>o(35091);const Yt=1e3;function $t(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:l}=e;const s=(0,i().v3)(),c=(0,p().ET)(),u=(0,a().DP)(),g=(0,n.useCallback)((e=>{var t;const o=null===(t=(0,Le().BV)(e,u))||void 0===t?void 0:t.slice(0,5);return{key:e,type:"button",title:(0,S.jsx)(d().sA,{...m().pP[e]}),caption:o?(0,S.jsx)("div",{style:{display:"flex"},children:null==o?void 0:o.map((e=>(0,S.jsx)("div",{style:{background:e,borderRadius:2,width:12,height:12,marginRight:3,marginTop:1}},e)))}):null,captionInline:!0,captionStyle:{marginLeft:"auto"},inlineSpacerStyle:{display:"none"}}}),[u]),f=(0,n.useMemo)((()=>[N().kq.map(g),N().VY.map(g)]),[g]),y=(null===(t=r.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",h=(0,a().IS)((()=>({icon:{width:20,height:20,marginLeft:2}})),[]);return(0,S.jsx)(jt().A,{disabled:l,title:(0,S.jsx)(d().sA,{...m().Zr.chartColor}),selectedKey:y,sections:f,icon:Dt,iconStyle:h.icon,hideCheck:!0,onChange:e=>{if(!e)return;const t=(0,Z().mg)(r);t.chartFormat||(t.chartFormat={}),t.chartFormat.colorTheme=e,(0,Le().Pi)(e)||(t.chartFormat.weightColorValue=!1),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:s,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:s,collectionContextStore:c,action:"charts_style_color"})}})}function Qt(e){const t=(0,i().Y0)(),o=(0,r().uB)(void 0,xe().A);return(0,S.jsx)(de().A,{focused:!1,popupType:t.isMobile?ce().z7.SlideUp:ce().z7.Popup,alignmentToOrigin:ce().yP.End,placementToOrigin:ce().sx.Bottom,buttonPopupStore:o,renderOrigin:t=>(0,S.jsx)(Ce().A,{...t,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().bg.chartMoreStyle}),rotateChevron:o.state.open,icon:Ft().I,disabled:e.disabled}),render:t=>(0,S.jsx)(Zt,{parent:t,collectionViewStore:e.collectionViewStore,chartConfig:e.chartConfig,disabled:e.disabled})})}function Zt(e){const{collectionViewStore:t,chartConfig:o,disabled:n}=e,{isMobile:l}=(0,i().Y0)(),c=(0,bt().X)("charts_next"),d=(0,p().ET)(),g=(0,r().O$)(d.normalizedSchemaStore),m=(0,r().K8)((()=>{var e;if((0,s().m)(o))return"groups_reducer"===(null==o||null===(e=o.dataConfig)||void 0===e?void 0:e.type)?(0,G()._g)({schema:g,property:o.dataConfig.groupBy.property}):void 0}),[o,g]),f=[],y={key:"default",items:[{key:"chartHeight",render:(e,i)=>(0,S.jsx)(Jt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"groupStyle",render:(e,i)=>(0,s().m)(o)&&"groups_reducer"===o.dataConfig.type&&o.dataConfig.aggregationConfig.stackOptions?(0,S.jsx)(Xt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"gridLine",render:(e,i)=>(0,s().m)(o)?(0,S.jsx)(eo,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisLabel",render:(e,i)=>(0,s().m)(o)?(0,S.jsx)(oo,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisAvatarStyle",render:(e,i)=>(0,s().m)(o)&&m&&(0,N().fn)(m)?(0,S.jsx)(to,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutValue",render:e=>"donut"!==o.type?null:(0,S.jsx)(ao,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"colorByValue",render:e=>{var i;const r=null===(i=o.chartFormat)||void 0===i?void 0:i.colorTheme;return"line"===o.type||!r||r&&!(0,Le().Pi)(r)?null:(0,S.jsx)(so,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"smoothLine",render:e=>"line"!==o.type?null:(0,S.jsx)(io,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"areaFill",render:e=>"line"!==o.type?null:(0,S.jsx)(ro,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"legend",render:e=>(0,S.jsx)(co,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"dataLabels",render:e=>(0,s().m)(o)&&(0,N().D5)(o)?(0,S.jsx)(po,{...e,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutDataLabels",render:(e,i)=>"donut"!==o.type?null:(0,S.jsx)(go,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"valueLabel",render:e=>{var i;return"donut"!==o.type||null!==(i=o.chartFormat)&&void 0!==i&&i.donutHideValue||!c?null:(0,S.jsx)(lo,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"caption",render:e=>(0,S.jsx)(uo,{...e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}}],render:e=>(0,S.jsx)(u().A,{...e})};f.push(y);const h=l?{menuType:he().gu.ActionSheet}:{menuType:he().gu.Popup,width:280,maxHeight:400},v=(0,a().IS)((()=>({menuList:{paddingTop:8,paddingBottom:8}})),[]);return(0,S.jsx)(pe().A,{...h,children:(0,S.jsx)(ge().Ay,{initialFocus:void 0,type:ge().Oh.Vertical,sections:f,resetFocusOnMouseOut:!0,style:v.menuList})})}function Jt(e){const{chartConfig:t,collectionViewStore:o}=e,a=(0,i().v3)(),l=(0,i().Y0)(),s=(0,r().K8)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.height;return o||N().bg.medium}),[t]),c=(0,n.useCallback)((e=>{const n=(0,Z().mg)(t);n.chartFormat||(n.chartFormat={}),n.chartFormat.height=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,a]),p=(0,n.useMemo)((()=>(0,V().WP)(m().WG).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[s,c]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,S.jsx)(Ce().A,{...e,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartHeight}),icon:kt().t,right:s?(0,S.jsx)(d().sA,{...m().WG[s]}):null}),renderExtension:(t,o)=>{const n=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartHeight}),device:l,onClickRight:o.close,popupEvents:t});return(0,S.jsx)(pe().A,{...n,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"chartHeight",render:e=>(0,S.jsx)(u().A,{...e}),items:p}]})})}})}function Xt(e){const{chartConfig:t,collectionViewStore:o}=e,a=(0,i().v3)(),l=(0,i().Y0)(),s=(0,r().K8)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisGroupStyle;return o||N().PC.normal}),[t]),c=(0,n.useCallback)((e=>{const n=(0,Z().mg)(t);n.chartFormat||(n.chartFormat={axisGroupStyle:N().PC.normal}),n.chartFormat.axisGroupStyle=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,a]),p=(0,n.useMemo)((()=>(0,V().WP)(m().TP).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[s,c]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,S.jsx)(Ce().A,{...e,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartGroupStyle}),icon:Et,right:s?(0,S.jsx)(d().sA,{...m().TP[s]}):null}),renderExtension:(t,o)=>{const n=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartGroupStyle}),device:l,onClickRight:o.close,popupEvents:t});return(0,S.jsx)(pe().A,{...n,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"groupStyles",render:e=>(0,S.jsx)(u().A,{...e}),items:p}]})})}})}function eo(e){const t=(0,i().v3)(),o=(0,p().ET)(),a=(0,i().Y0)(),l=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisGridLine;return o||"horizontal"}),[e.chartConfig]),s=(0,n.useCallback)((n=>{const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={axisGridLine:N().JQ.horizontal}),i.chartFormat.axisGridLine=n,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_grid_line"})}),[e.chartConfig,t,e.collectionViewStore,o]),c=(0,n.useMemo)((()=>(0,V().WP)(m().G_).map((e=>{let[t,o]=e;const n=l===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{s(t)}}}))),[l,s]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,S.jsx)(Ce().A,{...t,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartGridLine}),right:l?(0,S.jsx)(d().sA,{...m().G_[l]}):null,icon:Tt,disabled:e.disabled}),renderExtension:(t,o)=>{const n=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartGridLine}),device:a,onClickRight:o.close,popupEvents:t});return(0,S.jsx)(pe().A,{...n,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,S.jsx)(u().A,{...e}),items:c}]})})}})}function to(e){const t=(0,i().v3)(),o=(0,i().Y0)(),a=(0,m().k1)(),l=(0,r().K8)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisAvatar)||N().GL.avatar}),[e.chartConfig]),s=(0,n.useCallback)((o=>{const n=(0,Z().mg)(e.chartConfig);n.chartFormat||(n.chartFormat={axisAvatar:N().GL.avatar}),n.chartFormat.axisAvatar=o,te().createAndCommit({userAction:"chartSettings.updateAxisAvatarFormat",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}})}),[e.chartConfig,e.collectionViewStore,t]),c=(0,n.useMemo)((()=>(0,V().WP)(m().RO).map((e=>{let[t,o]=e;const n=l===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{s(t)}}}))),[l,s]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,S.jsx)(Ce().A,{...t,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartAxisAvatarFormat}),right:l?(0,S.jsx)("span",{style:J().RC,children:(0,S.jsx)(d().sA,{...m().RO[l]})}):null,rightStyle:a.avatarStyle,icon:Lt().u,disabled:e.disabled}),renderExtension:(t,n)=>{const i=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartAxisName}),device:o,onClickRight:n.close,popupEvents:t});return(0,S.jsx)(pe().A,{...i,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"avatarStyles",render:e=>(0,S.jsx)(u().A,{...e}),items:c}]})})}})}function oo(e){const t=(0,i().v3)(),o=(0,p().ET)(),a=(0,i().Y0)(),l=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisLabel;return o||N().tG.none}),[e.chartConfig]),s=(0,r().K8)((()=>"bar"===e.chartConfig.type),[e.chartConfig]),c=(0,n.useMemo)((()=>s?l===N().tG.x_axis?m().Le.y_axis:l===N().tG.y_axis?m().Le.x_axis:m().Le[l]:m().Le[l]),[s,l]),g=(0,n.useCallback)((n=>{const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={axisLabel:N().tG.none}),i.chartFormat.axisLabel=n,te().createAndCommit({userAction:"chartSettings.updateAxisLabel",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_axis_label"})}),[e.chartConfig,e.collectionViewStore,t,o]),f=(0,n.useMemo)((()=>{let e=(0,V().WP)(m().Le);if(s){const t=[];for(const[o,n]of e)o===N().tG.x_axis?t.push([N().tG.y_axis,n]):o===N().tG.y_axis?t.push([N().tG.x_axis,n]):t.push([o,n]);e=t}return e.map((e=>{let[t,o]=e;const n=l===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{g(t)}}}))}),[s,l,g]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,S.jsx)(Ce().A,{...t,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartAxisName}),right:c?(0,S.jsx)(d().sA,{...c}):null,icon:Ut,disabled:e.disabled}),renderExtension:(t,o)=>{const n=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartAxisName}),device:a,onClickRight:o.close,popupEvents:t});return(0,S.jsx)(pe().A,{...n,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,S.jsx)(u().A,{...e}),items:f}]})})}})}function no(e){return e.device.isMobile?{menuType:he().gu.ActionSheet,...e.popupEvents}:{menuType:he().gu.Popup,width:200,...e.popupEvents}}function io(e){const t=(0,i().v3)(),o=(0,p().ET)(),r=(0,n.useMemo)((()=>{var t;return Boolean(null===(t=e.chartConfig)||void 0===t||null===(t=t.chartFormat)||void 0===t?void 0:t.smoothLine)}),[e.chartConfig]),a=(0,n.useCallback)((()=>{var n;const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={smoothLine:!1}),i.chartFormat.smoothLine=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.smoothLine),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_smooth_line"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,S.jsx)(qt().A,{...e.menuListItemProps,title:(0,S.jsx)(d().sA,{...m().Zr.chartSmoothLine}),showChevron:!1,switcherProps:{on:r},icon:Vt,onClick:a,disabled:e.disabled})}function ro(e){const t=(0,i().v3)(),o=(0,p().ET)(),r=(0,n.useMemo)((()=>{var t;return!(null!==(t=e.chartConfig)&&void 0!==t&&null!==(t=t.chartFormat)&&void 0!==t&&t.hideLineFillArea)}),[e.chartConfig]),a=(0,n.useCallback)((()=>{var n;const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLineFillArea:!1}),i.chartFormat.hideLineFillArea=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLineFillArea),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_area_fill"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,S.jsx)(qt().A,{...e.menuListItemProps,title:(0,S.jsx)(d().sA,{...m().Zr.chartLineFillArea}),showChevron:!1,switcherProps:{on:r},icon:Bt,onClick:a,disabled:e.disabled})}function ao(e){var t;const o=(0,i().v3)(),r=(0,p().ET)(),{collectionViewStore:a,chartConfig:l,disabled:s}=e,c=(0,n.useMemo)((()=>{var e;return!(null!=l&&null!==(e=l.chartFormat)&&void 0!==e&&e.donutHideValue)}),[null==l||null===(t=l.chartFormat)||void 0===t?void 0:t.donutHideValue]),u=(0,n.useCallback)((()=>{var e;const t=(0,Z().mg)(l);t.chartFormat||(t.chartFormat={donutHideValue:!1}),t.chartFormat.donutHideValue=!(null!==(e=l.chartFormat)&&void 0!==e&&e.donutHideValue),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{ee().zv({store:a.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:r,action:"charts_style_donut_value"})}),[l,a,o,r]);return(0,S.jsx)(qt().A,{...e.menuListItemProps,title:(0,S.jsx)(d().sA,{...m().Zr.chartShowDonutValue}),showChevron:!1,switcherProps:{on:c},icon:ae().i,onClick:u,disabled:s})}function lo(e){var t;const o=(0,i().v3)(),r=(0,d().tz)(),l=(0,p().ET)(),{collectionViewStore:s,chartConfig:c,disabled:u}=e,g=(0,n.useMemo)((()=>{var e;return null==c||null===(e=c.chartFormat)||void 0===e?void 0:e.valueLabel}),[null==c||null===(t=c.chartFormat)||void 0===t?void 0:t.valueLabel]),f=(0,n.useCallback)((e=>{const t=(0,Z().mg)(c);t.chartFormat||(t.chartFormat={valueLabel:void 0}),t.chartFormat.valueLabel=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{ee().zv({store:s.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:l,action:"charts_style_value_label"})}),[c,s,o,l]),y=(0,a().IS)((()=>({inputContainer:{padding:"4px 0",marginLeft:34,marginRight:4}})),[]);return(0,S.jsx)("div",{style:y.inputContainer,children:(0,S.jsx)(Gt().B,{initialValue:g||"",placeholder:r.formatMessage(m().Zr.chartValueLabelPlaceholder),onBlur:f,onChange:f,onSubmit:f,disabled:u})})}function so(e){const t=(0,i().v3)(),o=(0,p().ET)(),a=(0,r().K8)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.weightColorValue)??!1}),[e.chartConfig]),l=(0,n.useCallback)((()=>{var n;const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={weightColorValue:!1}),i.chartFormat.weightColorValue=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.weightColorValue),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_weight_color_value"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,S.jsx)(qt().A,{...e.menuListItemProps,title:(0,S.jsx)(d().sA,{...m().Zr.chartWeightColorValue}),showChevron:!1,switcherProps:{on:a},icon:Ht().E,onClick:l,disabled:e.disabled})}function co(e){const t=(0,i().v3)(),o=(0,p().ET)(),a=(0,ft().hu)(e.chartConfig),l=(0,r().K8)((()=>{var t;return!(null!==(t=e.chartConfig.chartFormat)&&void 0!==t&&t.hideLegend||a)}),[e.chartConfig,a]),s=(0,n.useCallback)((()=>{var n;const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLegend:!1}),i.chartFormat.hideLegend=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLegend),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_legend_toggle"})}),[t,e.chartConfig,e.collectionViewStore,o]);return a?null:(0,S.jsx)(qt().A,{...e.menuListItemProps,title:(0,S.jsx)(d().sA,{...m().Zr.chartLegend}),showChevron:!1,switcherProps:{on:l},icon:It().n,onClick:s,disabled:e.disabled})}function uo(e){let{collectionViewStore:t,chartConfig:o,disabled:l}=e;const s=(0,d().tz)(),c=(0,i().v3)(),u=(0,p().ET)(),{showCaption:g,caption:f}=(0,r().K8)((()=>{var e,t;return"placeholder"===o.type?{showCaption:!1,caption:""}:{showCaption:(null===(e=o.chartFormat)||void 0===e?void 0:e.showCaption)??!1,caption:(null===(t=o.chartFormat)||void 0===t?void 0:t.caption)??""}}),[o]),y=(0,n.useCallback)((()=>{const e=t.getChartFormatStore();e&&(te().createAndCommit({userAction:"chartSettings.setChartFormat.showCaption",environment:c,canUndo:!0,perform:t=>{ee().zv({store:e,data:{showCaption:!g},transaction:t})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_style_show_caption"}))}),[t,c,u,g]),h=(0,n.useCallback)((e=>{const o=t.getChartFormatStore();o&&(te().createAndCommit({userAction:"chartSettings.setChartFormat.updateCaption",environment:c,canUndo:!0,perform:t=>{ee().zv({store:o,data:{caption:e},transaction:t})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_style_update_caption"}))}),[u,t,c]),v=(0,a().IS)((()=>({captionInputContainer:{padding:"4px 0",marginLeft:34,marginRight:4}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Ce().A,{title:(0,S.jsx)(d().sA,{...m().Zr.chartCaption}),showChevron:!1,right:(0,S.jsx)(Wt().A,{on:g,onClick:y,disabled:l}),icon:zt().i,onClick:y,disabled:l}),(0,S.jsx)("div",{style:v.captionInputContainer,children:(0,S.jsx)(Gt().B,{initialValue:f,placeholder:s.formatMessage(m().Zr.chartCaptionPlaceholder),onBlur:h,onChange:h,onSubmit:h,disabled:l,textarea:!0,maxLength:Yt})})]})}function po(e){let{collectionViewStore:t,chartConfig:o,disabled:a}=e;const l=(0,i().v3)(),s=(0,p().ET)(),c=(0,r().K8)((()=>(0,N().q_)(o)),[o]),u=(0,n.useCallback)((()=>{const e=(0,Z().mg)(o);e.chartFormat||(e.chartFormat={axisShowDataLabels:!0}),e.chartFormat.axisShowDataLabels=!c,te().createAndCommit({userAction:"chartSettings.setChartFormat.dataLabels",environment:l,canUndo:!0,perform:o=>{ee().zv({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),(0,X().X)({environment:l,collectionContextStore:s,action:"charts_style_data_labels"})}),[o,t,l,c,s]);return(0,S.jsx)(Ce().A,{title:(0,S.jsx)(d().sA,{...m().Zr.chartDataLabels}),showChevron:!1,right:(0,S.jsx)(Wt().A,{on:c,onClick:u,disabled:a}),icon:ae().i,onClick:u,disabled:a})}function go(e){const t=(0,i().v3)(),o=(0,p().ET)(),a=(0,i().Y0)(),l=(0,m().k1)(),s=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.donutDataLabels;return o||N().D0.none}),[e.chartConfig]),c=(0,n.useCallback)((n=>{const i=(0,Z().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={donutDataLabels:N().D0.none}),i.chartFormat.donutDataLabels=n,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_donut_data_labels"})}),[e.chartConfig,t,e.collectionViewStore,o]),g=(0,n.useMemo)((()=>(0,V().WP)(m().zH).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,S.jsx)(se().A,{...e,title:(0,S.jsx)(d().sA,{...o}),right:n?(0,le().b)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[s,c]);return(0,S.jsx)(fe().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,S.jsx)(Ce().A,{...t,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().Zr.chartDataLabels}),right:s?(0,S.jsx)("div",{style:{...l.donutDataLabelsRightText,...J().RC},children:(0,S.jsx)(d().sA,{...m().zH[s]})}):null,icon:ae().i,disabled:e.disabled}),renderExtension:(t,o)=>{const n=no({title:(0,S.jsx)(d().sA,{...m().Zr.chartDataLabels}),device:a,onClickRight:o.close,popupEvents:t});return(0,S.jsx)(pe().A,{...n,children:(0,S.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"donutDataLabelsStyle",render:e=>(0,S.jsx)(u().A,{...e}),items:g}]})})}})}var mo=()=>o(457056),fo=()=>o(896628);function yo(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),f=(0,a().IS)((e=>({errorIcon:(0,m().FE)(e)})),[]),y=(0,m().k1)(),h=(0,r().K8)((()=>u.collectionViewStore()),[u]),v=(0,r().K8)((()=>u.normalizedSchemaStore.state),[u]),x=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),C=(0,r().K8)((()=>{if("groups_reducer"===(null==x?void 0:x.type)){const e="formula"===x.groupBy.type?x.groupBy.groupBy:x.groupBy;return(0,W().sj)(e)||(0,W().Ik)(e)?{type:"property_group",property:x.groupBy.property,groupByOption:e.groupBy}:{type:"property_group",property:x.groupBy.property}}if("results_reducer"===(null==x?void 0:x.type))return{type:"property_group",property:x.nameProperty}}),[x]),b=(0,r().K8)((()=>{const e={icon:mo().o};return o&&(0,l().lc)(o)?{icon:$().b,iconStyle:f.errorIcon}:e}),[o,f.errorIcon]),w=(0,r().K8)((()=>{const e=(0,V().WP)(v),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,W().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Re().eD[e]),sectionName:we})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Re().WK[e]),sectionName:we})))});else{if(!(0,W().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we})}})),t}),[v,g]),j=n.useCallback((e=>{var o,n;const{key:i}=e,{property:r,groupByOption:a}=i;if(!t||!h)return;const l=(0,G()._g)({schema:v,property:r}),s=(0,z().o_)({property:r,collectionSchema:v,hideEmptyGroups:Boolean(null===(o=t.chartFormat)||void 0===o?void 0:o.axisHideEmptyGroups)});if(!l||!s)return;const d=Object.keys(v),p="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:d.find((e=>{const t=v[e];return Boolean(t&&(0,z().Iw)(t))})),g={aggregator:"count"};let f=Z().mg(t);if((0,z().tH)(l)&&p)f=(0,N().CN)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"results_reducer",valueProperty:p,groupBy:s});else if(a){var y;const e=(0,N().xS)({property:r,propertySchema:l,groupByOption:a,hideEmptyGroups:Boolean(null===(y=f.chartFormat)||void 0===y?void 0:y.axisHideEmptyGroups)});e&&(f=(0,N().CN)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:e,aggregation:g}))}else if(s){const e={aggregator:"count"};f=(0,N().CN)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:s,aggregation:e})}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:f,sort:null===(n=f.chartFormat)||void 0===n?void 0:n.mainSort}),te().createAndCommit({userAction:"chartSettings.setXAxis",environment:c,canUndo:!0,perform:t=>{ee().zv({store:h.getFormatStore().getKeyStore("chart_config"),data:f,transaction:t}),"week"===e.key.groupByOption&&fo().Jo(h,t)}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_x_axis_what_to_show",charts_analytics_context:(0,oe().nL)(u)})}),[t,h,v,c,u]);return(0,S.jsx)(K().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,l().lc)(o),renderTooltip:e=>o?(0,S.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,S.jsx)(Te,{...e,collectionContextStore:u,selectedProperty:C,properties:w,handlePropertySelect:j,originProps:{title:(0,S.jsx)("span",{children:(0,S.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:b.icon},callsite:"main_property",disabled:s,rightStyle:y.whatToShowRightText})})}function So(e){let{collectionViewStore:t,chartConfig:o,disabled:a}=e;const l=(0,i().v3)(),s=(0,p().ET)(),u=(0,r().K8)((()=>{var e;return Boolean(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups)}),[o]),g=n.useCallback((()=>{if(!o)return;const e=Z().mg(o);e.chartFormat={...e.chartFormat,axisHideEmptyGroups:!u},"groups_reducer"===e.dataConfig.type&&(e.dataConfig.groupBy.hideEmptyGroups=!u),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:l,canUndo:!0,perform:o=>{ee().zv({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),(0,X().X)({environment:l,collectionContextStore:s,action:"charts_x_axis_hide_empty_groups",charts_analytics_context:(0,oe().nL)(s)})}),[o,t,l,u,s]);return(0,S.jsx)(qt().A,{title:(0,S.jsx)(d().sA,{...m().Zr.chartHideEmptyGroups}),switcherProps:{on:u},onClick:g,icon:c().e,disabled:a})}const ho={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M15.25 15.625a.625.625 0 1 1 0 1.25h-5a2.125 2.125 0 0 1-2.125-2.125V4.259L4.792 7.592a.625.625 0 1 1-.884-.884l4.4-4.4a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 1 1-.884.884L9.375 4.259V14.75c0 .483.392.875.875.875z"})},vo=(0,y().wt)("arrowTurnLeftUp",ho),xo=(0,y().wt)("collectionChartCumulative",{viewBox:"0 0 16 16",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.25 8C1.25 7.44772 1.69772 7 2.25 7H3.75C4.30228 7 4.75 7.44772 4.75 8V12C4.75 12.5523 4.30228 13 3.75 13H2.25C1.69772 13 1.25 12.5523 1.25 12V8ZM3.75 8L2.25 8V12H3.75V8Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 6C6.25 5.44772 6.69772 5 7.25 5H8.75C9.30228 5 9.75 5.44772 9.75 6V12C9.75 12.5523 9.30228 13 8.75 13H7.25C6.69772 13 6.25 12.5523 6.25 12V6ZM8.75 6L7.25 6V12H8.75V6Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 4C11.25 3.44772 11.6977 3 12.25 3H13.75C14.3023 3 14.75 3.44772 14.75 4V12C14.75 12.5523 14.3023 13 13.75 13H12.25C11.6977 13 11.25 12.5523 11.25 12V4ZM13.75 4L12.25 4V12H13.75V4Z"})]})}),Co=(0,y().wt)("decimals",{viewBox:"0 0 20 20",svg:(0,S.jsx)("g",{children:(0,S.jsx)("path",{d:"M15.124 14.287c-2.033 0-3.244-1.65-3.244-4.296 0-2.633 1.222-4.278 3.244-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.205 4.301-3.234 4.301m0-1.205c1.114 0 1.749-1.137 1.749-3.09 0-1.931-.646-3.074-1.749-3.074-1.108 0-1.759 1.148-1.759 3.068 0 1.954.64 3.096 1.76 3.096Zm-7.461 1.205c-2.033 0-3.245-1.65-3.245-4.296 0-2.633 1.223-4.278 3.245-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.206 4.301-3.234 4.301m0-1.205c1.114 0 1.748-1.137 1.748-3.09 0-1.931-.645-3.074-1.748-3.074-1.108 0-1.76 1.148-1.76 3.068 0 1.954.64 3.096 1.76 3.096m-5.198 1.103a.81.81 0 0 1-.823-.823c0-.457.36-.823.823-.823.457 0 .817.366.817.823a.81.81 0 0 1-.817.823"})})}),bo={viewBox:"0 0 20 20",svg:(0,S.jsx)("path",{d:"M9.5 9.375a.625.625 0 1 0 0 1.25h7.6a.625.625 0 1 0 0-1.25zm-2-5a.625.625 0 1 0 0 1.25H17a.625.625 0 0 0 0-1.25zM10.875 15c0-.345.28-.625.625-.625h5.6a.625.625 0 0 1 0 1.25h-5.6a.625.625 0 0 1-.625-.625M2.215 4.263c-.149-.237.035-.534.328-.534h2.289c.293 0 .477.297.329.534L4.016 6.095a.395.395 0 0 1-.657 0zm2.328 4.466c-.293 0-.477.297-.328.534l1.144 1.832c.147.235.51.235.657 0l1.145-1.832c.148-.237-.035-.534-.33-.534zm1.672 5.534c-.149-.237.035-.534.328-.534h2.289c.293 0 .477.297.329.534l-1.145 1.832a.395.395 0 0 1-.657 0z"})},wo=(0,y().wt)("listToggleIndent",bo);var jo=()=>o(72135),Ao=()=>o(673900),_o=()=>o(374136),Mo=()=>o(795656);function ko(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),f=(0,a().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:18,height:18,marginLeft:4}})),[]),y=(0,m().k1)(),h=(0,r().K8)((()=>g.collectionViewStore()),[g]),v=(0,r().K8)((()=>g.databaseType),[g]),x=(0,r().K8)((()=>g.normalizedSchemaStore.state),[g]),C=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().K8)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),w=(0,r().K8)((()=>b?(0,G()._g)({schema:x,property:b}):void 0),[b,x]),j=(0,r().K8)((()=>{if(C)if("groups_reducer"===C.type){const e=C.aggregationConfig.aggregation;if((0,H().Iq)(e))return{type:"record_count"};if(ke(e.aggregator)){const t=(0,G()._g)({schema:x,property:e.property});if(!t)return;return(0,N().JW)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"aggregation",property:C.valueProperty,aggregation:"value"}}),[x,C]),A=(0,r().K8)((()=>{if(!C||!w)return[];const e=[];(0,V().WP)(x).forEach((t=>{let[o,n]=t;if(!n||o===b||!(0,W().Eg)(n))return;const i=[];(0,z().Iw)(n)&&(0,z().tH)(w)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().bg.chartAggregateByValues),sectionName:je});const r=(0,N().JW)(n);if(r){Me.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().TQ)({aggregation:t,databaseType:v,intl:c})||"",sectionName:je};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().TQ)({aggregation:{aggregator:"unique",property:o},databaseType:v,intl:c})||"",sectionName:je};i.push(e)}const a={key:{type:"property_group",property:o},name:n.name,sectionName:r?je:Ae,subMenuItems:i};e.push(a)}));return[{key:{type:"record_count"},name:(0,m().TQ)({aggregation:{aggregator:"count"},databaseType:v,intl:c})||"",sectionName:we},...e]}),[C,w,x,v,c,b]),_=(0,r().K8)((()=>o&&(0,l().dG)(o)?()=>(0,$().b)(f.errorIcon):vo),[o,f.errorIcon]),M=n.useCallback((e=>{h&&t&&b&&Be({environment:u,menuItem:e,chartConfig:t,collectionSchema:x,collectionViewStore:h,collectionContextStore:g,mainPropertyId:b})}),[t,g,x,h,u,b]);return(0,S.jsx)(K().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,l().dG)(o),renderTooltip:e=>o?(0,S.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,S.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:o&&!(0,l().xG)(o)?void 0:j,properties:A,handlePropertySelect:M,originProps:{title:(0,S.jsx)("span",{children:(0,S.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:_},callsite:"aggregation_property",disabled:s,rightStyle:y.whatToShowRightText})})}function Io(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),f=(0,a().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:18,height:18,marginLeft:4}})),[]),y=(0,m().k1)(),h=(0,r().O$)(g.normalizedSchemaStore),v=(0,r().K8)((()=>g.collectionViewStore()),[g]),x=(0,r().K8)((()=>{var e,o,n,i,r;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const a=t.dataConfig.aggregationConfig,l="formula"===(null===(o=a.stackOptions)||void 0===o?void 0:o.groupBy.type)?null===(n=a.stackOptions)||void 0===n?void 0:n.groupBy.groupBy:null===(i=a.stackOptions)||void 0===i?void 0:i.groupBy,s=null===(r=a.stackOptions)||void 0===r?void 0:r.groupBy.property;return l&&s?(0,W().sj)(l)||(0,W().Ik)(l)?{type:"property_group",property:s,groupByOption:l.groupBy}:{type:"property_group",property:s}:{type:"none"}}),[t]),C=(0,r().K8)((()=>{const e=(0,V().WP)(h),t=[],o={key:{type:"none"},name:Ee().A.formatMessage(m().bg.noneMenuItem),sectionName:we};return t.push(o),e.forEach((e=>{let[o,n]=e;if(n)if((0,W().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Re().eD[e]),sectionName:we})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we,subMenuItems:W().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Re().WK[e]),sectionName:we})))});else{if(!(0,W().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:we})}})),t}),[h,c]),b=(0,r().K8)((()=>o&&(0,l().ic)(o)?()=>(0,$().b)(f.errorIcon):Et),[o,f.errorIcon]),w=n.useCallback(((e,o)=>{var n,i;const r=(0,G()._g)({schema:h,property:e});if(!v||!r||!t||"groups_reducer"!==(null===(n=t.dataConfig)||void 0===n?void 0:n.type))return;const a=(0,N().xS)({property:e,propertySchema:r,groupByOption:o,hideEmptyGroups:!0});if(!a||!(0,W().rj)(a.type))return;const l=Z().mg(t);if("groups_reducer"!==l.dataConfig.type)return;const s=t.dataConfig.aggregationConfig;let c;if(l.dataConfig.aggregationConfig={...s,stackOptions:{groupBy:a}},"bar"===t.type||"column"===t.type)c=N().PC.normal;else if("line"===t.type){var d;c=null!==(d=t.chartFormat)&&void 0!==d&&d.axisCumulative?N().PC.normal:N().PC.side_by_side}const p=null===(i=t.chartFormat)||void 0===i?void 0:i.axisGroupStyle;l.chartFormat={...l.chartFormat,axisGroupStyle:p||c},te().createAndCommit({userAction:"chartSettings.setYAxisStackBy",environment:u,canUndo:!0,perform:e=>{ee().zv({store:v.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e}),"week"===o&&fo().Jo(v,e)}}),(0,X().X)({environment:u,collectionContextStore:g,action:"charts_y_axis_group_by",charts_analytics_context:(0,oe().nL)(g)})}),[h,t,v,u,g]),j=n.useCallback((()=>{var e;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const o=t.dataConfig.aggregationConfig;v&&te().createAndCommit({userAction:"chartSettings.clearYAxisStackBy",environment:u,canUndo:!0,perform:e=>{if(o){const n=Z().mg(t);if("groups_reducer"!==n.dataConfig.type)return;n.dataConfig.aggregationConfig={...o,stackOptions:void 0},ee().zv({store:v.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}})}),[v,t,u]),A=n.useCallback((e=>{const{key:t}=e;if("none"===t.type)j();else{const{property:e,groupByOption:o}=t;w(e,o)}}),[j,w]);return(0,S.jsx)(K().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,l().ic)(o),renderTooltip:e=>o?(0,S.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,S.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:x,properties:C,handlePropertySelect:A,originProps:{title:(0,S.jsx)("span",{style:J().RC,children:(0,S.jsx)(d().sA,{...m().bg.chartGroupBy})}),icon:b},callsite:"y_axis_stacked_groups",disabled:s,rightStyle:y.groupByRightText})})}function To(e){let{chartConfig:t,disabled:o}=e;const a=(0,i().v3)(),l=(0,p().ET)(),s=(0,r().K8)((()=>l.collectionViewStore()),[l]),c=(0,r().K8)((()=>{var e;return Boolean(null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisCumulative)}),[t]),u=(0,n.useCallback)((()=>{var e,o;if(!s||!t)return;const n=Z().mg(t),i=!(null!==(e=n.chartFormat)&&void 0!==e&&e.axisCumulative);n.chartFormat={...n.chartFormat,axisCumulative:i};const r=Boolean("groups_reducer"===n.dataConfig.type&&(null===(o=n.dataConfig)||void 0===o||null===(o=o.aggregationConfig)||void 0===o||null===(o=o.stackOptions)||void 0===o?void 0:o.groupBy));"line"===t.type&&r&&i&&(n.chartFormat={...n.chartFormat,axisGroupStyle:N().PC.normal}),te().createAndCommit({userAction:"chartSettings.setCumulative",environment:a,canUndo:!0,perform:e=>{ee().zv({store:s.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),(0,X().X)({environment:a,collectionContextStore:l,action:"charts_y_axis_cumulative",charts_analytics_context:(0,oe().nL)(l)})}),[t,s,a,l]);return t&&!(0,ft().CS)(t)?null:(0,S.jsx)(qt().A,{title:(0,S.jsx)(d().sA,{...m().bg.chartCumulative}),switcherProps:{on:c},onClick:u,icon:xo,iconStyle:{height:18},disabled:o})}function Po(e){const{chartConfig:t,disabled:o}=e,l=null==t?void 0:t.chartFormat,s=(0,i().v3)(),c=(0,i().Y0)(),g=(0,d().tz)(),f=(0,r().uB)(void 0,xe().A),y=(0,p().ET)(),h=(0,r().K8)((()=>y.collectionViewStore()),[y]),v=void 0!==(null==l?void 0:l.yAxisMin)||void 0!==(null==l?void 0:l.yAxisMax),[x,C]=(0,n.useState)(void 0!==(null==l?void 0:l.yAxisMin)&&void 0!==(null==l?void 0:l.yAxisMax)&&l.yAxisMin>l.yAxisMax),[b,w]=(0,n.useState)(void 0!==(null==l?void 0:l.yAxisMin)&&void 0!==(null==l?void 0:l.yAxisMax)&&l.yAxisMin>l.yAxisMax),j=(0,n.useCallback)((e=>{if(!h||!t)return;var o,n;if("yAxisMin"in e&&"yAxisMax"in e){if(e.yAxisMin===(null===(o=t.chartFormat)||void 0===o?void 0:o.yAxisMin)&&e.yAxisMax===(null===(n=t.chartFormat)||void 0===n?void 0:n.yAxisMax))return}else if("yAxisMin"in e){var i;if(e.yAxisMin===(null===(i=t.chartFormat)||void 0===i?void 0:i.yAxisMin))return}else if("yAxisMax"in e){var r;if(e.yAxisMax===(null===(r=t.chartFormat)||void 0===r?void 0:r.yAxisMax))return}if("yAxisMin"in e){const t=void 0!==e.yAxisMin&&void 0!==(null==l?void 0:l.yAxisMax)&&e.yAxisMin>l.yAxisMax;if(C(t),t)return;void 0===e.yAxisMin&&C(!1)}if("yAxisMax"in e){const t=void 0!==e.yAxisMax&&void 0!==(null==l?void 0:l.yAxisMin)&&e.yAxisMax<l.yAxisMin;if(w(t),t)return;void 0===e.yAxisMax&&w(!1)}const a=h.getAxisChartFormatStore();a&&(te().createAndCommit({userAction:"chartSettings.setYAxisRange",environment:s,canUndo:!0,perform:t=>{ee().zv({store:a,data:Z().LG(e,(e=>void 0===e?null:e)),transaction:t})}}),(0,X().X)({environment:s,collectionContextStore:y,action:"charts_y_axis_range",charts_analytics_context:(0,oe().nL)(y)}))}),[t,null==l?void 0:l.yAxisMax,null==l?void 0:l.yAxisMin,y,h,s]),A=(0,n.useCallback)((e=>j({yAxisMin:e})),[j]),_=(0,n.useCallback)((e=>j({yAxisMax:e})),[j]),M=(0,n.useCallback)((()=>j({yAxisMin:void 0,yAxisMax:void 0})),[j]),k=(0,a().IS)((e=>({container:{paddingBottom:16},icon:{transform:"bar"===(null==t?void 0:t.type)?"rotate(90deg)":void 0},errorIcon:{...(0,m().FE)(e),width:18,height:18,marginLeft:4},title:{display:"flex",justifyContent:"space-between",width:"100%"},resetButton:{float:"right",color:e.blueColor,cursor:"pointer"},inputContainer:{display:"flex",paddingLeft:14,paddingRight:14},separator:{color:e.mediumTextColor,margin:"0 8px"}})),[null==t?void 0:t.type]);return(0,S.jsx)(de().A,{focused:!1,popupType:c.isMobile?ce().z7.SlideUp:ce().z7.Popup,alignmentToOrigin:ce().yP.End,placementToOrigin:ce().sx.Bottom,buttonPopupStore:f,renderOrigin:e=>(0,S.jsx)(Ce().A,{...e,showChevron:!0,title:(0,S.jsx)(d().sA,{...m().bg.chartYAxisRange}),rotateChevron:f.state.open,icon:kt().t,iconStyle:k.icon,disabled:o,right:(0,S.jsx)(d().sA,{...v?m().bg.chartYAxisRangeCustom:m().bg.chartYAxisRangeAuto})}),render:()=>(0,S.jsx)(u().A,{topBorder:!1,disableMobileBorders:!0,title:(0,S.jsx)("div",{style:k.title,children:(0,S.jsx)(d().sA,{...m().bg.chartYAxisRangeMenu})}),right:v?(0,S.jsx)(F().A,{style:k.resetButton,onClick:M,children:(0,S.jsx)(d().sA,{...m().bg.chartYAxisRangeReset})}):void 0,style:k.container,children:(0,S.jsxs)("div",{style:k.inputContainer,children:[(0,S.jsx)(Ao().v,{value:null==l?void 0:l.yAxisMin,onBlur:A,onKeyDown:A,inputProps:{placeholder:g.formatMessage(m().bg.chartYAxisRangeMinPlaceholder),errorOutline:x}}),(0,S.jsx)("span",{style:k.separator,children:"-"}),(0,S.jsx)(Ao().v,{value:null==l?void 0:l.yAxisMax,onBlur:_,onKeyDown:_,inputProps:{placeholder:g.formatMessage(m().bg.chartYAxisRangeMaxPlaceholder),errorOutline:b}})]})})})}function Bo(e){const{chartConfig:t,disabled:o}=e,l=null==t?void 0:t.chartFormat,s=(0,i().v3)(),c=(0,d().tz)(),u=(0,p().ET)(),g=(0,r().K8)((()=>u.collectionViewStore()),[u]),m=(0,r().K8)((()=>u.normalizedSchemaStore.state),[u]),f=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),y=(0,r().K8)((()=>{if(f&&"results_reducer"===f.type)return f.valueProperty}),[f]),h=(0,r().K8)((()=>{if(y)return(0,G()._g)({schema:m,property:y})}),[y,m]),v=(0,r().K8)((()=>h?(0,_o().i5)(h):void 0),[h]),x=(0,n.useMemo)((()=>{const e=jo().iv.map((e=>({key:e,type:"button",title:(0,Mo().D)(c,e)})));return v&&"precision_uncapped"!==v?[...e,{key:"precision_from_number_property",type:"button",title:c.formatMessage({id:"collection.chartYAxisSettings.fromNumberProperty",defaultMessage:"Use property value ({value})"},{value:jo().Qq[v]})}]:e}),[c,v]),C=(0,n.useCallback)((e=>{if(!g||!t)return;const o=g.getAxisChartFormatStore();o&&(te().createAndCommit({userAction:"chartSettings.setYAxisPrecision",environment:s,canUndo:!0,perform:t=>{ee().zv({store:o,data:{numberPrecisionOverride:e},transaction:t})}}),(0,X().X)({environment:s,collectionContextStore:u,action:"charts_y_axis_precision",charts_analytics_context:(0,oe().nL)(u)}))}),[t,u,g,s]),b=(0,a().IS)((()=>({icon:{height:18}})),[]);return(0,S.jsx)(K().A,{placement:D().W.Right,textWrap:!0,renderTooltip:()=>(0,S.jsx)(d().sA,{defaultMessage:"Rounding defaults to 2 decimal places. Use this setting to override.",id:"database.chartSettings.numberOptions.numberPrecision.tooltip"}),render:e=>(0,S.jsx)(jt().A,{...e,icon:Co,iconStyle:b.icon,title:(0,S.jsx)(d().sA,{defaultMessage:"Decimal places",id:"database.chartSettings.numberOptions.numberPrecision"}),selectedKey:(null==l?void 0:l.numberPrecisionOverride)??jo().pS,options:x,onChange:C,disabled:o})})}function Ro(e){let{disabled:t}=e;const o=(0,i().v3)(),a=(0,p().ET)(),l=(0,r().K8)((()=>a.collectionStore()),[a]),s=(0,r().K8)((()=>{var e;return Boolean(null==l||null===(e=l.getFormat())||void 0===e?void 0:e.subitem_property)}),[l]),c=(0,r().K8)((()=>a.collectionViewStore()),[a]),u=(0,r().K8)((()=>null==c?void 0:c.getFormat()),[c]),g=(0,r().K8)((()=>"flattened"===(null==u?void 0:u.subitem_display_mode)),[u]),f=(0,n.useCallback)((()=>{const e=null==c?void 0:c.getFormatStore();if(!e)return;const t="flattened"===(null==u?void 0:u.subitem_display_mode)?void 0:"flattened";te().createAndCommit({userAction:"chartSettings.setCountSubitems",environment:o,canUndo:!0,perform:o=>{ee().KY({store:e.getKeyStore("subitem_display_mode"),transaction:o,value:t})}}),(0,X().X)({environment:o,collectionContextStore:a,action:"charts_set_subitems",charts_analytics_context:(0,oe().nL)(a)})}),[c,o,a,u]);return s?(0,S.jsx)(qt().A,{title:(0,S.jsx)(d().sA,{...m().bg.chartIncludeSubitems}),switcherProps:{on:g},onClick:f,icon:wo,iconStyle:{height:18},disabled:t}):null}var Vo=()=>o(34423);function Fo(e){let{collectionContextStore:t,collectionSettingsStore:n}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o(448701).A,{collectionContextStore:t}),(0,S.jsx)(o(614525).A,{collectionContextStore:t}),(0,S.jsx)(o(340643).A,{collectionContextStore:t,collectionSettingsStore:n}),(0,S.jsx)(o(364871).A,{collectionContextStore:t,collectionSettingsStore:n})]})}const Ko=n.memo((function(e){let{collectionSettingsStore:t}=e;const n=(0,i().v3)(),a=(0,d().tz)(),f=(0,p().ET)(),y=(0,r().K8)((()=>f.normalizedSchemaStore.state),[f.normalizedSchemaStore]),h=(0,r().K8)((()=>f.collectionViewStore()),[f]),v=(0,r().K8)((()=>f.normalizedFormatStore.state.chart_config),[f.normalizedFormatStore]),{canViewChart:x}=(0,o(714185).f)({collectionContextStore:f}),C=!x,b=(0,r().K8)((()=>{const e=(0,l().ye)({chartConfig:v,collectionSchema:y});if(void 0!==e)return e;return h?f.chartErrorStore.getState().get(h.id):void 0}),[v,f.chartErrorStore,y,h]),w=(0,r().K8)((()=>f.isInHomeWidgetStore.state),[f]),j=(0,r().K8)((()=>{var e;const t=null===(e=f.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,o(186445).sj)(t)}),[f]),A=(0,r().K8)((()=>j?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[j]),_=!(0,r().K8)((()=>f.permissionScopesStore.state),[f.permissionScopesStore]).canConfigureBlock||C,M=No(_);return h&&y&&v&&"placeholder"!==v.type?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u().A,{children:(0,S.jsx)(o(56516).Ct,{collectionContextStore:f,collectionSettingsStore:t})}),(0,S.jsx)(u().A,{topBorder:!0,title:a.formatMessage(m().bg.chartType),mobileStyle:{boxShadow:"none"},desktopTitleStyle:M.disabled,mobileTitleStyle:M.disabled,children:(0,S.jsx)(O,{chartConfig:v,disabled:_})}),"donut"===v.type?(0,S.jsx)(Lo,{chartConfig:v,chartError:b,disabled:_}):null,(0,s().m)(v)?"bar"===v.type?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Eo,{chartConfig:v,chartError:b,disabled:_,useXAxisLabel:!0}),(0,S.jsx)(Oo,{collectionViewStore:h,chartConfig:v,chartError:b,disabled:_,useYAxisLabel:!0})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Oo,{collectionViewStore:h,chartConfig:v,chartError:b,disabled:_}),(0,S.jsx)(Eo,{chartConfig:v,chartError:b,disabled:_})]}):null,(0,S.jsx)(zo,{collectionContextStore:f,chartConfig:v,paywallDisabled:Boolean(C)}),(0,S.jsx)(Do,{collectionContextStore:f,collectionSettingsStore:t,paywallDisabled:Boolean(C)}),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(u().A,{topBorder:!0,children:[(0,S.jsx)(it,{chartConfig:v,disabled:_}),(0,S.jsx)(Fo,{collectionContextStore:f,collectionSettingsStore:t}),w&&(0,S.jsx)(Ce().A,{icon:c().e,title:a.formatMessage(o(885749).uF.hide),showChevron:!1,onClick:()=>{g().default.state.currentSpaceViewStore&&o(980151).WO({environment:n,currentSpaceViewStore:g().default.state.currentSpaceViewStore,...A})}})]}),(0,S.jsx)(u().A,{topBorder:!0,children:(0,S.jsx)(o(95441).A,{href:(0,o(836251).xS)("guides.charts"),title:(0,S.jsx)(d().sA,{...m().bg.chartHelp}),analyticsFrom:"view_settings_charts_help"})})]})]}):null}));function Do(e){const{collectionContextStore:t,collectionSettingsStore:n,paywallDisabled:i}=e;return(0,S.jsxs)(u().A,{topBorder:!0,shouldShowBottomDivider:!0,style:{marginTop:8,marginBottom:8,paddingBottom:0},children:[(0,S.jsx)(o(230751).A,{collectionContextStore:t,collectionSettingsStore:n,disabled:i}),(0,S.jsx)(o(704640).A,{collectionContextStore:t,collectionSettingsStore:n,disabled:i})]})}function Lo(e){const t=No(e.disabled);return(0,S.jsxs)(u().A,{title:(0,S.jsx)(d().sA,{...m().bg.chartData}),desktopTitleStyle:t.disabled,mobileTitleStyle:t.disabled,children:[(0,S.jsx)(Ve,{...e}),(0,S.jsx)(Fe,{...e}),(0,S.jsx)(At,{...e,sortType:"main"}),(0,S.jsx)(Ro,{disabled:e.disabled})]})}function Oo(e){const{collectionViewStore:t,useYAxisLabel:o,...n}=e,i=No(e.disabled),a=(0,r().K8)((()=>{if("groups_reducer"===e.chartConfig.dataConfig.type)return e.chartConfig.dataConfig.groupBy}),[e.chartConfig.dataConfig]);return(0,S.jsxs)(u().A,{title:o?(0,S.jsx)(d().sA,{...m().bg.chartYAxis}):(0,S.jsx)(d().sA,{...m().bg.chartXAxis}),desktopTitleStyle:i.disabled,mobileTitleStyle:i.disabled,children:[(0,S.jsx)(yo,{...n}),a?(0,S.jsx)(Vo().T,{groupBy:a}):null,(0,S.jsx)(At,{...n,sortType:"main"}),(0,S.jsx)(So,{...e})]})}function Eo(e){var t,o;const{useXAxisLabel:n,disabled:i}=e,a=No(i),l=(0,r().K8)((()=>{var t;if("results_reducer"===e.chartConfig.dataConfig.type)return;return null===(t=e.chartConfig.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy}),[e.chartConfig.dataConfig]),s=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig;return"results_reducer"===(null==o?void 0:o.type)||"groups_reducer"===(null==o?void 0:o.type)&&("max"===o.aggregationConfig.aggregation.aggregator||"min"===o.aggregationConfig.aggregation.aggregator||"median"===o.aggregationConfig.aggregation.aggregator||"average"===o.aggregationConfig.aggregation.aggregator||"sum"===o.aggregationConfig.aggregation.aggregator)}),[null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig]);return(0,S.jsxs)(u().A,{title:n?(0,S.jsx)(d().sA,{...m().bg.chartXAxis}):(0,S.jsx)(d().sA,{...m().bg.chartYAxis}),desktopTitleStyle:a.disabled,mobileTitleStyle:a.disabled,children:[(0,S.jsx)(ko,{...e}),s&&(0,S.jsx)(Bo,{...e}),"groups_reducer"!==(null===(o=e.chartConfig)||void 0===o||null===(o=o.dataConfig)||void 0===o?void 0:o.type)?null:(0,S.jsx)(Io,{...e}),l?(0,S.jsx)(Vo().T,{groupBy:l}):null,l?(0,S.jsx)(At,{...e,sortType:"stacked"}):null,(0,S.jsx)(To,{...e}),(0,S.jsx)(Po,{...e}),(0,S.jsx)(Ro,{disabled:e.disabled})]})}function zo(e){let{collectionContextStore:t,chartConfig:o,paywallDisabled:n}=e;const i=(0,r().K8)((()=>t.collectionViewStore()),[t]),a=(0,r().K8)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),l=(0,r().K8)((()=>!o||!a.canConfigureBlock||n),[o,a.canConfigureBlock,n]),s=No(l);return i&&o&&"placeholder"!==o.type?(0,S.jsxs)(u().A,{title:(0,S.jsx)(d().sA,{...m().bg.chartStyle}),desktopTitleStyle:s.disabled,mobileTitleStyle:s.disabled,children:[(0,S.jsx)($t,{collectionViewStore:i,chartConfig:o,disabled:l}),(0,S.jsx)(Qt,{collectionViewStore:i,chartConfig:o,disabled:l})]}):null}function No(e){return(0,a().IS)((()=>({disabled:{opacity:e?.4:void 0}})),[e])}},340643:(e,t,o)=>{"use strict";o.d(t,{A:()=>s});o(296540);var n=()=>o(56366),i=()=>o(959013),r=()=>o(436696),a=()=>o(686526),l=o(474848);const s=function(e){let{collectionContextStore:t,collectionSettingsStore:s}=e;const c=(0,o(484714).v3)(),d=(0,i().tz)(),u=(0,n().O$)(t.permissionScopesStore),p=(0,n().K8)((()=>!u.canConfigureBlock||"collectionTypedView"===t.contextType),[t,u]),{viewName:g,viewType:m}=(0,n().K8)((()=>{var e,o;return{viewName:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getName(),viewType:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getType()}}),[t]);if(p||!m)return null;let f=(0,l.jsx)(i().sA,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"});return"chart"===m?f=(0,l.jsx)(i().sA,{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.duplicateButton.title.chart"}):g&&(f=(0,l.jsx)(i().sA,{defaultMessage:"Duplicate {viewName}",id:"database.viewSettings.mainTab.duplicateButton.title.viewName",values:{viewName:g}})),(0,l.jsx)(o(497222).A,{icon:o(764781).V,title:f,onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();i&&(a().vr({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:n,from:"view_settings_duplicate"}),(0,r().X)({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(c,t,s,d)})}},346705:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});class n extends(()=>o(757695))().default{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const i=new n},364387:function(e){(function(){var t,o,n;n=[],t={},e.exports=o=function(e,o,i){var r,a,l,s,c,d,u,p;if(null==i&&(i=!0),"string"==typeof o){if(2!==o.length)throw{name:"ArgumentException",message:"The format for string options is '<thousands><decimal>' (exactly two characters)"};p=o[0],r=o[1]}else if(Array.isArray(o)){if(2!==o.length)throw{name:"ArgumentException",message:"The format for array options is ['<thousands>','[<decimal>'] (exactly two elements)"};p=o[0],r=o[1]}else p=(null!=o?o.thousands:void 0)||(null!=o?o.group:void 0)||t.thousands,r=(null!=o?o.decimal:void 0)||t.decimal;return null==(c=n[d=""+p+r+i])&&(l=i?3:1,c=n[d]=new RegExp("^\\s*([+-]?(?:(?:\\d{1,3}(?:\\"+p+"\\d{"+l+",3})+)|\\d*))(?:\\"+r+"(\\d*))?\\s*$")),null==(u=e.match(c))||3!==u.length?NaN:(s=u[1].replace(new RegExp("\\"+p,"g"),""),a=u[2],parseFloat(s+"."+a))},e.exports.setOptions=function(e){var o,n;for(o in e)n=e[o],t[o]=n},e.exports.factoryReset=function(){t={thousands:",",decimal:"."}},e.exports.withOptions=function(e,t){return null==t&&(t=!0),function(n){return o(n,e,t)}},e.exports.factoryReset()}).call(this)},364871:(e,t,o)=>{"use strict";o.d(t,{A:()=>s});o(296540);var n=()=>o(56366),i=()=>o(959013),r=()=>o(436696),a=()=>o(686526),l=o(474848);const s=function(e){let{collectionContextStore:t,collectionSettingsStore:s}=e;const c=(0,o(484714).v3)(),{collectionViewBlockStore:d,permissionScopes:u,viewType:p,viewName:g}=(0,n().K8)((()=>{var e,o;return{collectionViewBlockStore:t.collectionViewBlockStore(),permissionScopes:t.permissionScopesStore.state,viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName()}}),[t]),m=(0,n().K8)((()=>{const e=1===(null==d?void 0:d.getCollectionViewIds().length),o=t.isEditableHomeCollectionStore.state;return!u.canConfigureBlock||"collectionTypedView"===t.contextType||e&&!o}),[t,d,u.canConfigureBlock]);if(!d||m||!p)return null;let f=(0,l.jsx)(i().sA,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteTheOnlyViewButton.title"});return"chart"===p?f=(0,l.jsx)(i().sA,{defaultMessage:"Delete chart",id:"database.viewSettings.mainTab.deleteButton.title.chart"}):g&&(f=(0,l.jsx)(i().sA,{defaultMessage:"Delete {viewName}",id:"database.viewSettings.mainTab.deleteButton.title.viewName",values:{viewName:g}})),(0,l.jsx)(o(497222).A,{icon:o(236262).I,title:f,isRed:!0,onClick:()=>function(e,t,o){const n=t.collectionViewStore();n&&(a().nl({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,from:"view_settings"}),(0,r().X)({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:n.getType()}))}(c,t,s)})}},368472:(e,t,o)=>{"use strict";o.d(t,{IB:()=>S,lP:()=>v});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(173614),s=()=>o(167170),c=()=>o(959013),d=()=>o(686526),u=()=>o(497222),p=()=>o(56516),g=()=>o(89924),m=()=>o(447934),f=()=>o(400851),y=o(474848);function S(e){const{collectionContextStore:t,collectionSettingsStore:o,showTopBorder:n,children:r}=e,l=(0,i().Y0)(),s=(0,a().IS)((()=>({header:{fontSize:l.isMobile?14:12},section:{marginBottom:6}})),[l]);return(0,y.jsxs)(g().A,{topBorder:n,title:(0,y.jsx)("div",{style:s.header,children:(0,y.jsx)(c().sA,{id:"database.viewSettings.customizeMenu.advanced.title",defaultMessage:"Advanced"})}),style:s.section,children:[(0,y.jsx)(p().GS,{collectionContextStore:t,collectionSettingsStore:o}),(0,y.jsx)(v,{collectionContextStore:t,collectionSettingsStore:o}),(0,y.jsx)(h,{collectionContextStore:t}),!1,r]})}function h(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),a=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),l=(0,n.useCallback)((()=>{const e=t.collectionStore();a&&e&&(0,m().nh)({environment:o,blockStore:a,collectionStore:e,collectionViewStore:t.collectionViewStore(),from:"customize_database_button_in_customize_menu"})}),[t,a,o]),d=(0,f().X)({environment:o,blockStore:a});return a&&d?(0,y.jsx)(u().A,{icon:s()._,onClick:l,title:(0,y.jsx)(c().sA,{defaultMessage:"Customize page layout",id:"database.viewSettings.customizeMenu.customizeLayout"})}):null}function v(e){const{collectionSettingsStore:t}=e;return(0,y.jsx)(u().A,{icon:l().c,onClick:()=>d().a2({collectionSettingsStore:t,item:{type:"connectionFeatures"}}),showChevron:!0,title:(0,y.jsx)(c().sA,{defaultMessage:"Connections",id:"database.viewSettings.customizeMenu.connections.title"})})}},384130:(e,t,o)=>{"use strict";o.d(t,{J:()=>p,v:()=>u});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(317909),l=()=>o(755199),s=()=>o(186445),c=()=>o(351360);function d(e){let{userSettingsDismissibleKey:t}=e;const o=(0,i().v3)(),d=(0,r().K8)((()=>c().default.state.currentUserSettingsStore),[]),u=(0,r().K8)((()=>{const e=null==d?void 0:d.getSettings();return!e||Boolean(e[t])}),[t,d]),p=(0,r().K8)((()=>{const e=(0,s()._m)(o),t=null==d?void 0:d.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!u}),[o,d,u]),g=n.useCallback((()=>{d&&!u&&p&&a().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{l().mJ({userSettingsStore:d,transaction:e,data:{[t]:Date.now()}})}})}),[o,p,t,d,u]);return{shouldShowTooltip:p,dismissTooltip:g}}function u(){return d({userSettingsDismissibleKey:"layout_info_panel_button_education_tooltip_dismissed_at"})}function p(){return d({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},388182:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});const n=o(757695).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},390518:(e,t,o)=>{"use strict";o.d(t,{A:()=>r});o(296540);var n=()=>o(331542),i=o(474848);function r(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().A,{})})}},393695:(e,t,o)=>{"use strict";o.d(t,{Y:()=>l});var n=()=>o(484714),i=()=>o(56366),r=()=>o(200277),a=()=>o(265793);function l(e){const t=(0,n().v3)();return(0,a().b)(e),(0,i().K8)((()=>{const o=e.collectionStore();return o?(0,r().N)(t,o):[]}),[t,e])}},395859:(e,t,o)=>{"use strict";o.d(t,{A:()=>h,X:()=>y});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(148307),a=()=>o(919709),l=()=>o(959013),s=()=>o(436696),c=()=>o(896628),d=()=>o(606952),u=()=>o(317909),p=()=>o(654062),g=()=>o(943919),m=()=>o(186445),f=o(474848);const y=(0,l().YK)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},formNamePlaceholderMessage:{defaultMessage:"Form name",id:"database.viewSettings.mainTab.formNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});function S(e,t,o){const n=o.collectionViewBlockStore(),i=o.collectionViewStore();if(!n||!i||!i.isDefined())return;const r=(0,m().sj)(n.id);i.getName()!==e&&u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,canUndo:!0,perform:t=>{if((0,p().F)({collectionViewStore:i,update:{name:e},transaction:t}),r){const o=(0,a().x9d)(e);d().KY({environment:n.environment,store:n.getBlockTitleStore(),value:o,transaction:t})}}}),(0,s().X)({environment:t,collectionContextStore:o,action:"rename",original_view_type:i.getType()})}const h=function(e){const{collectionViewStore:t,collectionContextStore:a,selectViewNameInitial:d,showViewDescriptionStore:p}=e,h=(0,n().v3)(),v=(0,l().tz)(),x=(0,o(401497).DP)(),C=(0,n().Y0)(),b=(0,i().K8)((()=>t.getType()),[t]),w=(0,i().K8)((()=>t.getName()),[t]),{description:j,collection_view_icon:A}=(0,i().K8)((()=>t.getFormat()),[t]),_=(0,i().O$)(p),M=(0,i().O$)(a.permissionScopesStore),k=(0,i().O$)(a.isEditableHomeCollectionStore),I=(0,i().K8)((()=>t.getAppConfigUri()),[t]),T=!I||(0,o(313892).$h)(I);return(0,f.jsx)(o(89924).A,{title:C.isMobile&&(0,f.jsx)(l().sA,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,f.jsx)(o(755735).B,{initialValue:w||"",placeholder:v.formatMessage("form_editor"===b?y.formNamePlaceholderMessage:y.viewNamePlaceholderMessage),onBlur:e=>S(e,h,a),onSubmit:e=>S(e,h,a),focusInitial:d,selectAll:d,disabled:!M.canConfigureBlock||!T,iconButton:{icon:e=>(0,f.jsx)(o(745266).h,{color:"gray",viewIcon:A,viewType:b}),iconStyle:{fill:o(278238).l8[x.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore(),i=t.collectionViewBlockStore();if(!i||!n||!n.isDefined())return;const a=(0,m().sj)(i.id);u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{if(a){const t=o||r().A.images.appPackages.taskDbIconSvg;(0,g().o)({collectionViewStore:n,icon:t,transaction:e}),c().zA({stores:[i],update:{page_icon:t},transaction:e})}else(0,g().o)({collectionViewStore:n,icon:o,transaction:e})}}),(0,s().X)({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(h,a,e)},inputRightButton:k||"form_editor"===b?null:(0,f.jsx)(o(539148).S,{description:j,showTooltip:!_,onClick:()=>p.setState(!_),addDescriptionText:v.formatMessage(y.addDescriptionTooltip),editDescriptionText:v.formatMessage(y.editDescriptionTooltip),disabled:!M.canConfigureBlock})})})}},397089:(e,t,o)=>{"use strict";o.d(t,{Ak:()=>A,IM:()=>j,jB:()=>w});o(898992),o(672577),o(581454),o(296540);var n=()=>o(908006),i=()=>o(56366),r=()=>o(401497),a=()=>o(857639),l=()=>o(742117),s=()=>o(179034),c=()=>o(96689),d=()=>o(854150),u=()=>o(534177),p=()=>o(686526),g=()=>o(521358),m=()=>o(374562),f=()=>o(313892),y=()=>o(878665),S=()=>o(180762),h=()=>o(553965),v=()=>o(234675),x=()=>o(39039),C=()=>o(95347),b=o(474848);function w(e){var t,o;const{collectionContextStore:n,feature:a,itemProps:s,icon:c,onClick:d}=e,u=(0,i().K8)((()=>n.databaseType),[n]),p=function(e,t){var o;const n=function(e){const{collectionContextStore:t,feature:o}=e,n=(0,C().rD)(t);return(0,i().K8)((()=>{if((0,v().l)(o))return;if((0,f().lK)(o))return o.dependencies.find((e=>"property"===e.type));if((0,f().u1)(o))return o.dependencies.find((e=>"property"===e.type));const e=(0,C().ff)(o,null==n?void 0:n.allFeatures).find((e=>(0,C().jk)({collectionContextStore:t,feature:e})));return null==e?void 0:e.dependencies.find((e=>"property"===e.type))}),[n,t,o])}({collectionContextStore:e,feature:t}),r=(0,i().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSchema()}),[e]),a=(0,i().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_uri_map}),[e]);if(!n||"property"!==n.type)return;const l=(null==a?void 0:a[n.uri])??n.uri,s=null==r?void 0:r[l];switch(null==s?void 0:s.type){case"select":case"multi_select":case"status":return null===(o=s.options)||void 0===o?void 0:o.map((e=>e.value)).join(", ");default:return}}(n,a),g=(0,r().IS)((e=>({addedIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),m=(0,x().tx)(a,u),S=p??m;return(0,b.jsx)(y().A,{showImage:!0,caption:m,tooltipImage:null===(t=a.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=a.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,b.jsx)(x().j7,{collectionContextStore:n,feature:a,caption:S,buttonMenuItemProps:{...(0,h().A)(s,e)},icon:c,right:(0,l().V)(g.addedIconStyle),onClick:d})})}function j(e){const{environment:t,feature:o,collectionContextStore:i,collectionSettingsStore:r,appConfig:l}=e;if(o.uri===(0,m().md)().uri)return()=>p().a2({collectionSettingsStore:r,item:{type:"subitemV2",from:"customize_menu"}});if(o.uri===(0,m().J4)().uri)return()=>p().a2({collectionSettingsStore:r,item:{type:"dependencies",from:"customize_menu"}});if((0,f().lK)(o)||(0,f().u1)(o)){if(0===o.dependencies.length)return()=>{a().log({level:"error",from:"FeaturesList",type:"FeatureWithNoDependencies",error:{miscDataString:`Feature ${o.name} has no dependencies.`}})};const e=o.dependencies[0],l=i.collectionStore();if(o.isAi)return()=>{const t=e.uri,o=null==l?void 0:l.getSchema()[t],n=i.settingsStore;p().a2({collectionSettingsStore:n,item:{type:"property",property:t,formatKey:i.getPropertyFormatKey()}}),"text"===(null==o?void 0:o.type)&&p().a2({collectionSettingsStore:n,item:{type:"propertyAiAutofill",propertySchema:o,property:t}})};if((0,f().lK)(o)&&("collection_view"===e.type||"collection_view_block"===e.type||"sub_external_collection"===e.type))return async()=>{await async function(e){const{feature:t,collectionContextStore:o,environment:i,collectionSettingsStore:r}=e;if(1!==t.dependencies.length)return;const a=t.dependencies[0];if("collection_view"===a.type){const e=o.collectionViewStore(),t=o.collectionViewBlockStore();if(!e||!t)return;const l=null==t?void 0:t.getParentStore();if(!l||l.table!==c().NX&&l.table!==s().ev&&l.table!==d().yK)return;const u=(await(0,g().QQ)({environment:i,collectionViewBlockStore:t,appParentStore:l})).find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===a.collectionViewBlockUri})),m=(0,f().cc)({collectionViewBlockStore:u,dependencyUri:a.uri});if(!m)return;(0,S().t)({environment:i,collectionContextStore:o,collectionViewId:m.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),n().default.afterNextFlush((()=>{p().Ow({collectionContextStore:o,collectionSettingsStore:r})}))}}({feature:o,collectionContextStore:i,environment:t,collectionSettingsStore:r})};if("property"===e.type){var y;const t=((null==l||null===(y=l.getFormat())||void 0===y?void 0:y.app_uri_map)??{})[e.uri]??e.uri;return()=>{A({collectionContextStore:i,property:t})}}return()=>{a().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureDependency",error:{miscDataString:`Feature ${o.name} has an unsupported dependency type: ${e.type}`}})}}if((0,f().$n)(o)){const e=(0,C().ff)(o,null==l?void 0:l.allFeatures);return 0===e.length?()=>{a().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureWithVariants",error:{miscDataString:`Feature ${o.name} has no variants.`}})}:()=>{1===e[0].dependencies.length&&A({collectionContextStore:i,property:e[0].dependencies[0].uri})}}(0,u().HB)(o)}function A(e){const{collectionContextStore:t,property:o}=e;p().a2({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}})}},419167:(e,t,o)=>{"use strict";o.d(t,{Ay:()=>b,GI:()=>x,Ve:()=>j,am:()=>C,jD:()=>w});var n=o(296540),i=()=>o(56366),r=()=>o(401497),a=()=>o(651124),l=()=>o(116089),s=()=>o(340498),c=()=>o(72135),d=()=>o(441738),u=()=>o(959013),p=()=>o(179070),g=()=>o(497222),m=()=>o(921855),f=()=>o(749240),y=()=>o(135221),S=()=>o(8980),h=()=>o(859428),v=o(474848);function x(e){let{collectionStore:t,propertySchema:o}=e;const n=(0,i().K8)((()=>(0,m().r4)(t.getName(),t)),[t]),r=(0,i().K8)((()=>{var e;const t=(null===(e=f().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,d().GI)(t)}),[]);return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,v.jsx)(u().sA,{...p().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(n)&&Boolean(o.name),collectionName:n,propertyName:o.name}})}),!r&&(0,v.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,v.jsx)(u().sA,{...p().fillAllPagesMessages.fillAllPagesAddOnMessage})})]})}function C(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;return t.isRunning?(0,v.jsx)("div",{style:n,children:(0,v.jsx)(y().A,{})}):(0,v.jsx)(S().I,{icon:l().x,color:"purplePrimary",style:o})}function b(e){let{updateAiInferencesTaskStatus:t,style:o}=e;const n=(0,u().tz)();return(0,v.jsx)("div",{style:o,children:t.isRunning?(0,v.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:void 0===t.numPagesFilled||void 0===t.numPagesRequested?(0,v.jsx)(u().sA,{defaultMessage:"Autofilling all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):(0,v.jsx)(u().sA,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,c().ZV)(t.numPagesFilled,"compact",n),numPagesRequested:(0,c().ZV)(t.numPagesRequested,"compact",n)}})}):(0,v.jsx)(u().sA,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})})}function w(e){let{updateAiInferencesTaskStatus:t}=e;const{numPagesFilled:o,numPagesRequested:n}={numPagesFilled:void 0,numPagesRequested:void 0,...t},i=(0,r().IS)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===o||void 0===n?null:(0,v.jsx)("div",{style:i.outer,role:"progressbar",children:(0,v.jsx)("div",{style:{...i.inner,width:100*Math.min(o/n,1)+"%"}})})}function j(e){const{environment:t,collectionContextStore:o,collectionStore:r,property:l,propertySchema:c,doesUserHaveAIAddOn:d,isAutofillSetupEnabled:u}=e,m=(0,i().K8)((()=>{const e=o.collectionStore();return e?(0,a().Ts)(e.getFormat(),l):{isRunning:!1,numPagesFilled:void 0,numPagesRequested:void 0}}),[o,l]),f=(0,n.useCallback)((async()=>{const e=o.collectionStore();e&&c&&await p().autofillPropertyForCollection({environment:t,collectionStore:e,propertySchema:c,property:l})}),[t,c,l,o]);return(0,v.jsx)(h().A,{disableTooltip:d,renderTooltip:()=>(0,v.jsx)(x,{collectionStore:r,propertySchema:c}),render:e=>(0,v.jsx)(g().A,{icon:e=>(0,v.jsx)(C,{updateAiInferencesTaskStatus:m,iconStyle:e,progressIconStyle:{width:s().Ev.sm,marginTop:4,marginLeft:4,marginRight:2}}),title:(0,v.jsx)(b,{updateAiInferencesTaskStatus:m}),caption:void 0!==m.numPagesFilled&&void 0!==m.numPagesRequested&&(0,v.jsx)(w,{updateAiInferencesTaskStatus:m}),focused:!1,onClick:f,disabled:m.isRunning||!u,...e})})}},424554:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ChartSettingsMain:()=>j().X,CollectionSettings:()=>n()._,CollectionSettingsButtonOptions:()=>b,CollectionSettingsEditButtonAutomationOption:()=>Q,CollectionSettingsPropertyTypeMenuItem:()=>Y,CollectionSettingsSaveAsAppButton:()=>ee});var n=()=>o(634339),i=o(296540),r=()=>o(56366),a=()=>o(912720),l=()=>o(959013),s=()=>o(246826),c=()=>o(813297),d=()=>o(390518),u=()=>o(546461),p=()=>o(911724),g=()=>o(840094),m=()=>o(845715),f=()=>o(633904),y=()=>o(419357),S=()=>o(89924),h=()=>o(972435),v=()=>o(735695),x=o(474848);const C=(0,l().YK)({inputPlaceholder:{defaultMessage:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});function b(e){const{collectionContextStore:t,propertySchema:o}=e,n=(0,r().K8)((()=>t.collectionStore()),[t]),l=(0,r().K8)((()=>null==n?void 0:n.getSpaceId()),[n]),s=(0,i.useMemo)((()=>{const e=o.automation_id;if(e&&l)return{id:e,spaceId:l,table:a().yB}}),[o.automation_id,l]);return(0,m().K)(n,s)?(0,x.jsx)(w,{...e}):(0,x.jsx)(d().A,{})}function w(e){const{collectionContextStore:t,propertySchema:o,propertyId:n}=e,[a,d]=(0,i.useState)([]),m=(0,r().O$)(t.permissionScopesStore),b=(0,r().K8)((()=>t.collectionStore()),[t]),w=(0,r().K8)((()=>null==b?void 0:b.getSpaceId()),[b]),{maybePersistedAutomationStore:j,maybePersistedTransactionActions:A}=(0,f().t)({automationId:o.automation_id,spaceId:w,defaultValue:void 0,persist:!0}),_=(0,r().K8)((()=>null==j?void 0:j.getTrigger()),[j]),M=(0,g().Qj)({automationStore:j,propertyId:n,propertySchema:o,collectionContextStore:t}),k=(0,r().K8)((()=>{var e;return"sufficient"===(null==M||null===(e=M.state)||void 0===e?void 0:e.executionPermissionStatus)}),[M]),I=(0,r().K8)((()=>(null==j?void 0:j.getNameStore().getValue())??""),[j]),T=(0,i.useCallback)((e=>{if(!j)return;const t=e.currentTarget.value;A.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",perform:e=>{s().KY({store:j.getNameStore(),transaction:e,value:t})}})}),[j,A]),P=(0,i.useCallback)((e=>{d((t=>[...t,e.id]))}),[]);return b&&j&&_&&"button"===_.type?(0,x.jsx)(u().u,{automationStore:j,contextType:"button_property",children:(0,x.jsxs)(p().v,{value:{collectionStore:b,disabled:!k,editorPlacement:{type:"inline"},editorWidth:v().vE,maybePersistedTransactionActions:A,onActionAdded:P,suppressActionErrors:a,hideDragHandle:!1},children:[(0,x.jsx)(S().A,{topBorder:!0,title:(0,x.jsx)(l().sA,{id:"database.buttonProperty.label",defaultMessage:"Label"}),children:(0,x.jsx)(y().Ay,{disabled:!m.canConfigureCollection,placeholder:h().A.formatMessage(C.inputPlaceholder),value:I,onChange:T})}),(0,x.jsx)(S().A,{style:{paddingInline:12},children:(0,x.jsx)(c().U3,{areActionsEditable:!0,areTriggersEditable:!1})})]})}):null}var j=()=>o(309920),A=()=>o(484714),_=()=>o(401497),M=()=>o(970013),k=()=>o(713998),I=()=>o(743176);const T={viewBox:"0 0 16 16",svg:(0,x.jsx)("path",{d:"M4.825 4.85a3.175 3.175 0 1 1 6.35 0v1.061a1.95 1.95 0 0 1 1.575 1.914v4.2a1.95 1.95 0 0 1-1.95 1.95H5.2a1.95 1.95 0 0 1-1.95-1.95v-4.2c0-.949.677-1.74 1.575-1.914zm1.1 1.025h4.15V4.85a2.075 2.075 0 0 0-4.15 0zm2.525 4.299a1.05 1.05 0 1 0-.9 0v.976a.45.45 0 0 0 .9 0z"})},P=(0,o(340498).wt)("lockFillSmall",T);var B=()=>o(284371),R=()=>o(901952),V=()=>o(235191),F=()=>o(686526),K=()=>o(36629),D=()=>o(317909),L=()=>o(895876),O=()=>o(8980),E=()=>o(614505),z=()=>o(16006),N=()=>o(132389),U=()=>o(859428),H=()=>o(682146),W=()=>o(962730),G=()=>o(939656),q=()=>o(497222);function Y(e){const{collectionContextStore:t,collectionUri:o,disabled:n,formatKey:a,isTypedProperty:s,property:c,propertyTypeButtonPopupStore:d}=e,u=(0,_().DP)(),p=(0,A().v3)(),g=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),m=(0,r().K8)((()=>(0,G().Jq)({property:c,collectionContextStore:t})),[t,c]),f=(0,r().K8)((()=>(0,G().k7)(g,m)),[g,m]),y=(0,r().K8)((()=>null==f?void 0:f.getIcon()),[f]),S=t.settingsStore,h=(0,i.useCallback)((()=>{m&&function(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertySchema:a,propertyTypeButtonPopupStore:l}=e,s=t.collectionStore();if(!s)return;F().a2({collectionSettingsStore:o,item:{type:"propertyType",propertySchema:a,onAccept:e=>function(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertyTypeButtonPopupStore:a,type:l}=e,s=t.collectionStore();if(!s)return;(0,R().V)({environment:n,collectionContextStore:t,property:r,new_property_type:(0,M().v2)(l),from:"view_settings",action:"change_type"}),"relation"===l?F().a2({collectionSettingsStore:o,item:{type:"selectRelationSource",property:r,formatKey:i}}):(D().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:n,canUndo:!0,perform:e=>{V().Hj({environment:n,collectionStore:s,property:r,type:l,transaction:e})}}),F().yl({collectionSettingsStore:o}),(0,M().hN)(l)&&K().pG({propertyType:l,propertyId:r,collectionContextStore:t}));a.reset()}({collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertyTypeButtonPopupStore:l,type:e})}})}({collectionContextStore:t,collectionSettingsStore:S,environment:p,formatKey:a,property:c,propertySchema:m,propertyTypeButtonPopupStore:d})}),[t,S,p,a,c,m,d]);if(!m)return null;const v=(0,k().H6)(m)||(0,k().KF)(m);return(0,x.jsx)(U().A,{placement:W().W.Left,disableTooltip:!n,renderTooltip:e=>function(e){const{tooltipEvents:t,isTypedProperty:o,collectionUri:n,propertySchema:i}=e;if(o&&n)return(0,x.jsx)(l().sA,{...t,defaultMessage:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:H().dC[i.type],databaseType:(0,L()._V)(n)}});return(0,x.jsx)(l().sA,{...t,defaultMessage:"This property's type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property."})}({tooltipEvents:e,isTypedProperty:s,collectionUri:o,propertySchema:m}),render:e=>(0,x.jsx)(q().A,{...e,disabled:n,rotateChevron:d.state.open,title:(0,x.jsx)(l().sA,{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:(0,x.jsxs)(x.Fragment,{children:[n?(0,x.jsx)("div",{...e,children:(0,x.jsx)(O().I,{icon:P,size:"sm",color:"secondary"})}):(0,x.jsx)(I().Ay,{type:m.type,icon:void 0,size:16,theme:u}),(0,x.jsx)(N().A,{size:4}),v?(0,x.jsxs)("div",{style:{color:n?u.darkTextColor:void 0,display:"flex",alignItems:"center"},children:[(0,x.jsx)(E().A,{icon:y,isEmptyPage:!1,size:20,disabled:!0}),(0,x.jsx)(z().A,{store:f,style:{display:"inline",wordBreak:"break-word",...B().RC}})]}):(0,x.jsx)("span",{style:{color:n?u.darkTextColor:void 0},children:H().dC[m.type]})]}),onClick:h})})}var $=()=>o(837570);function Q(e){const{collectionSettingsStore:t,collectionContextStore:o,property:n}=e,i=(0,A().v3)(),a=(0,r().K8)((()=>(0,G().Jq)({collectionContextStore:o,property:n})),[o,n]);return(0,x.jsx)(q().A,{title:(0,x.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,x.jsx)(l().sA,{id:"database.collectionsettings.button.editAutomationLabel",defaultMessage:"Edit automation"})}),disabled:!1,showChevron:!0,onClick:()=>{a&&"button"===a.type&&$().h({environment:i,mode:"edit_button_property",collectionSettingsStore:t,collectionContextStore:o,propertyId:n,propertySchema:a})}})}o(898992),o(354520),o(672577);var Z=()=>o(725649),J=()=>o(430102),X=()=>o(363186);function ee(e){let{workflowStore:t,collectionContextStore:o}=e;const n=(0,A().v3)(),r=(0,A().Y0)(),a=(0,i.useContext)(X()._o);return(0,x.jsx)(J().A,{title:(0,x.jsx)(l().sA,{defaultMessage:"Save as filter for App",id:"database.filterBar.changesControl.saveAsWorkflowAppFilter.title"}),color:"orange",disableDropdown:!0,onClick:()=>{a&&function(e){var t;let{collectionContextStore:o,workflowStore:n,saveModule:i}=e;const r=o.collectionStore();if(!r)return;const a=null===(t=n.getModel())||void 0===t||null===(t=t.getData())||void 0===t||null===(t=t.modules)||void 0===t?void 0:t.filter((e=>"database"===e.type)).find((e=>{var t;return(null===(t=(0,Z().DK)(e.state))||void 0===t||null===(t=t.pointer)||void 0===t?void 0:t.id)===(null==r?void 0:r.id)}));if(null==a||!a.state)return;i({...a,state:{...a.state,filter:{propertyFilters:o.currentPropertyFiltersStore.state,combinatorFilter:o.currentCombinatorFilterStore.state}}})}({environment:n,collectionContextStore:o,workflowStore:t,saveModule:a.saveModule})},style:{marginLeft:6,marginRight:r.isMobile?8:void 0,fontSize:r.isMobile?16:14,...r.isMobile?{height:30}:null}})}},448701:(e,t,o)=>{"use strict";o.d(t,{A:()=>p});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(90907),a=()=>o(701751),l=()=>o(436696),s=()=>o(222299),c=()=>o(525432),d=()=>o(497222),u=o(474848);function p(e){let{collectionContextStore:t}=e;const o=(0,n().v3)(),p=(0,i().K8)((()=>t.collectionViewBlockStore()),[t]),g=(0,i().K8)((()=>null==p?void 0:p.getCollectionViewSourceCollectionStore()),[p]),m=(0,i().K8)((()=>null==p?void 0:p.isLocked()),[p]),f=(0,i().K8)((()=>g?g.canEditCollection():null==p?void 0:p.canEditCollection()),[p,g]),y=(0,i().K8)((()=>null==p?void 0:p.isCollectionViewPageWithContent()),[p]),S=(0,i().K8)((()=>void 0!==t.viewsModuleContextStore.state),[t]);return p&&f&&!S?(0,u.jsx)(d().A,{icon:m?a().p:r().h,title:(0,c().VM)(Boolean(g),y,m),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();if(!o)return;s().X6({environment:e,store:o,lock:!o.isLocked()}),(0,l().X)({environment:e,collectionContextStore:t,action:"click_toggle_lock"})}(o,t)}):null}},455338:(e,t,o)=>{"use strict";o.d(t,{G:()=>l,t:()=>s});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454);var n=o.n(o(844751)),i=(o(296540),()=>o(959013)),r=()=>o(436572),a=o(474848);function l(e,t){const o=new Map,i=t.map((e=>{const t=[e.name,e.description].join(" ");return o.set(e.name,t),t})),r=new Set(n().filter(e,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=o.get(e.name);return t&&r.has(t)}))}function s(e){const{featureName:t}=e;r().D6({label:(0,a.jsx)(i().sA,{id:"database.viewSettings.customizeMenu.successToastAfterFeatureAddition",defaultMessage:"Added {featureName} to this database.",values:{featureName:t}})})}},467248:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M2.9 4.375a.625.625 0 1 0 0 1.25h14.2a.625.625 0 1 0 0-1.25zm0 3.333a.625.625 0 0 0 0 1.25h14.2a.625.625 0 1 0 0-1.25zM2.275 15c0-.345.28-.625.625-.625H10a.625.625 0 1 1 0 1.25H2.9A.625.625 0 0 1 2.275 15m.625-3.958a.625.625 0 1 0 0 1.25h14.2a.625.625 0 0 0 0-1.25z"})},i=(0,o(340498).wt)("textJustifyLeft",n)},478573:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var n=o(296540),i=()=>o(21140),r=o(474848);const a=n.forwardRef(((e,t)=>{const{icon:n,name:a,subText:l,disabled:s,...c}=e,d=(0,o(401497).IS)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.accentColors.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.accentColors.gray[100]:e.accentColors.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"},buttonMenuItem:{padding:6},subText:{color:e.lightTextColor,fontSize:12}})),[]);return(0,r.jsx)(o(760217).A,{...c,disabled:s,disabledFeedback:s,buttonStyle:{margin:0,width:"100%"},style:d.buttonMenuItem,itemMarginLeft:0,ref:t,title:(0,r.jsxs)(i().Ye,{gap:8,alignItems:"center",children:[(0,r.jsx)(i().Ye,{style:d.iconContainer,alignItems:"center",justifyContent:"center",children:n}),(0,r.jsxs)(i().wt,{children:[(0,r.jsx)("span",{children:a}),l?(0,r.jsx)("span",{style:d.subText,children:l}):null]})]})})}));a.displayName="AddPageLayoutModuleMenuButton"},490696:(e,t,o)=>{"use strict";o.d(t,{A:()=>z});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var n=o(296540),i=()=>o(17022),r=()=>o(484714),a=()=>o(56366),l=()=>o(401497),s=()=>o(708685),c=()=>o(502856),d=()=>o(784892),u=()=>o(247331),p=()=>o(563015),g=()=>o(977345),m=()=>o(416504),f=()=>o(591779),y=()=>o(792071),S=()=>o(959013),h=()=>o(973647),v=()=>o(284371),x=()=>o(193722),C=()=>o(175116),b=()=>o(862292),w=()=>o(921855),j=()=>o(476492),A=()=>o(909470),_=()=>o(847743),M=()=>o(972435),k=()=>o(722872),I=()=>o(991114),T=()=>o(645873),P=()=>o(963589),B=()=>o(962730),R=()=>o(792415),V=()=>o(351360),F=()=>o(508496),K=()=>o(942504),D=()=>o(928600),L=()=>o(833682),O=o(474848);const E=200;function z(e){var t,o,l,d;const{property:S,disabled:v,formulas:B,getRecordModel:K,propertySchema:z,collectionStore:U,handleSave:W,handleClose:G,blockStore:q,analyticsFrom:Y}=e,$=(0,r().v3)(),Q=(0,C().ET)(),{value:Z}=(0,T().fJ)(b().T.formulas),[J,X]=(0,n.useState)(null==z||null===(t=z.formula2)||void 0===t?void 0:t.code),ee=(0,f().lW)(J,E,Object.is),[te,oe]=(0,n.useState)(),ne=(0,n.useRef)(null===(o=z.formula2)||void 0===o?void 0:o.code),ie=(0,n.useRef)(J),re=(0,n.useRef)(null==z||null===(l=z.formula2)||void 0===l?void 0:l.result_type),ae=(0,n.useCallback)((e=>{ie.current=e,X(e)}),[]),le=(0,n.useCallback)((e=>{re.current=e}),[]),[se,ce]=(0,n.useState)((()=>i().A.withListenerIgnored((()=>H.state??!1)))),[de,ue]=(0,n.useState)([]),pe=(0,r().Y0)();(0,n.useEffect)((()=>()=>{const e=ne.current,t=ie.current,o=re.current;if(t!==e||void 0!==xe){W({newValue:t,newType:(0,s().removeFunctionsFromType)(o??{type:"unknown"}),propertySchema:z,collectionStore:U,property:S});const e=(0,w().r4)(t,U);(0,x().L)($,{...(0,j().sl)(Q),property_type:z.type,action:"formula_v2_edit",from:Y,formula_char_count:e.length})}}),[]);const ge=(0,a().K8)((()=>U.pointer),[U.pointer]),me=(0,n.useMemo)((()=>{const e={type:"block",collection:ge};return{kind:u().FormulaContextValueKind.ThisRow,type:e}}),[ge]),fe=(0,a().K8)((()=>R().A.state.publicPageData),[]),ye=(0,a().K8)((()=>{var e;return null===(e=V().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),Se=(0,a().K8)((()=>(0,A().i)()),[]),he=(0,P().X)("collections_xws"),ve=(0,n.useMemo)((()=>{if(!ye)return;const e=y().h0Y.fromGetRecordModelFn(K);return{sourceProperty:S,valueTypes:[me],handleDataRequest:(0,c().MC)({collectionFeatureGates:Se,experimentService:F().default,getRecordModel:K,loadRecordModel:e}),formulaPropertyNames:J&&(0,g().o2)(J),publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},spaceId:ye,restrictUnaccessibleProperties:he?"cross_space_only":void 0,featureGates:Se}}),[ye,K,S,me,J,null==fe?void 0:fe.collectionId,null==fe?void 0:fe.collectionSchema,Se,he]),xe=(0,a().K8)((()=>{if("v2"!==z.version&&z.formula)return B.convertCollectionFormulaToFormula2(z.formula,ge,U.getSchema())}),[ge,U,B,z.formula,z.version]),Ce=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!async function(){if(!xe||Ce.current||!ve)return;const e=await B.analyzeFormula(xe,ve);let t;t=h().Q.isFail(e)?{type:"unknown"}:e.value.type??{type:"unknown"},Ce.current=!0,ae(xe),le(t)}()}),[U,B,ae,le,S,z,xe,ve]);const be=(0,n.useMemo)((()=>{var e;const t="v2"===z.version?null===(e=z.formula2)||void 0===e?void 0:e.code:xe;return ne.current=t,t}),[null===(d=z.formula2)||void 0===d?void 0:d.code,z.version,xe]),we=(0,I().C)(),je=(0,a().K8)((()=>{ue([]);const e=null==q?void 0:q.getModel(),t=null==q?void 0:q.getRecordModel;if(!e||!ee||!t||_().Pe||!Z)return;const o=se?Z.evaluateRawCollectionFormula2({block:e,property:S,formulaCode:ee,getRecordModel:t,intl:M().A.getIntl(),userTimeZone:(0,m().P)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+we,resultCache:new Map,regExpCache:new Map,publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},experimentService:F().default,collectionFeatureGates:(0,A().i)()}):Z.evaluateCollectionFormula2WithoutCache({block:e,property:S,formulaCode:ee,getRecordModel:t,intl:M().A.getIntl(),userTimeZone:(0,m().P)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+we,resultCache:new Map,regExpCache:new Map,publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},experimentService:F().default,collectionFeatureGates:(0,A().i)()});if(o){if(!h().Q.isFail(o))return oe(re.current),o.value;(0,p().eJ)(o.error)&&ue([o.error])}}),[q,ee,se,S,we,fe,Z]);return ve&&ye?(0,O.jsx)(D().A,{menuType:pe.isMobile?k().gu.Modal:k().gu.Popup,hideMobileTopbar:!0,width:pe.isMobile?void 0:740,disableBottomPadding:!0,maxHeight:"unset",disableHeaderBorder:!0,disableScroller:!0,children:(0,O.jsx)(L().v,{initialCode:be,outputFooter:void 0!==q&&(0,O.jsx)(N,{formulaResult:je,isAdvancedMode:se,setIsAdvancedMode:ce,formulaType:te,blockStore:q,formulaSchema:z}),formulas:B,getRecordModel:K,focus:!0,disabled:v,parentSpaceId:ye,typecheckContext:ve,onCodeChange:ae,onTypeChange:le,handleClose:G,parentCollectionStore:U,evaluationErrors:de})}):null}const N=n.memo((function(e){let{formulaResult:t,formulaType:i,blockStore:r,formulaSchema:a,isAdvancedMode:c,setIsAdvancedMode:u}=e;const p=(0,l().IS)((e=>({output:{display:"flex",alignItems:"center",zIndex:1,fontSize:v().J.UISmall.desktop,height:38,padding:10,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden"},equals:{fontSize:v().J.UIRegular.desktop,color:e.mediumTextColor,marginRight:6,marginLeft:2},type:{fontSize:v().J.UISmall.desktop,color:e.mediumTextColor,marginLeft:6},iconStyle:{height:16,width:16},iconButtonStyle:{marginLeft:"auto"}})),[]),g=(0,n.useMemo)((()=>({baseStyles:{sizing:"small",tokenFormat:d().NY.Small,textStyle:{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",...o(425497).Cn[d().NY.Medium]}},store:r,isEmpty:!1,isReadOnly:!0,canComment:!1,shouldRenderTooltip:!1,shouldWrap:!1,collectionContextStore:void 0,templateVariableContext:void 0,property:void 0,propertyFormat:void 0,propertySchema:c?void 0:a,trackEditBlockProperty:()=>{},format:0,containerRef:null})),[r,a,c]),m=(0,n.useMemo)((()=>i?(0,s().getHumanReadableType)(i):o(145076).qY.unknown),[i]),f=(0,S().tz)(),y=c?f.formatMessage({id:"formulas.editor.toggleAdvancedModeOff",defaultMessage:"Hide details"}):f.formatMessage({id:"formulas.editor.toggleAdvancedModeOn",defaultMessage:"Show details"});return(0,O.jsx)(o(234359).L8.Provider,{value:g,children:(0,O.jsxs)("div",{style:p.output,children:[(0,O.jsx)("span",{style:p.equals,children:"="}),t&&(0,O.jsx)(U,{value:t,withComma:!1,blockStore:r,formulaSchema:a,isAdvancedMode:c,renderWrapper:!0}),c&&Boolean(t)&&(0,O.jsx)("span",{style:p.type,children:(0,O.jsx)(S().sA,{...m})}),(0,O.jsx)(o(859428).A,{renderTooltip:()=>y,placement:B().W.Top,alignment:B().C.Center,render:e=>(0,O.jsx)(o(285790).A,{icon:c?o(207583).F:o(305961).d,onClick:()=>{const e=!c;u(e),H.setState(e)},iconStyle:p.iconStyle,style:p.iconButtonStyle,ariaLabel:y,...e})})]})})})),U=n.memo((function e(t){let{value:i,withComma:r,blockStore:s,formulaSchema:c,isAdvancedMode:d,renderWrapper:u}=t;const[p,g]=(0,a().K8)((()=>{var e;if(!i)return[[],"text"];if("undefined"===i.type&&d)return[[K().Or],"empty"];const t=(0,o(886578).O)(i,s.getRecordModel,(0,m().P)());return[t,(null===(e=t[0])||void 0===e?void 0:e.type)??"text"]}),[s.getRecordModel,d,i]),f=(0,l().IS)((e=>({rightBracket:{color:e.mediumTextColor,fontSize:v().J.UISmall.desktop,marginLeft:2},leftBracket:{color:e.mediumTextColor,fontSize:v().J.UISmall.desktop,marginRight:2},comma:{color:e.mediumTextColor,fontSize:v().J.UISmall.desktop,marginRight:2}})),[]);let y;if("array"===i.type)y=(0,O.jsxs)(n.Fragment,{children:[d?(0,O.jsx)("span",{style:f.leftBracket,children:"["}):null,i.values.map(((t,o)=>(0,O.jsx)(e,{value:t,withComma:o<i.values.length-1,blockStore:s,formulaSchema:c,isAdvancedMode:d,renderWrapper:!1},o))),d?(0,O.jsx)("span",{style:f.rightBracket,children:"]"}):null,r?(0,O.jsx)("span",{style:f.comma,children:", "}):""]});else{const e=r&&!d&&(0,K().GL)(g,c);y=null==p?void 0:p.map(((t,o)=>(0,O.jsxs)(n.Fragment,{children:[(0,O.jsx)(K().yZ,{token:t,targetPropertySchema:c,blockStore:s,withComma:e,numberRightAlign:!1,shouldTruncate:!1,disableLinks:!1}),d&&r?(0,O.jsx)("span",{style:f.comma,children:", "}):null]},`${t.id}-${o}`)))}return u&&!d?(0,O.jsx)(K().Ye,{propertyType:g,rootPropertySchema:c,numberRightAlign:!1,children:y}):(0,O.jsx)(n.Fragment,{children:y})})),H=new(o(178624).R)({key:"formulas_show_details",namespace:o(419494).Bq,important:!0,trackingType:"preference"})},536308:(e,t,o)=>{"use strict";o.r(t),o.d(t,{formEditorActions:()=>n()});var n=()=>o(894995)},539148:(e,t,o)=>{"use strict";o.d(t,{S:()=>m});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(734410),a=()=>o(959013),l=()=>o(704152),s=()=>o(859428),c=()=>o(673730),d=()=>o(554283),u=()=>o(962730),p=o(474848);const g=(0,a().YK)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function m(e){let{onClick:t,description:o,showTooltip:m,addDescriptionText:f,editDescriptionText:y,disabled:S}=e;const{isMobile:h}=(0,n().Y0)(),[v,x]=(0,d().B)(),C=(0,a().tz)(),b=(0,i().IS)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:h?24:20,marginLeft:4},info:{width:h?18:16,height:h?18:16,fill:x&&!S?e.regularIconColor:e.mediumIconColor}})),[x,h,S]);return(0,p.jsx)(s().A,{renderTooltip:e=>(0,p.jsx)("div",{...e,children:null!=o&&o.length?o:f??C.formatMessage(g.addDescriptionTooltip)}),disableTooltip:!m||S,style:c().Q$,placement:u().W.Top,render:e=>(0,p.jsx)(l().A,{...e,ref:v,onClick:t,"aria-label":null!=o&&o.length?f:y??C.formatMessage(g.editDescriptionTooltip),style:b.button,disabled:S,disabledFeedback:S,children:(0,r().q)(b.info)})})}},546754:(e,t,o)=>{"use strict";o.d(t,{N:()=>s,u:()=>l});o(296540);var n=()=>o(496603),i=()=>o(645873),r=o(474848);const a=new(i().O2)("builder-modals",(()=>Promise.all([o.e(23806),o.e(75134),o.e(43380),o.e(96346),o.e(62475),o.e(3151),o.e(98629),o.e(90409),o.e(74562),o.e(38664),o.e(24587),o.e(4422),o.e(59794),o.e(21627),o.e(75659),o.e(15724),o.e(28721),o.e(6463),o.e(26483),o.e(29333),o.e(89109),o.e(97996),o.e(7522),o.e(67832),o.e(79665)]).then(o.bind(o,80524)))),l=(0,i()._h)(a,(e=>e.AutomationBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})}),s=(0,i()._h)(a,(e=>e.ButtonBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})});function c(){return(0,r.jsx)(o(401634).i,{handleOnDismiss:n().lQ,canSave:!1,handleOnSave:n().lQ,mode:"loading",children:(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,r.jsx)(o(331542).A,{})})})}},554840:(e,t,o)=>{"use strict";o.d(t,{e:()=>N,a:()=>z});o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(955363),s=()=>o(959013),c=()=>o(534177),d=()=>o(284371),u=()=>o(406699),p=()=>o(928600),g=()=>o(14235),m=()=>o(722872),f=()=>o(760578),y=()=>o(463830),S=(o(944114),o(581454),o.n(o(844751))),h=()=>o(651124),v=()=>o(390066),x=()=>o(30626),C=()=>o(496603),b=()=>o(736767),w=()=>o(760217),j=()=>o(419357),A=()=>o(939740),_=()=>o(89924),M=()=>o(250202),k=()=>o(682146),I=()=>o(972435),T=()=>o(970585),P=o(474848);const B=2,R=(0,s().YK)({inputPlaceholder:{defaultMessage:"Search for a property",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function V(e){const{currentProperty:t,getGroupedProperties:o,onAccept:l,renderProperty:d,inputPlaceholder:u,schema:p,format:g,defaultShowPropertyGroupCount:m}=e,f=(0,i().Y0)(),y=(0,r().uB)(void 0,T().A),A=(0,r().K8)((()=>o()),[o]),[M,V]=(0,n.useState)(!1),[D,L]=(0,n.useState)(""),O=(0,v().L)(g,p,void 0,h().jf.Page).collection_page_properties||[],E=(0,n.useCallback)((e=>{L(e.target.value),y.setState({...y.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),V(!1)}),[y]),z=(0,a().IS)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),N=C().Ul(A,(e=>Math.min(...e.map((e=>O.findIndex((t=>t.property===e))))))),U=[{key:"input",comp:(0,P.jsx)(_().A,{children:(0,P.jsx)(j().Ay,{focusInitial:!f.isMobile||void 0,focus:!f.isMobile||void 0,value:D,onChange:E,placeholder:u||I().A.formatMessage(R.inputPlaceholder)})})}];if(D){const e=N.map((e=>e.filter((e=>{const t=p[e],o=t?`${t.name} ${k().dC[t.type]}`:"";return Boolean(S().match(D,o))})))).filter((e=>e.length>0));if(0===e.length)U.push({key:"noResults",comp:(0,P.jsx)(b().A,{caption:(0,P.jsx)(s().sA,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,P.jsx)(_().A,{...e}),items:e.flat().map((e=>K({onAccept:l,property:e,schema:p,currentProperty:t,renderProperty:d}))).filter(c().O9)}];U.push(F({sections:o,menuListStore:y}))}}else{const e=m||B;let o,n;if(!M&&N.length>e){o=N.slice(0,e);const t=C().cz(N.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,P.jsx)(w().A,{...e,icon:(0,x()._)(z.dotsIcon),style:z.showMoreButton,title:(0,P.jsx)(s().sA,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{V(!0)}}}else o=N;const i=o.map(((e,i)=>({key:e.join("-"),render:e=>(0,P.jsx)(_().A,{...e,topBorder:0!==i}),items:e.map((e=>K({onAccept:l,property:e,schema:p,currentProperty:t,renderProperty:d}))).concat(i===o.length-1?[n]:[]).filter(c().O9)})));U.push(F({sections:i,menuListStore:y}))}return(0,P.jsx)(P.Fragment,{children:U.map((e=>{let{key:t,comp:o}=e;return(0,P.jsx)(n.Fragment,{children:o},t)}))})}function F(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,P.jsx)(A().Ay,{type:A().Oh.Vertical,initialFocus:0,sections:o,store:t})}}function K(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,a=t[r];if(!a)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,a):(0,P.jsx)(M().G,{...e,propertySchema:a,format:M().e.Name,checkState:t})},action:()=>{n(r)}}}var D=()=>o(497222),L=()=>o(380468),O=()=>o(148079),E=()=>o(557336);function z(e){const{currentPropertyId:t,feature:o,collectionContextStore:n,permissionScopes:i,onPropertySelect:a,buttonPopupStore:d,disabled:u}=e,p=(0,s().tz)(),g=(0,r().K8)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,c().HB)(o)}),[o,n]),m=(0,r().K8)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:y,handlePropertySelect:S,getProperties:h}=(0,E().Tv)({collectionContextStore:n,feature:o,onPropertySelect:a}),v=(0,f().uX)({feature:o,databaseType:m});return(0,P.jsx)(U,{intl:p,icon:l().N,caption:(0,P.jsx)(s().sA,{...v}),collectionContextStore:n,buttonPopupStore:d,shouldGroupProperties:!0,getGroupedProperties:h,currentProperty:t,disabled:u,onAccept:i.canConfigureBlock&&i.canConfigureCollection?S:()=>{},renderProperty:(e,t,i,r)=>(0,P.jsx)(O().A,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:g,checkState:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:y,handlePropertySelect:S})})}function N(e){const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:a,title:l}=e,d=(0,s().tz)(),u=(0,r().uB)(void 0,y().A),p=(0,r().O$)(o.normalizedSchemaStore),g=(0,n.useCallback)((()=>Object.keys(p).filter((e=>{const t=p[e];return"date"===(null==t?void 0:t.type)})).filter(c().O9)),[p]);return(0,P.jsx)(U,{intl:d,buttonPopupStore:u,title:l,collectionContextStore:o,shouldGroupProperties:!1,getProperties:g,currentProperty:t,disabled:a,onAccept:e=>{e&&i(e),u.setState({open:!1})}})}function U(e){const{currentProperty:t,icon:o,caption:n,buttonPopupStore:l,collectionContextStore:c,disabled:f,title:y,shouldGroupProperties:S}=e,h=(0,i().Y0)(),v=(0,r().K8)((()=>{var e;return(null===(e=c.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[c]),x=(0,r().O$)(c.normalizedSchemaStore),C=(0,a().IS)((e=>({caption:{fontSize:h.isMobile?d().J.UISmall.mobile:d().J.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[h]),b=(0,r().K8)((()=>l.state.open),[l]),w=(0,r().K8)((()=>h.isPhone?{menuType:m().gu.ActionSheet}:{menuType:m().gu.Popup,width:300}),[h.isPhone]);return(0,P.jsxs)(P.Fragment,{children:[n&&(0,P.jsx)("div",{style:C.caption,children:n}),(0,P.jsx)(u().Ay,{popupType:h.isPhone?g().nl.SlideUp:g().nl.Popup,alignmentToOrigin:u().yP.End,placementToOrigin:u().sx.Bottom,disabled:f,originGap:0,renderOrigin:e=>{var n;return(0,P.jsx)(D().A,{title:y??(0,P.jsx)(s().sA,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,P.jsx)("span",{style:d().RC,children:null===(n=x[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:b,disabled:f,icon:o,...e})},render:t=>(0,P.jsx)(p().A,{...w,children:S?(0,P.jsx)(V,{...e,getGroupedProperties:e.getGroupedProperties,format:v,schema:x}):(0,P.jsx)(L().A,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:v,schema:x})}),buttonPopupStore:l})]})}},557336:(e,t,o)=>{"use strict";o.d(t,{Me:()=>h,QZ:()=>x,Tv:()=>v,lk:()=>C});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(959013),l=()=>o(534177),s=()=>o(436696),c=()=>o(908447),d=()=>o(235191),u=()=>o(27732),p=()=>o(60867),g=()=>o(896628),m=()=>o(317909),f=()=>o(717989),y=()=>o(685889),S=()=>o(926203);function h(e){const{collectionContextStore:t,feature:o}=e,n=(0,a().tz)();return{initialPropertyName:(0,r().K8)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return y().$H(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function v(e){const{feature:t,collectionContextStore:o,onPropertySelect:v}=e,x=(0,i().v3)(),C=(0,a().tz)(),{initialPropertyName:b}=h({collectionContextStore:o,feature:t}),w=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"timeline_arrows_by"===t&&f().Tq({collectionViewStore:o,newProperty:n,transaction:i})}),[t]),j=(0,r().O$)(o.normalizedSchemaStore),A=(0,n.useCallback)((()=>y().qw(o,j)),[o,j]),_=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?p().zt({environment:x,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?f().L_({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,l().HB)(t)}),[o,x,t]),M=(0,n.useCallback)((e=>{const{featureType:t,from:n}=e,i=o.collectionStore(),r=i,a=o.collectionViewStore();if(!i||!r)return;const{performResult:s}=m().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:x,canUndo:!0,perform:n=>{const l=d().IL({environment:x,collectionStore:i,collectionViewArgs:a?{collectionViewStore:a,format:a.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:n});return u().cT({environment:x,collectionContextStore:o,collectionStore:i,property:l,propertyName:b,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:C,transaction:n,from:t}),a&&(w({collectionViewStore:a,newProperty:l,transaction:n}),_({relationPropertyId:l,transaction:n})),"timeline_arrows_by"===t&&(0,S().Wf)({environment:x,intl:C,collectionStore:i,transaction:n,newConfig:e.dateShiftingConfig}),l}});let p;"subitem"===t?p="notion://tasks/sub_task_feature":"timeline_arrows_by"===t?p="notion://tasks/task_dependencies_feature":(0,l().HB)(t),(0,c().Z)({environment:x,collectionContextStore:o,from:t,property_type:"relation",feature:{id:s,from:n,type:p}})}),[o,x,b,C,_,w]),k=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;m().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:x,canUndo:!0,perform:t=>{w({collectionViewStore:n,newProperty:e,transaction:t}),_({relationPropertyId:e,transaction:t})}}),v(e),"subitem"===t?i="update_default_subitem":"timeline_arrows_by"===t?i="update_default_timeline_arrows_by":(0,l().HB)(t),(0,s().X)({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,v,t,w,_]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;m().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:x,canUndo:!0,perform:t=>{w({collectionViewStore:n,newProperty:e,transaction:t})}}),v(e),"subitem"===t?i="update_subitem":"timeline_arrows_by"===t?i="update_timeline_arrows_by":(0,l().HB)(t),(0,s().X)({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,v,t,w]),handleDefaultPropertySelect:k,handleAddRelation:M,getProperties:A,clearCollectionViewSubitemDisplayMode:(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&m().createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:x,canUndo:!0,perform:t=>{g().zA({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,x])}}function x(e){const{feature:t,collectionContextStore:o}=e;let n,i;var r,a;if("subitem"===t)i=null===(r=o.collectionStore())||void 0===r?void 0:r.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(a=o.collectionViewStore())||void 0===a?void 0:a.getFormat().subitem_display_mode)?void 0:i;else if("timeline_arrows_by"===t){var s;n=o.currentArrowsByFormatStore.state,i=null===(s=o.collectionStore())||void 0===s?void 0:s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,l().HB)(t);const c=o.normalizedSchemaStore.state,d=y().uu(o,c);(0,l().O9)(n)&&!d.includes(n)&&(n=void 0),(0,l().O9)(i)&&!d.includes(i)&&(i=void 0);const u=n??i;if(u){var p;const e=Boolean(n),r="hidden"!==(null===(p=o.collectionViewStore())||void 0===p?void 0:p.getFormat().subitem_display_mode),a="subitem"===t?r:e;return{property:u,isDefault:u===i,enabledOnView:e,enabledOnCollection:Boolean(i),supportedInView:(0,S().v9)({feature:t,viewType:o.getViewType()}),isVisibleInView:a}}}function C(e){const{feature:t,collectionContextStore:o}=e;return(0,r().K8)((()=>x({feature:t,collectionContextStore:o})),[o,t])}},575154:(e,t,o)=>{"use strict";o.d(t,{q:()=>u});o(898992),o(354520),o(581454);var n=()=>o(56366),i=()=>o(663077),r=()=>o(496603),a=()=>o(863987),l=()=>o(793863),s=()=>o(200277),c=()=>o(437622),d=()=>o(580101);function u(e){let{parentStore:t,returnAllTemplates:o}=e;const u=(0,n().K8)((()=>{const e=a().A.getState();return((null==e?void 0:e.templatesWithRowIds)??[]).map((e=>e.template)).filter((e=>(0,i().Xq)(e,"collection")))}),[],{useDeepEqual:!0}),p=(0,n().K8)((()=>{d().A.getState();const e=(0,c().p3)().function;return e&&(0,i().AU)(e)?e:void 0}),[]),g=(0,n().K8)((()=>(0,s().$)({persona:p,parentStore:t})),[p,t],{useDeepEqual:!0});return(0,n().K8)((()=>(0,r().hS)([...u,...g,...o?(0,l().oA)():[]],(e=>e.templateId))),[u,g,o])}},580101:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});class n extends(()=>o(757695))().default{getInitialState(){}}const i=new n},582542:(e,t,o)=>{"use strict";o.d(t,{E:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})})},594952:(e,t,o)=>{"use strict";o.d(t,{I:()=>r});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M5.486 14.341a.669.669 0 1 0-.946.946.669.669 0 0 0 .946-.946"}),(0,n.jsx)("path",{d:"M11.964 2.093a1.625 1.625 0 0 0-2.471.205L6.976 5.821l-.04-.04a.625.625 0 0 0-.884 0l-1.07 1.07a2.625 2.625 0 0 0 0 3.713l.563.563-1.35.964c-.355.253-.782.557-1.13.92-.363.38-.683.867-.754 1.495-.09.793.17 1.621.78 2.231s1.437.87 2.23.78c.628-.072 1.115-.392 1.495-.755.364-.348.668-.775.92-1.13l.015-.021.95-1.329.562.563a2.625 2.625 0 0 0 3.712 0l1.07-1.07a.625.625 0 0 0 0-.884l-.054-.054 3.524-2.517a1.625 1.625 0 0 0 .204-2.471zm-1.454.932a.375.375 0 0 1 .57-.048l3.001 3.001a4.3 4.3 0 0 1-1.216 2.443l-.069.068c-.112.113.004.3.155.25l.69-.23a3.2 3.2 0 0 0 1.525-1.079l.16-.206 1.51 1.509a.375.375 0 0 1-.048.57l-3.558 2.541-5.262-5.261zM6.494 7.107l6.226 6.226-.629.628a1.375 1.375 0 0 1-1.944 0l-1.085-1.084a.625.625 0 0 0-.95.078l-1.379 1.93c-.27.38-.51.715-.781.974-.263.25-.509.385-.772.415a1.47 1.47 0 0 1-1.206-.42c-.33-.33-.47-.776-.42-1.207.029-.263.164-.51.415-.771.258-.27.594-.512.972-.782l1.931-1.379a.625.625 0 0 0 .079-.95L5.866 9.68a1.375 1.375 0 0 1 0-1.944z"})]})},r=(0,o(340498).wt)("paintBrush",i)},614525:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});o(296540);var n=()=>o(959013),i=()=>o(436696),r=()=>o(686526),a=o(474848);const l=function(e){let{collectionContextStore:t}=e;const l=(0,o(484714).v3)(),{viewName:s,viewType:c,isViewsModule:d}=(0,o(56366).K8)((()=>{var e,o;return{viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName(),isViewsModule:Boolean(t.viewsModuleContextStore.state)}}),[t]);if(!c||d)return null;let u=(0,a.jsx)(n().sA,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"});return"chart"===c?u=(0,a.jsx)(n().sA,{defaultMessage:"Copy link to chart",id:"database.viewSettings.mainTab.copyLinkButton.title.chart"}):s&&(u=(0,a.jsx)(n().sA,{defaultMessage:"Copy link to {viewName}",id:"database.viewSettings.mainTab.copyLinkButton.title.viewName",values:{viewName:s}})),(0,a.jsx)(o(497222).A,{icon:o(742852).w,title:u,onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(r().GH({environment:e,collectionContextStore:t,collectionViewStore:o}),(0,i().X)({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(l,t)})}},626318:(e,t,o)=>{"use strict";o.d(t,{Bj:()=>v,ZX:()=>h});o(16280);var n=()=>o(278238),i=()=>o(206267),r=()=>o(454984),a=()=>o(688728),l=()=>o(475140),s=()=>o(179034),c=()=>o(869558),d=()=>o(183558),u=()=>o(246826),p=()=>o(317909),g=()=>o(594794),m=()=>o(972435),f=()=>o(630116),y=()=>o(978846),S=()=>o(38e3);function h(e){var t,o;const{environment:n,layoutStore:s,relationPropertyId:c,targetCollectionPointer:u,viewName:g,viewIcon:m}=e,h=null===(t=s.getModel())||void 0===t?void 0:t.firstRawModuleOfType("editor"),x=null===(o=s.getModel())||void 0===o?void 0:o.firstRawModuleOfType("viewsMain");if(!h&&!x)throw new Error("Invalid state: no editor or viewsMain module");const{performResult:C}=p().createAndCommit({environment:n,canUndo:!0,perform:e=>{const{inMemoryRecordCache:t}=s;let o,C=x;if(C){var b;if("viewsMain"!==(null===(b=C)||void 0===b?void 0:b.type))throw new Error("Invalid state: editor or viewsMain module is not of the expected type");o=f().Bv.createChildStore(s,C.collection_view_block_pointer)}else{const t=(0,d().Ay)(),{collectionViewBlockStore:c}=(0,S().$)({environment:n,layoutStore:s,transaction:e});o=c,C={id:t,type:"viewsMain",collection_view_block_pointer:{...o.pointer,spaceId:o.getSpaceId()}};const u=(0,l().JO)(s.getModules(),(e=>"editor"===e.type));if(!u||!h||"form_conditional_modules"===u.area)throw new Error("Invalid state: no editor module");if("views_main_tab_modules"===u.area)throw new Error("Cannot add views main module when editor is already in views main module");p().applyOperation({store:s,transaction:e,operation:r().N4.deleteModuleInArea({pointer:s.pointer,area:a().Zm[u.area],moduleId:h.id})}),(0,y().UQ)({position:{type:"absolute",area:u.area,index:u.index},module:C,layoutStore:s,transaction:e,environment:n,sessionId:(0,i().JW)(),isPropertyCreation:!1})}if(!C)throw new Error("Invalid state: no views main module");const w=v({environment:n,transaction:e,targetCollectionPointer:u,collectionViewBlockStore:o,viewName:g,viewIcon:m,relationPropertyId:c,inMemoryRecordCache:t});return{viewsMainModule:C,collectionViewBlockPointer:o.pointer,collectionViewPointer:w}},userAction:"viewsModuleActions.addViewToViewsMainModule"});if(!C)throw new Error("Transaction to add collection view to views main module failed");return{viewsMainModule:C.viewsMainModule,collectionViewPointer:C.collectionViewPointer,collectionViewBlockPointer:C.collectionViewBlockPointer}}function v(e){let{environment:t,transaction:o,targetCollectionPointer:r,collectionViewBlockStore:a,viewName:l,viewIcon:d,relationPropertyId:y,inMemoryRecordCache:S}=e;const h=(0,g().JH)({environment:t,table:c().Gy,spaceId:a.getSpaceId()}).id;let v=d;if(!v&&r){const e=f().sk.createChildStore(a,r).getIcon();null!=e&&e.icon&&(0,n().T8)(e.icon)&&(v=e.icon)}const C={id:h,type:"table",parent_id:a.pointer.id,parent_table:s().ev,space_id:a.getSpaceId(),alive:!0,name:l??m().A.formatMessage(x.view),format:{hide_linked_collection_name:!0,collection_pointer:r,collection_view_icon:v,...y?{property_filters:[{id:i().JW(),filter:{property:y,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}]}:{},subitem_display_mode:y?"disabled":void 0}};return p().applyOperation({store:a,operation:{pointer:a.pointer,path:["view_ids"],command:"listAfter",args:{id:h}},transaction:o}),u().eC({environment:t,table:c().Gy,value:C,inMemoryRecordCache:S,transaction:o}),{id:h,table:c().Gy,spaceId:a.getSpaceId()}}const x=(0,o(959013).YK)({view:{defaultMessage:"View",id:"pageLayout.viewsModuleActions.defaultViewName"}})},634339:(e,t,o)=>{"use strict";o.d(t,{_:()=>uf});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(498212),l=()=>o(989423),s=()=>o(508496);function c(e,t){l().vd(e,"view_settings",t),s().default.logEvent("view_settings",t.menu,t)}var d=()=>o(686526),u=()=>o(896628),p=()=>o(317909),g=()=>o(546754),m=()=>o(623580),f=()=>o(545805),y=(o(944114),o(581454),()=>o(244641)),S=()=>o(401497),h=()=>o(148307),v=()=>o(187174),x=()=>o(589982),C=()=>o(563884),b=()=>o(340498),w=o(474848);const j=(0,b().wt)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})}),A=(0,b().wt)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})});var _=()=>o(353731),M=()=>o(133033),k=()=>o(643381);const I=(0,b().wt)("rightArrowEmpty",{viewBox:"0 0 22 18",svg:(0,w.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var T=()=>o(420713),P=()=>o(735384),B=()=>o(959013),R=()=>o(284371),V=()=>o(901389),F=()=>o(781697),K=()=>o(735695),D=()=>o(497222),L=()=>o(916727),O=()=>o(66689),E=()=>o(799829),z=()=>o(179034),N=()=>o(950914),U=()=>o(919709),H=()=>o(973647),W=()=>o(534177),G=()=>o(450859),q=()=>o(42120),Y=()=>o(630116);var $=()=>o(760217),Q=()=>o(406699),Z=()=>o(187485),J=()=>o(928600),X=()=>o(939740),ee=()=>o(14235),te=()=>o(204063),oe=()=>o(89924),ne=()=>o(574036),ie=()=>o(96689),re=()=>o(854150),ae=()=>o(449506),le=()=>o(313892),se=()=>o(601734);const ce="https://www.notion.so/help/sprints",de=[1,2,3,4,5,6,7,8],ue={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},pe={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},ge=(0,B().YK)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),me={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:ge.completeSprintNextSprintActionMenuOptionText,selectedText:ge.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:ge.completeSprintBacklogActionMenuOptionText,selectedText:ge.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:ge.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:ge.completeSprintKeepInCurrentSprintActionSelectedText}};function fe(e){return(0,w.jsx)(B().sA,{...me[e.completeSprintAction].menuOptionText})}function ye(e){return(0,w.jsx)(B().sA,{...me[e.completeSprintAction].selectedText})}function Se(e){const{weekday:t}=e;return(0,w.jsx)(B().sA,{...ge.weekdayOption,values:{weekdayName:pe[t]}})}function he(e){return ue[e]}function ve(e){const{sprintDurationValue:t}=e;return(0,w.jsx)(B().sA,{...ge.durationMenuOptionText,values:{durationValue:ue[t].value}})}function xe(e){const{numOfSprintBoards:t}=e;return t>0?(0,w.jsx)(B().sA,{...ge.turnOffSprintsModalWithSprintBoardsDescription}):(0,w.jsx)(B().sA,{...ge.turnOffSprintsModalNoSprintBoardsDescription})}function Ce(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,w.jsx)(B().sA,{...ge.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,w.jsx)(B().sA,{...ge.manageSprintFromThisViewModalManualSprintCompletionDescription})}function be(e){const{collectionContextStore:t,collectionSettingsStore:o,from:a}=e,{sprintSettingsConfig:l,currentSprintDateRange:s,sprintSettingsPermissionsContext:c,sprintSettingsConfigUpdater:d,turnOffSprints:u,turnOnSprints:g,automaticSprintCompletionEnabled:m,canManageSprintFromThisView:f,manageSprintFromThisView:y}=function(e){var t;const{collectionContextStore:o,from:a}=e,l=(0,i().v3)(),s=(0,r().K8)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),c=(0,r().K8)((()=>null==s?void 0:s.permissionsContext),[s]),d=(0,r().K8)((()=>{var e;return Boolean(null==s||null===(e=s.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==s||null===(t=s.automationContext)||void 0===t?void 0:t.automationStore]),u=(0,r().K8)((()=>{var e;return o.collectionStore()===(null==s?void 0:s.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==O().Lu}),[o,null==s?void 0:s.taskCollectionStore]),[g,m]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(m(void 0),!s)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=s;if(!e||!t)return;const o=t.getSchema(),n=E().n$[O().av].current.reducer,i=await G().mA(l,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});H().Q.isFail(i)||m(i.value.blockIds[0])}()}),[l,s]);const f=(0,r().K8)((()=>{const e=null==s?void 0:s.sprintCollectionViewBlockStore;if(e&&g)return Y().Bv.createChildStore(e,{id:g,table:z().ev,spaceId:e.getSpaceId()})}),[g,null==s?void 0:s.sprintCollectionViewBlockStore]),y=(0,r().K8)((()=>{if(!f)return;const e=f.getPropertyValue(O().Hx.Dates);if(!e)return;const t=(0,U().Cok)(e)[0];return t&&"daterange"===t.type?t:void 0}),[f]),S=(0,r().K8)((()=>{var e,t,o;if(!s)return;const n=(null===(e=s.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??N().AL.actionConfig.complete_sprint_action,i=Boolean(null===(t=s.automationContext)||void 0===t?void 0:t.automationStore.isActive()),r=null===(o=s.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??N().AL.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??N().AL.recurrenceConfig.weekdays}}}),[s]),h=(0,r().K8)((()=>(0,W().O9)(f)&&(0,W().O9)(S)),[f,S]),v=n.useCallback((e=>{h&&p().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:l,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&q().e_({environment:l,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:f,newDuration:e})}})}),[h,f,l,s]),x=n.useCallback((e=>{h&&p().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:l,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&q().g4({environment:l,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:f,newWeekday:e})}})}),[h,f,l,s]),C=n.useCallback((e=>{h&&p().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:l,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&q().U2({environment:l,transaction:t,automationStore:s.automationContext.automationStore,actionStore:s.automationContext.automationActionStore,currentSprintBlockStore:f,newAutocompleteStatus:e})}})}),[h,f,l,s]),b=n.useCallback((e=>{h&&p().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:l,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&q().qy({transaction:t,actionStore:s.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[h,l,s]),w=n.useCallback((async()=>{await q().c({environment:l,collectionContextStore:o,from:a})}),[l,o,a]),j=n.useCallback((async e=>{s&&await q().eN({environment:l,collectionContextStore:o,sprintSettingsContext:s,sprintBoardViewBlockIds:e})}),[o,l,s]),A=n.useCallback((()=>{s&&q().Zk({environment:l,collectionContextStore:o,currentViewBlockStore:s.currentCollectionViewBlockStore,taskCollectionViewBlockStore:s.taskCollectionViewBlockStore})}),[o,l,s]);return{sprintSettingsConfig:S,sprintSettingsPermissionsContext:c,turnOnSprints:w,turnOffSprints:j,automaticSprintCompletionEnabled:d,canManageSprintFromThisView:u,currentSprintDateRange:y,manageSprintFromThisView:A,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:h,handleSprintDurationChange:v,handleSprintStartWeekdayChange:x,handleSprintAutoCompleteChange:C,handleSprintRemainingTasksBehaviorChange:b}}}({collectionContextStore:t,collectionSettingsStore:o,from:a});if(!c||!c.canEdit||!l)return null;let S;return S=c.sprintsEnabled?(0,w.jsx)(we,{...e,updateSprintSettingsConfig:d,onTurnOffSprints:u,automaticSprintCompletionEnabled:m,currentSprintDateRange:s,canManageSprintFromThisView:f,onManageSprintFromThisView:y,sprintSettingsConfig:l}):(0,w.jsx)(je,{...e,onTurnOnSprints:g}),S}function we(e){const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:n,canManageSprintFromThisView:i,updateSprintSettingsConfig:r,collectionContextStore:a,onTurnOffSprints:l,onManageSprintFromThisView:s}=e,c=Le(),d=[];return d.push((0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(oe().A,{topBorder:!0,disableMobileBorders:!0,children:[i&&(0,w.jsx)(Pe,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:s}),(0,w.jsx)(Te,{turnOffSprints:l,collectionContextStore:a})]},"turn-off-sprints-section"),(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Z().A,{href:ce,external:!0,children:(0,w.jsx)(D().A,{icon:M().$,iconStyle:c.icon,title:(0,w.jsx)(B().sA,{...ge.learnSprintsTitle}),isGray:!0})})})]})),(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{...ge.sprintsMenuTitle}),footer:d,children:[(0,w.jsx)(Ae,{automaticSprintCompletionEnabled:o,currentSprintDateRange:n}),(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(Re,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,w.jsx)(Ve,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,w.jsx)(Fe,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Be,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function je(e){const{onTurnOnSprints:t}=e,o=Le(),n=[];return n.push((0,w.jsx)(oe().A,{disableMobileBorders:!0,children:(0,w.jsx)("div",{style:o.buttonWrap,children:(0,w.jsx)(te().A,{style:o.button,onClick:async()=>{await t()},size:"lg",children:(0,w.jsx)(B().sA,{...ge.turnOnSprints})})})},"turn-on-sprints-section")),(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{...ge.setupSprintsTitle}),footer:n,children:(0,w.jsxs)(oe().A,{disableMobileBorders:!0,children:[(0,w.jsx)(_e,{}),(0,w.jsx)(Me,{}),(0,w.jsx)(ke,{})]})})}function Ae(e){const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,n=Le();if(!o)return null;const i=y().c9.fromISO(o.end_date).plus({days:1});return(0,w.jsx)(L().F,{style:n.sprintStartDateHeader,children:(0,w.jsxs)("div",{style:n.sprintStartDateHeaderWrap,children:[I(n.sprintStartDateHeaderIcon),(0,w.jsx)(De,{nextSprintStartDate:i,automaticSprintCompletionEnabled:t})]})})}function _e(){const e=Le();return(0,w.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,w.jsx)(B().sA,{...ge.setupSprintsCaption})})}function Me(){const e=Le();return(0,w.jsx)("div",{style:e.mediaWrap,children:(0,w.jsx)("img",{src:h().A.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function ke(){const e=Le(),t=t=>(0,w.jsx)("span",{style:e.boldText,children:t});return(0,w.jsxs)("div",{style:e.disclaimerWrap,children:[(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.setupSprintsTeamspaceStatement})}),(0,w.jsx)(Ie,{text:(0,w.jsx)(B().sA,{...ge.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:T().l}),(0,w.jsx)(Ie,{text:(0,w.jsx)(B().sA,{...ge.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:_().$})]})}function Ie(e){const{text:t,icon:o}=e,n=Le();return(0,w.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,w.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,w.jsx)("div",{children:t})]})}function Te(e){const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,i().v3)(),a=(0,r().K8)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:l}]=(0,v().Yb)((async()=>{if(null==a||!a.taskCollectionStore||null==a||!a.taskCollectionViewBlockStore)return;const e=await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await se().Aw.load(),a=i.getSpaceId(),l=i.getParentStore(),s=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=s&&(0,le().lS)(r(),s);if(!l||l.table!==ie().NX&&l.table!==z().ev&&l.table!==re().yK||!c)return;const d=await ae().callApi({eventName:"getSprintBoardViewBlocks",environment:o,data:{spaceId:a,taskCollectionId:n.id,parentId:l.id,parentTable:l.table}});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:a.taskCollectionStore,collectionViewBlockStore:a.taskCollectionViewBlockStore});return e}),[n,null==a?void 0:a.taskCollectionStore,null==a?void 0:a.taskCollectionViewBlockStore]),s=Le();return(0,w.jsx)(D().A,{icon:P().I,title:(0,w.jsx)(B().sA,{...ge.turnOffSprints}),isRed:!0,iconStyle:s.icon,onClick:()=>{V().ui({description:(0,w.jsx)(xe,{numOfSprintBoards:l?l.length:0}),message:(0,w.jsx)("div",{style:s.modalTitle,children:(0,w.jsx)(B().sA,{...ge.turnOffSprintsModalTitle})}),innerStyle:s.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,w.jsx)(B().sA,{...ge.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(l??[])}}]})}})}function Pe(e){const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=Le();return(0,w.jsx)(D().A,{icon:A,title:(0,w.jsx)(B().sA,{...ge.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{V().ui({description:(0,w.jsx)(Ce,{automaticSprintCompletionEnabled:t}),message:(0,w.jsx)("div",{style:n.modalTitle,children:(0,w.jsx)(B().sA,{...ge.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,w.jsx)(B().sA,{...ge.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function Be(e){const{onChange:t,sprintSettingsConfig:o}=e,n=Le();return(0,w.jsx)(ne().A,{title:(0,w.jsx)(B().sA,{...ge.automatedSprintsToggleTitle}),caption:(0,w.jsx)(B().sA,{...ge.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,k().l)(n.icon),shouldWrapCaption:!0})}function Re(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=he(o.recurrenceConfig.interval),r=de.map((e=>he(e)));return(0,w.jsx)(Ke,{title:(0,w.jsx)(B().sA,{...ge.duration}),right:(0,w.jsx)(ve,{sprintDurationValue:i.value}),icon:x().u,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,w.jsx)($().A,{...e,disabled:n,title:(0,w.jsx)(ve,{sprintDurationValue:o.value}),checkState:o.key===i.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function Ve(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,w.jsx)(Ke,{title:(0,w.jsx)(B().sA,{...ge.startOn}),icon:C().k,right:(0,w.jsx)(Se,{weekday:i}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,w.jsx)($().A,{...e,disabled:n,title:(0,w.jsx)(Se,{weekday:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Fe(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,w.jsx)(Ke,{title:(0,w.jsx)(B().sA,{...ge.incompleteTasks}),right:(0,w.jsx)(ye,{completeSprintAction:i}),icon:j,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,w.jsx)($().A,{...e,disabled:n,title:(0,w.jsx)(fe,{completeSprintAction:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Ke(e){const{getMenuItems:t}=e,o=(0,i().Y0)(),n=Le(),r=(0,F().e)({width:250});return(0,w.jsx)(Q().Ay,{popupType:o.isMobile?ee().nl.SlideUp:ee().nl.Popup,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,renderOrigin:t=>(0,w.jsx)(D().A,{...e,iconStyle:n.icon,...t}),render:e=>(0,w.jsx)(J().A,{...r,children:(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,sections:[{key:0,render:e=>(0,w.jsx)(oe().A,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function De(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,n=y().c9.local().startOf("day"),i=t.diff(n,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),a=e=>(0,w.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===i?(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.sprintStartDateToday,values:{time:a}})}):(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.sprintStartDateFuture,values:{time:a,days:i,formattedDate:r}})}):i<0?(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.sprintStartDateShouldStartPast,values:{time:a,days:Math.abs(i),formattedDate:r}})}):0===i?(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.sprintStartDateShouldStartToday,values:{time:a}})}):(0,w.jsx)("div",{children:(0,w.jsx)(B().sA,{...ge.sprintStartDateShouldStartFuture,values:{time:a,days:i,formattedDate:r}})})}function Le(){const e=(0,i().Y0)();return(0,S().IS)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?R().J.UISmall.mobile:R().J.UISmall.desktop,color:t.mediumTextColor,fontWeight:R().Wy.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?R().J.UIRegular.mobile:R().J.UIRegular.desktop,color:t.mediumTextColor,fontWeight:R().Wy.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.lightIconColor,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:R().Wy.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",border:`1px solid ${t.accentColors.washGlass[0]}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:R().Wy.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:R().Wy.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.mediumTextColor},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var Oe=()=>o(645873);const Ee=new(Oe().O2)("database-automations",(()=>Promise.all([o.e(23806),o.e(75134),o.e(43380),o.e(96346),o.e(62475),o.e(3151),o.e(98629),o.e(90409),o.e(74562),o.e(38664),o.e(24587),o.e(4422),o.e(59794),o.e(21627),o.e(75659),o.e(15724),o.e(28721),o.e(6463),o.e(26483),o.e(29333),o.e(89109),o.e(97996),o.e(7522),o.e(67832),o.e(79665)]).then(o.bind(o,470365)))),ze=(0,Oe()._h)(Ee,(e=>e.CollectionSettingsAutomationsView)),Ne=new(Oe().O2)("CollectionSettingsCustomizeMenu",(()=>o.e(66592).then(o.bind(o,23272)))),Ue=(0,Oe()._h)(Ne,(e=>e.CollectionSettingsCustomizeMenu)),He=new(Oe().O2)("CollectionSettingsCustomizeMenuPrototype",(()=>o.e(39778).then(o.bind(o,14192)))),We=(0,Oe()._h)(He,(e=>e.CollectionSettingsCustomizeMenuPrototype)),Ge=new(Oe().O2)("CustomizeMenuConnectionsSettings",(()=>o.e(91795).then(o.bind(o,655533)))),qe=(0,Oe()._h)(Ge,(e=>e.CustomizeMenuConnectionsSettings));var Ye=()=>o(753199),$e=()=>o(388487),Qe=()=>o(756279),Ze=()=>o(940371),Je=()=>o(988950),Xe=()=>o(541801),et=()=>o(204067),tt=()=>o(265793),ot=()=>o(939656),nt=(o(18107),o(967357),o(898992),o(354520),()=>o(908006)),it=()=>o(851979),rt=()=>o(987555),at=()=>o(738418),lt=()=>o(708830),st=()=>o(235191),ct=()=>o(60867),dt=()=>o(895876),ut=()=>o(519839),pt=()=>o(802790),gt=()=>o(125565),mt=()=>o(175116),ft=()=>o(873050);var yt=()=>o(405417),St=()=>o(760578),ht=()=>o(685889),vt=()=>o(463830),xt=()=>o(828973),Ct=()=>o(93549),bt=()=>o(807831),wt=()=>o(702796);function jt(e){const{propertyName:t,subitemsDisplayMode:o,inversePropertyName:n}=e,i=(0,S().IS)((e=>({togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",fontWeight:R().Wy.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}})),[]);return(0,w.jsx)(oe().A,{disableMobileBorders:!0,children:(0,w.jsx)("div",{style:i.togglePreviewOutsideBorder,children:(r=o,"disabled"===r?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(At,{isLast:!1,itemEmoji:It,title:n}),(0,w.jsx)(At,{isLast:!1,itemEmoji:Tt,title:t}),(0,w.jsx)(At,{isLast:!0,itemEmoji:Tt,title:t})]}):"flattened"===r?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(At,{isLast:!1,itemEmoji:It,title:n}),(0,w.jsx)(At,{isLast:!1,itemEmoji:Tt,title:t,right:(0,w.jsx)(kt,{parentPropertyName:n})}),(0,w.jsx)(At,{isLast:!0,itemEmoji:Tt,title:t,right:(0,w.jsx)(kt,{parentPropertyName:n})})]}):"hidden"===r?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(At,{isLast:!1,itemEmoji:It,title:n,right:(0,w.jsx)(Mt,{count:2})}),(0,w.jsx)(At,{isLast:!1,itemEmoji:Pt,title:n}),(0,w.jsx)(At,{isLast:!0,itemEmoji:Bt,title:n,right:(0,w.jsx)(Mt,{count:1})})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(At,{isLast:!1,itemEmoji:It,title:n,left:(0,w.jsx)(_t,{indented:!1})}),(0,w.jsx)(At,{isLast:!1,itemEmoji:Tt,title:t,left:(0,w.jsx)(_t,{indented:!0})}),(0,w.jsx)(At,{isLast:!0,itemEmoji:Tt,title:t,left:(0,w.jsx)(_t,{indented:!0})})]}))})});var r}function At(e){let{isLast:t,itemEmoji:o,title:n,left:i,right:r}=e;const a=(0,S().IS)((e=>({previewItem:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:t?void 0:`1px solid ${e.regularDividerColor}`}})),[t]);return(0,w.jsxs)("div",{style:a.previewItem,children:[i,(0,w.jsxs)("span",{style:{marginRight:"5px"},children:[" ",o]}),n,r]})}function _t(e){let{indented:t}=e;const o=(0,S().DP)();return(0,w.jsx)(wt().A,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:{color:o.regularIconColor,marginLeft:t?"24px":void 0,height:20},disabled:!0})}function Mt(e){let{count:t}=e;const o=(0,S().IS)((e=>({subitemCountIndicator:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},subitemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},innerText:{color:e.lightTextColor,fontWeight:R().Wy.medium,fontSize:R().J.UISmall.desktop}})),[]);return(0,w.jsxs)("span",{style:o.subitemCountIndicator,children:[(0,bt().V)(o.subitemIcon),(0,w.jsx)("span",{style:o.innerText,children:t})]})}function kt(e){let{parentPropertyName:t}=e;const o=(0,S().IS)((e=>({parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.lightTextColor,fontWeight:R().Wy.medium,fontSize:R().J.UISmall.desktop,whiteSpace:"nowrap"}})),[]);return(0,w.jsxs)("span",{style:o.parentWrapper,children:[(0,Ct().j)(o.parentItemIcon),(0,w.jsx)("span",{style:o.parentTitle,children:t})]})}const It="",Tt="",Pt="",Bt="";var Rt=()=>o(147361),Vt=()=>o(926203),Ft=()=>o(557336);function Kt(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:a,from:l}=e,s=(0,B().tz)(),c=(0,i().Y0)(),u=(0,r().O$)(t.normalizedSchemaStore),p=(0,r().K8)((()=>t.databaseType),[t]),g=(0,r().K8)((()=>t.collectionStore()),[t]),m=(0,Ft().lk)({collectionContextStore:t,feature:a}),f=null==m?void 0:m.property,y=(0,n.useMemo)((()=>ut().HG(u)),[u]),h=(0,r().O$)(t.permissionScopesStore),v=(0,r().K8)((()=>{var e;return f&&(null===(e=u[f])||void 0===e?void 0:e.name)}),[u,f]),x=(0,r().K8)((()=>t.collectionViewStore()),[t]),C=(0,r().K8)((()=>null==x?void 0:x.getFormat()),[x]),b=(null==C?void 0:C.subitem_display_mode)??"show",j=(0,r().K8)((()=>{const e=f&&u[f];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=u[o])||void 0===t?void 0:t.name:void 0}}),[f,u]),A=(0,r().K8)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?ht().zF(s,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:a}):s.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,s,a]),_=(0,r().K8)((()=>Boolean(g&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,W().O9)(i)||i===n}({collectionContextStore:t,collectionStore:g}))),[t,g]),M=(0,r().uB)(void 0,vt().A),k=(0,n.useCallback)((e=>{e&&M.setState({open:!1})}),[M]),{initialPropertyName:I}=(0,Ft().Me)({collectionContextStore:t,feature:a}),T=(0,Ft().Tv)({collectionContextStore:t,onPropertySelect:k,feature:a}),{handleAddRelation:P,handleDefaultPropertySelect:V,clearCollectionViewSubitemDisplayMode:F}=T,D=(0,S().IS)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:c.isMobile?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.mediumTextColor,fontWeight:R().Wy.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[c]);if(!g)return null;let L;if("subitem"===a)if(m)L=(0,w.jsxs)(oe().A,{disableMobileBorders:!0,children:[(0,w.jsx)("div",{style:D.subitemsPreviewContainer,children:(0,w.jsx)(jt,{propertyName:v||I,inversePropertyName:j||A,subitemsDisplayMode:b})}),(0,w.jsx)(Ht,{databaseType:p,permissionScopes:h}),(0,w.jsx)(pt().A,{size:12,style:{marginTop:4,marginBottom:4}}),(0,w.jsx)(Vt().Eg,{collectionSettingsStore:o,feature:a,permissionScopes:h}),(0,w.jsx)(Vt().Xm,{feature:a,databaseType:p,permissionScopes:h,propertyName:v,relationPropertyId:f,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:V,inversePropertyName:j,clearCollectionViewSubitemDisplayMode:F})]});else{const e=()=>{P({featureType:"subitem",from:l}),d().yl({collectionSettingsStore:o}),nt().default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,lt().Qe)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,yt().kY)(e);ct().QK({collectionContextStore:t,pathKey:o})}}))};L=(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(jt,{propertyName:v||I,inversePropertyName:j||A,subitemsDisplayMode:b}),(0,w.jsx)(Vt().pz,{feature:a,permissionScopes:h,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===a?L=m?(0,w.jsxs)(w.Fragment,{children:[_?(0,w.jsx)(Lt,{collectionContextStore:t,firstDatePropertyId:y,permissionScopes:h}):(0,w.jsx)(Dt,{collectionContextStore:t,databaseType:p}),(0,w.jsxs)(oe().A,{topBorder:!0,children:[(0,w.jsx)(Vt().Eg,{collectionSettingsStore:o,feature:a,permissionScopes:h}),(0,w.jsx)(Et,{feature:a,databaseType:p,featuredRelationProperty:m,actions:T,permissionScopes:h}),(0,w.jsx)(Vt().Xm,{feature:a,databaseType:p,permissionScopes:h,relationPropertyId:f,propertyName:v,inversePropertyName:j,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:V})]})]}):(0,w.jsx)(Ot,{databaseType:p,collectionContextStore:t,firstDatePropertyId:y,handleAddRelation:P,permissionScopes:h,from:l}):(0,W().HB)(a);const O=(0,St().mv)({feature:a,databaseType:p}),E=(0,St().I_)({feature:a,databaseType:p});return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{...O}),children:[(0,w.jsx)(oe().A,{disableMobileBorders:!0,children:(0,w.jsx)("div",{style:{...D.container,...D.captionText},children:(0,w.jsx)(B().sA,{...E})})}),L]})}function Dt(e){const{collectionContextStore:t,databaseType:o}=e,n=(0,i().WS)(),a=(0,S().IS)((e=>({wrap:{boxShadow:e.shadow2XS,...n?{backgroundColor:e.surface.wash,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[n]),l=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),s=(0,St().qC)({currentDateShiftConfig:l,databaseType:o});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{...St().Ic.dateShiftingSectionCaption}),children:(0,w.jsx)(Rt().r,{mode:null==l?void 0:l.mode})}),(0,w.jsx)(L().F,{style:a.wrap,showCloseButton:!1,children:(0,w.jsxs)("div",{style:a.iconWithMessage,children:[(0,at().G)(a.icon),(0,w.jsx)(gt().A,{isSmall:!0,isMultiline:!0,children:(0,w.jsx)(B().sA,{...s})})]})})]})}function Lt(e){const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:a}=e,l=(0,i().v3)(),s=(0,B().tz)(),c=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),d=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&p().createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:l,canUndo:!0,perform:t=>{(0,Vt().Wf)({collectionStore:o,environment:l,intl:s,newConfig:e,transaction:t})}})}),[t,l,s]),u=(0,n.useMemo)((()=>({configWithoutDates:c,...c?{datePropertyId:c.date_property,endDatePropertyId:c.end_date_property}:{datePropertyId:o}})),[c,o]);return(0,w.jsx)(Vt().aH,{collectionContextStore:t,currentConfig:u,disabled:!a.canConfigureBlock||!a.canConfigureCollection,onConfigChange:d})}function Ot(e){const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:a,databaseType:l,from:s}=e,[c,u]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:Vt().qd,avoid_weekends:Vt().$g}}),p=(0,r().K8)((()=>t.settingsStore),[t]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Vt().aH,{collectionContextStore:t,currentConfig:c,disabled:!a.canConfigureBlock||!a.canConfigureCollection,onConfigChange:u}),(0,w.jsx)(Vt().pz,{feature:"timeline_arrows_by",permissionScopes:a,databaseType:l,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:c,from:s}),d().yl({collectionSettingsStore:p})}})]})}function Et(e){const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:r,databaseType:a}=e,l=(0,i().Y0)(),s=(0,S().IS)((()=>({eyeHideIcon:{width:20,height:l.isMobile?24:12,marginLeft:3}})),[l]);if(!o.supportedInView)return null;const c=o.enabledOnView,d=o.isVisibleInView,u=d?{icon:rt().T,iconStyle:s.eyeHideIcon}:{icon:it().h};return(0,w.jsx)(D().A,{...u,onClick:()=>{n.handlePropertySelect(c?void 0:o.property)},title:(0,w.jsx)(B().sA,{...(0,St().WI)({feature:t,isOn:d,databaseType:a})}),disabled:!r.canConfigureBlock})}function zt(e){const{subitemDisplayMode:t,collectionViewType:o,intl:n,databaseType:i}=e;if("show"===t||void 0===t)switch(o){case"board":case"calendar":case"gallery":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"Card property"});case"table":case"list":case"timeline":case"page":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"});default:return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.default",defaultMessage:"Default view"})}else{if("hidden"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Parents only"},{items:(0,dt().oj)(i,!0)});if("flattened"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});if("disabled"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.disabled",defaultMessage:"Disabled"});(0,W().HB)(t)}}const Nt=["show","hidden","flattened","disabled"];function Ut(e){const{intl:t,collectionViewType:o,databaseType:n}=e;return Nt.map((e=>({key:e,type:"button",title:zt({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:n})})))}function Ht(e){const{databaseType:t,permissionScopes:o}=e,a=(0,B().tz)(),s=(0,mt().ET)(),c=(0,r().K8)((()=>s.collectionViewStore()),[s]),d=(0,r().K8)((()=>null==c?void 0:c.getFormat()),[c]),g=(null==d?void 0:d.subitem_display_mode)??"show",m="show"===g,f=(0,i().v3)(),y=n.useCallback((e=>{const t=s.getPropertyFormatKey(),o=(0,yt().r6)(s),n=null==o?void 0:o.property,i=null==o?void 0:o.inverse;c&&t&&n&&i&&e!==g&&p().createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:f,canUndo:!0,perform:o=>{const r=c.getType();if(("board"===r||"gallery"===r||"calendar"===r)&&st().a5({formatStore:c,formatKey:t,property:n,update:{visible:"show"===e},transaction:o}),"hidden"===g){var a;const e=null==d||null===(a=d.property_filters)||void 0===a?void 0:a.filter((e=>e.id!==ft().Oe));u().zA({stores:[c],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:i,filter:{operator:"is_empty"}},t=(null==d?void 0:d.property_filters)||[];u().zA({stores:[c],update:{property_filters:[...t,{id:ft().Oe,filter:e}]},transaction:o})}u().zA({stores:[c],update:{subitem_display_mode:e},transaction:o})}})}),[s,c,f,d,g]);(0,n.useEffect)((()=>{l().vd(f,"configure_subitem_display_mode",{userAction:m?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[m,f]);const S=(0,r().K8)((()=>(null==c?void 0:c.getType())??"table"),[c]);return"chart"===S||"form_editor"===S||"feed"===S||"map"===S||"chat"===S?(0,w.jsx)(w.Fragment,{}):(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Show as",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:s,selectedKey:g,options:Ut({collectionViewType:S,intl:a,databaseType:t}),onChange:e=>y(e),disabled:!o.canConfigureBlock})}const Wt={viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{d:"M3.25 13.165a.8.8 0 0 0 1.203.69l8.854-5.164a.8.8 0 0 0 0-1.382L4.453 2.144a.8.8 0 0 0-1.203.691z"})},Gt=(0,b().wt)("arrowCaretRightFillSmall",Wt);var qt=()=>o(436696),Yt=()=>o(4319),$t=()=>o(946548),Qt=()=>o(878665);const Zt="box1-filter",Jt="box2-filter";function Xt(e){const{propertyName:t,inversePropertyName:o}=e,n=(0,S().DP)(),i=(0,S().IS)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,w.jsx)(oe().A,{disableMobileBorders:!0,children:(0,w.jsx)("div",{style:i.svgWrap,children:(0,w.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,w.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,w.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,w.jsx)("path",{fill:n.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,w.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,w.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,w.jsxs)("g",{filter:`url(#${Zt})`,children:[(0,w.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,w.jsx)("text",{x:"67",y:"31",fill:"#000",children:""})]}),(0,w.jsxs)("g",{filter:`url(#${Jt})`,children:[(0,w.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,w.jsx)("text",{x:"185",y:"95",fill:"#000",children:""})]}),(0,w.jsx)(eo,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.regularTextColor},children:t}),(0,w.jsx)(eo,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,w.jsxs)("defs",{children:[(0,w.jsxs)("filter",{id:Zt,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,w.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,w.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,w.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,w.jsx)("feOffset",{}),(0,w.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,w.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,w.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,w.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,w.jsx)("feOffset",{dy:"2"}),(0,w.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,w.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,w.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,w.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,w.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,w.jsxs)("filter",{id:Jt,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,w.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,w.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,w.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,w.jsx)("feOffset",{}),(0,w.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,w.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,w.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,w.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,w.jsx)("feOffset",{dy:"2"}),(0,w.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,w.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,w.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,w.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,w.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function eo(e){const{children:t,textStyles:o,...n}=e;return(0,w.jsx)("foreignObject",{...n,children:(0,w.jsx)("div",{style:{...R().RC,...n.width?{width:Number(n.width)}:{},...o},children:t})})}var to=()=>o(554840);function oo(e){var t;const{collectionContextStore:o,feature:i}=e,a=(0,B().tz)(),l=(0,r().K8)((()=>o.collectionStore()),[o]),s=(0,r().O$)(o.normalizedSchemaStore),c=(0,r().O$)(o.permissionScopesStore),d=null===(t=(0,Ft().lk)({collectionContextStore:o,feature:i}))||void 0===t?void 0:t.property,u=(0,r().K8)((()=>{var e;return d&&(null===(e=s[d])||void 0===e?void 0:e.name)}),[d,s]),p=(0,r().K8)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),g=(0,r().K8)((()=>{const e=d&&s[d];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=s[o])||void 0===t?void 0:t.name:void 0}}),[d,s]),m=(0,r().K8)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?ht().zF(a,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):a.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,a,i]),f=(0,r().uB)(void 0,vt().A),{initialPropertyName:y}=(0,Ft().Me)({collectionContextStore:o,feature:i}),h=(0,n.useCallback)((e=>{e&&f.setState({open:!1})}),[f]),v=(0,S().IS)((()=>({previewContainer:{marginLeft:2}})),[]);if(!l)return null;let x;return"subitem"===i?x=(0,w.jsx)(jt,{propertyName:u||y,inversePropertyName:g||m,subitemsDisplayMode:"show"}):"timeline_arrows_by"===i?x=(0,w.jsx)(Xt,{propertyName:u||y,inversePropertyName:g||m}):(0,W().HB)(i),(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{...St().Ic.advancedSettings}),children:[(0,w.jsx)("div",{style:v.previewContainer,children:x}),(0,w.jsxs)(oe().A,{disableMobileBorders:!0,children:[(0,w.jsx)(to().a,{currentPropertyId:d,feature:i,onPropertySelect:h,buttonPopupStore:f,collectionContextStore:o,permissionScopes:c,disabled:!c.canConfigureCollection}),"subitem"===i&&p&&(0,w.jsx)(no,{collectionContextStore:o,permissionScopes:c})]})]})}function no(e){const{collectionContextStore:t,permissionScopes:o}=e,a=(0,B().tz)(),l=(0,i().v3)(),s=(0,r().K8)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),c=!o.canConfigureBlock,d=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(Yt().jP({environment:l,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),(0,qt().X)({environment:l,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,l]);return(0,w.jsx)(Qt().A,{showImage:o.canConfigureBlock,caption:a.formatMessage(St().Ic.toggleNestingOnTitleMenuItemTooltip),tooltipImage:h().A.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,w.jsx)(D().A,{...e,icon:()=>Gt({width:b().Ev.sm,height:b().Ev.sm,marginLeft:4,marginRight:2}),onClick:d,title:(0,w.jsx)(B().sA,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,w.jsx)($t().A,{disallowTabbing:!0,on:s,disabled:c,onClick:d}),disabled:c})})}var io=()=>o(689094),ro=()=>o(510683),ao=()=>o(859428),lo=()=>o(553965),so=()=>o(962730),co=()=>o(53137);function uo(e){const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:a}=e,l=(0,S().IS)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),u=(0,r().K8)((()=>{const e=co().A.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&c?(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:po({environment:s,integration:t,spaceId:c}),children:(0,w.jsx)("div",{style:l.settingsMenu,children:(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:u.map((e=>{const n={key:e.id,render:o=>(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)("span",{children:e.account_name}),placement:so().W.Left,textWrap:!0,render:n=>(0,w.jsx)($().A,{...(0,lo().A)(n||{},o),title:e.account_name,icon:(0,w.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{d().yl({collectionSettingsStore:o}),a(e)}};return n})),render:e=>(0,w.jsx)(oe().A,{...e})}]})})}):null}function po(e){const t=e.environment.device.isMobileBrowser;return(0,w.jsx)(oe().A,{topBorder:!0,children:t?void 0:go(e)})}function go(e){return(0,w.jsx)(D().A,{...e,icon:io().W,title:(0,w.jsx)(B().sA,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await ro().Jq({...e,from:"source_picker_connect_another_account"})}})}o(823215),o(737550);var mo=()=>o(970013),fo=()=>o(743176),yo=()=>o(857639),So=()=>o(467730),ho=()=>o(803074),vo=()=>o(625830),xo=()=>o(419357),Co=()=>o(710149),bo=()=>o(972435),wo=(o(16280),o(672577),()=>o(617871)),jo=(o(803949),()=>o(638681)),Ao=()=>o(527328);const _o={name:"User",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/User\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notion.lightning.force.com/lightning/r/User/0055b00000MWTaJAAX/view","https://notion.lightning.force.com/lightning/r/user/0055b00000MWTaJAAX/view"],additional_types:{connectedRelation:!0},attributes:Ao().eV.attributes,connected_relation_properties:{title:{name:"Name",type:"title"},Id:{name:"Id",type:"text"},CreatedDate:{name:"Created Date",type:"date"},LastModifiedDate:{name:"Last Modified Date",type:"date"},Email:{name:"Email",type:"email"},SmallPhotoUrl:{name:"Avatar URL",type:"url"},NotionUser:{name:"Notion User",type:"relation",uri:"notion://user-defined-collection/salesforce:User"}},connected_relation_sub_schemas:{"notion://user-defined-collection/salesforce:User":{title:{name:"Name",type:"title"}}}},Mo={name:"Report",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Report\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view","https://notionlabs-abc-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view?queryParamsAny=test"],attributes:Ao().eV.attributes},ko=[{name:"Account",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Account\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004euUDAAY/view"],attributes:Ao().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Ao().eV.connected_relation_properties,Type:{name:"Type",type:"text"},AccountNumber:{name:"Account Number",type:"text"},AnnualRevenue:{name:"Annual Revenue",type:"number"},Website:{name:"Website",type:"url"},Phone:{name:"Phone",type:"phone_number"},Description:{name:"Description",type:"text"},ParentId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Parent Account",type:"relation"},OwnerId:{uri:"notion://user-defined-collection/salesforce:User",name:"Account Owner",type:"relation"},mapped_OwnerId:{name:"Mapped Account Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Ao().eV.connected_relation_sub_schemas},{name:"Contact",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Contact\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004euUDAAY/view"],attributes:Ao().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Ao().eV.connected_relation_properties,Phone:{name:"Phone",type:"phone_number"},Email:{name:"Email",type:"email"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"}},connected_relation_sub_schemas:Ao().eV.connected_relation_sub_schemas},{name:"Opportunity",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Opportunity\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004euUDAAY/view"],attributes:Ao().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Ao().eV.connected_relation_properties,Amount:{name:"Amount",type:"number"},CloseDate:{name:"Close Date",type:"date"},StageName:{name:"Stage",type:"text"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"},OwnerId:{name:"Owner",uri:"notion://user-defined-collection/salesforce:User",type:"relation"},mapped_OwnerId:{name:"Mapped Opportunity Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Ao().eV.connected_relation_sub_schemas},_o],Io=(Ao().eV,ko.map((e=>({name:e.name,additional_types:e.additional_types,connected_relation_properties:e.connected_relation_properties,connected_relation_sub_schemas:e.connected_relation_sub_schemas}))),jo().string());jo().object({required:{Name:jo().string(),Id:Io,CreatedById:Io},optional:{UserName:jo().string(),SmallPhotoUrl:jo().nullable(jo().string()),Alias:jo().nullable(jo().string()),Email:jo().nullable(jo().string()),IsActive:jo().boolean(),ProfileId:jo().nullable(Io),UserType:jo().nullable(jo().string())}}),jo().union([jo().object({required:{scope:jo().string(),signature:jo().string(),access_token:jo().string(),refresh_token:jo().string(),instance_url:jo().string(),id:jo().string(),token_type:jo().string(),issued_at:jo().string()},optional:{id_token:jo().string(),refresh_token:jo().string(),state:jo().string()}})]),jo().object({required:{sub:jo().string(),user_id:jo().string(),organization_id:jo().string(),preferred_username:jo().string(),name:jo().string(),email:jo().string()},optional:{nickname:jo().string(),email_verified:jo().boolean(),given_name:jo().string(),family_name:jo().string(),zoneinfo:jo().string(),photos:jo().object({optional:{},required:{picture:jo().string(),thumbnail:jo().string()}}),profile:jo().string(),picture:jo().string(),address:jo().object({optional:{country:jo().string()},required:{}}),urls:jo().record(jo().string(),jo().string()),active:jo().boolean(),user_type:jo().string(),language:jo().string(),locale:jo().string(),utcOffset:jo().number(),updated_at:jo().string()}});var To=()=>o(583835);const Po=(0,To().Dv)("updateConnectedRelationFieldSelection");var Bo=()=>o(36629),Ro=()=>o(357625),Vo=()=>o(543665);const Fo=(0,B().YK)({updateConnectedRelationFieldSelectionFailed:{defaultMessage:"Failed to update field selection",id:"ConnectedRelationActionsAddProperties.updateConnectedRelationFieldSelectionFailed"}});async function Ko(e){var t,o;const{environment:n,objectName:i,objectLabel:r,collectionContextStore:a,intl:s}=e,c=co().A.state;if(!c.loaded)return[];const d=null==a||null===(t=a.collectionStore())||void 0===t?void 0:t.getSpaceId();if(!d)return;const u=null==a||null===(o=a.collectionStore())||void 0===o?void 0:o.getSpacePointer();yo().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Received request to create Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:d,collectionPointer:u}}});const p=c.integrations.find((e=>e.id===wo().mn));if(!p)return;const g=co().A.bots.state.find((e=>e.integration_id===wo().mn));if(!g)return;const m=g.id,f=await ae().callApi({eventName:"describeSalesforceObject",environment:n,data:{spaceId:d,objectName:i,botId:m}});if("success"!==(null==f?void 0:f.type))return yo().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Describe Salesforce object failed while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:d,collectionPointer:u,error:f.error}}}),void(0,l().u4)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:wo().mn,actionType:"create_connected_relation_property",status:"failed"}}});const y=function(e){const{describeObjectResponse:t,objectName:o}=e;let n={},i={};return t.forEach((e=>{if("Name"!==e.name){if("created_by"!==e.type&&"last_edited_by"!==e.type&&"created_time"!==e.type&&"last_edited_time"!==e.type&&"rollup"!==e.type&&"formula"!==e.type)if("relation"===e.type){if(e.referenceTo){const t=e.referenceTo;n[e.name]={name:e.label,type:e.type,uri:`notion://user-defined-collection/salesforce:${t}`},i[`notion://user-defined-collection/salesforce:${t}`]={title:{name:e.label,type:"title"}}}}else if("select"===e.type||"multi_select"===e.type){var t;n[e.name]={name:e.label,type:e.type,options:null===(t=e.picklistValues)||void 0===t?void 0:t.map((e=>({id:e.label,value:e.value})))}}else"person"===e.type?n[e.name]={name:e.label,type:e.type,uri:"notion://user-defined-collection/salesforce:User",source_property_id:"Email"}:n[e.name]={name:e.label,type:e.type}}else n.title={name:e.label,type:"title"}})),n={...Ao().eV.connected_relation_properties,...n},i={...Ao().eV.connected_relation_sub_schemas,...i},{value:{name:o,regex:(0,Ao().fh)(o),attributes:Ao().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:n,connected_relation_sub_schemas:i}}}({describeObjectResponse:f.data.properties,objectName:i});if(H().Q.isFail(y))return yo().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Failed to get connected relation pattern while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:d,collectionPointer:u,error:y.error}}}),(0,l().u4)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:wo().mn,actionType:"create_connected_relation_property",status:"failed"}}}),{error:new Error(y.error)};const S={name:`${p.name} ${r}`,pattern:y.value,integration:p};await Bo().XO({environment:n,connectedRelationProperty:S,collectionContextStore:a,intl:s,from:"new_property",propertyGroupId:void 0,propertyLimit:"no_limit"}),yo().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Successfully created Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:d,collectionPointer:u}}}),(0,l().u4)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:wo().mn,actionType:"create_connected_relation_property",status:"success"}}})}var Do=()=>o(346615),Lo=()=>o(704152),Oo=()=>o(493823),Eo=()=>o(331542),zo=()=>o(673730);function No(e){const{title:t,items:o,handleSelect:r,isSelectAll:a,sectionCallout:l,selectAllTooltipContent:s,isSectionItemsLoading:c}=e,[d,u]=n.useState(!0),{isMobile:p}=(0,i().Y0)(),g=e.disableCollapse??!1,m=(0,S().IS)((e=>({sectionMargin:{margin:"0px 14px"},sectionTitleContainer:{display:"flex",padding:2,borderRadius:6,gap:2,alignItems:"center"},sectionMenuDesktopTitleStyle:{padding:0,margin:0,alignItems:"center"},arrow:{width:p?14:12,height:p?14:12,transition:"transform 200ms ease-out",transform:`rotateZ(${d?0:-90}deg)`,fill:"inherit",opacity:1,marginTop:2},menuList:{paddingTop:0,paddingBottom:0}})),[p,d]);return o.length?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{style:{...m.sectionMargin},desktopTitleStyle:m.sectionMenuDesktopTitleStyle,title:(0,w.jsxs)(Lo().A,{style:m.sectionTitleContainer,onClick:()=>u(!d),disabled:g,children:[t,!g&&(0,Do().p)(m.arrow),c&&(0,w.jsx)(Eo().A,{style:{alignSelf:"right"}})]}),right:o.length&&d&&!c&&(0,w.jsx)(ao().A,{renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:s}),render:e=>(0,w.jsx)("div",{...e,children:(0,w.jsx)(Uo,{onClick:r,isSelectAll:a})}),disableTooltip:!s})}),d&&(0,w.jsxs)(w.Fragment,{children:[l,(0,w.jsx)(X().Ay,{style:m.menuList,type:X().Oh.Vertical,initialFocus:0,sections:[{key:"collapsableSectionMenuList",render:e=>(0,w.jsx)(oe().A,{topBorder:!1,...e}),items:o}]})]})]}):(0,w.jsx)(w.Fragment,{})}function Uo(e){return(0,w.jsx)(Oo().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:R().J.UISmall.desktop,height:"fit-content"},onClick:e.onClick,children:e.isSelectAll?(0,w.jsx)(B().sA,{id:"database.viewSettings.collapsableSection.selectAll",defaultMessage:"Select all"}):(0,w.jsx)(B().sA,{id:"database.viewSettings.collapsableSection.unselectAll",defaultMessage:"Unselect all"})})}const Ho=(0,B().YK)({inputPlaceholder:{defaultMessage:"Search property",id:"database.viewSettings.ConnectedRelationActionsAddProperties.inputPlaceholder"},addColumn:{defaultMessage:"Add properties",id:"database.viewSettings.ConnectedRelationActionsAddProperties.addColumn"},updateConnectedRelationFieldSelectionFailed:{defaultMessage:"Failed to update field selection",id:"ConnectedRelationActionsAddProperties.updateConnectedRelationFieldSelectionFailed"}});function Wo(e){const{collectionSettingsStore:t,collectionContextStore:o,rootPropertySchema:a,rootPropertyId:c,integrationId:u}=e,[g,m]=n.useState(""),[f,y]=n.useState([]),h=(0,r().K8)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),x=(0,S().DP)(),C=(0,i().v3)(),b=(0,S().IS)((e=>({buttonWrapper:{borderColor:"none",padding:8},button:{width:"100%",border:"none",fontWeight:R().Wy.medium},shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),[{status:j,value:A}]=(0,v().Yb)((async()=>{var e;if(!h)return;if(!a||!(0,mo().UU)(a))return;const t=null==a?void 0:a.collection_pointer;if(!t)return;const n=new(Vo().m)(C,t);await n.load();const i=null==n||null===(e=n.getFormat())||void 0===e?void 0:e.pattern_name;if(!i)return;const r=await ho().Nf({environment:C,integrationId:u,connectedRelationPatternName:i,spaceId:h}),l=o.collectionStore();if(l&&r){const e=Go({collectionStore:l,rootPropertyId:c}).map((e=>e.attributeName));return r.map((t=>({...t,isSelected:!!e.includes(t.id)})))}}),[C,h,u,a,o,c]);(0,n.useEffect)((()=>{"resolved"===j&&A&&y(A)}),[j,A]);const _=f.length?(0,So().Ay)(g,f,(e=>e.name)):[],M=e=>{y(f.map((t=>t.id===e.id?{id:e.id,name:e.name,isSelected:!e.isSelected,type:e.type,metadata:e.metadata}:t)))},k=_.filter((e=>!e.metadata.custom)).map((e=>({key:e.id,render:()=>(0,w.jsx)($().A,{focused:!1,style:{},onClick:()=>{M(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,checked:e.isSelected,onClick:()=>{M(e)},style:{borderRadius:2}})}),icon:(0,w.jsx)(fo().Ay,{type:e.type??"text",icon:void 0,size:16,theme:x})}),action:()=>{}}))),I=_.filter((e=>e.metadata.custom)).map((e=>({key:e.id,render:()=>(0,w.jsx)($().A,{focused:!1,style:{},onClick:()=>{M(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,checked:e.isSelected,onClick:()=>{M(e)},style:{borderRadius:2}})}),icon:(0,w.jsx)(fo().Ay,{type:e.type??"text",icon:void 0,size:16,theme:x})}),action:()=>{}})));return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Add properties",id:"ConnectedRelationActionsAddProperties.titleForSelectPropertiesTab"}),header:(0,w.jsx)(qo,{inputValue:g,integrationName:"Salesforce",onChange:m}),footer:"resolved"===j&&(0,w.jsx)("div",{style:b.buttonWrapper,children:(0,w.jsx)(te().A,{style:b.button,onClick:async e=>{e.stopPropagation(),await async function(e){var t;const{environment:o,collectionContextStore:n,allProperties:i,rootPropertyId:r,integrationId:a,rootPropertySchema:c}=e,d=n.collectionStore();if(!d)return;const u=n.collectionViewStore(),g=n.getPropertyFormatKey();if(!g)return;if(!c||!(0,mo().UU)(c))return;const m=i.filter((e=>e.isSelected)),f=Go({collectionStore:d,rootPropertyId:r}),y=f.map((e=>e.attributeName)),S=m.filter((e=>!y.includes(e.id))),h=f.filter((e=>!m.some((t=>t.id===e.attributeName))));(S.length||h.length)&&p().createAndCommit({userAction:"CollectionSettingsConnectedRelationActionsAddProperties",environment:o,canUndo:!0,perform:e=>{if(S.length&&st().UM({environment:o,collectionStore:d,transaction:e,propertiesToBeAdded:S,collectionViewArgs:u?{collectionViewStore:u,format:u.getFormat(),formatKey:g}:void 0,rootPropertyId:r}),h.length){const t=d.getSchema();for(const n of h)st().BJ({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:d,schema:t,property:n.id})}}});await async function(e){const{environment:t,collectionStore:o,propertiesToBeAdded:n,integrationId:i,rootPropertySchema:r}=e,a=r.collection_pointer;if(a&&i===wo().mn){const e=s().default.checkGate({gateName:"salesforce_caching"});if(n.length&&e){var l;const e=co().A.bots.state.find((e=>e.integration_id===i));if(!e)return;const r=new(Vo().m)(t,a);await r.load();const s=null===(l=r.getFormat())||void 0===l?void 0:l.pattern_name;if(!s)return;const c={};for(const t of n)c[t.metadata.name]=t.metadata;const d=(0,Ro().UT)(t,Po,{spaceId:o.getSpaceId(),botId:e.id,integrationId:i,key:null==s?void 0:s.toLowerCase(),metadata:c});if(d)for await(const t of d)"in_progress"!==t.taskStatus&&(t.taskStatus,"failure"!==t.taskStatus&&"dead"!==t.taskStatus&&"timeout_before_execution"!==t.taskStatus&&"retryable_failure"!==t.taskStatus||t.error&&V().f1(bo().A.formatMessage(Fo.updateConnectedRelationFieldSelectionFailed)))}}}({environment:o,collectionStore:d,propertiesToBeAdded:S,rootPropertyId:r,integrationId:a,rootPropertySchema:c}),yo().log({level:"info",from:"ConnectedRelationActionsAddProperties",type:"updateCollectionSchema",data:{miscDataToConvertToString:{propertiesToBeAddedCount:S.length,propertiesToBeDeletedCount:h.length,collectionPointer:null===(t=n.collectionStore())||void 0===t?void 0:t.getSpacePointer(),rootPropertyId:r,totalProperties:i.length}}}),(0,l().u4)({environment:o,event:{eventName:"salesforce_actions",eventProperties:{integrationId:a,actionType:"added_properties_for_connected_relation"}}})}({environment:C,collectionContextStore:o,allProperties:f,rootPropertyId:c,integrationId:u,rootPropertySchema:a}),d().os({collectionSettingsStore:t})},children:bo().A.formatMessage(Ho.addColumn)})}),handleClose:()=>{d().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:(0,w.jsxs)(w.Fragment,{children:["pending"===j&&(0,w.jsx)("div",{children:(0,w.jsx)("div",{children:[64,51,73,95,45,67,45,91,52].map(((e,t)=>(0,w.jsxs)("div",{style:{...b.shimmerRow},children:[(0,w.jsx)(Co().A,{style:{...b.leftShimmer}}),(0,w.jsx)(Co().A,{style:{...b.rightShimmer,width:e}})]},t)))})}),"resolved"===j&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{propertyCount, plural, one {{propertyCount} standard property} other {{propertyCount} standard properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.standardPropertiesTitle",values:{propertyCount:f.filter((e=>!e.metadata.custom)).length}}),isSelectAll:!f.filter((e=>!e.metadata.custom)).every((e=>e.isSelected)),items:k,handleSelect:()=>{f.filter((e=>!e.metadata.custom)).every((e=>e.isSelected))?y(f.map((e=>e.metadata.custom?e:{...e,isSelected:!1}))):y(f.map((e=>e.metadata.custom?e:{...e,isSelected:!0})))}},"Standard Properties"),(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{propertyCount, plural, one {{propertyCount} custom property} other {{propertyCount} custom properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.OptionalPropertiesTitle",values:{propertyCount:f.filter((e=>e.metadata.custom)).length}}),isSelectAll:!f.filter((e=>e.metadata.custom)).every((e=>e.isSelected)),items:I,handleSelect:()=>{f.filter((e=>e.metadata.custom)).every((e=>e.isSelected))?y(f.map((e=>e.metadata.custom?{...e,isSelected:!1}:e))):y(f.map((e=>e.metadata.custom?{...e,isSelected:!0}:e)))}},"Optional Properties")]})]})})}function Go(e){const{collectionStore:t,rootPropertyId:o}=e,n=t.getSchema(),i=[];for(const c in n){var r;if("rollup"===(null===(r=n[c])||void 0===r?void 0:r.type)){var a,l;if((null===(a=n[c])||void 0===a?void 0:a.relation_property)===o)i.push({id:c,attributeName:null===(l=n[c])||void 0===l||null===(l=l.target_property)||void 0===l?void 0:l.trim()})}else{var s;const e=null===(s=n[c])||void 0===s?void 0:s.derived_property_record_metadata;(null==e?void 0:e.pointer_property_uri)===o&&i.push({id:c,attributeName:null==e?void 0:e.external_object_attribute})}}return i}function qo(e){const{isMobile:t}=(0,i().Y0)();return(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(gt().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?R().J.UISmall.mobile:R().J.UISmall.desktop},children:(0,w.jsx)(B().sA,{defaultMessage:"Add {integrationName} properties as a column directly to this database.",id:"database.viewSettings.ConnectedRelationActionsAddProperties.description",values:{integrationName:e.integrationName}})}),(0,w.jsx)(xo().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:bo().A.formatMessage(Ho.inputPlaceholder)})]})}const Yo=(0,To().Dv)("bulkCreateConnectedProperty"),$o=(0,B().YK)({copyUrlDescription:{defaultMessage:"Content will be copied and any Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.copyUrlDescription"},copyColumn:{defaultMessage:"Copy column",id:"ConnectedRelationActionsCopyUrl.copyColumn"},SalesforceBulkCreateConnectedPropertyFailed:{defaultMessage:"Failed to copy column",id:"ConnectedRelationActionsCopyUrl.SalesforceBulkCreateConnectedPropertyFailed"}});function Qo(e){const{collectionSettingsStore:t,collectionContextStore:o,integrationId:a}=e,[l,s]=(0,n.useState)(null),c=(0,i().v3)(),u=(0,r().K8)((()=>{var e;const t=null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema();if(!t)return[];const n=[];for(const[o,i]of Object.entries(t)){i&&"url"===i.type&&n.push({id:o,...i})}return n}),[o]);(0,n.useEffect)((()=>{var e;s((null===(e=u[0])||void 0===e?void 0:e.id)||null)}),[u]);const p=(0,S().IS)((e=>({buttonWrapper:{borderColor:"none",padding:8},button:{width:"100%",border:"none",fontWeight:R().Wy.medium},addDivider:{borderColor:e.tableDividerColor}})),[]);return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Copy URL",id:"ConnectedRelationActionsCopyUrl.titleForCopyUrlTab"}),header:(0,w.jsx)(Jo,{}),handleClose:()=>{d().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"What to copy?",id:"ConnectedRelationActionsCopyUrl.whatToCopy"}),selectedKey:l||"select",popupStyle:{minWidth:190},options:[...null==u?void 0:u.map((e=>e?{key:e.id,type:"button",title:e.name}:void 0)).filter((e=>void 0!==e))],onChange:e=>{s(e)}}),(0,w.jsx)("div",{style:p.buttonWrapper,children:(0,w.jsx)(te().A,{style:p.button,onClick:async n=>{n.stopPropagation(),d().os({collectionSettingsStore:t});const i=co().A.bots.state.find((e=>e.integration_id===a));if(!i)return;const r=i.id,s=o.collectionStore(),u=l&&s?(0,Ro().UT)(c,Yo,{spaceId:s.getSpaceId(),botId:r,collectionId:s.id,integrationId:e.integrationId,sourceColumnId:l,destinationColumnId:e.property}):null;if(u)for await(const e of u)"in_progress"!==e.taskStatus&&(e.taskStatus,"failure"!==e.taskStatus&&"dead"!==e.taskStatus&&"timeout_before_execution"!==e.taskStatus&&"retryable_failure"!==e.taskStatus||e.error&&V().f1(bo().A.formatMessage($o.SalesforceBulkCreateConnectedPropertyFailed)))},children:bo().A.formatMessage($o.copyColumn)})}),(0,w.jsx)(pt().A,{size:"100%",innerStyle:{borderColor:p.addDivider.borderColor}}),(0,w.jsx)(Zo,{})]})})}function Zo(){const e=(0,B().tz)(),{isMobile:t}=(0,i().Y0)(),o=(0,S().IS)((e=>({previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:t?18:10,fontSize:t?16:12,color:e.lightTextColor}})),[t]);return(0,w.jsxs)(oe().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,children:[(0,w.jsxs)("div",{style:o.tabDescription,children:[" ","Preview"]}),(0,w.jsx)("div",{children:(0,w.jsx)("img",{src:h().A.images.externalIntegrations.salesforceCopyUrlPng,style:o.previewContentContainer,alt:"Salesforce Copy URL"})}),(0,w.jsx)("div",{style:o.tabDescription,children:e.formatMessage($o.copyUrlDescription)})]})}function Jo(e){const{isMobile:t}=(0,i().Y0)();return(0,w.jsx)(oe().A,{children:(0,w.jsx)(gt().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?R().J.UISmall.mobile:R().J.UISmall.desktop},children:(0,w.jsx)(B().sA,{defaultMessage:"Select the column you wish to copy and auto-populate this property.\nCopying URL from column will override all existing Salesforce URLs.",id:"database.viewSettings.ConnectedRelationActionsCopyUrl.description"})})})}o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698);const Xo=(0,B().YK)({inputPlaceholder:{defaultMessage:"Search object",id:"database.viewSettings.ConnectedRelationActionsObjectSelection.inputPlaceholder"}});function en(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,[a,l]=n.useState(""),s=(0,i().v3)(),c=(0,B().tz)(),u=(0,S().DP)(),p=(0,r().K8)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),g=(0,r().K8)((()=>{const e=co().A.state;if(!e.loaded)return;const t=e.integrations.find((e=>e.id===wo().mn));return t?t.info.icon:void 0}),[]),m=(0,S().IS)((e=>({shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),[{status:f,value:y}]=(0,v().Yb)((async()=>{if(!p)return;const e=await async function(e){var t;const{environment:o,spaceId:n}=e,i=co().A.bots.state.find((e=>e.integration_id===wo().mn));if(!i)return;const r=i.id,a=await ae().callApi({eventName:"listSalesforceObjects",environment:o,data:{spaceId:n,botId:r}});return"success"===(null==a?void 0:a.type)?null==a||null===(t=a.data)||void 0===t?void 0:t.sObjects:void 0}({environment:s,spaceId:p});return e&&e.length>0?e.map((e=>({name:e.name,label:e.label}))):void 0}),[p,s]),[{status:h,value:x}]=(0,v().Yb)((async()=>{var e;const t=null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema(),n=new Set;if(t){const e=Object.values(t);for(const t of e){var i;if(t&&(0,mo().UU)(t)&&(null===(i=t.connectedRelation)||void 0===i?void 0:i.integration_id)===wo().mn){var r;const e=t.collection_pointer;if(!e)continue;const o=new(Vo().m)(s,e);await o.load();const i=null==o||null===(r=o.getFormat())||void 0===r?void 0:r.pattern_name;i&&n.add(i)}}}return n}),[s,o]);return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Salesforce",id:"ConnectedRelationActionsObjectSelection.titleForSelectPropertiesTab"}),header:(0,w.jsx)(tn,{inputValue:a,integrationName:"Salesforce",onChange:l}),handleClose:()=>{d().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:[("pending"===f||"pending"===h)&&(0,w.jsx)("div",{children:(0,w.jsx)("div",{children:[64,51,73,95,45,67,45,91,52].map(((e,t)=>(0,w.jsxs)("div",{style:{...m.shimmerRow},children:[(0,w.jsx)(Co().A,{style:{...m.leftShimmer}}),(0,w.jsx)(Co().A,{style:{...m.rightShimmer,width:e}})]},t)))})}),"resolved"===f&&"resolved"===h&&y&&(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:[{key:"objects",render:e=>(0,w.jsx)(oe().A,{...e,title:"Salesforce objects"}),items:y.filter((e=>e.label.toLowerCase().includes(a.toLowerCase()))).map((e=>({key:e.name,render:t=>(0,w.jsx)(ao().A,{placement:so().W.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!x.has(e.name),renderTooltip:()=>(0,w.jsx)(B().sA,{defaultMessage:"This object is already connected to a property in this collection.",id:"ConnectedRelationActionsObjectSelection.alreadyConnected"}),render:o=>(0,w.jsx)($().A,{...(0,lo().A)(t,o),disabled:x.has(e.name),style:{opacity:x.has(e.name)?.5:1},title:e.label,id:e.name,icon:(0,w.jsx)(fo().Ay,{type:"text",icon:g,size:16,theme:u})})}),action:async()=>{await Ko({environment:s,objectName:e.name,objectLabel:e.label,collectionContextStore:o,intl:c})}})))}]})]})}function tn(e){return(0,w.jsx)(oe().A,{children:(0,w.jsx)(xo().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:bo().A.formatMessage(Xo.inputPlaceholder)})})}function on(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n,rootPropertyId:i,rootPropertySchema:r,integrationId:a}}=e;return"connectedRelationAddProperties"===n&&i&&r?(0,w.jsx)(Wo,{collectionSettingsStore:t,collectionContextStore:o,rootPropertyId:i,integrationId:a,rootPropertySchema:r}):"ConnectedRelationObjectSelection"===n?(0,w.jsx)(en,{collectionSettingsStore:t,collectionContextStore:o,integrationId:a}):"connectedRelationCopyUrl"===n&&i?(0,w.jsx)(Qo,{collectionContextStore:o,integrationId:a,property:i,collectionSettingsStore:t}):null}var nn=()=>o(513416),rn=()=>o(381138),an=()=>o(100622),ln=()=>o(939768),sn=()=>o(559926),cn=()=>o(884107),dn=()=>o(633457),un=()=>o(56394),pn=()=>o(2143),gn=()=>o(572088),mn=()=>o(476492),fn=()=>o(351360);function yn(e){const{onClick:t,integration:o,accountName:n}=e,i=(0,S().IS)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:R().Wy.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,w.jsx)("div",{style:i.accountSelection,children:(0,w.jsxs)("div",{onClick:t,children:[(0,w.jsx)(gt().A,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)("span",{children:n}),placement:so().W.Left,textWrap:!0,render:t=>(0,w.jsx)($().A,{showExtensionArrow:!0,focused:!1,...(0,lo().A)(t||{},e),title:n,icon:(0,w.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var Sn=()=>o(751735);function hn(e,t){const{r:o,g:n,b:i}=(null==e?void 0:e.info.accent_color)||{r:0,g:0,b:0},r=`rgba(${o},${n},${i},${"dark"===t?.6:1})`;return{background:r,hoveredBackground:(0,Sn().e$)(r,.4),pressedBackground:(0,Sn().e$)(r,.9)}}var vn=()=>o(614505),xn=()=>o(444768);function Cn(e){const{collectionContextStore:t,integration:o}=e,n=(0,S().DP)(),a=(0,r().K8)((()=>t.collectionStore()),[t]),l=(0,r().K8)((()=>null==a?void 0:a.getIcon()),[a]),s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=fn().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,S().IS)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.text.contrastPrimary}})),[]),{background:u,hoveredBackground:p,pressedBackground:g}=hn(o,n.mode);return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,w.jsx)("div",{style:d.settingsMenu,children:(0,w.jsxs)("div",{style:d.authenticationBody,children:[(0,w.jsx)(vn().A,{disabled:!0,bucket:"secure",store:a,icon:l,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,w.jsx)("div",{style:d.settingsMenuSubHeading,children:(0,w.jsx)(B().sA,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,w.jsx)(Oo().p,{onClick:()=>{c&&(ro().Jq({environment:s,integration:o,spaceId:c,from:"placeholder_root_external_collection_view_block"}),xn().A.reset())},style:{background:u,...d.settingsMenuAuthenticationButton},hoveredStyle:{background:p},pressedStyle:{background:g},children:(0,w.jsx)(B().sA,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function bn(e){const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,r().K8)((()=>o.collectionStore()),[o]),a=(0,r().K8)((()=>{if(!i)return;const e=i.getFormat().integration_id;return co().A.integrations.state.find((t=>t.id===e))}),[i]),l=(0,r().K8)((()=>!!a&&(0,gn().jw)(a.id).length>0),[a]),s=(0,r().K8)((()=>{var e;return null===(e=fn().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return i&&s&&a?(0,w.jsx)(w.Fragment,{children:l?(0,w.jsx)(An,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:a,externalAuthentication:n}):(0,w.jsx)(Cn,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:a})}):null}function wn(e){var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))}const jn=(0,B().YK)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function An(e){const{integration:t,collectionContextStore:o,collectionSettingsStore:a,externalAuthentication:l}=e,[s,c]=(0,n.useState)(""),u=(0,r().K8)((()=>{const e=co().A.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),p=(0,r().K8)((()=>l||(u.length?u[0]:null)),[u,l]),[g,m]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null),h=(0,S().IS)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:an().Ay.white,background:an().Ay.blue,borderRadius:6,padding:10,boxShadow:e.shadowMD,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),x=(0,r().K8)((()=>o.collectionStore()),[o]),C=(0,r().K8)((()=>o.collectionViewBlockStore()),[o]),b=(0,i().v3)(),[{value:j,status:A}]=(0,v().Yb)((async()=>{if(!p)return;const e=p.parent_id;return ae().callApi({eventName:"listExternalCollections",environment:b,data:{bot_id:e}})}),[b,p]),_="success"===(null==j?void 0:j.type)&&"data"in j.data?j.data.data:[],M="success"===(null==j?void 0:j.type)&&"error"in j.data?j.data.error:null,k=_.filter((e=>!f||e.type===f)),I=k.length?(0,So().Ay)(s,k,(e=>e.title)):[],T=Array.from(new Set(_.map((e=>e.type)))),P=wn({integration:t,url:s}),R=async e=>{if(m(!0),!x||!C)return;const n=e||s,i=wn({integration:t,url:n});if(!i)return m(!1),void V().ui({items:[{label:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:async()=>{const e=await cn().R.clipboardActions.load();e.copyString({environment:b,stringValue:JSON.stringify({botId:null==p?void 0:p.parent_id,url:n},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}},{label:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const r=(0,gn().jw)(t.id);await dn().jW({environment:b,url:n,botIds:r.map((e=>e.id)),externalCollectionStore:x,externalCollectionViewBlockStore:C});const{host:l}=(0,ln().qg)(n);sn().lR(b,{...(0,mn().sl)(o),integrationId:t.id,type:"collection",entity:i.name,domain:l||"",from:"external_picker_settings"}),d().R8({collectionSettingsStore:a,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),m(!1)};if(!x||!C)return null;const F=T.length>1?(0,w.jsx)("div",{style:h.filterContainer,children:(0,w.jsxs)(pn().H,{type:Qe().A.X,style:h.filterContainerScroller,children:[(0,w.jsx)(un().A,{title:(0,w.jsx)("span",{children:bo().A.formatMessage(jn.all)}),on:!(0,W().Pe)(f),hideChevron:!0,onClick:e=>{(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>{y(null)}})}},"all"),T.map((e=>(0,w.jsx)(un().A,{title:(0,w.jsx)("span",{children:bo().A.formatMessage(jn[e])}),on:f===e,hideChevron:!0,onClick:t=>{(0,Ye().SQ)({event:t,context:Ye().y$.CollectionSettingsClick,callback:()=>{y((t=>t===e?null:e))}})}},e)))]})}):null,D=P?(0,w.jsx)("div",{style:h.syncSourceButton,children:(0,w.jsx)(te().A,{size:"lg",onClick:e=>{(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>{R()}})},disabled:!1,children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,L=P||_.length&&I.length?null:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:h.noResults,children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,w.jsxs)("div",{style:h.suggestionBox,children:[(0,at().G)({marginRight:8,width:14,height:14}),(0,w.jsx)(B().sA,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),O=_.length&&I.length?(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:[{key:"collections",items:I.map((e=>{const t={key:e.url,render:t=>(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)("span",{children:e.title}),placement:so().W.Left,textWrap:!0,render:o=>(0,w.jsx)($().A,{...(0,lo().A)(o||{},t),title:e.title,icon:(0,w.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),R(e.url)}};return t})),render:e=>(0,w.jsx)(oe().A,{...e,disableMobilePadding:!0})}]}):null,E="pending"===A||"idle"===A||g;if(!p||M&&(M.status===nn().nG.UNAUTHORIZED||M.status===nn().nG.FORBIDDEN))return(0,w.jsx)(Cn,{collectionContextStore:o,collectionSettingsStore:a,integration:t});const z="rejected"===A||"failed"===(null==j?void 0:j.type)||M,N=(0,w.jsx)(yn,{onClick:()=>{d().a2({collectionSettingsStore:a,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{d().a2({collectionSettingsStore:a,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:p.account_name});return(0,w.jsx)(K().Ay,{...e,footer:D||g?null:N,title:(0,w.jsx)(B().sA,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!E&&"resolved"===A&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(xo().Ay,{inputLeft:(0,w.jsx)(xo().Zf,{icon:rn().q}),onSubmit:()=>{P&&R()},style:h.settingsMenuSearchBox,focusInitial:!0,value:s,onChange:e=>{c(e.target.value)},placeholder:"Search source or paste a link..."}),P?null:F]}),children:(0,w.jsxs)("div",{style:h.settingsMenu,children:[z&&(0,w.jsx)("div",{style:h.errorMessage,children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),E&&(g?(0,w.jsxs)("div",{style:h.syncingData,children:[(0,w.jsx)("span",{children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,w.jsx)(Eo().A,{style:{alignSelf:"center"}})]}):(0,w.jsxs)("div",{style:h.syncingData,children:[(0,w.jsx)("span",{children:(0,w.jsx)(B().sA,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,w.jsx)(Eo().A,{style:{alignSelf:"center"}})]})),!E&&"resolved"===A&&(0,w.jsxs)(w.Fragment,{children:[D,L,O]})]})})}var _n=()=>o(278238),Mn=()=>o(654062),kn=()=>o(943919),In=()=>o(745266),Tn=()=>o(449476),Pn=()=>o(755735),Bn=()=>o(265504);const Rn=function(e){const{collectionContextStore:t,collectionSettingsStore:n}=e,a=(0,B().tz)(),l=(0,S().DP)(),s=(0,i().v3)(),{device:c}=s,u=(0,r().K8)((()=>t.collectionViewStore()),[t]),g=(0,r().K8)((()=>null==u?void 0:u.isDefined()),[u]),m=(0,r().K8)((()=>null==u?void 0:u.getFormat().collection_view_icon),[u]),f=(0,r().K8)((()=>null==u?void 0:u.getType()),[u]),y=(0,r().K8)((()=>Tn().A.state.isOpen),[]);return u&&g?(0,w.jsxs)(K().Ay,{...e,collectionSettingsStore:n,title:(0,w.jsx)(B().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:y?280:290,children:[(0,w.jsx)(oe().A,{isInput:!0,children:(0,w.jsx)(Pn().B,{initialValue:"",placeholder:a.formatMessage(o(395859).X.viewNamePlaceholderMessage),focusInitial:!c.isMobile||void 0,onBlur:e=>Vn(e,s,t),iconButton:{icon:e=>(0,w.jsx)(In().h,{color:"gray",viewIcon:m,viewType:f}),iconStyle:{fill:_n().l8[l.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;p().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{(0,kn().o)({collectionViewStore:n,icon:o,transaction:e})}}),(0,qt().X)({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(s,t,e)},onSubmit:e=>function(e,t,o,n){Vn(e,t,n),d().R8({collectionSettingsStore:o,item:{type:"main"}}),(0,qt().X)({environment:t,collectionContextStore:n,action:"rename"})}(e,s,n,t)})}),(0,w.jsx)(Bn().A,{collectionContextStore:t,collectionSettingsStore:n,showDoneButton:!c.isMobile})]}):null};function Vn(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&p().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,canUndo:!0,perform:t=>{(0,Mn().F)({collectionViewStore:n,update:{name:e},transaction:t})}})}var Fn=()=>o(700500),Kn=()=>o(72645),Dn=()=>o(388821),Ln=()=>o(869558),On=()=>o(885110),En=()=>o(669548),zn=()=>o(246826),Nn=()=>o(606952),Un=()=>o(359454),Hn=()=>o(231314),Wn=()=>o(389658),Gn=()=>o(682146),qn=()=>o(493260),Yn=()=>o(58293),$n=()=>o(597898),Qn=()=>o(338907);function Zn(e){var t;let{environment:o,collectionContextStore:n}=e;if(!(0,Qn().u_)(o))return!1;if(Jn(n))return!1;return!Boolean("chart"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType()))&&("linked"!==n.getCollectionViewBlockSourceState()||s().default.checkGate({gateName:"workflow_container"}))}function Jn(e){var t;return Boolean((null===(t=e.collectionViewBlockStore())||void 0===t?void 0:t.isInlineCollectionView())&&"uninitialized"===e.getCollectionViewBlockSourceState())}var Xn=()=>o(409902),ei=()=>o(594013),ti=()=>o(901610),oi=()=>o(519831),ni=()=>o(720665);function ii(e){var t,o,n;const{collectionContextStore:i,collectionStore:r,transaction:a}=e,l=i.collectionViewStore();if(!l||!r.isDefined())return;const s=ut().e2(r),c=null===(t=r.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,d=i.collectionStore(),u=(null==d?void 0:d.pointer.id)!==r.pointer.id,p=r.getSchema();let g=l.getChartConfig();u&&"chart"===l.getType()&&g&&"placeholder"!==g.type&&(g=function(e){let{chartConfig:t,collectionSchema:o}=e;return(0,ti().m)(t)?(0,ei().EZ)({collectionSchema:o,axisChartType:t.type}):"donut"===t.type?(0,ei().ZS)({collectionSchema:o}):(0,ei().EZ)({collectionSchema:o,axisChartType:"column"})}({chartConfig:g,collectionSchema:p}));const m={table_properties:null==s||null===(o=s.getFormat())||void 0===o?void 0:o.table_properties,collection_pointer:{table:oi().Vl,id:r.id,spaceId:r.getSpaceId()},chart_config:g,timeline_arrows_by:c?{property:c}:void 0,table_subitem_toggle_column:"title"},f=null==i?void 0:i.normalizedSchemaStore.state;zn().zv({store:l,data:(0,ni().g_)({format:m,query2:{sort:null==s||null===(n=s.getQuery(f))||void 0===n?void 0:n.sort}}),transaction:a})}function ri(e){const{collectionContextStore:t,transaction:o,source:n}=e,i=t.collectionViewStore();if(i&&(u().zA({stores:[i],update:{collection_view_source:n},transaction:o}),"collection"===n.type)){const e=Y().md.createChildStore(i,{table:oi().Vl,id:n.id,spaceId:n.spaceId});if(!e.isDefined())return;ii({collectionContextStore:t,collectionStore:e,transaction:o})}}var ai=()=>o(564037),li=()=>o(272600),si=()=>o(424599);function ci(e){const{collectionContextStore:t,environment:o,collectionStore:n,collectionSettingsStore:i,createdCollectionStore:r,userAction:a}=e;if(p().createAndCommit({userAction:a,environment:o,canUndo:!0,perform:e=>{var a;const l=t.collectionViewStore(),s=t.collectionViewBlockStore();if(!l||!s)return;ri({collectionContextStore:t,source:{type:"collection",id:n.id,spaceId:n.getSpaceId()},transaction:e}),r&&(0,Xn().h)({collectionViewBlockStore:s,collectionStore:r,transaction:e}),t.isInHomeWidgetStore.state&&d().os({collectionSettingsStore:i});const c=s.getBlockTitleStore(),u=null==s||null===(a=s.getTitleStore())||void 0===a?void 0:a.getValue();c&&u&&Nn().KY({environment:o,store:c,value:u,transaction:e}),(0,li().p)({collectionViewBlockStore:s,collectionPointer:n.pointer,transaction:e})}}),(0,ai().getIsWorkflowEditorOpen)(o))return void d().os({collectionSettingsStore:i});const l=t.viewsModuleContextStore.isInLayoutBuilder();(0,si().M)({environment:o,collectionStore:n,collectionContextStore:t,collectionSettingsStore:i,shouldSkipViewSelection:l})}var di=()=>o(736982),ui=()=>o(757695),pi=()=>o(821062),gi=()=>o(228927),mi=()=>o(768627),fi=()=>o(970585),yi=()=>o(333080),Si=()=>o(370873),hi=()=>o(314660),vi=()=>o(963589);const xi=(0,B().YK)({browse:{defaultMessage:"Browse",id:"database.collectionSettings.useBrowseCollections.browse"},createdByMe:{defaultMessage:"Created by me",id:"database.collectionSettings.useBrowseCollections.createdByMe"},recents:{defaultMessage:"Recents",id:"database.collectionSettings.useBrowseCollections.recents"},mentionedMe:{defaultMessage:"Mentioned me",id:"database.collectionSettings.useBrowseCollections.mentionedMe"}});function Ci(e){const t=(0,i().v3)(),o=(0,vi().X)("collections_system_db"),{isMobile:r}=t.device,a=(0,S().IS)((e=>({icon:{color:e.mediumIconColor,width:r?24:20,height:r?24:20}})),[r]),l=(0,n.useCallback)((o=>{const n=e.collectionViewStore();n&&p().createAndCommit({userAction:"CreateViewSourceMenuBody.allPagesOption",environment:t,canUndo:!0,perform:t=>{ri({collectionContextStore:e,source:{type:o,spaceId:n.getSpaceId()},transaction:t}),(0,hi().f)({collectionViewStore:n,update:{filter:void 0,sort:[],aggregations:void 0},transaction:t});const i=e.settingsStore;d().os({collectionSettingsStore:i})}})}),[e,t]);return(0,n.useMemo)((()=>{if(!o)return;return{key:"browse",items:[{key:"created-by-me",render:e=>(0,w.jsx)($().A,{...e,title:bo().A.formatMessage(xi.createdByMe),icon:(0,Si().p)(a.icon)}),action:()=>{l("createdByMe")}},{key:"recents",render:e=>(0,w.jsx)($().A,{...e,title:bo().A.formatMessage(xi.recents),icon:(0,yi().c)(a.icon)}),action:()=>{l("recents")}},{key:"mentioned-me",render:e=>(0,w.jsx)($().A,{...e,title:bo().A.formatMessage(xi.mentionedMe),icon:(0,yi().c)(a.icon)}),action:()=>{l("mentionsMe")}}],render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(xi.browse),...e})}}),[a.icon,l,o])}var bi=()=>o(591779),wi=()=>o(30626),ji=()=>o(245241),Ai=()=>o(496603),_i=()=>o(736767),Mi=()=>o(305390),ki=()=>o(135599),Ii=()=>o(106628),Ti=()=>o(361330);function Pi(e){let{numShimmers:t=5}=e;const o=(0,S().IS)((e=>({container:{maxHeight:253},shimmerContainer:{height:45,margin:"0 14px 0px 18px",display:"flex",alignItems:"center"},circleContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:5,marginTop:5,alignSelf:"flex-start"},circle:{width:16,height:16,borderRadius:12,backgroundColor:e.lightDividerColor},sourceContainer:{flex:"1 1 auto",marginTop:6,marginLeft:8,alignSelf:"flex-start"},title:{height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor},location:{marginTop:9,height:9,width:"60%",borderRadius:8,backgroundColor:e.lightDividerColor},showMoreContainer:{margin:"-2px 14px 0px 18px",display:"flex",alignItems:"center"},showMore:{marginTop:3,height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor}})),[]),n=Ai().Hn(t,(e=>(0,w.jsxs)("div",{style:o.shimmerContainer,children:[(0,w.jsx)("div",{style:o.circleContainer,children:(0,w.jsx)(Co().A,{style:o.circle})}),(0,w.jsxs)("div",{style:o.sourceContainer,children:[(0,w.jsx)(Co().A,{style:o.title}),(0,w.jsx)(Co().A,{style:o.location})]})]},e))),i=(0,w.jsxs)("div",{style:o.showMoreContainer,children:[(0,w.jsx)("div",{style:o.circleContainer,children:(0,w.jsx)(Co().A,{style:o.circle})}),(0,w.jsx)("div",{style:o.sourceContainer,children:(0,w.jsx)(Co().A,{style:o.showMore})})]});return(0,w.jsxs)("div",{style:o.container,children:[n,i]})}const Bi=5,Ri=20,Vi=20;function Fi(e){const{input:t,handleAcceptExistingCollection:o,hideSearchTitle:a,collectionContextStore:s,collectionStore:c,parentStore:d,context:u,showSuggestions:p,searchResultsItemsLimit:g=Ri,isSearchSurfacesHookEnabled:m=!1,showLoadMoreResultsButton:f=!1,requireEditPermissions:y=!1}=e,h=(0,i().v3)(),[x,C]=(0,n.useState)(Bi),b=(0,n.useRef)(!1);(0,bi().ZC)(t)!==t&&(b.current=!1),(0,n.useEffect)((()=>{m||(t.length>0&&x===Bi?C(Ri):0===t.length&&x===Ri&&C(Bi))}),[t.length,m,x]);const{results:j,isResultsLoading:A,searchSessionId:_,fetchAdditionalServerResultsOnChange:M,hasMoreResults:k,searchSessionFlowNumber:I}=(0,ki().W)({disable:!m||0===t.length&&!p,searchQuery:t,limit:g,source:"collection_settings_source",type:ji().Vz.CollectionsInSpace}),T=(0,n.useRef)(0),P=I+T.current,[B]=(0,v().Yb)((async()=>{if(m)return;const e=await Di({query:t,limit:x},d,h,_,s,y);return T.current+=1,e}),[m,t,x,d,h,_,s,y],{debounce:Ti().tu}),R=(0,S().IS)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]),V=(0,r().K8)((()=>B&&"pending"===B.status||A),[A,B]),{resultsSectionItems:F,hasResults:K}=(0,r().K8)((()=>{if("rejected"===B.status)return{resultsSectionItems:[],hasResults:!1};const{results:e,showMore:n}=B.value??{results:[],showMore:0},i=m?j.map((e=>e.store.getCollectionViewSourceCollectionStore())):e.map((e=>Vo().m.createChildStore(d,{table:oi().Vl,id:e}))),r=(0,Ai().oE)(i).filter((e=>{if(u===Oi.Source){const t=e.getParentBlockStore();return(null==t?void 0:t.id)!==d.id}return!y||e.canEditCollection()})),a=r.map(((e,n)=>({key:e.id,render:t=>{var o;return(0,w.jsx)(Mi().A,{...t,store:e,right:u===Oi.Relation&&((null==c?void 0:c.id)??(null==s||null===(o=s.collectionStore())||void 0===o?void 0:o.id))===e.id&&(0,w.jsx)(Ki,{})})},action:i=>{o(e),(0,l().u4)({environment:h,event:{eventName:"source_collection_search_item_click",eventProperties:{index:n,search_session_id:_,source:"source",using_secondary_search_surfaces_hook:m,query_length:t.length,reciprocal_rank:1/(n+1),search_session_flow_number:P,total_results:r.length}}})}})));if(V&&a.push({key:"loading",render:e=>(0,w.jsx)("div",{style:{paddingTop:h.device.isMobile?10:0},children:(0,w.jsx)(Pi,{numShimmers:Math.min(g,5)})}),action:()=>{}}),!m&&n>0&&!V){const e={key:"showMore",render:e=>(0,w.jsx)($().A,{...e,buttonStyle:R.showMoreButton,icon:(0,wi()._)({width:16,height:16}),title:bo().A.formatMessage(Li.showMore,{showMore:n})}),action:()=>C((e=>e+Vi))};a.push(e)}else if(m&&(0===t.length||f)&&!V&&!b.current&&k&&M){const e={key:"showMore",render:e=>(0,w.jsx)($().A,{...e,buttonStyle:R.showMoreButton,icon:(0,wi()._)({width:16,height:16}),title:bo().A.formatMessage(Li.showMoreWithoutCount)}),action:()=>{M(g),b.current=!0}};a.push(e)}return a.length>0?{resultsSectionItems:a,hasResults:!0}:{resultsSectionItems:[{key:"noResults",render:e=>(0,w.jsx)(_i().A,{caption:bo().A.formatMessage(Li.noResults),style:{marginLeft:1},...e}),action:()=>{}}],hasResults:!1}}),[B.status,B.value,m,j,V,t.length,f,k,M,d,u,y,c,s,o,h,_,P,g,R.showMoreButton]),D=(0,n.useMemo)((()=>({key:"results",items:F,render:e=>(0,w.jsx)(oe().A,{title:!a&&bo().A.formatMessage(Li.existingDatabases),...e})})),[a,F]);return{resultsSection:D,fetchMoreResults:!V&&M?M:void 0,searchSessionFlowNumber:P,searchSessionId:_,hasResults:K}}function Ki(){const e=(0,B().tz)();return(0,w.jsx)(ao().A,{renderTooltip:()=>e.formatMessage(Li.thisDatabase),render:e=>(0,w.jsx)("div",{...e,children:(0,at().G)({width:14,height:14})})})}async function Di(e,t,o,n,i,r){const{query:a,limit:l}=e,{currentSpaceStore:s}=fn().default.state,c=null==i?void 0:i.collectionViewBlockStore(),d=await Ii().T.searchActions.load(),u=await d.searchCollectionsWithRecents({environment:o,collectionViewBlockStore:c,parentStore:t,spaceStore:s,query:a,limit:l,requireEditPermissions:r,searchSessionId:n});return{results:u.results,showMore:Math.max(0,u.total-u.results.length)}}const Li=(0,B().YK)({showMore:{defaultMessage:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title"},noResults:{defaultMessage:"No results",id:"database.viewSettings.searchCollections.noResults.title"},existingDatabases:{defaultMessage:"Existing databases",id:"database.viewSettings.createViewTab.existingDatabases"},showMoreWithoutCount:{defaultMessage:"Show more",id:"database.viewSettings.searchCollections.showMore.titleWithoutCount"},thisDatabase:{defaultMessage:"This database",id:"database.viewSettings.searchCollections.thisDatabase.tooltip"}});let Oi=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({});const Ei=(0,B().YK)({linkedInputPlaceholder:{defaultMessage:"Link to a database",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{defaultMessage:"Link or create a database",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",defaultMessage:"Select a database"}}),zi=ui().default.createClass("",{name:"InputStore"});function Ni(e){let{collectionContextStore:t,context:o,parentStore:a,onAccept:c,inputStore:d,requireEditPermissions:u,collectionStore:p}=e;const g=(0,i().v3)(),m=(0,r().uB)(d,zi),f=(0,r().uB)(void 0,fi().A),y=(0,n.useRef)(0),S=(0,r().O$)(m),{resultsSection:h,fetchMoreResults:v,searchSessionId:x,searchSessionFlowNumber:C}=Fi({input:S,handleAcceptExistingCollection:c,collectionContextStore:t,parentStore:a,context:o,showSuggestions:!0,requireEditPermissions:u,collectionStore:p}),b=Ci(t);(0,n.useEffect)((()=>{y.current=C}),[C]);const j=(0,r().K8)((()=>"on"===s().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,l().u4)({environment:g,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:x,using_secondary_search_surfaces_hook:j,source:"relation"}}}),()=>{(0,l().u4)({environment:g,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:x,source:"relation",using_secondary_search_surfaces_hook:j,search_session_flow_number:y.current}}})})),[g,j,x]);const A="linked"===(0,r().K8)((()=>null==t?void 0:t.getCollectionViewBlockSourceState()),[t])||o===Oi.Relation?Ei.linkedInputPlaceholder:o===Oi.Source?Ei.linkedOrSourceInputPlaceholder:Ei.automationInputPlaceholder;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{isInput:!0,children:(0,w.jsx)(xo().Ay,{focusInitial:!g.device.isMobile||void 0,value:S,onChange:e=>{m.setState(e.target.value),f.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:bo().A.formatMessage(A),showClearButton:!0})}),(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:[h,b].filter(W().O9),store:f}),j?(0,w.jsx)(gi().A,{onChange:(e,t)=>{v&&e<mi().A.incrementScrollOffset&&v()}}):null]})}const Ui=n.memo(Ni,pi().A);var Hi=()=>o(852507),Wi=()=>o(428045),Gi=()=>o(820579),qi=()=>o(498474),Yi=()=>o(343666),$i=()=>o(209660),Qi=()=>o(115512),Zi=()=>o(160475),Ji=()=>o(839754),Xi=()=>o(554509);function er(e){let{icon:t,style:o}=e;return t({...(0,S().IS)((e=>({icon:{fill:e.regularIconColor,width:18,height:18}})),[]).icon,...o})}function tr(e){let{buttonMenuItemProps:t,iconStyle:o,hideButton:n,menuItemStyle:i}=e;const r=(0,S().IS)((e=>({buttonMenuItem:{display:n?"none":"flex",...i},icon:{fill:e.mediumIconColor,...o}})),[n,i,o]);return(0,w.jsx)($().A,{style:r.buttonMenuItem,...t,title:(0,w.jsx)(Xi().D,{styleName:"Body-14px/Regular",colorName:"secondary",children:(0,w.jsx)(B().sA,{id:"addWorkflowTemplateMenu.moreTemplates",defaultMessage:"More templates"})}),icon:(0,w.jsx)(er,{icon:wi()._,style:r.icon})})}var or=()=>o(902842),nr=()=>o(913454),ir=()=>o(575154);var rr=()=>o(349379),ar=()=>o(32454),lr=()=>o(3486),sr=()=>o(896326);const cr=(0,B().YK)({suggested:{defaultMessage:"Suggested",id:"database.viewSettings.createViewTab.suggested"},link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"},linkOrCreate:{defaultMessage:"Link or create...",id:"database.viewSettings.searchCollections.linkedOrCreate"},addOrLinkDatabase:{defaultMessage:"Add or link database...",id:"database.viewSettings.searchCollections.addOrLinkDatabase"},setupWithAI:{defaultMessage:"Build with AI",id:"database.viewSettings.searchCollections.setupWithAI"}}),dr=14,ur=32;function pr(e){let{collectionContextStore:t,collectionSettingsStore:o,parentStore:c,existingCollectionStore:u,createdCollectionRecordPointerMap:p,input:g,setInput:m,newButtonMenuItem:f,context:y,handleAcceptExistingCollection:h,hideSearchTitle:v,onSelectCollection:x}=e;const C=(0,i().v3)(),b=(0,r().uB)(void 0,fi().A),j=(0,n.useRef)(0),A=(0,r().K8)((()=>Zn({environment:C,collectionContextStore:t})),[C,t]),_=g.length>0,M=(0,r().K8)((()=>Jn(t)),[t]),k=_||!A,{resultsSection:I,searchSessionId:T,searchSessionFlowNumber:P,hasResults:R}=Fi({showSuggestions:!0,input:g,collectionContextStore:t,hideSearchTitle:v,parentStore:c,context:y,handleAcceptExistingCollection:h,searchResultsItemsLimit:3,showLoadMoreResultsButton:_,isSearchSurfacesHookEnabled:!0}),V=(0,n.useMemo)((()=>{if(k&&R)return I}),[I,k,R]),F=Ci(t);(0,n.useEffect)((()=>{j.current=P}),[P]),(0,n.useEffect)((()=>((0,l().u4)({environment:C,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:T,using_secondary_search_surfaces_hook:!0,source:"source"}}}),()=>{(0,l().u4)({environment:C,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:T,source:"source",using_secondary_search_surfaces_hook:!0,search_session_flow_number:j.current}}})})),[C,T]);const K=_,D=(0,S().IS)((e=>({newTableWrapperStyle:{...K&&{position:"sticky",bottom:0,backgroundColor:e.popoverBackground}}})),[K]),L=(0,r().K8)((()=>yr(c)),[c]),O=(0,n.useCallback)((e=>{var o;let{template:n,collectionViewBlockStore:i,collectionViewBlockParentStore:r,flowId:a,aiPrompt:l}=e;null!==(o=n.value.onboarding)&&void 0!==o&&o.isMinimal?(0,ar().createMinimalCollectionTemplateWithoutModal)({environment:C,template:n,parentStore:r,existingCollectionInfo:{collectionViewBlockStore:i,collectionStore:t.collectionStore(),collectionViewStore:t.collectionViewStore()},relationInfos:[]}):(0,ar().openSelectedTemplateOnboardingModalForInAppFlows)({environment:C,template:n,parentStore:r,existingCollectionInfo:{collectionViewBlockStore:i,collectionStore:t.collectionStore(),collectionViewStore:t.collectionViewStore()},origin:Sr(t),navigateToOnFinish:"skip",flowId:a,aiPrompt:l,onClose:e=>(0,Ji().ZM)({environment:C,userAction:"CreateViewSourceMenuBodyNew.onAcceptCollectionTemplate",result:e,existingCollectionViewBlockStore:i})})}),[C,t]),E=function(e){const{input:t,parentStore:o,onAcceptCollectionTemplate:s,collectionContextStore:c,settingsSupportsSuggestedTemplates:d}=e,u=(0,i().v3)(),p=(0,S().DP)(),[g]=(0,n.useState)((0,a().Ay)()),m=(0,S().IS)((()=>({icon:{marginLeft:6,marginRight:6},moreIcon:{width:dr,height:dr,margin:(ur-dr)/2},caption:{fontSize:(0,Qi().ny)(u,"UIRegular"),whiteSpace:"normal"}})),[u]),f=(0,r().K8)((()=>yr(o)),[o]),y=(0,ir().q)({parentStore:f}),h=(0,So().Ay)(t,y,(e=>e.value.targetCollection.name)),v=h.slice(0,nr().TRUNCATE_COLLECTION_TEMPLATE_ITEMS_AT),x=v.length<h.length,C=(0,n.useMemo)((()=>f?v.map(((e,t)=>gr({collectionTemplate:e,theme:p,styles:m,hideCaption:!0,onAcceptCollectionTemplate:o=>{s(o),(0,rr().os)({environment:u,eventProperties:{from_modal_template_picker:!1,selected_index:t,collection_template_ids_shown:v.map((e=>e.templateId)),...(0,sr().gM)({origin:Sr(c),parentStore:f,collectionTemplate:e,flowId:g,collectionTemplatesSearchQuery:void 0})}})},parentStore:o,collectionTemplateParentStore:f,aiPrompt:void 0}))):[]),[f,s,o,p,m,v,u,g,c]),b=(0,n.useMemo)((()=>{const e={key:"see_more_workflow_templates",render:e=>(0,w.jsx)(tr,{buttonMenuItemProps:e,iconStyle:m.moreIcon,menuItemStyle:(0,di().h)({environment:u})}),action:()=>function(e){let{environment:t,parentStore:o,collectionContextStore:n}=e;const i=o.getParentStore(),r=n.collectionViewBlockStore();if(!i||!r||i.table===Yi().SN||!(0,nr().isCollectionTemplateParentStore)(i))return;(0,ar().openTemplateOnboardingModal)({parentStore:i,template:void 0,version:(0,ar().getTemplateOnboardingVersion)({template:void 0}),origin:Sr(n),existingCollectionInfo:{collectionStore:n.collectionStore(),collectionViewStore:n.collectionViewStore(),collectionViewBlockStore:r},navigateToOnFinish:"skip",onClose:e=>(0,Ji().ZM)({environment:t,userAction:"CreateViewSourceMenuBodyNew.handleClickMoreButton",result:e,existingCollectionViewBlockStore:r})})}({parentStore:o,collectionContextStore:c,environment:u})};return{key:"suggestedCollectionTemplates",items:[...C,...x?[e]:[]],render:e=>(0,w.jsx)(oe().A,{title:bo().A.formatMessage(cr.suggested),...e})}}),[C,x,m.moreIcon,u,o,c]),j=(0,r().K8)((()=>Sr(c)),[c]);if(function(e){let{collectionTemplateIds:t,origin:o,flowId:r,blockId:a}=e;const s=(0,i().v3)(),c=(0,n.useRef)(!1);(0,n.useEffect)((()=>{c.current||((0,l().u4)({environment:s,event:{eventName:"suggested_collection_templates_shown",eventProperties:{origin:o,collection_template_ids_shown:t,block_id:a,flow_id:r}}}),c.current=!0)}))}({collectionTemplateIds:v.map((e=>e.templateId)),origin:j,blockId:o.id,flowId:g}),!d)return;return 0===C.length?void 0:b}({input:g,onAcceptCollectionTemplate:O,parentStore:c,collectionContextStore:t,settingsSupportsSuggestedTemplates:A}),z=M?void 0:E,N=function(e){const{newButtonMenuItem:t,collectionTemplateParentStore:o,onAcceptCollectionTemplate:n,parentStore:i,showTopBorder:a,hideCaption:l,searchInput:s,settingsSupportsSuggestedTemplates:c}=e,d=(0,B().tz)(),u=(0,S().DP)(),p=(0,S().IS)((()=>({...e.styles,icon:{...e.styles.icon,width:20,height:20}})),[e.styles]);return(0,r().K8)((()=>{if(!t)return;const e=[t];if((0,nr().getIsSetupGeneratorEnabled)()&&o&&c){const t=nr().globalWorkflowTemplates.fromIdOfType({type:"collection",templateId:Wi().MH});e.push(gr({collectionTemplate:t,theme:u,styles:p,onAcceptCollectionTemplate:n,parentStore:i,collectionTemplateParentStore:o,nameOverride:d.formatMessage(cr.setupWithAI),hideIconBackground:!0,hideCaption:l,aiPrompt:(0,U().x9d)(s)}))}return{key:"newButton",render:e=>(0,w.jsx)(oe().A,{...e,topBorder:a,style:p.newTableWrapperStyle}),items:e}}),[t,o,u,p,n,i,d,l,s,a,c])}({newButtonMenuItem:f,collectionTemplateParentStore:L,onAcceptCollectionTemplate:O,parentStore:c,showTopBorder:!A&&k&&(Boolean(z)||R),styles:D,hideCaption:!0,searchInput:g,settingsSupportsSuggestedTemplates:A}),H=k?void 0:function(e){let{existingCollectionStore:t,collectionSettingsStore:o,createdCollectionRecordPointerMap:n,onSelectCollection:i}=e;const r={key:"link_database",render:e=>(0,w.jsx)(fr,{buttonMenuItemProps:e}),action:()=>{d().dP({collectionSettingsStore:o,item:{type:"createViewSource",existingCollectionStore:t,createdCollectionRecordPointerMap:n}}),d().a2({collectionSettingsStore:o,item:{type:"linkToDatabase",existingCollectionStore:t,onSelectCollection:i}})}};return{key:"more_settings",render:e=>(0,w.jsx)(oe().A,{topBorder:!0,...e}),items:[r]}}({existingCollectionStore:u,collectionSettingsStore:o,createdCollectionRecordPointerMap:p,onSelectCollection:x}),W=(0,r().K8)((()=>void 0!==f?cr.addOrLinkDatabase:null!=t&&t.isInHomeWidgetStore.state?cr.search:cr.link),[t,f]),G=(0,n.useMemo)((()=>({key:"input",render:e=>(0,w.jsx)(oe().A,{shouldShowBottomDivider:!1,...e}),items:[{key:"input",action:()=>{},render:e=>(0,w.jsx)(xo().Ay,{...e,value:g,onChange:e=>{m(e.target.value),b.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:bo().A.formatMessage(W),showClearButton:!0})}]})),[g,b,W,m]),q=function(){const e=(0,i().v3)();return(0,r().K8)((()=>{if(!("db_create_empty_state"===s().default.getEligibleGroup({experimentId:"adoption_import_entry_point",defaultGroup:"control"})))return;return{key:"importButton",render:e=>(0,w.jsx)(oe().A,{...e,topBorder:!1}),items:[{key:"import_button",render:e=>(0,w.jsx)(mr,{buttonMenuItemProps:e}),action:()=>{$i().Ow({currentTab:"imports",openedFrom:"database_create_empty_state"}),sn().kY(e,{from:"database_create_empty_state"}),(0,Zi().t)({environment:e,action:"click",from:"database_create_empty_state"})}}]}}),[e])}(),Y=(0,n.useMemo)((()=>(0,Ai().oE)(_?[G,V,z,N,H,F]:[G,N,V,z,H,q,F])),[_,G,V,z,N,H,q,F]);return(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:Y})}function gr(e){const{collectionTemplate:t,theme:o,styles:n,onAcceptCollectionTemplate:i,parentStore:r,collectionTemplateParentStore:a,hideIconBackground:l,nameOverride:s,hideCaption:c,aiPrompt:d}=e,{templateId:u,description:p}=t,{name:g}=t.value.targetCollection,m=(0,lr().d)(t.value.targetCollection.icon,o),f=(0,w.jsx)(or().z,{template:t,size:dr,iconStyle:n.icon});return{key:u,render:e=>(0,w.jsx)(Xe().wT,{placement:so().W.Left,collectionTemplate:t,render:t=>(0,w.jsx)(di().I,{buttonMenuItemProps:{...(0,lo().A)(e,t),alignIconTop:!0},title:s??g,caption:c?void 0:(0,w.jsx)("div",{style:n.caption,children:p}),icon:(0,w.jsx)(Hn().y,{backgroundSize:ur,icon:f,backgroundColor:l?"#00000000":m.fill.secondary})})}),action:()=>{i({template:t,collectionViewBlockStore:r,collectionViewBlockParentStore:a,flowId:void 0,aiPrompt:d})}}}function mr(e){const{buttonMenuItemProps:t}=e,o=(0,i().v3)(),n=(0,S().IS)((e=>({importIcon:{width:20,height:20,fill:e.mediumTextColor,margin:"auto"},iconWrapper:{width:ur}})),[]);return(0,Hi().w)((()=>{(0,Zi().t)({environment:o,action:"view",from:"database_create_empty_state"})})),(0,w.jsx)(di().I,{buttonMenuItemProps:t,title:(0,w.jsx)(B().sA,{id:"createViewSourceMenuBody.importButton",defaultMessage:"Import data"}),icon:(0,w.jsx)("div",{style:n.iconWrapper,children:(0,Gi().f)(n.importIcon)})})}function fr(e){let{buttonMenuItemProps:t}=e;const o=(0,S().IS)((e=>({iconWrapper:{width:ur},linkDatabaseIcon:{fill:e.mediumTextColor,height:16,width:16,margin:"auto",transform:"rotate(45deg)"}})),[]);return(0,w.jsx)(di().I,{buttonMenuItemProps:t,title:(0,w.jsx)(B().sA,{id:"createViewSourceMenuBody.linkDatabase",defaultMessage:"Link to existing database"}),icon:(0,w.jsx)("div",{style:o.iconWrapper,children:(0,qi().q)(o.linkDatabaseIcon)})})}function yr(e){const t=e.getParentStore();if(t&&(0,nr().isCollectionTemplateParentStore)(t))return t}function Sr(e){return e.isFullScreenStore.state?"collection_settings_create_view_source":"collection_settings_create_view_source_inline"}function hr(e){const{collectionSettingsStore:t,collectionContextStore:a,existingCollectionStore:l,onSelectCollection:s}=e,c=(0,i().v3)(),u=(0,Yn().r)(),g=c.currentUser.id,m=null==u?void 0:u.id,[f,y,h,v]=(0,r().K8)((()=>[a.collectionViewBlockStore(),a.collectionViewStore(),a.collectionStore(),a.getCollectionViewBlockSourceState()]),[a]),[x,C]=(0,n.useState)(void 0),[b,j]=(0,n.useState)(void 0),[[A,_],M]=(0,n.useState)([l,void 0]),k=(0,n.useCallback)((e=>{M(e),t.state.open&&d().dP({collectionSettingsStore:t,item:{type:"createViewSource",existingCollectionStore:e[0],createdCollectionRecordPointerMap:e[1]}})}),[t]),[I,T]=(0,n.useState)(""),P=(0,r().K8)((()=>h&&a.hasSingleCollection()),[a,h]),B=(0,$n().P9)({name:"view_chart",spaceId:m,userId:g,amount:"unknown"}),[R,V]=(0,n.useState)("boot");(0,n.useEffect)((()=>{if("boot"===R&&y){var e,o,n;const r=null==y?void 0:y.id,l=r?null===(e=(0,qn().v)(r))||void 0===e?void 0:e.viewType:void 0,s=l||(null==y?void 0:y.getType());C(l??(null==y?void 0:y.getType()));const u=null===(o=a.collectionViewBlockStore())||void 0===o?void 0:o.getTitleValue();var i;if(null!=u&&null!==(n=u[0])&&void 0!==n&&null!==(n=n[0])&&void 0!==n&&n.length)j(null===(i=a.collectionViewBlockStore())||void 0===i?void 0:i.getTitleValue());"chart"===s&&On().Z({environment:c,collectionContextStore:a,collectionViewId:r,from:"slash_menu"}).then((e=>{if("success"===(null==e?void 0:e.type)){const o=e.data.can_view_chart;B||o||"source"!==a.getCollectionViewBlockSourceState()||d().os({collectionSettingsStore:t})}})),V("initializing")}}),[B,a,t,y,c,R]);const F=(0,n.useCallback)((async e=>{const t=a.collectionViewStore(),n=a.collectionViewBlockStore();if(!t||!n)return;if(s)return void(A&&s(A));let i;b?i=b:null!=e&&e.length&&(i=(0,U().x9d)(e)),await async function(e){const{environment:t,collectionName:n,collectionContextStore:i,collectionViewBlockStore:r,collectionViewStore:a,baseViewType:l,createdCollectionRecordPointerMap:s,setCreatedCollection:c}=e,d=a,u=r;(0,qt().X)({environment:t,collectionContextStore:i,action:"select_new_collection"}),"chart"===l&&i.isCreatingNewChartCollectionStore.setState(!0);const{addCollectionViewSourceToNewCollection:g}=await o.e(12071).then(o.bind(o,711996));p().createAndCommit({userAction:"CollectionSettingsCreateViewSourceNew.handleCreateDB",environment:t,canUndo:!0,perform:e=>{zn().zv({store:d,data:{name:l?Gn().to[l]:void 0,query2:void 0,type:l??"table",..."chart"!==l&&{format:void 0}},transaction:e});const o=g({environment:t,collectionViewStore:d,collectionViewBlockStore:u,name:n,transaction:e,targetCollectionRecordPointerMap:s}),r=u.getCollectionViewSourceCollectionStore();i.setContext({type:"collectionView",collectionViewBlockStore:u,collectionStore:r,collectionViewStore:d,pageVisitSourceOverride:void 0}),c([r,o])}})}({environment:c,baseViewType:x,collectionName:i,collectionContextStore:a,collectionViewBlockStore:n,collectionViewStore:t,createdCollectionRecordPointerMap:_,setCreatedCollection:k})}),[a,b,c,x,_,k,s,A]);(0,n.useEffect)((()=>{if("initializing"===R){if(l)return k([l,_]),void V("initialized");const e=(null==f?void 0:f.getCollectionViewStores().length)||0;"source"===v?V("initialized_source"):"linked"===v&&e>1||a.isEditableHomeCollectionStore.state?V("initialized_linked"):(F(),V("initialized"))}}),[x,a,f,F,l,_,P,R,v,k]);const L=function(e){let{phase:t,baseViewType:o,createNewCollection:a,input:l,originalTitle:s}=e;const c=(0,i().v3)(),u=(0,mt().ET)(),g=u.settingsStore,m=(0,r().K8)((()=>Zn({environment:c,collectionContextStore:u})),[c,u]),[f,y]=(0,r().K8)((()=>[u.collectionViewBlockStore(),u.getCollectionViewBlockSourceState()]),[u]),h=(0,n.useMemo)((()=>o?Gn().to[o].toLocaleLowerCase():bo().A.formatMessage(vr.database).toString().toLocaleLowerCase()),[o]),v=(0,S().IS)((e=>({newItemIconStyle:{color:e.mediumIconColor,marginTop:2},newItemRightStyle:{alignItems:"top"},newDatabaseIconStyle:{fill:e.text.secondary,height:14,width:14}})),[]);return(0,r().K8)((()=>{if("initialized"===t||"initialized_source"===t)return m?{key:"newButton",render:e=>(0,w.jsx)(di().I,{buttonMenuItemProps:e,title:l.length>0?bo().A.formatMessage(vr.newDatabaseWithName,{name:l}):bo().A.formatMessage(vr.newEmptyDatabase),icon:(0,w.jsx)(Hn().y,{icon:(0,Kn().b)(v.newDatabaseIconStyle),backgroundSize:ur})}),action:()=>{var e;if("linked"===y)a(l);else if(l&&!s){const e=null==f?void 0:f.getTitleStore();e&&p().createAndCommit({userAction:"CollectionSettingsCreateViewSource.setTitleAfterNewInput",environment:c,canUndo:!0,perform:t=>{Nn().KY({environment:c,store:e,value:[[l]],transaction:t})}})}d().os({collectionSettingsStore:g}),"collection_view_page"!==(null===(e=u.collectionViewBlockStore())||void 0===e?void 0:e.getType())||0!==l.length||s||nt().default.afterNextFlush((()=>{(0,Un().P)({environment:c,collectionContextStore:u})}))}}:{key:"newButton",render:e=>(0,w.jsx)(D().A,{...e,icon:io().W,iconStyle:v.newItemIconStyle,rightStyle:v.newItemRightStyle,title:bo().A.formatMessage(vr.newViewType,{viewType:h}),caption:bo().A.formatMessage(vr.startBlankDatabase)}),action:()=>{var e,t;const n=u.collectionViewStore();if(!n||!f||!o)return;if(d().os({collectionSettingsStore:g}),"chart"===o)return;const i=(0,Wn().qP)({isInline:f.getType()===Fn().xd.collectionView,viewType:o,chartType:n.getChartPlaceholderType()}),r=f.getSpaceId()??n.getSpaceId()??(null===(e=fn().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??(null===(t=fn().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),s=r?c.idCreator.getSpaceIdCreatorSync(r):void 0,m=Dn().RecordMapLegacy.create();m.set({id:"block",table:z().ev},f.pointer),m.set({id:"view",table:Ln().Gy},n.pointer),p().createAndCommit({userAction:"useNewButtonMenuItem.handleNewButtonForViewType",environment:c,canUndo:!0,perform:e=>{En().j({environment:c,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,Dn().partialRecordMapToRecordMap)(i),targetRecordCache:f.inMemoryRecordCache,transaction:e,recordPointerMap:m,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:s})}}),a(l)}}}),[t,m,l,v,y,s,g,u,a,f,c,h,o])}({phase:R,baseViewType:x,createNewCollection:F,input:I,originalTitle:b}),O=(0,r().K8)((()=>t.state.hideSettingsHeader),[t]),E=(0,n.useCallback)((e=>{s?s(e):ci({collectionContextStore:a,environment:c,collectionStore:e,collectionSettingsStore:t,createdCollectionStore:A,userAction:"CollectionSettingsCreateViewSource.handleSourcePickerAccept"})}),[a,t,A,c,s]);return(0,w.jsx)(K().Ay,{...e,title:bo().A.formatMessage(vr.newDatabase),handleClose:()=>{d().os({collectionSettingsStore:t})},children:f&&(0,w.jsx)(pr,{collectionContextStore:a,collectionSettingsStore:t,parentStore:f,existingCollectionStore:A,createdCollectionRecordPointerMap:_,input:I,setInput:T,newButtonMenuItem:L,handleAcceptExistingCollection:E,context:Oi.Source,hideSearchTitle:O,onSelectCollection:s})})}const vr=(0,B().YK)({newViewType:{defaultMessage:"New {viewType}",id:"database.viewSettings.createView.newViewType"},newDatabase:{defaultMessage:"New database",id:"database.viewSettings.createViewTab.newDatabase"},newTable:{defaultMessage:"New table",id:"database.viewSettings.createViewTab.newTable"},newEmptyDatabase:{defaultMessage:"New empty database",id:"database.viewSettings.createViewTab.newEmptyDatabase"},newDatabaseWithName:{defaultMessage:"New {name} database",id:"database.viewSettings.createViewTab.newDatabaseWithName"},database:{defaultMessage:"Database",id:"database.viewSettings.createViewTab.view"},startBlankDatabase:{defaultMessage:"Start a blank database",id:"database.viewSettings.createViewTab.startBlankDatabase"}});var xr=o.n(o(844751)),Cr=()=>o(836251),br=()=>o(430171),wr=()=>o(95441);const jr=(0,B().YK)({searchPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.databaseProperties.searchPlaceholder"}}),Ar=ui().default.createClass("",{name:"InputStore"});function _r(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,a=(0,i().v3)(),l=(0,S().DP)(),s=(0,r().O$)(t.normalizedSchemaStore),c=(0,r().O$)(t.permissionScopesStore),u=(0,r().uB)(void 0,Ar),p=(0,r().O$)(u),g=(0,n.useMemo)((()=>{const e=p.toLowerCase();return e?Object.entries(s).filter((t=>{let[o,n]=t;return!!n&&xr().test(e,n.name.toLowerCase())})):Object.entries(s)}),[s,p]),m=c.canConfigureCollection&&!c.isExternallyImportedAndSyncedCollection,f=(0,n.useCallback)((()=>{(0,br().c)({environment:a,collectionContextStore:t})}),[a,t]),y=(0,n.useCallback)((e=>{d().a2({collectionSettingsStore:o,item:{type:"property",property:e,formatKey:void 0}})}),[o]),h=(0,S().IS)((e=>({title:{display:"flex",alignItems:"center"},propertiesContainer:{paddingTop:8,paddingBottom:8},propertyIcon:{fill:e.regularIconColor}})),[]);return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)("div",{style:h.title,children:(0,w.jsx)(B().sA,{defaultMessage:"Properties",id:"database.viewSettings.databaseProperties.title"})}),header:(0,w.jsx)(oe().A,{children:(0,w.jsx)(xo().Ay,{placeholder:bo().A.formatMessage(jr.searchPlaceholder),value:p,onChange:e=>u.setState(e.target.value)})}),footer:(0,w.jsxs)(oe().A,{topBorder:!0,children:[m&&(0,w.jsx)(D().A,{icon:io().W,title:(0,w.jsx)(B().sA,{defaultMessage:"New property",id:"database.viewSettings.databaseProperties.newProperty"}),isGray:!0,onClick:f}),(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.databaseProperties"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.databaseProperties.learnMoreButton.title"}),analyticsFrom:"database_settings_properties"})]}),children:(0,w.jsx)("div",{style:h.propertiesContainer,children:g.map((e=>{let[t,o]=e;return o?(0,w.jsx)(D().A,{icon:e=>(0,w.jsx)(fo().Ay,{type:o.type,icon:o.icon,size:16,style:{...e,...h.propertyIcon},theme:l}),title:o.name,onClick:()=>y(t),showChevron:!0},t):null}))})})}var Mr=()=>o(657222),kr=()=>o(645395),Ir=()=>o(436572),Tr=()=>o(368472),Pr=()=>o(691093),Br=()=>o(56516);const Rr=(0,B().YK)({copySuccessMessage:{defaultMessage:"Link to database copied to clipboard",id:"database.viewSettings.databaseSettings.copyLinkSnackBarItem.title"},deleteButtonLabel:{defaultMessage:"Delete",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.title"},detachButtonLabel:{defaultMessage:"Detach",id:"database.viewSettings.databaseSettings.detachDatabaseButton.title"},cancelButtonLabel:{defaultMessage:"Cancel",id:"database.viewSettings.databaseSettings.cancelButton.title"}});function Vr(e){const t=(0,i().v3)(),o=(0,S().IS)((()=>({title:{display:"flex",alignItems:"center"}})),[]),n=(0,r().K8)((()=>{const t=e.collectionContextStore.collectionViewBlockStore();if(!t)return;const o=e.collectionContextStore.collectionStore();if(!o)return;const n=o.getSchemaStore().getValue(),i=t.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),r=o.getAutomationStores(),a=o.getParentId()===t.id;return{collectionViewBlockStore:t,collectionStore:o,schema:n,views:i,automations:r,isSourceDatabase:a}}),[e.collectionContextStore]);if(!n)return null;const a=n.isSourceDatabase?(0,w.jsx)(B().sA,{defaultMessage:"Delete database",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirm"}):(0,w.jsx)(B().sA,{defaultMessage:"Detach database",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirm"});return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)("div",{style:o.title,children:(0,w.jsx)(B().sA,{defaultMessage:"Database options",id:"database.viewSettings.databaseSettings.title"})}),children:[(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(D().A,{icon:kr().j,showChevron:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"Properties",id:"database.viewSettings.databaseSettings.properties"}),onClick:()=>{d().a2({collectionSettingsStore:e.collectionSettingsStore,item:{type:"databaseProperties"}})}}),(0,w.jsx)(Br().GS,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,w.jsx)(Tr().lP,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,w.jsx)(Br().is,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore})]}),(0,w.jsxs)(oe().A,{topBorder:!0,children:[(0,w.jsx)(D().A,{icon:Mr().w,title:(0,w.jsx)(B().sA,{defaultMessage:"Copy link to database",id:"database.viewSettings.databaseSettings.copyLinkButton.title"}),onClick:async()=>{const e=await cn().R.clipboardActions.load();await e.copyString({environment:t,stringValue:window.location.href,copiedMessage:e.clipboardMessages.copiedLinkToClipboard}),Ir().D6({label:bo().A.formatMessage(Rr.copySuccessMessage)})}}),(0,w.jsx)(D().A,{icon:P().I,isRed:!0,title:a,onClick:async()=>{if(!n)return;const{collectionStore:e,collectionViewBlockStore:o,isSourceDatabase:i}=n,r=i?(0,w.jsx)(B().sA,{defaultMessage:"{databaseCount, plural, one {# database} other {# databases}}, {propertyCount, plural, one {# property} other {# properties}}, {viewCount, plural, one {# view} other {# views}}, {automationCount, plural, one {# automation} other {# automations}} will be deleted",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirmDescription",values:{databaseCount:1,propertyCount:Object.keys(n.schema??{}).length,viewCount:n.views.length,automationCount:n.automations.length}}):(0,w.jsx)(B().sA,{defaultMessage:"{viewCount, plural, one {# view} other {# views}} will be deleted. The database will not be deleted.",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirmDescription",values:{viewCount:n.views.length}}),{accept:l}=await V().Gh({message:a,description:r,acceptLabel:bo().A.formatMessage(i?Rr.deleteButtonLabel:Rr.detachButtonLabel),cancelLabel:bo().A.formatMessage(Rr.cancelButtonLabel),cancelButtonType:"plain",cancelColor:"gray"});l&&(p().createAndCommit({environment:t,userAction:"CollectionSettingsDatabaseSettings.handleDeleteDatabase",canUndo:!0,perform:t=>{(0,Xn().h)({collectionViewBlockStore:o,collectionStore:e,transaction:t})}}),(0,Pr().updateWorkflowNavigationState)({environment:t,navigationState:{type:"configure"},redirect:!0}))}})]})]})}const Fr={viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{d:"M6.162 3.038a.625.625 0 0 0-.884 0l-3.52 3.52a.625.625 0 0 0 0 .884l3.52 3.52a.625.625 0 1 0 .884-.884L3.709 7.625H11.2a1.975 1.975 0 1 1 0 3.95h-1.136a.625.625 0 0 0 0 1.25H11.2a3.225 3.225 0 1 0 0-6.45H3.709l2.453-2.453a.625.625 0 0 0 0-.884"})},Kr=(0,b().wt)("arrowUTurnUpLeftSmall",Fr);var Dr=()=>o(912720),Lr=()=>o(813297),Or=()=>o(254497),Er=()=>o(285790),zr=()=>o(678553),Nr=()=>o(525432),Ur=()=>o(447934);const Hr=(0,B().YK)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"}});function Wr(e){let{collectionSettingsStore:t,collectionContextStore:a,timelineViewTab:l}=e;const s=(0,i().v3)(),c=(0,S().DP)(),u=(0,r().O$)(a.normalizedDeletedSchemaStore),g=(0,o(7667).A)(),m=(0,n.useCallback)((e=>{g(e);const o=(0,Nr().ZI)({timelineViewTab:l,collectionContextStore:a});d().yl({collectionSettingsStore:t}),d().a2({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:o}})}),[a,t,g,l]),f=(0,n.useCallback)((()=>{const e=Object.entries(u).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(W().O9);return 0===e.length?(0,w.jsx)(oe().A,{children:(0,w.jsx)(zr().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,w.jsx)(oe().A,{children:e.map((e=>{let{propertyId:t,propertySchema:n}=e;return(0,w.jsx)(zr().A,{title:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,w.jsx)(fo().Ay,{type:n.type,icon:n.icon,size:16,theme:c,style:{fill:c.regularIconColor}}),(0,w.jsx)("span",{style:{marginLeft:6,maxWidth:200,...R().RC},children:n.name})]}),right:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Er().A,{icon:Kr,iconStyle:{width:b().Ev.sm,height:b().Ev.sm},ariaLabel:bo().A.formatMessage(Hr.undo),onClick:()=>m(t)}),(0,w.jsx)(Er().A,{icon:o(259476).h,iconStyle:{width:b().Ev.sm,height:b().Ev.sm},ariaLabel:bo().A.formatMessage(Hr.delete),onClick:()=>{!async function(e,t,o){const{automationActions:n}=await Lr().QV.automations.load();V().ui({message:(0,w.jsx)(B().sA,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,w.jsx)(B().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:async()=>{const i=t.collectionStore();if(i){const t=i.getLayoutStore();await(null==t?void 0:t.load());const r=function(e,t){const o=e.getDeletedSchema(),n=o[t];if((0,W().O9)(n)&&(0,mo().nu)(n)&&n.automation_id)return Y().dn.createChildStore(e,{id:n.automation_id,spaceId:e.getSpaceId(),table:Dr().yB})}(i,e);p().createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,canUndo:!0,perform:a=>{t&&(0,Ur().HD)({environment:o,layoutStore:t,property:e,transaction:a}),(0,Or().E)({collectionStore:i,update:{[e]:null},transaction:a}),r&&n.deleteAutomation({automationStore:r,environment:o,transaction:a})}})}}}]})}(t,a,s)}})]})},t)}))})}),[a,u,s,m,c]);return(0,w.jsx)(K().Ay,{collectionSettingsStore:t,title:(0,w.jsx)(B().sA,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:f()})}const Gr=n.memo(Wr,pi().A);var qr=()=>o(221844),Yr=()=>o(395361),$r=()=>o(118884),Qr=()=>o(617668),Zr=()=>o(760077),Jr=()=>o(31902);const Xr=(0,B().YK)({inputPlaceholder:{defaultMessage:"Search for a view",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}}),ea=7;function ta(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,a=(0,i().v3)(),l=(0,i().Y0)(),s=(0,S().DP)(),c=(0,n.useMemo)((()=>new(qr().A)({name:"CollectionSettingsDuplicateExistingView"})),[]),u=(0,r().uB)(void 0,fi().A),[p,g]=(0,n.useState)(""),[m,f]=(0,n.useState)(!0),y=(0,n.useRef)({lastDuplicatedViewId:void 0,didAccept:!1,wentBack:!1,initialViewType:void 0,preselectedViewPointer:void 0}),h=(0,r().O$)(t.collectionSettingsDuplicateExistingViewLimitStore),v=(0,vi().X)("duplicate_existing_view_store"),x=(0,n.useMemo)((()=>v?h:m),[v,h,m]),C=(0,n.useCallback)((e=>{v?t.collectionSettingsDuplicateExistingViewLimitStore.setState(e):f(e)}),[t.collectionSettingsDuplicateExistingViewLimitStore,v]),b=(0,n.useCallback)(((e,o)=>{if(e.id===y.current.lastDuplicatedViewId&&o)return;y.current.lastDuplicatedViewId=e.id;const n=t.collectionViewStore();if(!n)return;let i=n;o&&(i=n.clone(c)),(0,Zr().U)({viewToDuplicateStore:e,collectionContextStore:t,collectionViewStore:n,environment:a,temporaryStore:i})}),[t,a,c]);(0,Hi().w)((()=>{const e=t.collectionViewStore();if(!e)return;const o=(0,qn().v)(e.id);y.current.preselectedViewPointer=null==o?void 0:o.viewPointer,a.defaultRecordCache.inMemoryRecordCache.addCacheOverride(c),y.current.initialViewType=e.getType()})),(0,$r().X)((()=>{const e=y.current;if(a.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(c),!e.didAccept&&!e.wentBack){const{viewStores:o}=na(t,p,x),n=o.find((t=>t.id===e.lastDuplicatedViewId));if(!n)return;b(n,!1)}}));const j=(0,n.useCallback)((e=>{if(void 0===e)return y.current.lastDuplicatedViewId=void 0,void c.clearCache();b(e,!0)}),[b,c]),A=(0,Yr().Y)(j,500);(0,r().K8)((()=>{const e=u.state;if(l.isMobile||void 0===e.focus.indexLocal)return;const o=p.length>0;if(!o&&0===e.focus.section||o&&1===e.focus.section)return void A(void 0);const n=na(t,p,x).viewStores,i=e.focus.indexLocal;if(i<0||i>=n.length)return;const r=n[i];A(r)}),[t,l.isMobile,A,p,x,u]);const _=(0,n.useCallback)((e=>{a.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(c),(0,qt().X)({environment:a,collectionContextStore:t,action:"click_duplicate_view"}),b(e,!1),d().R8({collectionSettingsStore:o,item:{type:"main",selectViewNameInitial:!0}}),y.current.didAccept=!0,C(!0)}),[t,o,b,a,C,c]),M=(0,n.useCallback)((()=>{(0,qt().X)({environment:a,collectionContextStore:t,action:"click_new_empty_view"}),d().os({collectionSettingsStore:o}),d().a2({collectionSettingsStore:o,item:{type:"createView"}}),y.current.didAccept=!0,C(!0)}),[t,o,a,C]),{viewStores:k,showMore:I}=(0,r().K8)((()=>na(t,p,x)),[t,p,x]),T=(0,r().K8)((()=>{var e;return function(e){const{theme:t,viewStores:o,showMore:n,preselectedViewPointerId:i,onDuplicateViewAccept:r,onShowMore:a}=e,l=Ai().oE(o.map((e=>{const t=e.getType(),o=e.getFormat().collection_view_icon;if(!t||"page"===t)return;const n=e.getName(),a=e.id,l={key:a,render:e=>(0,w.jsx)($().A,{...e,title:(0,w.jsx)(Jr().A,{collectionViewType:t,collectionViewName:n}),icon:(0,w.jsx)(In().h,{color:"regular",viewIcon:o,viewType:t,style:{marginRight:4,marginLeft:2}}),checkState:i===a}),action:()=>{r(e)}};return l})));if(n>0){const e={key:"showMore",render:e=>(0,w.jsx)($().A,{...e,icon:(0,wi()._)({width:16,height:16,color:t.mediumTextColor}),style:{color:t.mediumTextColor},title:(0,w.jsx)(B().sA,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:n}})}),action:()=>{a()}};l.push(e)}return l}({viewStores:k,showMore:I,preselectedViewPointerId:null===(e=y.current.preselectedViewPointer)||void 0===e?void 0:e.id,onDuplicateViewAccept:_,onShowMore:()=>{C(!1)},theme:s})}),[_,C,I,s,k]),P=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]),R=(0,n.useCallback)((e=>{g(e),u.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),C(!0)}),[u,C]),V=(0,n.useCallback)((()=>{y.current.wentBack=!0,d().yl({collectionSettingsStore:o})}),[o]);return(0,w.jsx)(oa,{collectionSettingsStore:o,collectionName:P,inputValue:p,onInputValueChange:R,menuListItems:T,showMore:I,initialViewType:y.current.initialViewType,menuListStore:u,onNewEmptyViewClick:M,onBackArrowClick:V})}function oa(e){const{collectionSettingsStore:t,collectionName:o,inputValue:r,menuListItems:a,showMore:l,initialViewType:s,menuListStore:c,onNewEmptyViewClick:d,onBackArrowClick:u,onInputValueChange:p}=e,g=(0,i().Y0)(),m=(0,S().IS)((e=>({plusIconStyle:{color:e.mediumIconColor}})),[]),f=(0,n.useMemo)((()=>{const e=s?Gn().to[s].toLocaleLowerCase():void 0;return e?(0,w.jsx)(B().sA,{defaultMessage:"New {viewType} view",id:"database.viewSettings.createViewTab.newView1",values:{viewType:e}}):(0,w.jsx)(B().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView2"})}),[s]),y=(0,n.useMemo)((()=>({key:"emptyViewSection",items:[{key:"emptyViewMenuItem",render:e=>(0,w.jsx)(D().A,{...e,icon:Qr().plusIcon,iconStyle:m.plusIconStyle,title:f}),action:d}],render:e=>(0,w.jsx)(oe().A,{topBorder:r.length>0,...e})})),[f,r.length,d,m.plusIconStyle]);return(0,w.jsxs)(K().Ay,{collectionSettingsStore:t,title:(0,w.jsx)(B().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}),handleBackArrowClick:u,children:[l>0||r?(0,w.jsx)(oe().A,{children:(0,w.jsx)(xo().Ay,{focusInitial:!g.isMobile||void 0,value:r,onChange:e=>{p(e.target.value)},placeholder:bo().A.formatMessage(Xr.inputPlaceholder),showClearButton:!0})}):null,(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:Ai().oE([r.length?void 0:y,{key:"results",render:e=>0===a.length?(0,w.jsx)(_i().A,{caption:(0,w.jsx)(B().sA,{defaultMessage:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})}):(0,w.jsx)(oe().A,{title:o?(0,w.jsx)(B().sA,{defaultMessage:"Views on {collectionName}",id:"database.viewSettings.duplicateExistingViewTab.viewsTitle",values:{collectionName:o}}):(0,w.jsx)(B().sA,{defaultMessage:"Existing views",id:"database.viewSettings.duplicateExistingViewTab.viewsTitleExistingViews"}),...e}),items:a},r.length?y:void 0]),store:c})]})}function na(e,t,o){const n=e.collectionViewBlockStore(),i=e.collectionStore(),r=e.collectionViewStore();if(!n||!i||!r)return{viewStores:[],showMore:0};const a=i.getParentBlockStore();if(!n||!a)return{viewStores:[],showMore:0};let l=(0,ut().Mf)({collectionStore:i,sourceCollectionViewBlockStore:a,currentCollectionViewBlockStore:n,currentCollectionViewStore:r,constraints:(0,qn().v)(r.id)}),s=0;return t?l=l.filter((e=>(0,ut().As)(e,t))):o&&(s=l.length-ea,l=l.slice(0,ea)),{viewStores:l,showMore:s}}var ia=()=>o(484392),ra=()=>o(442277),aa=()=>o(206267),la=()=>o(282883),sa=()=>o(824862),ca=()=>o(763824),da=()=>o(864943),ua=()=>o(635676),pa=()=>o(504836),ga=()=>o(666803),ma=()=>o(404141),fa=()=>o(10984);const ya=(0,B().YK)({inputPlaceholder:{defaultMessage:"Search for a project...",id:"database.viewSettings.collectionSettingsExternalListProjects.inputPlaceholder"},fetchingProjects:{defaultMessage:"Loading projects from Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjects"},fetchingProjectsFailed:{defaultMessage:"We're experiencing temporary issues with Jira's APIs. Please try again in a sometime.",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjectsFailed"},defaultLoadingMessage:{defaultMessage:"Loading...",id:"database.viewSettings.collectionSettingsExternalListProjects.loading"},somethingWentWrong:{defaultMessage:"Something went wrong. Please try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.somethingWentWrong"},authInProgress:{defaultMessage:"Authenticating with Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.authInProgress"},authFailed:{defaultMessage:"Authentication failed, try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.authFailed"},noAccessToSite:{defaultMessage:"If you have multiple Jira sites, make sure you're authenticating into {site}",id:"database.viewSettings.collectionSettingsExternalListProjects.noAccessToSite"}});function Sa(e){switch(e){case"fetchingProjects":return ya.fetchingProjects;case"somethingWentWrong":return ya.somethingWentWrong;case"fetchingProjectsFailed":return ya.fetchingProjectsFailed;case"authFailed":return ya.authFailed;case"authInProgress":return ya.authInProgress;case"noAccessToSite":return ya.noAccessToSite;default:return ya.defaultLoadingMessage}}function ha(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,[a,s]=n.useState(""),[c,u]=n.useState(!1),[p,g]=n.useState([]),[m,f]=n.useState(!1),[y,h]=n.useState(0),[x,C]=n.useState(!1),[b,j]=n.useState([]),[A,_]=n.useState([]),[k,I]=n.useState([]),[T,P]=n.useState({show:!1}),[F,D]=n.useState(!1),[L,O]=n.useState({show:!1}),[E,z]=n.useState(""),N=(0,i().v3)(),U=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),W=(0,r().K8)((()=>fn().default.state.currentSpaceStore),[]),G=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().bot_id}),[t]),[{value:q}]=(0,v().Yb)((async()=>{if(G&&U)return ae().callApi({eventName:"getExternalConnectionMetaInfo",environment:N,data:{botId:G,spaceId:U}})}),[N,G,U]);(0,n.useEffect)((()=>{"success"===(null==q?void 0:q.type)&&"data"in q&&z(q.data.email)}),[q]);const Q=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().synced_collection_external_url}),[t]),J=(0,r().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.synced_collection_instance_type)??"Cloud"}),[t]),X=(0,r().K8)((()=>"DataCenter"===J?"jira-dc":"jira"),[J]),ee=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.external_collection_type}),[t]),te=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat();return Boolean(null==o?void 0:o.sync_state)}),[t]),oe=(0,r().O$)(ga().Ay),{projectCollectionPointer:ne,taskCollectionPointer:ie}=(0,r().K8)((()=>(0,pa().Be)(t.collectionStore())),[t]),re=(0,r().K8)((()=>{if(G&&W){return Y().vK.createChildStore(W,{table:sa().GP,id:G,spaceId:W.id}).getLastEditedById()}return null}),[G,W]),le=(0,r().K8)((()=>(null==W?void 0:W.userId)===re),[re,W]),se=(0,r().K8)((()=>{const e=ga().Ay.state.flowId||aa().JW();return ga().Ay.setState({...ga().Ay.state,flowId:e}),e}),[]),ce=(0,r().K8)((()=>oe.projectKeys),[oe]),[{value:de}]=(0,v().Yb)((async()=>U&&G&&ne?(P({show:!0,type:"fetchingProjects"}),"DataCenter"===J&&(0,pa().ru)()?ae().callStreamApi({eventName:"streamProjectsForJiraSite",environment:N,data:{botId:G,spaceId:U,projectCollectionPointer:ne}}):ae().callApi({eventName:"getProjectsForJiraSite",environment:N,data:{botId:G,spaceId:U,projectCollectionPointer:ne}})):null),[N,ne,U,G,J]),ue=(0,r().K8)((()=>fa().dL()),[]);(0,n.useEffect)((()=>{ue&&y>100?(f(!0),(0,l().u4)({environment:N,event:{eventName:"external_sync_setup_action",eventProperties:{integration:X,actionType:"issues_free_limit_exceeded",flowId:se,issueCount:y,isSyncOwner:le}}})):f(!1)}),[N,se,ue,y,le,X]);const pe=(0,n.useCallback)((e=>{const{jiraProjects:t,permittedProjects:o,existingImportedProjectKeys:n}=e;I(n);const i=o.map((e=>e.key));j(i);const r=[...t.filter((e=>{let{isPrivate:t}=e;return!t})).sort(((e,t)=>{var o,n;return t.insight&&e.insight?null!==(o=t.insight)&&void 0!==o&&o.lastIssueUpdateTime&&null!==(n=e.insight)&&void 0!==n&&n.lastIssueUpdateTime?new Date(t.insight.lastIssueUpdateTime).getTime()-new Date(e.insight.lastIssueUpdateTime).getTime():t.insight.totalIssueCount-e.insight.totalIssueCount:1})),...t.filter((e=>{let{isPrivate:t}=e;return t})).sort(((e,t)=>{const o=i.includes(e.key),n=i.includes(t.key);return o&&n?0:o?-1:1}))];let a=0;r.forEach((e=>{var t;n.includes(e.key)&&(a+=(null===(t=e.insight)||void 0===t?void 0:t.totalIssueCount)??0)})),_(r),h(a);const l=Ai().sb([...n,...ce||[]]);n.length&&u(!0),l&&g(l)}),[ce]),ge=(0,n.useCallback)((async e=>{const{response:t}=e;let o=!1;try{for await(const e of t){if("error"===e.type)return P({show:!1}),D(!1),!("code"in e)||"SITE_NOT_FOUND"!==e.code&&"NO_USER_BOT_FOUND"!==e.code&&"INVALID_BOT"!==e.code||le?void O({show:!0,type:"fetchingProjectsFailed"}):void C(!0);if(!o){u(!0),I(e.existingImportedProjectKeys);const t=Ai().sb([...e.existingImportedProjectKeys,...ce||[]]);g(t),o=!0,P({show:!1})}_((t=>Ai().Mp([...t,...e.permittedProjects],((e,t)=>e.key===t.key)))),j((t=>Ai().sb([...t,...e.permittedProjects.map((e=>e.key))])))}}finally{D(!1)}}),[ce,le]);(0,n.useEffect)((()=>{if("success"!==(null==de?void 0:de.type)&&"failed"!==(null==de?void 0:de.type)||("Cloud"!==J&&(0,pa().ru)()||P({show:!1}),"failed"===(null==de?void 0:de.type)&&O({show:!0,type:"fetchingProjectsFailed"})),"success"===(null==de?void 0:de.type)&&"data"in de&&"object"==typeof de.data)if("code"in de.data){if(!le){const{code:e}=de.data;"SITE_NOT_FOUND"===e?(C(!0),O({show:!0,type:"noAccessToSite"})):"NO_USER_BOT_FOUND"!==e&&"INVALID_BOT"!==e||C(!0),(0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,actionType:"member_auth_render",flowId:se}}})}}else"DataCenter"===J&&(0,pa().ru)()&&Symbol.asyncIterator in de.data?(D(!0),ge({response:de.data})):pe(de.data)}),[de,le,pe,ge,N,se,J,X]);const me=ee?ua().l[ee]:"",fe=(0,r().K8)((()=>{const e=ga().Ay.state;return e.isMemberAuthSuccessForDataCenter&&!e.open&&"DataCenter"===e.instanceValue&&e.site&&"dc-auth"===e.type}),[]);(0,v().Yb)((async()=>{if(!le&&ne&&U&&G&&fe&&(0,pa().Zf)()&&(0,pa().ru)()){C(!1),P({show:!0,type:"fetchingProjects"}),_([]),D(!0);try{const e=await ae().callStreamApi({eventName:"streamProjectsForJiraSite",environment:N,data:{botId:G,spaceId:U,projectCollectionPointer:ne}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&await ge({response:e.data})}catch(e){D(!1),O({show:!0,type:"fetchingProjectsFailed"})}}}),[G,U,ne,N,ge,fe,le]);const ye=(0,S().IS)((e=>{const t="dark"===e.mode;return{fetchingProjects:{width:"100%",height:"100%",paddingBottom:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:14,paddingLeft:8,paddingRight:8,color:e.mediumTextColor,textAlign:"center"},settingsMenu:{padding:"8px"},projectIcon:{width:20,height:20,borderRadius:4,..."Cloud"===J&&{marginBottom:14}},connectAccountWrapper:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:12,padding:12,flexDirection:"column",gap:8},connectAccountCTA:{borderRadius:6},connectAccountDescription:{fontSize:R().J.UIRegular.desktop,textAlign:"center",color:e.text.secondary},errorMessage:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",height:"100%",color:an().Ay.red,paddingLeft:8,paddingRight:8,fontSize:R().J.UIRegular.desktop},authErrorMessage:{fontSize:R().J.UIRegular.desktop,color:e.text.secondary,marginBottom:12,textAlign:"center"},permittedProjectItemTitle:{fontSize:R().J.UISmall.desktop,fontWeight:R().Wy.medium},permittedProjectItemCaption:{fontSize:R().J.UISmall.desktop,color:_n().l8.dark.gray,fontWeight:R().Wy.regular},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},sectionMargin:{margin:"0px 14px"},projectVisibilityCallout:{fontSize:R().J.UISmall.desktop,...!t&&{backgroundColor:an().Ay.EmailLinkBackground},padding:"6px 8px",marginBottom:6,borderRadius:6,color:e.text.secondary},privateProjectCallout:{width:"-webkit-fill-available",padding:"0px 16px",color:e.text.secondary,marginLeft:4,marginRight:4},helpIcon:{width:12,height:12,display:"inline-block"},menuListItem:{paddingTop:"0px",paddingBottom:"0px"},checkBox:{borderRadius:2,..."Cloud"===J&&{marginBottom:14}},deskTopIcon:{..."Cloud"===J&&{alignSelf:"center"}}}}),[J]);if(!G||!U)return null;const Se=A.length?(0,So().Ay)(a,A,(e=>e.name)):[],he=e=>{const t=e.key;var o,n;p.includes(t)?(g(p.filter((e=>e!==t))),h(y-((null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0))):(g([...p,t]),h(y+((null===(n=e.insight)||void 0===n?void 0:n.totalIssueCount)??0)))},ve=()=>{const e=A.filter((e=>be(e.key)));if(p.length===e.length)g([]),h(0);else{let e=0;g(A.filter((e=>be(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key}))),h(e)}},xe=()=>{let e=0;const t=A.filter((e=>!k.includes(e.key)&&be(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key})),o=p.filter((e=>!t.includes(e)));if(t.every((e=>p.includes(e))))g(o),h(y-e);else{g([...o,...t]);let e=0;for(const t of p){const o=A.find((e=>e.key===t));var n;if(o)e+=(null===(n=o.insight)||void 0===n?void 0:n.totalIssueCount)??0}h(e)}},Ce=()=>{const e=p.filter((e=>!k.includes(e)));k.every((e=>p.includes(e)))?g(e):g([...e,...k]);let t=0;for(const n of p){const e=A.find((e=>e.key===n));var o;if(e)t+=(null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0}h(t)},be=e=>b.includes(e),we=Q&&(0,ia().A)((0,pa().ay)(Q)),je=Se.map((e=>({key:e.id,render:()=>(0,w.jsx)(ao().A,{disableTooltip:be(e.key),renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:Te}),render:t=>(0,w.jsx)($().A,{...t,style:ye.menuListItem,focused:!1,buttonStyle:be(e.key)?{}:ye.disabledItem,disabled:!be(e.key),onClick:()=>{he(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,disabled:!be(e.key),checked:p.includes(e.key),onClick:()=>{he(e)},style:ye.checkBox})}),icon:(0,w.jsx)("img",{src:e.avatarUrls["48x48"],style:ye.projectIcon}),desktopIconStyle:ye.deskTopIcon,caption:e.insight&&(0,w.jsx)("div",{children:e.isPrivate?(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Ae=Se.filter((e=>k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,w.jsx)(ao().A,{disableTooltip:be(e.key),renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:Te}),render:t=>(0,w.jsx)($().A,{...t,style:ye.menuListItem,focused:!1,buttonStyle:be(e.key)?{}:ye.disabledItem,disabled:!be(e.key),onClick:()=>{he(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,disabled:!be(e.key),checked:p.includes(e.key),onClick:()=>{he(e)},style:ye.checkBox})}),icon:(0,w.jsx)("img",{src:e.avatarUrls["48x48"],style:ye.projectIcon}),desktopIconStyle:ye.deskTopIcon,caption:e.insight&&(0,w.jsx)("div",{children:e.isPrivate?(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),_e=Se.filter((e=>!k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,w.jsx)(ao().A,{disableTooltip:be(e.key),renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:Te}),render:t=>(0,w.jsx)($().A,{...t,style:ye.menuListItem,focused:!1,buttonStyle:be(e.key)?{}:ye.disabledItem,disabled:!be(e.key),onClick:()=>{he(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,disabled:!be(e.key),checked:p.includes(e.key),onClick:()=>{he(e)},style:ye.checkBox})}),desktopIconStyle:ye.deskTopIcon,icon:(0,w.jsx)("img",{src:e.avatarUrls["48x48"],style:ye.projectIcon}),caption:e.insight&&(0,w.jsx)("div",{children:e.isPrivate?(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,w.jsx)(B().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Me=(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:ye.permittedProjectItemTitle,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.userTooltipTitleForPrivatePages",defaultMessage:"Only some private projects can be synced to Notion"})}),(0,w.jsx)("div",{style:ye.permittedProjectItemCaption,children:le?(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.owner.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects they have access to. Click to view the help center",values:{email:E,site:we||"This"}}):(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.member.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects that both have access to. Click to view the help center",values:{email:E,site:we||"This"}})})]}),ke=()=>(0,w.jsxs)("div",{style:{...ye.sectionMargin,...ye.projectVisibilityCallout},children:[(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCallout",defaultMessage:"Syncing these projects will make them visible to everyone with access to this database "}),(0,w.jsx)(ao().A,{renderTooltip:e=>(0,w.jsxs)("div",{...e,style:zo().Q$,children:[(0,w.jsx)("div",{style:ye.permittedProjectItemTitle,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.title",defaultMessage:"To restrict access, create a new Jira sync database"})}),(0,w.jsx)("div",{style:ye.permittedProjectItemCaption,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.description",defaultMessage:"Use the Share menu to choose who can access the database, then sync your private projects"})})]}),alignment:so().C.Start,render:e=>(0,w.jsx)("div",{...e,style:{display:"inline",position:"relative",top:2},children:(0,w.jsx)("span",{children:(0,M().$)(ye.helpIcon)})})})]}),Ie=()=>(0,w.jsx)(ao().A,{renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:Me}),render:e=>(0,w.jsx)(Oo().p,{...e,style:ye.privateProjectCallout,children:(0,w.jsxs)(Z().A,{className:"notion-print-ignore",href:(0,Cr().xS)("guides.externalImportAndSync"),external:!0,children:[(0,M().$)({...ye.helpIcon,marginRight:6}),(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects..privateProjectNotFound",defaultMessage:"Can't find a private project?"})]})})}),Te=le?(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.tooltipMessageForPrivatePages",defaultMessage:"You don't have access to this project in Jira"}):Me;async function Pe(){O({show:!1});const e="DataCenter"===J?wo().Fv:wo().me,t=co().A.integrations.state.find((t=>{let{id:o}=t;return o===e}));if(!t||!U)return;(0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,actionType:"member_auth_initiated",flowId:se}}}),e===wo().Fv&&ga().Ay.setState({...ga().Ay.state,site:Q});const o=N.device.isElectron?await async function(e,t){const o=await ro().Jq({environment:N,integration:e,spaceId:t,from:"connected_apps_settings"});P({show:!0,type:"authInProgress"});const n=co().A.externalAuthentications.state,i=performance.now()+6e4,r=ca().yX(),a=setInterval((()=>{const e=performance.now();i<e?r.resolve(void 0):co().A.externalAuthentications.state.length>n.length&&r.resolve("success")}),1e3);return await r.promise,clearInterval(a),P({show:!1}),o}(t,U):await ro().Jq({environment:N,integration:t,spaceId:U,from:"connected_apps_settings"});if("DataCenter"!==J||le)if(C(!1),o&&H().Q.isSuccess(o)){if(!G||!ne)return;if((0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,flowId:se,status:"success",actionType:"member_auth_status"}}}),P({show:!0,type:"fetchingProjects"}),"DataCenter"===J&&(0,pa().ru)()&&le){_([]);try{const e=await ae().callStreamApi({eventName:"streamProjectsForJiraSite",environment:N,data:{botId:G,spaceId:U,projectCollectionPointer:ne}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&(D(!0),ge({response:e.data}))}catch(i){O({show:!0,type:"fetchingProjectsFailed"})}}else{var n;const e=await ae().callApi({eventName:"getProjectsForJiraSite",environment:N,data:{botId:G,spaceId:U,projectCollectionPointer:ne,userBotId:null===(n=o.value)||void 0===n||null===(n=n.externalAuthentication)||void 0===n?void 0:n.id}});P({show:!1}),"success"===e.type?"code"in e.data?"SITE_NOT_FOUND"===e.data.code?(C(!0),V().ui({message:(0,w.jsx)(Ca,{site:Q,integrationIconUrl:me,connectAccount:Pe}),showCancel:!1,keepFocus:!0,innerStyle:{width:320,padding:18},items:[]}),(0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,actionType:"member_auth_render",flowId:se}}})):"NO_USER_BOT_FOUND"===e.data.code?(C(!0),O({type:"somethingWentWrong",show:!0}),(0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,actionType:"member_auth_render",flowId:se}}})):O({type:"fetchingProjectsFailed",show:!0}):pe(e.data):O({type:"fetchingProjectsFailed",show:!0})}}else C(!0),O({type:"authFailed",show:!0}),(0,l().u4)({environment:N,event:{eventName:"external_sync_auth",eventProperties:{integration:X,flowId:se,status:"failed",actionType:"member_auth_status"}}})}return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListProjects.title",values:{title:te?"Synced projects":"Select projects"}}),header:!T.show&&!x&&!L.show&&(0,w.jsx)(va,{inputValue:a,onChange:s}),handleClose:()=>{ga().Ay.setState({...oe,projectKeys:[],site:void 0,isMemberAuthSuccessForDataCenter:!1}),d().os({collectionSettingsStore:o})},footer:!T.show&&!x&&!L.show&&(0,w.jsx)(xa,{onActionButtonClick:()=>{const e={};A.forEach((t=>{var o;t.insight&&(p.includes(t.key)&&(e[t.key]=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0))})),d().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:mo().Sh.SyncProjects,selectedProjectKeys:p,projectIssueCounts:e}}),ga().Ay.setState({...ga().Ay.state,projectKeys:[]}),(0,l().u4)({environment:N,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:X,actionType:"select_properties_cta_click",flowId:se,identifier:Q,botId:G,collectionId:null==ie?void 0:ie.id,isSyncOwner:le}}})},disabled:!c&&0===p.length,selectedProjectKeysLength:p.length,isSetupComplete:te,shouldShowUpgradePlan:m,flowId:se,isSyncOwner:le,integrationType:X}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6,...x||L.show?{height:"100%"}:{}},children:T.show?(0,w.jsxs)("div",{style:ye.fetchingProjects,children:[(0,w.jsx)("span",{children:bo().A.formatMessage(Sa(T.type))}),(0,w.jsx)(Eo().A,{style:{alignSelf:"center"}})]}):x?(0,w.jsxs)("div",{style:ye.connectAccountWrapper,children:[L.show&&(0,w.jsx)("div",{style:ye.authErrorMessage,children:bo().A.formatMessage(Sa(L.type),{site:(0,la().nH)(Q||"")})}),(0,w.jsxs)(da().A,{size:"lg",onClick:Pe,style:ye.connectAccountCTA,children:[(0,w.jsx)("img",{style:{width:14,height:15,marginRight:8},src:me}),(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountCTA",defaultMessage:"Authenticate your access"})]}),(0,w.jsx)("div",{style:ye.connectAccountDescription,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountDescription",defaultMessage:"Connect your Jira account to view and sync projects"})})]}):L.show?(0,w.jsx)("div",{style:ye.errorMessage,children:bo().A.formatMessage(Sa(L.type))}):c?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{existingSyncedProjectsCount, plural, one {{existingSyncedProjectsCount} synced project} other {{existingSyncedProjectsCount} synced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsTitle",values:{existingSyncedProjectsCount:k.length}}),isSectionItemsLoading:F,isSelectAll:!k.every((e=>p.includes(e))),items:Ae,handleSelect:Ce},"syncedProjects"),(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{unsyncedProjectsCount, plural, one {{unsyncedProjectsCount} unsynced project} other {{unsyncedProjectsCount} unsynced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsTitle",values:{unsyncedProjectsCount:A.length-k.length}}),isSectionItemsLoading:F,isSelectAll:!A.filter((e=>!k.includes(e.key))).map((e=>e.key)).every((e=>p.includes(e))),sectionCallout:ke(),items:_e,handleSelect:xe},"unsyncedProjects"),Ie()]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{buttonText}",id:"database.viewSettings.collectionSettingsExternalListProjects.selectedProjectsTitleForInitialSync",values:{buttonText:p.length===A.length?`All ${A.length} Projects`:`${p.length.toString()} of ${A.length.toString()} projects`}}),isSectionItemsLoading:F,handleSelect:ve,items:je,sectionCallout:ke(),isSelectAll:p.length!==A.length,disableCollapse:!0},"allProjects"),Ie()]})})}function va(e){const{isMobile:t}=(0,i().Y0)();return(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(gt().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?R().J.UISmall.mobile:R().J.UISmall.desktop},children:(0,w.jsx)(B().sA,{defaultMessage:"Whenever a synced project is updated in Jira, those updates will appear in Notion",id:"database.viewSettings.collectionSettingsExternalListProjects.description"})}),(0,w.jsx)(xo().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:bo().A.formatMessage(ya.inputPlaceholder)})]})}function xa(e){const t=(0,i().v3)(),o=(0,S().IS)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},wrapperInner:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:R().Wy.medium},syncDescription:{fontSize:R().J.UISmall.desktop,color:e.mediumTextColor,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]);return(0,w.jsx)("div",{style:o.wrapper,children:(0,w.jsx)("div",{style:o.wrapperInner,children:e.shouldShowUpgradePlan?(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:{...o.syncDescription,...o.error},children:(0,w.jsx)(B().sA,{defaultMessage:"Your Free Notion plan allows up to 100 synced issues. Choose fewer projects or upgrade to sync unlimited issues.",id:"database.viewSettings.collectionSettingsExternalListProjects.upgradePlanContext"})}),(0,w.jsx)(te().A,{style:o.button,onClick:()=>{ma().A.setState({open:!0,openedFrom:"jira_sync_2",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),(0,l().u4)({environment:t,event:{eventName:"external_sync_setup_action",eventProperties:{integration:e.integrationType,actionType:"plan_upgrade_cta_click",flowId:e.flowId,isSyncOwner:e.isSyncOwner}}})},disabled:e.disabled,children:(0,w.jsx)(B().sA,{defaultMessage:"Upgrade",id:"database.viewSettings.collectionSettingsExternalListProjects.Upgrade"})})]}):(0,w.jsxs)(w.Fragment,{children:[!e.isSetupComplete&&(0,w.jsx)("div",{style:o.syncDescription,children:(0,w.jsx)(B().sA,{defaultMessage:"{projects, plural, one {{projects} project will be synced} other {{projects} projects will be synced}}",id:"database.viewSettings.collectionSettingsExternalListProjects.projectsToBeSynced",values:{projects:e.selectedProjectKeysLength}})}),(0,w.jsxs)(te().A,{style:o.button,onClick:e.onActionButtonClick,disabled:e.disabled,children:[(0,w.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,w.jsx)(B().sA,{defaultMessage:"Select properties to sync ",id:"database.viewSettings.collectionSettingsExternalListProjects.selectProperties"})}),(0,ra().B)({width:14,height:14,marginLeft:6})]})]})})})}function Ca(e){const{isMobile:t}=(0,i().Y0)(),o=(0,S().IS)((e=>({title:{fontWeight:R().Wy.medium,marginRight:4,marginBottom:6},caption:{marginBottom:24},tryAgainCTA:{width:"100%",marginBottom:8},cancelCTA:{width:"100%",justifyContent:"center",color:e.lightTextColor,fontWeight:R().Wy.medium},siteButtonContainer:{gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary,marginBottom:24},siteButton:{padding:"4px 30px 4px 8px",borderRadius:6,gap:8,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:t?R().J.UIRegular.mobile:R().J.UIRegular.desktop,fontWeight:R().Wy.regular,lineHeight:"18px",letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:t?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.secondary,fontWeight:R().Wy.regular,textAlign:"left",lineHeight:t?R().K_.UISmall.mobile:R().K_.UISmall.desktop},logo:{width:20,height:20,marginTop:6},siteWrapper:{display:"flex",flexFlow:"column",gap:1,alignItems:"flex-start"}})),[t]);return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:o.title,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.title",defaultMessage:"Authentication Failed"})}),(0,w.jsx)(gt().A,{isSecondaryColor:!0,isMultiline:!0,style:o.caption,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.description",defaultMessage:"If you have multiple Jira sites, make sure youre authenticating into this one:"})}),(0,w.jsx)("div",{style:o.siteButtonContainer,children:(0,w.jsx)(Lo().A,{style:o.siteButton,disallowTabbing:!0,disabled:!0,children:(0,w.jsxs)("div",{style:o.siteButtonTextContainer,children:[(0,w.jsx)("img",{style:o.logo,src:e.integrationIconUrl}),(0,w.jsxs)("div",{style:o.siteWrapper,children:[(0,w.jsx)("span",{style:o.siteNameText,children:(0,ia().A)((0,pa().ay)(e.site||""))}),(0,w.jsx)("span",{style:o.siteNameSecondaryText,children:e.site})]})]})})}),(0,w.jsx)(te().A,{style:{width:"100%",marginBottom:8},onClick:()=>{e.connectAccount(),V().zw()},children:(0,w.jsx)(B().sA,{defaultMessage:"Try again",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.tryAgainCTA"})}),(0,w.jsx)(Oo().p,{onClick:()=>{V().zw()},style:{width:"100%",justifyContent:"center"},children:(0,w.jsx)(gt().A,{isSecondaryColor:!0,children:(0,w.jsx)(B().sA,{defaultMessage:"Cancel",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.cancenCTA"})})})]})}const ba=(0,B().YK)({inputPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.inputPlaceholder"}}),wa=o(488173).UY,ja=["attachment","issuetype"],Aa=["description","comment"],_a=["updated","labels","issuelinks","creator","subtasks","reporter","watches","created"],Ma=new Map([["user","person"],["attachment","file"],["array","multi_select"],["option","select"],["option-with-child","select"],["number","number"],["datetime","date"],["date","date"],["priority","select"],["issuetype","select"],["string","text"],["default","text"]]),ka=100;function Ia(e){const{collectionSettingsStore:t,collectionContextStore:o,action:s,selectedProjectKeys:c}=e,[u,p]=n.useState(""),[g,m]=n.useState([]),f=(0,S().DP)(),[y,h]=n.useState(!1),x=(0,i().v3)(),C=(0,r().K8)((()=>o.collectionStore()),[o]),b=(0,r().K8)((()=>null==C?void 0:C.getFormat()),[C]),j=(0,r().K8)((()=>null==C?void 0:C.getSchema()),[C]),A=(0,r().K8)((()=>{const e=o.collectionViewBlockStore();return"notion://projects_collection"===(null==b?void 0:b.app_config_uri)?(0,ot().k7)(e,null==j?void 0:j["notion://projects/project_to_task_relation"]):C}),[o,j,b,C]),_=(0,r().K8)((()=>null==A?void 0:A.getSchema()),[A]),M=(0,r().K8)((()=>null==A?void 0:A.id),[A]),k=(0,r().K8)((()=>null==C?void 0:C.getSpaceId()),[C]),I=(0,r().K8)((()=>{var e;return null==C||null===(e=C.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[C]),T=(0,r().K8)((()=>null==C?void 0:C.getFormat().bot_id),[C]),P=(0,r().K8)((()=>g.filter((e=>e.isSelected)).length),[g]),R=(0,r().K8)((()=>{const e=null==C?void 0:C.getFormat();return Boolean(null==e?void 0:e.sync_state)}),[C]),V=(0,r().O$)(ga().Ay),F=(0,r().K8)((()=>{const e=V.flowId||aa().JW();return V.flowId||ga().Ay.setState({...V,flowId:e}),e}),[V]),D=(0,r().K8)((()=>Boolean(co().A.externalAuthentications.state.find((e=>e.id===T&&e.user_id===x.currentUser.id)))),[T,x]),L=(0,n.useCallback)((e=>{const t=g.map((t=>{const o=e.find((e=>e.id===t.id));var n;return o&&!Aa.includes(o.id)?{...t,isProjectLevel:"PROJECT"===(null===(n=o.scope)||void 0===n?void 0:n.type)}:t})),o=e.filter((e=>!t.find((t=>t.id===e.id))&&!Aa.includes(e.id))).filter((e=>{let{schema:t}=e;return Boolean(t)})).map((e=>{var t;const o=ja.includes(e.id),n=(0,a().gB)(`${M}:${e.id}`),i=Boolean(null==_?void 0:_[n]);return{id:e.id,name:e.name,isSelected:o||i,isRequired:o,currentlySyncing:o||i,type:(r=null==e?void 0:e.schema,r?"watches"===r.type||"array"===r.type&&"user"===r.items?"person":"array"===r.type&&"attachment"===r.items?"file":Ma.get((null==r?void 0:r.type)??"default"):"text"),isProjectLevel:"PROJECT"===(null===(t=e.scope)||void 0===t?void 0:t.type),isPopular:_a.includes(e.id)};var r}));return[...t,...o]}),[g,M,_]),O=(0,n.useCallback)((e=>{m(e);e.filter((e=>e.isSelected)).length>100&&(0,l().u4)({environment:x,event:{eventName:"external_sync_setup_action",eventProperties:{integration:"jira",actionType:"properties_limit_exceeded",flowId:F,identifier:I,botId:T,collectionId:M,isSyncOwner:D}}})}),[x,I,T,M,F,D]),[{value:E}]=(0,v().Yb)((async()=>k&&I?await ae().callApi({eventName:"getFieldsForJiraIssues",environment:x,data:{spaceId:k,site:I}}):null),[x,k,I]);(0,n.useEffect)((()=>{if(!y&&"success"===(null==E?void 0:E.type)&&"data"in E){const e=L(E.data.fields.sort(((e,t)=>{var o,n,i,r,a;return ja.includes(e.id)&&!ja.includes(t.id)?-1:!ja.includes(e.id)&&ja.includes(t.id)?1:ja.includes(e.id)&&ja.includes(t.id)||null!==(o=e.schema)&&void 0!==o&&o.customId&&null!==(n=t.schema)&&void 0!==n&&n.customId||!(null!==(i=e.schema)&&void 0!==i&&i.customId||null!==(r=t.schema)&&void 0!==r&&r.customId)?e.name.toLocaleLowerCase()>t.name.toLocaleLowerCase()?1:-1:null!==(a=e.schema)&&void 0!==a&&a.customId?1:-1})));h(!0),O(e)}}),[E,y,O,L]),(0,n.useEffect)((()=>{const e=[];_&&Object.entries(_).forEach((t=>{let[o,n]=t;if(("relation"!==(null==n?void 0:n.type)||null==n||!n.connectedRelation)&&(null!=n&&n.derived_property_record_metadata||wa.has(o))){var i;const t="title"===o?"Task Name (Summary)":(null==n?void 0:n.name)??wa.get(o)??"",r=(null==n||null===(i=n.derived_property_record_metadata)||void 0===i?void 0:i.external_object_attribute)??wa.get(o)??"";e.push({id:r,name:t,isSelected:!0,currentlySyncing:!0,isRequired:wa.has(o)||ja.includes(r),type:null==n?void 0:n.type})}})),m((t=>Ai().hS([...t,...e],"id")))}),[_]);const z=(0,S().IS)((e=>({settingsMenu:{padding:8},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},snackbarCta:{color:e.text.contrastPrimary,marginLeft:16}})),[]),N=g.length?(0,So().Ay)(u,g,(e=>e.name)):[],U=e=>{O(g.map((t=>t.id===e.id?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!e.isSelected,currentlySyncing:e.currentlySyncing,type:e.type,isPopular:e.isPopular,isProjectLevel:e.isProjectLevel}:t)))},H=N.filter((e=>e.isRequired||e.isPopular)).map((e=>({key:e.id,render:()=>(0,w.jsx)($().A,{focused:!1,style:e.isRequired?z.disabledItem:{},onClick:()=>{U(e)},disabled:e.isRequired,title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{U(e)},style:{borderRadius:2}})}),icon:(0,w.jsx)(fo().Ay,{type:e.type??"text",icon:void 0,size:16,theme:f})}),action:()=>{}}))),W=N.filter((e=>!e.isRequired&&e.isProjectLevel)),G=N.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))),q=W.map((e=>({key:e.id,render:()=>(0,w.jsx)($().A,{focused:!1,onClick:()=>{U(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{U(e)},style:{borderRadius:2}})}),icon:(0,w.jsx)(fo().Ay,{type:e.type??"text",icon:void 0,size:16,theme:f})}),action:()=>{}}))),Y=G.map((e=>({key:e.id,render:()=>(0,w.jsx)($().A,{focused:!1,onClick:()=>{U(e)},title:(0,w.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,w.jsx)("div",{children:(0,w.jsx)(vo().A,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{U(e)},style:{borderRadius:2}})}),icon:(0,w.jsx)(fo().Ay,{type:e.type??"text",icon:void 0,size:16,theme:f})}),action:()=>{}})));return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(w.Fragment,{children:R?(0,w.jsx)(B().sA,{defaultMessage:"Synced issue properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSyncedPropertiesTab"}):(0,w.jsx)(B().sA,{defaultMessage:"Select issue properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSelectPropertiesTab"})}),header:(0,w.jsx)(Ta,{inputValue:u,onChange:p}),handleClose:()=>{d().os({collectionSettingsStore:t})},footer:(0,w.jsx)(Pa,{action:s,onSubmit:async()=>{if(!(C&&T&&k))return;const{projectCollectionPointer:o,taskCollectionPointer:n}=(0,pa().Be)(C);if(!o||!n)return;const i=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source)),r=g.filter((e=>e.isSelected)).map((e=>e.id));ja.forEach((e=>{r.includes(e)||r.push(e)})),Ir().D6({label:(0,w.jsx)(B().sA,{defaultMessage:"Started syncing from Jira. Youll be notified when the sync is complete",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.title"}),right:(0,w.jsx)(Oo().p,{onClick:Ir().N2,style:z.snackbarCta,children:(0,w.jsx)(B().sA,{defaultMessage:"Close",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.close"})}),position:"bottom"}),await ae().callApi({eventName:"syncJiraProjects",environment:x,data:{botId:T,projectKeys:c,projectIssueCounts:e.projectIssueCounts,spaceId:k,properties:r,projectCollectionPointer:o,taskCollectionPointer:n,onlyUpdateProperties:!i,flowId:F}}),i?(0,l().u4)({environment:x,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_projects_and_properties",flowId:F,identifier:I,botId:T,collectionId:M,isSyncOwner:D}}}):(0,l().u4)({environment:x,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_properties",flowId:F,identifier:I,botId:T,collectionId:M,isSyncOwner:D}}}),ga().Ay.setState({...ga().Ay.state,flowId:void 0}),d().os({collectionSettingsStore:t})},isSetupComplete:R,selectedPropertiesCount:P}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6},children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{standardPropertyCount, plural, one {{standardPropertyCount} standard property} other {{standardPropertyCount} standard properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.standardPropertiesTitle",values:{standardPropertyCount:g.filter((e=>e.isRequired||e.isPopular)).length}}),isSelectAll:!g.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected)),items:H,handleSelect:()=>{g.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected))?O(g.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!1}:e))):O(g.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!0}:e)))},isSectionItemsLoading:!y},"requiredProperties"),(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{projectLevelOptionalPropertyCount, plural, one {{projectLevelOptionalPropertyCount} project property} other {{projectLevelOptionalPropertyCount} project properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.projectLevelOptionalPropertiesTitle",values:{projectLevelOptionalPropertyCount:q.length.toString()}}),handleSelect:()=>{g.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected))?O(g.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):O(g.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},items:q,isSelectAll:!g.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected)),selectAllTooltipContent:(0,w.jsx)(B().sA,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!y},"projectProperties"),(0,w.jsx)(No,{title:(0,w.jsx)(B().sA,{defaultMessage:"{siteLevelPropertiesCount, plural, one {{siteLevelPropertiesCount} site property} other {{siteLevelPropertiesCount} site properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.siteLevelPropertiesTitle",values:{siteLevelPropertiesCount:Y.length.toString()}}),items:Y,handleSelect:()=>{g.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected))?O(g.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):O(g.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},isSelectAll:!g.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected)),selectAllTooltipContent:(0,w.jsx)(B().sA,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!y},"siteProperties")]})})}function Ta(e){const{isMobile:t}=(0,i().Y0)();return(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(gt().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?R().J.UISmall.mobile:R().J.UISmall.desktop},children:(0,w.jsx)(B().sA,{defaultMessage:"Select which Jira properties will be synced as Notion properties in the issues database",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.description"})}),(0,w.jsx)(xo().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:bo().A.formatMessage(ba.inputPlaceholder)})]})}function Pa(e){const t=(0,S().IS)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},buttonWrapper:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:R().Wy.medium},syncDescription:{paddingTop:8,fontSize:R().J.UISmall.desktop,color:e.mediumTextColor,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]),o=e.selectedPropertiesCount>ka,n=e.action===mo().Sh.SyncProjects?(0,w.jsx)("div",{style:t.buttonWrapper,children:(0,w.jsx)(te().A,{style:t.button,onClick:e.onSubmit,disabled:o,children:e.isSetupComplete?(0,w.jsx)(B().sA,{defaultMessage:"Sync projects",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton"}):(0,w.jsx)(B().sA,{defaultMessage:"Start Jira sync",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.startJiraSyncButton"})})}):(0,w.jsx)("div",{style:t.buttonWrapper,children:(0,w.jsx)(te().A,{style:t.button,onClick:e.onSubmit,disabled:o,children:(0,w.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,w.jsx)(B().sA,{defaultMessage:"Sync additional properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncAdditionalProperties"})})})});return(0,w.jsxs)("div",{style:t.wrapper,children:[!e.isSetupComplete&&!o&&(0,w.jsx)("div",{style:t.syncDescription,children:(0,w.jsx)(B().sA,{defaultMessage:"{propertiesCount, plural, one {{propertiesCount} property will be synced} other {{propertiesCount} properties will be synced}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.selectProperties",values:{propertiesCount:e.selectedPropertiesCount}})}),o&&(0,w.jsx)("div",{style:{...t.syncDescription,...t.error},children:(0,w.jsx)(B().sA,{defaultMessage:"You selected {selectedProperties} properties. The maximum allowed is 100",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.propertiesLimit",values:{selectedProperties:e.selectedPropertiesCount}})}),n]})}var Ba=()=>o(662303),Ra=()=>o(869190),Va=()=>o(449552),Fa=()=>o(112710),Ka=()=>o(704654),Da=()=>o(16006),La=()=>o(748768);function Oa(e){var t,o;let{taskCollectionStore:n,projectCollectionStore:a,externalSyncStore:l,currentSpaceStore:s}=e;const c=(0,r().K8)((()=>{if(s)return s.getSubscriptionTier()}),[s]),d=(0,r().K8)((()=>"enterprise"===c),[c]),u=(0,r().K8)((()=>null==n?void 0:n.getFormat()),[n]),p=Boolean(null==u||null===(t=u.sync_state)||void 0===t?void 0:t.syncing),g=(0,r().K8)((()=>p||!(null!=l&&l.shouldAllowUserToEditSyncedCollection())),[p,l]),m=Boolean(null==u||null===(o=u.sync_state)||void 0===o?void 0:o.enable_two_way_sync),f=(0,i().v3)();return d?(0,w.jsx)(ne().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"2-way sync",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.switchName"}),caption:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.caption",defaultMessage:"Allows editing in Notion and automatically syncs changes to JIRA"}),on:m,focused:!1,onClick:()=>{La().toggleTwoWaySyncOnCollection({environment:f,taskCollectionStore:n,projectCollectionStore:a})},disabled:g,textWrapperStyle:{opacity:1}}):null}var Ea=()=>o(991249);function za(e){let{integrationIconUrl:t,currentSpaceStore:o}=e;const{isMobile:n}=(0,i().Y0)(),a=(0,i().v3)(),l=(0,S().IS)((e=>({upgradeToEnterpriseContainer:{margin:"6px 15px",padding:"12px",borderRadius:6,backgroundColor:e.surface.wash},upgradeToEnterpriseButton:{width:"100%",marginTop:6,padding:"3px 0px",backgroundColor:e.whiteButtonBackground,color:e.text.primary,borderRadius:6,textAlign:"center",border:`1px solid ${e.stroke.primary}`,fontWeight:R().Wy.medium,fontSize:n?R().J.UIRegular.mobile:R().J.UIRegular.desktop},upgradeToEnterpriseTextContainer:{display:"flex",alignItems:"center",margin:"0px 12px",gap:6},upgradeToEnterpriseIcon:{width:14,height:14},upgradeToEnterpriseText:{fontSize:n?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.primary,fontWeight:R().Wy.regular},hoveredStyle:{backgroundColor:e.whiteButtonHoveredBackground}})),[n]),s=(0,r().K8)((()=>{if(o)return o.getSubscriptionTier()}),[o]);return(0,r().K8)((()=>"enterprise"===s),[s])?null:(0,w.jsxs)("div",{style:l.upgradeToEnterpriseContainer,children:[(0,w.jsxs)("div",{style:l.upgradeToEnterpriseTextContainer,children:[(0,w.jsx)("img",{style:l.upgradeToEnterpriseIcon,src:t}),(0,w.jsx)("div",{style:l.upgradeToEnterpriseText,children:(0,w.jsx)(B().sA,{defaultMessage:"Jira 2-way sync is now available",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySyncAvailable"})})]}),(0,w.jsx)(Lo().A,{style:l.upgradeToEnterpriseButton,hoveredStyle:l.hoveredStyle,onClick:()=>{(0,Ea().K)(a,{from:"workspace_connections",upsell:{type:"product",product:"enterprise",limit:{type:"none"}}})},children:(0,w.jsx)(B().sA,{defaultMessage:"Upgrade to Enterprise",id:"database.viewSettings.collectionSettingsExternalSource.upgradeToEnterprise"})})]})}var Na=()=>o(437622);const Ua=(0,B().YK)({CollectionSettingsExternalSourceTitle:{defaultMessage:"Select data to sync",id:"database.viewSettings.collectionSettingsExternalSource.tabTitle"},CollectionSettingsExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.description",defaultMessage:"To set up a Jira synced database, youll need to choose projects and properties to sync"},importInProgressToolTip:{id:"database.viewSettings.collectionSettingsExternalSource.tooltipForInProgressImport",defaultMessage:"Cannot be edited while sync is in progress"},accountDisconnectedTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.accountDisconnectedTooltip",defaultMessage:"Account has been disconnected"},sourceDisabledTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.sourceDisabledTooltip",defaultMessage:"Workspace owner has disabled edits for this Jira site"}}),Ha=12;function Wa(e){var t,o;const{collectionSettingsStore:n,collectionContextStore:a}=e,s=(0,B().tz)(),{isMobile:c}=(0,i().Y0)(),u=(0,i().v3)(),p=(0,r().K8)((()=>a.collectionStore()),[a]),g=(0,r().K8)((()=>null==p?void 0:p.getFormat()),[p]),m=(0,r().K8)((()=>null==p?void 0:p.getSchema()),[p]),f=(0,r().K8)((()=>{var e;return null==p||null===(e=p.getFormat())||void 0===e?void 0:e.external_collection_type}),[p]),y=(0,r().K8)((()=>fn().default.state.currentSpaceStore),[]),h=(0,r().O$)(a.externalSyncStore),v=(0,r().K8)((()=>{var e;return(null==p||null===(e=p.getFormat())||void 0===e?void 0:e.synced_collection_instance_type)??"Cloud"}),[p]),x=(0,r().K8)((()=>"DataCenter"===v?"jira-dc":"jira"),[v]),C=f?ua().l[f]:"",b=(0,r().K8)((()=>{const e=a.collectionViewBlockStore();return(0,ot().k7)(e,(null==g?void 0:g.app_config_uri)===O().Tw?null==m?void 0:m[O().K4.ProjectToTaskRelation]:null==m?void 0:m[O().yx.TaskToProjectRelation])}),[a,m,g]),j=(0,r().K8)((()=>ga().Ay.getFlowId()),[]),A=(0,r().K8)((()=>Boolean(co().A.externalAuthentications.state.find((e=>e.id===(null==g?void 0:g.bot_id)&&e.user_id===u.currentUser.id)))),[g,u]),_=(0,r().K8)((()=>(0,pa().CS)()),[]),k=(0,S().IS)((e=>({collectionSettingsExternalSourceTitle:{marginLeft:12,fontSize:c?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.secondary},preview:{padding:"12px 36px 12px 30px",background:e.surface.wash,display:"flex",justifyContent:"flex-start",marginLeft:14,marginRight:14,borderRadius:6,marginBottom:24},container:{marginLeft:12,marginRight:12},lastSyncText:{fontSize:c?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.secondary,fontWeight:R().Wy.regular,textAlign:"left",marginLeft:14,lineHeight:R().K_.UISmall.desktop,marginBottom:6},captionText:{fontSize:c?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.secondary,fontWeight:R().Wy.regular,textAlign:"left",marginLeft:14},sourceSectionTitle:{textAlign:"left",color:e.text.secondary,paddingTop:0},siteButtonContainer:{margin:"0px 14px",gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary},siteButton:{padding:"4px 8px",borderRadius:6,gap:8,display:"flex",justifyContent:"space-between"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:c?R().J.UIRegular.mobile:R().J.UIRegular.desktop,fontWeight:R().Wy.regular,lineHeight:R().K_.UIRegular.desktop,letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:c?R().J.UISmall.mobile:R().J.UISmall.desktop,color:e.text.secondary,fontWeight:R().Wy.regular,textAlign:"left",lineHeight:c?R().K_.UISmall.mobile:R().K_.UISmall.desktop},lockedIcon:{width:14,height:14,color:e.icon.secondary},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[c]);if(!p||!b)return null;const I=(null==g?void 0:g.app_config_uri)===O().Tw,T=Boolean((null==g?void 0:g.sync_state)&&(null==g||null===(t=g.sync_state)||void 0===t?void 0:t.last_synced_at));return(0,w.jsxs)(K().Ay,{collectionSettingsStore:n,title:s.formatMessage(Ua.CollectionSettingsExternalSourceTitle),fullHeight:!0,handleClose:()=>{ga().Ay.setState({...ga().Ay.state,projectKeys:[]}),d().os({collectionSettingsStore:n})},children:[_?(0,w.jsx)(za,{integrationIconUrl:C,currentSpaceStore:y}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{disableMobileBorders:!0,children:(0,w.jsx)("div",{style:k.collectionSettingsExternalSourceTitle,children:(0,w.jsx)(B().sA,{...Ua.CollectionSettingsExternalSourceDescription})})}),(0,w.jsx)("div",{style:k.preview,children:Ga({projectCollectionStore:I?p:b,taskCollectionStore:I?b:p,integrationIconUrl:C})})]}),_&&(0,w.jsx)(Oa,{taskCollectionStore:I?b:p,projectCollectionStore:I?p:b,externalSyncStore:h,currentSpaceStore:y}),(0,w.jsxs)(oe().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.sourceSite"}),style:k.sourceSectionTitle,desktopTitleStyle:{marginBottom:0},children:[(null==g||null===(o=g.sync_state)||void 0===o?void 0:o.last_synced_at)&&(0,w.jsx)("div",{style:k.lastSyncText,children:(0,w.jsx)(B().sA,{defaultMessage:"Last synced {lastSyncedAt}",id:"database.viewSettings.collectionSettingsExternalSource.lastSynced",values:{lastSyncedAt:`${(0,Ra().jE)(g.sync_state.last_synced_at,Ba().locale,s)}`}})}),(0,w.jsx)("div",{style:k.siteButtonContainer,children:(0,w.jsxs)(Lo().A,{style:k.siteButton,disallowTabbing:!0,disabled:!0,children:[(0,w.jsxs)("div",{style:k.siteButtonTextContainer,children:[qa({iconStyle:{width:15,height:15,marginTop:6},srcUrl:C}),(0,w.jsxs)("div",{style:{display:"flex",flexFlow:"column",gap:1},children:[(0,w.jsx)("span",{style:k.siteNameText,children:(0,ia().A)((0,pa().ay)((null==g?void 0:g.synced_collection_external_url)||""))}),(0,w.jsx)("span",{style:k.siteNameSecondaryText,children:null==g?void 0:g.synced_collection_external_url})]})]}),(0,w.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,Va().g)(k.lockedIcon)})]})})]}),Ya({taskCollectionStore:I?b:p,collectionSettingsStore:n,isSetupComplete:T,flowId:j,isSyncOwner:A}),(0,w.jsx)(pt().A,{size:1,style:{marginTop:16,marginBottom:16}}),(0,w.jsx)(Z().A,{style:{display:"flex",marginLeft:14,marginRight:14},className:"notion-print-ignore",href:(0,Cr().xS)("guides.externalImportAndSync"),external:!0,onClick:()=>{(0,l().u4)({environment:u,event:{eventName:"external_sync_setup_action",eventProperties:{integration:x,actionType:"learn_more_cta_click",flowId:j,collectionId:I?b.id:p.id,botId:null==g?void 0:g.bot_id,identifier:null==g?void 0:g.synced_collection_external_url,isSyncOwner:A}}})},children:(0,w.jsx)(Oo().p,{icon:M().$,isLightGray:!0,style:{width:"100%"},children:(0,w.jsx)(B().sA,{id:"externalSync.helpCenter",defaultMessage:"Learn about Jira sync"})})})]})}function Ga(e){const{projectCollectionStore:t,taskCollectionStore:o,integrationIconUrl:n}=e,a=(0,i().v3)(),l=(0,r().K8)((()=>"dark"===a.ThemeStore.state.mode),[a]),s=(0,S().IS)((e=>({iconContainer:{display:"flex",alignItems:"center"},sourceIcon:{width:26,height:26,padding:5,borderRadius:6,gap:10,borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,boxShadow:"0px 2px 4px 0px #161D1B05",...!l&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},taskArrow:{width:87,height:26,top:26},projectArrow:{width:87,height:26,top:2,border:1},arrowContainer:{display:"flex",flexFlow:"column",justifyContent:"center"},collectionIconContainer:{display:"flex",flexFlow:"column",justifyContent:"space-around",gap:12},collectionIcon:{width:88,padding:"4px 6px 6px 6px",borderRadius:6,gap:6,display:"flex",alignItems:"center",borderColor:e.stroke.primary,borderWidth:1,borderStyle:"solid",...!l&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},title:{fontSize:Ha,fontWeight:R().Wy.medium,lineHeight:R().K_.UISmall.desktop,letterSpacing:0,color:e.text.primary}})),[l]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:s.iconContainer,children:qa({iconStyle:s.sourceIcon,srcUrl:n})}),(0,w.jsxs)("div",{style:s.arrowContainer,children:[qa({iconStyle:s.projectArrow,srcUrl:h().A.images.externalIntegrations.externalAppToProjectsArrowPng}),qa({iconStyle:s.taskArrow,srcUrl:h().A.images.externalIntegrations.externalAppToTasksArrowPng})]}),(0,w.jsxs)("div",{style:s.collectionIconContainer,children:[(0,w.jsxs)("div",{style:s.collectionIcon,children:[$a(Fa().a,n),(0,w.jsx)(Da().A,{store:t,style:s.title})]}),(0,w.jsxs)("div",{style:s.collectionIcon,children:[$a(Ka().E,n),(0,w.jsx)(Da().A,{store:o,style:s.title})]})]})]})}function qa(e){const{iconStyle:t,srcUrl:o,altString:n}=e;return(0,w.jsx)("img",{style:t,src:o,alt:n})}function Ya(e){let{taskCollectionStore:t,collectionSettingsStore:o,isSetupComplete:n,flowId:a,isSyncOwner:s}=e;const c=(0,i().v3)(),u=(0,r().K8)((()=>t.getSchema()),[t]),p=(0,r().K8)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.syncing}),[t]),g=(0,r().K8)((()=>fn().default.state.currentSpaceStore),[]),m=(0,r().K8)((()=>t.getFormat().bot_id),[t]),f=(0,r().K8)((()=>t.getFormat().synced_collection_external_url),[t]),y=(0,r().K8)((()=>(0,Na().p4)(g)),[g]),S=(0,r().K8)((()=>(0,pa().Zf)()),[]),h=(0,r().K8)((()=>(0,pa().X7)()),[]),v=(0,r().K8)((()=>t.getFormat().synced_collection_instance_type),[t]),x=(0,r().K8)((()=>"DataCenter"===v?"jira-dc":"jira"),[v]),C=(0,r().K8)((()=>(0,pa().yX)()),[])&&!y&&"Cloud"===v||"DataCenter"===v&&(!h||!y&&!S),b=(0,r().K8)((()=>{if(m&&g){const e=Y().vK.createChildStore(g,{table:sa().GP,id:m,spaceId:g.id});return!e.isDefined()||Boolean(e.getAlive())}return!0}),[m,g]);let j=0;for(const i in u){var A;null!==(A=u[i])&&void 0!==A&&A.derived_property_record_metadata&&j++}let _=bo().A.formatMessage(Ua.accountDisconnectedTooltip);return Boolean(p)?_=bo().A.formatMessage(Ua.importInProgressToolTip):C&&(_=bo().A.formatMessage(Ua.sourceDisabledTooltip)),n?(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Data synced from Jira",id:"database.viewSettings.collectionSettingsExternalSource.titleStringForSyncedData"}),children:(0,w.jsx)(ao().A,{disableTooltip:!Boolean(p)&&b&&!C,renderTooltip:e=>(0,w.jsx)("div",{...e,style:zo().Q$,children:_}),render:e=>(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(D().A,{...e,icon:Fa().a,disabled:Boolean(p)||!b||C,onClick:()=>{d().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,l().u4)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_projects_cta_click",flowId:a,identifier:f,botId:m,collectionId:t.id,isSyncOwner:s}}})},showChevron:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"Projects",id:"database.viewSettings.collectionSettingsExternalSource.projects"})}),(0,w.jsx)(D().A,{...e,icon:kr().j,disabled:Boolean(p)||!b||C,onClick:()=>{d().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:mo().Sh.SyncAdditionalProperties,selectedProjectKeys:[],projectIssueCounts:{}}}),(0,l().u4)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_properties_cta_click",flowId:a,identifier:f,botId:m,collectionId:t.id,isSyncOwner:s}}})},right:(0,w.jsx)(B().sA,{id:"database.viewSettings.collectionSettingsExternalSource.syncedPropertiesCount",defaultMessage:"{syncedPropertiesCountString}",values:{syncedPropertiesCountString:j.toString()}}),showChevron:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"Task Properties",id:"database.viewSettings.collectionSettingsExternalSource.taskProperties"})})]})})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Step 1",id:"database.viewSettings.collectionSettingsExternalSource.setupProjects"}),children:(0,w.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,w.jsx)(te().A,{style:{width:"100%"},onClick:()=>{d().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,l().u4)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_projects_cta_click",flowId:a,identifier:f,botId:m,collectionId:t.id,isSyncOwner:s}}})},disabled:C,children:(0,w.jsx)(B().sA,{defaultMessage:"Select projects to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncProjectsButton"})})})}),(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Step 2",id:"database.viewSettings.collectionSettingsExternalSource.setupProperties"}),children:(0,w.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,w.jsx)(te().A,{style:{width:"100%"},disabled:!0,children:(0,w.jsx)(B().sA,{defaultMessage:"Select properties to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncPropertiesButton"})})})})]})}function $a(e,t){const o=(0,i().v3)(),n=(0,r().K8)((()=>"dark"===o.ThemeStore.state.mode),[o]),a=(0,S().IS)((e=>({sourceIcon:{width:10,height:10,padding:2,borderRadius:3,gap:10,position:"absolute",borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,right:-3,bottom:-3,boxShadow:"0px 2px 4px 0px #161D1B05",...!n&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`},display:"flex",alignItems:"center",justifyContent:"center"},baseIcon:{height:14,width:14,color:e.icon.secondary}})),[n]);return(0,w.jsxs)("div",{style:{position:"relative"},children:[e(a.baseIcon),(0,w.jsx)("div",{style:a.sourceIcon,children:qa({iconStyle:{height:5,width:5},srcUrl:t})})]})}function Qa(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n}}=e;if("external_source"===n)return(0,w.jsx)(Wa,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_projects"===n)return(0,w.jsx)(ha,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_task_properties"===n){const{action:n,selectedProjectKeys:i,projectIssueCounts:r}=e.tabSettings;return(0,w.jsx)(Ia,{collectionSettingsStore:t,collectionContextStore:o,action:n,selectedProjectKeys:i,projectIssueCounts:r})}return(0,w.jsx)(w.Fragment,{})}var Za=()=>o(374562),Ja=()=>o(132389),Xa=()=>o(176983),el=()=>o(835243),tl=()=>o(901952);const ol=(0,B().YK)({autoIncrementIdPrefixPlaceholder:{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{defaultMessage:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function nl(e){const{uniqueIdProperty:t,prefixValue:o,collectionContextStore:a}=e,l=(0,i().v3)(),s=(0,r().K8)((()=>a.collectionStore()),[a]),[c,d]=(0,n.useState)(o??""),[u,g]=(0,n.useState)(!0),[m,f]=(0,n.useState)(),y=(0,n.useCallback)((()=>{g(!0),f(void 0)}),[g,f]),h=(0,n.useCallback)((e=>{g(!0),f(bo().A.formatMessage(ol.duplicatePrefixNameError,{prefixName:`"${e}"`}))}),[]),x=(0,n.useCallback)(((e,t,o)=>{const n=o.collectionStore();n&&(g(!1),ae().callApi({eventName:"setRecordKey",environment:l,data:{spaceId:n.getSpaceId(),table:n.table,key:e,id:n.id}}).then((n=>{g(!0),200!==n.status?h(e):(0,tl().V)({environment:l,collectionContextStore:o,property:t,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>h(e))))}),[l,h]),C=(0,n.useCallback)((async e=>{if(!s)return!1;const t=await ae().callApi({eventName:"isRecordKeyAvailable",environment:l,data:{spaceId:s.getSpaceId(),table:s.table,key:e.trim()}});return"success"===t.type&&t.data.isAvailable}),[s,l]),b=(0,Yr().U)((e=>{C(e).then((t=>{t||h(e),g(!0)})).catch((()=>h(e)))}),500),[j]=(0,v().Yb)((async()=>{if(s)return ae().callApi({eventName:"suggestRecordKey",environment:l,data:{spaceId:s.getSpaceId(),table:oi().Vl,id:s.id,shouldSetSuccessfullySuggestedRecord:!1}})}),[s,l]);(0,n.useEffect)((()=>{var e;if(!o&&"resolved"===j.status)return"success"===(null===(e=j.value)||void 0===e?void 0:e.type)&&j.value.data?(f(void 0),void d(j.value.data.key)):void 0}),[o,j]),(0,n.useEffect)((()=>()=>{b.cancel()}),[b]);const A=(0,n.useCallback)((e=>{const t=e.target.value.toUpperCase();d(t),y(),t&&t!==o&&((0,el().n4)(t)||f(bo().A.formatMessage(el().DZ.prefixInvalidError)),g(!1),b(t))}),[y,o,b]),_=(0,n.useCallback)((()=>{b.flush()}),[b]),M=(0,n.useCallback)((e=>{const n=null==s?void 0:s.getRecordKeyStore();e!==o&&!m&&n&&s&&null!=t&&t.propertySchema?x(e,null==t?void 0:t.propertyId,a):g(!0)}),[s,o,m,t,x,a]),k=(0,n.useCallback)((()=>{const e=a.collectionStore();e&&p().createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:l,canUndo:!0,perform:t=>{const o=st().IL({environment:l,collectionStore:e,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:t});x(c,o,a)}})}),[a,l,c,x]),I=(0,n.useCallback)((e=>{if(!s)return;const t=[{label:(0,w.jsx)(B().sA,{id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit",defaultMessage:"Update ID Prefix"}),color:"red",onAccept:()=>M(e)}];V().ui({message:(0,w.jsx)("span",{children:(0,w.jsx)(B().sA,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",defaultMessage:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{databaseName:(0,w.jsx)(Da().A,{style:{display:"inline",fontWeight:R().Wy.medium},shouldWrap:!0,store:s})}})}),showCancel:!0,keepFocus:!0,items:t})}),[s,M]),T=(0,n.useCallback)((e=>{o?I(e):M(e)}),[o,M,I]),P=(0,n.useCallback)((()=>t?t&&!o?(0,w.jsxs)(w.Fragment,{children:[(0,io().W)({width:14,height:14}),(0,w.jsx)(Ja().A,{size:4}),(0,w.jsx)(B().sA,{defaultMessage:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})]}):(0,w.jsx)(B().sA,{defaultMessage:"Update ID Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit"}):(0,w.jsxs)(w.Fragment,{children:[(0,io().W)({width:14,height:14}),(0,w.jsx)(Ja().A,{size:4}),(0,w.jsx)(B().sA,{defaultMessage:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"})]})),[o,t]),F=(0,S().IS)((e=>({prefixInputOuterStyle:{color:void 0===o?e.lightTextColor:e.regularTextColor}})),[o]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(xo().Ay,{left:(0,w.jsx)(gt().A,{style:{marginLeft:4,marginRight:7},children:(0,w.jsx)(B().sA,{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})}),value:c,inputOuterStyle:F.prefixInputOuterStyle,onChange:A,onBlur:_,placeholder:ol.autoIncrementIdPrefixPlaceholder.defaultMessage,onSubmit:()=>T(c.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),m||!u?(0,w.jsx)(il,{prefixName:c,hasRequestCompleted:u,errorMessage:m}):(0,w.jsx)(gt().A,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,w.jsx)(B().sA,{defaultMessage:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:c?`${c}-`:""}})}),(0,w.jsx)(te().A,{size:"lg",style:{margin:"8px 16px",width:"90%"},onClick:()=>{t?T(c.trim()):k()},disabled:c===o||Boolean(m)||!u,children:P()})]})}function il(e){const{errorMessage:t,hasRequestCompleted:o}=e;return(0,w.jsx)(gt().A,{isMultiline:!0,style:{paddingTop:12,marginLeft:16,marginRight:16,...o?{color:an().Ay.red}:{},...e.styles},isSecondaryColor:!o,children:o&&t?t:(0,w.jsx)("div",{style:{paddingTop:3,paddingBottom:3},children:(0,w.jsx)(Eo().A,{legacySize:14})})})}o(430670);var rl=()=>o(784892);const al={pull_request_review_edited:!0,pull_request_review_submitted:!0,pull_request_review_requested:!0,pull_request_review_request_removed:!0,pull_request_closed:!0,pull_request_opened:!0,pull_request_reopened:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0,pull_request_labeled:!0,pull_request_unlabeled:!0},ll={pull_request_review_comment_created:!0,issue_comment_created:!0},sl={installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,...al,...ll},cl={pull_request_opened:!0,pull_request_review_requested:!0,pull_request_review_submitted:!0,pull_request_closed:!0};(0,W().u0)((e=>{const t=(0,W().uv)(sl);return(0,W().Xk)(t,e)?{true:e}:{false:e}}));jo().literals(...(0,W().uv)({pull_request:!0,pull_request_review:!0,pull_request_review_comment:!0,installation:!0,issue_comment:!0})),jo().literals(...(0,W().uv)(sl)),jo().literals(...(0,W().uv)(ll));var dl=()=>o(452951),ul=()=>o(312296),pl=()=>o(811979),gl=()=>o(45552),ml=()=>o(399762),fl=()=>o(722872),yl=()=>o(35091);const Sl=14,hl=(0,B().YK)({autoUpdate:{defaultMessage:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{defaultMessage:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},addStatusDescription:{defaultMessage:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{defaultMessage:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{defaultMessage:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},pull_request_opened:{defaultMessage:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},pull_request_review_requested:{defaultMessage:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},pull_request_review_submitted:{defaultMessage:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},pull_request_closed:{defaultMessage:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{defaultMessage:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{defaultMessage:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"},linkbackAndActivitySectionHeader:{defaultMessage:"Linkbacks & Activity",id:"collectionSettingsGithubAutomationConfig.linkbacksAndActivityHeading"},linkBacksToggle:{defaultMessage:"Linkbacks in GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggle"},linkBacksToggleDescription:{defaultMessage:"Enable linkback comments to the linked page on GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggleDescription"},activityCommentsToggle:{defaultMessage:"Activity Comments",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggle"},activityCommentsToggleDescription:{defaultMessage:"Show GitHub activity as comments on the linked page",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggleDescription"}}),vl={pull_request_opened:bo().A.formatMessage(hl.pull_request_opened),pull_request_review_requested:bo().A.formatMessage(hl.pull_request_review_requested),pull_request_review_submitted:bo().A.formatMessage(hl.pull_request_review_submitted),pull_request_closed:bo().A.formatMessage(hl.pull_request_closed)},xl=bo().A.formatMessage(hl.noAutomations),Cl={pull_request_opened:null,pull_request_review_requested:null,pull_request_review_submitted:null,pull_request_closed:null},bl={github_linkbacks:!0,activity_comments:!1};function wl(e){const{gitHubProperty:t,selectedStatusProperty:o,setSelectedStatusProperty:a,intl:l}=e,s=(0,i().v3)(),c=(0,mt().ET)(),d=(0,i().Y0)(),u=Ml(),g=(0,r().K8)((()=>{const e=(0,ht().Jq)(c,t);if(e&&(0,mo().UU)(e))return e}),[c,t]),m=(0,r().K8)((()=>{const e=c.normalizedSchemaStore.state;return(0,W().WP)(e).flatMap((e=>{let[t,o]=e;return o&&(0,mo().DD)(o)?[{id:t,schema:o}]:[]}))}),[c.normalizedSchemaStore]),f=(0,r().K8)((()=>g&&(0,mo().UU)(g)&&(0,W().O9)(g.connectedRelation.automationSettings)?g.connectedRelation.automationSettings:bl),[g]);(0,n.useEffect)((()=>{v(f)}),[f]),(0,n.useEffect)((()=>{if(!o&&m.length>0){if(null!=g&&g.connectedRelation.automation)for(const t of m)if(g.connectedRelation.automation[t.id])return void a(t);const e=m[0];a(e)}}),[m,g,o,a]);const[y,S]=(0,n.useState)(Cl),[h,v]=(0,n.useState)(bl),x=(0,n.useCallback)((e=>{const o=c.collectionStore();if(!o||!g||!(0,mo().nC)(g))return;const n=g.connectedRelation;n.automationSettings=e;const i={...g,connectedRelation:{...n}};p().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,ul().F)({environment:s,collectionStore:o,update:{[t]:i},transaction:e})}}),v(e)}),[c,s,t,g]);(0,n.useEffect)((()=>{var e,t;o&&g&&(0,mo().UU)(g)&&null!==(e=g.connectedRelation.automation)&&void 0!==e&&e[o.id]?S(null===(t=g.connectedRelation.automation)||void 0===t?void 0:t[o.id]):S(Cl)}),[g,o]);const C=(0,n.useCallback)((e=>{const n=c.collectionStore();if(!(n&&o&&g&&(0,mo().nC)(g)))return;const i=g.connectedRelation;if(!i||!o.id)return;i.automation={...i.automation,...e};const r={...g,connectedRelation:{...i}};(0,tl().V)({environment:s,collectionContextStore:c,property:o.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:e}),p().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,ul().F)({environment:s,collectionStore:n,update:{[t]:r},transaction:e})}})}),[c,o,g,s,t]),b=(0,r().K8)((()=>o&&o.schema.options?o.schema.options:[]),[o]),j=(0,r().K8)((()=>{const e={};return b.forEach((t=>{e[t.id]=t})),e}),[b]),A=(0,r().K8)((()=>{var e,t;const n=null==o||null===(e=o.schema)||void 0===e?void 0:e.groups,i=null==o||null===(t=o.schema)||void 0===t?void 0:t.options;return n&&i?n.map((e=>{const t=i.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(W().O9):[]}),[o]);function _(e,t){const n=A.map((t=>{let{group:n,groupOptions:i}=t;const r=i.map((t=>({key:t.id,render:e=>(0,w.jsx)($().A,{...e,focused:e.focused,isTokenTitle:!0,title:(0,w.jsx)(ml().q,{format:rl().NY.Small,value:t.value,color:t.color,showRemoveButton:!1,groupColor:n.color,isSingle:!0})}),action:()=>{const n={...y,[e]:t.id};o&&(C({[o.id]:n}),S(n))}}))).filter(W().O9);return{key:n.name,render:e=>(0,w.jsx)(oe().A,{...e,title:n.name,topBorder:e.index>0}),items:r}}));if(y[e]){function i(){const n={...y,[e]:null};o&&(C({[o.id]:n}),S(n)),t.close()}const r={key:"removeOptionSection",render:e=>(0,w.jsx)(oe().A,{...e,topBorder:!0}),items:[{key:"removeOptionButton",render:e=>(0,w.jsx)($().A,{...e,focused:!1,title:l.formatMessage(hl.removeStatusOption),left:(0,P().I)({width:12}),onClick:i}),action:e=>{i()}}]};n.push(r)}return n}return(0,w.jsxs)(w.Fragment,{children:[o?(0,w.jsx)(oe().A,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:(0,w.jsx)(Al,{selectedStatusProperty:o,setSelectedStatusProperty:a,existingStatusProperties:m,intl:l}),children:(0,W().uv)(cl).map((e=>(0,w.jsx)(pl().A,{focused:!1,placementToOrigin:Q().sx.Top,alignmentToOrigin:Q().yP.End,popupType:d.isMobile?Q().z7.SlideUp:Q().z7.Popup,render:t=>{const o=d.isMobile?{menuType:fl().gu.Modal,right:(0,w.jsx)(gl().DoneMenuText,{}),onClickRight:t.close}:{menuType:fl().gu.Popup,width:150};return(0,w.jsx)(J().A,{...o,children:(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,sections:_(e,t),initialFocus:void 0,onAccept:t.close})})},renderOrigin:t=>{const n=y[e];let i=(0,w.jsx)("div",{style:u.noneText,children:xl});if(n){const e=j[n];if(e){var r;const t=null==o||null===(r=o.schema)||void 0===r||null===(r=r.groups)||void 0===r||null===(r=r.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n)})))||void 0===r?void 0:r.color;i=(0,w.jsx)(ml().q,{format:rl().NY.Small,showRemoveButton:!1,isSingle:!0,value:e.value,color:e.color,groupColor:t})}}return(0,w.jsx)(D().A,{...t,focused:!1,icon:()=>(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap"},children:[vl[e],(0,w.jsx)(Ja().A,{size:8}),(0,dl().Z)(u.automationMenuItemArrow)]}),title:(0,w.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:i}),showChevron:!0,chevronStyle:{margin:0}})}},e)))}):(0,w.jsx)(jl,{setSelectedStatusProperty:a,intl:l}),(0,w.jsx)(oe().A,{topBorder:!0,disableDesktopPadding:!0,disableMobilePadding:!0,title:l.formatMessage(hl.linkbackAndActivitySectionHeader),children:[(0,w.jsx)(ao().A,{renderTooltip:()=>l.formatMessage(hl.linkBacksToggleDescription),render:e=>(0,w.jsx)(yl().A,{...e,title:l.formatMessage(hl.linkBacksToggle),onClick:()=>{x({...h,github_linkbacks:!h.github_linkbacks})},switcherProps:{on:h.github_linkbacks}})},"github_linkbacks"),(0,w.jsx)(ao().A,{renderTooltip:()=>l.formatMessage(hl.activityCommentsToggleDescription),render:e=>(0,w.jsx)(yl().A,{...e,title:l.formatMessage(hl.activityCommentsToggle),onClick:()=>{x({...h,activity_comments:!h.activity_comments})},switcherProps:{on:h.activity_comments}})},"activity_comments")]})]})}function jl(e){const{setSelectedStatusProperty:t,intl:o}=e,n=(0,i().v3)(),r=(0,mt().ET)(),a=Ml();return(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,w.jsx)(pt().A,{size:"100%",innerStyle:a.addStatusDivider}),(0,w.jsx)("div",{style:a.addStatusDescription,children:o.formatMessage(hl.addStatusDescription)}),(0,w.jsxs)(te().A,{style:a.addStatusButton,onClick:e=>{e.stopPropagation(),_l(n,r,t)},children:[(0,io().W)({width:14}),(0,w.jsx)(Ja().A,{size:4}),o.formatMessage(hl.addStatusButton)]}),(0,w.jsx)(Ja().A,{size:4})]})}function Al(e){const{selectedStatusProperty:t,setSelectedStatusProperty:o,existingStatusProperties:n,intl:r}=e,a=(0,i().v3)(),l=(0,mt().ET)(),s=(0,i().Y0)(),c=Ml(),d=(0,S().DP)(),u=n.map((e=>{const{id:t,schema:n}=e;return{key:t,action:()=>{o(e)},render:t=>(0,w.jsx)($().A,{...t,icon:(0,w.jsx)(fo().Ay,{size:Sl,theme:d,icon:e&&e.schema.icon,type:"status"}),title:n.name})}})).filter(W().O9),p={key:"newStatusProperty",action:()=>{_l(a,l,o)},render:e=>(0,w.jsx)($().A,{...e,icon:(0,io().W)(c.statusPickerIcon),title:r.formatMessage(hl.newStatusPropertyButton)})};return(0,w.jsxs)("div",{style:c.statusPickerWrapper,children:[(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[r.formatMessage(hl.autoUpdate),s.isMobile&&(0,w.jsx)(Ja().A,{size:4}),(0,w.jsx)(Q().Ay,{placementToOrigin:Q().sx.Bottom,alignmentToOrigin:Q().yP.Start,popupType:s.isMobile?Q().z7.SlideUp:Q().z7.Popup,renderOrigin:e=>(0,w.jsx)($().A,{...e,title:t.schema.name,focused:!1,style:c.statusPickerButtonCore,textWrapperStyle:c.statusPickerButtonTextWrapper,left:(0,w.jsx)(fo().Ay,{size:Sl,theme:d,icon:t.schema.icon,type:"status"}),leftStyle:{marginLeft:2},showExtensionArrow:!0,extensionArrowStyle:c.statusPickerExtensionArrow}),render:e=>{const t=s.isMobile?{menuType:fl().gu.ActionSheet}:{menuType:fl().gu.Popup,width:150};return(0,w.jsx)(J().A,{...t,children:(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,sections:[{key:0,render:e=>(0,w.jsx)(oe().A,{...e}),items:[...u,p]}],initialFocus:0,onAccept:e.close})})}})]}),s.isMobile&&(0,w.jsx)(Ja().A,{size:4}),r.formatMessage(hl.when)]})}function _l(e,t,o){const n=t.collectionStore();n&&p().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",environment:e,canUndo:!0,perform:i=>{const r=st().IL({environment:e,collectionStore:n,collectionViewArgs:void 0,propertyType:"status",transaction:i}),a=(0,ht().Jq)(t,r);a&&(0,mo().DD)(a)&&o({id:r,schema:a})}})}function Ml(){const e=(0,i().Y0)().isMobile;return(0,S().IS)((t=>({addStatusDivider:{borderColor:t.tableDividerColor},addStatusDescription:{width:"calc(100% - 24px)",padding:e?"16px 8px":"14px 0px",fontSize:e?16:12,color:t.lightTextColor},addStatusButton:{width:"calc(100% - 24px)",display:"inline-flex",alignItems:"center",justifyContent:"center"},noneText:{color:t.lightTextColor},automationMenuItemArrow:{width:12,fill:t.lightIconColor,stroke:t.lightIconColor,strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{display:"inline-flex",alignItems:"center",flexWrap:"wrap",rowGap:2,marginBottom:e?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:e?28:20,borderRadius:5,maxWidth:e?150:100},statusPickerIcon:{width:Sl,height:Sl},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2}})),[e])}var kl=()=>o(283860);const Il=(0,B().YK)({tabTitle:{defaultMessage:"GitHub Pull Requests",id:"database.viewSettings.githubConfigTab.tabTitle"},connect:{defaultMessage:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{defaultMessage:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},tabDescription:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function Tl(e){let{collectionContextStore:t,intl:o}=e;const n=Ll(),{hoveredBackground:a,pressedBackground:l}=Dl(),s=(0,Xa().J)(),c=(0,i().v3)(),d=Kl(),u=function(e){return(0,r().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e])}(t);return(0,w.jsxs)(oe().A,{disableMobileBorders:!0,mobileStyle:n.previewContentContainer,style:n.previewContentContainer,children:[(0,w.jsx)("img",{src:"/images/external_integrations/github-icon.png",style:{width:36,height:36}}),(0,w.jsx)("p",{style:n.connectDescription,children:s?(0,Za().Jb)().description:o.formatMessage(Il.connectDescriptionAdmin)}),(0,w.jsx)(Oo().p,{style:n.connectButton,hoveredStyle:{background:a},pressedStyle:{background:l},disabled:!s,disabledFeedback:!s,onClick:async e=>{if(e.preventDefault(),u&&d)try{await ro().Jq({environment:c,spaceId:u,integration:d,from:"connected_relation_property_menu"})}catch(t){const e=o.formatMessage(Il.authError);V().f1(e)}},children:o.formatMessage(Il.connect)}),(0,w.jsx)(Ja().A,{size:4})]})}function Pl(e){let{collectionContextStore:t}=e;const o=Ll(),{isMobile:n}=(0,i().Y0)(),r=Fl(t);return(0,w.jsxs)(oe().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,style:o.previewContentContainer,children:[(0,w.jsx)(Ja().A,{size:n?16:8}),(0,w.jsx)(kl().A,{width:"calc(100% - 24px)",uniqueIdPrefix:null==r?void 0:r.prefix})]})}function Bl(e){let{collectionContextStore:t,intl:o,selectedStatusProperty:n}=e;const i=(0,r().K8)((()=>t.databaseType),[t]),a=Fl(t),l=Ll(),s=(0,dt().$O)(i),c=(0,dt().oj)(i);let d;return d=a&&a.prefix?n?o.formatMessage(Il.tabDescription,{singleItemName:s}):o.formatMessage(Il.tabDescriptionNoStatus,{singleItemName:s}):o.formatMessage(Il.tabDescriptionNoIdPrefix,{pluralItemName:c}),(0,w.jsx)(oe().A,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:l.tabDescription,style:l.tabDescription,children:d})}function Rl(e){let{collectionContextStore:t}=e;const o=Fl(t);return o&&o.prefix?null:(0,w.jsx)(nl,{collectionContextStore:t,uniqueIdProperty:o&&{propertyId:o.id,propertySchema:o.schema},prefixValue:null==o?void 0:o.prefix})}function Vl(e){let{collectionContextStore:t,selectedStatusProperty:o,setSelectedStatusProperty:n,property:i,intl:r}=e;const a=Fl(t);return a&&a.prefix?(0,w.jsx)(wl,{selectedStatusProperty:o,setSelectedStatusProperty:n,gitHubProperty:i,intl:r}):null}function Fl(e){return(0,r().K8)((()=>{var t,o;const n=null===(t=e.collectionStore())||void 0===t||null===(t=t.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema(),r=i&&(0,W().WP)(i).find((e=>{let[,t]=e;return t&&"auto_increment_id"===t.type}));if(r){const[e,t]=r;if(t&&"auto_increment_id"===t.type)return{id:e,schema:t,prefix:n}}}),[e])}function Kl(){return(0,r().K8)((()=>co().A.integrations.state.find((e=>e.id===wo().ob))),[])}function Dl(){const e=Kl(),t=(0,S().DP)();return(0,r().K8)((()=>hn(e,t.mode)),[e,t.mode])}function Ll(){const{isMobile:e}=(0,i().Y0)(),{background:t}=Dl();return(0,S().IS)((o=>({previewContentContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},connectButton:{fontSize:14,maxWidth:"calc(100% - 24px)",height:void 0,color:o.text.contrastPrimary,background:t,whiteSpace:"normal",padding:8,textAlign:"center"},connectDescription:{maxWidth:"calc(100% - 24px)",color:o.lightTextColor,fontSize:14,textAlign:"center"},tabDescription:{padding:e?18:14,fontSize:e?16:12,color:o.lightTextColor}})),[e,t])}const Ol=(0,B().j4)((function(e){const{collectionContextStore:t,property:o,intl:i}=e,[a,l]=(0,n.useState)(void 0);return(0,r().K8)((()=>{const e=co().A.bots.state.find((e=>e.integration_id===wo().ob));return Boolean(e)}),[])?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Pl,{collectionContextStore:t}),(0,w.jsx)(Bl,{collectionContextStore:t,intl:i,selectedStatusProperty:a}),(0,w.jsx)(Rl,{collectionContextStore:t}),(0,w.jsx)(Vl,{collectionContextStore:t,selectedStatusProperty:a,setSelectedStatusProperty:l,property:o,intl:i})]}):(0,w.jsx)(Tl,{collectionContextStore:t,intl:i})}));var El=()=>o(713998);const zl={viewBox:"0 0 20 20",svg:(0,w.jsx)("path",{d:"M16.625 8A2.625 2.625 0 0 0 14 5.375h-1.42a.625.625 0 1 1 0-1.25H14a3.875 3.875 0 0 1 0 7.75H4.259l3.333 3.333a.625.625 0 0 1-.884.884l-4.4-4.4a.625.625 0 0 1 0-.884l4.4-4.4a.625.625 0 0 1 .884.884l-3.333 3.333H14A2.625 2.625 0 0 0 16.625 8"})},Nl=(0,b().wt)("arrowUTurnDownLeft",zl);var Ul=()=>o(742117),Hl=()=>o(764781),Wl=()=>o(471095),Gl=()=>o(236262),ql=()=>o(798880),Yl=()=>o(441738),$l=()=>o(59400),Ql=()=>o(937075),Zl=()=>o(966759),Jl=()=>o(854593),Xl=()=>o(617254),es=()=>o(324587),ts=()=>o(831566),os=()=>o(797535),ns=()=>o(419167);function is(e){let{setAiInference:t,aiInference:o,disabled:i}=e;const r=(0,n.useRef)(aa().JW()),a=()=>{if(!o)return;const e={...o,add_options:!o.add_options};t(e)};return(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)(B().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.description",defaultMessage:"New options are created based on property name & page details"}),placement:so().W.Bottom,render:e=>(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.text",defaultMessage:"Generate new options"}),showChevron:!1,right:(0,w.jsx)($t().A,{inputId:r.current,on:!(null==o||!o.add_options),onClick:a,disabled:!1,noColor:!1}),onClick:a,disabled:Boolean(i),textWrapperStyle:{minWidth:"auto"},...e})})}const rs=n.memo(is);var as=()=>o(8980),ls=()=>o(515918),ss=()=>o(798174),cs=()=>o(495159),ds=()=>o(68465);const us=(0,b().wt)("numbers",{viewBox:"0 0 22 12",svg:(0,w.jsx)("path",{d:"M2.91732 11V2.50293H2.80795L0.299156 4.32129V3.02246L2.92416 1.13574H4.14779V11H2.91732ZM6.73438 11V10.1523L10.0703 6.54297C10.4896 6.08724 10.8177 5.71126 11.0547 5.41504C11.2917 5.11426 11.458 4.8431 11.5537 4.60156C11.6494 4.36003 11.6973 4.0957 11.6973 3.80859V3.79492C11.6973 3.44857 11.6221 3.13867 11.4717 2.86523C11.3213 2.5918 11.1071 2.37533 10.8291 2.21582C10.5511 2.05632 10.2184 1.97656 9.83105 1.97656C9.43913 1.97656 9.09505 2.05859 8.79883 2.22266C8.5026 2.38216 8.27246 2.60775 8.1084 2.89941C7.94434 3.18652 7.8623 3.52376 7.8623 3.91113L7.85547 3.9248L6.67969 3.91797L6.66602 3.91113C6.67057 3.3278 6.81185 2.81055 7.08984 2.35938C7.36784 1.90365 7.75065 1.54818 8.23828 1.29297C8.72591 1.0332 9.28418 0.90332 9.91309 0.90332C10.4873 0.90332 11.0046 1.02409 11.4648 1.26562C11.9251 1.5026 12.2874 1.82845 12.5518 2.24316C12.8206 2.65788 12.9551 3.13184 12.9551 3.66504V3.67871C12.9551 4.05241 12.889 4.41243 12.7568 4.75879C12.6292 5.10514 12.4014 5.49023 12.0732 5.91406C11.7451 6.33333 11.2826 6.85059 10.6855 7.46582L8.13574 10.0977L8.44336 9.53027V10.0977L8.14258 9.89258H13.1191V11H6.73438ZM18.276 11.1641C17.597 11.1641 17.0046 11.0479 16.4987 10.8154C15.9928 10.583 15.5918 10.264 15.2956 9.8584C15.0039 9.4528 14.8353 8.99023 14.7897 8.4707L14.7829 8.38867H15.9655L15.9723 8.45703C16.0042 8.7806 16.1182 9.06543 16.3141 9.31152C16.5146 9.55762 16.7812 9.7513 17.1139 9.89258C17.4512 10.0293 17.8385 10.0977 18.276 10.0977C18.709 10.0977 19.0872 10.0225 19.4108 9.87207C19.7389 9.72168 19.9941 9.51432 20.1764 9.25C20.3587 8.98112 20.4499 8.6735 20.4499 8.32715V8.31348C20.4499 7.70736 20.2471 7.24251 19.8415 6.91895C19.4404 6.59082 18.8936 6.42676 18.2008 6.42676H16.9635V5.3877H18.1462C18.5381 5.3877 18.8844 5.31478 19.1852 5.16895C19.486 5.01855 19.7207 4.81576 19.8893 4.56055C20.0579 4.30078 20.1423 4.00684 20.1423 3.67871V3.66504C20.1423 3.31868 20.0693 3.02474 19.9235 2.7832C19.7777 2.54167 19.5635 2.3571 19.2809 2.22949C19.0029 2.10189 18.6634 2.03809 18.2624 2.03809C17.875 2.03809 17.5286 2.10417 17.2233 2.23633C16.9225 2.36393 16.681 2.5485 16.4987 2.79004C16.3164 3.03158 16.207 3.31868 16.1706 3.65137L16.1637 3.71973H14.9811L14.988 3.65137C15.0426 3.11361 15.2113 2.64421 15.4938 2.24316C15.7809 1.84212 16.1592 1.52995 16.6286 1.30664C17.1025 1.08333 17.6471 0.97168 18.2624 0.97168C18.8913 0.97168 19.4381 1.08105 19.903 1.2998C20.3724 1.514 20.7347 1.8125 20.9899 2.19531C21.2497 2.57357 21.3796 3.01335 21.3796 3.51465V3.52832C21.3796 3.93392 21.2907 4.29395 21.113 4.6084C20.9352 4.92285 20.6891 5.1849 20.3747 5.39453C20.0602 5.60417 19.6979 5.75228 19.2878 5.83887V5.86621C20.0078 5.92546 20.5889 6.16927 21.0309 6.59766C21.4775 7.02148 21.7008 7.58431 21.7008 8.28613V8.2998C21.7008 8.84668 21.5527 9.33659 21.2565 9.76953C20.9603 10.2025 20.5547 10.5443 20.0397 10.7949C19.5247 11.041 18.9368 11.1641 18.276 11.1641Z"})}),ps=(0,b().wt)("numbersBold",{viewBox:"0 0 39 19",svg:(0,w.jsx)("path",{d:"M5.05697 18V3.98438H4.96322L0.627281 6.97266V4.19531L5.04525 1.08984H8.03353V18H5.05697ZM11.8711 18V15.9375L17.7656 10.1484C18.5156 9.41406 19.0859 8.80859 19.4766 8.33203C19.8672 7.84766 20.1367 7.41406 20.2852 7.03125C20.4336 6.64844 20.5078 6.25 20.5078 5.83594V5.80078C20.5078 5.29297 20.3906 4.84375 20.1562 4.45312C19.9219 4.0625 19.5938 3.75781 19.1719 3.53906C18.7578 3.3125 18.2734 3.19922 17.7188 3.19922C17.1016 3.19922 16.5547 3.32812 16.0781 3.58594C15.6016 3.83594 15.2266 4.17969 14.9531 4.61719C14.6875 5.04688 14.5508 5.53906 14.543 6.09375L14.5312 6.16406H11.7188L11.707 6.09375C11.707 5.05469 11.9688 4.13672 12.4922 3.33984C13.0234 2.53516 13.7422 1.90625 14.6484 1.45312C15.5547 1 16.582 0.773438 17.7305 0.773438C18.8555 0.773438 19.8477 0.984375 20.707 1.40625C21.5742 1.82031 22.25 2.39453 22.7344 3.12891C23.2266 3.85547 23.4727 4.68359 23.4727 5.61328V5.64844C23.4727 6.30469 23.3516 6.92578 23.1094 7.51172C22.875 8.08984 22.4727 8.72266 21.9023 9.41016C21.332 10.0898 20.5469 10.9141 19.5469 11.8828L14.8477 16.3594L15.8789 14.4961V16.3594L14.8594 15.5273H23.7305V18H11.8711ZM32.0094 18.293C30.7751 18.293 29.6969 18.0898 28.7751 17.6836C27.8532 17.2695 27.1227 16.6992 26.5837 15.9727C26.0446 15.2461 25.736 14.4102 25.6579 13.4648L25.6462 13.3242H28.529L28.5407 13.4414C28.6032 13.9023 28.779 14.3125 29.068 14.6719C29.3649 15.0312 29.7633 15.3164 30.2633 15.5273C30.7633 15.7305 31.3454 15.832 32.0094 15.832C32.6657 15.832 33.236 15.7227 33.7204 15.5039C34.2126 15.2773 34.5915 14.9688 34.8571 14.5781C35.1305 14.1797 35.2673 13.7227 35.2673 13.207V13.1836C35.2673 12.293 34.9587 11.6094 34.3415 11.1328C33.7243 10.6562 32.8766 10.418 31.7985 10.418H29.7946V8.16797H31.7282C32.3532 8.16797 32.8962 8.05859 33.3571 7.83984C33.8258 7.62109 34.1891 7.32422 34.4469 6.94922C34.7048 6.56641 34.8337 6.12891 34.8337 5.63672V5.61328C34.8337 5.09766 34.7204 4.66016 34.4938 4.30078C34.2751 3.94141 33.9508 3.66797 33.5212 3.48047C33.0993 3.28516 32.5876 3.1875 31.986 3.1875C31.3923 3.1875 30.8649 3.28516 30.404 3.48047C29.9508 3.67578 29.5876 3.95312 29.3141 4.3125C29.0407 4.67188 28.8766 5.09766 28.8219 5.58984L28.8102 5.69531H26.0094L26.0212 5.56641C26.1071 4.60547 26.404 3.76953 26.9118 3.05859C27.4274 2.33984 28.1149 1.78516 28.9743 1.39453C29.8415 0.996094 30.8454 0.796875 31.986 0.796875C33.1501 0.796875 34.1618 0.984375 35.0212 1.35938C35.8805 1.72656 36.5446 2.24219 37.0133 2.90625C37.4899 3.5625 37.7282 4.33203 37.7282 5.21484V5.23828C37.7282 5.93359 37.5719 6.55078 37.2594 7.08984C36.9548 7.62109 36.5329 8.0625 35.9938 8.41406C35.4626 8.76562 34.8571 9.01172 34.1774 9.15234V9.21094C35.4274 9.32812 36.4313 9.74219 37.1891 10.4531C37.9469 11.1562 38.3258 12.0938 38.3258 13.2656V13.2891C38.3258 14.2656 38.0602 15.1328 37.529 15.8906C36.9977 16.6484 36.2555 17.2383 35.3024 17.6602C34.3571 18.082 33.2594 18.293 32.0094 18.293Z"})});var gs=()=>o(115552),ms=()=>o(33218),fs=()=>o(937199);function ys(){const{layoutStore:e,currentModuleSelection:t,collectionStore:n}=(0,fs().LH)(),i=(0,r().K8)((()=>{if("existing_module"===(null==t?void 0:t.type))return e.getModuleById(t.moduleId)}),[t,e]),a=(0,r().K8)((()=>{if((0,o(778781).gx)(i))return null==n?void 0:n.getSchemaStore().getKeyStore(i.propertyId).getValue()}),[n,i]);if(!i||!a)return null;switch(i.type){case"property_person":case"property_created_by":case"property_last_edited_by":return(0,w.jsx)(xs,{module:i,options:Ss,heightVariant:"tall"});case"property_formula":return(0,o(708685).isNumberFormulaPropertySchema)(a)?(0,w.jsx)(xs,{module:i,options:vs,heightVariant:"short"}):null;case"property_number":return(0,w.jsx)(xs,{module:i,options:vs,heightVariant:"short"});case"property_file":return(0,w.jsx)(xs,{module:i,options:hs,heightVariant:"short"});default:return null}}const Ss={available:["large","compact"],appearance:{compact:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.compact",defaultMessage:"Compact"}),image:{src:h().A.images.layouts.configuration.personCompactPng,width:100,height:41}},large:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.large",defaultMessage:"Large"}),image:{src:h().A.images.layouts.configuration.personMediumPng,width:82,height:56}}}},hs={available:["landscape","portrait","square"],appearance:{landscape:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.landscape",defaultMessage:"Landscape"}),image:{src:h().A.images.layouts.configuration.fileLandscapePng,width:192,height:128}},portrait:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.portrait",defaultMessage:"Portrait"}),image:{src:h().A.images.layouts.configuration.filePortraitPng,width:192,height:128}},square:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.square",defaultMessage:"Square"}),image:{src:h().A.images.layouts.configuration.fileSquarePng,width:192,height:128}}}},vs={available:["large","small"],appearance:{large:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.large",defaultMessage:"Large"}),icon:{function:ps,size:42}},small:{label:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.small",defaultMessage:"Small"}),icon:{function:us,size:22}}}};function xs(e){let{module:t,options:o,heightVariant:r}=e;const a=(0,i().v3)(),{layoutStore:l}=(0,fs().LH)(),s=(0,n.useCallback)((e=>{const o=l.getModel(),n=null==o?void 0:o.getPageModuleAreaById(t.id);if(!n||!o)return;const i={...t,style:e};p().createAndCommit({environment:a,perform(e){(0,ms().UQ)({environment:a,transaction:e,layoutStore:l,position:{area:n,moduleId:i.id},updatedModule:i})},canUndo:!0,userAction:"BuilderLayoutModules.setDisplayStyle"})}),[a,l,t]),c=(0,S().IS)((e=>({container:{margin:"10px 8px"},label:{fontSize:R().J.UISmall.desktop,fontWeight:R().Wy.medium,margin:"0px 8px 6px 8px",color:e.text.secondary}})),[]);return(0,w.jsxs)("div",{style:c.container,children:[(0,w.jsx)("p",{style:c.label,children:(0,w.jsx)(B().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.title",defaultMessage:"Style"})}),(0,w.jsx)(gs().A,{disabled:!1,options:o,selectedOption:t.style,onOptionSelected:s,height:r})]})}var Cs=()=>o(411671),bs=()=>o(749240),ws=()=>o(597777),js=()=>o(971404);function As(e){let{collectionContextStore:t,property:o}=e;const n=(0,B().tz)(),a=(0,i().v3)(),l=(0,r().K8)((()=>_s(t,o)),[t,o]),s=(0,r().K8)((()=>t.getPropertyFormat(o)),[t,o]);if(!l)return null;const c=(null==s?void 0:s.date_format)||l.date_format||ws().vz,d=function(e){const t=Ms();for(const o in t)if(t[o]===e)return o;return"12h"}((null==s?void 0:s.time_format)||l.time_format||ws().CE);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),selectedKey:c,popupStyle:{minWidth:190},options:ws().wJ.map((e=>({key:e,type:"button",title:n.formatMessage(ws().xz[e])}))),onChange:e=>function(e,t,o,n){const i="collectionTypedView"===o.contextType;if(i){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;p().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvDateFormatChange",environment:t,canUndo:!0,perform:t=>{st().a5({formatStore:i,formatKey:r,property:n,update:{date_format:e},transaction:t})}})}else{const i=o.collectionStore(),r=_s(o,n);if(!i||!r)return;const a={...r,date_format:e};p().createAndCommit({userAction:"CollectionSettingsDateOptions.handleDateFormatChange",environment:t,canUndo:!0,perform:e=>{(0,ul().F)({environment:t,collectionStore:i,update:{[n]:a},transaction:e})}})}(0,tl().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_format"})}(e,a,t,o)}),(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),selectedKey:d,popupStyle:{minWidth:190},options:ws().ZD.map((e=>({key:e,type:"button",title:n.formatMessage(ws().px[e])}))),onChange:e=>function(e,t,o,n){const i=Ms()[e],r="collectionTypedView"===o.contextType;if(r){const e=o.formatStore();if(!e)return;const r=o.getPropertyFormatKey();if(!r)return;p().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvClockFormatChange",environment:t,canUndo:!0,perform:t=>{st().a5({formatStore:e,formatKey:r,property:n,update:{time_format:i},transaction:t})}})}else{const e=o.collectionStore(),r=_s(o,n);if(!e||!r)return;const a={...r,time_format:i};p().createAndCommit({userAction:"CollectionSettingsDateOptions.handleClockFormatChange",environment:t,canUndo:!0,perform:o=>{(0,ul().F)({environment:t,collectionStore:e,update:{[n]:a},transaction:o})}})}(0,tl().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_time_format"})}(e,a,t,o)})]})}function _s(e,t){const o=e.normalizedSchemaStore.state[t];if(o)return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?o:void 0}function Ms(){return(0,js().X)(Ba().locale).time}var ks=()=>o(91451);function Is(e){const{collectionContextStore:t,property:o,propertySchema:r}=e,a=(0,i().v3)(),l=(0,n.useCallback)((e=>{const n={...r,default:"created_by"===e?"created_by":void 0},i=t.collectionStore();i&&((0,ts().p)({environment:a,collectionStore:i,performTransaction:t=>{p().applyOperation({store:(0,Y().Oo)(i,i.pointer),operation:{pointer:i.pointer,command:"update",path:["schema",o],args:{default:e}},transaction:t})}}),p().createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",environment:a,canUndo:!0,perform:e=>{(0,ul().F)({environment:a,collectionStore:i,update:{[o]:n},transaction:e})}}))}),[t,a,o,r]);return(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:r.default?"created_by":"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",type:"button",title:(0,w.jsx)(B().sA,{defaultMessage:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:"created_by",type:"button",title:(0,w.jsx)(B().sA,{defaultMessage:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:(0,ks().z)({width:16})}],onChange:l})}function Ts(e){let{collectionContextStore:t,collectionSettingsStore:a,property:l}=e;const s=(0,i().v3)(),c=(0,r().uB)(void 0,vt().A),d=(0,n.useCallback)((e=>{const n=t.collectionStore();if(!n)return null;const i=t.normalizedSchemaStore.state[l];if("formula"!==(null==i?void 0:i.type))return;const r=Boolean(n.getDatabaseType()&&n.isTypedProperty(l)),c=null==a?void 0:a.getState().fromBlockStore;return(0,w.jsx)(Oe().u2,{dependency:o(862292).T.formulas,children:t=>(0,w.jsx)(o(490696).A,{handleClose:e.close,property:l,getRecordModel:n.getRecordModel,propertySchema:i,collectionStore:n,handleSave:e=>function(e,t){const{newValue:o,newType:n,propertySchema:i,property:r,collectionStore:a}=e,l=o?{...i,formula2:{code:o,result_type:n},version:"v2"}:{...i,formula2:void 0,version:"v2"};p().createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,ul().F)({environment:t,collectionStore:a,update:{[r]:l},transaction:e})}})}(e,s),formulas:t,disabled:r,blockStore:c,analyticsFrom:"view_settings"})})}),[t,a,s,l]);return(0,w.jsx)(Q().Ay,{popupType:s.device.isMobile?ee().nl.SlideUp:ee().nl.Popup,alignmentToOrigin:Q().yP.End,renderOrigin:e=>(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Edit formula",id:"database.viewSettings.formulaOptions.title"}),showChevron:!0,rotateChevron:c.state.open,...e}),render:d,buttonPopupStore:c})}const Ps=n.memo(Ts,pi().A);function Bs(e,t,o){return"1"===e?"relation"===t?o&&!0===o?(0,w.jsx)(B().sA,{defaultMessage:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}):(0,w.jsx)(B().sA,{defaultMessage:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}):(0,w.jsx)(B().sA,{defaultMessage:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:Gn().dC[t]}}):"no_limit"===e?(0,w.jsx)(B().sA,{defaultMessage:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function Rs(e,t,o){return{key:e,type:"button",title:Bs(e,t,o)}}function Vs(e){const{property:t,propertySchema:o,collectionContextStore:r}=e,a=(0,i().v3)(),l=(0,n.useCallback)((e=>{const n=r.collectionStore();if(!n||!(0,mo().sO)(o))return;const i={...o,limit:Number(e)?1:void 0};p().createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",environment:a,canUndo:!0,perform:e=>{(0,ul().F)({environment:a,collectionStore:n,update:{[t]:i},transaction:e})}});const l=Number(e)?`${o.type}_toggle_limit_on`:`${o.type}_toggle_limit_off`;(0,tl().V)({environment:a,collectionContextStore:r,property:t,from:"view_settings",action:l})}),[r,a,t,o]);return(0,mo().sO)(o)?"relation"===o.type&&o.connectedRelation?(0,w.jsx)(Fs,{propertyType:o.type,connectedRelation:!0,selectedKey:o.limit?"1":"no_limit",onChange:l}):(0,w.jsx)(Fs,{propertyType:o.type,selectedKey:o.limit?"1":"no_limit",onChange:l}):null}function Fs(e){const{propertyType:t,selectedKey:o,connectedRelation:n,onChange:i}=e;return(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),selectedKey:o,popupStyle:{minWidth:190},options:[Rs("1",t,n),Rs("no_limit",t)],onChange:i})}var Ks=()=>o(795656),Ds=()=>o(913687),Ls=()=>o(630053),Os=()=>o(925907);const Es=(0,B().YK)({linkPreviewDescription:{defaultMessage:"Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.linkPreviewDescription"}});function zs(){const e=Us(),t=(0,B().tz)();return(0,w.jsxs)(oe().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:e.previewContentContainer,children:[(0,w.jsxs)("div",{style:e.tabDescription,children:[" ","Preview"]}),(0,w.jsx)("div",{children:(0,w.jsx)("img",{src:h().A.images.externalIntegrations.salesforceLinkpreviewPng,style:e.previewContentContainer})}),(0,w.jsx)("div",{style:e.tabDescription,children:t.formatMessage(Es.linkPreviewDescription)})]})}function Ns(e){let{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a}=e;const s=Us(),c=t.settingsStore;return(0,w.jsxs)(oe().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:s.previewContentContainer,children:[(0,w.jsxs)("div",{style:s.tabDescription,children:[" ","Database actions"]}),(0,w.jsx)(D().A,{showChevron:!0,title:"Add properties",icon:kr().j,onClick:()=>{(0,l().u4)({environment:a,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",integrationId:i}}}),d().a2({collectionSettingsStore:c,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}}),(0,w.jsx)(D().A,{showChevron:!0,title:"Copy URL",icon:Os().n,onClick:()=>{d().a2({collectionSettingsStore:c,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationCopyUrl",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}})]})}function Us(){const{isMobile:e}=(0,i().Y0)();return(0,S().IS)((t=>({addDivider:{borderColor:t.tableDividerColor},previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:e?18:10,fontSize:e?16:12,color:t.lightTextColor}})),[e])}const Hs=function(e){const{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a}=e,l=Us();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(zs,{}),(0,w.jsx)(pt().A,{size:"100%",innerStyle:{borderColor:l.addDivider.borderColor}}),(0,w.jsx)(Ns,{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a})]})};var Ws=()=>o(27732),Gs=()=>o(68263),qs=()=>o(806401),Ys=()=>o(487941);function $s(e){const{temporaryAutoRelateState:t,handleAutoRelateToggle:o,collectionStore:n,targetCollectionStore:a,autoRelate:l}=e,s=(0,i().Y0)(),c=(0,r().K8)((()=>(null==n?void 0:n.getFormat().bot_id)||a.getFormat().bot_id),[n,a]),d=(0,r().K8)((()=>!!c),[c]),u=(0,S().IS)((e=>({errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6}})),[]),p=(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[(0,w.jsx)(B().sA,{defaultMessage:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),!s.isMobile&&(0,w.jsx)(ao().A,{render:e=>(0,w.jsx)("div",{...e,children:(0,M().$)(u.helpIcon)}),style:{width:200},placement:so().W.Bottom,textWrap:!0,renderTooltip:()=>(0,w.jsx)(B().sA,{defaultMessage:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})})]});return d?(0,w.jsx)(ne().A,{title:p,on:t?t.enabled:!!l&&(null==l?void 0:l.enabled),focused:!1,onClick:()=>o(c),textWrapperStyle:{opacity:1}}):null}function Qs(e){const{collectionContextStore:t,property:o,targetCollectionStore:a,temporaryInverseState:l,setTemporaryInverseState:s,mode:c="edit",onSubmit:d,shouldEnforceTwoWayRelation:u}=e,p=(0,i().v3)(),g=(0,i().Y0)(),m=(0,B().tz)(),f=(0,r().uB)(void 0,vt().A),y=(0,r().K8)((()=>o?ht().Jq(t,o):void 0),[t,o]),h=(0,qs().D)(y),v=(0,r().K8)((()=>t.collectionStore()),[t]),x=(0,r().K8)((()=>t.contextType),[t]),C=Boolean((null==v?void 0:v.id)===a.id),b=(0,r().K8)((()=>Boolean(o?ht().D5(t,o,a):void 0)),[t,o,a]),j=(0,r().K8)((()=>{if("relation"!==(null==y?void 0:y.type))return"";const e=y.property;if(!e||e===o)return"";const t=a.getRole();if(!t||!Gs().Tt(t))return"";const n=a.getSchema()[e];return(null==n?void 0:n.name)||""}),[a,o,y]),A=(0,r().K8)((()=>"relation"===(null==y?void 0:y.type)&&y.autoRelate?y.autoRelate:{enabled:!1}),[y]),_=(0,r().K8)((()=>Boolean(ht().uf(a))),[a]),k=(0,r().K8)((()=>Boolean((null==v?void 0:v.getDatabaseType())&&o&&(null==v?void 0:v.isTypedProperty(o)))),[v,o]),I=(0,n.useMemo)((()=>l?l.hasInverseRelation:b),[l,b]),T=(0,n.useMemo)((()=>l?l.inverseName:j),[l,j]),P=(0,n.useMemo)((()=>l?l.autoRelate:A),[l,A]),R=(0,n.useCallback)((()=>{o&&(0,tl().V)({environment:p,collectionContextStore:t,property:o,from:"collectionPage"===x?"page_properties":"view_settings",action:I?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:C})}),[o,t,p,x,C,I]),V=(0,n.useCallback)((()=>null!=v&&v.isSyncedCollection()?P:I?{enabled:!1}:P),[v,P,I]),F=(0,n.useCallback)((()=>{s({hasInverseRelation:!0,inverseName:T,autoRelate:V()}),R()}),[s,T,R,V]),K=(0,n.useCallback)((()=>{s({hasInverseRelation:!1,inverseName:void 0,autoRelate:V()}),R()}),[s,R,V]),L=Boolean(h||!_||k||u),O=(0,n.useCallback)((e=>{s({hasInverseRelation:!0,inverseName:e.target.value,autoRelate:P})}),[s,P]),E=(0,n.useCallback)((e=>{const n=null!=P&&P.enabled?{enabled:!1}:{enabled:!0,bot_id:e};s({hasInverseRelation:I,inverseName:T,autoRelate:n}),o&&(0,tl().V)({environment:p,collectionContextStore:t,property:o,from:"collectionPage"===x?"page_properties":"view_settings",action:n.enabled?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[o,s,t,x,T,I,P,p]),z=(0,n.useCallback)((e=>{(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:d})}),[d]),N=(0,S().IS)((e=>({container:{width:g.isMobile?"100%":250,paddingBottom:g.isMobile?16:8,paddingLeft:g.isMobile?8:4,paddingRight:g.isMobile?8:4,marginTop:8},errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6},modalTitleStyle:{fontSize:16,fontWeight:600,lineHeight:1.2,color:e.regularTextColor,marginTop:8,whiteSpace:"normal",marginLeft:14,marginRight:14},disabled:{opacity:.5,pointerEvents:"none"}})),[g]),U=(0,r().uB)(void 0,Ys().A),H=(0,r().K8)((()=>U.state.hovered||U.state.focused),[U]),W=(0,n.useMemo)((()=>!_||k?m.formatMessage(Xs.errors.cannotEditTargetDatabase):C?m.formatMessage(Xs.tooltips.selfRelationInverseTooltip):m.formatMessage(Xs.tooltips.inverseRelationTooltip,{databaseName:(0,w.jsx)(Da().A,{shouldWrap:!0,style:{display:"inline"},store:a})})),[_,k,m,C,a]),G=(0,n.useMemo)((()=>(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[m.formatMessage(Xs.generic.title),!g.isMobile&&(0,w.jsx)(ao().A,{placement:so().W.Bottom,textWrap:!0,style:{width:200},store:U,render:e=>(0,w.jsx)("div",{...e,children:(0,M().$)(N.helpIcon)}),renderTooltip:()=>W})]})),[m,g.isMobile,N.helpIcon,W,U]);return v?(0,w.jsxs)(w.Fragment,{children:["create"===c&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Zs,{currentInverseState:I,disableInverseRelation:K,enableInverseRelation:F,handleAutoRelateToggle:E,temporaryInverseState:l,collectionStore:v,targetCollectionStore:a,isTwoWayToggleDisabled:L,isNameDisabled:L,menuTitle:G,autoRelate:A,isSelfRelation:C,inverseRelationName:j,handleInverseNameChange:O}),(0,w.jsx)(te().A,{style:{display:"flex",margin:"6px 12px 0px 12px"},onClick:z,children:m.formatMessage(Xs.create.addRelation)})]}),"edit"===c&&(0,w.jsx)(pl().A,{focused:!1,disabled:L,popupType:g.isMobile?Q().z7.SlideUp:Q().z7.Popup,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,isFullWidthOnMobile:!0,buttonPopupStore:f,onClose:d,renderOrigin:e=>(0,w.jsx)(ao().A,{placement:so().W.Bottom,textWrap:!0,style:{width:200},forceVisibleState:!H&&void 0,disableTooltip:!h,render:t=>(0,w.jsx)("div",{...t,children:(0,w.jsx)(D().A,{...e,showChevron:!0,rotateChevron:f.state.open,title:G,disabled:L,right:I?m.formatMessage(Xs.generic.on):m.formatMessage(Xs.generic.off)})}),renderTooltip:()=>h&&m.formatMessage(Xs.tooltips.disabledTwoWayRelationTooltip)}),render:e=>(0,w.jsxs)("div",{style:N.container,children:[(0,w.jsx)(ne().A,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,disabled:L,on:I,title:m.formatMessage(Xs.edit.enable),titleStyle:{display:"inline-flex"},onClick:e=>{I?K():F()}}),(0,w.jsxs)("div",{style:I?void 0:N.disabled,children:[(0,w.jsx)($s,{handleAutoRelateToggle:E,temporaryAutoRelateState:null==l?void 0:l.autoRelate,collectionStore:v,autoRelate:A,targetCollectionStore:a}),(0,w.jsx)(Js,{collectionStore:v,targetCollectionStore:a,isSelfRelation:C,temporaryInverseState:l,inverseRelationName:j,disabled:L,onChange:O,title:(0,w.jsx)(gt().A,{isSecondaryColor:!0,isSmall:!0,children:m.formatMessage(Xs.edit.propertyNameLabel)})})]})]})})]}):null}function Zs(e){const{currentInverseState:t,disableInverseRelation:o,enableInverseRelation:n,handleAutoRelateToggle:i,temporaryInverseState:r,collectionStore:a,targetCollectionStore:l,isTwoWayToggleDisabled:s,isNameDisabled:c,menuTitle:d,autoRelate:u,isSelfRelation:p,inverseRelationName:g,handleInverseNameChange:m}=e,f=(0,B().tz)();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(ne().A,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,on:t,disabled:s,title:d,titleStyle:{display:"inline-flex"},onClick:()=>{t?o():n()}}),t&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($s,{handleAutoRelateToggle:i,temporaryAutoRelateState:null==r?void 0:r.autoRelate,collectionStore:a,autoRelate:u,targetCollectionStore:l}),(0,w.jsx)(Js,{collectionStore:a,targetCollectionStore:l,isSelfRelation:p,temporaryInverseState:r,inverseRelationName:g,disabled:c,onChange:m,title:(0,w.jsx)(gt().A,{isSmall:!0,isSecondaryColor:!0,children:p?f.formatMessage(Xs.create.selfRelationPropertyNameHeader):f.formatMessage(Xs.create.relationPropertyNameHeader)})})]})]})}function Js(e){const{collectionStore:t,targetCollectionStore:o,isSelfRelation:n,temporaryInverseState:i,inverseRelationName:a,disabled:l,onChange:s,title:c}=e,d=(0,B().tz)(),u=(0,r().K8)((()=>null!=t&&t.isDefined()?ht().zF(d,{sourceCollection:t.getModel(),isSelfRelation:n,targetCollectionStore:o,createUnique:!0}):d.formatMessage(Xs.placeholders.relatedToTarget)),[t,d,n,o]);return(0,w.jsx)(oe().A,{title:c,noTextOverflow:!0,children:(0,w.jsx)(xo().Ay,{value:(null==i?void 0:i.inverseName)||a,placeholder:u,onChange:s,onBlur:Ai().D_,onSubmit:Ai().D_,focusInitial:!0,selectAll:!1,disabled:l})})}const Xs={generic:(0,B().YK)({on:{id:"database.viewSettings.setupRelationTab.generic.on",defaultMessage:"On"},off:{id:"database.viewSettings.setupRelationTab.generic.off",defaultMessage:"Off"},title:{id:"database.viewSettings.setupRelationTab.generic.title",defaultMessage:"Two-way relation"}}),create:(0,B().YK)({addRelation:{id:"database.viewSettings.setupRelationTab.create.relation.add",defaultMessage:"Add relation"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.add",defaultMessage:"Show on{databaseName}"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.addSelfRelationInverse",defaultMessage:"Separate directions {icon}"},relationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.propertyNameHeader",defaultMessage:"Related property name"},selfRelationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.selfRelation.inverse.propertyNameHeader",defaultMessage:"Inverse related property name"}}),edit:(0,B().YK)({modalTitle:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.modalTitle",defaultMessage:"Related property settings"},enable:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.enable",defaultMessage:"Enable"},propertyNameLabel:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.propertyNameLabel",defaultMessage:"Related property name"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.add",defaultMessage:"Show on{databaseName}"},editRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.edit",defaultMessage:"Edit relation on {databaseName}"},saveRelationInverse:{id:"database.viewSettings.setupRelationTab.relation.inverse.save",defaultMessage:"Save"},removeRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.remove",defaultMessage:"Remove property"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.add",defaultMessage:"Add inverse property"},editSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.edit",defaultMessage:"Edit inverse property"},renameSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.rename",defaultMessage:"Rename"},saveSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.save",defaultMessage:"Save"},removeSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.remove",defaultMessage:"Remove property"}}),tooltips:(0,B().YK)({inverseRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.tooltip",defaultMessage:"Manage property on {databaseName} showing backlinks to the current database"},selfRelationInverseTooltip:{id:"database.viewSettings.setupRelationTab.selfRelation.inverse.tooltip",defaultMessage:"Manage separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more."},disabledTwoWayRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.disabled.tooltip",defaultMessage:"Two-way relations cannot be enabled when share settings are inherited through this relation."}}),errors:(0,B().YK)({cannotEditTargetDatabase:{id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title",defaultMessage:"Cannot edit target database."}}),placeholders:(0,B().YK)({relatedToTarget:{id:"database.viewSettings.setupRelationTab.relation.inverse.placeholder",defaultMessage:"Related to target"}})};function ec(e){const{collectionContextStore:t,property:o,targetCollectionStore:a}=e,l=(0,i().v3)(),s=(0,B().tz)(),c=(0,r().K8)((()=>t.collectionStore()),[t]),d=(0,r().K8)((()=>t.contextType),[t]),[u,g]=(0,n.useState)(void 0),m=Boolean(a&&(null==c?void 0:c.id)===a.id),f=(0,n.useCallback)((()=>{if(!u)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=u;p().createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",environment:l,canUndo:!0,perform:r=>{Ws().Go({environment:l,collectionContextStore:t,property:o,hasInverseRelation:e,inverseName:n,autoRelate:i,intl:s,transaction:r})}}),(0,tl().V)({environment:l,collectionContextStore:t,property:o,from:"collectionPage"===d?"page_properties":"view_settings",action:"relation_edit",is_self_relation:m,has_inverse:e,auto_relate:null==i?void 0:i.enabled}),g(void 0)}),[u,l,t,o,d,m,s]);return(0,w.jsx)(Qs,{collectionContextStore:t,targetCollectionStore:a,property:o,temporaryInverseState:u,setTemporaryInverseState:g,onSubmit:f})}const tc=(0,b().wt)("linkedRelationDark",{viewBox:"0 0 36 32",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#fff",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM8 3a.5.5 0 000 1h6.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H8z",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#fff",opacity:"0.5"}),(0,w.jsx)("path",{fill:"#564328",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,w.jsx)("path",{fill:"#CA984D",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),oc=(0,b().wt)("linkedRelationLight",{viewBox:"0 0 36 32",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#91918E",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM9 3a.5.5 0 000 1h5.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H9z",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#91918E",opacity:"0.5"}),(0,w.jsx)("path",{fill:"#FBF3DB",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,w.jsx)("path",{fill:"#CB912F",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),nc=(0,b().wt)("unlinkedRelationDark",{viewBox:"0 0 36 32",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#fff",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#fff",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#fff",opacity:"0.5"})]})}),ic=(0,b().wt)("unlinkedRelationLight",{viewBox:"0 0 36 32",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#91918E",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#91918E",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,w.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"})]})});var rc=()=>o(107683),ac=()=>o(898486),lc=()=>o(716108);function sc(e){const{collectionContextStore:t,property:o,propertySchema:a}=e,l=(0,B().tz)(),s=(0,i().v3)(),c=(0,i().Y0)(),d=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,ot().k7)(e,a)}),[t,a]),g=(0,r().K8)((()=>{var e;return Boolean(null===(e=a.permissions_data)||void 0===e?void 0:e.shared_by_enabled)}),[a]),m=(0,r().K8)((()=>"dark"===s.ThemeStore.state.mode),[s.ThemeStore]),f=(0,r().K8)((()=>m?nc:ic),[m]),y=(0,r().K8)((()=>m?tc:oc),[m]),h=(0,r().K8)((()=>null==d?void 0:d.getName()),[d]),v=(0,r().K8)((()=>null==u?void 0:u.getName()),[u]),x=d&&u&&d.id===u.id,C=(0,r().K8)((()=>{const e=d&&d.getSharingEnabledRelationId();return Boolean(e&&e!==o)}),[d,o]);let b;C?b="hasAnotherSharingEnabledProperty":x&&(b="isSelfRelation");const[j,A]=(0,n.useState)(!1),[_,M]=(0,n.useState)(!1),k=(0,r().K8)((()=>{const e={limit:!1,twoWayRelation:!1};if(!d)return e;if(1!==a.limit&&(e.limit=!0),u){ht().D5(t,o,u)&&(e.twoWayRelation=!0)}return e}),[d,a,t,o,u]),[I,T]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(!_){const e=[];k.limit&&e.push("limit"),k.twoWayRelation&&e.push("twoWayRelation"),T(e)}}),[k,_]);const P=(0,n.useCallback)((async e=>{if(!d)return;const t=a.property,n=(null==a?void 0:a.permissions_data)??{},i={...a,limit:1,autoRelate:void 0,permissions_data:{...n,shared_by_enabled:e}},{serverCommitResult:r}=p().createAndCommit({userAction:"CollectionSettingsShareBy.handleShareByChange",environment:s,canUndo:!0,perform:e=>{(0,ul().F)({environment:s,collectionStore:d,update:{[o]:i},transaction:e}),u&&t&&Ws().t$({environment:s,collectionStore:u,property:t,transaction:e})}});try{await r}catch(c){if(c instanceof lc().rS&&c.clientData){const e=(0,ac().Yu)(c.clientData),t=(0,ac().t4)(l,e);t&&V().f1(t)}}}),[d,a,s,o,u,l]),R=(0,n.useCallback)((e=>{d&&(e&&I.length>0?A(!0):P(e))}),[d,I,P]),F=(0,n.useCallback)((()=>{A(!1)}),[]),K=(0,n.useCallback)((async()=>{M(!0);try{await P(!0)}finally{M(!1),A(!1)}}),[P]),D=(0,S().IS)((e=>({disabled:{opacity:.5,pointerEvents:"none"},container:{marginLeft:14,marginRight:16,marginBottom:12},buttonTitle:{fontSize:c.isMobile?17:14,fontWeight:400,lineHeight:c.isMobile?"24px":"20px",textWrap:"wrap",overflow:"auto"},buttonDefault:{marginTop:12,paddingTop:c.isMobile?16:12,paddingBottom:c.isMobile?16:12,borderRadius:8,boxShadow:`0 0 0 1px ${e.selectLightGray[200]}`,gap:6},buttonSelected:{boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:c.isMobile?54:36,height:c.isMobile?48:32},disabledReasonContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,borderRadius:10,backgroundColor:e.tint.uiYellow,color:e.text.uiYellowPrimary,fontSize:12,textWrap:"pretty"},modalContainer:{padding:20,paddingBottom:12,width:c.isMobile?void 0:400},modalHeader:{display:"flex",flexDirection:"column"},modalHeaderIconContainer:{display:"flex",justifyContent:"center"},modalHeaderTitle:{display:"flex",justifyContent:"center",marginTop:8,fontSize:17,fontWeight:590,lineHeight:"22px",textAlign:"center",color:e.regularTextColor},modalHeaderDescription:{display:"flex",justifyContent:"center",marginTop:8,fontSize:14,lineHeight:"20px",color:e.mediumTextColor,textAlign:"center",textWrap:"pretty"},modalList:{display:"flex",marginTop:24,flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",fontSize:14,boxShadow:`0 0 0 1px ${e.selectLightGray[100]}`,borderRadius:10},modalListItem:{borderBottom:`1px solid ${e.selectLightGray[100]}`},modalListItemContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12}})),[c.isMobile]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(oe().A,{topBorder:!0,disableMobileBorders:!0,disableDesktopPadding:!0,disableMobilePadding:!0,mobileTitleStyle:{marginTop:12},mobileStyle:{paddingBottom:6},title:(0,w.jsx)(gt().A,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,children:(0,w.jsx)(B().sA,{id:"collectionSettings.relationSharingSwitcher.header",defaultMessage:"Share settings through relation"})}),children:[b&&(0,w.jsx)("div",{style:D.container,children:(0,w.jsx)("div",{style:D.disabledReasonContent,children:l.formatMessage(cc.disabledReasons[b])})}),(0,w.jsxs)("div",{style:{...D.container,...x&&D.disabled,...C&&D.disabled},children:[(0,w.jsx)($().A,{focused:!1,left:f(D.icon),title:(0,w.jsx)(B().sA,{id:"collectionSettings.relationSharingSwitcher.unlinkedTitle",defaultMessage:"{collectionName} and {relationName} have separate share settings",values:{collectionName:h,relationName:v}}),titleStyle:D.buttonTitle,style:{...D.buttonDefault,...!g&&D.buttonSelected},onClick:()=>R(!1)}),(0,w.jsx)($().A,{focused:!1,left:y(D.icon),title:(0,w.jsx)(B().sA,{id:"collectionSettings.relationSharingSwitcher.linkedTitle",defaultMessage:"{collectionName} inherit share settings from related {relationName}",values:{collectionName:h,relationName:v}}),titleStyle:D.buttonTitle,style:{...D.buttonDefault,...g&&D.buttonSelected},onClick:()=>R(!0)})]})]}),(0,w.jsx)(rc().s,{showCloseIcon:!0,isOpen:j,onDismiss:()=>{A(!1)},render:()=>(0,w.jsxs)("div",{style:D.modalContainer,children:[(0,w.jsxs)("div",{style:D.modalHeader,children:[(0,w.jsx)("div",{style:D.modalHeaderIconContainer,children:y({width:36,height:32,marginLeft:4})}),(0,w.jsx)("div",{style:D.modalHeaderTitle,children:l.formatMessage(cc.header.title)}),(0,w.jsx)("div",{style:D.modalHeaderDescription,children:l.formatMessage(cc.header.description)})]}),(0,w.jsx)("div",{style:D.modalList,children:I.map(((e,t,o)=>(0,w.jsx)("div",{style:{...D.modalListItem,borderBottom:t+1===o.length?"none":D.modalListItem.borderBottom},children:(0,w.jsx)("div",{style:D.modalListItemContent,children:l.formatMessage(cc.issues[e],{title:e=>(0,w.jsx)("span",{style:{fontWeight:590},children:e}),description:e=>(0,w.jsx)("div",{style:{marginTop:4},children:e})})})},e)))}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",marginTop:24,gap:8},children:[(0,w.jsx)(te().A,{size:"lg",onClick:K,isLoading:_,disabled:_,children:(0,w.jsx)(B().sA,{id:"collectionSettings.relationSharingSwitcher.changes.applyChanges",defaultMessage:"Apply changes"})}),(0,w.jsx)(Oo().p,{onClick:F,size:"lg",isGray:!0,disabled:_,style:{justifyContent:"center"},children:(0,w.jsx)(B().sA,{id:"collectionSettings.relationSharingSwitcher.changes.cancel",defaultMessage:"Cancel"})})]})]})})]})}const cc={header:(0,B().YK)({title:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderTitle",defaultMessage:"Turn on permission sharing"},description:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderDescription",defaultMessage:"To enable permission sharing through a relation, the following changes are required."}}),issues:(0,B().YK)({limit:{id:"collectionSettings.relationSharingSwitcher.changes.setLimitToOne",defaultMessage:"<title>Limit to one page</title><description>Permissions can only be inherited from one related page. For existing pages that have more than one related page, only the first page will be kept.</description>"},twoWayRelation:{id:"collectionSettings.relationSharingSwitcher.changes.removeTwoWayRelation",defaultMessage:"<title>Remove the two-way relation</title><description>Only one-way relations are supported at this time.</description>"}}),disabledReasons:(0,B().YK)({hasAnotherSharingEnabledProperty:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.hasAnotherSharingEnabledProperty",defaultMessage:"Sharing is already enabled through another relation."},isSelfRelation:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.isSelfRelation",defaultMessage:"Can't change share settings for a self-relation."}})};var dc=()=>o(584262),uc=()=>o(296798),pc=()=>o(492414);function gc(e){const{isSelfRelation:t,collectionStore:o,showAs:n,disabled:a,onClick:l}=e,s=(0,r().K8)((()=>Boolean(o)),[o]),c=(0,r().K8)((()=>null==o?void 0:o.getIcon()),[o]),d=(0,r().K8)((()=>{if(t)return;const e=null==o?void 0:o.getParentBlockStore();return e&&(0,pc().Ay)({store:e,pageVisitSource:dc().y8.LinkInPage})}),[o,t]),u=(0,i().Y0)(),p=(0,S().IS)((e=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:e.regularTextColor,fontWeight:R().Wy.semibold,fontSize:14,marginLeft:4*(u.isRetina?.5:1),wordBreak:"break-word",...R().RC},chevronTitle:{display:"inline",wordBreak:"break-word",...R().RC}})),[u]),g=(0,r().K8)((()=>Tn().A.state.isOpen&&"layout-editor"===Tn().A.state.mode),[]),m=(0,w.jsx)(vn().A,{icon:c,isEmptyPage:!1,size:20,disabled:!0});return(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===n,onClick:l,disabled:a,right:t?(0,w.jsx)(B().sA,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===n&&d?(0,w.jsxs)(uc().A,{external:g,href:d,innerStyle:p.linkBox,children:[m,(0,w.jsx)(Da().A,{store:o,underline:!0,style:p.linkTitle,maxLength:15})]}):s?(0,w.jsxs)(w.Fragment,{children:[m,(0,w.jsx)(Da().A,{store:o,style:p.chevronTitle})]}):(0,w.jsx)(B().sA,{defaultMessage:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}})}function mc(e){const{collectionContextStore:t,property:o}=e,n=(0,i().v3)(),a=(0,r().K8)((()=>t.collectionStore()),[t]),l=(0,r().K8)((()=>ht().Jq(t,o)),[t,o]),c=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,ot().k7)(e,l)}),[t,l]),d=Boolean(c&&(null==a?void 0:a.id)===c.id),u=(0,r().K8)((()=>{var e;return(0,Ls().Sf)({experimentService:s().default,actor:{table:ql().oo,id:n.currentUser.id??""},spaceId:(null===(e=fn().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??""})}),[n.currentUser]),p=l&&(0,mo().UU)(l)?l.connectedRelation:void 0,{isConnectedRelationDatabaseActionsSupported:g,connectedRelationPatternName:m,integrationId:f}=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o],n=null==e?void 0:e.name,i=(0,El().Dz)(e);return{isConnectedRelationDatabaseActionsSupported:(0,El().Mn)(i)&&s().default.checkGate({gateName:"connected_relations_database_actions_enabled"}),connectedRelationPatternName:n,integrationId:i}}),[t,o]);if(!c)return null;const y=l&&!(0,El().H6)(l)&&!(0,El().KF)(l)&&!(0,El().V5)(l);return(0,w.jsxs)(w.Fragment,{children:[y&&(0,w.jsx)(gc,{isSelfRelation:d,collectionStore:c,showAs:"link",disabled:!0}),g&&m&&f&&(0,w.jsx)(Hs,{collectionContextStore:t,property:o,connectedRelationPatternName:m,integrationId:f,propertySchema:l,environment:n}),y&&(0,w.jsx)(Vs,{collectionContextStore:t,propertySchema:l,property:o}),!Boolean(p)&&(0,w.jsx)(ec,{collectionContextStore:t,property:o,targetCollectionStore:c}),u&&l&&(0,mo().nC)(l)&&(0,w.jsx)(sc,{collectionContextStore:t,property:o,propertySchema:l})]})}var fc=()=>o(596359),yc=()=>o(831194),Sc=()=>o(439264),hc=()=>o(255824),vc=()=>o(823882);function xc(e){var t;const o=(0,i().v3)(),a=(0,S().DP)(),{isMobile:l}=(0,i().Y0)(),{property:s,option:c,statusGroup:d,propertySchema:u,isDefault:g,disabled:m}=e,f=(0,mt().ET)(),y=(0,r().K8)((()=>{var e;return null===(e=f.collectionStore())||void 0===e?void 0:e.id}),[f]),h=(0,r().uB)(void 0,vt().A),v=(0,r().K8)((()=>h.state.open),[h]),x=(0,n.useCallback)((()=>{h.setState({open:!0})}),[h]),C=(0,n.useCallback)((()=>{h.setState({open:!1})}),[h]),b=(0,n.useCallback)((e=>{const t=f.collectionStore();t&&(0,ts().p)({environment:o,collectionStore:t,performTransaction:o=>{for(const n of e)p().applyOperation({store:(0,Y().Oo)(t,n.pointer),operation:n,transaction:o})}})}),[f,o]),j=(0,S().IS)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return y?(0,w.jsx)(vc().h,{open:v,origin:(0,w.jsx)(ao().A,{renderTooltip:e=>(0,w.jsxs)("div",{...e,style:zo().Q$,children:[(0,w.jsx)("div",{children:c.value}),(0,w.jsx)("div",{style:{color:a.text.contrastSecondary},children:c.description})]}),placement:so().W.Left,disableTooltip:!(null!==(t=c.description)&&void 0!==t&&t.length),render:e=>{var t,o;return(0,w.jsx)(D().A,{...e,showDragHandle:!l,showChevron:!0,disabled:m,rotateChevron:v,title:"status"===u.type?(0,w.jsx)(ml().q,{format:l?rl().NY.Large:rl().NY.Medium,value:c.value,color:c.color,hideTooltip:!(null===(t=c.description)||void 0===t||!t.length),tooltipPlacement:so().W.Left,showRemoveButton:!1,isSingle:!0,groupColor:null==d?void 0:d.color}):(0,w.jsx)(ml().O,{format:l?rl().NY.Large:rl().NY.Medium,value:c.value,color:c.color,hideTooltip:!(null===(o=c.description)||void 0===o||!o.length),tooltipPlacement:so().W.Left,showRemoveButton:!1,isSingle:!0}),right:g?(0,w.jsx)("span",{style:j.defaultText,children:(0,w.jsx)(B().sA,{id:"database.statusProperty.default",defaultMessage:"Default"})}):void 0,onClick:x})}}),option:c,property:s,propertySchema:u,statusGroup:d,collectionId:y,analyticsFrom:"view_settings",alignmentToOrigin:so().C.End,onChange:b,onClose:C}):null}const Cc=ui().default.createClass(void 0,{name:"InputGroupIndexStore"});const bc=function(e){let{collectionContextStore:t,property:o,disabled:a,aIAutofillOption:l}=e;const s=(0,i().v3)(),c=(0,r().uB)(void 0,Cc),[d,u]=(0,n.useState)({inputValue:"",focus:!1}),g=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),m=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().app_config_uri}),[t]),f=(0,r().K8)((()=>jc(t,o)),[t,o]),y=(0,r().O$)(c);if(!g||!f)return null;if("status"===f.type){const e=f.groups??[];if(0===e.length)return null;const n=f.options??[],i=e.map((e=>{const t=n.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}})),r=f.defaultOption,l=[...i[0].groupOptions.map((e=>e.value))];for(const{group:t,groupOptions:o}of i.slice(1))l.push({key:`group-header-${t.name}`,draggable:!1}),l.push(...o.map((e=>e.value)));const p=(0,le().s6)(m,g,o)?{tooltipCaption:(0,w.jsx)(B().sA,{defaultMessage:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,S=(l,s)=>{if(l.startsWith("group-header-")){const e=l.substring(13),n=i.findIndex((t=>{let{group:o}=t;return o.name===e})),{group:r,groupOptions:s}=i[n];return(0,w.jsxs)(wc,{title:(0,w.jsx)(yc().RS,{disableGroup:p,group:r,showIcon:!1}),right:!d.focus&&(0,w.jsx)(Ac,{collectionContextStore:t,property:o,onClick:e=>(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>Mc(u,c,n)})}),disabled:a,children:[y===n&&(0,w.jsx)(kc,{collectionContextStore:t,property:o,input:d,setInput:u,inputGroupIndexStore:c}),!d.focus&&0===s.length&&(0,w.jsx)(Ic,{setInput:u,inputGroupIndexStore:c,groupIndex:n})]})}{const t=n.find((e=>e.value===l));if(!t)return null;const i=e.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,w.jsx)(xc,{option:t,statusGroup:i,propertySchema:f,property:o,isDefault:t.value===r,disabled:a},t.value)}};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(wc,{title:(0,w.jsx)(yc().RS,{disableGroup:p,group:i[0].group}),right:!d.focus&&(0,w.jsx)(Ac,{collectionContextStore:t,property:o,onClick:e=>(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>Mc(u,c,0)})}),disabled:a,children:[0===y&&(0,w.jsx)(kc,{collectionContextStore:t,property:o,input:d,setInput:u,inputGroupIndexStore:c}),!d.focus&&0===i[0].groupOptions.length&&(0,w.jsx)(Ic,{setInput:u,inputGroupIndexStore:c,groupIndex:0})]}),(0,w.jsx)(Sc().Ay,{direction:"vertical",keys:l,renderKey:S,onDrop:e=>_c(e,s,o,t),disabled:a})]})}{const e=f.options??[],n=e.map((e=>e.value)),i=f.auto_sort_options||"manual";return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(xt().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:i,options:[{key:"manual",type:"button",title:(0,w.jsx)(B().sA,{defaultMessage:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",type:"button",title:(0,w.jsx)(B().sA,{defaultMessage:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",type:"button",title:(0,w.jsx)(B().sA,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:e=>function(e,t,o,n){const i=o.collectionStore(),r=o.normalizedSchemaStore.state,a=jc(o,n);if(!i||!a)return;if(!(0,mo().lx)(a))return;const l=[{pointer:i.pointer,command:"update",path:["schema",n],args:{auto_sort_options:e}}];"alphabetical"!==e&&"reverse_alphabetical"!==e||l.push(...(0,ut().d4)({collectionId:i.id,property:n,propertySchema:a,schema:r,isAscending:"alphabetical"===e})||[]);(0,ts().p)({environment:t,collectionStore:i,performTransaction:e=>{for(const t of l)p().applyOperation({store:(0,Y().Oo)(i,t.pointer),operation:t,transaction:e})}}),(0,tl().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"select_change_auto_sort_options"})}(e,s,t,o),popupStyle:{minWidth:190}},"autoSortMenuItem"),l,(0,w.jsx)(wc,{title:(0,w.jsx)(B().sA,{defaultMessage:"Options",id:"database.viewSettings.selectOptions.title"}),right:!d.focus&&n.length>0&&(0,w.jsx)(Ac,{collectionContextStore:t,property:o,onClick:e=>(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>Mc(u,c)})}),disabled:a,children:(0,w.jsx)(kc,{collectionContextStore:t,property:o,input:d,setInput:u,inputGroupIndexStore:c})},"sectionHeader"),n.length>0&&(0,w.jsx)(Sc().Ay,{direction:"vertical",keys:n,renderKey:t=>{const n=e.find((e=>e.value===t));return n?(0,w.jsx)(xc,{option:n,property:o,propertySchema:f,isDefault:!1,statusGroup:void 0,disabled:a},n.value):null},onDrop:e=>_c(e,s,o,t)}),!d.focus&&0===n.length&&(0,w.jsx)(Ic,{setInput:u,inputGroupIndexStore:c})]})}};function wc(e){let{title:t,right:o,children:n,disabled:i,overrideStyle:r}=e;return(0,w.jsx)(oe().A,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!i&&o,style:{width:"100%",paddingBottom:0,...r},children:!i&&n})}function jc(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&((0,mo().lx)(o)||"status"===o.type))return o}function Ac(e){let{onClick:t,collectionContextStore:o,property:n}=e;const i=(0,B().tz)();return(0,r().K8)((()=>jc(o,n)),[o,n])?(0,w.jsx)(Er().A,{icon:io().W,onClick:t,style:{width:20,height:20},ariaLabel:i.formatMessage({defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.addOption"})}):null}function _c(e,t,o,n){const i=n.normalizedSchemaStore.state,r=n.collectionStore();r&&(fc().gc({newValues:e,property:o,schema:i,collectionStore:r,environment:t}),(0,tl().V)({environment:t,collectionContextStore:n,property:o,from:"view_settings",action:"select_options_reorder"}))}function Mc(e,t,o){e({focus:!0,inputValue:""}),void 0!==o&&t.setState(o)}function kc(e){let{collectionContextStore:t,property:o,input:r,setInput:a,inputGroupIndexStore:l}=e;const s=(0,i().v3)(),c=(0,B().tz)(),d=(0,n.useCallback)((()=>function(e,t,o,n,i,r){const a=t.collectionStore(),l=jc(t,o);if(!l||!a)return;const s=l.options||[],c=n.inputValue.trim();if(c)if("status"===l.type){const t=r.state;let n;if(void 0!==t&&(n=s.find((e=>{var o;return null===(o=l.groups)||void 0===o||null===(o=o[t].optionIds)||void 0===o?void 0:o.includes(e.id)}))),void 0===t||void 0!==n)fc().Uk({modification:{type:"keyedObjectListBefore",beforeOption:n,newValue:c},property:o,propertySchema:l,options:s,environment:e,collectionStore:a,groupIndex:t});else{let n;for(let e=t-1;e>=0;e--){var d;const t=null===(d=l.groups)||void 0===d?void 0:d[e];if(t&&(n=s.find((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})),void 0!==n))break}fc().Uk({modification:{type:"keyedObjectListAfter",afterOption:n,newValue:c},property:o,propertySchema:l,options:s,environment:e,collectionStore:a,groupIndex:t})}}else!(0,mo().lx)(l)||"alphabetical"!==l.auto_sort_options&&"reverse_alphabetical"!==l.auto_sort_options?fc().Uk({modification:{type:"keyedObjectListBefore",newValue:c},property:o,propertySchema:l,options:s,environment:e,collectionStore:a}):fc().Uk({modification:{type:"autoSortInsert",newValue:c},property:o,propertySchema:l,options:s,environment:e,collectionStore:a});i({focus:!0,inputValue:""}),(0,tl().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:"select_add_option",option_value_char_count:c.length})}(s,t,o,r,a,l)),[s,t,o,r,a,l]),u=(0,n.useCallback)((e=>function(e,t){t({focus:!0,inputValue:e.target.value.replace(/,/g,"")})}(e,a)),[a]),p=(0,n.useCallback)((()=>function(e,t,o){o({focus:!1,inputValue:e.device.isPhone?t.inputValue:""})}(s,r,a)),[s,r,a]),g=(0,hc().g)(),m=(0,S().IS)((e=>({inputOuterStyle:g?{backgroundColor:e.white}:{},inputMenuItem:{marginTop:2,marginBottom:8}})),[g]);return r.focus?(0,w.jsx)(f().A,{debugName:"CollectionSettingsSelectOptions",capture:!0,onEsc:p,children:(0,w.jsx)(xo().Ay,{value:r.inputValue,focus:!0,placeholder:c.formatMessage({defaultMessage:"Type a new option",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:m.inputMenuItem,inputOuterStyle:m.inputOuterStyle,onChange:u,onBlur:p,onSubmit:d,mobileKeyboardOnDismiss:d})}):null}function Ic(e){let{groupIndex:t,setInput:o,inputGroupIndexStore:n}=e;return(0,w.jsx)($().A,{icon:(0,io().W)({width:14}),focused:!1,title:(0,w.jsx)(B().sA,{defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:e=>(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>Mc(o,n,t)})})}var Tc=()=>o(263178),Pc=()=>o(974967);const Bc=(0,B().YK)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",defaultMessage:"Show as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",defaultMessage:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.select",defaultMessage:"Select"}});function Rc(e){let{collectionContextStore:t,property:o,disabled:n}=e;const a=(0,i().v3)(),l=(0,S().IS)((e=>({icon:{width:16,height:16,fill:e.mediumIconColor}})),[]),[s,c]=(0,r().K8)((()=>{var e;return[Vc(t,o),(null===(e=t.getPropertyFormat(o))||void 0===e?void 0:e.statusShowAs)??"select"]}),[t,o]);if(!s)return null;const d=[{key:"checkbox",type:"button",title:bo().A.formatMessage(Bc.statusCheckboxLabel),icon:(0,Tc().S)(l.icon)},{key:"select",type:"button",title:bo().A.formatMessage(Bc.statusSelectLabel),icon:(0,Pc().n)(l.icon)}];return(0,w.jsx)(xt().A,{title:bo().A.formatMessage(Bc.statusShowAsLabel),selectedKey:c,popupStyle:{minWidth:190},options:d,onChange:e=>function(e,t,o,n){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;p().createAndCommit({userAction:"CollectionSettingsStatusOptions.handleShowAsChange",environment:t,canUndo:!0,perform:t=>{st().a5({formatStore:i,formatKey:r,property:n,update:{statusShowAs:e,visible:!0},transaction:t})}}),(0,tl().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"status_change_format"})}(e,a,t,o),disabled:n})}function Vc(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&"status"===o.type)return o}function Fc(e){let{collectionContextStore:t,property:o,propertySchema:n}=e;const r=(0,i().v3)();return(0,w.jsx)(yl().A,{title:(0,w.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,w.jsx)(B().sA,{defaultMessage:"Show full URL",id:"database.viewSettings.propertyTab.toggleShowFullUrl"})}),showChevron:!1,switcherProps:{on:Boolean(n.show_full_url),noColor:!1},onClick:()=>function(e,t,o,n){const i=t.collectionStore();if(!n||!i||"url"!==n.type)return;const r=!Boolean(n.show_full_url);p().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:e,canUndo:!0,perform:t=>{(0,ul().F)({environment:e,collectionStore:i,update:{[o]:{...n,show_full_url:r}},transaction:t})}}),(0,tl().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:r?"url_toggle_show_full_on":"url_toggle_show_full_off"})}(r,t,o,n)})}const Kc=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:a,formatKey:l,property:s,selectNameInitial:c,titleOverride:d}=e,[u,g]=(0,n.useState)(!1),[m,f]=(0,n.useState)(""),y=(0,i().v3)(),h=(0,n.useRef)(null),v=(0,B().tz)(),x=(0,S().DP)(),{collectionStore:C,isMultiSourceView:b}=(0,r().K8)((()=>({collectionStore:t.collectionStore(),isMultiSourceView:"collectionTypedView"===t.contextType})),[t]),j=(0,r().K8)((()=>t.normalizedSchemaStore.state),[t.normalizedSchemaStore]),{isTypedProperty:A,databaseType:_}=(0,r().K8)((()=>C?{isTypedProperty:C.isTypedProperty(s),databaseType:C.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[C,s]),M=(0,r().K8)((()=>(0,El()._g)({schema:j,property:s})),[s,j]),k=(0,r().K8)((()=>zc({property:s,formatKey:l,collectionContextStore:t})),[t,l,s]),I=(0,r().K8)((()=>(0,Gn().fE)({property:s,collectionContextStore:t,newValue:m})),[t,m,s]),T=(0,r().K8)((()=>{var e;const n=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!n&&(0,o(696746).Nh)(n)}),[t]),P=(0,r().K8)((()=>Boolean(C&&_&&le().jP((0,Xl().appConfigs)(),_,s,C))),[C,_,s]),R=(0,r().K8)((()=>{var e;const o=t.collectionViewStore();return!!o&&(Boolean((null===(e=zc({property:s,formatKey:l,collectionContextStore:t}))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())}),[t,l,s]),V=(0,r().uB)(void 0,vt().A),F=(0,r().K8)((()=>Tn().A.state.isOpen),[]);(0,n.useEffect)((()=>{!function(e,t,n){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const r=o(344482).A.findTableHeaderCell(t,e);if(!r)return;const a=r.getNode();if(!a||!n)return;const l=(0,o(953418).T8)(a);if(!l)return;const s=n.getBoundingClientRect(),c=a.getBoundingClientRect().right+20-s.left;l.scrollLeft=l.scrollLeft+c}(s,t,h.current),M&&f(M.name||"")}),[t,s,M]);const D=(0,n.useCallback)((e=>{(0,ot().Fc)({collectionContextStore:t,environment:y,inputValue:m,name:e,property:s})}),[t,y,m,s]),L=(0,n.useCallback)((e=>{g(!u),e.stopPropagation()}),[u]),O=(0,n.useCallback)((e=>{!function(e){var t;const{description:o,environment:n,collectionContextStore:i,property:r}=e,a=i.collectionStore(),l=null==a||null===(t=a.getSchema())||void 0===t?void 0:t[r];if(!a||void 0===l||o===l.description)return;p().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:n,canUndo:!0,perform:e=>{(0,ul().F)({environment:n,collectionStore:a,update:{[r]:{...l,description:o}},transaction:e})}}),(0,tl().V)({environment:n,collectionContextStore:i,property:r,from:"view_properties",action:"set_description"})}({collectionContextStore:t,description:e,environment:y,property:s})}),[t,y,s]),E=(0,n.useCallback)((e=>{f(e)}),[]);if(!M)return null;const z=!(0,El().di)(M),N=b,U=b||(0,El().Jf)({property:s,propertySchema:M,isTypedProperty:A}),H=M.description;return(0,w.jsxs)(K().Ay,{...e,title:d||(C?(0,w.jsx)(B().sA,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,w.jsx)(B().sA,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"})),footer:(0,w.jsx)(sd,{collectionContextStore:t,formatKey:l,property:s,collectionSettingsStore:a,wrapProperty:R,propertySchema:M,propertyFormat:k,isRequiredTypedProperty:P,databaseType:_}),ref:h,children:[(0,w.jsxs)(oe().A,{isInput:!0,style:F?{margin:"0 2px"}:void 0,children:[(0,w.jsx)(Pn().B,{disabled:N,initialValue:M.name||"",placeholder:bo().A.formatMessage(Ds().A.inputPlaceholder),onBlur:D,onSubmit:D,focusInitial:c,selectAll:c,iconButton:{icon:e=>(0,w.jsx)(fo().Ay,{type:M.type,icon:M.icon,size:16,theme:x,style:e}),iconStyle:{fill:_n().l8[x.mode].gray},...F?{backgroundColor:x.white}:void 0,enforceIconColor:"gray",onSubmit:e=>function(e,t,o,n){const i=o.collectionStore();if(!i)return;p().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyIconSubmit",environment:e,canUndo:!0,perform:e=>{st().yC({collectionStore:i,property:t,icon:n,transaction:e})}}),(0,tl().V)({environment:e,collectionContextStore:o,property:t,icon:n,from:"view_settings",action:"change_icon"})}(y,s,t,e)},inputOuterStyle:F?{backgroundColor:x.white}:void 0,inputRightButton:T?null:(0,w.jsx)(o(539148).S,{description:H,showTooltip:!u,onClick:L,addDescriptionText:v.formatMessage(zo().Mo.addPropertyDescriptionTooltip),editDescriptionText:v.formatMessage(zo().Mo.editPropertyDescriptionTooltip)}),onChange:E}),I&&(0,w.jsx)(o(653259).A,{propertyName:m})]}),u&&(0,w.jsx)(o(705602).y,{initialDescription:H,handleSaveDescription:O}),(0,w.jsxs)(oe().A,{children:[z&&(0,w.jsx)($l().Dy,{disabled:U,isTypedProperty:A,collectionUri:_,collectionContextStore:t,formatKey:l,propertyTypeButtonPopupStore:V,property:s}),"button"===M.type&&(0,w.jsx)($l().w$,{collectionSettingsStore:a,collectionContextStore:t,property:s}),b?(0,w.jsxs)(w.Fragment,{children:["status"===M.type&&(0,w.jsx)(Uc,{collectionSettingsStore:a,collectionContextStore:t,property:s}),("date"===M.type||"created_time"===M.type||"last_edited_time"===M.type)&&(0,w.jsx)(Wc,{collectionContextStore:t,property:s})]}):(0,w.jsx)(cd,{collectionContextStore:t,property:s,propertySchema:M})]}),F&&(0,w.jsx)(ys,{})]})}));function Dc(e,t,o,n){const i=zc({property:n,formatKey:o,collectionContextStore:t}),r=t.collectionViewStore(),a=t.normalizedFormatStore.state,l=(0,ot().Jq)({collectionContextStore:t,property:n});if(!l)return;if(!(i&&r&&o&&l))return;const s=Oc({formatKey:o,collectionContextStore:t}).map((e=>e.property===i.property?{...i,visible:!i.visible}:e)),c={...a,[o]:s};p().createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,canUndo:!0,perform:a=>{(0,Mn().F)({collectionViewStore:r,update:{format:c},transaction:a});const l=Nc({property:n,formatKey:o,collectionContextStore:t});Yt().sp({environment:e,collectionContextStore:t,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:a,propertyAction:i.visible?"hide":"show"})}}),(0,qt().X)({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:l.type})}async function Lc(e,t,o,n,i,r){await Jl().q({environment:e,collectionContextStore:o,property:n,handleDeleteAccept:()=>function(e,t,o,n,i){const r=o.normalizedSchemaStore.state,a=o.collectionStore(),l=(0,El()._g)({schema:r,property:t});l&&(a&&p().createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async n=>{await st().PF({environment:e,collectionStore:a,schema:r,property:t,transaction:n});const l=Nc({property:t,formatKey:i,collectionContextStore:o});Yt().sp({environment:e,collectionContextStore:o,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"delete"})}}),d().yl({collectionSettingsStore:n}),(0,qt().X)({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==l?void 0:l.type}),(0,Zl().i)({environment:e,collectionContextStore:o,property_type:l.type,from:"view_settings",property:t}))}(e,n,o,i,r),theme:t,from:"view_settings"})}function Oc(e){const{formatKey:t,collectionContextStore:o}=e;if(!t)return[];var n;if("collection_page_properties"===t)return(null===(n=o.collectionStore())||void 0===n?void 0:n.getFormat().collection_page_properties)??[];return o.normalizedFormatStore.state[t]||[]}function Ec(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function zc(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Oc({formatKey:o,collectionContextStore:t});return null==i?void 0:i.find((e=>e.property===n))}function Nc(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Oc({formatKey:o,collectionContextStore:t});if(0===i.length)return-1;return i.filter((e=>e.visible)).findIndex((e=>e.property===n))}function Uc(e){let{collectionSettingsStore:t,collectionContextStore:o,property:n}=e;const i=(0,r().K8)((()=>{var e;return le().s6(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,n)}),[o,n]);return(0,w.jsxs)(w.Fragment,{children:[i?null:(0,w.jsx)(Rc,{collectionContextStore:o,property:n,disabled:i}),(0,w.jsx)(bc,{collectionSettingsStore:t,collectionContextStore:o,property:n,disabled:i,aIAutofillOption:null})]})}function Hc(e){let{collectionContextStore:t,collectionSettingsStore:o,property:n}=e;return(0,w.jsx)(Ps,{collectionContextStore:t,collectionSettingsStore:o,property:n})}function Wc(e){let{collectionContextStore:t,property:o}=e;return(0,w.jsx)(As,{collectionContextStore:t,property:o})}function Gc(e){let{collectionContextStore:t,property:o}=e;return(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,El().di)(e)}),[t,o])?(0,w.jsx)(Ol,{collectionContextStore:t,property:o}):(0,w.jsx)(mc,{collectionContextStore:t,property:o})}function qc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&("number"===n.type||"formula"===n.type||"rollup"===n.type)?(0,w.jsx)(Ks().$,{collectionContextStore:t,property:o}):null}function Yc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>t.collectionStore()),[t]);return n&&"url"===n.type&&i?(0,w.jsx)(Fc,{collectionContextStore:t,property:o,propertySchema:n}):null}function $c(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"person"===n.type?(0,w.jsx)(Is,{collectionContextStore:t,propertySchema:n,property:o}):null}function Qc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"button"===n.type?(0,w.jsx)($l().m4,{collectionContextStore:t,propertySchema:n,propertyId:o}):null}function Zc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]);return n?(0,w.jsx)(Vs,{collectionContextStore:t,propertySchema:n,property:o}):null}function Jc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return n&&"auto_increment_id"===n.type?(0,w.jsx)(nl,{uniqueIdProperty:{propertyId:o,propertySchema:n},prefixValue:i,collectionContextStore:t}):null}function Xc(e){let{collectionContextStore:t,property:o}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Zc,{collectionContextStore:t,property:o}),(0,w.jsx)($c,{collectionContextStore:t,property:o})]})}function ed(e){const{environment:t,property:o,propertySchema:i,collectionSettingsStore:a,collectionContextStore:l,collectionStore:s}=e,c=(0,r().K8)((()=>(0,mo().om)(i)),[i]),u=(0,r().K8)((()=>(0,ds().jq)(t,Cs().A.getMode(t,s),s)),[t,s]),g=(0,n.useMemo)((()=>{const e=i.name.trim(),t=Gn().dC[i.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[i.name,i.type]),m=(0,n.useCallback)((()=>{if(!s||!i||!(0,mo().lx)(i))return;const e=(0,mo().RM)(i);if(!e)return;const n=[];if(c)Ql().Nj(t,{type:"remove_ai_inference",ai_inference_type:c.type,collection_id:s.id}),n.push({pointer:s.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:i.type,auto_update_on_edit:!1,add_options:!1};Ql().Nj(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:s.id}),n.push({pointer:s.pointer,command:"set",path:["schema",o,e],args:r})}(0,ts().p)({environment:t,collectionStore:s,performTransaction:e=>{for(const t of n)p().applyOperation({store:(0,Y().Oo)(s,t.pointer),operation:t,transaction:e})}})}),[c,s,t,o,i]),f=(0,n.useCallback)((e=>{if(!i||!s||!(0,mo().$M)(i))return;const n=(0,mo().RM)(i);if(!n)return;const r={pointer:s.pointer,command:"set",path:["schema",o,n],args:e};(0,ts().p)({environment:t,collectionStore:s,performTransaction:e=>{p().applyOperation({store:(0,Y().Oo)(s,r.pointer),operation:r,transaction:e})}})}),[s,t,o,i]),y=(0,r().K8)((()=>Ec(l)),[l]);return(0,r().K8)((()=>u&&"form_editor"!==y),[u,y])?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(wc,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,w.jsx)(ao().A,{disableTooltip:!g,placement:so().W.Left,renderTooltip:e=>(0,w.jsx)(B().sA,{...e,defaultMessage:"Update the property name to use AI autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,w.jsx)(yl().A,{...e,title:(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,w.jsx)(B().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,w.jsx)(ls().A,{style:{display:"inline-block"}})]}),showChevron:!1,switcherProps:{on:Boolean(c),noColor:!1},onClick:m,disabled:!u||g}),style:{whiteSpace:"break-spaces"}}),c&&!g&&("select"===c.type||"multi_select"===c.type)&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(rs,{setAiInference:f,aiInference:c,disabled:!u}),(0,w.jsx)(D().A,{title:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:an().Ay.uiGray},children:[(0,w.jsx)(B().sA,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,Ul().V)({fill:an().Ay.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{d().a2({collectionSettingsStore:a,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}})]})]}):null}function td(e){const{environment:t,property:o,propertySchema:n,collectionContextStore:i,collectionStore:a}=e,l=(0,r().K8)((()=>{var e;const t=(null===(e=bs().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Yl().GI)(t)}),[]),s=(0,r().K8)((()=>{const e=i.collectionStore();return e&&(0,ds().jq)(t,Cs().A.getMode(t,e),e)}),[t,i]);return(0,r().K8)((()=>(0,mo().lx)(n)&&n.select_ai_inference),[n])?(0,w.jsx)(ns().Ve,{environment:t,collectionContextStore:i,collectionStore:a,property:o,propertySchema:n,doesUserHaveAIAddOn:l,isAutofillSetupEnabled:Boolean(s)}):null}function od(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:n,property:a}=e;const l=(0,i().v3)(),s=(0,r().K8)((()=>n.collectionStore()),[n]);return s?(0,w.jsx)(bc,{collectionSettingsStore:o,collectionContextStore:n,property:a,disabled:!1,aIAutofillOption:(0,w.jsx)(ed,{environment:l,collectionStore:s,collectionSettingsStore:o,collectionContextStore:n,property:a,propertySchema:t})}):null}function nd(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().O$)(t.normalizedSchemaStore)[o];let i;return i=(0,El().di)(n)?(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.githubRelation"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.relations"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,w.jsx)(oe().A,{topBorder:!0,children:i})}function id(e){let{collectionContextStore:t,property:o,collectionSettingsStore:n}=e;const i=(0,r().K8)((()=>(0,ot().Jq)({collectionContextStore:t,property:o})),[t,o]),a=(0,r().K8)((()=>Ec(t)),[t]);if(!i||"text"!==i.type||"form_editor"===a)return null;const l=(0,mo().om)(i);let s;return l&&(0,mo().UH)(l.type)?"summarize"===l.type?s=cs().VT.autofillSummary:"extract"===l.type?s=cs().VT.autofillExtract:"custom"===l.type?s=cs().VT.autofillCustom:"translate"===l.type?s=cs().VT.autofillTranslate:(0,W().HB)(l):s=Ds().A.autofillOffLabel,(0,w.jsx)(D().A,{title:(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,w.jsx)(B().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,w.jsx)(ls().A,{style:{display:"inline-block"}})]}),showChevron:!0,right:bo().A.formatMessage(s),onClick:()=>function(e,t,o){const n=(0,ot().Jq)({collectionContextStore:t,property:o});t.collectionStore()&&n&&d().a2({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}(n,t,o)})}function rd(e){let{property:t,collectionContextStore:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>o.collectionStore()),[o]),l=(0,r().K8)((()=>(0,Gn().Kc)(o)),[o]),s=(0,r().K8)((()=>Boolean((null==a?void 0:a.getDatabaseType())&&(null==a?void 0:a.isTypedProperty(t)))),[a,t]);return a?(0,w.jsx)(ss().A,{disabled:s,context:ss().C.ViewSettings,property:t,schema:l,analyticsFrom:"view_settings",parentStore:a,onChange:e=>function(e,t,o,n){const i=n.collectionStore();i&&p().createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,canUndo:!0,perform:n=>{(0,ul().F)({environment:t,collectionStore:i,update:{[o]:e.propertySchema},transaction:n})}})}(e,n,t,o)}):null}function ad(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:n,property:r,collectionSettingsStore:a,formatKey:l}=e;const s=(0,S().DP)(),c=(0,i().v3)();return(0,w.jsx)(ao().A,{disableTooltip:!t,placement:so().W.Left,renderTooltip:e=>(0,dt().eF)(o,e),render:e=>(0,w.jsx)(D().A,{...e,isRed:!0,disabled:t,onClick:()=>Lc(c,s,n,r,a,l),icon:()=>t?(0,w.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,w.jsx)(as().I,{icon:Wl().i})}):(0,w.jsx)(as().I,{icon:Gl().I}),title:(0,w.jsx)(B().sA,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:c.device.isMobile&&t?(0,dt().eF)(o):null})})}function ld(e){let{}=e;return(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.databaseProperties"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})}function sd(e){let{propertySchema:t,propertyFormat:a,isRequiredTypedProperty:l,databaseType:s,collectionContextStore:c,formatKey:g,property:m,collectionSettingsStore:f,wrapProperty:y}=e;const S=(0,i().v3)(),h=(0,fl().Tf)(),v=(0,n.useCallback)((()=>function(e,t,o,n,i){const r=zc({property:n,formatKey:o,collectionContextStore:t}),a=t.collectionViewStore(),l=t.normalizedFormatStore.state,s=(0,ot().Jq)({collectionContextStore:t,property:n});s&&r&&a&&o&&s&&(Yt().Nv({currentValue:i,environment:e,property:n,collectionViewStore:a,format:l,formatKey:o}),(0,qt().X)({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:a.getType(),property_type:s.type}))}(S,c,g,m,y)),[S,c,g,m,y]),x=(0,r().K8)((()=>c.collectionStore()),[c]),C=(0,r().K8)((()=>Ec(c)),[c]),b=(0,r().K8)((()=>Tn().A.state.isOpen),[]),j=(0,r().K8)((()=>g&&("title"!==m||(0,ut().O)({viewType:C,format:c.normalizedFormatStore.state}))&&"page"!==C),[g,m,C,c]),A=(0,r().K8)((()=>g&&(0,ut().hc)({viewType:C,property:m})),[g,m,C]),_=(0,r().K8)((()=>f.state.hideDuplicatePropertyOption),[f]),M=(0,mo().vB)(t)&&Boolean(x)&&!b&&"form_editor"!==C&&!_,k=mo().cN.includes(t.type)&&x&&!b&&"form_editor"!==C,I="form_editor"===C;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(oe().A,{topBorder:!0,disableMobilePadding:!h,children:[A&&a&&(0,w.jsx)(yl().A,{icon:Nl,title:(0,w.jsx)(B().sA,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:y,disallowTabbing:!0},onClick:v}),(j||M||k||I)&&(0,w.jsxs)(w.Fragment,{children:[x&&(0,w.jsx)(td,{environment:S,collectionStore:x,collectionContextStore:c,property:m,propertySchema:t}),j&&a&&(null!=a&&a.visible?(0,w.jsx)(D().A,{icon:o(566910).e,title:(0,w.jsx)(B().sA,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>Dc(S,c,g,m)}):(0,w.jsx)(D().A,{icon:o(89849).h,title:(0,w.jsx)(B().sA,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>Dc(S,c,g,m)})),M&&(0,w.jsx)(D().A,{icon:Hl().V,title:(0,w.jsx)(B().sA,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,n,i){const r=Oc({formatKey:i,collectionContextStore:o}),a=o.normalizedSchemaStore.state,l=o.collectionStore(),s=null==l?void 0:l.getSpaceId();if(!l||!s)return;const c=(0,El()._g)({schema:a,property:t});if(!c)return;const g=l.getNormalizedPropertyGroups(),m=await(0,ut().W4)({environment:e,schema:a,property:t,properties:r,propertyGroups:g,parentStore:l,spaceId:s});if(!m)return;const f=e.currentUser.id,y=f?{id:f,table:ql().oo}:void 0,S=o.collectionViewStore();p().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,canUndo:!0,perform:n=>{(0,W().O9)(m.automationUpdate)&&es().duplicateAutomation({actorPointer:y,environment:e,sourceAutomationStore:m.automationUpdate.sourceAutomationStore,targetAutomationId:m.automationUpdate.targetAutomationId,transaction:n});const r={...a,[m.newProperty]:m.newPropertySchema},s={...l.getFormat(),collection_page_properties:m.newProperties,property_groups:m.newPropertyGroups};(0,os().I)({environment:e,collectionStore:l,update:{schema:r,format:s},transaction:n});const c=Nc({property:t,formatKey:i,collectionContextStore:o});Yt().sp({environment:e,collectionContextStore:o,currentIndex:c,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"duplicate"}),i&&S&&u().zA({stores:[S],update:{[i]:m.newProperties},transaction:n})}}),d().os({collectionSettingsStore:n}),(0,qt().X)({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==S?void 0:S.getType(),property_type:c.type})}(S,m,c,f,g)}),k&&(0,w.jsx)(ad,{collectionContextStore:c,property:m,collectionSettingsStore:f,formatKey:g,isRequiredTypedProperty:l,databaseType:s}),I&&(0,w.jsx)(ld,{})]})]}),"formula"===t.type&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.formulas"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,w.jsx)(nd,{collectionContextStore:c,property:m}),"rollup"===t.type&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.relations"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}function cd(e){let{property:t,propertySchema:o,collectionContextStore:a}=e;const l=(0,i().v3)(),s=a.settingsStore,c=(0,r().K8)((()=>(0,ds().O0)(l)),[l]);return(0,n.useMemo)((()=>"button"===o.type),[o.type])?null:(0,w.jsxs)(w.Fragment,{children:[c&&"text"===o.type&&(0,w.jsx)(id,{collectionContextStore:a,property:t,collectionSettingsStore:s}),(0,mo().lx)(o)&&(0,w.jsx)(od,{collectionSettingsStore:s,collectionContextStore:a,property:t,propertySchema:o}),"status"===o.type&&(0,w.jsx)(Uc,{collectionSettingsStore:s,collectionContextStore:a,property:t}),"formula"===o.type&&(0,w.jsx)(Hc,{collectionContextStore:a,collectionSettingsStore:s,property:t}),"rollup"===o.type&&(0,w.jsx)(rd,{property:t,collectionContextStore:a}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,w.jsx)(Wc,{collectionContextStore:a,property:t}),"relation"===o.type&&(0,w.jsx)(Gc,{collectionContextStore:a,property:t}),"person"===o.type&&(0,w.jsx)(Xc,{collectionContextStore:a,property:t}),(0,w.jsx)(qc,{collectionContextStore:a,property:t}),(0,w.jsx)(Yc,{collectionContextStore:a,property:t}),"auto_increment_id"===o.type&&(0,w.jsx)(Jc,{collectionContextStore:a,property:t}),"button"===o.type&&(0,w.jsx)(Qc,{collectionContextStore:a,property:t})]})}var dd=()=>o(362750),ud=()=>o(612740),pd=()=>o(116089),gd=()=>o(583289),md=()=>o(495262),fd=()=>o(179070),yd=()=>o(364280),Sd=()=>o(135221),hd=()=>o(186445),vd=()=>o(71304);const xd=(0,B().YK)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function Cd(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,doesUserHaveAIAddOn:a}=e;const l=(0,n.useRef)(aa().JW()),s=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(a||null!=r&&r.auto_update_on_edit))return void fd().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,a,i,o]);return r?(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsxs)("div",{style:{width:159},children:[(0,w.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,w.jsx)(B().sA,{...xd.autoUpdateExplanationMessage})}),!a&&(0,w.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,w.jsx)(B().sA,{...xd.onlyWithAiAddOnMessage})})]}),render:e=>(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{...xd.updateOnPageEdits}),showChevron:!1,switcherProps:{inputId:l.current,on:!!r.auto_update_on_edit,noColor:!1},onClick:s,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var bd=()=>o(693954),wd=()=>o(805751);const jd=(0,B().YK)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. Key topics in bullets or People mentioned on the page",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function Ad(e){var t;let{environment:o,aiInference:i,setAiInference:a,collectionContextStore:l,isAutofillSetupEnabled:s,shouldShowUserPromptIsInvalidError:c,setShouldShowUserPromptIsInvalidError:d}=e;const u=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:jd.extractPromptSectionTitle,inputPlaceholder:jd.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:jd.customPromptSectionTitle,inputPlaceholder:jd.customPromptInputPlaceholder,value:e.prompt};default:(0,W().HB)(e)}}(i),p=(0,r().K8)((()=>(0,Gn().hn)()),[]),g=(0,n.useCallback)((e=>{if(l.collectionStore()&&u)switch(e.target.value&&e.target.value.length<=dd().oV?d(!1):e.target.value.length>dd().oV&&d(!0),u.aiInferenceType){case"extract":case"custom":a({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p});break;case"select":case"multi_select":a({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p,add_options:((null==i?void 0:i.type)===u.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,W().HB)(u.aiInferenceType)}}),[i,l,p,u,a,d]),m=(0,hc().g)(),f=(0,S().IS)((e=>({inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:c?"1px solid red":void 0,backgroundColor:m?e.white:void 0}})),[o.device.isMobile,m,c]);return u?(0,w.jsxs)(oe().A,{title:bo().A.formatMessage(u.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,w.jsx)(wd().A,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,w.jsx)(xo().Ay,{inputOuterStyle:f.inputOuterStyle,type:"text",value:u.value||"",onChange:g,placeholder:bo().A.formatMessage(u.inputPlaceholder),textarea:!0,disabled:!s,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},u.aiInferenceType)}),c&&(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,bd().Q)({width:12,height:12,fill:"#D34F43"}),(0,w.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=u.value)||void 0===t?void 0:t.length)??0)>dd().oV?(0,w.jsx)(B().sA,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,w.jsx)(B().sA,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function _d(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:l,doesUserHaveAIAddOn:s}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(oe().A,{style:{marginBottom:10},children:[(0,w.jsx)(Cd,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,doesUserHaveAIAddOn:s}),(0,w.jsx)(rs,{setAiInference:i,aiInference:n})]}),n&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Ad,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:l})})]}):null}var Md=()=>o(474587),kd=()=>o(64e3);const Id=new(vt().A),Td=(0,B().YK)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Pd(e){const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:a,setDraftAiInference:l,environment:s,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p,doesUserHaveAIAddOn:g}=e,m=(0,S().DP)(),f=(0,n.useMemo)((()=>[new(vt().A),new(vt().A)]),[]),y=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:a,theme:l,optionsButtonPopupStores:s}=e;if(!n||!(0,mo().UH)(n.type))return[];switch(n.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=Ai().oE((0,W().uv)(i).map((e=>{if(e===a)return;const t=i[e];if(t&&(0,Md().jm)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,w.jsx)(fo().Ay,{icon:t.icon,type:t.type,theme:l,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;s.length<2;)s.push(new(vt().A));return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:Td.whatToTranslate,selectAllTitle:Td.allProperties,buttonPopupStore:s[0]},{type:"single",options:Md().nP.map((e=>{let{key:t,name:o}=e;return{id:t,option:bo().A.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:Td.translateTo,buttonPopupStore:s[1]}];default:(0,W().HB)(n)}}({environment:s,aiInference:a,collectionSchema:d,setAiInference:l,property:c,theme:m,optionsButtonPopupStores:f})),[s,a,d,l,c,m,f]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(oe().A,{style:{marginBottom:10},children:[(0,w.jsx)(Bd,{propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:a,setDraftAiInference:l,environment:s}),(0,mo().bB)(a,"text")&&(0,w.jsx)(Cd,{collectionContextStore:t,environment:s,setAiInference:l,aiInference:a,doesUserHaveAIAddOn:g})]}),(0,mo().bB)(a,"text")&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Ad,{environment:s,aiInference:a,setAiInference:l,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p})}),(0,w.jsx)(Vd,{environment:s,optionProps:y})]})]})}function Bd(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:i,setDraftAiInference:a,environment:l}=e;const s=(0,r().K8)((()=>(0,Gn().hn)()),[]),c=(0,n.useCallback)((e=>{var n,i,r,l,c,d,u,p;if(!t||!(0,mo().$M)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:s};break;case"translate":g={type:e,auto_update_on_edit:s,targetProperties:(null===(n=t.ai_inference)||void 0===n?void 0:n.type)===e?null===(i=t.ai_inference)||void 0===i?void 0:i.targetProperties:["title"],toLanguage:(null===(r=t.ai_inference)||void 0===r?void 0:r.type)===e?null===(l=t.ai_inference)||void 0===l?void 0:l.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(c=t.ai_inference)||void 0===c?void 0:c.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:s};break;case"custom":g={type:e,prompt:(null===(u=t.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=t.ai_inference)||void 0===p?void 0:p.prompt:o[e]??"",auto_update_on_edit:s};break;default:(0,W().HB)(e)}a(g)}),[s,o,t,a]),d=(0,S().DP)();return t&&(0,mo().$M)(t)?(0,w.jsx)(Q().Ay,{popupType:l.device.isMobile?Q().z7.SlideUp:Q().z7.Popup,buttonPopupStore:Id,render:e=>{const t={key:"section",render:e=>(0,w.jsx)(oe().A,{...e}),items:Ai().oE(Object.keys(cs().vr.text).map((t=>{if((0,mo().UH)(t))return{key:t,render:e=>{const o=cs().vr.text[t];return(0,w.jsx)($().A,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:d.aiPurpleColor}),title:bo().A.formatMessage(o.name),checkState:(null==i?void 0:i.type)===t})},action:()=>{e.close(),c(t)}}})))};return(0,w.jsx)(J().A,{menuType:fl().gu.Popup,minWidth:260,maxWidth:"100vw",children:(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,w.jsx)($().A,{focused:!1,onClick:t,title:(0,w.jsx)(B().sA,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),right:(0,w.jsx)(Rd,{aiActionType:null==i?void 0:i.type})})}}):null}function Rd(e){let{aiActionType:t}=e;const o=(0,S().DP)(),n=t&&(0,mo().UH)(t)?cs().vr.text[t]:{name:Td.noAiAutofillSelected,svg:()=>null};return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,w.jsx)("div",{style:{color:o.lightIconColor},children:n.svg({height:16,width:16,marginRight:2})}),(0,w.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,w.jsx)(B().sA,{...n.name})}),(0,w.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,Ul().V)({height:12,width:12})})]})}function Vd(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,w.jsx)(oe().A,{title:bo().A.formatMessage(Td.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,w.jsx)(Fd,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,w.jsx)(Kd,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function Fd(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:a,selectorTitle:l,selectAllTitle:s,buttonPopupStore:c}=e;const[d,u]=(0,n.useState)(""),p=(0,S().DP)(),g=o.filter((e=>i.includes(e.id))),m=(0,r().K8)((()=>Ai().sb(Ai().Ul(o.map((e=>e.id)))).join(",")===Ai().sb(Ai().Ul(i)).join(",")),[o,i]),f=e=>{i.includes(e)?a(i.filter((t=>t!==e))):a(Ai().sb([...i,e]))},y=()=>{i.length<o.length?a(o.map((e=>e.id))):a(["title"])},h=(0,w.jsx)(oe().A,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,w.jsx)(xo().Ay,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:d,onChange:e=>{u(e.target.value)},placeholder:bo().A.formatMessage(Td.selectorSearchPlaceholder)})});return(0,w.jsx)(Q().Ay,{popupType:t.device.isMobile?Q().z7.SlideUp:Q().z7.Popup,buttonPopupStore:c,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(d.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,w.jsx)($().A,{focused:!1,onClick:e.onClick,left:(0,w.jsx)(vo().A,{checked:i.includes(t),size:14,checkSize:8,onClick:e=>{f(t)}}),icon:n,title:o}),action:()=>{f(t)}}})),n={key:"section",render:e=>(0,w.jsx)(oe().A,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,w.jsx)(oe().A,{...e}),items:[{key:"all-items",render:e=>(0,w.jsx)($().A,{focused:!1,onClick:()=>{y()},left:(0,w.jsx)(vo().A,{checked:m,size:14,checkSize:8,onClick:()=>{y()}}),title:bo().A.formatMessage(s)}),action:()=>{y()}}]};return(0,w.jsxs)(J().A,{menuType:fl().gu.Popup,minWidth:260,maxWidth:"100vw",children:[h,0===t.length?(0,w.jsx)(oe().A,{children:(0,w.jsx)(kd().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,w.jsx)(D().A,{title:bo().A.formatMessage(l),showChevron:!0,right:(0,w.jsx)("div",{style:{color:p.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:Ai().oE(g.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:c.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function Kd(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:a,buttonPopupStore:l}=e;const[s,c]=(0,n.useState)(""),d=o.find((e=>e.id===i)),u=(0,S().DP)(),p=(0,w.jsx)(oe().A,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,w.jsx)(xo().Ay,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:s,onChange:e=>{c(e.target.value)},placeholder:bo().A.formatMessage(Td.selectorSearchPlaceholder)})});return(0,w.jsx)(Q().Ay,{popupType:t.device.isMobile?Q().z7.SlideUp:Q().z7.Popup,buttonPopupStore:l,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(s.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:a}=t;return{key:o,render:e=>(0,w.jsx)($().A,{focused:!1,onClick:e.onClick,icon:a,title:n,checkState:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,w.jsx)(oe().A,{...e}),items:t};return(0,w.jsxs)(J().A,{menuType:fl().gu.Popup,minWidth:260,maxWidth:"100vw",children:[p,0===t.length?(0,w.jsx)(oe().A,{children:(0,w.jsx)(kd().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,w.jsx)(D().A,{title:bo().A.formatMessage(a),showChevron:!0,right:d&&(0,w.jsxs)(w.Fragment,{children:[d.icon,(0,w.jsx)("div",{style:{color:u.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:d.option})]}),rightStyle:{flexShrink:1},rotateChevron:l.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const Dd=(0,B().YK)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling {propertyName} with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Ld(e){const{property:t,collectionContextStore:o,collectionSettingsStore:a}=e,l=(0,r().K8)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),s=(0,r().K8)((()=>o.collectionStore()),[o]),c=(0,r().K8)((()=>o.normalizedSchemaStore.getState()),[o]),u=l&&(0,mo().$M)(l)?(0,mo().om)(l):void 0,g=(0,i().v3)(),m=(0,B().tz)(),y=Ed(),S=(0,r().K8)((()=>{const e=o.collectionStore();return e&&(0,ds().jq)(g,Cs().A.getMode(g,e),e)}),[g,o]),h=ui().default.createValue({stage:"not_started"},{name:"tryAutofillStore"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new(qr().A)({name:"CollectionSettingsPropertyAiAutofill"});g.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),a=o.getPropertyFormatKey();return r&&a&&p().createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:g,canUndo:!0,perform:e=>{st().a5({formatStore:r,formatKey:a,property:t,update:{visible:!0},transaction:e})}}),()=>{g.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,g,t]);const v=(0,n.useRef)({}),x=(0,r().K8)((()=>(0,Gn().hn)()),[]),[C,b]=(0,n.useState)(l&&fd().getDefaultAiInference(l,x)),[j,A]=(0,n.useState)(!1),_=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!l||!(0,mo().$M)(l))return;const n=(0,mo().om)(l);n&&"prompt"in n&&(v.current={...v.current,[n.type]:n.prompt}),fd().saveOrRemovePropertyAiInference({environment:g,propertySchema:l,collectionStore:e,property:t,draftAiInference:C})}),[o,l,C,t,g]),M=(0,r().K8)((()=>{const e=o.collectionStore();return e?(0,vd().tS)({environment:g,intl:m,store:e}):(0,ud().L)(m)}),[o,g,m]),k=(0,n.useCallback)((async()=>{if(l&&(0,mo().$M)(l)&&Ai().n4(C,(0,mo().om)(l)))d().os({collectionSettingsStore:a});else if(C){var e;if("prompt"in C)if((0,mo().qD)(C)&&0===(null===(e=C.prompt)||void 0===e?void 0:e.length)||(0,W().O9)(C.prompt)&&C.prompt.length>dd().oV)return void A(!0);(null==u||!u.auto_update_on_edit)&&null!=C&&C.auto_update_on_edit&&x&&l?await gd().U({sourceAction:"auto_update",propertyName:l.name,collectionName:M})&&_():_()}}),[M,a,u,C,_,x,l]),I=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&u&&l&&(fd().saveOrRemovePropertyAiInference({environment:g,propertySchema:l,collectionStore:e,property:t,draftAiInference:null}),d().yl({collectionSettingsStore:a}))}),[o,u,g,l,t,a]),T=l&&(0,mo().$M)(l)&&Ai().n4(C,(0,mo().om)(l)),P=(0,n.useCallback)((async()=>new Promise((e=>{V().ui({showCancel:!1,keepFocus:!1,message:(0,w.jsxs)(yd().VP,{alignItems:"center",gap:8,children:[(0,pd().x)(y.confirmDiscardChangesDialogIconStyle),(0,w.jsx)("div",{style:y.confirmDiscardChangesDialogMessageStyle,children:(0,w.jsx)(B().sA,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,w.jsx)(B().sA,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,w.jsx)(B().sA,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[y]),R=(0,n.useCallback)((async()=>{(T||await P())&&d().yl({collectionSettingsStore:a})}),[T,a,P]),F=(0,n.useCallback)((async()=>{(T||await P())&&d().os({collectionSettingsStore:a})}),[T,a,P]),L=(0,r().K8)((()=>{var e;const t=(null===(e=bs().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Yl().GI)(t)}),[]);return l&&(0,mo().$M)(l)&&s?(0,w.jsx)(f().A,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:F,children:(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Fill {propertyName} with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:l.name}}),handleBackArrowClick:R,handleClose:F,children:[!S&&(0,w.jsx)(oe().A,{style:y.menuItemStyle,children:(0,w.jsx)(B().sA,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===l.type&&(0,w.jsx)(Pd,{collectionContextStore:o,propertySchema:l,previousPromptByAiInferenceType:v.current,isAutofillSetupEnabled:Boolean(S),draftAiInference:C,setDraftAiInference:b,environment:g,propertyId:t,collectionSchema:c,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:A,doesUserHaveAIAddOn:L}),(0,mo().lx)(l)&&(0,w.jsx)(_d,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(S),draftAiInference:C,setDraftAiInference:b,environment:g,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:A,doesUserHaveAIAddOn:L}),(0,mo().bB)(C,l.type)&&(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(Od,{environment:g,isAutofillSetupEnabled:S,collectionContextStore:o,tryAutofillStore:h,propertySchema:l,property:t,aiInference:C}),(0,w.jsx)(te().A,{style:{...y.buttonStyle,margin:"8px 12px 12px 12px",display:T?"none":"flex"},onClick:k,disabled:!S,children:T?(0,w.jsx)(B().sA,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,w.jsx)(B().sA,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,w.jsxs)(oe().A,{topBorder:!0,title:g.device.isMobile&&bo().A.formatMessage(Dd.toggleFillWithAiSectionLabel),children:[(0,mo().bB)(u,l.type)&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(ns().Ve,{environment:g,collectionContextStore:o,collectionStore:s,property:t,propertySchema:l,doesUserHaveAIAddOn:L,isAutofillSetupEnabled:Boolean(S)}),(0,w.jsx)(D().A,{icon:Gl().I,isRed:!0,focused:!1,title:bo().A.formatMessage(Dd.removeAutofillButton),onClick:I,disabled:!S})]}),(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.aiAutofill"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function Od(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:a,propertySchema:l,property:s,aiInference:c}=e;const[d,u]=(0,n.useState)(aa().JW()),p=(0,n.useRef)(aa().JW()),g=(0,r().K8)((()=>a.state.stage),[a]),m=(0,r().K8)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:Ai().oE([(0,hd().ao)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),f=(0,n.useCallback)((()=>{var e;Ql().oe(t,{ai_inference_type:c.type,type:"undo_from_collection_settings",inference_id:d,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:p.current}),"not_started"!==g&&(md().tN({environment:t}),a.setState({stage:"not_started"}))}),[t,c,d,i,g,a]),y=(0,W().EI)(m.candidateBlockStores),S=Ed({isTryAutofillEnabled:o&&y}),h=Boolean((0,n.useContext)(fs().sf));if(t.device.isMobile||h)return null;let v;return v=y?"collection"===m.type?(0,w.jsx)(B().sA,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,w.jsx)(B().sA,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:l.name}}):(0,w.jsx)(B().sA,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,w.jsx)("div",{style:{margin:"8px 12px"},children:(0,w.jsxs)(yd().fI,{gap:8,children:[(0,w.jsx)(Oo().p,{disabled:!o||!y,style:{...S.buttonStyle,...S.undoButtonStyle,..."not_started"===g&&{display:"none"}},onClick:f,children:(0,w.jsx)(B().sA,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)("div",{children:v}),render:e=>(0,w.jsx)(Oo().p,{...e,disabled:!o||!y,style:{...S.buttonStyle,...S.tryButtonStyle},hoveredStyle:S.tryButtonHoveredStyle,pressedStyle:S.tryButtonPressedStyle,onClick:async()=>{if((0,W().EI)(m.candidateBlockStores)){const e=aa().JW();u(e),a.setState({stage:"in_progress"}),await fd().autofillPropertyForBlocks({environment:t,stores:m.candidateBlockStores,property:s,propertySchema:l,aiInferenceOverride:c,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:p.current,collectionContextStore:i,from:"ai_autofill_settings"}),a.setState({stage:"complete"})}},children:"in_progress"===g?(0,w.jsx)(Sd().A,{}):(0,w.jsxs)(w.Fragment,{children:[(0,pd().x)({width:16,..."not_started"!==g&&{display:"none"}}),"not_started"!==g?(0,w.jsx)(B().sA,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===m.type?(0,w.jsx)(B().sA,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,w.jsx)(B().sA,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})}function Ed(e){const t=(0,S().DP)();return(0,S().IS)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[75],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var zd=()=>o(151744),Nd=()=>o(663077),Ud=()=>o(716016),Hd=()=>o(455348),Wd=()=>o(668725),Gd=()=>o(386164),qd=()=>o(931075),Yd=()=>o(67103),$d=()=>o(551882),Qd=()=>o(13898),Zd=()=>o(147294),Jd=()=>o(933117),Xd=()=>o(921855),eu=()=>o(996926),tu=()=>o(470928),ou=()=>o(118849),nu=()=>o(44750),iu=()=>o(393695),ru=()=>o(759709);function au(e){const{collectionContextStore:t,onAccept:o,propertySchema:a,disableSuggestions:s,propertyGroupId:c}=e,d=(0,i().Y0)(),[g,m]=n.useState(""),f=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:a,searchInput:s,disableSuggestions:c,propertyGroupId:d}=e;const[g,m]=(0,n.useState)(!1),f=(0,B().tz)(),y=(0,i().v3)(),h=(0,r().K8)((()=>{const e=t.collectionStore();return Boolean(e&&(0,ds().jq)(y,Cs().A.getMode(y,e),e))}),[y,t]),v=(0,r().K8)((()=>{var e;if(!t)return;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,le().lS)((0,Xl().appConfigs)(),o):void 0}),[t]),x=(0,r().K8)((()=>{var e,o;if(!h)return!1;if(void 0!==v)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const n=null===(o=t.collectionStore())||void 0===o?void 0:o.getSchema();return!(n&&(0,W().uv)(n).length>mo().Hm)&&(0,ds().QV)()}),[h,v,t]),C=function(e){let{collectionContextStore:t,onAccept:o}=e;const n=(0,i().v3)(),a=(0,S().DP)(),l=(0,B().tz)(),s=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),c=(0,r().K8)((()=>(0,ds().QV)()),[]),d=(0,r().K8)((()=>{if(c){return Cu((0,Gn().lO)({environment:n,collectionContextStore:t}),s)}return[]}),[t,s,n,c]),u=(0,r().K8)((()=>Object.fromEntries(d.map((e=>[Gn().dC[e.propertyType].toLowerCase(),mu({collectionContextStore:t,propertyType:e.propertyType,propertyName:Gn().dC[e.propertyType],disablePropertyTooltip:!0,intl:l,iconFill:a.aiPurpleColor,onAccept:o,isSuggestedProperty:!0})])))),[t,l,o,a.aiPurpleColor,d]);return u}({collectionContextStore:t,onAccept:a}),b=function(e){let{environment:t,collectionContextStore:o,propertySchema:n,onAccept:i,intl:a}=e;const l=(0,r().K8)((()=>Object.fromEntries((0,Gn().xm)({collectionContextStore:o,environment:t}).map((e=>[Gn().dC[e].toLowerCase(),mu({propertyType:e,propertyName:Gn().dC[e],collectionContextStore:o,onAccept:i,intl:a,propertySchema:n,isSuggestedProperty:!1})])))),[o,a,i,n,t]);return l}({environment:y,propertySchema:o,onAccept:a,intl:f,collectionContextStore:t}),j=function(){const e=(0,i().v3)(),t=(0,mt().ET)(),o=(0,S().DP)(),n=(0,r().K8)((()=>{const n=function(e){var t;let{environment:o,collectionContextStore:n,spaceStore:i}=e;if(!(0,tu().Io)())return!1;const r=null==i?void 0:i.getModel();if(!r||!(0,qd().Xi)(r))return!1;const a=null===(t=n.collectionViewBlockStore())||void 0===t?void 0:t.isCollectionViewPageWithContent();if(a)return!1;const l=n.collectionStore();if(!l)return!1;const s=(0,et().NU)({environment:o,collectionStore:l,templateId:Wi().z$});if(s)return!1;return!0}({environment:e,collectionContextStore:t,spaceStore:fn().default.getState().currentSpaceStore}),i=(0,tu().$3)({environment:e,collectionStore:t.collectionStore()});if(!n&&!i)return{};const r=nr().globalWorkflowTemplates.fromId(Wi().z$);if(!(0,Nd().bz)(r))return{};const a=(0,tu().xE)(e),s="verification_upsell_item_collection_entrypoint",c=i?(0,w.jsx)(ou().A,{subscriptionTier:"business",analyticsName:s}):a?(0,w.jsx)(Zd().E,{style:{marginLeft:2},newBadgeKey:"verification",didUserEngage:!1}):void 0;return{[r.templateId]:pu({environment:e,template:r,collectionContextStore:t,theme:o,suggestedFeatureAnalytics:void 0,titleBadge:c,onAccept:()=>{var o,n;i?(0,Ea().K)(e,{from:s,upsell:{type:"product",product:"business",limit:{type:"none"}}}):(0,l().u4)({environment:e,event:{eventName:"page_verification_property_added",eventProperties:{space_id:null===(o=fn().default.getState().currentSpaceStore)||void 0===o?void 0:o.id,collection_id:null===(n=t.collectionStore())||void 0===n?void 0:n.id}}})},titleOverride:bo().A.formatMessage(Yd().Gl.verificationPropertyName),isUpsell:i,tooltip:(0,w.jsx)(B().sA,{...wu.verification})})}}),[t,e,o]);return n}(),A=(0,n.useMemo)((()=>({...b,...j})),[b,j]),_=function(e){let{collectionContextStore:t,propertySchema:o,propertyGroupId:a}=e;const l=(0,i().v3)(),s=(0,B().tz)(),c=(0,r().K8)((()=>co().A.bots.state),[]),d=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>(null==d?void 0:d.getSchema())??{}),[d]),p=(0,r().K8)((()=>!(null==d||!d.isPageTreeCollection())),[d]),g=(0,r().K8)((()=>t.databaseType),[t]),m=(0,r().K8)((()=>{var e;return null===(e=fn().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),f=(0,r().K8)((()=>{if(void 0===o)return(0,eu().N)(d,m)}),[d,o,m]),y=(0,r().K8)((()=>Boolean(null==d?void 0:d.isSyncedCollection())),[d]),S=(0,Xa().J)(),h=(0,hc().g)(),v=(0,n.useMemo)((()=>{if(null!=f&&f.length&&!h)return Object.fromEntries(f.map((e=>{const{isDisabled:o,propertyDisabledTooltip:n}=function(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:a,isSyncedCollection:l,schema:s,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var u;if((0,El().iY)({isAuthed:Boolean(n.find((e=>e.integration_id===d))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(d===wo().ob){if(vu(s,wo().ob))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bu.duplicateGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bu.wikiGithubPropertyTooltip)};if(l)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bu.syncedDatabaseGithubPropertyTooltip)}}else if(d===wo().io){if(vu(s,wo().io),o!==O().TC)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bu.nonMeetingsCronPropertyTooltip)};if(vu(s,wo().io))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bu.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:e,bots:c,isSpaceAdmin:S,environment:l,isWikiCollection:p,databaseType:g,isSyncedCollection:y,schema:u,intl:s,isMobile:l.device.isMobile});return[e.name.toLowerCase(),fu({connectedRelationProperty:e,isDisabled:o,propertyDisabledTooltip:n,environment:l,intl:s,collectionContextStore:t,propertyGroupId:a})]})).filter(W().O9))}),[f,h,c,S,l,p,g,y,u,s,t,a]);return v}({collectionContextStore:t,propertySchema:o,propertyGroupId:d}),[M,k]=function(e){const{collectionContextStore:t}=e,o=(0,i().v3)(),a=(0,r().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),l=(0,vi().X)("connected_relations_database_actions_enabled"),[s,c]=(0,n.useMemo)((()=>{if(!l)return[{},[]];const e={};for(const[n,i]of Object.entries(a)){if(!i||!(0,mo().UU)(i))continue;const r=i.connectedRelation.integration_id;if(!r||!(0,wo().KB)(r))continue;const a=yu({propertySchema:i,environment:o,collectionContextStore:t,propertyId:n,integrationId:r});e[r]||(e[r]={}),e[r][i.name.toLowerCase()]=a}return[e,Object.values(e).flat()]}),[a,l,o,t]);return[s,c]}({collectionContextStore:t}),I=s.length>0,T=(0,n.useCallback)((e=>e.splice(0,g?1/0:lu)),[g]),P=(0,n.useCallback)((e=>{let t;return t=I||g?e:T(e),xr().filter(s,t).filter((e=>!(I&&(A.hasOwnProperty(e.original)||null!=_&&_.hasOwnProperty(e.original)||null!=k&&k.hasOwnProperty(e.original))))).map((e=>e.original.toString()))}),[I,g,s,A,_,k,T]),R=function(e){let{collectionContextStore:t,propertySchema:o,disableSuggestions:a,hasAiEnabled:l,showAiSuggestions:s,getFilteredSuggestedItemKeys:c,onAccept:d}=e;const g=(0,i().v3)(),m=(0,S().DP)(),f=(0,B().tz)(),y=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,le().lS)((0,Xl().appConfigs)(),o):void 0}),[t]);(0,tt().b)(t);const h=(0,iu().Y)(t),v=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),x=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat()}),[t]),C=function(e){let{collectionContextStore:t,showAiSuggestions:o}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema();return o?Ai().oE(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[]}),[t]),s=(0,n.useCallback)((e=>e.filter((e=>!l.includes(e.name.toLocaleLowerCase())))),[l]),c=(0,r().K8)((()=>{const e=t.collectionStore(),o=null==e?void 0:e.getFormat();if(null!=o&&o.ai_suggested_properties&&(null==o?void 0:o.ai_suggested_properties.length)>0)return s(null==o?void 0:o.ai_suggested_properties)}),[t,s]),[d,g]=(0,n.useState)(c||"loading"),m=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(m.current||c)return;(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSpaceId(),n=null==e?void 0:e.id,i=[];if(o&&n&&e.getName()){const t=await ae().callApi({eventName:"getAiSuggestedProperties",environment:a,data:{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:Ai().oE(Object.values(e.getSchema())),collectionName:(0,Xd().r4)(e.getName(),e),numSuggestion:su},headers:(0,Gd().WS)({spaceId:o})});if("success"===t.type){const o=t.data.properties.filter((e=>!l.includes(e.name.toLocaleLowerCase())));i.push(...o),p().createAndCommit({environment:a,perform:t=>{u().zA({stores:[e],update:{ai_suggested_properties:o},transaction:t})},canUndo:!0,userAction:"propertyType.generateAiSuggestion"})}}const r=s(i);g(r)})(),m.current=!0}),[t,a,d,o,c,l,s]),d}({collectionContextStore:t,showAiSuggestions:s}),b=(0,r().K8)((()=>(0,ds().QV)()),[]),w=(0,r().K8)((()=>{if(o||a)return[];const e=h.filter((e=>(0,nr().shouldShowInSuggestedProperties)(e)));if(y){const e=hu({appConfig:y,collectionFormat:x,collectionSchema:v,hasAiEnabled:l});return(b?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(e.length>0)return e.map((e=>({type:"workflow",template:e})));if(s)return"loading"===C?"loading":C.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!b){return Cu((0,Gn().lO)({environment:g,collectionContextStore:t}),v)}return[]}),[o,a,h,y,s,b,x,v,l,C,g,t]),j=(0,n.useMemo)((()=>{if("loading"===w)return[];const e=w.filter((e=>"workflow"===e.type)).map((e=>du(e.template.templateId)));return c(e).map(uu)}),[w,c]);(0,ru().O)({collectionContextStore:t,origin:"suggested_properties",shownTemplateIds:j});const A=(0,r().K8)((()=>"loading"===w?"loading":Object.fromEntries(w.map(((e,o)=>{switch(e.type){case"ai_suggestion":return[e.propertySchema.name.toLowerCase(),mu({collectionContextStore:t,propertyType:e.propertySchema.type,propertyName:e.propertySchema.name,disablePropertyTooltip:!0,intl:f,onAccept:d,isSuggestedProperty:!0})];case"typed":return[e.appConfigFeature.name.toLowerCase(),gu({appConfig:y,suggestedProperty:e.appConfigFeature,isDisabled:!1,environment:g,collectionContextStore:t,theme:m})];case"workflow":return[(0,nr().getWorkflowTemplateName)(e.template).toLowerCase(),pu({environment:g,template:e.template,collectionContextStore:t,theme:m,suggestedFeatureAnalytics:{origin:"suggested_properties",selectedIndex:j.indexOf(e.template.templateId),shownTemplateIds:j}})];case"derived_ai_property":return[Gn().dC[e.propertyType].toLowerCase(),mu({collectionContextStore:t,propertyType:e.propertyType,propertyName:Gn().dC[e.propertyType],disablePropertyTooltip:!0,intl:f,iconFill:m.aiPurpleColor,onAccept:d,isSuggestedProperty:!0})]}})))),[y,t,g,f,w,m,d,j]);return A}({hasAiEnabled:h,showAiSuggestions:x,collectionContextStore:t,propertySchema:o,onAccept:a,disableSuggestions:c,getFilteredSuggestedItemKeys:P}),V=(0,n.useMemo)((()=>{if("loading"===R)return[];return P((0,W().uv)(R)).flatMap((e=>R[e]))}),[R,P]),F=(0,n.useMemo)((()=>xr().filter(s,(0,W().uv)(C)).flatMap((e=>C[e.original]))),[C,s]),K=(0,n.useMemo)((()=>xr().filter(s,(0,W().uv)(A)).flatMap((e=>A[e.original]))),[s,A]),D=(0,n.useMemo)((()=>_?xr().filter(s,(0,W().uv)(_)).flatMap((e=>_[e.original])):[]),[_,s]),L=(0,n.useMemo)((()=>{if(!M)return{};const e={};return(0,W().uv)(M).forEach((t=>{const o=xr().filter(s,(0,W().uv)(M[t])).flatMap((e=>M[t][e.original]));o.length>0&&(e[t]=o)})),e}),[M,s]),E=function(e){let{hasMoreSuggestions:t,filteredSuggestedPropertyItems:o,showAiSuggestions:i,setIsShowingMoreSuggestions:r,hasSearchInput:a,disableSuggestions:l,isLoading:s}=e;const c=(0,S().IS)((e=>({loadingShimmer:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},moreSuggestionsButtonContainer:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.mediumTextColor,fontSize:12}})),[]),d=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,w.jsxs)(oe().A,{...e,title:bo().A.formatMessage(bu.suggestedSectionTitle),disableMobileBorders:!0,children:[(0,w.jsx)(Co().A,{style:{width:"80%",...c.loadingShimmer}}),(0,w.jsx)(Co().A,{style:{width:"50%",...c.loadingShimmer}}),(0,w.jsx)(Co().A,{style:{width:"60%",...c.loadingShimmer}}),(0,w.jsx)(Co().A,{style:{width:"50%",...c.loadingShimmer}})]}),items:[]})),[c.loadingShimmer]),u=(0,n.useMemo)((()=>({key:"more-suggestions",render:e=>(0,w.jsx)($().A,{...e,title:(0,w.jsxs)("div",{style:c.moreSuggestionsButtonContainer,children:[(0,w.jsx)(B().sA,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,Wd().b)({fill:an().Ay.uiGray,width:12,height:12,marginLeft:4})]})}),action:e=>{r(!0),e.event&&"stopPropagation"in e.event&&e.event.stopPropagation()}})),[r,c.moreSuggestionsButtonContainer]),p=(0,n.useMemo)((()=>l?{key:"suggested",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]}:o.length?{key:"suggested",render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.suggestedSectionTitle)}),items:t&&!a?[...o,u]:o}:s&&i&&!a?d:{key:"suggested",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]}),[l,o,a,u,s,i,d,t]);return p}({hasMoreSuggestions:!g&&(0,W().uv)(R).length>lu,filteredSuggestedPropertyItems:V,hasSearchInput:I,showAiSuggestions:x,setIsShowingMoreSuggestions:m,disableSuggestions:Boolean(c||o),isLoading:"loading"===R}),z=function(e){let{filteredAiDerivedPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"autofill",render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.autofillSectionTitle)}),items:t}:{key:"autofill",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]}),[t])}({filteredAiDerivedPropertyItems:F}),N=function(e){let{filteredStandardPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"standard",render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.typesSectionTitle)}),items:t}:{key:"standard",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]}),[t])}({filteredStandardPropertyItems:K}),U=function(e){let{filteredConnectedPropertyItems:t}=e;const o=(0,n.useMemo)((()=>t.length?{key:"connected",render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.connectedRelationSectionTitle)}),items:t}:{key:"connected",render:()=>null,items:[]}),[t]);return o}({filteredConnectedPropertyItems:D}),H=function(e){let{filteredConnectedPropertyItemsPerIntegration:t}=e;const o=(0,n.useMemo)((()=>0===Object.keys(t).length?[{key:"existingConnectedRelations",render:()=>null,items:[]}]:Object.entries(t).map((e=>{let[t,o]=e;return 0===o.length?{key:t,render:()=>null,items:[]}:{key:t,render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.existingConnectedRelationSectionTitle,{integrationName:(0,wo().mi)(t)})}),items:o}}))),[t]);return o}({filteredConnectedPropertyItemsPerIntegration:L}),G=(0,n.useMemo)((()=>{if(o||!s.length)return{key:"custom",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]};const e=T((0,W().uv)(R));return C.hasOwnProperty(s.toLowerCase())||null!=e&&e.includes(s.toLowerCase())||null!=A&&A.hasOwnProperty(s.toLowerCase())||null!=_&&_.hasOwnProperty(s.toLowerCase())||null!=k&&k.hasOwnProperty(s.toLowerCase())?{key:"custom",render:()=>(0,w.jsx)(w.Fragment,{}),items:[]}:{key:"custom",render:e=>(0,w.jsx)(oe().A,{...e,title:bo().A.formatMessage(bu.selectToAddNewProperty)}),items:[mu({collectionContextStore:t,onAccept:a,propertyType:"text",propertyName:s,disablePropertyTooltip:!0,intl:f,isSuggestedProperty:!1})]}}),[o,s,C,T,R,A,_,k,t,a,f]),q=(0,n.useMemo)((()=>[E,z,N,...H,U,G]),[E,z,N,U,G,H]);return q}({collectionContextStore:t,propertySchema:a,onAccept:o,disableSuggestions:s,searchInput:g,propertyGroupId:c}),y=(0,r().K8)((()=>{const e=null==t?void 0:t.collectionStore();if(e)return(0,Xd().r4)(e.getName(),e)}),[t]),h=(0,r().K8)((()=>t.permissionScopesStore.state),[t]),v=(0,hc().g)(),x=(0,S().IS)((e=>({inputOuterStyle:v?{backgroundColor:e.white}:{}})),[v]);return null!=h&&h.isExternallyImportedAndSyncedCollection?null:(0,w.jsxs)(K().Ay,{...e,title:a?bo().A.formatMessage(bu.changePropertyType):d.isDesktop&&y?bo().A.formatMessage(bu.newPropertyWithDatabaseName,{databaseName:y}):bo().A.formatMessage(bu.newProperty),children:[(0,w.jsx)(oe().A,{isInput:!0,children:(0,w.jsx)(xo().Ay,{focusInitial:!d.isMobile||void 0,focus:!d.isMobile||void 0,autoFocus:!d.isMobile||void 0,value:g,onChange:e=>{m(e.target.value)},inputOuterStyle:x.inputOuterStyle,placeholder:bo().A.formatMessage(a?bu.searchToChangePlaceholder:bu.searchPlaceholder)})}),(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,sections:f,disableInitialScroll:!0,initialFocus:void 0,resetInitialFocusOnSectionChange:!1})]})}const lu=4,su=10;const cu="workflow.";function du(e){return`${cu}${e}`}function uu(e){return e.replace(cu,"")}function pu(e){let{environment:t,template:o,collectionContextStore:n,theme:i,suggestedFeatureAnalytics:r,titleBadge:a,titleOverride:l,isUpsell:s,onAccept:c,tooltip:d}=e;const u=l||(0,nr().getWorkflowTemplateName)(o);return{key:du(o.templateId),action:()=>{s||(0,nu().p)({environment:t,template:o,collectionContextStore:n,suggestedFeatureAnalytics:r}),c&&c()},render:e=>(0,w.jsx)(ao().A,{style:{whiteSpace:"break-spaces"},placement:so().W.Left,renderTooltip:()=>d,disableTooltip:!d,render:t=>(0,w.jsx)($().A,{...(0,lo().A)(t,e),title:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,w.jsx)(gt().A,{style:{marginRight:4},children:u}),a]}),icon:(0,w.jsx)(or().z,{template:o,size:16,iconStyle:{fill:i.regularIconColor}})})})}}function gu(e){let{appConfig:t,suggestedProperty:o,isDisabled:n,propertyDisabledTooltip:i,environment:r,collectionContextStore:a,theme:l}=e;const s=a.collectionStore(),c=Hd().u9.derivePropertyUris((null==s?void 0:s.getSchema())??{},null==s?void 0:s.getPropertyMapping()),u=(e,t,o,i)=>{const r=o.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==s||null===(t=s.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,zd().LE)(e.uri)&&!c.has(e.uri)})),a=o.dependencies.find((e=>"property"===e.type&&(0,mo().$M)(e.propertySchema)&&(0,mo().om)(e.propertySchema)));if(r)return(0,w.jsx)($().A,{...e,disabled:n,disabledFeedback:n,title:(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,a?(0,w.jsx)($d().A,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,w.jsx)(Qd().A,{}):null]}),icon:(0,w.jsx)(fo().Ay,{type:r.propertySchema.type,theme:l,icon:i,size:16,style:{fill:l.regularIconColor}})})},p=new(vt().A);return{key:o.name,render:e=>{var n,l;return(0,w.jsx)(Qt().A,{showImage:!i,caption:i??o.description,tooltipImage:i||null===(n=o.tooltipImage)||void 0===n?void 0:n.img,tooltipImageScale:null===(l=o.tooltipImage)||void 0===l?void 0:l.scale,render:n=>{if((0,le().lK)(o))return u({...(0,lo().A)(e,n)},o.name,o,o.icon);{const i=Ai().oE(o.variants.map((e=>{const o=null==t?void 0:t.allFeatures.find((t=>t.uri===e));if(o&&(0,le().lK)(o))return o})));return(0,w.jsx)(Jd().A,{buttonPopupStore:p,items:i,getKey:e=>e.name,onSelect:async e=>{await Bo().h3({environment:r,feature:e,collectionContextStore:a,addFeatureFrom:"new_property"}),d().os({collectionSettingsStore:a.settingsStore})},selectedItem:void 0,renderOrigin:t=>u({focused:Boolean(e.focused),...(0,lo().A)(Ai().cJ(e,"onClick","focused"),(0,lo().A)(n,t))},o.name,i[0],o.icon),renderItem:e=>(0,w.jsx)($().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{(0,le().lK)(o)?(await Bo().h3({environment:r,feature:o,collectionContextStore:a,addFeatureFrom:"new_property"}),d().os({collectionSettingsStore:a.settingsStore})):p.setState({open:!0})}}}function mu(e){let{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:a,onAccept:l,iconFill:c,isSuggestedProperty:d}=e;const u={key:n,render:e=>{const l=o&&(null==o?void 0:o.type)===i,d=function(e,t,o){if("auto_increment_id"===t){var n;if(null!=o&&o.type)return bo().A.formatMessage(ac().qh.convert_to_auto_increment_id_property);const t=e.collectionStore();if(null==t?void 0:t.isPageTreeCollection())return bo().A.formatMessage(ac().qh.wiki_forbidden_auto_increment_id_property);if(Boolean(null==t?void 0:t.isSyncedCollection()))return bo().A.formatMessage(ac().qh.synced_database_forbidden_auto_increment_id_property);const i=t&&t.id,r=t&&t.getFormat(),a=t&&(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id),l=t&&t.getSchema(),s=t&&t.getDeletedSchema();if(!(i&&r&&a&&l&&s))return;if(t&&(0,Ud().N_)({id:i,format:r,space_id:a,schema:l,deleted_schema:s}))return bo().A.formatMessage(ac().qh.duplicate_auto_increment_id_property)}}(t,i,o),u=void 0!==d,p=!r&&wu.hasOwnProperty(i)&&"on"===s().default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?a.formatMessage(wu[i]):void 0;return(0,w.jsx)(Su,{checkState:l,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:u,tooltip:d??p,iconFill:c})},action:()=>{l(i,d,n)}};return u}function fu(e){let{connectedRelationProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,intl:a,propertyGroupId:c}=e;return{key:t.name,render:e=>(0,w.jsx)(Su,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:o,tooltip:n,icon:t.integration.info.icon}),action:async()=>{const e=s().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"});t.integration.id===wo().mn&&e?((0,l().u4)({environment:i,event:{eventName:"salesforce_actions",eventProperties:{actionType:"navigate_to_object_selection",integrationId:t.integration.id}}}),d().a2({collectionSettingsStore:r.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"ConnectedRelationObjectSelection",integrationId:t.integration.id}})):await Bo().XO({environment:i,connectedRelationProperty:t,collectionContextStore:r,intl:a,from:"new_property",propertyGroupId:c})}}}function yu(e){const{propertySchema:t,collectionContextStore:o,propertyId:n,integrationId:i}=e;return{key:n,render:e=>(0,w.jsx)(Su,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:!1,icon:t.icon}),action:()=>{d().a2({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:n,integrationId:i,rootPropertySchema:t}})}}}const Su=n.memo((function(e){let{buttonMenuItemProps:t,checkState:o,propertyName:i,propertyType:r,isDisabled:a,badge:l,tooltip:s,tooltipImage:c,tooltipImageScale:d,icon:u,iconFill:p}=e;const g=(0,S().DP)(),m=(0,n.useCallback)((e=>(0,w.jsx)($().A,{...e?(0,lo().A)(t,e):t,disabled:a,disabledFeedback:a,title:(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[i,l]}),checkState:o,icon:(0,w.jsx)(fo().Ay,{type:r,theme:g,icon:u,size:16,style:{fill:p??g.regularIconColor}})})),[t,a,i,l,o,r,g,u,p]);return s?(0,w.jsx)(Qt().A,{showImage:!a,caption:s,tooltipImage:a?void 0:c,tooltipImageScale:d,render:e=>m(e)}):m(void 0)}));function hu(e){let{appConfig:t,collectionFormat:o,collectionSchema:n,hasAiEnabled:i}=e;if(!o||!n)return[];const r=e=>{const t=o.app_config_uri,r=Hd().u9.derivePropertyUris(n??{},o.app_uri_map);if(e.collectionUri!==t)return!1;let a=!0;e.uri===(0,Za().Jb)().uri&&r.has(O().yx.GithubPrsRelation)&&(a=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===t&&(0,zd().LE)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||i)&&a},a={};t.allFeatures.forEach((e=>{(0,le().$n)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,le().lK)(t)&&r(t))))))&&(a[e.uri]=e.variants)}));const l=Object.values(a).flat();return t.allFeatures.filter((e=>(0,le().lK)(e)&&!l.find((t=>t===e.uri))?r(e):!!(0,le().$n)(e)&&Boolean(a[e.uri]))).sort(((e,t)=>(0,le().$n)(e)?-1:(0,le().$n)(t)?1:e.dependencies.length-t.dependencies.length))}function vu(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const xu=["ai_summary"];function Cu(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!xu.includes(e.propertyType)||!o.has(e.propertyType)))}const bu=(0,B().YK)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},existingConnectedRelationSectionTitle:{defaultMessage:"{integrationName}",id:"database.viewSettings.propertyTypeSection.existingConnectedIntegrationTitle"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"}}),wu=(0,B().YK)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notions formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this items progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"},geo_point:{defaultMessage:"Display a physical location on a map.",id:"database.viewSettings.propertyTab.geoPointProperty.tooltip"}});function ju(e){const{collectionContextStore:t,collectionSettingsStore:o,property:a,formatKey:l,propertyGroupId:s}=e,c=(0,i().v3)(),u=(0,n.useMemo)((()=>ui().default.createValue("")),[]),p=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]);return p?(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>d().os({collectionSettingsStore:o}),children:(0,w.jsx)(Ui,{collectionContextStore:t,onAccept:e=>function(e,t,o,n,i,r,a){const l=o.collectionStore();if(!l)return;(0,qt().X)({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:s}=n.state,c=s[s.length-2];c&&"setupRelation"===c.type&&d().yl({collectionSettingsStore:n});d().dP({collectionSettingsStore:n,item:{type:"setupRelation",property:i,formatKey:r,propertyGroupId:a,targetCollectionPointer:e.pointer}})}(e,c,t,o,a,l,s),parentStore:p,context:Nr().U9.Relation,inputStore:u})}):null}function Au(e){const{collectionContextStore:t,collectionSettingsStore:o,module:i}=e,a=(0,n.useMemo)((()=>ui().default.createValue("")),[]),{collectionStore:l}=(0,fs().bi)(),s=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),c=(0,n.useCallback)((e=>{d().dP({collectionSettingsStore:o,item:{type:"setupViewsModule",targetCollectionPointer:e.pointer,module:i}})}),[o,i]);return s?(0,w.jsx)(K().Ay,{...e,handleClose:()=>d().os({collectionSettingsStore:o}),children:(0,w.jsx)(Ui,{collectionContextStore:t,onAccept:c,parentStore:s,context:Nr().U9.Relation,inputStore:a,collectionStore:l})}):null}var _u=()=>o(908447),Mu=()=>o(717989),ku=()=>o(395963);function Iu(e){const{collectionContextStore:t,collectionSettingsStore:o,property:a,formatKey:l,propertyGroupId:s,targetCollectionPointer:c,from:g}=e,m=(0,r().K8)((()=>t.collectionStore()),[t]),f=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?Y().md.createChildStore(n,t):void 0}({targetCollectionPointer:c,collectionStore:m,collectionViewBlockStore:e})}),[t,m,c]),y=(0,r().K8)((()=>a?ht().Jq(t,a):void 0),[t,a]),S=Boolean(m&&f&&m.id===f.id),h=Boolean("relation"===(null==y?void 0:y.type)&&y.connectedRelation),v=Boolean("subitem"===g),x=Boolean("timeline_arrows_by"===g),C=v||x,b=(0,r().K8)((()=>t.contextType),[t]),j=(0,i().v3)(),A=(0,B().tz)(),_=(0,r().K8)((()=>{const e=null==m?void 0:m.getSchema();return void 0===(null==y?void 0:y.name)&&f&&e?ht().$H(A,{targetCollectionStore:f,isSelfRelation:S,sourceSchema:e,createUnique:!0,from:g}):(null==y?void 0:y.name)||""}),[m,null==y?void 0:y.name,f,A,S,g]),[M,k]=(0,n.useState)(_),[I,T]=(0,n.useState)("no_limit"),[P,R]=(0,n.useState)({hasInverseRelation:C,inverseName:void 0,autoRelate:{enabled:!1}}),V=(0,n.useCallback)((()=>{d().a2({collectionSettingsStore:o,item:{type:"selectRelationSource",property:a,formatKey:l}})}),[o,a,l]),F=(0,n.useCallback)((()=>{if(!P)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=P,r=t.collectionStore(),c=t.collectionViewStore();if(!r||!f)return;const{performResult:m}=p().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:j,canUndo:!0,perform:o=>{const d=a??st().IL({environment:j,collectionStore:r,collectionViewArgs:c&&l?{collectionViewStore:c,format:c.getFormat(),formatKey:l}:void 0,propertyType:"relation",transaction:o});if(Ws().cT({environment:j,collectionContextStore:t,collectionStore:r,property:d,propertyName:M,targetCollectionStore:f,hasInverseRelation:e,inverseName:n,autoRelate:i,propertyLimit:I,intl:A,transaction:o,from:g}),s&&d&&(0,ku().En)({collectionStore:r,groupId:s,propertyId:d,transaction:o}),c){var p;const e=(null===(p=c.getFormat().table_properties)||void 0===p?void 0:p.find((e=>e.property===d)))??{property:d,visible:!0};u().zA({stores:[c],update:{table_properties:[...c.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===g&&c?ct().zt({environment:j,collectionContextStore:t,relationPropertyId:d,transaction:o}):"timeline_arrows_by"===g&&c&&(Mu().Tq({collectionViewStore:c,newProperty:d,transaction:o}),Mu().L_({collectionContextStore:t,relationPropertyId:d,transaction:o})),d}});"subitem"===g||"timeline_arrows_by"===g?(d().yl({collectionSettingsStore:o}),d().a2({collectionSettingsStore:o,item:{type:"main"}})):d().n1({collectionSettingsStore:o,property:m,formatKey:l}),(0,_u().Z)({environment:j,collectionContextStore:t,from:"collectionPage"===b?"page_properties":"view_settings",property_type:"relation"})}),[P,t,f,j,g,b,a,l,s,M,I,A,o]);return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,w.jsx)(oe().A,{isInput:!0,children:(0,w.jsx)(xo().Ay,{value:M||"",placeholder:"Property name",onChange:e=>k(e.target.value),onBlur:Ai().lQ,onSubmit:Ai().lQ,focusInitial:!0,selectAll:!1})}),(0,w.jsx)(gc,{isSelfRelation:S,collectionStore:f,showAs:"chevron",onClick:V,disabled:v}),!g&&(0,w.jsx)(Fs,{selectedKey:I,propertyType:"relation",onChange:e=>T(e)}),f&&!h&&(0,w.jsx)(Qs,{collectionContextStore:t,targetCollectionStore:f,property:a,mode:"create",temporaryInverseState:P,setTemporaryInverseState:R,onSubmit:F,shouldEnforceTwoWayRelation:C}),(0,w.jsx)(oe().A,{children:(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.relations"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var Tu=()=>o(416504),Pu=()=>o(154017),Bu=()=>o(180762),Ru=()=>o(626318);function Vu(e){const{collectionContextStore:t,collectionSettingsStore:o,targetCollectionPointer:a,module:l}=e,s=(0,B().tz)(),{isMobile:c}=(0,i().Y0)(),{layoutStore:u,setModuleSelection:g}=(0,fs().LH)(),{collectionStore:m}=(0,fs().bi)(),f=(0,i().v3)(),y=(0,r().K8)((()=>u.inMemoryRecordCache),[u]),h=(0,r().K8)((()=>{if(!a)return;if(m&&m.pointer===a)return m;const e=t.collectionViewBlockStore();return e?Y().md.createChildStore(e,a):void 0}),[t,m,a]),v=(0,r().K8)((()=>null==h?void 0:h.canEditCollection()),[h]),x=Boolean(m&&h&&m.id===h.id),C=(0,r().K8)((()=>{var e;return null==h||null===(e=h.getModel())||void 0===e?void 0:e.getRenderTitle({getRecordModel:null==m?void 0:m.getRecordModel,intl:s,userTimeZone:(0,Tu().P)()})}),[h,m,s]),b=(null==h?void 0:h.id)!==(null==m?void 0:m.id),[j,A]=(0,n.useState)(C??""),[_,k]=(0,n.useState)({hasInverseRelation:b,inverseName:void 0,autoRelate:{enabled:!1}}),[I,T]=(0,n.useState)(!1),P=(0,n.useCallback)((()=>{d().a2({collectionSettingsStore:o,item:{type:"selectViewsModuleSource",module:l}})}),[o,l]),V=(0,n.useCallback)((()=>{T((e=>!e))}),[]),F=(0,n.useCallback)((()=>{k((e=>({...e,hasInverseRelation:!1})))}),[]),L=(0,n.useCallback)((()=>{k((e=>({...e,hasInverseRelation:!0})))}),[]),O=(0,n.useCallback)((e=>{var t;const o=null!=_&&null!==(t=_.autoRelate)&&void 0!==t&&t.enabled?{enabled:!1}:{enabled:!0,bot_id:e};k((t=>({...t,autoRelate:{enabled:!!o,bot_id:e}})))}),[_]),E=(0,n.useCallback)((e=>{k((t=>({...t,inverseName:e.target.value})))}),[]),z=(0,n.useCallback)((()=>{const e=null==t?void 0:t.collectionViewBlockStore();if(!e)throw new Error("Views module block not found");const{performResult:n}=p().createAndCommit({userAction:"CollectionSettingsSetupViewsModule.handleAddView",environment:f,canUndo:!0,perform:o=>{let n;if(I&&m){const e=st().IL({environment:f,collectionStore:m,collectionViewArgs:void 0,propertyType:"relation",transaction:o}),{inverseRelationPropertyId:i}=Ws().cT({environment:f,collectionContextStore:t,collectionStore:m,property:e,propertyName:j,targetCollectionStore:h??m,hasInverseRelation:_.hasInverseRelation,inverseName:_.inverseName,autoRelate:_.autoRelate,intl:s,transaction:o,propertyLimit:"no_limit"})??{};n=i??e}const i=(0,Ru().Bj)({environment:f,transaction:o,collectionViewBlockStore:e,targetCollectionPointer:null==h?void 0:h.pointer,viewName:j,relationPropertyId:n,inMemoryRecordCache:y});return g({type:"existing_module",moduleId:l.id,isDragging:!1}),{collectionViewPointer:i}}});d().os({collectionSettingsStore:o});const{collectionViewPointer:i}=n??{};i&&(nt().default.afterNextFlush((()=>{t&&((0,Bu().t)({environment:f,collectionContextStore:t,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),d().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore,closeOnEscape:!1}))})),t&&(0,Pu().b)({environment:f,collectionContextStore:t,view_type:"table",module:"viewsMain",is_in_page_builder:!0})),d().os({collectionSettingsStore:o})}),[t,f,o,I,m,j,h,_,s,y,g,l.id]),N=(0,r().K8)((()=>null==h?void 0:h.getIcon()),[h]),U=(0,S().IS)((e=>({chevronTitle:{marginLeft:4,display:"inline",wordBreak:"break-word",alignSelf:"center",...R().RC},relationMenuTitle:{display:"flex",alignItems:"center",whiteSpace:"pre"},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6},tooltip:{maxWidth:285,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},tooltipSecondary:{color:e.text.contrastSecondary}})),[]),H=I&&h&&v;return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"New view",id:"database.viewSettings.setupViewTab.title"}),children:[(0,w.jsx)(oe().A,{isInput:!0,children:(0,w.jsx)(xo().Ay,{value:j||"",placeholder:I?s.formatMessage({defaultMessage:"View & relation name",id:"database.viewSettings.mainTab.viewNameAndRelationNameSection.title"}):s.formatMessage({defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),onChange:e=>A(e.target.value),onBlur:Ai().lQ,onSubmit:Ai().lQ,focusInitial:!0,selectAll:!1})}),(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"View of",id:"database.viewSettings.setupViewsModule.viewOf.title"}),showChevron:!0,onClick:P,disabled:!1,right:x?(0,w.jsx)(B().sA,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(vn().A,{icon:N,isEmptyPage:!1,size:20,disabled:!0}),(0,w.jsx)(Da().A,{store:h,style:U.chevronTitle})]}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}}),(0,w.jsx)(ne().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Add new relation",id:"database.viewSettings.addRelationToggle"}),on:I,onClick:V,focused:!1,disabled:!v})]}),H&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Zs,{currentInverseState:!(null==_||!_.hasInverseRelation),disableInverseRelation:F,enableInverseRelation:L,handleAutoRelateToggle:O,temporaryInverseState:_,collectionStore:m,targetCollectionStore:h,isTwoWayToggleDisabled:!x,isNameDisabled:!1,menuTitle:(0,w.jsxs)("div",{style:U.relationMenuTitle,children:[s.formatMessage(Xs.generic.title),!c&&(0,w.jsx)(ao().A,{placement:so().W.Bottom,textWrap:!0,style:U.tooltip,render:e=>(0,w.jsx)("div",{...e,children:(0,M().$)(U.helpIcon)}),renderTooltip:()=>(0,w.jsxs)(w.Fragment,{children:[x?s.formatMessage(Fu.selfTwoWayRelationTooltip):s.formatMessage(Fu.nonSelfTwoWayRelationTooltip),!x&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("br",{}),(0,w.jsx)("span",{style:U.tooltipSecondary,children:(0,w.jsx)(B().sA,{...Fu.nonSelfTwoWayRelationTooltipSecondary})})]})]})})]}),autoRelate:null==_?void 0:_.autoRelate,isSelfRelation:x,inverseRelationName:(null==_?void 0:_.inverseName)??"",handleInverseNameChange:E})}),(0,w.jsx)(oe().A,{children:(0,w.jsx)(te().A,{style:{display:"flex",margin:"0px 8px 8px 8px"},onClick:z,disabled:0===j.length,children:I?(0,w.jsx)(B().sA,{...Fu.addViewAndRelationButton}):(0,w.jsx)(B().sA,{...Fu.addViewButton})})})]})}const Fu=(0,B().YK)({addViewButton:{defaultMessage:"Add view",id:"database.viewSettings.addViewButton"},addViewAndRelationButton:{defaultMessage:"Add view & relation",id:"database.viewSettings.addViewAndRelationButton"},selfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.selfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.nonSelfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltipSecondary:{defaultMessage:"This setting is required for relations of linked databases in tabbed views.",id:"database.viewSettings.nonSelfTwoWayRelationTooltipSecondary"}});var Ku=()=>o(579627),Du=()=>o(21140),Lu=()=>o(484595);function Ou(e){let{collectionSettingsStore:t,collectionContextStore:a,integrationName:s,integrationIcon:c,fullHeight:u}=e;const g=(0,i().v3)(),m=(0,S().IS)((e=>({promptTitle:zu(e)})),[]),[f,y]=(0,n.useState)(!1),h=(0,r().K8)((()=>a.collectionViewBlockStore()),[a]),{numberOfGuests:v,numberOfUsers:x,isPublic:C}=(0,r().K8)((()=>{const e=bs().subscriptionDataStoreInstance.state?o(134217).Be(bs().subscriptionDataStoreInstance.state):[],t=(0,ni().MU)(Ai().oE(e.map((e=>[e.userId,e.role]))));if(!h)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const n=(0,o(731320).i0)(h).map((e=>e.permissionItem));let i=!1,r=!1;for(const o of n)Gs().FP(o)?i=!0:Gs().Lg(o)&&!Gs().$I(o.role)&&(r=!0);const a=Ai().sb(Ai().oE([...n.map((e=>"user_permission"===e.type?e.user_id:void 0)),...r?Object.keys(t):[]])),l=a.filter((e=>"none"!==t[e])).length,s=a.filter((e=>{const o=t[e],i=Boolean(n.filter(Gs().B2).find((t=>t.user_id===e)));return Boolean(o&&i&&!Gs().Tt(o))})).length;return{numberOfGuests:s,numberOfUsers:l+s,isPublic:i}}),[h]);(0,n.useEffect)((()=>{C||1!==x||d().os({collectionSettingsStore:t})}),[t,C,x]);const b=(0,n.useCallback)((()=>{h&&(f&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;p().createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,canUndo:!0,perform:e=>{Ku().wW({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:g,store:h}),function(e,t){l().vd(e,"set_database_sync_permissions",t)}(g,{type:f?"restrict":"share"}),d().os({collectionSettingsStore:t}))}),[t,h,g,f]);if(!h)return null;const j=(0,w.jsx)("div",{style:m.promptTitle,children:(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),A=(0,w.jsxs)(w.Fragment,{children:[0!==v?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:x,numberOfGuests:v}})," "]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:x}})," "]}),C&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:s}})]}),_=(0,w.jsx)(Du().Ye,{style:{marginTop:10},children:(0,w.jsx)(te().A,{style:{flex:"0 0 100%"},size:"lg",onClick:b,children:(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),M=(0,w.jsx)(Du().Ye,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,w.jsx)("img",{style:{width:40},src:c})}),k=(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,w.jsx)($().A,{...e,textWrapperStyle:{textAlign:"left"},title:(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:A,icon:(0,w.jsx)(Lu().A,{isSelected:!f}),onClick:()=>{y(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,w.jsx)($().A,{...e,textWrapperStyle:{textAlign:"left"},title:(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,w.jsx)(B().sA,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,w.jsx)(Lu().A,{isSelected:f}),onClick:()=>{y(!0)}})}],render:e=>(0,w.jsx)(oe().A,{...e})}]});return(0,w.jsx)(K().Ay,{collectionSettingsStore:t,fullHeight:u,children:(0,w.jsxs)(Du().Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[M,(0,w.jsxs)("div",{children:[j,k]}),_]})})}const Eu=n.memo(Ou,pi().A);function zu(e){return{color:e.regularTextColor,fontWeight:R().Wy.semibold,fontSize:14}}var Nu=()=>o(187899),Uu=()=>o(380468);const Hu=(0,B().YK)({inputPlaceholder:{defaultMessage:"Filter by",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});function Wu(e){var t;const{context:a,collectionSettingsStore:l,collectionContextStore:s}=e,c=(0,i().v3)(),u=(0,r().O$)(s.normalizedSchemaStore),p=(0,r().O$)(s.normalizedFormatStore),g=(0,r().O$)(s.permissionScopesStore),m=(0,r().K8)((()=>function(e){return e.currentCombinatorFilterStore.state}(s)),[s]),f=(0,r().K8)((()=>{const e=s.collectionViewStore();return e?(0,ft().LQ)({schema:u,filters:$u(s),getRecordModel:e.getRecordModel}):[]}),[s,u]),y=(0,r().K8)((()=>s.contextType),[s]),S=(0,n.useCallback)((e=>{if(!e)return;const t=s.collectionViewStore(),o=f.find((t=>t.property===e));if(!o||!t)return;const n={id:aa().JW(),filter:o};Nu().IU({environment:c,collectionContextStore:s,temporaryState:{...s.temporaryStateStore.state,propertyFilters:{value:[...$u(s),n]}}}),function(e,t,o,n,i){if((0,qt().X)({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===Nr().Bd.FilterBar||o===Nr().Bd.TopbarFilterPopup){qu(t,n);const o=t.getFilterBarItemSettingsStore(e);d().R8({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===Nr().Bd.ViewSettings){Yu(n);const o=t.getFilterOptionsItemSettingsStore(e);d().R8({collectionSettingsStore:o,item:{type:"filter"}})}}(n,s,a,l,c)}),[s,l,a,c,f]),h=(0,n.useCallback)((()=>{s.collectionViewStore()&&(m||Nu().IU({environment:c,collectionContextStore:s,temporaryState:{...s.temporaryStateStore.state,combinatorFilter:{value:o(289915).Lx}}}),Qu(s,a,l,c))}),[s,l,m,a,c]);return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:g.canConfigureBlock&&"collectionSettings"!==y&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(D().A,{icon:m?o(170350).S:Qr().plusIcon,isGray:!0,title:m?(0,w.jsx)(B().sA,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,w.jsx)(B().sA,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:m&&(0,w.jsx)(B().sA,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=m.filters)||void 0===t?void 0:t.length)||1}}),onClick:h})}),children:(0,w.jsx)(Uu().A,{schema:u,format:p,getProperties:()=>f.map((e=>e.property)),onAccept:S,inputPlaceholder:bo().A.formatMessage(Hu.inputPlaceholder)})})}const Gu=n.memo(Wu,pi().A);function qu(e,t){e.filtersBarOpenStore.setState(!0),d().yl({collectionSettingsStore:t})}function Yu(e){d().R8({collectionSettingsStore:e,item:{type:"main"}}),d().a2({collectionSettingsStore:e,item:{type:"filters"}})}function $u(e){return e.currentPropertyFiltersStore.state}function Qu(e,t,o,n){(0,qt().X)({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===Nr().Bd.FilterBar||t===Nr().Bd.TopbarFilterPopup?(qu(e,o),d().R8({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===Nr().Bd.ViewSettings&&(Yu(o),d().R8({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const Zu=(0,B().YK)({inputPlaceholder:{defaultMessage:"Sort by",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const Ju=function(e){const{context:t,collectionContextStore:o,collectionSettingsStore:n}=e,a=(0,i().v3)(),l=(0,B().tz)(),s=(0,r().O$)(o.normalizedSchemaStore),c=(0,r().O$)(o.normalizedFormatStore),u=(0,r().K8)((()=>Xu(o)),[o]);return(0,w.jsx)(K().Ay,{...e,collectionSettingsStore:n,title:(0,w.jsx)(B().sA,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,w.jsx)(Uu().A,{schema:s,format:c,getProperties:()=>Object.entries(s).filter((e=>{let[t,o]=e;return!u.find((e=>e.property===t))&&(0,El().oH)(o)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const a=o.collectionViewStore(),l=o.normalizedSchemaStore.state;if(!a||!l)return;const s=null===(r=l[e])||void 0===r?void 0:r.type;(0,qt().X)({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:a.getType(),property_type:s});const c={property:e,direction:"ascending"},u=[...Xu(o),c];if(Nu().IU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,sorts:{value:u}}}),n===Nr().Bd.TopbarSortPopup||n===Nr().Bd.FilterBar){o.filtersBarOpenStore.setState(!0),d().yl({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;d().R8({collectionSettingsStore:e,item:{type:"sort"}})}else n===Nr().Bd.ViewSettings&&(d().R8({collectionSettingsStore:i,item:{type:"main"}}),d().a2({collectionSettingsStore:i,item:{type:"sort"}}))}(e,a,o,t,n),inputPlaceholder:l.formatMessage(Zu.inputPlaceholder)})})};function Xu(e){return e.currentSortsStore.state}var ep=()=>o(406792);const tp=function(e){const{collectionContextStore:t,context:n,collectionSettingsStore:a}=e,l=(0,i().v3)(),s=(0,r().K8)((()=>t.collectionViewStore()),[t]),c=(0,r().O$)(t.normalizedSchemaStore),u=(0,r().K8)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),p=(0,r().K8)((()=>null==s?void 0:s.getType()),[s]);return s&&u&&p?(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,w.jsx)(o(44935).i,{children:(0,w.jsx)(o(870988).tY,{index:0,level:0,combinatorFilter:u,schema:c,onChange:(e,o)=>function(e,t,o,n){var i;const r=null===(i=n.remoteResultStore.state)||void 0===i?void 0:i.sizeHint,a=ep().default.DO_NOT_USE_markLegacy("collections.update_filter_lag");ep().default.DO_NOT_USE_measureAfterNextFlushLegacy(a,{environment:o,getData:()=>mn().K6({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:r})}),Nu().IU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryStateStore.state,combinatorFilter:{value:t}}}),(0,qt().X)({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,l,t),collectionContextStore:t,collectionViewType:p,collectionViewId:s.id,parentStore:s})}),(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),isRed:!0,icon:Gl().I,onClick:()=>function(e,t,o,n){Nu().IU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,combinatorFilter:{value:void 0}}}),o===Nr().Bd.FilterBar&&d().os({collectionSettingsStore:n});(0,qt().X)({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(l,t,n,a)})})]}):null};var op=()=>o(300089),np=()=>o(958832),ip=()=>o(194440),rp=()=>o(57232),ap=()=>o(128941);function lp(e){const{collectionSettingsStore:t,collectionContextStore:a}=e,l=(0,i().v3)(),[s,c,u,p]=(0,r().K8)((()=>[a.currentPropertyFiltersStore.state,a.currentPropertyFiltersStore.state.map((e=>e.id)),a.permissionScopesStore.state,(0,ft().I6)(a)]),[a]),g=(0,o(396182).I)(),m=(0,r().K8)((()=>{const e=a.isUnlistedViewStore.state&&a.isInlineViewStore.state;return u.canConfigureBlock||e?a.currentCombinatorFilterStore.state:void 0}),[a,u]),f=(0,n.useCallback)((e=>{d().os({collectionSettingsStore:a.filterOptionsCombinatorFilterSettingsStore}),s.filter((t=>!e||t.id!==e)).forEach((e=>{const t=a.getFilterOptionsItemSettingsStore(e);d().os({collectionSettingsStore:t})}))}),[a,s]);(0,n.useEffect)((()=>f()),[]);const y=(0,S().IS)((e=>({menuItem:{color:e.mediumTextColor},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.mediumIconColor},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,w.jsx)("div",{onClick:e=>{(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:f})},children:(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:p&&(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(cp,{collectionContextStore:a})}),unconstrainedWidth:!0,children:(0,w.jsxs)(oe().A,{children:[(c.length>0||m)&&(0,w.jsxs)("div",{style:l.device.isMobile?y.mobile:void 0,children:[m&&(0,w.jsx)(up,{collectionContextStore:a}),dp(l)?(0,w.jsx)(Sc().Ay,{direction:"vertical",keys:c,renderKey:e=>{const t=c.indexOf(e);return(0,w.jsx)(pp,{collectionContextStore:a,filter:s[t],onClick:f})},onDrop:e=>function(e,t,o){const n=o.collectionViewBlockStore();if(!n)return;const i=o.currentPropertyFiltersStore.state,r=Ai().oE(e.map((e=>i.find((t=>t.id===e)))));Nu().IU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,propertyFilters:{value:r}}}),(0,qt().X)({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,l,a),onDragEnd:()=>g(),disabled:!u.canConfigureBlock}):c.map((e=>{const t=c.indexOf(e);return(0,w.jsx)(pp,{collectionContextStore:a,filter:s[t],onClick:f},e)}))]}),(0,w.jsx)($().A,{focused:!1,icon:(0,io().W)(y.menuItemIcon),style:y.menuItem,title:(0,w.jsx)(B().sA,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{f(),function(e,t,o){(0,qt().X)({environment:e,collectionContextStore:o,action:"click_new_filter"}),d().a2({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpenStore.setState(!0)}(l,t,a)}})]})})})}const sp=n.memo(lp,pi().A);function cp(e){let{collectionContextStore:t}=e;return(0,w.jsx)(ap().Ay,{context:ap().$J.SettingsFilters,collectionContextStore:t})}function dp(e){return!e.device.isMobile}function up(e){let{collectionContextStore:t}=e;const o=(0,i().v3)();return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[dp(o)&&(0,w.jsx)(rp().A,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,w.jsx)(np().l,{context:op().aV.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function pp(e){let{filter:t,collectionContextStore:o,onClick:n}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[dp(a)&&(0,w.jsx)(rp().A,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,w.jsx)(ip().A,{id:t.id,context:op().aV.SettingsFilters,collectionContextStore:o,collectionSettingsStore:l,onClick:n},t.id)]})}var gp=()=>o(812480),mp=()=>o(921598),fp=()=>o(632537),yp=()=>o(673900);const Sp=function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;const a=(0,S().DP)(),l=n[t.property];return(0,r().K8)((()=>o.collectionStore()),[o])&&l?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{topBorder:!1,disableMobileBorders:!0,title:(0,w.jsx)(B().sA,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),children:(0,w.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,w.jsx)(hp,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,w.jsx)("span",{style:{color:a.mediumTextColor,margin:"0 8px"},children:""}),(0,w.jsx)(hp,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,w.jsx)(oe().A,{topBorder:!1,disableMobileBorders:!0,title:(0,w.jsx)(B().sA,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),children:(0,w.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,w.jsx)(hp,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,w.jsxs)("span",{style:{color:a.mediumTextColor,fontSize:12},children:[(0,w.jsx)(fp().A,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,w.jsx)(fp().A,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null};function hp(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,w.jsx)(yp().v,{value:t[o],onChange:e=>{void 0!==e&&("size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}}))}})}const vp=function(e){return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(xp,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,w.jsx)(Cp,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})};function xp(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,r().K8)((()=>(0,Ze().S)(t)),[t]),i=(0,r().O$)(o.normalizedSchemaStore),a=(0,r().O$)(o.normalizedFormatStore);if(!n||"groupByNumber"!==n.type||"chart_config"===n.groupByKey)return null;const l=a[n.groupByKey];return l?(0,gp().hC)({groupBy:l,schema:i})??null:null}function Cp(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>n.collectionViewStore()),[n]),s=(0,r().O$)(n.normalizedSchemaStore),c=(0,r().O$)(n.normalizedFormatStore),d=(0,r().K8)((()=>(0,mp().H2)(c,t,o)),[c,t,o]);if(!d||!l)return null;const g=(0,gp().bO)(d);return g?(0,w.jsx)(Sp,{numberGroupBy:g,schema:s,onChange:e=>{if("number"===d.type)p().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:a,canUndo:!0,perform:n=>{u().zA({stores:[l],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===d.type){const n=Ai().cJ(e.newNumberGroupBy,"property"),i={...d,groupBy:n};p().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:a,canUndo:!0,perform:e=>{u().zA({stores:[l],update:{[t]:i,[o]:void 0},transaction:e})}})}(0,qt().X)({environment:a,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:d.type})},collectionContextStore:n}):null}const bp=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:a,groupByKey:l,groupsFormatKey:s}=e,c=(0,i().v3)(),g=(0,r().K8)((()=>(0,Ze().S)(a)),[a]),m=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),f=(0,r().K8)((()=>t.collectionViewStore()),[t]),y=(0,r().K8)((()=>null==f?void 0:f.getType()),[f]),S=(0,r().K8)((()=>(0,mp().H2)(t.normalizedFormatStore.state,l,s)),[t,l,s]),h=(0,r().O$)(t.normalizedSchemaStore),v=(0,r().O$)(t.normalizedFormatStore),x=(0,r().K8)((()=>void 0!==y&&(0,o(10594).Qt)({viewType:y,groupByKey:l})),[l,y]),C=(0,n.useCallback)((()=>Object.entries(h).sort(wp).map((e=>e[0])).filter((e=>{const t=h[e];return t&&(0,mp().Eg)(t)}))),[h]),b=(0,n.useCallback)((e=>{const o=t.collectionViewStore();if(o){if(e){const n=h[e];if(!n||!(0,mp().Eg)(n))return;const i=(0,mp().V0)({property:e,propertySchema:n,isCollectionTypedView:"collectionTypedView"===t.contextType});p().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:c,canUndo:!0,perform:e=>{u().zA({stores:[o],update:{[l]:i,[s]:void 0},transaction:e})}}),(0,qt().X)({environment:c,collectionContextStore:t,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else p().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:c,canUndo:!0,perform:e=>{u().zA({stores:[o],update:{[l]:void 0,[s]:void 0},transaction:e})}}),(0,qt().X)({environment:c,collectionContextStore:t,action:"group_by_property_accept"});d().R8({collectionSettingsStore:a,item:{type:"main"}}),d().a2({collectionSettingsStore:a,item:{type:"group",groupByKey:l,groupsFormatKey:s}})}}),[t,a,l,s,h,c]),j=(0,n.useMemo)((()=>g&&"groupByProperty"===g.type&&y?(0,gp().rq)(g.groupByKey,y):null),[g,y]);return m&&f&&g&&y&&"groupByProperty"===g.type?(0,w.jsx)(K().Ay,{...e,collectionSettingsStore:a,title:j,children:(0,w.jsx)(Uu().A,{schema:h,format:v,currentProperty:null==S?void 0:S.property,showNoneOption:x,getProperties:C,onAccept:b})}):null}));function wp(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return void 0!==i&&void 0!==r?i.localeCompare(r,void 0,{sensitivity:"base"}):void 0!==i?1:void 0!==r?-1:0}const jp=(0,B().j4)((function(e){const t=(0,r().K8)((()=>{const t=e.collectionContextStore.collectionViewStore();return"chart"===(null==t?void 0:t.getType())}),[e.collectionContextStore]),o=(0,r().K8)((()=>Tn().A.state.isOpen),[]);return(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:o?280:290,children:(0,w.jsx)(Bn().A,{...e,showDoneButton:t})})}));var Ap=()=>o(174638),_p=()=>o(690471),Mp=()=>o(259464);const kp=110,Ip=210,Tp=223,Pp=25,Bp=87;function Rp(e){const{propertyName:t}=e,o=(0,S().DP)(),n=(0,S().IS)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:_p().cC},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,w.jsx)(oe().A,{children:(0,w.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,w.jsxs)("svg",{style:n.svgContainer,children:[(0,w.jsx)(Mp().A,{startPoint:{x:kp,y:Pp},endPoint:{x:kp,y:Bp},style:n.svgArrowTheme,showArrowHead:!0}),(0,w.jsx)(Mp().A,{startPoint:{x:Ip,y:Bp},endPoint:{x:Tp,y:Bp},style:n.svgArrowTheme,showArrowHead:!1}),(0,w.jsx)("circle",{cx:Tp,cy:Bp,r:_p().w7,style:n.svgArrowTheme,fill:o.white})]}),(0,w.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,w.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,w.jsx)("span",{children:""})}),(0,w.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,w.jsx)("span",{children:""})})]})})}const Vp=(0,B().YK)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const Fp=(0,B().j4)((function(e,t){const{collectionContextStore:a,collectionSettingsStore:l,formatSetting:s}=e,c=(0,i().Y0)(),g=(0,B().tz)(),m=(0,i().v3)(),f="collection_page_properties",[y]=(0,n.useState)("no_limit"),v="subitem"===s,x="timeline_arrows_by"===s,C=(0,r().K8)((()=>a.databaseType),[a]),j=(0,r().O$)(a.normalizedSchemaStore),A=(0,r().K8)((()=>a.collectionStore()),[a]),_=(0,r().K8)((()=>(null==A?void 0:A.getFormat())??{}),[A]),M=(0,r().K8)((()=>a.collectionViewStore()),[a]),k=(0,r().K8)((()=>null==M?void 0:M.getFormat()),[M]),I=(null==k?void 0:k.subitem_display_mode)??"show",T=(0,r().K8)((()=>{var e;return v?null===(e=a.currentSubitemFormatStoreForCollectionStore.state)||void 0===e?void 0:e.property:x?a.currentArrowsByFormatStore.state:void 0}),[a,v,x]),R=(0,r().K8)((()=>{var e,t;return v?null===(e=a.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:x?null===(t=a.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[a,v,x]),V=(0,r().O$)(a.permissionScopesStore),F=(0,r().K8)((()=>ht().uu(a,j)),[a,j]),L=(0,r().K8)((()=>a.normalizedSchemaStore.state),[a]),O=(0,r().K8)((()=>{var e;const t=a.currentSubitemFormatStoreForCollectionStore.state,o=a.currentArrowsByFormatStore.state;let n;return v?n=t?j[t.property]:void 0:x&&(n=o?j[o]:void 0),null===(e=n)||void 0===e?void 0:e.name}),[a,j,v,x]),E=(0,r().K8)((()=>{const e=a.collectionStore();return null!=e&&e.isDefined()?ht().$H(g,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:L,createUnique:!0,from:s}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[a,L,g,s]),[z,N]=(0,n.useState)(O||E),U=(0,r().K8)((()=>{const e=a.currentSubitemFormatStoreForCollectionStore.state,t=a.currentArrowsByFormatStore.state;let o;if(v?o=e?j[e.property]:void 0:x&&(o=t?j[t]:void 0),o&&"relation"===o.type){var n;const e=o.property;return e?null===(n=j[e])||void 0===n?void 0:n.name:void 0}}),[a,j,v,x]),H=(0,r().K8)((()=>{const e=a.collectionStore();return null!=e&&e.isDefined()?ht().zF(g,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:s}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[a,g,s]),W=(0,r().K8)((()=>"title"===a.normalizedFormatStore.state.table_subitem_toggle_column),[a]),[G,q]=(0,n.useState)({hasInverseRelation:!0,inverseName:U,autoRelate:{enabled:!1}}),[Y,$]=(0,n.useState)(0===F.length),Z=(0,r().uB)(void 0,vt().A),X=(0,r().O$)(Z),te=(0,n.useCallback)((()=>ht().uu(a,j)),[a,j]),ne=(0,n.useCallback)((e=>{if(e){const t=j[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=j[e];if(t&&G){const e=t.name;q({hasInverseRelation:null==G?void 0:G.hasInverseRelation,inverseName:e,autoRelate:null==G?void 0:G.autoRelate})}}N(t.name)}}}),[j,G,N]),ie=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;v?(0,Ai().b0)(t.getFormat().table_subitem_toggle_column)&&u().zA({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n}):x&&Mu().Tq({collectionViewStore:t,newProperty:o,transaction:n})}),[v,x]),re=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:o}=e;v&&ct().zt({environment:m,collectionContextStore:a,relationPropertyId:t,transaction:o}),x&&Mu().L_({collectionContextStore:a,relationPropertyId:t,transaction:o})}),[v,x,m,a]),ae=(0,n.useCallback)((e=>{const t=a.collectionViewStore();t&&(p().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,canUndo:!0,perform:o=>{ie({collectionViewStore:t,newProperty:e,transaction:o}),re({relationPropertyId:e,transaction:o})}}),ne(e),$(!1),d().os({collectionSettingsStore:l}),(0,qt().X)({action:v?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:a}))}),[a,m,$,ne,l,v,ie,re]),le=(0,n.useCallback)((e=>{const t=a.collectionViewStore();t&&(p().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,canUndo:!0,perform:o=>{ie({collectionViewStore:t,newProperty:e,transaction:o})}}),ne(e),$(!1),d().os({collectionSettingsStore:l}),(0,qt().X)({action:v?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:a}))}),[a,m,ne,l,v,ie]),se=(0,n.useCallback)((()=>{nt().default.afterNextFlush((()=>{$(!0),q({hasInverseRelation:!0,inverseName:H,autoRelate:{enabled:!1}}),N(E)}))}),[H,E]),ce=(0,n.useCallback)((()=>{if(!G)return;const{hasInverseRelation:e,inverseName:t,autoRelate:o}=G,n=a.collectionStore(),i=n,r=a.collectionViewStore();n&&i&&(p().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,canUndo:!0,perform:l=>{const c=st().IL({environment:m,collectionStore:n,collectionViewArgs:r&&f?{collectionViewStore:r,format:r.getFormat(),formatKey:f}:void 0,propertyType:"relation",transaction:l});return Ws().cT({environment:m,collectionContextStore:a,collectionStore:n,property:c,propertyName:z,targetCollectionStore:i,hasInverseRelation:e,inverseName:t,autoRelate:o,propertyLimit:y,intl:g,transaction:l,from:s}),r&&(ie({collectionViewStore:r,newProperty:c,transaction:l}),re({relationPropertyId:c,transaction:l})),c}}),d().yl({collectionSettingsStore:l}),d().a2({collectionSettingsStore:l,item:{type:"main"}}),(0,_u().Z)({environment:m,collectionContextStore:a,from:s,property_type:"relation"}))}),[a,m,l,f,g,y,z,G,s,ie,re]),de=(0,n.useCallback)((()=>{const e=a.collectionViewStore();e&&(Yt().jP({environment:m,collectionViewStore:e,currentValue:a.normalizedFormatStore.state.table_subitem_toggle_column}),(0,qt().X)({environment:m,collectionContextStore:a,action:"toggle_table_subitem_toggle_on_title"}))}),[a,m]),ue=!V.canConfigureBlock,pe=(0,S().IS)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12},existingRelationButton:{margin:"6px 12px 6px 12px",width:"auto"}})),[]);if(!A)return null;const ge=v&&V.canConfigureBlock&&O,me=V.canConfigureCollection,fe=(e,t,n,i)=>(0,w.jsx)(o(148079).A,{version:"v1",menuProps:e,property:t,defaultProperty:R,checkState:n,propertySchema:i,collectionContextStore:a,handleDefaultPropertySelect:ae,handlePropertySelect:le});return(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{...(0,St().mv)({feature:s,databaseType:C})}),footer:(0,w.jsxs)(oe().A,{topBorder:F.length>0&&!Y,children:[ge&&!Y&&(0,w.jsx)(Qt().A,{showImage:!ue,caption:bo().A.formatMessage(St().Ic.toggleNestingOnTitleMenuItemTooltip),tooltipImage:h().A.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,w.jsx)(yl().A,{...e,icon:e=>Gt({width:b().Ev.sm,height:b().Ev.sm,marginLeft:4,marginRight:2}),title:(0,w.jsx)(B().sA,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),switcherProps:{disallowTabbing:!0,on:W},disabled:ue,onClick:de,isGray:!0})}),me&&F.length>0&&!Y&&(0,w.jsx)(D().A,{icon:io().W,title:(0,w.jsx)(B().sA,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:se}),!Y&&(0,w.jsx)(w.Fragment,{children:V.canConfigureBlock&&!V.canConfigureCollection?(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>le(void 0)}):V.canConfigureBlock&&(0,w.jsx)(Q().Ay,{popupType:c.isPhone?ee().nl.SlideUp:ee().nl.Popup,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,originGap:0,renderOrigin:e=>(0,w.jsx)(w.Fragment,{children:!(!V.canConfigureBlock||!T)&&(0,w.jsx)(D().A,{isGray:!0,icon:P().I,title:(0,w.jsx)(B().sA,{...(0,St().Pf)({feature:s,databaseType:C})}),isRed:!0,...e})}),render:e=>{let t;return t=c.isPhone?{menuType:fl().gu.ActionSheet}:{menuType:fl().gu.Popup,width:300},(0,w.jsx)(J().A,{...t,footer:(0,w.jsxs)(oe().A,{topBorder:!0,children:[V.canConfigureBlock&&(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>le(void 0)}),V.canConfigureCollection&&(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{ae(void 0)}})]})})}})})]}),children:[v&&(0,w.jsx)(jt,{propertyName:z||E,inversePropertyName:(null==G?void 0:G.inverseName)||H,subitemsDisplayMode:I}),x&&(0,w.jsx)(Rp,{propertyName:z||E}),!Y&&(0,w.jsx)("div",{style:pe.useExistingTitle,children:(0,w.jsx)(B().sA,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),F.length>0&&!Y?(0,w.jsx)("div",{style:{paddingBottom:"6px"},children:(0,w.jsx)(oe().A,{children:(0,w.jsx)(Q().Ay,{buttonPopupStore:Z,render:e=>{let t;return t=c.isPhone?{menuType:fl().gu.ActionSheet}:{menuType:fl().gu.Popup,width:300},(0,w.jsx)(J().A,{...t,footer:(0,w.jsx)(Uu().A,{schema:j,format:_,getProperties:te,onAccept:V.canConfigureBlock&&!V.canConfigureCollection?le:Ai().lQ,inputPlaceholder:bo().A.formatMessage(v?Vp.subitemInputPlaceholder:Vp.timelineArrowsByInputPlaceholder),currentProperty:T,defaultShowPropertyCount:5,renderProperty:V.canConfigureBlock&&!V.canConfigureCollection?void 0:fe})})},renderOrigin:e=>{var t;return(0,w.jsx)(D().A,{title:(0,w.jsx)(B().sA,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:T?null===(t=j[T])||void 0===t?void 0:t.name:void 0,rotateChevron:X.open,disabled:!1,icon:o(365683).H,...e})},popupType:c.isPhone?ee().nl.SlideUp:ee().nl.Popup,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,originGap:0})})}):me&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{children:(0,w.jsx)("div",{style:pe.emptyStateText,children:(0,w.jsx)(B().sA,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,w.jsx)(oe().A,{children:(0,w.jsx)(xo().Ay,{value:z,placeholder:z,onChange:e=>N(e.target.value),onBlur:Ai().lQ,onSubmit:Ai().lQ,focusInitial:!0,selectAll:!1})}),(0,w.jsx)(Qs,{collectionContextStore:a,targetCollectionStore:A,property:void 0,temporaryInverseState:G,setTemporaryInverseState:q,onSubmit:ce}),F.length>0&&(0,w.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,w.jsx)(Oo().p,{onClick:()=>{nt().default.afterNextFlush((()=>{$(!1)}))},isGray:!0,style:pe.existingRelationButton,children:(0,w.jsx)(B().sA,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})}));var Kp=()=>o(846141);function Dp(e){let{context:t,collectionContextStore:o,collectionSettingsStore:n,fullHeight:a,hideDesktopHeader:l}=e;const s=(0,i().v3)(),[c,u,p,g,m,f]=(0,r().K8)((()=>[o.collectionViewStore(),(0,ft().gv)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopesStore.state,Lp(o)]),[o]),y=t===Nr().Bd.ViewSettings&&u;return c?(0,w.jsx)(K().Ay,{collectionSettingsStore:n,fullHeight:a,hideDesktopHeader:l,title:(0,w.jsx)(B().sA,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:y&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{paddingTop:24}}),(0,w.jsx)(oe().A,{topBorder:!0,children:(0,w.jsx)(Op,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,w.jsx)(Kp().A,{collectionContextStore:o,schema:p,format:g,sorts:f,disabled:!m.canConfigureBlock,parentStore:c,onChange:e=>function(e,t,o){!function(e,t,o){const n=t.collectionViewStore();if(!n)return;Nu().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:e}}})}(e,o,t)}(e,s,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===Nr().Bd.FilterBar&&d().os({collectionSettingsStore:e})}(n,t)})}):null}function Lp(e){return e.currentSortsStore.state}function Op(e){let{collectionContextStore:t}=e;return(0,w.jsx)(ap().Ay,{context:ap().$J.SettingsSort,collectionContextStore:t})}const Ep=2e4,zp=100;var Np=()=>o(792071),Up=()=>o(979340);var Hp=()=>o(72135);const Wp={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function Gp(e){let{collectionContextStore:t}=e;const a=(0,B().tz)(),{isMobile:l}=(0,i().Y0)(),s=(0,S().IS)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:l?4:8},warningIcon:{fill:(0,an().k5)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[l]),c=(0,r().K8)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),d=(0,r().K8)((()=>fn().default.state.currentSpaceStore),[]),u=(0,r().K8)((()=>function(e){if(!e)return Ep;const t=Np().Bj6.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,Up().dL)(t.getSubscriptionTier())?zp:Ep}(null==d?void 0:d.getModel())),[d]),p=(0,r().K8)((()=>(0,Up().dL)(null==d?void 0:d.getSubscriptionTier())),[d]),g=(0,n.useMemo)((()=>(0,w.jsx)(o(101981).A,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:Wp,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const o={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(u,t.aggregationResult.value)};return(0,Hp().ZV)(o.value,"number_with_commas",a)}})),[t,a,u]);return(0,w.jsx)(zr().A,{title:(0,w.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c&&d&&p&&(0,w.jsx)(ao().A,{placement:so().W.Left,alignment:so().C.Center,renderTooltip:()=>(0,w.jsx)(B().sA,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,w.jsx)("div",{...e,children:(0,bd().Q)(s.warningIcon)})}),(0,w.jsx)(B().sA,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,w.jsx)(B().sA,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:g,limit:(0,Hp().ZV)(u,"number_with_commas",a)}}),style:s.menuItem})}const qp=n.memo(Gp,pi().A);var Yp=()=>o(796073);function $p(e){let{collectionContextStore:t}=e;const a=(0,i().v3)(),{isMobile:l}=a.device,s=(0,S().IS)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:l?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[l]),c=(0,r().K8)((()=>t.collectionStore()),[t]),[u,p]=(0,r().K8)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[c]),g=(0,r().K8)((()=>fn().default.state.currentSpaceStore),[]),m=(0,r().K8)((()=>{var e;const o=t.numberChildrenUnfurledStore.state,n=t.numberChildrenReceivedStore.state,i=o/n,r=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&n&&i<1&&!l||r&&l}),[t,l]),f=(0,r().K8)((()=>{const e=g&&(0,Up().dL)(g.getSubscriptionTier());return{defaultMessage:e?"Clear and sync database":"Sync database",description:e?"Clears and refreshes the database ":"Refreshes the synced database."}}),[g]),[y,h]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{if(u&&p){const e=`${p}:${u}`,t=o(763884).A.get({userId:a.currentUser.id,key:e});h(t)}}),[p,a,u]);const v=!y||y<Date.now();return u&&p?m?(0,w.jsx)(zr().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,Yp().$)(s.menuItemIcon,"sync-spinner"),style:s.menuItem}):v?(0,w.jsx)(D().A,{isGray:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:f.defaultMessage,description:f.description}}),icon:Yp().$,onClick:async()=>{const e=null==c?void 0:c.id,t=!0===(null==c?void 0:c.getFormat().stale);e&&await d().cJ({environment:a,uri:u,botId:p,collectionId:e,nextSync:y,setNextSync:h,isStale:t})}}):(0,w.jsx)(zr().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,o(907514).OH)(Date.now(),y)}}),icon:(0,o(210314).u)(s.menuItemIcon),style:s.menuItem}):null}const Qp=n.memo($p,pi().A);function Zp(e){var t;let{collectionContextStore:n}=e;const a=(0,i().v3)(),{isMobile:l}=a.device,s=(0,S().IS)((()=>({menuItemTitle:{paddingLeft:l?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[l]),c=(0,r().K8)((()=>n.collectionStore()),[n]),[d,u,p]=(0,r().K8)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[c]),g=null==c||null===(t=c.pointer)||void 0===t?void 0:t.spaceId,m=(0,r().K8)((()=>(0,o(252833).fH)(p,g)),[g,p]),f=(0,r().K8)((()=>n.collectionViewBlockStore()),[n]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,w.jsx)(ao().A,{placement:so().W.Left,alignment:so().C.Center,renderTooltip:()=>f&&(0,w.jsx)(o(706965).A,{store:f,compactFormat:!0}),render:e=>(0,w.jsx)(zr().A,{...e,title:m,icon:(0,w.jsx)(vn().A,{disabled:!0,icon:null==c?void 0:c.getIcon(),isEmptyPage:!1,size:20,style:s.menuItemIcon}),style:s.menuItemTitle})}),style:{paddingBottom:0}}),(0,w.jsx)(oe().A,{children:(0,w.jsx)(qp,{collectionContextStore:n})}),(0,w.jsxs)(oe().A,{topBorder:!0,children:[(0,w.jsx)(Qp,{collectionContextStore:n}),(0,w.jsx)(D().A,{isGray:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:Os().n,onClick:async()=>{const e=await cn().R.clipboardActions.load(),t={uri:d,botId:u,spaceId:g};e.copyString({environment:a,stringValue:JSON.stringify(t,null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}}),(0,w.jsx)(Z().A,{href:`${o(780054).A.domainBaseUrl}?target=connected_apps`,children:(0,w.jsx)(D().A,{icon:o(262462).M,title:(0,w.jsx)(B().sA,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,w.jsx)(wr().A,{href:(0,Cr().xS)("guides.syncedDatabases"),title:(0,w.jsx)(B().sA,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const Jp=n.memo(Zp,pi().A);function Xp(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,a=(0,i().v3)(),[l,s]=(0,r().K8)((()=>{var e;return[t.collectionViewBlockStore(),Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore())]}),[t]),c=(0,n.useMemo)((()=>ui().default.createValue("")),[]);return l?(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>d().os({collectionSettingsStore:o}),children:s?(0,w.jsx)(Jp,{collectionContextStore:t}):(0,w.jsx)(Ui,{collectionContextStore:t,parentStore:l,onAccept:e=>function(e,t,o,n){p().createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,canUndo:!0,perform:t=>{ri({collectionContextStore:o,source:{type:"collection",id:e.id,spaceId:e.getSpaceId()},transaction:t})}}),d().yl({collectionSettingsStore:n})}(e,a,t,o),context:Nr().U9.Source,inputStore:c})}):null}const eg=n.memo(Xp);var tg=()=>o(451306);function og(e){let{subscriptionTier:t,analyticsName:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>(0,Na().s7)(n)),[n]),l=(0,S().IS)((e=>({container:{margin:"8px 14px",padding:"8px 12px",borderRadius:8,border:`1px solid ${e.stroke.secondary}`,color:e.text.primary,fontSize:14,lineHeight:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},nonWorkspaceAdmin:{border:"unset",backgroundColor:e.lightGrayButtonBackground}})),[]);return(0,w.jsx)(Lo().A,{...(0,tg().AH)(l.container,!a&&l.nonWorkspaceAdmin),onClick:()=>{Ea().K(n,{from:o,upsell:{type:"product",product:t,limit:{type:"none"}}})},disabled:!a,children:a?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(B().sA,{id:"upsellBannerButton.title.workspaceAdmin",defaultMessage:"Upgrade to unlock"}),(0,w.jsx)(ou().A,{subscriptionTier:t,analyticsName:o,desktopStyle:{marginLeft:8},disableTooltip:!0})]}):(0,w.jsx)(B().sA,{id:"upsellBannerButton.title.nonWorkspaceAdmin",defaultMessage:"Contact your workspace owner to upgrade to unlock this feature"})})}var ng=()=>o(58488),ig=()=>o(173215),rg=()=>o(246722),ag=()=>o(792540);function lg(e){let{formBlockStore:t,disabled:o}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(sg,{formBlockStore:t,disabled:o}),(0,w.jsx)(cg,{formBlockStore:t,disabled:o})]})}function sg(e){let{formBlockStore:t,disabled:o}=e;const n=(0,r().K8)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_title")),[t]);return(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.customizeConfirmationScreen.title",defaultMessage:"Confirmation title"}),style:{paddingBottom:8},children:(0,w.jsx)(dg,{formBlockStore:t,disabled:o,textStore:n,settingName:"custom_confirmation_screen_title"})})}function cg(e){let{formBlockStore:t,disabled:o}=e;const n=(0,r().K8)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_body")),[t]);return(0,w.jsx)(oe().A,{title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.customizeConfirmationScreen.body",defaultMessage:"Confirmation body"}),style:{paddingBottom:12},children:(0,w.jsx)(dg,{formBlockStore:t,disabled:o,textStore:n,textarea:!0,settingName:"custom_confirmation_screen_body"})})}function dg(e){let{formBlockStore:t,disabled:o,textStore:a,textarea:s,settingName:c}=e;const d=(0,i().v3)(),u=(0,S().IS)((e=>({input:{fontSize:14,lineHeight:"20px",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",padding:"3px 6px",margin:"0 8px",width:"auto",overflow:"hidden",height:s?68:28,textWrap:s?"wrap":"nowrap",opacity:o?.4:1}})),[s,o]),p=(0,r().K8)((()=>t.getSpaceId()),[t]),g=(0,Ai().sg)((0,n.useCallback)((()=>{(0,l().u4)({environment:d,event:{eventName:"form_settings_changed",eventProperties:{form_id:t.id,form_setting:c}}})}),[t.id,d,c]),1e3),m=(0,ig().x)({textStore:a,parentStore:t,spaceId:p,disabled:!0});return o?(0,w.jsx)("div",{style:u.input,children:m}):(0,w.jsx)(rg().A,{disabled:o,store:a,pasteBehavior:"inline",inPageFind:ag().Os.none,style:u.input,disabledMentionTypes:{page:!1,date:!1,user:!0,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0},disableSlashCommands:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableEnter:!0,disableHorizontalEdgeScroll:!0,disableEquationInteraction:!0,disableTemplateVariableMentions:!0,disableFilters:!0,disableRightMarginHoverStyling:!0,disableSuggestEdit:!0,disableShiftEnter:!0,onChange:g,onTab:Ai().D_,onUntab:Ai().D_})}const ug={viewBox:"0 0 20 20",svg:(0,w.jsx)("path",{d:"M10 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6"})},pg=(0,b().wt)("dotFill",ug);var gg=()=>o(594952);const mg={viewBox:"0 0 20 20",svg:(0,w.jsx)("path",{fillRule:"evenodd",d:"m8.793 12.35 1.124 3.042a.625.625 0 1 0 1.173-.434L7.352 4.846a.988.988 0 0 0-1.854 0L1.761 14.958a.625.625 0 1 0 1.172.434l1.124-3.042zm-.462-1.25L6.425 5.943 4.52 11.1zm9.322-2.381c.345 0 .625.28.625.625v5.83a.625.625 0 1 1-1.25 0v-.204a3.26 3.26 0 0 1-2.21.83c-.903 0-1.742-.342-2.353-.98s-.961-1.537-.961-2.592.35-1.943.968-2.567c.616-.623 1.454-.942 2.346-.942.824 0 1.606.272 2.21.802v-.177c0-.345.28-.625.625-.625m-4.9 3.51c0-.774.252-1.33.608-1.69.358-.362.864-.57 1.457-.57s1.107.209 1.472.573c.361.361.616.917.616 1.686 0 1.503-.966 2.322-2.088 2.322-.582 0-1.088-.217-1.45-.595-.362-.377-.614-.952-.614-1.727",clipRule:"evenodd"})},fg=(0,b().wt)("textFormat",mg);var yg=()=>o(769314),Sg=()=>o(377586);const hg=30,vg=(0,B().YK)({submitButtonTextPlaceholder:{id:"formCustomizeSettings.customizeSubmitButton.text.placeholder",defaultMessage:"Submit"}});function xg(e){let{formBlockStore:t,disabled:o}=e;return(0,w.jsxs)(oe().A,{title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.customizeSubmitButton.title",defaultMessage:"Submit button"}),children:[(0,w.jsx)(Cg,{formBlockStore:t,disabled:o}),(0,w.jsx)(bg,{formBlockStore:t,disabled:o})]})}function Cg(e){let{formBlockStore:t,disabled:o}=e;const a=(0,i().Y0)(),{customSubmitButtonColorStore:s,currentColor:c}=(0,r().K8)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_color");return{customSubmitButtonColorStore:e,currentColor:(null==e?void 0:e.getValue())??"gray"}}),[t]),d=(0,w.jsx)(B().sA,{..._n().jd[c]}),u=(0,n.useCallback)((e=>{let{environment:o,color:n}=e;s&&(p().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonColor",environment:o,canUndo:!0,perform:e=>{zn().KY({store:s,value:n,transaction:e})}}),(0,l().u4)({environment:o,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_color",form_id:t.id}}}))}),[s,t.id]),g=(0,S().IS)((e=>({colorLabelWrapper:{display:"flex",alignItems:"center",gap:2},selectedCircle:{height:b().Ev.lg,width:b().Ev.lg,stroke:_n().l8[e.mode][c],fill:_n().l8[e.mode][c]},colorLabel:{fontSize:14,lineHeight:"18px"}})),[c]);return(0,w.jsx)(Q().Ay,{popupType:a.isPhone?Sg().n.SlideUp:Sg().n.Popup,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,disabled:o,originGap:0,renderOrigin:e=>(0,w.jsx)(D().A,{...e,title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.customizeSubmitButton.color",defaultMessage:"Color"}),disabled:o,icon:gg().I,right:(0,w.jsxs)("div",{style:g.colorLabelWrapper,children:[pg(g.selectedCircle),(0,w.jsx)("div",{style:g.colorLabel,children:d})]}),showChevron:!0}),render:e=>(0,w.jsx)(yg().A,{parent:e,currentColor:c,onColorSelected:u}),style:{padding:"5px 0"}})}function bg(e){let{formBlockStore:t,disabled:o}=e;const a=(0,i().v3)(),s=(0,B().tz)(),{customSubmitButtonTextStore:c,currentText:d}=(0,r().K8)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_text");return{customSubmitButtonTextStore:e,currentText:(null==e?void 0:e.getValue())??""}}),[t]),u=(0,n.useCallback)((e=>{c&&(p().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonText",environment:a,canUndo:!0,perform:t=>{zn().KY({store:c,value:e,transaction:t})}}),(0,l().u4)({environment:a,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_text",form_id:t.id}}}))}),[c,a,t.id]),g=(0,Ai().sg)(u,500);return(0,w.jsx)(zr().A,{title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.customizeSubmitButton.text",defaultMessage:"Text"}),icon:fg({width:b().Ev.default,height:b().Ev.default,marginLeft:4}),right:(0,w.jsx)(Pn().B,{disabled:o,initialValue:d,placeholder:s.formatMessage(vg.submitButtonTextPlaceholder),onBlur:u,onSubmit:u,onChange:g,inputOuterStyle:{margin:0,width:160},maxLength:hg,textWrapperStyle:{margin:0}}),style:{padding:"2px 0 2px 4px",lineHeight:"28px"},disabled:o})}function wg(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,i().Y0)(),a=function(){const e=(0,i().v3)(),t=(0,Yn().r)(),o=e.currentUser.id,n=null==t?void 0:t.id;return(0,$n().P9)({name:"form_customization",spaceId:n,userId:o})}(),l=!a,s=(0,r().K8)((()=>t.collectionViewStore()),[t]),c=(0,r().K8)((()=>{if(!s)throw new Error("No CollectionViewStore found");return s.getFormBlockStore()}),[s]);return s&&c?(0,w.jsx)(ng().I,{children:(0,w.jsx)(K().Ay,{collectionSettingsStore:o,title:(0,w.jsx)(B().sA,{id:"formCustomizeSettings.menuTitle",defaultMessage:"Customize"}),menuScrollerStyle:n.isMobile?void 0:{maxHeight:600},children:(0,w.jsxs)("div",{style:{padding:"0 4px 4px"},children:[a?null:(0,w.jsx)(og,{subscriptionTier:"plus",analyticsName:"forms_customize_settings"}),(0,w.jsx)(xg,{formBlockStore:c,disabled:l}),(0,w.jsx)(lg,{formBlockStore:c,disabled:l})]})})}):null}var jg=()=>o(31503),Ag=()=>o(450648),_g=()=>o(894995),Mg=()=>o(348241);const kg=(0,b().wt)("collectionFormCheckboxQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#E3E2E0",rx:"1"}),(0,w.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#E3E2E0",rx:"1"}),(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#E3E2E0",rx:"1"}),(0,w.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),Ig=(0,b().wt)("collectionFormCheckboxQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,w.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,w.jsx)("path",{fill:"#2383E2",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),Tg=(0,b().wt)("collectionFormDateQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2",fillOpacity:"0.57"})]})}),Pg=(0,b().wt)("collectionFormDateQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2"})]})}),Bg=(0,b().wt)("collectionFormEmailQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsx)("g",{children:(0,w.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),Rg=(0,b().wt)("collectionFormEmailQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsx)("g",{children:(0,w.jsx)("path",{fill:"#2383E2",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),Vg=(0,b().wt)("collectionFormFileQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,w.jsx)("path",{fill:"#E3E2E0",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),Fg=(0,b().wt)("collectionFormFileQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#2383E2",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,w.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),Kg=(0,b().wt)("collectionFormMultiSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"#E3E2E0"})]})}),Dg=(0,b().wt)("collectionFormMultiSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"white",fillOpacity:"0.283"})]})}),Lg=(0,b().wt)("collectionFormNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5445 21.979C23.9068 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3697 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9566 17.7202 22.9566 17.269C22.9566 17.0229 23.0045 16.8042 23.1275 16.5649C23.5924 15.5874 24.6861 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5777 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,w.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.969 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7024 17.1802 14.7366 17.064C15.0032 15.9976 16.1858 14.8696 18.1067 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,w.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),Og=(0,b().wt)("collectionFormNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5446 21.979C23.9069 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3698 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9567 17.7202 22.9567 17.269C22.9567 17.0229 23.0045 16.8042 23.1276 16.5649C23.5924 15.5874 24.6862 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5778 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2"}),(0,w.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.9691 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7025 17.1802 14.7366 17.064C15.0032 15.9976 16.1859 14.8696 18.1068 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2"}),(0,w.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2"})]})}),Eg=(0,b().wt)("collectionFormPersonQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"#E3E2E0"}),(0,w.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),zg=(0,b().wt)("collectionFormPersonQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2"})]})}),Ng=(0,b().wt)("collectionFormPhoneNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,w.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#E3E2E0"}),(0,w.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#E3E2E0"})]})}),Ug=(0,b().wt)("collectionFormPhoneNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("path",{fill:"#2383E2",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,w.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"}),(0,w.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"})]})}),Hg=(0,b().wt)("collectionFormRelationQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsx)("g",{children:(0,w.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.2344 16.2773L23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871L23.6816 14.7344L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"#E3E2E0"})})}),Wg=(0,b().wt)("collectionFormRelationQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsx)("g",{children:(0,w.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.1336 18.6198C25.1674 17.8334 24.1964 17.4385 23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871C22.5227 15.7638 22.1325 14.7904 21.3451 14.8189L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"white",fillOpacity:"0.283"})})}),Gg=(0,b().wt)("collectionFormSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"#E3E2E0"})]})}),qg=(0,b().wt)("collectionFormSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"white",fillOpacity:"0.283"})]})}),Yg=(0,b().wt)("collectionFormTextQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,w.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),$g=(0,b().wt)("collectionFormTextQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,w.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2"})]})});const Qg={light:{text:Yg,select:Gg,title:Yg,multi_select:Kg,relation:Hg,date:Tg,person:Eg,file:Vg,number:Lg,checkbox:kg,email:Bg,url:(0,b().wt)("collectionFormUrlQuestionType",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#E3E2E0",rx:"1"}),(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#E3E2E0",rx:"1"}),(0,w.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})}),phone_number:Ng},dark:{text:$g,select:qg,title:$g,multi_select:Dg,relation:Wg,date:Pg,person:zg,file:Fg,number:Og,checkbox:Ig,email:Rg,url:(0,b().wt)("collectionFormUrlQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,w.jsxs)("g",{children:[(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,w.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,w.jsx)("path",{fill:"#2383E2",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})}),phone_number:Ug}},Zg=o(166883).x;function Jg(e){const{style:t,propertyType:o}=e,i="dark"===(0,S().DP)().mode?"dark":"light",a=(0,n.useMemo)((()=>({...t})),[t]);return(0,r().K8)((()=>(0,jg().XO)(o)?Qg[i][o](a):Zg(a)),[o,i,a])}var Xg=()=>o(98205),em=()=>o(630960),tm=()=>o(465741),om=()=>o(38337),nm=()=>o(465425),im=()=>o(978846),rm=()=>o(63667),am=()=>o(478573);function lm(e){const{questionStore:t,name:o}=e,{collectionStore:n}=(0,fs().LH)(),i=(0,r().K8)((()=>{const e=t.getPropertyId();if(!n||!e)return;const o=n.getSchema();return(0,El()._g)({schema:o,property:e})}),[n,t]);if(!i)return null;const a=i.type;return(0,w.jsx)(am().A,{...e,icon:(0,w.jsx)(Jg,{propertyType:i.type}),name:o,subText:Gn().dC[a],disabled:!1})}var sm=()=>o(959733);function cm(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:a,collectionContextStore:l}=e,s=(0,i().Y0)(),c=(0,B().tz)(),{layoutStore:d}=(0,fs().LH)(),u=(0,r().K8)((()=>l.collectionStore()),[l]);return(0,r().K8)((()=>u?(null==d?void 0:d.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:u.getSchema()}))??[]:[]),[d,u]).length>=tm().eb?(0,w.jsx)(K().Ay,{...e,title:c.formatMessage(tm().Gi.questionLimitReachedTitle),children:(0,w.jsx)("div",{style:{padding:16,paddingTop:2,fontSize:12},children:c.formatMessage(tm().Gi.questionLimitReachedSubtitle)})}):(0,w.jsx)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{id:"formQuestionCreateSettings.menuTitle",defaultMessage:"Select type"}),menuScrollerStyle:s.isMobile?void 0:{maxHeight:600},children:(0,w.jsx)(um,{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:a,collectionContextStore:l})})}const dm=(0,B().YK)({showMore:{defaultMessage:"Show {numAdditionalProperties} more",id:"formQuestionCreateSettings.showMore"}});function um(e){const{area:t,moduleId:o,parentModuleId:a,parentConditionalGroupId:l,collectionContextStore:s}=e,[c,d]=(0,n.useState)(!1),u=function(e){const{area:t,collectionContextStore:o,moduleId:n,parentModuleId:a,parentConditionalGroupId:l}=e,s=(0,i().v3)(),{layoutStore:c,collectionStore:d}=(0,fs().LH)(),u=(0,r().K8)((()=>{var e;return Boolean(null===(e=o.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasSitePublicPermission())}),[o]),p=pm({area:t,moduleId:n,parentModuleId:a,parentConditionalGroupId:l,collectionContextStore:o}),g=(0,em().i)({layoutStore:c,collectionStore:d});return(0,r().K8)((()=>{if(!d)return[];const e=d.getSchema(),t=g.map((t=>{const o=(0,El()._g)({schema:e,property:t});if(!o)return;const n=(0,tm().CK)({environment:s,propertyType:o.type,propertySchema:o,isPublicForm:u});let i=null;return"invalid_property_type_for_public_form"===n?i=(0,w.jsx)(B().sA,{...em().y.unsupportedPublicQuestionType}):"related_collection_not_public"===n&&(i=(0,w.jsx)(B().sA,{...em().y.relatedCollectionNotPublic})),{key:t,keywords:[o.name],render:e=>{let{ref:o,...r}=e;return(0,w.jsx)("div",{style:{width:"100%"},children:(0,w.jsx)(rm().k,{...r,propertyId:t,tooltip:i,disabled:Boolean(n)})})},action:()=>{p({type:"existingProperty",propertyId:t})}}})).filter(W().O9);return t}),[d,g,s,u,p])}({area:t,collectionContextStore:s,moduleId:o,parentModuleId:a,parentConditionalGroupId:l}),g=function(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:a,collectionContextStore:l}=e,s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return Boolean(null===(e=l.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasSitePublicPermission())}),[l]),d=pm({area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:a,collectionContextStore:l}),u=(0,sm().g)({actionHandler:e=>d({type:"newProperty",propertyType:(0,mo().v2)(e)}),renderIcon:e=>(0,w.jsx)(Jg,{propertyType:(0,mo().v2)(e)}),tooltip:e=>{if("invalid_property_type_for_public_form"===(0,tm().CK)({environment:s,propertyType:(0,mo().v2)(e),isPublicForm:c}))return{image:void 0,caption:em().y.unsupportedPublicQuestionType}},disabled:e=>{const t=(0,tm().CK)({environment:s,propertyType:(0,mo().v2)(e),isPublicForm:c});return Boolean(t)}});return(0,r().K8)((()=>jg().m3.filter((e=>"select"!==e)).map((e=>{if("relation"!==e&&(0,jg().XO)(e))return"title"!==e?u(e):void 0})).filter(W().O9)),[u])}({area:t,moduleId:o,parentModuleId:a,parentConditionalGroupId:l,collectionContextStore:s}),m=function(e,t,o){const a=(0,i().v3)(),{layoutStore:l,collectionStore:s,setModuleSelection:c,sessionId:d}=(0,fs().LH)(),u=(0,r().K8)((()=>l.getModules()),[l]),g=(0,r().K8)((()=>[...u.form_layout_schema,...Object.values(u.form_conditional_modules??{})].filter((e=>"formQuestion"===e.type))),[u]),m=(0,r().K8)((()=>(0,jg().Cg)({moduleId:o??e,modulesByArea:u})),[u,e,o]),f=o?m.length-1:m.length,y=(0,n.useCallback)((e=>{const o=e.parentConditionalGroupId===t,n=m.includes(e.id),i=(0,Xg().Yg)({currentModule:e,nestedModules:u.form_conditional_modules||{},includePlaceholders:!0}).maxDepth+f>jg().mh;return!o&&!n&&!i}),[t,m,u,f]),S=(0,n.useCallback)((o=>{void 0!==t&&void 0!==e&&(p().createAndCommit({userAction:"FormQuestionCreateSettings.moveExistingQuestion",canUndo:!0,environment:a,perform:n=>{(0,im().E)({position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:t,parentModuleId:e},moduleId:o.id,environment:a,layoutStore:l,transaction:n,sessionId:d})}}),c({type:"existing_module",moduleId:o.id,isDragging:!1}))}),[a,t,e,l,c,d]);return(0,r().K8)((()=>{if(!s)return[];const e=g.filter(y).map((e=>{const t=Y().c7.createChildStore(l,{table:"form_question",id:e.formQuestionId,spaceId:l.getSpaceId()??""});if(void 0===t)return;const o=(0,Ag().r4)({textValue:t.getNameStore().getValue(),getRecordModel:t.getRecordModel,deterministic:!0,userTimeZone:(0,Tu().P)(),intl:bo().A.getIntl()});return{key:t.id,keywords:[o],render:e=>{let{ref:n,...i}=e;return(0,w.jsx)("div",{style:{width:"100%"},children:(0,w.jsx)(lm,{...i,name:o,questionStore:t})})},action:()=>{S(e)}}})).filter(W().O9);return e}),[s,S,g,l,y])}(a,l,o),f=(0,S().IS)((e=>({showMoreIcon:{width:16,height:16,marginLeft:4,marginRight:4,fill:e.lightIconColor},showMoreButton:{height:42,color:e.lightTextColor,marginLeft:0}})),[]),y=function(e){const{key:t,title:o,items:n,limit:i}=e,r={key:"show-more",keywords:[],action:()=>{},render:e=>(0,w.jsx)($().A,{...e,id:om().v4C,icon:(0,wi()._)({...f.showMoreIcon}),title:bo().A.formatMessage(dm.showMore,{numAdditionalProperties:i?n.length-i:n.length}),desktopIconStyle:{marginLeft:7,marginRight:5},style:f.showMoreButton,onClick:e=>{d(!0),e.stopPropagation()}})},a=void 0!==i&&n.length>i,l=[...a?n.slice(0,i):n,...a?[r]:[]];return{key:t,render:e=>(0,w.jsx)(oe().A,{title:o,...e,style:{display:"flex",flexDirection:"column",alignItems:"center",paddingLeft:"8px",paddingRight:"8px",paddingTop:"new-properties"===t&&u.length>0?8:0,paddingBottom:0},desktopTitleStyle:{alignSelf:"flex-start",paddingLeft:"8px"}}),items:l}},h=c?void 0:5,v=y({key:"existing-properties",title:(0,w.jsx)(B().sA,{id:"formQuestionCreateSettings.existingPropertiesSectionTitle",defaultMessage:"Existing properties"}),items:u,limit:h}),x=y({key:"new-properties",title:u.length>0||m.length>0?(0,w.jsx)(B().sA,{id:"formQuestionCreateSettings.newPropertiesSectionTitle",defaultMessage:"New question"}):void 0,items:g}),C=y({key:"existing-questions",title:m.length>0?(0,w.jsx)(B().sA,{id:"formQuestionCreateSettings.existingQuestionsSectionTitle",defaultMessage:"Existing questions"}):void 0,items:m});return(0,w.jsx)(oe().A,{children:(0,w.jsx)(X().Ay,{initialFocus:0,type:X().Oh.Vertical,sections:[...m.length>0&&void 0!==a&&void 0!==l?[C]:[],...u.length>0?[v]:[],...g.length>0?[x]:[]]})})}function pm(e){const{area:t,moduleId:o,parentModuleId:a,parentConditionalGroupId:l,collectionContextStore:s}=e,c=(0,i().v3)(),{layoutStore:d,collectionStore:u,setModuleSelection:g,sessionId:m}=(0,fs().LH)(),{autofocusedQuestionTextStore:f,formAddConditionalLogicTooltipStore:y}=(0,Mg().cJ)(),S=(0,vi().X)("forms_conditional_logic"),{currentUserSettingsStore:h}=(0,r().K8)((()=>fn().default.state),[]);return(0,n.useCallback)((e=>{p().createAndCommit({userAction:"FormQuestionCreateSettings.createFormQuestion",environment:c,canUndo:!0,undoCheckpoint:`form_layout_new_question_${o}`,perform:n=>{if(!u)throw new Error("Collection store not found");const i=(()=>{if("existingProperty"===e.type)return e.propertyId;const t=e.propertyType;return st().IL({environment:c,collectionStore:u,collectionViewArgs:void 0,propertyName:Gn().dC[t],propertyType:t,transaction:n})})(),r=(()=>{if("existingProperty"===e.type){const e=u.getSchema()[i];return null==e?void 0:e.type}return e.propertyType})();if(!("form_conditional_modules"!==t||a&&l))throw new Error("Parent module ID and parent conditional group ID are required for nested modules");const{updatedModuleId:p,formQuestionId:v}=(0,_g().createFormQuestionAndUpdateOrCreateModule)({environment:c,transaction:n,layoutStore:d,moduleId:o,propertyId:i,initialQuestionTitle:(()=>{if("existingProperty"===e.type){const e=u.getSchema()[i];return e?e.name:""}{const t=e.propertyType;if((0,jg().XO)(t)&&"select"!==t)return tm().mY[t]}})()??"",shouldSyncQuestionNameToPropertyName:"newProperty"===e.type,collectionContextStore:s,autofocusTitle:{shouldAutofocus:!0,autofocusedQuestionTextStore:f},sessionId:m,..."form_conditional_modules"===t&&a&&l?{area:t,parentModuleId:a,parentConditionalGroupId:l}:{area:"form_layout_schema"}});g({type:"existing_module",moduleId:p,isDragging:!1});const x=null==h?void 0:h.getSettingsStore().getKeyStore("seen_forms_add_conditional_logic_tooltip").getValue();"checkbox"===r&&S&&!x&&y.setState({openTooltip:(0,Xg().fY)({formQuestionId:v})})}}),S&&nm().HH(c,Xg().wG)}),[c,m,u,d,o,s,f,t,a,l,g,S,y,h])}const gm=function(e){return(0,w.jsx)(ng().I,{children:(0,w.jsx)(cm,{...e})})};var mm=()=>o(665589),fm=()=>o(419178),ym=()=>o(566534),Sm=()=>o(655923),hm=()=>o(112282),vm=()=>o(638045);const xm={viewBox:"0 0 20 20",svg:(0,w.jsx)("path",{d:"M10 3.075c.345 0 .625.28.625.625v5.217l4.518-2.608a.625.625 0 1 1 .625 1.082L11.25 10l4.518 2.609a.625.625 0 0 1-.625 1.082l-4.518-2.609V16.3a.625.625 0 0 1-1.25 0v-5.218l-4.518 2.61a.625.625 0 1 1-.625-1.083l4.518-2.61-4.518-2.608a.625.625 0 1 1 .625-1.082l4.518 2.608V3.7c0-.345.28-.625.625-.625"})},Cm=(0,b().wt)("asterisk",xm),bm={viewBox:"0 0 20 20",svg:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("g",{clipPath:"url(#clip0_9869_14376)",children:(0,w.jsx)("path",{d:"M6.25 3.125a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25M4.375 6.25a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0m1.875 4.375a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25M4.375 13.75a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0m6.25-7.5a3.125 3.125 0 1 1 6.25 0 3.125 3.125 0 0 1-6.25 0m3.125-1.875a1.875 1.875 0 1 0 0 3.75 1.875 1.875 0 0 0 0-3.75m0 6.25a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25m-1.875 3.125a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0"})}),(0,w.jsx)("defs",{children:(0,w.jsx)("clipPath",{id:"clip0_9869_14376",children:(0,w.jsx)("path",{d:"M0 0h20v20H0z"})})})]})},wm=(0,b().wt)("circleGrid2X2",bm);var jm=()=>o(274570),Am=()=>o(62616),_m=()=>o(765974),Mm=()=>o(813197),km=()=>o(524060);const Im={viewBox:"0 0 20 20",svg:(0,w.jsx)("path",{d:"M12.718 4.625H6.313a3 3 0 0 0 0 6h7.562a1.75 1.75 0 1 1 0 3.5H7.282a2.126 2.126 0 1 0 0 1.25h6.593a3 3 0 1 0 0-6H6.313a1.75 1.75 0 1 1 0-3.5h6.405a2.126 2.126 0 1 0 0-1.25m1.157.625a.875.875 0 1 1 1.75 0 .875.875 0 0 1-1.75 0"})},Tm=(0,b().wt)("pathRoundEnds",Im);var Pm=()=>o(467248),Bm=()=>o(42583),Rm=()=>o(500993),Vm=()=>o(475140),Fm=()=>o(251822),Km=()=>o(832857),Dm=()=>o(802975);function Lm(e){const{environment:t,questionStore:o,autofocusedQuestionTextStore:n,currValue:i}=e;p().createAndCommit({userAction:"formQuestion.toggleShowDescription",environment:t,canUndo:!0,perform:e=>{const t=!i;p().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","showDescription"],command:"set",args:t},transaction:e}),t||function(e){var t;const{questionStore:o,autofocusedQuestionTextStore:n,transaction:i}=e;void 0===(null===(t=o.getConfig())||void 0===t?void 0:t.description)&&p().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","description"],command:"set",args:(0,U().x9d)("")},transaction:i});n.autofocusQuestionDescription({questionId:o.id})}({questionStore:o,autofocusedQuestionTextStore:n,transaction:e})}})}var Om=()=>o(536308),Em=()=>o(248064),zm=()=>o(237775);function Nm(e){let{children:t}=e;return(0,w.jsx)(ao().A,{renderTooltip:()=>(0,w.jsx)(B().sA,{id:"FormSettingsNameSyncTooltip.tooltip",defaultMessage:"Renaming a question also renames its linked database property. Disable to keep names separate."}),placement:so().W.Left,alignment:so().C.Center,textWrap:!0,render:e=>(0,w.jsx)("div",{...e,children:t})})}function Um(e){let{tooltipState:t,disableTooltip:o,children:i}=e;const r=(0,n.useMemo)((()=>{if(!t)return null;switch(t){case"deleted_property":return(0,w.jsx)(B().sA,{id:"FormSettingsComingSoonTooltip.deletedProperty",defaultMessage:"The linked property has been deleted."});case"invalid_property_type":return(0,w.jsx)(B().sA,{id:"FormSettingsComingSoonTooltip.invalidProperty",defaultMessage:"The linked property is an unsupported type."});case"invalid_property_type_for_public_form":return(0,w.jsx)(B().sA,{...em().y.unsupportedPublicQuestionType});case"related_collection_not_public":return(0,w.jsx)(B().sA,{...em().y.relatedCollectionNotPublic});case"generic_error":return(0,w.jsx)(B().sA,{id:"FormSettingsErrorTooltip.genericError",defaultMessage:"There is an issue with this linked property."});default:(0,W().HB)(t)}}),[t]);return(0,w.jsx)(ao().A,{renderTooltip:()=>r,disableTooltip:o,placement:so().W.Left,render:e=>(0,w.jsx)("div",{...e,children:i})})}function Hm(e){const{collectionContextStore:t,collectionSettingsStore:o,formQuestionId:n,moduleId:a}=e,l=(0,i().v3)(),{collectionViewStore:s,formBlockStore:c}=(0,r().K8)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]),d=(0,r().K8)((()=>{if(!s)throw new Error("no collectionViewStore found");const e=s.getSpaceId();if(!e)throw new Error("no spaceId found");return zm().c.createChildStore(s,{table:"form_question",id:n,spaceId:e})}),[s,n]),u=(0,r().K8)((()=>{var e;return null===(e=d.getConfig())||void 0===e?void 0:e.propertyId}),[d]),p=(0,r().K8)((()=>{if(!u)return;return t.normalizedSchemaStore.state[u]}),[t.normalizedSchemaStore,u]),g=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state;return d?d.getQuestionErrorState(l,e,null==c?void 0:c.hasSitePublicPermission()):"generic_error"}),[t.normalizedSchemaStore,l,c,d]),m=(0,r().K8)((()=>{if(p)return p.type}),[p]);return u?(0,w.jsx)(ng().I,{children:(0,w.jsxs)(K().Ay,{...e,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.menuTitle",defaultMessage:"Question options"}),children:[(0,w.jsxs)(oe().A,{children:[(0,w.jsx)(qm,{collectionContextStore:t,formQuestionStore:d}),(0,w.jsx)(tf,{collectionContextStore:t,formQuestionStore:d}),(0,w.jsx)(Gm,{collectionContextStore:t,propertySchema:p,formQuestionStore:d})]}),(0,w.jsxs)(oe().A,{topBorder:!0,children:[(0,w.jsx)(Wm,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,propertyId:u,propertyType:m,questionErrorState:g}),(0,w.jsx)(Xm,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,questionErrorState:g}),(0,w.jsx)(Ym,{collectionContextStore:t,formQuestionStore:d})]}),(0,w.jsxs)(oe().A,{topBorder:!0,children:[(0,w.jsx)(rf,{collectionSettingsStore:o,moduleId:a}),(0,w.jsx)(of,{moduleId:a,propertyId:u,propertySchema:p}),(0,w.jsx)(nf,{moduleId:a}),(0,w.jsx)(lf,{collectionSettingsStore:o,collectionContextStore:t,moduleId:a,propertyId:u,propertySchema:p,formQuestionStore:d}),(0,w.jsx)(ef,{collectionSettingsStore:o,collectionContextStore:t,moduleId:a,formQuestionStore:d})]})]})}):null}function Wm(e){let{collectionSettingsStore:t,collectionContextStore:o,formQuestionStore:n,propertyId:a,propertyType:l,questionErrorState:s}=e;const c=(0,i().v3)(),{layoutStore:d}=(0,fs().LH)(),{isCollectionEmpty:u}=(0,Mg().cJ)(),{collectionStore:g,collectionSchema:m,collectionViewStore:f,formatKey:y}=(0,r().K8)((()=>({collectionStore:o.collectionStore(),collectionSchema:o.normalizedSchemaStore.state,collectionViewStore:o.collectionViewStore(),formatKey:o.getPropertyFormatKey()})),[o]),h=(0,r().K8)((()=>l&&(0,jg().XO)(l)?"select"===l?"multi_select":l:"not_found"),[l]),v=(0,r().K8)((()=>s?_m().b:wm),[s]),x=(0,S().IS)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.accentColors.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.accentColors.gray[100]:e.accentColors.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"}})),[]),C=(0,em().i)({layoutStore:d,collectionStore:g}),b=(0,r().K8)((()=>{const e=[];return jg().m3.forEach((t=>{"select"!==t&&e.push({key:t,type:"button",title:tm().mY[t],hideOption:"title"===t&&!C.includes(mo().rn)||"relation"===t,icon:(0,w.jsx)("div",{style:x.iconContainer,children:(0,w.jsx)(Jg,{propertyType:t})})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.questionType.propertyNotFound",defaultMessage:"Not Found"})}),e}),[x.iconContainer,C]),j=(0,r().K8)((()=>null==g?void 0:g.getDatabaseType()),[g]);return g?(0,w.jsx)(Um,{tooltipState:s,disableTooltip:void 0===s,children:(0,w.jsx)(xt().A,{icon:v,options:b,disabled:"not_found"===h||void 0!==j,title:(0,w.jsx)(B().sA,{defaultMessage:"Question type",id:"formQuestionEditSettings.questionType.menuTitle"}),selectedKey:h,menuItemOptionsStyle:{paddingTop:4,paddingBottom:4},onChange:e=>{"not_found"!==e&&((0,tl().V)({environment:c,collectionContextStore:o,property:a,new_property_type:e,from:"form_editor",action:"change_type"}),p().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:c,canUndo:!0,perform:t=>{if(l===mo().rn){const o=st().IL({environment:c,collectionStore:g,propertyType:e,transaction:t,collectionViewArgs:f&&y?{collectionViewStore:f,format:f.getFormat(),formatKey:y}:void 0});zn().KY({store:n.getConfigStore().getKeyStore("propertyId"),value:o,transaction:t})}else e===mo().rn?(zn().KY({store:n.getConfigStore().getKeyStore("propertyId"),value:mo().rn,transaction:t}),u&&(st().BJ({environment:c,collectionStore:g,schema:m,property:a,transaction:t}),t.postSubmitCallbacks.push((e=>{e||Om().formEditorActions.maybeSyncQuestionNameToPropertyName({environment:c,questionStore:n,collectionStore:g,collectionContextStore:o})})))):st().Hj({environment:c,collectionStore:g,property:a,type:e,transaction:t})}}))}})}):null}function Gm(e){const{propertySchema:t,formQuestionStore:o,collectionContextStore:n}=e,i=(0,r().K8)((()=>{const e=null==t?void 0:t.type;if(e&&!(0,jg().XO)(e)||!e)return null;switch(e){case"title":case"text":return(0,w.jsx)(Jm,{formQuestionStore:o,propertyType:e,collectionContextStore:n});case"multi_select":case"relation":case"person":return(0,w.jsx)(Zm,{formQuestionStore:o,propertySchema:t,collectionContextStore:n});case"date":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($m,{formQuestionStore:o,collectionContextStore:n}),(0,w.jsx)(Qm,{formQuestionStore:o,collectionContextStore:n})]});case"select":case"file":case"number":case"checkbox":case"email":case"url":case"phone_number":return(0,w.jsx)(w.Fragment,{});default:(0,W().HB)(e)}}),[n,o,t]);return(0,w.jsx)(w.Fragment,{children:i})}function qm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const a=(0,r().K8)((()=>o.isRequired()),[o]),l=(0,i().v3)(),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;p().createAndCommit({userAction:"formQuestion.toggleRequired",environment:o,canUndo:!0,perform:e=>{p().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","required"],command:"set",args:!n},transaction:e})}})}({environment:l,questionStore:o,currValue:o.isRequired()})}),[l,o]),c=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Required",id:"formQuestionEditSettings.isRequired.title"}),switcherProps:{on:a},icon:Cm,onClick:s,disabled:c})}function Ym(e){let{collectionContextStore:t,formQuestionStore:o}=e;const a=(0,r().K8)((()=>o.shouldSyncQuestionNameToPropertyName()),[o]),l=(0,i().v3)(),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;p().createAndCommit({userAction:"formQuestion.toggleShouldSyncQuestionNameToPropertyName",environment:o,canUndo:!0,perform:e=>{p().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!n},transaction:e})}})}({environment:l,questionStore:o,currValue:o.shouldSyncQuestionNameToPropertyName()})}),[l,o]),c=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(Nm,{children:(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Sync with property name",id:"formQuestionEditSettings.shouldSyncQuestionNameToPropertyName.title"}),switcherProps:{on:a},icon:Tm,onClick:s,disabled:c})})}function $m(e){let{collectionContextStore:t,formQuestionStore:o}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1}),[o]),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;p().createAndCommit({userAction:"formQuestion.changeEndDateSetting",environment:o,canUndo:!0,perform:e=>{p().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","endDate"],command:"set",args:!n},transaction:e})}})}({environment:a,questionStore:o,currValue:l})}),[l,a,o]),c=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"End date",id:"formQuestionEditSettings.date.endDate.title"}),switcherProps:{on:l},icon:Bm().D,onClick:s,disabled:c})}function Qm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.includeTime)??!1}),[o]),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;p().createAndCommit({userAction:"formQuestion.changeIncludeTimeSetting",environment:o,canUndo:!0,perform:e=>{p().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","includeTime"],command:"set",args:!n},transaction:e})}})}({environment:a,questionStore:o,currValue:l})}),[l,a,o]),c=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Include time",id:"formQuestionEditSettings.date.includeTime.title"}),switcherProps:{on:l},icon:jm().y,onClick:s,disabled:c})}function Zm(e){let{collectionContextStore:t,formQuestionStore:o,propertySchema:a}=e;const l=(0,i().v3)(),s=(0,B().tz)(),c=(0,vi().X)("forms_max_selection_custom_options");let d=(0,r().K8)((()=>c?[{key:"unlimited",title:"Unlimited",type:"button"},{key:"1",title:"1",type:"button"},{key:"2",title:"2",type:"button"},{key:"3",title:"3",type:"button"},{key:"4",title:"4",type:"button"},{key:"5",title:"5",type:"button"},{key:"10",title:"10",type:"button"}]:[{key:"unlimited",title:"Unlimited",type:"button"},{key:"1",title:"1",type:"button"}]),[c]);const u=d.map((e=>e.key)),{selectedKey:g,maxSelection:m}=(0,r().K8)((()=>{const e=(0,jg().hm)(a,o.getModel()),t=null==e?void 0:e.toString();let n="custom";return void 0===e?n="unlimited":t&&u.includes(t)&&(n=t),{selectedKey:n,maxSelection:e}}),[o,a,u]),[f,y]=(0,n.useState)("custom"===g?null==m?void 0:m.toString():""),S=(0,n.useCallback)(((e,t,n)=>{let i;switch(e){case"unlimited":i=void 0;break;case"custom":if(!n)return;i=parseInt(n,10);break;default:i=parseInt(e,10)}void 0!==i&&(isNaN(i)||!Number.isInteger(i)||i<1||i>1e3)?y(""):p().createAndCommit({environment:l,userAction:"MaxSelectionComponent.handleUpdateSelection",canUndo:!0,perform:e=>{zn().KY({store:o.getKeyStore("config").getKeyStore("propertyTypeSpecificConfig").getKeyStore(a.type).getKeyStore("maxSelectionCount"),value:i,transaction:e})}})}),[l,o,a.type,y]);function h(e){const t=/[^0-9]/g;t.test(e)&&Ir().D6({label:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.maxSelection.nonNumberWarning",defaultMessage:"Please enter a number."})});const o=e.replace(t,"");y(o)}d=(0,r().K8)((()=>c?[...d,{key:"custom",type:"input",isInput:!0,inputValue:f,onSubmit:S,onChange:h}]:d),[d,S,c,f]);const v=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(ao().A,{textWrap:!0,alignment:so().C.Center,placement:so().W.Left,disableTooltip:!((0,El().bu)(a)&&a.limit),renderTooltip:()=>{if((0,El().bu)(a)&&void 0!==a.limit)return(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.maxSelection.error.tooltip",defaultMessage:"A limit of 1 has been set on the linked property. Please remove the limit on the linked property in order to configure this question's max selection."})},render:e=>(0,w.jsx)(xt().A,{...e,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.maxSelection.title",defaultMessage:"Max selection"}),icon:Mm().L,selectedKey:g,options:d,onChange:S,disabled:v||(0,El().bu)(a)&&void 0!==a.limit,inputPlaceholder:s.formatMessage({id:"formQuestionEditSettings.maxSelection.inputPlaceholder",defaultMessage:"Custom"})})})}function Jm(e){let{collectionContextStore:t,formQuestionStore:o,propertyType:a}=e;const l=(0,r().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig(a))||void 0===e?void 0:e.longAnswer)??!1}),[o,a]),s=(0,i().v3)(),c=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n,propertyType:i}=e;p().createAndCommit({userAction:"formQuestion.changeName",environment:o,canUndo:!0,perform:e=>{p().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig",i,"longAnswer"],command:"set",args:!n},transaction:e})}})}({environment:s,questionStore:o,currValue:l,propertyType:a})}),[l,s,o,a]),d=sf({collectionContextStore:t,formQuestionStore:o});return(0,w.jsx)(yl().A,{title:(0,w.jsx)(B().sA,{defaultMessage:"Long answer",id:"formQuestionEditSettings.longAnswer.title"}),switcherProps:{on:l},icon:mm().l,onClick:c,disabled:d})}function Xm(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:n,questionErrorState:a}=e;const l=(0,S().DP)(),s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=n.getConfig())||void 0===e?void 0:e.propertyId}),[n]),u=(0,r().K8)((()=>{if(!c)return;const e=t.normalizedSchemaStore.state[c];return e?e.name:void 0}),[t.normalizedSchemaStore,c]),{layoutStore:p,collectionStore:g}=(0,fs().LH)(),m=(0,em().i)({layoutStore:p,collectionStore:g}),f=(0,r().K8)((()=>{const e=[];return m.forEach((o=>{const n=t.normalizedSchemaStore.state[o];n&&(0,jg().Sg)(n)&&e.push({key:o,type:"button",title:n.name,icon:(0,w.jsx)(fo().Ay,{type:n.type,theme:l,icon:void 0,size:16,style:{fill:l.regularIconColor}})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.linkedProperty.propertyNotFound",defaultMessage:"Not Found"})}),e}),[l,t.normalizedSchemaStore,m]);return(u||a)&&c?"deleted_property"===a?(0,w.jsx)(xt().A,{disabled:f.every((e=>!0===e.hideOption)),icon:Am().c,title:(0,w.jsx)(B().sA,{defaultMessage:"Linked property",id:"formQuestionEditSettings.linkedProperty.title"}),selectedKey:"not_found",onChange:e=>Om().formEditorActions.remapQuestionToNewProperty({environment:s,formQuestionStore:n,newPropertyId:e}),options:f}):(0,w.jsx)(D().A,{icon:Am().c,title:(0,w.jsx)(B().sA,{defaultMessage:"View linked property",id:"formQuestionEditSettings.viewLinkedProperty.title"}),showChevron:!0,onClick:()=>{d().a2({collectionSettingsStore:o,item:{type:"property",formatKey:void 0,property:c}})}}):null}function ef(e){let{collectionContextStore:t,collectionSettingsStore:o,moduleId:a,formQuestionStore:l}=e;const{layoutStore:s,sessionId:c}=(0,fs().LH)(),{isCollectionEmpty:d}=(0,Mg().cJ)(),u=(0,i().v3)(),g=(0,r().K8)((()=>(0,Vm().Ib)({modulesByArea:s.getModules(),find:e=>a===e.id})),[s,a]),m=(0,n.useCallback)((()=>{void 0!==g&&p().createAndCommit({userAction:"formActions.deleteFormQuestion",environment:u,canUndo:!0,perform:e=>{(0,Dm().B)({environment:u,module:g.module,sessionId:c,layoutStore:s,transaction:e,collectionSettingsStore:o,isCollectionEmpty:d,collectionContextStore:t,area:g.area,updateParentModule:!0})}})}),[t,o,u,d,s,c,g]);return(0,w.jsx)(D().A,{icon:Gl().I,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.deleteQuestion.title",defaultMessage:"Delete question"}),onClick:m})}function tf(e){let{formQuestionStore:t,collectionContextStore:o}=e;const a=(0,i().v3)(),{autofocusedQuestionTextStore:l}=(0,Mg().cJ)(),s=(0,r().K8)((()=>{var e;return Boolean(null===(e=t.getConfig())||void 0===e?void 0:e.showDescription)}),[t]),c=(0,n.useCallback)((()=>{Lm({environment:a,questionStore:t,autofocusedQuestionTextStore:l,currValue:s})}),[l,a,t,s]),d=sf({collectionContextStore:o,formQuestionStore:t});return(0,w.jsx)(yl().A,{icon:Pm().i,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.addDescription.title",defaultMessage:"Description"}),onClick:c,disabled:d,switcherProps:{on:s}})}function of(e){let{moduleId:t,propertyId:o,propertySchema:a}=e;const l=(0,i().v3)(),{layoutStore:s,sessionId:c,setModuleSelection:d}=(0,fs().LH)(),u=(0,vi().X)("forms_conditional_logic"),p=(0,r().K8)((()=>{if(a)return"checkbox"===a.type||"select"===a.type||"multi_select"===a.type?a.type:void 0}),[a]),g=(0,r().K8)((()=>u&&p),[u,p]),m=(0,r().K8)((()=>(0,Rm().A)(t,s.getModules())),[s,t]),f=(0,n.useCallback)((()=>{p&&Km().lF({environment:l,layoutStore:s,currentQuestionModule:m.module,area:m.area,property:o,filterValue:{type:p,value:void 0},setModuleSelection:d,sessionId:c})}),[l,s,m,d,o,c,p]);return g?(0,w.jsx)(D().A,{icon:km().O,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.addConditionalLogic.title",defaultMessage:"Add conditional logic"}),onClick:f}):null}function nf(e){let{moduleId:t}=e;const o=(0,i().v3)(),{layoutStore:a,sessionId:l}=(0,fs().LH)(),s=(0,r().K8)((()=>{var e;if(a)return null===(e=a.getModules().form_conditional_modules)||void 0===e?void 0:e[t]}),[a,t]),c=(0,n.useCallback)((()=>{s&&"formQuestion"===s.type&&Km().Ix({environment:o,layoutStore:a,formQuestionModule:s,sessionId:l})}),[o,a,s,l]);return s?(0,w.jsx)(D().A,{icon:ym().U,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.removeFromConditionalGroup.title",defaultMessage:"Remove from conditional group"}),onClick:c}):null}function rf(e){let{collectionSettingsStore:t,moduleId:o}=e;const n=(0,r().uB)(void 0,vt().A),{layoutStore:i}=(0,fs().LH)(),a=(0,r().K8)((()=>(0,Vm().Ib)({modulesByArea:i.getModules(),find:e=>e.id===o})),[i,o]),{currentModuleIndex:l,numChildrenInGroup:s}=(0,r().K8)((()=>(0,Vm().y1)({modulesByArea:i.getModules(),moduleId:o})),[i,o]),{numHeaderModules:c,numFooterModules:d}=(0,r().K8)((()=>{if("form_layout_schema"===(null==a?void 0:a.area)){const e=i.getModules(),t=(0,Fm().jS)(a.area,e[a.area]);return{numHeaderModules:t.nonMoveableHeaderModules.length,numFooterModules:t.nonMoveableFooterModules.length}}return{numHeaderModules:0,numFooterModules:0}}),[a,i]);return void 0===a||void 0===l||void 0===s||s-c-d==1?null:(0,w.jsx)(pl().A,{focused:!1,popupType:Q().z7.Popup,alignmentToOrigin:Q().yP.Center,placementToOrigin:Q().sx.Right,buttonPopupStore:n,renderOrigin:e=>(0,w.jsx)(D().A,{...e,showChevron:!0,title:(0,w.jsx)(B().sA,{defaultMessage:"Move question",id:"formQuestionEditSettings.moveQuestion.title"}),icon:vm().t,disabled:!1}),render:e=>(0,w.jsx)(af,{collectionSettingsStore:t,parent:e,currentModuleAndArea:a,currentModuleIndex:l,numChildrenInGroup:s,numHeaderModules:c,numFooterModules:d})})}function af(e){const{collectionSettingsStore:t,parent:o,currentModuleIndex:n,currentModuleAndArea:a,numChildrenInGroup:l,numHeaderModules:s,numFooterModules:c}=e,u=(0,i().v3)(),{layoutStore:p,sessionId:g}=(0,fs().LH)(),{isFirstInGroup:m,isLastInGroup:f}=(0,r().K8)((()=>({isFirstInGroup:0===n-s,isLastInGroup:n===l-c-1})),[n,l,s,c]),y=(0,r().K8)((()=>{if("form_conditional_modules"===a.area){const e=a.module.parentConditionalGroupId,t=a.module.parentModuleId;if(!e||!t)return;return{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e,parentModuleId:t,index:0}}return{type:"absolute",area:"form_layout_schema",index:s}}),[a,s]);if(!y)return null;const S=[],h={key:"default",items:[{key:"moveUp",render:(e,t)=>m?null:(0,w.jsx)(D().A,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Move up",id:"formQuestionEditSettings.rearrangeQuestion.moveUp"}),icon:hm().s,disabled:!1}),action:()=>{(0,im().E)({environment:u,layoutStore:p,position:{...y,index:n-1},moduleId:a.module.id,sessionId:g}),o.close(),d().os({collectionSettingsStore:t})}},{key:"moveDown",render:(e,t)=>f?null:(0,w.jsx)(D().A,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Move down",id:"formQuestionEditSettings.rearrangeQuestion.moveDown"}),icon:Sm().v,disabled:!1}),action:()=>{(0,im().E)({environment:u,layoutStore:p,position:{...y,index:n+1},moduleId:a.module.id,sessionId:g}),o.close(),d().os({collectionSettingsStore:t})}},{key:"moveToTop",render:(e,t)=>m?null:(0,w.jsx)(D().A,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Move to top of group",id:"formQuestionEditSettings.rearrangeQuestion.moveToTop"}),icon:fm().Q,disabled:!1}),action:()=>{(0,im().E)({environment:u,layoutStore:p,position:y,moduleId:a.module.id,sessionId:g}),o.close(),d().os({collectionSettingsStore:t})}},{key:"moveToBottom",render:(e,t)=>f?null:(0,w.jsx)(D().A,{...e,title:(0,w.jsx)(B().sA,{defaultMessage:"Move to bottom of group",id:"formQuestionEditSettings.rearrangeQuestion.moveToBottom"}),icon:Gi().f,disabled:!1}),action:()=>{(0,im().E)({environment:u,layoutStore:p,position:{...y,index:l-c-1},moduleId:a.module.id,sessionId:g}),o.close(),d().os({collectionSettingsStore:t})}}],render:e=>(0,w.jsx)(oe().A,{...e})};S.push(h);const v={menuType:fl().gu.Popup,width:280,maxHeight:400};return(0,w.jsx)(J().A,{...v,children:(0,w.jsx)(X().Ay,{initialFocus:void 0,type:X().Oh.Vertical,sections:S,resetFocusOnMouseOut:!0})})}function lf(e){let{collectionContextStore:t,moduleId:o,propertyId:a,formQuestionStore:l,propertySchema:s}=e;const{layoutStore:c}=(0,fs().LH)(),d=(0,r().K8)((()=>l.getConfig()),[l]),{collectionStore:u,autofocusedQuestionTextStore:g}=(0,Mg().cJ)(),m=(0,i().v3)(),f=(0,B().tz)(),y=(0,r().K8)((()=>c.getSpaceId()),[c]),S=(0,Em().h)(),h=(0,r().K8)((()=>{var e;return u?(null===(e=c.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:u.getSchema()}))||void 0===e?void 0:e.length)??0:0}),[c,u]),v=(0,n.useCallback)((async()=>{if(!y)return;if(h>=tm().eb)return void Ir().D6({label:f.formatMessage(tm().Gi.questionLimitReachedFullMessage)});const e=u.getSchema(),n=await(0,ut().W4)({environment:m,schema:e,property:a,parentStore:u,propertyGroups:void 0,spaceId:y});n&&p().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:m,canUndo:!0,perform:e=>{(0,ul().F)({environment:m,collectionStore:u,update:{[n.newProperty]:n.newPropertySchema},transaction:e}),(0,_g().createFormQuestionAndModuleForNewlyDuplicatedProperty)({environment:m,transaction:e,layoutStore:c,collectionStore:u,propertyId:n.newProperty,position:{type:"module_relative",area:"form_layout_schema",relativeToModuleId:o,direction:"below"},addLayoutModule:S,collectionContextStore:t,autofocusTitle:{shouldAutofocus:!0,autofocusedQuestionTextStore:g},existingFormQuestionConfig:d})}})}),[S,g,t,u,m,c,o,a,d,y,h,f]);return s&&(0,mo().vB)(s)&&y?(0,w.jsx)(D().A,{icon:Hl().V,title:(0,w.jsx)(B().sA,{id:"formQuestionEditSettings.duplicateQuestion.title",defaultMessage:"Duplicate question"}),onClick:v}):null}function sf(e){let{collectionContextStore:t,formQuestionStore:o}=e;const n=(0,i().v3)(),{collectionStore:a,formBlockStore:l}=(0,r().K8)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),collectionStore:t.collectionStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]);return void 0!==(0,r().K8)((()=>{if(!a)return"generic_error";const e=a.getSchema();return e&&o?o.getQuestionErrorState(n,e,null==l?void 0:l.hasSitePublicPermission()):"generic_error"}),[a,n,l,o])}const cf=(0,B().YK)({suggested:{defaultMessage:"Suggested",id:"database.viewSettings.createViewTab.suggested"},link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"},linkOrCreate:{defaultMessage:"Link or create...",id:"database.viewSettings.searchCollections.linkedOrCreate"}});function df(e){let{existingCollectionStore:t,onSelectCollection:o}=e;const a=(0,i().v3)(),[c,d]=(0,n.useState)(""),u=(0,mt().ET)(),[p,g]=(0,r().K8)((()=>[u.settingsStore,u.settingsStore.state.hideSettingsHeader]),[u]),m=(0,r().K8)((()=>{const e=u.collectionViewBlockStore();if(!e)throw new Error("collectionViewBlockStore is required");return e}),[u]),f=(0,r().uB)(void 0,fi().A),y=(0,n.useCallback)((e=>{o?o(e):ci({collectionContextStore:u,environment:a,collectionStore:e,collectionSettingsStore:p,createdCollectionStore:t,userAction:"LinkToDatabaseMenu.handleAcceptExistingSource"})}),[u,p,t,a,o]),{resultsSection:S,fetchMoreResults:h,searchSessionId:v,searchSessionFlowNumber:x}=Fi({input:c,collectionContextStore:u,hideSearchTitle:g,parentStore:m,context:Oi.Source,handleAcceptExistingCollection:y,showSuggestions:!0}),C=Ci(u),b=(0,n.useRef)(0);(0,n.useEffect)((()=>{b.current=x}),[x]);const j=(0,r().K8)((()=>"on"===s().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,l().u4)({environment:a,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:v,using_secondary_search_surfaces_hook:j,source:"source"}}}),()=>{(0,l().u4)({environment:a,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:v,source:"source",using_secondary_search_surfaces_hook:j,search_session_flow_number:b.current}}})})),[a,j,v]);const A=(0,r().K8)((()=>null!=u&&u.isInHomeWidgetStore.state?cf.search:cf.link),[u]);return(0,w.jsxs)(K().Ay,{collectionSettingsStore:p,title:"Link to existing database",children:[(0,w.jsx)(oe().A,{shouldShowBottomDivider:!1,children:(0,w.jsx)(xo().Ay,{value:c,onChange:e=>{d(e.target.value),f.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:bo().A.formatMessage(A),showClearButton:!0})}),(0,w.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:[S,C].filter(W().O9)}),j?(0,w.jsx)(gi().A,{onChange:(e,t)=>{h&&e<mi().A.incrementScrollOffset&&h()}}):null]})}function uf(e){var t;const{collectionSettingsStore:o,collectionContextStore:a}=e,l=(0,i().v3)(),[s,u]=(0,n.useState)(),p=(0,r().K8)((()=>(0,Ze().S)(o)),[o]),g=(0,r().K8)((()=>a.getViewType()),[a]),m=(0,r().K8)((()=>a.allowScrollingWhenCollectionSettingsSidebarOpen()),[a]),y=(0,r().K8)((()=>o.state.closeOnEscape),[o]);(0,$e().A)({capture:!m,preventType:Qe().A.Y});const S=(0,r().K8)((()=>{if("property"===(null==p?void 0:p.type))return(0,ot().Jq)({collectionContextStore:a,property:p.property})}),[a,p]);(0,n.useEffect)((()=>{var e,t,o,n,i,r,d;p&&s!==p&&("propertyType"===p.type?c(l,{view_type:g,menu:p.type,is_database_name_empty:!Boolean(null==a||null===(e=a.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()),collection_id:null===(t=a.collectionStore())||void 0===t?void 0:t.id,collection_view_id:null===(o=a.collectionViewStore())||void 0===o?void 0:o.id,collection_view_block_id:null===(n=a.collectionViewBlockStore())||void 0===n?void 0:n.id,database_visit_id:a.visitSessionId,..."button"===(null==S?void 0:S.type)&&{builder_type:"modal"}}):c(l,{view_type:g,menu:p.type,collection_id:null===(i=a.collectionStore())||void 0===i?void 0:i.id,collection_view_id:null===(r=a.collectionViewStore())||void 0===r?void 0:r.id,collection_view_block_id:null===(d=a.collectionViewBlockStore())||void 0===d?void 0:d.id,database_visit_id:a.visitSessionId,builder_type:"modal"}));u(p)}),[a,p,l,s,null==S?void 0:S.type,g]);const h=(0,n.useCallback)((e=>{!1!==y&&(0,Ye().SQ)({event:e,context:Ye().y$.CollectionSettingsClick,callback:()=>{d().os({collectionSettingsStore:o})}})}),[y,o]),v=function(e){return{main:t=>(0,w.jsx)(pf,{tab:t,...e}),source:()=>(0,w.jsx)(eg,{...e}),createViewSource:t=>(0,w.jsx)(Zf,{tab:t,...e}),createSyncedViewSource:t=>(0,w.jsx)(mf,{tab:t,...e}),selectAccountForExternalSource:t=>(0,w.jsx)(ff,{tab:t,...e}),shareSyncedView:t=>(0,w.jsx)(yf,{tab:t,...e}),propertyType:t=>(0,w.jsx)(Sf,{tab:t,...e}),propertyAiAutofill:t=>(0,w.jsx)(hf,{tab:t,...e}),createView:()=>(0,w.jsx)(Rn,{...e}),duplicateExistingView:()=>(0,w.jsx)(ta,{...e}),properties:t=>(0,w.jsx)(vf,{tab:t,...e}),property:t=>(0,w.jsx)(xf,{tab:t,...e}),deletedProperties:t=>(0,w.jsx)(Cf,{tab:t,...e}),selectRelationSource:t=>(0,w.jsx)(bf,{tab:t,...e}),setupRelation:t=>(0,w.jsx)(wf,{tab:t,...e}),selectViewsModuleSource:t=>(0,w.jsx)(jf,{tab:t,...e}),setupViewsModule:t=>(0,w.jsx)(Af,{tab:t,...e}),layout:()=>(0,w.jsx)(jp,{...e}),group:t=>(0,w.jsx)(_f,{tab:t,...e}),groupByProperty:t=>(0,w.jsx)(Mf,{tab:t,...e}),subitem:t=>(0,w.jsx)(If,{tab:t,...e}),arrowsBy:t=>(0,w.jsx)(Pf,{tab:t,...e}),githubConfig:t=>(0,w.jsx)(Vf,{tab:t,...e}),filters:()=>(0,w.jsx)(sp,{...e}),groupByNumber:t=>(0,w.jsx)(kf,{tab:t,...e}),filter:t=>(0,w.jsx)(Ff,{tab:t,...e}),createFilter:()=>(0,w.jsx)(Gu,{...e}),createSort:()=>(0,w.jsx)(Ju,{...e}),sort:()=>(0,w.jsx)(Dp,{...e}),page:()=>(0,w.jsx)(gf,{...e}),automationSettings:t=>(0,w.jsx)(Kf,{tab:t,...e}),mobileCreateAutomation:t=>(0,w.jsx)(Of,{tab:t,...e}),mobileEditAutomation:t=>(0,w.jsx)(Ef,{tab:t,...e}),mobileEditButtonAutomation:t=>(0,w.jsx)(zf,{tab:t,...e}),externalProjectsSyncSettings:t=>(0,w.jsx)(Df,{tab:t,...e}),connectedRelationDatabaseActions:t=>(0,w.jsx)(Lf,{tab:t,...e}),dependencies:t=>(0,w.jsx)(Bf,{tab:t,...e}),relationFeaturesAdvancedSettings:t=>(0,w.jsx)(Rf,{tab:t,...e}),subitemV2:t=>(0,w.jsx)(Tf,{tab:t,...e}),sprintSettings:t=>(0,w.jsx)(Nf,{tab:t,...e}),customize:t=>(0,w.jsx)(Gf,{tab:t,...e}),confirmAddTemplate:t=>(0,w.jsx)(qf,{tab:t,...e}),views:t=>(0,w.jsx)(Yf,{tab:t,...e}),linked_collections:t=>(0,w.jsx)($f,{tab:t,...e}),connectionFeatures:t=>(0,w.jsx)(Qf,{tab:t,...e}),formQuestionEditSettings:t=>(0,w.jsx)(Uf,{tab:t,...e}),formQuestionCreateSettings:t=>(0,w.jsx)(Hf,{tab:t,...e}),formCustomizeSettings:t=>(0,w.jsx)(Wf,{tab:t,...e}),linkToDatabase:t=>(0,w.jsx)(Jf,{tab:t,...e}),databaseSettings:t=>(0,w.jsx)(Xf,{tab:t,...e}),databaseProperties:t=>(0,w.jsx)(ey,{tab:t,...e})}}(e),x=p?null===(t=v[p.type])||void 0===t?void 0:t.call(v,p):null;return x?(0,w.jsx)(f().A,{debugName:"CollectionSettings",capture:!0,onEsc:h,children:x}):null}function pf(e){const{collectionContextStore:t,tab:o}=e,n=(0,r().K8)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,r().K8)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,w.jsx)(Br().Ay,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function gf(e){const{collectionContextStore:t}=e,o=(0,i().v3)(),n=(0,r().K8)((()=>t.collectionViewStore()),[t]);return n?(0,w.jsx)(K().Ay,{...e,title:"Select page to display",children:(0,w.jsx)("div",{style:{margin:12},children:(0,w.jsx)(m().A,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Je().A.setState({pageId:e.target.value})},onSubmit:()=>{const e=Je().A.state.pageId;if(!e)return null;p().createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,canUndo:!0,perform:t=>{u().zA({stores:[n],update:{page_pointer:{id:(0,a().G2)(e),spaceId:t.spaceId,table:"block"}},transaction:t})}})}})})}):null}function mf(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,w.jsx)(bn,{...e,...t})}function ff(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,w.jsx)(uo,{...e,...t})}function yf(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,w.jsx)(Eu,{...e,...t})}function Sf(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,w.jsx)(au,{...e,...t})}function hf(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,w.jsx)(Ld,{...e,...t})}function vf(e){const{tab:t}=e;return"properties"!==t.type?null:(0,w.jsx)(Ap().A,{...e,timelineViewTab:t.timelineViewTab})}function xf(e){const{tab:t}=e;return"property"!==t.type?null:(0,w.jsx)(Kc,{...e,...t,titleOverride:e.collectionSettingsPropertyTitleOverride},t.property)}function Cf(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,w.jsx)(Gr,{...t,...e})}function bf(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,w.jsx)(ju,{...e,...t})}function wf(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,w.jsx)(Iu,{...e,...t})}function jf(e){const{tab:t}=e;return"selectViewsModuleSource"!==t.type?null:(0,w.jsx)(Au,{...e,...t})}function Af(e){const{tab:t}=e;return"setupViewsModule"!==t.type?null:(0,w.jsx)(Vu,{...e,...t})}function _f(e){const{tab:t}=e;return"group"!==t.type?null:(0,w.jsx)(gp().Ay,{...e,...t})}function Mf(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,w.jsx)(bp,{...e,...t})}function kf(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,w.jsx)(vp,{...e,...t})}function If(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,w.jsx)(Fp,{...e,...t,formatSetting:"subitem"})}function Tf(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,w.jsx)(Kt,{...e,feature:"subitem",from:t.from})}function Pf(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,w.jsx)(Fp,{...e,...t,formatSetting:"timeline_arrows_by"})}function Bf(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,w.jsx)(Kt,{...e,feature:"timeline_arrows_by",from:t.from})}function Rf(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,w.jsx)(oo,{...e,feature:t.feature})}function Vf(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,w.jsx)(Ol,{...e,property:t.property})}function Ff(e){const{tab:t}=e;return"filter"!==t.type?null:(0,w.jsx)(tp,{...e})}function Kf(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,w.jsx)(ze,{...e,tabSettings:t})}function Df(e){const{tab:t}=e;return"externalProjectsSyncSettings"!==t.type?null:(0,w.jsx)(Qa,{...e,tabSettings:t})}function Lf(e){const{tab:t}=e;return"connectedRelationDatabaseActions"!==t.type?null:(0,w.jsx)(on,{...e,tabSettings:t})}function Of(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileCreateAutomation"!==t.type?null:(0,w.jsx)(g().u,{collectionSettingsStore:n,collectionContextStore:o,mode:"create",from:t.from,source:t.source})}function Ef(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("mobileEditAutomation"!==t.type)return null;const{automationId:i}=t;return(0,w.jsx)(g().u,{collectionSettingsStore:n,collectionContextStore:o,mode:"update",source:t.source,automationId:i})}function zf(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileEditButtonAutomation"!==t.type?null:(0,w.jsx)(g().N,{collectionSettingsStore:n,collectionContextStore:o,propertyId:t.propertyId,propertySchema:t.propertySchema})}function Nf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,w.jsx)(be,{collectionContextStore:o,collectionSettingsStore:n,from:t.from})}function Uf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionEditSettings"!==t.type?null:(0,w.jsx)(Hm,{collectionContextStore:o,collectionSettingsStore:n,formQuestionId:t.formQuestionId,moduleId:t.moduleId})}function Hf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionCreateSettings"!==t.type?null:(0,w.jsx)(gm,{collectionContextStore:o,collectionSettingsStore:n,moduleId:t.moduleId,area:t.area,parentModuleId:t.parentModuleId,parentConditionalGroupId:t.parentConditionalGroupId})}function Wf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formCustomizeSettings"!==t.type?null:(0,w.jsx)(wg,{collectionContextStore:o,collectionSettingsStore:n})}function Gf(e){const{tab:t,collectionContextStore:o}=e,n=(0,i().v3)();(0,tt().b)(o);const a=(0,r().K8)((()=>{const e=o.collectionStore();return(0,et().tY)({environment:n,collectionStore:e})}),[n,o]),l=(0,r().K8)((()=>a&&s().default.checkGate({gateName:"workflow_templates_prototype"})),[a]);return"customize"!==t.type?null:a&&l?(0,w.jsx)(We,{collectionTemplate:a}):(0,w.jsx)(Ue,{...e})}function qf(e){let{tab:t,collectionSettingsStore:o}=e;return"confirmAddTemplate"!==t.type?null:(0,w.jsx)(Xe().W3,{template:t.template,collectionSettingsStore:o})}function Yf(e){let{tab:t,collectionSettingsStore:o,collectionContextStore:n}=e;return"views"!==t.type?null:(0,w.jsx)(Xe().vK,{collectionSettingsStore:o,collectionContextStore:n})}function $f(e){let{tab:t}=e;return"linked_collections"!==t.type?null:(0,w.jsx)(Xe().P6,{})}function Qf(e){const{tab:t}=e;return"connectionFeatures"!==t.type?null:(0,w.jsx)(qe,{...e})}function Zf(e){const{tab:t}=e;return"createViewSource"!==t.type?null:(0,w.jsx)(hr,{existingCollectionStore:t.existingCollectionStore,createdCollectionRecordPointerMap:t.createdCollectionRecordPointerMap,onSelectCollection:t.onSelectCollection,...e})}function Jf(e){const{tab:t}=e;return"linkToDatabase"!==t.type?null:(0,w.jsx)(df,{existingCollectionStore:t.existingCollectionStore,onSelectCollection:t.onSelectCollection,...e})}function Xf(e){const{tab:t}=e;return"databaseSettings"!==t.type?null:(0,w.jsx)(Vr,{...e})}function ey(e){const{tab:t}=e;return"databaseProperties"!==t.type?null:(0,w.jsx)(_r,{...e})}},635676:(e,t,o)=>{"use strict";o.d(t,{l:()=>r});var n=()=>o(148307),i=()=>o(651124);const r={[i().uO.Jira]:n().A.images.externalIntegrations.jiraPng,[i().uO.Salesforce]:n().A.images.externalIntegrations.salesforcePng}},638045:(e,t,o)=>{"use strict";o.d(t,{t:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M13.978 5.393a.625.625 0 0 1-.884 0l-2.469-2.469v5.662a.625.625 0 1 1-1.25 0V2.924L6.906 5.393a.625.625 0 1 1-.883-.884L9.558.974a.625.625 0 0 1 .884 0l3.535 3.535a.625.625 0 0 1 0 .884m-3.352 6.026a.625.625 0 1 0-1.25 0v5.648l-2.469-2.469a.625.625 0 1 0-.883.884l3.535 3.535c.244.245.64.245.884 0l3.535-3.535a.625.625 0 1 0-.883-.884l-2.469 2.469z"})},i=(0,o(340498).wt)("arrowUpDownStacked",n)},646668:(e,t,o)=>{"use strict";o.d(t,{Rh:()=>f,d7:()=>d,nr:()=>p,rr:()=>g,uo:()=>m,v:()=>u});var n=()=>o(636090),i=()=>o(178492),r=()=>o(148307),a=()=>o(604995),l=()=>o(416504),s=()=>o(972435);const c=(0,o(959013).YK)({aiSummaryName:{id:"feature.ai_summary.name",defaultMessage:"AI summary"},aiSummaryDescription:{id:"feature.ai_summary.description",defaultMessage:"Summarize pages with AI"},aiAutofillName:{id:"feature.ai_autofill.name",defaultMessage:"Custom AI autofill"},aiAutofillDescription:{id:"feature.ai_autofill.description",defaultMessage:"Autofill properties with AI"},aiTranslationName:{id:"feature.ai_translation.name",defaultMessage:"AI translation"},aiTranslationDescription:{id:"feature.ai_translation.description",defaultMessage:"Translate pages with AI"},aiKeywordsName:{id:"feature.ai_keywords.name",defaultMessage:"AI keywords"},aiKeywordsDescription:{id:"feature.ai_keywords.description",defaultMessage:"Extract keywords with AI"}}),d=[{uri:i().Bn.priorityHmlFeature,name:"Priority",dependencies:[{uri:i().Kg.priorityHmlProperty,type:"property",collectionUri:n().iH,name:"Priority",description:"High, medium, or low",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Priority",options:[{id:"priority_low",value:"Low",color:"green"},{id:"priority_medium",value:"Medium",color:"yellow"},{id:"priority_high",value:"High",color:"red"}]}}],collectionUri:n().iH},{uri:i().Bn.progressBarFeature,collectionUri:n().iH,name:"Progress Bar",description:"Visual representation of progress",icon:r().A.images.appPackages.featureStatusSvg,dependencies:[{uri:i().Kg.progressBarCurrentProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Current",propertySchema:{type:"number",name:"Current"}},{uri:i().Kg.progressBarTargetProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Target",propertySchema:{type:"number",name:"Target"}},{uri:i().Kg.progressBarFormulaProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Progress Formula",propertySchema:{type:"formula",name:"Progress bar",formula2:{code:[["",[["fpp",{property:i().Kg.progressBarCurrentProperty,collection:{id:n().iH,table:"collection"}}]]],["/"],["",[["fpp",{property:i().Kg.progressBarTargetProperty,collection:{id:n().iH,table:"collection"}}]]]],result_type:{type:"number"}},show_as:{type:"bar",color:"green",maxValue:1,showValue:!1},version:"v2"}}]},{uri:i().Bn.ganttChartFeature,collectionUri:n().iH,name:"Gantt Chat",description:"Chart to show progress of a project's tasks over time.",icon:r().A.images.appPackages.featureGanttSvg,dependencies:[{uri:i().Kg.ganttInitiativeProperty,type:"property",collectionUri:n().iH,name:"Initiative",description:"Initiatives associated with a specific project",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Initiative",options:[{id:"initiative_a",value:"Initiative A",color:"purple"},{id:"initiative_b",value:"Initiative B",color:"green"},{id:"initiative_c",value:"Initiative C",color:"blue"}]}},{uri:i().Kg.ganttDueDateProperty,type:"property",collectionUri:n().iH,name:"Due Date",description:"When a project is due.",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"date",name:"Due Date"}},{uri:i().Kg.ganttTimelineView,type:"collection_view",collectionUri:n().iH,description:"GANTT chart timeline view of projects",value:{type:"timeline",name:"Timeline",format:{collection_view_icon:"/icons/timeline_gray.svg",timeline_show_table:!0,timeline_table_properties:[{width:171,visible:!0,property:"title"},{width:200,visible:!0,property:i().Kg.ganttInitiativeProperty}],timeline_preference:{zoomLevel:"month",centerTimestamp:(0,a().ln)((0,a().Ec)((0,l().P)()),(0,l().P)())},collection_group_by:{sort:{type:"manual"},type:"multi_select",property:i().Kg.ganttInitiativeProperty,hideEmptyGroups:!0}},query2:{timeline_by:i().Kg.ganttDueDateProperty}},collectionViewBlockUri:n().eh}]}],u=[p(),g(),m(),f()];function p(){return{uri:i().Bn.aiSummaryFeature,collectionUri:n().iH,name:s().A.formatMessage(c.aiSummaryName),description:s().A.formatMessage(c.aiSummaryDescription),icon:r().A.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r().A.images.tooltips.properties.aiAutofillSummaryPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiSummaryProperty,type:"property",collectionUri:n().iH,name:s().A.formatMessage(c.aiSummaryName),propertySchema:{type:"text",name:s().A.formatMessage(c.aiSummaryName),ai_inference:{type:"summarize",auto_update_on_edit:!0}}}]}}function g(){return{uri:i().Bn.aiCustomAutofillFeature,collectionUri:n().iH,name:s().A.formatMessage(c.aiAutofillName),description:s().A.formatMessage(c.aiAutofillDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiCustomAutofillPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiCustomAutofillProperty,type:"property",collectionUri:n().iH,name:s().A.formatMessage(c.aiAutofillName),propertySchema:{name:s().A.formatMessage(c.aiAutofillName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function m(){return{uri:i().Bn.aiTranslationFeature,collectionUri:n().iH,name:s().A.formatMessage(c.aiTranslationName),description:s().A.formatMessage(c.aiTranslationDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiTranslationPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiTranslationProperty,type:"property",collectionUri:n().iH,name:s().A.formatMessage(c.aiTranslationName),propertySchema:{name:s().A.formatMessage(c.aiTranslationName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function f(){return{uri:i().Bn.aiKeywordsFeature,collectionUri:n().iH,name:s().A.formatMessage(c.aiKeywordsName),description:s().A.formatMessage(c.aiKeywordsDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiKeywordsPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiKeywordsProperty,type:"property",collectionUri:n().iH,name:s().A.formatMessage(c.aiKeywordsName),propertySchema:{type:"multi_select",name:s().A.formatMessage(c.aiKeywordsName),select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}}}]}}},652380:(e,t,o)=>{"use strict";o.d(t,{G:()=>C,M:()=>b});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),a=()=>o(959013),l=()=>o(100622),s=()=>o(496603),c=()=>o(36629),d=()=>o(313892),u=()=>o(878665),p=()=>o(760217),g=()=>o(933117),m=()=>o(553965),f=()=>o(463830),y=()=>o(455338),S=()=>o(815416),h=()=>o(39039),v=()=>o(95347),x=o(474848);function C(e){var t,o;const{collectionContextStore:r,collectionSettingsStore:a,feature:l,itemProps:C}=e,w=(0,n().v3)(),j=(0,v().rD)(r),A=(0,v().hw)(r,a),_=(0,i().K8)((()=>r.databaseType),[r]),M=(0,v().C5)(r),k=(0,h().tx)(l,_),I=(0,h().gZ)(l,M);return(0,x.jsx)(u().A,{showImage:!0,caption:k,description:I,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>{if((0,d().lK)(l)||(0,d().u1)(l))return(0,x.jsx)(h().j7,{collectionContextStore:r,buttonMenuItemProps:{...(0,m().A)(C,e)},feature:l,caption:k,onClick:()=>A(l),icon:(0,x.jsx)(S().a,{feature:l}),right:(0,x.jsx)(b,{focused:C.focused})});{const t=new(f().A),o=(0,v().ff)(l,null==j?void 0:j.allFeatures);return(0,x.jsx)(g().A,{buttonPopupStore:t,items:o,getKey:e=>e.name,renderItem:e=>(0,x.jsx)(p().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0}),onSelect:async e=>{await c().h3({environment:w,feature:e,collectionContextStore:r,addFeatureFrom:"customize_menu"}),(0,y().t)({featureName:e.name})},selectedItem:void 0,renderOrigin:o=>(0,x.jsx)(h().j7,{collectionContextStore:r,buttonMenuItemProps:{focused:Boolean(C.focused),...(0,m().A)(s().cJ(C,"onClick","focused"),(0,m().A)(e,o))},feature:l,caption:k,onClick:()=>{t.setState({open:!0})},icon:(0,x.jsx)(S().a,{feature:l}),right:(0,x.jsx)(b,{focused:C.focused})})})}}})}function b(e){const{focused:t}=e,o=(0,r().IS)((e=>({addButton:{fontSize:12,fontWeight:500,color:e.blueColor,background:t?l().Ay.diffBackground:e.accentColors.gray[75],padding:"3px 10px",borderRadius:16}})),[t]);return(0,x.jsx)("div",{style:o.addButton,children:(0,x.jsx)(a().sA,{defaultMessage:"Add",id:"database.viewSettings.customizeMenu.addButton"})})}},653259:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});o(296540);var n=()=>o(959013),i=()=>o(100622),r=()=>o(125565),a=o(474848);function l(e){return(0,a.jsx)(r().A,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:i().Ay.red,...e.styles},children:(0,a.jsx)(n().sA,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},673900:(e,t,o)=>{"use strict";o.d(t,{v:()=>c});var n=o.n(o(364387)),i=o(296540),r=()=>o(401497),a=()=>o(496603),l=()=>o(623580),s=o(474848);function c(e){let{value:t,onChange:o,onBlur:c,onKeyDown:d,inputProps:u}=e;const[p,g]=(0,i.useState)(""),m=(0,i.useRef)(""),f=(0,i.useRef)(t);(0,i.useEffect)((()=>{const e=void 0===t?"":t.toString();g(e),m.current=e,f.current=t}),[t]);const y=(0,i.useCallback)((e=>a().sg((e=>{null==o||o(e)}),300)(e)),[o]),S=(0,i.useCallback)((e=>{const t=e.target.value;if(g(t),m.current=t,o){const e=n()(t);y(isNaN(e)?void 0:e)}}),[y,o]),h=(0,i.useCallback)((e=>{const t=n()(e.target.value);null==c||c(isNaN(t)?void 0:t)}),[c]),v=(0,i.useRef)(c),x=(0,i.useCallback)((e=>{if("Enter"===e.key){const e=n()(p);null==d||d(isNaN(e)?void 0:e)}}),[p,d]);(0,i.useEffect)((()=>()=>{var e;if((null===(e=f.current)||void 0===e?void 0:e.toString())!==m.current){var t;const e=n()(m.current);null===(t=v.current)||void 0===t||t.call(v,isNaN(e)?void 0:e)}}),[]);const C=(0,r().IS)((e=>({input:{background:e.contentBackground}})),[]);return(0,s.jsx)(l().A,{type:"number",value:p,inputClassName:"input-hide-arrows",style:C.input,onChange:S,onBlur:c?h:void 0,onKeyDown:d?x:void 0,...u})}},704640:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});o(296540);var n=()=>o(56366),i=()=>o(959013),r=()=>o(686526),a=o(474848);const l=function(e){let{collectionContextStore:t,collectionSettingsStore:l,disabled:s}=e;const c=(0,o(484714).v3)(),d=(0,n().O$)(t.permissionScopesStore),u=(0,n().K8)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&d.canConfigureBlock?1:0)),[t,d]);return(0,a.jsx)(o(497222).A,{disabled:s,icon:o(170350).S,title:(0,a.jsx)(i().sA,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:u>0?(0,a.jsx)(i().sA,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:u},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,a.jsx)(i().sA,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{(0,o(436696).X)({environment:c,collectionContextStore:t,action:"click_filters"}),0===u?r().a2({collectionSettingsStore:l,item:{type:"createFilter"}}):r().a2({collectionSettingsStore:l,item:{type:"filters"}})}})}},705602:(e,t,o)=>{"use strict";o.d(t,{s:()=>u,y:()=>g});var n=o(296540),i=()=>o(484714),r=()=>o(401497),a=()=>o(959013),l=()=>o(419357),s=()=>o(89924),c=()=>o(673730),d=o(474848);const u=(0,a().YK)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),p=60;function g(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:g}=e;const[m,f]=(0,n.useState)(t??""),y=(0,n.useRef)(m),{isMobile:S}=(0,i().Y0)(),h=(0,a().tz)(),v=(0,r().IS)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},descriptionInput:{lineHeight:"20px",fontSize:S?14:13}})),[S]),x=(0,n.useCallback)((()=>o(y.current)),[o]);(0,n.useEffect)((()=>()=>x()),[x]);const C=(0,n.useMemo)((()=>(0,d.jsx)(l().Ay,{value:m,onChange:e=>{f(e.target.value),y.current=e.target.value},onBlur:x,onSubmit:x,placeholder:h.formatMessage(u.addDescription),focusInitial:!0,disabled:!1,inputOuterStyle:v.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c().fy,autosize:!0,autosizeMaxHeight:p,showClearButton:!1})),[m,h,x,v.descriptionInput]);return S&&!g?(0,d.jsx)(s().A,{topBorder:!0,isInput:!0,title:(0,d.jsx)("span",{style:v.title,children:h.formatMessage(u.descriptionHeader)}),children:C}):C}},739222:(e,t,o)=>{"use strict";o.d(t,{Bm:()=>ne,RH:()=>Q,YX:()=>U,bz:()=>z,iF:()=>oe,js:()=>ie,nu:()=>re,ph:()=>ce});o(898992),o(354520),o(672577),o(581454),o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),a=()=>o(66689),l=()=>o(148307),s=()=>o(970013),c=()=>o(617871),d=()=>o(857639),u=()=>o(263178),p=()=>o(959013),g=()=>o(534177),m=()=>o(686526),f=()=>o(36629),y=()=>o(901389),S=()=>o(317909),h=()=>o(521358),v=()=>o(374562),x=()=>o(313892),C=()=>o(878665),b=()=>o(816559),w=()=>o(989423),j=()=>o(476492),A=()=>o(23815),_=()=>o(972435),M=()=>o(553965),k=()=>o(685889),I=()=>o(252833),T=()=>o(37433),P=()=>o(351360),B=()=>o(53137),R=()=>o(346705),V=()=>o(455338),F=()=>o(234675),K=()=>o(397089),D=()=>o(39039),L=()=>o(95347),O=()=>o(652380),E=o(474848);function z(e){const t=ce(),o=function(e){const t=(0,L().rD)(e),o=(0,i().K8)((()=>{var o;const n=(0,T().nk)()||(0,x().o$)(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getDatabaseType(),r=void 0===t||i===a().dC;return n&&r?[U]:[]}),[e,t]);return o}(e),n=function(e){const t=(0,i().K8)((()=>{const t=e.databaseType;let o;if(t===a().av){const t=e.collectionStore();o=Boolean(t&&(0,A().$6)(t))}else o=t===a().dC&&function(e){const t=e.collectionStore();if(!t)return!1;const o=t.getMappedProperty(a().yx.TaskToSprintRelation),n=t.getSchema()[o];if(!n)return!0;const i=(0,k().pg)(e,n);return Boolean(i&&(0,A().$6)(i))}(e);return o?[Q]:[]}),[e]);return t}(e);return[...t,...o,...n]}const N=(0,p().YK)({taskName:{id:"feature.turnIntoTasks.name",defaultMessage:"Tasks"},taskDescription:{id:"feature.turnIntoTasks.description",defaultMessage:"See your tasks in Home, manage tasks in sprints, and more"}}),U={uri:"notion://feature/turn_into_tasks_feature",name:_().A.formatMessage(N.taskName),description:_().A.formatMessage(N.taskDescription),tooltipImage:{img:l().A.images.tooltips.collectionSettings.turnIntoTasksPng,scale:.5},icon:"",collectionUri:F().R,isFeatureAdded:function(e,t){var o;if(e.uri!==U.uri)return!1;return(null===(o=t.collectionStore())||void 0===o?void 0:o.getDatabaseType())===a().dC},getSuggestedFeatureMenuItem:e=>(0,E.jsx)(H,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,E.jsx)(W,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})};function H(e){var t,o;const{collectionContextStore:i,feature:l,itemProps:s}=e,c=(0,n().v3)(),d=(0,L().NE)(),p=(0,r().IS)((e=>({featureIconWrapper:{...d.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...d.featureIcon,fill:e.accentColors.blue[400]}})),[d]);return(0,E.jsx)(C().A,{showImage:!0,caption:l.description,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,E.jsx)(D().j7,{collectionContextStore:i,feature:l,caption:l.description,buttonMenuItemProps:{...(0,M().A)(s,e)},icon:(0,E.jsx)("div",{style:p.featureIconWrapper,children:(0,u().S)(p.featureIcon)}),right:(0,E.jsx)(O().M,{focused:s.focused}),onClick:()=>function(e){const{collectionContextStore:t,environment:o}=e;R().A.setState({isModalOpen:!0,databaseType:a().dC,collectionContextStore:t});const n=(0,j().sl)(t)||{};w().vd(o,"convert_db_start",{...n,database_type:a().dC})}({environment:c,collectionContextStore:i})})})}function W(e){const{collectionContextStore:t,feature:o,itemProps:i}=e,a=(0,n().v3)(),l=(0,L().NE)(),s=(0,r().IS)((e=>({featureIconWrapper:{...l.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...l.featureIcon,fill:e.accentColors.blue[400]}})),[l]);return(0,E.jsx)(K().jB,{collectionContextStore:t,feature:o,itemProps:i,icon:(0,E.jsx)("div",{style:s.featureIconWrapper,children:(0,u().S)(s.featureIcon)}),onClick:Y({environment:a,collectionContextStore:t})})}function G(){const e=(0,r().IS)((e=>({confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[]);return(0,E.jsx)("span",{style:e.confirmationModalDescription,children:(0,E.jsx)(p().sA,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})})}function q(){const e=(0,r().IS)((e=>({confirmationModalTitle:{fontWeight:500},wrapper:{textAlign:"center"}})),[]);return(0,E.jsx)("div",{style:e.wrapper,children:(0,E.jsx)("span",{style:e.confirmationModalTitle,children:(0,E.jsx)(p().sA,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})})}function Y(e){const{environment:t,collectionContextStore:o}=e,n=[{label:(0,E.jsx)(p().sA,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:()=>{S().createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",canUndo:!0,perform:e=>{h().Fr({environment:t,collectionContextStore:o,transaction:e})}})}}];return()=>{y().ui({message:(0,E.jsx)(q,{}),description:(0,E.jsx)(G,{}),showCancel:!0,keepFocus:!0,items:n})}}const $=(0,p().YK)({featureName:{id:"feature.sprints.name",defaultMessage:"Sprints"},featureDescription:{id:"feature.sprints.description",defaultMessage:"Plan tasks in cycles with sprints"}}),Q={uri:"notion://feature/sprints_feature",name:_().A.formatMessage($.featureName),description:_().A.formatMessage($.featureDescription),tooltipImage:{img:l().A.images.tooltips.properties.sprintsPng,scale:.5},icon:"/icons/run_gray.svg",collectionUri:F().R,isFeatureAdded:function(e,t){var o;if(e.uri!==Q.uri)return!1;const n=null===(o=t.sprintSettingsContextStore.state)||void 0===o?void 0:o.permissionsContext;if(!n)return!1;return n.canEdit&&n.sprintsEnabled},getSuggestedFeatureMenuItem:e=>(0,E.jsx)(Z,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,E.jsx)(J,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps})};function Z(e){var t,o;const{collectionContextStore:n,collectionSettingsStore:i,feature:a,itemProps:l}=e,s=(0,L().NE)(),c=(0,r().IS)((e=>({featureIconWrapper:{...s.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...s.featureIcon,fill:e.accentColors.blue[400]}})),[s]);return(0,E.jsx)(C().A,{showImage:!0,caption:a.description,tooltipImage:null===(t=a.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=a.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,E.jsx)(D().j7,{collectionContextStore:n,feature:a,caption:a.description,buttonMenuItemProps:{...(0,M().A)(l,e)},icon:(0,E.jsx)("div",{style:c.featureIconWrapper,children:(0,u().S)(c.featureIcon)}),right:(0,E.jsx)(O().M,{focused:l.focused}),onClick:()=>m().a2({collectionSettingsStore:i,item:{type:"sprintSettings",from:"customize_menu"}})})})}function J(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:n,itemProps:i}=e,a=(0,L().NE)(),l=(0,r().IS)((e=>({featureIconWrapper:{...a.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...a.featureIcon,fill:e.accentColors.blue[400]}})),[a]);return(0,E.jsx)(K().jB,{collectionContextStore:t,feature:n,itemProps:i,icon:(0,E.jsx)("div",{style:l.featureIconWrapper,children:(0,u().S)(l.featureIcon)}),onClick:()=>m().a2({collectionSettingsStore:o,item:{type:"sprintSettings",from:"customize_menu"}})})}const X=(0,p().YK)({githubFeatureDescription:{id:"customizeMenu.github.featureDescription",defaultMessage:"Link PRs and set up automated task status updates based on PR changes"},googleDriveFeatureDescription:{id:"customizeMenu.googleDrive.featureDescription",defaultMessage:"Link Google Drive files"},figmaFeatureDescription:{id:"customizeMenu.figma.featureDescription",defaultMessage:"Link Figma pages"},zendeskFeatureDescription:{id:"customizeMenu.zendesk.featureDescription",defaultMessage:"Link Zendesk tickets"}}),ee=[c().Hd,c().ob,c().e1,c().k0],te="notion://feature/connection_",oe=`${te}${c().ob}`,ne=`${te}${c().Hd}`,ie=`${te}${c().e1}`,re=`${te}${c().k0}`,ae={[c().ob]:`${te}property_${c().ob}`,[c().Hd]:`${te}property_${c().Hd}`,[c().e1]:`${te}property_${c().e1}`,[c().k0]:`${te}property_${c().k0}`},le={[c().ob]:X.githubFeatureDescription,[c().Hd]:X.googleDriveFeatureDescription,[c().e1]:X.figmaFeatureDescription,[c().k0]:X.zendeskFeatureDescription},se={[c().ob]:l().A.images.tooltips.properties.githubSyncPullStatusPng,[c().Hd]:l().A.images.tooltips.properties.googleDrivePng,[c().e1]:l().A.images.tooltips.properties.figmaPng,[c().k0]:l().A.images.tooltips.properties.zendeskPng};function ce(){const e=(0,i().K8)((()=>{var e;return null===(e=P().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),t=(0,i().K8)((()=>B().A.integrations.state),[]);return(0,i().K8)((()=>e?ee.map((e=>{const o=t.find((t=>t.id===e));if(!o)return;const n=o.id===c().ob?(0,v().Jb)().name:o.name;return{uri:`${te}${e}`,name:n,description:_().A.formatMessage(le[e]),icon:o.info.icon,tooltipImage:{img:se[e],scale:.5},collectionUri:F().R,integrationId:e,isFeatureAdded:(e,t)=>Boolean(pe(t,e.integrationId)),getSuggestedFeatureMenuItem:e=>(0,E.jsx)(de,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,E.jsx)(ue,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})}})).filter(g().O9):[]),[e,t])}function de(e){var t,o;const{collectionContextStore:i,feature:r,itemProps:a}=e,l=(0,n().v3)(),s=(0,p().tz)(),d=(0,L().NE)();return(0,E.jsx)(C().A,{showImage:!0,caption:r.description,tooltipImage:null===(t=r.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=r.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,E.jsx)(D().j7,{collectionContextStore:i,feature:r,caption:r.description,buttonMenuItemProps:{...(0,M().A)(a,e)},icon:(0,E.jsx)("div",{style:d.featureIconWrapper,children:(0,E.jsx)(b().Ay,{style:d.featureIcon,src:r.icon})}),right:(0,E.jsx)(O().M,{focused:a.focused}),onClick:()=>async function(e){var t;const{environment:o,collectionContextStore:n,feature:i,intl:r}=e,a=B().A.integrations.state.find((e=>e.id===i.integrationId)),l=null==a||null===(t=a.info.original_url_patterns)||void 0===t?void 0:t.find((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.connectedRelation}));if(!a||!l||!i.integrationId)return;const s={name:a.id===c().ob?(0,v().Jb)().name:(0,I().Fe)({pattern:l,integration:a}),pattern:l,integration:a};await f().XO({environment:o,collectionContextStore:n,connectedRelationProperty:s,intl:r,from:"customize_menu",untypedFeatureArgs:{propertyId:ae[i.integrationId]},propertyGroupId:void 0}),(0,V().t)({featureName:i.name})}({environment:l,collectionContextStore:i,intl:s,feature:r})})})}function ue(e){const{collectionContextStore:t,feature:o,itemProps:n}=e,i=(0,L().NE)(),r=o.integrationId;return r?(0,E.jsx)(K().jB,{collectionContextStore:t,feature:o,itemProps:n,icon:(0,E.jsx)("div",{style:i.featureIconWrapper,children:(0,E.jsx)(b().Ay,{style:i.featureIcon,src:o.icon})}),onClick:()=>{const e=pe(t,r);e?(0,K().Ak)({collectionContextStore:t,property:e}):d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingPropertyId",error:{miscDataString:`Feature ${o.name} has no relation property ID.`}})}}):(d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingIntegrationId",error:{miscDataString:`Feature ${o.name} has no integration ID.`}}),null)}function pe(e,t){var o;const n=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema();if(n&&t)for(const[i,r]of Object.entries(n))if(r&&(0,s().UU)(r)&&r.connectedRelation.integration_id===t)return i}},748768:(e,t,o)=>{"use strict";o.r(t),o.d(t,{toggleTwoWaySyncOnCollection:()=>y,updateSyncedData:()=>S});o(16280),o(898992),o(672577),o(814603),o(147566),o(198721);var n=()=>o(282883),i=()=>o(179034),r=()=>o(343666),a=()=>o(919709),l=()=>o(312296),s=()=>o(789557),c=()=>o(972435),d=()=>o(252833),u=()=>o(630116),p=()=>o(449506),g=()=>o(896628),m=()=>o(436572),f=()=>o(317909);function y(e){var t;const{environment:o,taskCollectionStore:i,projectCollectionStore:r}=e,a=!(null===(t=i.getFormat().sync_state)||void 0===t?void 0:t.enable_two_way_sync);a&&function(e){const{environment:t,taskCollectionStore:o}=e,i=o.getSchema(),r={};for(const a of n().En){const e=i[a];e&&"read_write"!==e.synced_permissions&&("notion://tasks/assign_property"===a&&"person"===e.type?r[a]={...e,synced_permissions:"read_write",limit:1}:r[a]={...e,synced_permissions:"read_write"})}Object.keys(r).length>0&&f().createAndCommit({userAction:"updateSyncedCollectionActions.addSyncedPermissionsToSchema",environment:t,canUndo:!0,perform:e=>{(0,l().F)({environment:t,collectionStore:o,update:r,transaction:e})}})}({environment:o,taskCollectionStore:i});const s=i.getFormat().sync_state||{syncing:!1};f().createAndCommit({userAction:"updateSyncedCollectionActions.toggleTwoWaySyncOnCollection",environment:o,canUndo:!0,perform:e=>{g().zA({stores:[i,r],update:{sync_state:{...s,enable_two_way_sync:a}},transaction:e})}})}async function S(e){const{transaction:t,environment:o}=e;try{const e=t.operations.find((e=>function(e){switch(e.command){case"set":case"addPersonAfter":case"removePerson":return!0;default:return!1}}(e)&&2===e.path.length&&"properties"===e.path[0]&&n().En.includes(e.path[1].toString())));if(e){const n=(0,d().sP)({transaction:t,updateOperation:e,environment:o});if(!n)return;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i}=e,r=(0,d().jg)({updateOperation:n,transaction:t,collectionStore:i});if("UPDATE_PROPERTY"===r.syncCollectionUpdates[0].updateType){const e=d().vT({pageId:r.syncCollectionUpdates[0].collectionPagePointer.id,propertyId:r.syncCollectionUpdates[0].propertyId});d().Jv({uniquePropertyId:e});const t=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:r});if(d().NW(e),"success"===t.type){if(t.data.success)return;var a;throw h({errorCode:t.data.errorCode,syncCollectionType:i.getFormat().external_collection_type,propertyName:1===r.syncCollectionUpdates.length?null===(a=i.getSchema()[r.syncCollectionUpdates[0].propertyId])||void 0===a?void 0:a.name:void 0}),new Error(t.data.message)}var l;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(l=t.error)||void 0===l||null===(l=l.name)||void 0===l?void 0:l.toString())??"Unknown error")}}({transaction:t,environment:o,updateOperation:e,syncedCollectionStore:n}))}const c=t.operations.find((e=>"set"===e.command&&1===e.path.length&&"text"===e.path[0]));if(c&&c.pointer.table===r().SN){const e=(0,d().cb)({transaction:t,commentPointer:c.pointer,environment:o});if(!e)return;const{collectionStore:n,collectionPagePointer:i}=e;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i,collectionPagePointer:r}=e,a=(0,d().mE)({updateOperation:n,transaction:t,collectionStore:i,collectionPagePointer:r});d().L$({commentId:n.pointer.id});const l=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:a});if(d().Rw(n.pointer.id),"success"===(null==l?void 0:l.type)){if(l.data.success)return;throw h({errorCode:l.data.errorCode,syncCollectionType:i.getFormat().external_collection_type}),new Error(l.data.message)}var s;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(s=l.error)||void 0===s||null===(s=s.name)||void 0===s?void 0:s.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:c,syncedCollectionStore:n,collectionPagePointer:i}))}const g=t.operations.find((e=>{var t;return"update"===e.command&&1===e.path.length&&"properties"===e.path[0]&&(null===(t=e.args)||void 0===t?void 0:t.source)}));if(g){const e=(0,d().m0)({transaction:t,updateOperation:g,environment:o});if(!e)return;try{await async function(e){var t;const{transaction:o,environment:n,updateOperation:i,syncedCollectionStore:r,collectionPagePointer:l,commentPointer:s}=e,c=a().q4_(null===(t=i.args)||void 0===t?void 0:t.source);if(!c)return;const d=c.split("/").pop(),u=(g=c,new URL(g).pathname.slice(1));var g;if(!d)return;const m={spaceId:o.spaceId,syncType:r.getFormat().external_collection_type,syncCollectionUpdates:[{collectionPagePointer:l,notionCommentId:s.id,attachment:{fileName:d,s3Data:{path:u}},updateType:"APPEND_ATTACHMENT"}]},f=await p().callApi({eventName:"updateSyncedCollectionData",environment:n,data:m});if("success"===(null==f?void 0:f.type)){if(f.data.success)return;throw h({errorCode:f.data.errorCode,syncCollectionType:r.getFormat().external_collection_type}),new Error(f.data.message)}var y;throw h({syncCollectionType:r.getFormat().external_collection_type}),new Error((null===(y=f.error)||void 0===y||null===(y=y.name)||void 0===y?void 0:y.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:g,syncedCollectionStore:e.collectionStore,collectionPagePointer:e.collectionPagePointer,commentPointer:e.commentPointer})}catch(l){const n=new(u().jg)(o,e.commentPointer),r=new(u().Bv)(o,{id:g.pointer.id,table:i().ev,spaceId:t.spaceId});throw n&&r&&f().createAndCommit({userAction:"Comment.handleRemoveFileFromActionsDueToSyncFailure",environment:o,canUndo:!0,perform:e=>{s().L6({commentStore:n,fileBlocks:[r],transaction:e})}}),l}return}}catch(l){throw h({}),l}}function h(e){const{errorCode:t,syncCollectionType:o,propertyName:n}=e,i=c().A.getIntl();if(!o)return void m().yq({item:{label:i.formatMessage({id:"syncedCollectionUpdateError.syncCollectionTypeMissing",defaultMessage:"Failed to update: incorrect sync collection setup"})}});if(!t)return void m().yq({item:{label:`Failed to update ${n??o}`}});const r=d().LA({syncCollectionType:o,errorCode:t,intl:i});m().yq({item:{label:r}})}},755735:(e,t,o)=>{"use strict";o.d(t,{B:()=>d});var n=o(296540),i=()=>o(56366),r=()=>o(383594),a=()=>o(419357),l=()=>o(486666),s=o(474848);const c=o(757695).default.createClass("",{name:"InputStore"}),d=n.forwardRef((function(e,t){const{placeholder:d,focusInitial:u,selectAll:p,disabled:g,inputOuterStyle:m,iconButton:f,inputRightButton:y,initialValue:S,onBlur:h,onSubmit:v,onChange:x,maxLength:C,textWrapperStyle:b,textarea:w}=e,j=(0,o(484714).v3)(),[A,_]=(0,n.useState)(S||""),M=(0,i().uB)(e.inputStore,c),k=(0,i().O$)(M)||A,I=(0,n.useCallback)((()=>{h(k)}),[k,h]),T=(0,n.useCallback)((()=>{v(k)}),[k,v]),P=(0,n.useCallback)((e=>{const t=e.target.value;_(t),M&&M.setState(t),x&&x(t)}),[M,x]),B=(0,o(336811).O)();return(0,n.useEffect)((()=>{e.inputStore&&M.setState(S)}),[]),(0,n.useEffect)((()=>()=>{B.current&&S!==k&&h(k)}),[S,k,B,h]),(0,s.jsx)(a().Ay,{ref:t,focusInitial:u,selectAll:p,value:k,onChange:P,onBlur:I,onSubmit:T,placeholder:d,disabled:g,textWrapperStyle:{opacity:g?.4:void 0,...b},maxlength:C,inputOuterStyle:m,left:f&&(0,s.jsx)(a().KF,{icon:f.icon,iconStyle:f.iconStyle,onClick:e=>function(e,t,n){if(!(n&&e.target instanceof Element))return;const i=o(972435).A.getIntl(),{onSubmit:a,enforceIconColor:s,includeEmojiTab:c}=n;r().W(t,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:l().GF,popupWidth:l().jv,showArrow:!0,title:i.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:c?[{type:"emoji",onChange:(e,t)=>{a(e),t&&t.keepVisible||r().I()}},{type:"icon",enforceIconColor:s,onChange:(e,t)=>{a(e),t&&t.keepVisible||r().I()}}]:[{type:"icon",enforceIconColor:s,onChange:(e,t)=>{a(e),t&&t.keepVisible||r().I()}}],onDelete:()=>{a(),r().I()}})}(e,j,f),disabled:g,style:{opacity:g?.4:void 0},backgroundColor:f.backgroundColor}),showClearButton:!1,inputRight:y,textarea:w,style:{paddingLeft:6}})}))},759709:(e,t,o)=>{"use strict";o.d(t,{O:()=>l});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(989423);function l(e){let{collectionContextStore:t,shownTemplateIds:o,origin:l}=e;const s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getWorkflowTemplateId()}),[t]),d=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!d.current&&o.length>0&&((0,a().u4)({environment:s,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:l,collection_template_id:c,template_ids_shown:o}}}),d.current=!0)}))}},768627:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});class n extends(()=>o(757695))().default{getInitialState(){return{searchQuery:"",searchLimit:n.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}n.limitIncrement=20,n.resultsCacheTTL=2*o(720665).Xb,n.incrementScrollOffset=200;const i=n},793863:(e,t,o)=>{"use strict";o.d(t,{H:()=>k,Mq:()=>T,oA:()=>I});o(581454);var n=o(296540),i=()=>o(56366),r=()=>o(401497),a=()=>o(428045),l=()=>o(467730),s=()=>o(47966),c=()=>o(571731),d=()=>o(598985),u=()=>o(919709),p=()=>o(959013),g=()=>o(496603),m=()=>o(939740),f=()=>o(554509),y=()=>o(89924),S=()=>o(902842),h=()=>o(338907),v=()=>o(913454),x=()=>o(32454),C=()=>o(458097),b=()=>o(84817),w=()=>o(115512),j=o(474848);const A=n.forwardRef(((e,t)=>{const{icon:n,label:i,description:a,...l}=e,s=(0,r().IS)((e=>({button:{width:"100%",borderRadius:12,margin:0,...(0,w().nl)({width:1,color:e.stroke.input})},hovered:{background:e.modalBackground,...(0,w().nl)({width:2,color:e.stroke.uiBlueSecondary})},pressed:{background:e.modalBackground,...(0,w().nl)({width:2,color:e.stroke.uiBluePrimary})},templateIcon:{marginTop:a?2:0},enterIcon:{width:16,justifySelf:"end",color:e.icon.tertiary}})),[a]);return(0,j.jsx)(o(760217).A,{...l,buttonStyle:s.button,hoveredStyle:s.hovered,pressedStyle:s.pressed,itemMarginLeft:0,itemMarginRight:0,ref:t,title:(0,j.jsxs)(b().Y1,{direction:"horizontal",align:a?"top-left":"center-left",gap:12,padding:"12px 14px",children:[(0,j.jsx)("div",{style:s.templateIcon,children:n}),(0,j.jsxs)(b().Y1,{gap:4,children:[(0,j.jsx)(f().D,{styleName:"UIRegular-14px/Medium",children:i}),a&&(0,j.jsx)(f().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:a})]}),l.focused&&(0,o(356596).K)(s.enterIcon)]})})}));A.displayName="SearchResultButton";var _=()=>o(992032);function M(e){const{template:t,label:o,description:n}=e;return(0,j.jsx)(A,{icon:(0,j.jsx)(S().z,{template:t,size:18}),label:o??t.value.targetCollection.name,description:n??t.description,...e})}function k(e){let{query:t,onSelectTemplate:o,onAddEmptyPage:l,onAddEmptyDatabase:S,onMarketplaceClick:h,showEmptyPageButton:b}=e;const w=(0,i().K8)((()=>(0,v().getIsSetupGeneratorEnabled)()),[]),k=(0,r().IS)((e=>({optionIcon:{height:16,width:"auto",color:e.icon.secondary},section:{gap:8,padding:"0 0 8px 0"},sectionTitle:{padding:"16px 0 0 0",marginTop:0,marginBottom:4}})),[]),P=function(e){const t=(0,i().K8)((()=>I()),[]);return(0,n.useMemo)((()=>T(e,t)),[e,t])}(t),B=(0,i().K8)((()=>v().globalWorkflowTemplates.fromIdOfType({templateId:a().MH,type:"collection"})),[]),R=P.map((e=>({key:e.templateId,render:t=>{let{ref:o,...n}=t;return(0,j.jsx)(M,{template:e,...n})},action:()=>o(e,{type:"suggested_template",allOrderedTemplateIds:P.map((e=>e.templateId))})}))),V=(0,n.useMemo)((()=>w?{key:a().MH,render:e=>{let{ref:o,...n}=e;return(0,j.jsx)(M,{template:B,label:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.buildWithAiLabel",defaultMessage:"Build {searchQuery} with AI",values:{searchQuery:t}}),description:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.buildWithAiDescription",defaultMessage:"Use AI to generate a tailored setup"}),...n})},action:async()=>{o(B,{type:"ai_generated_template"});const e=C().A.state;if(!e.open||!e.setupGenerator)return;e.setupGenerator.store.setState({...e.setupGenerator.store.state,prompt:(0,u().x9d)(t)}),(0,x().moveToNextOnboardingStep)();await e.setupGenerator.submitPrompt({from:"initial-input"})&&(0,x().moveToNextOnboardingStep)()}}:void 0),[w,B,t,o]),F=(0,n.useMemo)((()=>(0,g().oE)([b?{key:"new-page",render:e=>(0,j.jsx)(A,{icon:(0,s().Y)(k.optionIcon),label:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.newPage",defaultMessage:"New {searchQuery} page",values:{searchQuery:t}}),...e}),action:()=>l({title:t})}:void 0,{key:"new-database",render:e=>(0,j.jsx)(A,{icon:(0,c().J)(k.optionIcon),label:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.newDatabase",defaultMessage:"New {searchQuery} database",values:{searchQuery:t}}),...e}),action:()=>S({title:t})},{key:"marketplace",render:e=>(0,j.jsx)(A,{icon:(0,d().J)(k.optionIcon),label:_().Ac,...e}),action:e=>h(e.event)}])),[b,k.optionIcon,t,l,S,h]),K=(0,n.useMemo)((()=>[{key:"collection-templates",items:(0,g().oE)([...R,V]),render:e=>(0,j.jsx)(y().A,{title:(0,j.jsx)(f().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.topResults",defaultMessage:"Top results"})}),style:k.section,desktopTitleStyle:k.sectionTitle,mobileTitleStyle:k.sectionTitle,...e})},{key:"more-options",items:F,render:e=>(0,j.jsx)(y().A,{title:(0,j.jsx)(f().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:(0,j.jsx)(p().sA,{id:"workflowTemplatesOnboardingModal.searchResults.moreOptions",defaultMessage:"More options"})}),style:k.section,desktopTitleStyle:k.sectionTitle,mobileTitleStyle:k.sectionTitle,...e})}]),[R,V,F,k]);return(0,j.jsx)(m().Ay,{initialFocus:0,type:m().Oh.Vertical,sections:K})}function I(){const e=g().sb([...(0,a().dj)({isM3_3Enabled:(0,h().Te)()}),...(0,a().Lh)({isM3_3Enabled:(0,h().Te)()})]);return v().globalWorkflowTemplates.allOfType({templateIds:e,type:"collection"})}function T(e,t){return(0,l().Ay)(e,t,(e=>`${e.value.targetCollection.name} ${e.description}`),{minThreshold:l().qR,normalizeFuzzyScore:!0})}},795656:(e,t,o)=>{"use strict";o.d(t,{$:()=>$,D:()=>J});o(898992),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(708685),s=()=>o(568063),c=()=>o(977345),d=()=>o(668725),u=()=>o(72135),p=()=>o(959013),g=()=>o(100622),m=()=>o(534177),f=()=>o(284371),y=()=>o(901952),S=()=>o(317909),h=()=>o(312296),v=()=>o(704152),x=()=>o(406699),C=()=>o(623580),b=()=>o(14235),w=()=>o(78901),j=()=>o(162010),A=()=>o(89924),_=()=>o(946548),M=()=>o(859428),k=()=>o(467730),I=()=>o(763884),T=()=>o(972435),P=()=>o(722872),B=()=>o(970585),R=()=>o(760217),V=()=>o(419357),F=()=>o(928600),K=()=>o(939740),D=o(474848);const L="LastUsedCurrency",O=o(757695).default.createClass("",{name:"NumberFormatFilterStore"});function E(e){const{collectionContextStore:t,collectionStore:o,property:a,schema:l,onClose:s}=e,c=(0,i().v3)(),d=(0,p().tz)(),g=(0,r().uB)(void 0,B().A),m=(0,r().uB)(void 0,O),f=(0,n.useCallback)((e=>{m.setState(e.target.value),g.setState({...g.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[m,g]),v=(0,r().O$)(m),x=(0,r().K8)((()=>function(e){const{environment:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,numberFormatFilterStore:a,onClose:l}=e,s=I().A.get({userId:t.currentUser.id,key:L}),c=(0,k().Ay)(a.state,(0,u().RQ)(s),(e=>e));return c.map((e=>{const a={key:e,render:t=>(0,D.jsx)(R().A,{...t,title:(0,u().gL)(T().A.getIntl(),e)}),action:()=>function(e){const{newFormat:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:a,onClose:l}=e,s=r[i];if(!s)return;if("number"!==s.type&&"formula"!==s.type)return;const c={...s,number_format:t,..."percent"===t&&void 0!==(null==s?void 0:s.show_as)?{show_as:{...null==s?void 0:s.show_as,maxValue:1}}:{}};"number"===s.type&&(0,u().SL)(t)&&I().A.set({userId:a.currentUser.id,key:L,value:t});S().createAndCommit({userAction:"NumberFormatMenu.handleNumberFormatChange",environment:a,canUndo:!0,perform:e=>{(0,h().F)({environment:a,collectionStore:n,update:{[i]:c},transaction:e})}}),(0,y().V)({environment:a,collectionContextStore:o,property:i,from:"view_settings",action:"number_change_format",number_format:t}),null==l||l()}({newFormat:e,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:t,onClose:l})};return a}))}({environment:c,collectionStore:o,collectionContextStore:t,property:a,schema:l,numberFormatFilterStore:m,onClose:s})),[t,c,o,a,l,m,s]),{device:C}=c;let b;b=C.isMobile?{menuType:P().gu.ActionSheet}:{menuType:P().gu.Popup};const w=!C.isMobile&&(0,D.jsx)(A().A,{isInput:!0,children:(0,D.jsx)(V().Ay,{value:v,onChange:f,focus:!0,focusAfterAnimation:!0,placeholder:d.formatMessage({defaultMessage:"Filter formats",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0})});return(0,D.jsx)(F().A,{...b,header:w,children:(0,D.jsx)(K().Ay,{type:K().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,D.jsx)(A().A,{...e}),items:x}],store:g})})}var z=()=>o(893952),N=()=>o(175116),U=()=>o(722372),H=()=>o(449476),W=()=>o(962730),G=()=>o(463830),q=()=>o(497222),Y=()=>o(828973);function $(e){const{collectionContextStore:t,property:o}=e,{propertySchema:i,numberFormat:a,numberPrecision:d}=(0,r().K8)((()=>{const e=t.collectionStore();if(!e)return{};const n=t.normalizedSchemaStore.state[o];if(!n)return{};if("number"===n.type)return{propertySchema:n,numberFormat:n.number_format??u().C4,numberPrecision:n.number_precision??u().pS};if("formula"===n.type)return"number"===(0,l().getFormulaPropertySchemaResultType)(n)?{propertySchema:n,numberFormat:n.number_format??u().C4,numberPrecision:n.number_precision??u().pS}:n.formula2&&"number"===(0,c().pg)(n.formula2.result_type).type?{propertySchema:n,numberFormat:n.number_format??u().C4,numberPrecision:u().pS}:{};if("rollup"===n.type){var i;if(n.aggregation&&"show_unique"!==n.aggregation){var r;const i=null===(r=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===r?void 0:r.targetPropertySchema;if(void 0===(null==i?void 0:i.type))return{};const a=(0,U().o_)(n.aggregation,(0,U().o_)(n.aggregation,"number_format"in i?i.number_format:void 0));return a?{propertySchema:n,numberFormat:a,numberPrecision:u().pS}:{}}const a=null===(i=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===i?void 0:i.targetPropertySchema;if("number"===(null==a?void 0:a.type)||"formula"===(null==a?void 0:a.type)&&"number"===(0,l().getFormulaPropertySchemaBaseResultType)(a))return{propertySchema:n,numberFormat:a.number_format??u().C4,numberPrecision:u().pS}}return{}}),[t,o]),p="rollup"!==(null==i?void 0:i.type),g=(0,n.useMemo)((()=>"formula"===(null==i?void 0:i.type)&&"number"!==(0,l().getFormulaPropertySchemaResultType)(i)),[i]),m="rollup"!==(null==i?void 0:i.type)&&!g;return i?(0,D.jsxs)(D.Fragment,{children:[p&&(0,D.jsx)(Q,{numberFormat:a,property:o}),m&&(0,D.jsx)(Z,{numberPrecision:d,property:o}),(0,D.jsx)(X,{property:o,propertySchema:i,numberFormat:a})]}):null}function Q(e){const{numberFormat:t,property:o}=e,a=(0,p().tz)(),{isMobile:l}=(0,i().Y0)(),s=(0,N().ET)(),c=(0,r().uB)(void 0,G().A),d=(0,r().K8)((()=>s.collectionStore()),[s]),g=(0,r().O$)(s.normalizedSchemaStore),m=(0,n.useCallback)((e=>(0,D.jsx)(q().A,{title:(0,D.jsx)(p().sA,{defaultMessage:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:(0,D.jsx)("span",{style:{...f().RC},children:(0,u().gL)(a,u().PA.find((e=>e===t))??u().C4)}),showChevron:!0,rotateChevron:c.state.open,...e})),[c,a,t]),y=(0,n.useCallback)((e=>d?(0,D.jsx)(E,{collectionContextStore:s,collectionStore:d,property:o,schema:g,onClose:e.close}):null),[s,d,o,g]);return(0,D.jsx)(x().Ay,{popupType:l?b().nl.SlideUp:b().nl.Popup,alignmentToOrigin:x().yP.End,renderOrigin:m,render:y,buttonPopupStore:c})}function Z(e){const{numberPrecision:t,property:o}=e,a=(0,p().tz)(),s=(0,i().v3)(),c=(0,N().ET)(),d=(0,r().K8)((()=>c.collectionStore()),[c]),g=(0,r().O$)(c.normalizedSchemaStore),m=(0,n.useMemo)((()=>{const e=g[o];if(!e)return;const t="formula"===e.type&&"number"===(0,l().getFormulaPropertySchemaResultType)(e);return"number"===e.type||t?e:void 0}),[o,g]),f=(0,n.useMemo)((()=>u().iv.map((e=>({key:e,type:"button",title:J(a,e)})))),[a]),v=(0,n.useCallback)((e=>{if(!d||!m)return;const t={...m,number_precision:e};S().createAndCommit({userAction:"NumberFormatMenu.handleNumberPrecisionChange",environment:s,canUndo:!0,perform:e=>{(0,h().F)({environment:s,collectionStore:d,update:{[o]:t},transaction:e})}}),(0,y().V)({environment:s,collectionContextStore:c,property:o,from:"view_settings",action:"number_change_precision",number_precision:e})}),[c,d,s,o,m]),x=(0,n.useCallback)((()=>(0,D.jsx)(p().sA,{defaultMessage:"Round to a specified number of decimal places. The underlying remains unchanged.",id:"database.viewSettings.numberOptions.numberPrecision.tooltip"})),[]),C=(0,n.useCallback)((e=>(0,D.jsx)(Y().A,{...e,title:(0,D.jsx)(p().sA,{defaultMessage:"Decimal places",id:"database.viewSettings.numberOptions.numberPrecision"}),selectedKey:t,options:f,onChange:v})),[v,t,f]);return(0,D.jsx)(M().A,{placement:W().W.Right,textWrap:!0,renderTooltip:x,render:C})}function J(e,t){switch(t){case"precision_uncapped":return e.formatMessage({id:"collection.numberFormat.precisionUncapped",defaultMessage:"Default"});case"precision_0":return e.formatMessage({id:"collection.numberFormat.precision0",defaultMessage:"0"});case"precision_1":return e.formatMessage({id:"collection.numberFormat.precision1",defaultMessage:"1"});case"precision_2":return e.formatMessage({id:"collection.numberFormat.precision2",defaultMessage:"2"});case"precision_3":return e.formatMessage({id:"collection.numberFormat.precision3",defaultMessage:"3"});case"precision_4":return e.formatMessage({id:"collection.numberFormat.precision4",defaultMessage:"4"});case"precision_5":return e.formatMessage({id:"collection.numberFormat.precision5",defaultMessage:"5"});default:(0,m().HB)(t)}}function X(e){const{property:t,propertySchema:o,numberFormat:l}=e,{show_as:s}=o,c=(0,i().v3)(),u=(0,a().DP)(),m=(0,N().ET)(),b=(0,n.useRef)({color:(null==s?void 0:s.color)??"green",maxValue:(null==s?void 0:s.maxValue)??100,showValue:(null==s?void 0:s.showValue)??!0}),M=(0,r().K8)((()=>H().A.state.isOpen),[]),k={type:(null==s?void 0:s.type)??"number",color:(null==s?void 0:s.color)??b.current.color,maxValue:(null==s?void 0:s.maxValue)??b.current.maxValue,showValue:(null==s?void 0:s.showValue)??b.current.showValue},I=(0,a().IS)((e=>({card:{boxSizing:"content-box",height:36,flex:1,margin:1,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.mediumTextColor,borderRadius:6,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:6,paddingBottom:6,cursor:"pointer",background:M?e.cardContentBackground:void 0},cardHoveredStyle:{background:M?e.cardContentBackground:void 0},cardPressedStyle:{background:M?e.cardContentBackground:void 0},selectedCard:{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor},cardVisual:{height:20,marginBottom:4,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},cardText:{lineHeight:1,fontSize:12},progressBar:{width:"100%"},showAsTypeOption:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginLeft:M?12:16,marginRight:16,marginTop:6,gap:12},extraOptionStyle:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:16,paddingRight:16,gap:16,height:28,width:"100%"}})),[M]),T=(0,n.useCallback)((e=>{const n=m.collectionStore();o&&n&&(S().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:c,canUndo:!0,perform:i=>{(0,h().F)({environment:c,collectionStore:n,update:{[t]:{...o,show_as:e}},transaction:i})}}),(0,y().V)({environment:c,collectionContextStore:m,property:t,from:"view_settings",action:"number_change_show_as",number_show_as:(null==e?void 0:e.type)??"number"}))}),[m,c,t,o]),P=(0,n.useMemo)((()=>[{key:"number",visual:(0,D.jsx)("div",{style:{fontSize:16,fontWeight:f().Wy.medium},children:"42"}),text:(0,D.jsx)(p().sA,{defaultMessage:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:(0,D.jsx)(w().z,{percentage:50,filledColor:"bar"===k.type?u.blueColor:u.accentColors.translucentGray[500],unfilledColor:"bar"===k.type?u.accentColors.uiBlue[300]:u.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,D.jsx)(p().sA,{defaultMessage:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:(0,D.jsx)(j().C,{size:20,percentage:40,filledColor:"ring"===k.type?u.blueColor:u.accentColors.translucentGray[500],unfilledColor:"ring"===k.type?u.accentColors.uiBlue[300]:u.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,D.jsx)(p().sA,{defaultMessage:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}]),[k.type,u.blueColor,u.accentColors]),B=(0,D.jsx)("div",{style:I.showAsTypeOption,children:P.map((e=>{const t=k.type===e.key;return(0,D.jsxs)(v().A,{onClick:()=>{const t="number"===e.key?void 0:{type:e.key,color:k.color,maxValue:"percent"===l?1:k.maxValue,showValue:k.showValue};void 0!==t&&(b.current=t),T(t)},style:{...I.card,...t?I.selectedCard:{}},hoveredStyle:I.cardHoveredStyle,pressedStyle:I.cardPressedStyle,children:[(0,D.jsx)("div",{style:I.cardVisual,children:e.visual}),(0,D.jsx)("div",{style:I.cardText,children:e.text})]},e.key)}))}),R=e=>{const t="number"!==k.type?{...k,type:k.type,...e}:void 0;void 0!==t&&(b.current=t),T(t)},V="number"!==k.type?(0,D.jsxs)("div",{style:I.extraOptionStyle,children:[(0,D.jsx)("div",{style:{flex:6,fontSize:14},children:(0,D.jsx)(p().sA,{defaultMessage:"Color",id:"database.viewSettings.numberOptions.color"})}),(0,D.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:6,gap:7},children:(0,D.jsx)(x().Ay,{popupType:c.device.isMobile?x().z7.SlideUp:x().z7.Popup,renderOrigin:e=>(0,D.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},...e,children:(0,D.jsx)(z().A,{color:k.color,focused:!1,buttonStyle:{width:"auto",marginLeft:0,marginRight:0,borderRadius:6,color:u.lightTextColor},style:{minHeight:36},right:(0,d().b)({width:12,height:12})})}),render:e=>{const t=g().tS.map((t=>(0,D.jsx)(z().A,{color:t,checkState:t===k.color,focused:!1,style:{width:"100%"},onClick:()=>{R({color:t}),e.close()}},t)));return(0,D.jsx)("div",{style:{minWidth:150,paddingTop:8,paddingBottom:8},children:t})}})})]}):null,F="number"!==k.type?"percent"!==l&&(0,D.jsxs)("div",{style:I.extraOptionStyle,children:[(0,D.jsx)("div",{style:{flex:6,fontSize:14},children:(0,D.jsx)(p().sA,{defaultMessage:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})}),(0,D.jsx)("div",{style:{flex:6},children:(0,D.jsx)(C().A,{value:k.maxValue.toString(),onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,""),o=parseFloat(t);!isNaN(o)&&o>0&&R({maxValue:o})},inputStyle:{textAlign:"right"}})})]}):null,K="number"!==k.type?(0,D.jsxs)("div",{style:I.extraOptionStyle,children:[(0,D.jsx)("div",{style:{flex:6,fontSize:14},children:(0,D.jsx)(p().sA,{defaultMessage:"Show number",id:"database.viewSettings.numberOptions.showValue"})}),(0,D.jsx)("div",{style:{flex:6,display:"flex",justifyContent:"flex-end"},children:(0,D.jsx)(_().A,{on:k.showValue,onClick:()=>{R({showValue:!k.showValue})},disabled:!1})})]}):null,L=Boolean(V||F||K)?(0,D.jsxs)("div",{style:{backgroundColor:M?u.cardContentBackground:u.accentColors.gray[30],boxShadow:M?`0 0 0 1px ${u.regularDividerColor}`:void 0,borderRadius:5,marginTop:12,marginLeft:M?12:16,marginRight:16,paddingTop:12,paddingBottom:12,maxHeight:1e3,transition:"max-height 0.5s ease-in-out",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[V,F,K]}):null;return(0,D.jsxs)(A().A,{title:(0,D.jsx)(p().sA,{defaultMessage:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0,children:[B,L,!M&&(0,D.jsx)("div",{style:{marginTop:12,marginLeft:18,marginRight:18,fontSize:12,color:u.lightTextColor},children:(0,D.jsx)(p().sA,{id:"database.CollectionSettings.NumberOptions.applyAllViews",defaultMessage:"Changes apply to all views showing this property."})})]})}},798174:(e,t,o)=>{"use strict";o.d(t,{C:()=>T,A:()=>P});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(67657),l=()=>o(970013),s=()=>o(668725),c=()=>o(959013),d=()=>o(989423);var u=()=>o(497222),p=()=>o(175116),g=()=>o(722372),m=()=>o(476492),f=()=>o(722872),y=()=>o(553965),S=()=>o(463830),h=()=>o(630116),v=()=>o(760217),x=()=>o(406699),C=()=>o(939740),b=()=>o(14235),w=()=>o(89924),j=()=>o(859428),A=()=>o(717402),_=()=>o(195071),M=()=>o(250202),k=()=>o(150987),I=o(474848);let T=function(e){return e[e.BlockPropertyOverlay=0]="BlockPropertyOverlay",e[e.ViewSettings=1]="ViewSettings",e}({});const P=function(e){let{context:t,schema:n,property:a,parentStore:l,onDismiss:s,disabled:d,analyticsFrom:p,onChange:g}=e;const m=(0,o(401497).DP)(),h=(0,i().v3)(),v=(0,r().uB)(void 0,S().A),w=(0,r().uB)(void 0,S().A),_=(0,r().uB)(void 0,S().A),M=(0,i().Y0)(),k=(0,r().K8)((()=>B(n,a,l)),[n,a,l]),P=Boolean(null==k?void 0:k.propertySchema.relation_property),K=Boolean((null==k?void 0:k.propertySchema.relation_property)&&(null==k?void 0:k.propertySchema.target_property)),D=(0,r().K8)((()=>o(496603).oE([W(h,m,d,n,a,l,p,_,g),G(P,h,m,d,n,a,l,p,w,g),q(K,h,m,d,n,a,l,p,v,g)])),[P,K,h,m,d,n,a,l,p,g,v,_,w]),L=(0,r().K8)((()=>v.state.open),[v]),O=(0,r().K8)((()=>_.state.open),[_]),E=(0,r().K8)((()=>w.state.open),[w]);if(!k)return null;if(t===T.BlockPropertyOverlay){let e;return e=M.isMobile?{menuType:f().gu.Modal,title:k.propertySchema.name,right:(0,I.jsx)(o(45552).DoneMenuText,{}),onClickRight:s}:{menuType:f().gu.Popup},(0,I.jsx)(o(928600).A,{...e,children:(0,I.jsx)(C().Ay,{type:C().Oh.Vertical,initialFocus:void 0,sections:D})})}return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x().Ay,{popupType:M.isMobile?b().nl.SlideUp:b().nl.Popup,alignmentToOrigin:x().yP.End,renderOrigin:e=>(0,I.jsx)(u().A,{title:(0,I.jsx)(c().sA,{defaultMessage:"Relation",id:"database.viewSettings.rollupOptions.relationProperty"}),disabled:d,showChevron:!0,rotateChevron:O,right:k.relationPropertySchema?(0,I.jsx)(A().Ay,{propertySchema:k.relationPropertySchema,showIcon:!0}):(0,I.jsx)(c().sA,{id:"database.viewSettings.rollupOptions.selectRelation",defaultMessage:"Select"}),...e}),render:e=>(0,I.jsx)(N,{parent:e,analyticsFrom:p,schema:n,property:a,parentStore:l,onChange:g}),buttonPopupStore:_}),(0,I.jsx)(j().A,{renderTooltip:()=>(0,I.jsx)(V,{}),disableTooltip:P,render:e=>(0,I.jsx)(x().Ay,{popupType:M.isMobile?b().nl.SlideUp:b().nl.Popup,alignmentToOrigin:x().yP.End,renderOrigin:t=>(0,I.jsx)(u().A,{title:(0,I.jsx)("span",{style:{...!K&&{color:m.mediumTextColor}},children:(0,I.jsx)(c().sA,{defaultMessage:"Property",id:"database.viewSettings.rollupOptions.targetProperty"})}),disabled:!P||d,showChevron:!0,rotateChevron:E,right:P&&(k.targetPropertySchema?(0,I.jsx)(A().Ay,{propertySchema:k.targetPropertySchema,showIcon:!0}):(0,I.jsx)(c().sA,{id:"database.viewSettings.rollupOptions.selectTargetProperty",defaultMessage:"Select"})),...(0,y().A)(e,t)}),render:e=>(0,I.jsx)(U,{parent:e,analyticsFrom:p,schema:n,property:a,parentStore:l,onChange:g}),buttonPopupStore:w})}),(0,I.jsx)(j().A,{renderTooltip:()=>(0,I.jsx)(F,{}),disableTooltip:K,render:e=>(0,I.jsx)(x().Ay,{popupType:M.isMobile?b().nl.SlideUp:b().nl.Popup,alignmentToOrigin:x().yP.End,renderOrigin:t=>(0,I.jsx)(u().A,{disabled:!K||d,title:(0,I.jsx)("span",{style:{...!K&&{color:m.mediumTextColor}},children:(0,I.jsx)(c().sA,{defaultMessage:"Calculate",id:"database.viewSettings.rollupOptions.calculate"})}),showChevron:!0,rotateChevron:L,right:K&&(0,I.jsx)(R,{schema:n,property:a,parentStore:l}),...(0,y().A)(e,t)}),render:e=>(0,I.jsx)(H,{parent:e,analyticsFrom:p,schema:n,property:a,parentStore:l,onChange:g}),buttonPopupStore:v})})]})};function B(e,t,o){var n;const i=e[t];if(!i)return;let r,a;if(i.relation_property){const t=e[i.relation_property];t&&"relation"===t.type&&(r=t)}if(r){const e=l().Nv(r);a=e?h().md.createChildStore(o,e):void 0}const s=null===(n=a)||void 0===n?void 0:n.getValue(),c=s?l().Dp(s):{};let d;if(s&&i.target_property){var u;d=c[(null===(u=a)||void 0===u?void 0:u.getMappedProperty(i.target_property))??i.target_property]}return{propertySchema:i,relationPropertySchema:r,relatedCollectionValue:s,relatedCollectionSchema:c,targetPropertySchema:d}}function R(e){let{schema:t,property:o,parentStore:n}=e;const i=(0,r().K8)((()=>B(t,o,n)),[n,o,t]);return i?i.propertySchema.aggregation?(0,I.jsx)(I.Fragment,{children:g().zY[(0,a().ZP)(i.propertySchema.aggregation)]}):(0,I.jsx)(c().sA,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}):null}function V(){return(0,I.jsx)(c().sA,{id:"database.rollupProperty.editProperty.tooltip",defaultMessage:"Select an existing relation first."})}function F(){return(0,I.jsx)(c().sA,{id:"database.rollupProperty.editAggregate.tooltip",defaultMessage:"Select an existing relation and property first."})}function K(e,t){return e?void 0:(0,s().b)({width:11,fill:t.mediumIconColor})}function D(e){return"relation"===e.type}function L(e){return"rollup"!==e.type&&!l().Hk.includes(e.type)}function O(e,t,o,n,i,r,a,l){const s=B(n,i,r);if(!s)return;const c={...s.propertySchema,relation_property:e,target_property:"title",target_property_type:"title",aggregation:void 0};null==a||a({propertySchema:c}),function(e,t){d().vd(e,"configure_rollup_relation",t)}(t,{...(0,m().sl)(l),from:o})}function E(e,t,o,n,i,r,a,l){const s=B(n,i,r);if(!s||!s.relatedCollectionValue||!s.relatedCollectionSchema)return;const c=s.relatedCollectionSchema[e];if(!c)return;const u={...s.propertySchema,target_property:e,target_property_type:c.type,aggregation:void 0};null==a||a({propertySchema:u}),function(e,t){d().vd(e,"configure_rollup_target_property",t)}(t,{...(0,m().sl)(l),from:o,property_type:c.type})}function z(e,t,o,n,i,r,l,s){const c=B(n,i,r);if(!c)return;const u={...c.propertySchema,aggregation:e,show_as:void 0};null==l||l({propertySchema:u});const p=e?(0,a().ZP)(e):void 0;!function(e,t){d().vd(e,"configure_rollup_aggregation",t)}(t,{...(0,m().sl)(s),from:o,aggregation:p})}function N(e){let{parent:t,analyticsFrom:o,schema:r,property:a,parentStore:l,onChange:s}=e;const c=(0,i().v3)(),d=(0,p().ET)(),u=(0,n.useCallback)((e=>O(e,c,o,r,a,l,s,d)),[c,o,r,a,l,s,d]);return(0,I.jsx)(k().A,{schema:r,isRelationProperty:!0,onAccept:u,onClose:t.close,allowProperty:D})}function U(e){let{parent:t,analyticsFrom:o,schema:a,property:l,parentStore:s,onChange:c}=e;const d=(0,i().v3)(),u=(0,p().ET)(),g=(0,n.useCallback)((e=>E(e,d,o,a,l,s,c,u)),[d,o,a,l,s,c,u]),m=(0,r().K8)((()=>B(a,l,s)),[s,l,a]);return m?(0,I.jsx)(k().A,{isRelationProperty:!1,schema:m.relatedCollectionSchema,onAccept:g,allowProperty:L,onClose:t.close}):null}function H(e){let{parent:t,analyticsFrom:o,schema:a,property:l,parentStore:s,onChange:d}=e;const u=(0,i().v3)(),g=(0,p().ET)(),m=(0,n.useCallback)((e=>z(e,u,o,a,l,s,d,g)),[u,o,a,l,s,d,g]),f=(0,r().K8)((()=>B(a,l,s)),[s,l,a]);return f&&f.propertySchema.target_property?(0,I.jsx)(_().A,{property:f.propertySchema.target_property,schema:f.relatedCollectionSchema,currentAggregation:f.propertySchema.aggregation?{aggregator:f.propertySchema.aggregation,property:f.propertySchema.target_property}:void 0,onChange:m,onClose:t.close,noneText:(0,I.jsx)(c().sA,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),source:"rollupPropertyMenu"}):null}function W(e,t,o,n,i,r,a,l,s){const{device:d}=e,u=B(n,i,r);if(u)return{key:0,render:e=>(0,I.jsx)(w().A,{...e,title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.editRelation.title",defaultMessage:"Relation"})}),items:[{key:0,render:e=>(0,I.jsx)(x().Ay,{popupType:d.isMobile?b().nl.SlideUp:b().nl.Popup,renderOrigin:n=>u.relationPropertySchema?(0,I.jsx)(M().G,{...(0,y().A)(e,n),propertySchema:u.relationPropertySchema,format:M().e.Name,right:K(o,t),disabled:o}):(0,I.jsx)(v().A,{...(0,y().A)(e,n),title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.editRelation.buttonTitle",defaultMessage:"Select an existing relation"}),right:K(o,t),style:{color:t.mediumTextColor},disabled:o}),render:e=>(0,I.jsx)(N,{parent:e,analyticsFrom:a,schema:n,property:i,parentStore:r,onChange:s}),buttonPopupStore:l},e.key),action:()=>{l.setState({open:!0})}}]}}function G(e,t,o,n,i,r,a,l,s,d){const{device:u}=t,p=B(i,r,a);if(p)return{key:1,render:e=>(0,I.jsx)(w().A,{...e,title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.editProperty.title",defaultMessage:"Property"}),topBorder:!0}),items:[{key:0,render:t=>(0,I.jsx)(j().A,{renderTooltip:()=>(0,I.jsx)(V,{}),disableTooltip:e,render:g=>(0,I.jsx)(x().Ay,{popupType:u.isMobile?b().nl.SlideUp:b().nl.Popup,renderOrigin:i=>p.targetPropertySchema?(0,I.jsx)(M().G,{...(0,y().A)(t,i),propertySchema:p.targetPropertySchema,format:M().e.Name,right:K(n,o),disabled:n}):(0,I.jsx)(v().A,{...(0,y().A)(t,g),title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.editProperty.buttonTitle",defaultMessage:"Select a property to display"}),right:K(!e||n,o),disabled:!e||n,disabledFeedback:!0}),render:e=>(0,I.jsx)(U,{parent:e,analyticsFrom:l,schema:i,property:r,parentStore:a,onChange:d}),buttonPopupStore:s})},t.key),action:()=>{s.setState({open:!0})}}]}}function q(e,t,o,n,i,r,a,l,s,d){const{device:u}=t;if(B(i,r,a))return{key:2,render:e=>(0,I.jsx)(w().A,{...e,title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.editAggregate.title",defaultMessage:"Calculate"}),topBorder:!0}),items:[{key:0,render:t=>(0,I.jsx)(j().A,{renderTooltip:()=>(0,I.jsx)(F,{}),disableTooltip:e,render:p=>e?(0,I.jsx)(x().Ay,{popupType:u.isMobile?b().nl.SlideUp:b().nl.Popup,renderOrigin:e=>(0,I.jsx)(v().A,{...(0,y().A)(t,e),title:(0,I.jsx)(R,{schema:i,property:r,parentStore:a}),right:K(n,o),disabled:n}),render:e=>(0,I.jsx)(H,{parent:e,analyticsFrom:l,schema:i,property:r,parentStore:a,onChange:d}),buttonPopupStore:s}):(0,I.jsx)(v().A,{...(0,y().A)(t,p),title:(0,I.jsx)(c().sA,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),right:K(n,o),disabled:!0,disabledFeedback:!0})},t.key),action:()=>{s.setState({open:!0})}}]}}},813197:(e,t,o)=>{"use strict";o.d(t,{L:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M8.848 3.085c.34.06.567.384.507.724l-.61 3.466h3.42l.65-3.683a.625.625 0 0 1 1.23.216l-.61 3.467h2.435a.625.625 0 1 1 0 1.25h-2.655l-.52 2.95h2.435a.625.625 0 0 1 0 1.25h-2.655l-.65 3.684a.625.625 0 0 1-1.23-.217l.61-3.467h-3.42l-.65 3.684a.625.625 0 0 1-1.23-.217l.61-3.467H4.13a.625.625 0 1 1 0-1.25h2.605l.52-2.95H4.87a.625.625 0 0 1 0-1.25h2.605l.65-3.683a.625.625 0 0 1 .723-.507m2.578 8.39.52-2.95H8.523l-.52 2.95z"})},i=(0,o(340498).wt)("number",n)},815416:(e,t,o)=>{"use strict";o.d(t,{a:()=>v});o(296540);var n=()=>o(401497),i=()=>o(151744),r=()=>o(632625),a=()=>o(589982),l=()=>o(563884),s=()=>o(747651),c=()=>o(658985),d=o(474848);const u=(0,o(340498).wt)("nest",{viewBox:"0 0 16 16",svg:(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,d.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,d.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,d.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})});var p=()=>o(385527),g=()=>o(713838),m=()=>o(248823),f=()=>o(328327),y=()=>o(374562),S=()=>o(646668);const h={[(0,y().kr)().uri]:o(880261).v,[(0,y().Xq)().uri]:l().k,[(0,o(326224).nU)().uri]:c().$,[(0,f().Ub)().uri]:o(974967).n,[(0,f().mU)().uri]:o(50170).u,[(0,f().$$)().uri]:p().h,[(0,f().AN)().uri]:l().k,[(0,f().PA)().uri]:g().e,[(0,f().l3)().uri]:c().$,[(0,f().Sg)().uri]:a().u,[(0,f().NP)().uri]:a().u,[(0,S().rr)().uri]:o(173019).r,[(0,S().uo)().uri]:o(318890).K,[(0,S().Rh)().uri]:o(981714).u,[(0,y().md)().uri]:u,[(0,y().J4)().uri]:o(582542).E,[(0,m().ft)().uri]:p().h,[(0,m().Li)().uri]:g().e};function v(e){const{feature:t}=e,o=(0,n().IS)((e=>{var o,n;return{featureIconWrapper:{height:28,width:28,padding:"6px 0px",backgroundColor:null===(o=x(t,e))||void 0===o?void 0:o[30],borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto",fill:null===(n=x(t,e))||void 0===n?void 0:n[400]}}}),[t]),i=(0,n().DP)();if(!t.icon){const e=h[t.uri]??s().x;return(0,d.jsx)("div",{style:o.featureIconWrapper,children:e(o.featureIcon)})}return(0,d.jsx)("div",{style:o.featureIconWrapper,children:(0,d.jsx)(r().A,{icon:t.icon,theme:i,size:16,style:o.featureIcon})})}function x(e,t){return e.isAi?t.accentColors.purple:(0,i().tK)(e.collectionUri,t)}},823882:(e,t,o)=>{"use strict";o.d(t,{h:()=>O});o(944114),o(898992),o(354520),o(672577),o(430670),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(784892),l=o(474848);const s={viewBox:"0 0 20 20",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M12.876 7.982a.625.625 0 1 0-1.072-.644L9.25 11.595 7.815 9.92a.625.625 0 1 0-.95.813l2 2.334a.625.625 0 0 0 1.01-.085z"}),(0,l.jsx)("path",{d:"M5.25 3.125A2.125 2.125 0 0 0 3.125 5.25v9.5c0 1.174.951 2.125 2.125 2.125h9.5a2.125 2.125 0 0 0 2.125-2.125v-9.5a2.125 2.125 0 0 0-2.125-2.125zM4.375 5.25c0-.483.392-.875.875-.875h9.5c.483 0 .875.392.875.875v9.5a.875.875 0 0 1-.875.875h-9.5a.875.875 0 0 1-.875-.875z"})]})},c=(0,o(340498).wt)("checkmarkSquare",s);var d=()=>o(748054),u=()=>o(236262),p=()=>o(519831),g=()=>o(959013),m=()=>o(100622),f=()=>o(496603),y=()=>o(284371),S=()=>o(901952),h=()=>o(193722),v=()=>o(596359),x=()=>o(901389),C=()=>o(539148),b=()=>o(705602),w=()=>o(828973),j=()=>o(175116),A=()=>o(476492),_=()=>o(722872),M=()=>o(377586),k=()=>o(831194),I=()=>o(575143),T=()=>o(419357),P=()=>o(928600),B=()=>o(939740),R=()=>o(45552),V=()=>o(14235),F=()=>o(89924),K=()=>o(893952),D=()=>o(399762);const L=o(757695).default.createClass(!1,{name:"ShowSelectDescriptionStore"});function O(e){let{onClose:t,collectionId:o,propertySchema:a,property:s,onChange:c,option:d,analyticsFrom:u,statusGroup:p,origin:g,open:m,alignmentToOrigin:f}=e;const y=(0,i().v3)(),S=(0,j().ET)(),h=(0,r().uB)(void 0,L),[v,x]=(0,n.useState)(""),C=(0,n.useRef)(m);(0,n.useEffect)((()=>{!C.current&&m&&x(d.value),C.current=m}),[m,d.value]);const b=(0,n.useCallback)((()=>(0,l.jsx)(E,{collectionContextStore:S,onClose:t,collectionId:o,propertySchema:a,property:s,onChange:c,option:d,analyticsFrom:u,statusGroup:p,renameInputValue:v,setRenameInputValue:x,showSelectDescriptionStore:h})),[S,t,o,a,s,c,d,u,p,v,x,h]),w=(0,n.useCallback)((()=>function(e,t,o,n,i,r,a,l,s){o(),z(e,t,n,i,r,a,l,s)}(y,S,t,o,a,s,c,d,v)),[y,S,t,o,a,s,c,d,v]),{device:A}=y;return(0,l.jsx)(V().Ay,{popupType:A.isMobile?M().n.SlideUp:M().n.Popup,open:m,onDismiss:w,origin:g,render:b,alignmentToOrigin:f})}function E(e){let{collectionContextStore:t,onClose:o,collectionId:s,propertySchema:f,property:S,onChange:j,option:M,analyticsFrom:V,statusGroup:L,renameInputValue:O,setRenameInputValue:E,showSelectDescriptionStore:N}=e;const U=(0,g().tz)(),H=(0,i().v3)(),W=(0,r().K8)((()=>t.collectionStore()),[t]),G=(0,n.useCallback)((e=>function(e,t){const o=e.target.value.replace(/,/g,"");t(o)}(e,E)),[E]),q=(0,n.useCallback)((()=>function(e,t,o,n,i,r,a,l,s){o(),z(e,t,n,i,r,a,l,s)}(H,t,o,s,f,S,j,M,O)),[H,t,o,s,f,S,j,M,O]),Y=(0,n.useCallback)((()=>{if(W)return function(e,t,o,n,i,r,a,l,s){v().r$({environment:e,option:t,property:i,propertySchema:n,collectionStore:a,statusGroup:l}),r(),(0,h().L)(e,{...(0,A().sl)(s),property_type:n.type,action:"select_delete_option",from:o})}(H,M,V,f,S,o,W,L,t)}),[H,M,W,V,f,S,o,L,t]),{device:$}=H,Q=(0,r().O$)(N),Z=[];Q&&Z.push({key:"description",render:e=>(0,l.jsx)(F().A,{...e,desktopStyle:{paddingTop:0},title:$.isMobile?U.formatMessage(b().s.descriptionHeader):void 0}),items:[{key:"description",render:e=>(0,l.jsx)(b().y,{...e,initialDescription:M.description,handleSaveDescription:e=>function(e,t,o,n,i,r,a,l){if(e===(l.description??""))return;const s={...l,description:e},c={pointer:{table:p().Vl,id:n},command:"keyedObjectListUpdate",path:["schema",i,"options"],args:{value:s}};o([c]),(0,h().L)(t,{property_type:r.type,action:"select_set_description",from:a})}(e,H,j,s,S,f,V,M),disableAutoSection:!0}),action:()=>{}}]});const J={key:"action",render:e=>(0,l.jsx)(F().A,{...e}),items:[]};Z.push(J),J.items.push({key:"delete",render:e=>(0,l.jsx)(I().A,{...e,title:(0,l.jsx)(g().sA,{id:"database.selectPropertyOptionEditMenu.deleteLabel",defaultMessage:"Delete"}),svg:u().I}),action:Y}),L&&"status"===f.type&&(J.items.push({key:"setAsDefault",render:e=>(0,l.jsx)(I().A,{...e,title:(0,l.jsx)(g().sA,{id:"database.selectPropertyOptionEditMenu.setAsDefault",defaultMessage:"Set as default"}),svg:d().M}),action:()=>async function(e,t,o,n,i,r,a,s,c){if("status"!==o.type||!c)return;if(r.value===o.defaultOption)return;if(void 0!==o.defaultOption){const{accept:e}=await x().Gh({mode:"wide",message:(0,l.jsx)(g().sA,{defaultMessage:'Change default to "{defaultValue}"?',id:"database.editProperty.setAsDefault.confirm.title",values:{defaultValue:r.value}}),description:(0,l.jsx)(g().sA,{defaultMessage:"New pages will start with {defaultValue} as the default status. Existing pages <b>without a status explicitly set</b> will switch to {defaultValue}.",id:"database.editProperty.setAsDefault.confirm.description",values:{defaultValue:r.value,b:e=>(0,l.jsx)("span",{style:{fontWeight:y().Wy.semibold},children:e})}}),acceptLabel:(0,l.jsx)(g().sA,{defaultMessage:"Continue",id:"database.editProperty.setAsDefault.confirm.continueButton"})});if(!e)return}const d={table:p().Vl,id:e},u=[],m={pointer:d,command:"update",path:["schema",t],args:{defaultOption:r.value}};u.push(m),n(u),a(),(0,h().L)(s,{property_type:o.type,action:"status_set_default",from:i,collection_id:e})}(s,S,f,j,V,M,o,H,L)}),J.items.push({key:"Group",render:e=>(0,l.jsx)("div",{...e,children:(0,l.jsx)(w().A,{...e,title:(0,l.jsx)(g().sA,{id:"database.selectPropertyOptionEditMenu.Group",defaultMessage:"Group"}),selectedKey:L.name,options:(f.groups??[]).map((e=>({key:e.name,type:"button",title:k().OR[e.name]??e.name}))),icon:c,onChange:e=>{!function(e,t,o,n,i,r,a,l,s){if("status"!==a.type||!s)return;const c={table:p().Vl,id:t},d=[],u=a.groups??[],g=u.findIndex((e=>e.id===s.id)),m=u.findIndex((t=>t.name===e));if(g===m)return;const f={pointer:c,command:"listRemove",path:["schema",n,"groups",g,"optionIds"],args:{id:o.id}},y={pointer:c,command:"listAfter",path:["schema",n,"groups",m,"optionIds"],args:{id:o.id}};d.push(f,y);const S=a.options??[],v=u.flatMap((e=>{const t=e.optionIds??[],o=S.filter((e=>t.includes(e.id)));return o})),x={pointer:c,command:"set",path:["schema",n,"options"],args:v};d.push(x),i(d),(0,h().L)(l,{property_type:a.type,action:"status_set_default",from:r,collection_id:t})}(e,s,M,S,j,V,f,H,L)}})}),action:()=>{}}));const X=m().tS.map((e=>{const t={key:e,render:t=>(0,l.jsx)(K().A,{...t,color:e,checkState:M.color===e}),action:()=>{!function(e,t,o,n,i,r,a,l){const s={...t,color:e},c={pointer:{table:p().Vl,id:o},command:"keyedObjectListUpdate",path:["schema",n,"options"],args:{value:s}};r([c]),(0,h().L)(l,{property_type:i.type,action:"select_change_color",from:a,collection_id:o})}(e,M,s,S,f,j,V,H)}};return t})),ee={key:"color",render:e=>(0,l.jsx)(F().A,{...e,title:(0,l.jsx)(g().sA,{id:"database.selectPropertyOptionEditMenu.colorsSection",defaultMessage:"Colors"}),topBorder:!0}),items:X};let te;return Z.push(ee),te=$.isMobile?{menuType:_().gu.Modal,title:(0,l.jsx)(D().O,{format:a().NY.Large,value:M.value,color:M.color,showRemoveButton:!1,isSingle:!0}),right:(0,l.jsx)(R().DoneMenuText,{}),onClickRight:q}:{menuType:_().gu.Popup,width:220},(0,l.jsxs)(P().A,{...te,children:[(0,l.jsx)(F().A,{isInput:!0,children:(0,l.jsx)(T().Ay,{focusInitial:!0,selectAll:!$.isMobile,value:O,maxlength:180,onChange:G,onSubmit:q,showClearButton:!1,inputRight:(0,l.jsx)(C().S,{onClick:()=>N.setState(!Q),description:M.description,showTooltip:!Q})})}),(0,l.jsx)(B().Ay,{type:B().Oh.Vertical,disableKeyboard:!0,initialFocus:void 0,sections:Z})]})}function z(e,t,o,n,i,r,a,s){const c=s,d=n.options||[],u=d.find((e=>e.id!==a.id&&e.value.trim().toLowerCase()===c.trim().toLowerCase()));if(a.value!==c)if(c)if(u)x().f1((0,l.jsx)(g().sA,{defaultMessage:"This select option already exists.",id:"database.editProperty.errorDialog.duplicateSelectValue.message"}));else{const l=d.find((e=>e.id===a.id));if(!l)return;const s=c.trim(),u={...l,value:s},g={pointer:{table:p().Vl,id:o},command:"keyedObjectListUpdate",path:["schema",i,"options"],args:{value:u}},m="status"===n.type&&a.value===n.defaultOption?{pointer:{table:p().Vl,id:o},command:"update",path:["schema",i],args:{defaultOption:s}}:void 0;r(f().oE([g,m])),(0,S().V)({environment:e,collectionContextStore:t,property:i,from:"view_settings",action:"select_rename_option",option_value_char_count:s.length})}else x().f1((0,l.jsx)(g().sA,{defaultMessage:"Please type a value.",id:"database.editProperty.errorDialog.missingSelectValue.message"}))}},878665:(e,t,o)=>{"use strict";o.d(t,{A:()=>d});var n=o(296540),i=()=>o(401497),r=()=>o(100622),a=()=>o(859428),l=()=>o(103448),s=()=>o(962730),c=o(474848);function d(e){const{render:t,showImage:o,caption:d,description:u,tooltipImage:p,placement:g,tooltipDelayThreshold:m,hideTooltipBeforeImageLoaded:f,imageContainerStyle:y}=e,S=e.tooltipImageScale||1,[h,v]=n.useState(!1),[x,C]=n.useState({width:0,height:0});n.useEffect((()=>{if(p){const e=new Image;e.src=p,e.onload=()=>{C({width:"number"==typeof S?e.width*S:S.widthPx,height:"number"==typeof S?e.width*S:S.heightPx}),v(!0)}}}),[p,S]);const b=(0,i().IS)((()=>({tooltip:{whiteSpace:"break-spaces"},description:{fontWeight:"normal",color:r().Ay.uiLightGray}})),[]),w=(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:d}),u&&(0,c.jsx)("div",{style:b.description,children:u})]});return(0,c.jsx)(a().A,{placement:g??s().W.Left,disableTooltip:void 0===d||!h&&f,delayThreshold:m,style:b.tooltip,render:t,renderTooltip:()=>p&&h&&o?(0,c.jsx)(l().A,{caption:w,imageURL:p,imageWidth:x.width,imageHeight:x.height,imageContainerStyle:y}):w})}},880261:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},885749:(e,t,o)=>{"use strict";o.d(t,{Ay:()=>u,cL:()=>c,uF:()=>s});o(898992),o(803949),o(581454);var n=o(296540),i=()=>o(959013),r=()=>o(406699),a=()=>o(939740),l=o(474848);const s=(0,i().YK)({hide:{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from Home"}}),c=20;function d(e){let{actions:t}=e;const d=(0,o(401497).IS)((e=>({hideButtonIcon:{height:c,width:c,fill:e.regularIconColor}})),[]),u=(0,i().tz)(),p=(0,n.useMemo)((()=>{const e={};return t.forEach((t=>{"custom"===t.type&&(e[t.item.key]=t.closeOnAccept)})),e}),[t]),g=[{key:"all",render:e=>(0,l.jsx)(o(89924).A,{...e}),items:t.map((e=>{switch(e.type){case"hide":return{key:"hide",render:e=>(0,l.jsx)(o(760217).A,{...e,icon:(0,o(207583).F)(d.hideButtonIcon),title:u.formatMessage(s.hide),style:{borderRadius:o(665579)._g}}),action:e.hide};case"custom":return e.item;default:(0,o(534177).HB)(e)}}))}];return(0,l.jsx)(r().Ay,{popupType:r().z7.Popup,alignmentToOrigin:r().yP.Center,originGap:2,renderOrigin:e=>(0,l.jsx)(o(167068).A,{...e}),render:e=>(0,l.jsx)(o(928600).A,{menuType:o(722872).gu.Popup,children:(0,l.jsx)(a().Ay,{onAccept:t=>((e,t)=>{p[e.key]&&t.close()})(t,e),type:a().Oh.Vertical,sections:g,initialFocus:void 0})})})}const u=n.memo(d)},916727:(e,t,o)=>{"use strict";o.d(t,{F:()=>s});o(296540);var n=()=>o(401497),i=()=>o(66913),r=()=>o(284371),a=()=>o(704152),l=o(474848);function s(e){const{title:t,icon:o,style:s,children:c,right:d,showCloseButton:u,onClose:p}=e,g=(0,n().DP)(),m=(0,l.jsx)(a().A,{onClick:p,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,i().V)({width:14,fill:g.mediumTextColor})});return(0,l.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:g.accentColors.orange[50],borderRadius:6,...s},children:[t&&(0,l.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,l.jsx)("div",{style:{fontWeight:r().Wy.medium,flexGrow:1,...r().RC},children:t}),u?m:d]}),c]})}},926203:(e,t,o)=>{"use strict";o.d(t,{$g:()=>R,Eg:()=>K,Wf:()=>N,Xm:()=>L,aH:()=>V,pz:()=>D,qd:()=>B,v9:()=>U});o(898992),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(970013),s=()=>o(726275),c=()=>o(212727),d=()=>o(236262),u=()=>o(959013),p=()=>o(183558),g=()=>o(534177),m=()=>o(284371),f=()=>o(436696),y=()=>o(966759),S=()=>o(235191),h=()=>o(686526),v=()=>o(901389),x=()=>o(246826),C=()=>o(317909),b=()=>o(312296),w=()=>o(704152),j=()=>o(204063),A=()=>o(89924),_=()=>o(574036),M=()=>o(760578),k=()=>o(497222),I=()=>o(147361),T=()=>o(554840),P=o(474848);const B="consume_gap",R=!0;function V(e){var t;const{currentConfig:o,onConfigChange:l,disabled:s,collectionContextStore:c}=e,d=(0,r().K8)((()=>c.databaseType),[c]),p=(0,i().v3)(),m=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[y,S]=(0,n.useState)((0,g().O9)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):R),h=(0,g().O9)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):y;(0,n.useEffect)((()=>{if((0,g().O9)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==y&&S(e)}}),[o,y]);const v=(0,a().IS)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),x=(0,n.useCallback)((e=>{(0,g().O9)(o.configWithoutDates)&&(l({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),(0,f().X)({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,p,l]),C=(0,n.useCallback)((e=>{(0,g().O9)(e)?l({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:y}}):l({...o,configWithoutDates:void 0}),(0,f().X)({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,p,y,l]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(A().A,{title:(0,P.jsx)(u().sA,{...M().Ic.dateShiftingSectionCaption}),disableMobileBorders:!0,style:v.previewContainer,desktopTitleStyle:v.previewTitle,children:(0,P.jsx)(I().r,{mode:m})}),(0,P.jsx)(A().A,{disableMobileBorders:!0,style:v.dateShiftContainer,children:(0,P.jsx)(E,{currentMode:m,onModeChange:C,databaseType:d,disabled:s})}),(0,P.jsxs)(A().A,{children:[(0,P.jsx)(O,{currentValue:h,databaseType:d,onChange:x,disabled:s||!(0,g().O9)(o.configWithoutDates)}),(0,P.jsx)(F,{...e})]})]})}function F(e){const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:a}=e,s=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,l().$L)(o)}))}),[t]),c=s.length,d=o.datePropertyId?s.find((e=>e!==o.datePropertyId)):void 0,p="string"==typeof o.datePropertyId&&(0,g().O9)(o.endDatePropertyId),m=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(p&&(0,g().O9)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=s.find((e=>e!==t)))}i({...o,...n})}),[o,s,i,p]);return!(0,g().O9)(o.configWithoutDates)||c<=1?null:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(T().e,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:p?(0,P.jsx)(u().sA,{...M().Ic.startDate}):(0,P.jsx)(u().sA,{...M().Ic.datePropertyPickerTitle}),onPropertyChanged:e=>m("datePropertyId",e),disabled:a}),(0,g().O9)(d)&&"string"==typeof o.datePropertyId&&(0,P.jsxs)(P.Fragment,{children:[(0,g().O9)(o.endDatePropertyId)&&(0,P.jsx)(T().e,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,P.jsx)(u().sA,{...M().Ic.endDate}),onPropertyChanged:e=>m("endDatePropertyId",e),disabled:a}),(0,P.jsx)(_().A,{title:(0,P.jsx)(u().sA,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:p,disabled:a,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:p?void 0:d})}})]})]})}function K(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,P.jsx)(k().A,{icon:c().gearIcon,showChevron:!0,disabled:i,title:(0,P.jsx)(u().sA,{...M().Ic.advancedSettings}),onClick:()=>{h().a2({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function D(e){const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,a().IS)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px 4px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const l=(0,M().vP)({feature:t,databaseType:n});return(0,P.jsx)(A().A,{disableMobileBorders:!0,children:(0,P.jsx)("div",{style:r.buttonWrap,children:(0,P.jsx)(j().A,{style:r.button,onClick:o,size:"lg",children:(0,P.jsx)(u().sA,{...l})})})})}function L(e){const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:r,inversePropertyName:l,collectionContextStore:s,collectionSettingsStore:c,handleDefaultPropertySelect:p,databaseType:g,clearCollectionViewSubitemDisplayMode:f}=e,x=(0,i().v3)(),b=(0,a().IS)((e=>({modalPropertyName:{color:e.darkTextColor,fontWeight:m().Wy.semibold}})),[]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&l))return null;const w=(0,M().Pf)({feature:t,databaseType:g}),j=(0,M().Ew)({feature:t,databaseType:g}),A={label:(0,P.jsx)(u().sA,{...M().Ic.turnOff}),color:"red",onAccept:async e=>{r&&(null!=e&&e.delete&&await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,a=o.collectionStore();if(!a)return;await C().createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>S().PF({environment:t,collectionStore:a,schema:r,property:n,transaction:e})});const l=r[n];l&&(0,y().i)({environment:t,collectionContextStore:o,property_type:l.type,from:i,property:n})}({environment:x,propertyId:r,collectionContextStore:s,feature:t}),p(void 0),null==f||f(),h().R8({collectionSettingsStore:c,item:{type:"main"}}))}};return(0,P.jsx)(k().A,{icon:d().I,title:(0,P.jsx)(u().sA,{...w}),isRed:!0,onClick:()=>{v().ui({selectionItems:[{key:"delete",text:(0,P.jsx)(u().sA,{...M().Ic.removePropertiesTitle}),description:(0,P.jsx)(u().sA,{...M().Ic.removePropertiesDescription,values:{span:e=>(0,P.jsx)("span",{style:b.modalPropertyName,children:e}),property:n,inverseProperty:l}}),preSelected:!0},{key:"keep",text:(0,P.jsx)(u().sA,{...M().Ic.keepPropertiesTitle})}],selectType:"radio",selectAlignXAxis:"right",message:(0,P.jsx)(u().sA,{...j}),showCancel:!0,keepFocus:!0,items:[A]})}})}function O(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,P.jsx)(_().A,{title:(0,P.jsx)(u().sA,{...M().Ic.avoidWeekendsSwitcherTitle}),caption:(0,P.jsx)(u().sA,{...(0,M().nV)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function E(e){const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,a().IS)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,P.jsx)("div",{style:r.wrap,children:[...s().OY,void 0].map((e=>(0,P.jsx)(z,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function z(e){const{dateShiftingMode:t,onClick:o,active:n,disabled:r,databaseType:l}=e,s=(0,i().Y0)(),c=(0,a().IS)((e=>({buttonStyles:{fontSize:s.isMobile?m().J.UISmall.mobile:m().J.UISmall.desktop,fontWeight:m().Wy.medium,borderRadius:6,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...r&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,s,r]),d=(0,M().Zt)({dateShiftingMode:t,databaseType:l}),p=(0,M().mo)(t);return(0,P.jsx)(w().A,{style:c.buttonStyles,onClick:o,disabled:r,children:(0,P.jsxs)("div",{style:c.buttonContentWrap,children:[(0,P.jsx)("div",{children:p(c.icon)}),(0,P.jsx)("div",{children:(0,P.jsx)(u().sA,{...d})})]})})}function N(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let a;if((0,g().O9)(o.configWithoutDates))if(o.datePropertyId)a={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,p().Ay)(),l={name:r.formatMessage(M().Ic.newDateProperty),type:"date"};(0,b().F)({environment:t,collectionStore:n,update:{[e]:l},transaction:i}),a={...o.configWithoutDates,date_property:e,end_date_property:void 0}}x().zv({store:n.getFormatStore(),data:{dependency_date_shifting_config:a??null},transaction:i})}function U(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,g().HB)(o)}},939656:(e,t,o)=>{"use strict";o.d(t,{Fc:()=>u,Jq:()=>c,k7:()=>d});var n=()=>o(235191),i=()=>o(317909),r=()=>o(682146),a=()=>o(342),l=()=>o(878423),s=()=>o(630116);function c(e){let{collectionContextStore:t,property:o}=e;return(0,r().Kc)(t)[o]}function d(e,t){var o;if("relation"!==(null==t?void 0:t.type))return;const n=null===(o=l().A.state.caches[a().oB])||void 0===o?void 0:o.inMemoryRecordCache,i=null==t?void 0:t.collection_pointer,r=i&&e?s().md.createChildStore(e,i):void 0;return n?null==r?void 0:r.clone(n):r}function u(e){const{name:t,environment:o,property:a,collectionContextStore:l,inputValue:s}=e;if((0,r().fE)({property:a,collectionContextStore:l,newValue:s}))return;const c=l.collectionStore();if(!c)return;const d=c.getSchema()[a];d&&d.name!==t&&i().createAndCommit({userAction:"ButtonBuilderModal.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{n().YO({collectionStore:c,property:a,name:t,transaction:e})}})}},943919:(e,t,o)=>{"use strict";o.d(t,{o:()=>i});var n=()=>o(896628);function i(e){const{icon:t,collectionViewStore:o,transaction:i}=e;n().zA({stores:[o],update:{collection_view_icon:t},transaction:i})}},959733:(e,t,o)=>{"use strict";o.d(t,{g:()=>M});var n=o(296540),i=()=>o(56366),r=()=>o(31503),a=()=>o(970013),l=()=>o(465741),s=()=>o(682146),c=()=>o(937199),d=()=>o(959013),u=()=>o(859428),p=()=>o(103448),g=()=>o(175116),m=()=>o(962730),f=()=>o(478573),y=()=>o(484714),S=()=>o(543906),h=()=>o(235191),v=()=>o(495262),x=()=>o(317909),C=()=>o(424554),b=()=>o(14235),w=()=>o(525432),j=o(474848);function A(e){var t;const{open:o,originRef:r,settingsViewToOpen:a,propertyType:l,isPropertyEditComplete:d,onPropertyEditComplete:u,onDismiss:p,rollbackIfEditIncomplete:g,collectionContextStore:f,collectionSettingsStore:A}=e,_=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect(),M=(0,y().v3)(),{collectionStore:k}=(0,c().bi)(),[I,T]=(0,n.useState)(null),[P,B]=(0,n.useState)(!1),[R,V]=(0,n.useState)(null);(0,S().A)((()=>{const e=`CollectionPropertySettingsPopup.createNewProperty.${l}.${Date.now()}`,{performResult:t}=x().createAndCommit({userAction:"CollectionPropertySettingsPopup.createNewProperty",environment:M,canUndo:!0,undoCheckpoint:e,perform:e=>h().IL({environment:M,collectionStore:k,collectionViewArgs:void 0,propertyName:s().dC[l],propertyType:l,transaction:e})});A.update((e=>({...e,stack:[{...a,property:t}],open:!0}))),T(t),V(e)}),o);const F=(0,i().K8)((()=>{if(!I)return!1;const e=k.getSchema()[I];return!!e&&d(e)}),[k,d,I]);(0,n.useEffect)((()=>{F&&I&&!P&&(u(I),B(!0))}),[F,u,I,P]);const{setModuleSelection:K}=(0,c().LH)();return I?(0,j.jsx)(b().Ay,{open:o,popupType:b().nl.Popup,render:()=>(0,j.jsx)(C().CollectionSettings,{context:w().Bd.TopbarFilterPopup,collectionContextStore:f,collectionSettingsStore:A,hideDesktopHeader:!0}),originRect:_,alignmentToOrigin:m().C.Center,placementToOrigin:m().W.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:()=>{!F&&g&&(R&&v().JM({environment:M,namedRevisionId:R}),K(void 0)),p()}}):null}function _(e){const{icon:t,name:o,disabled:i,tooltip:r,propertySettingsPopup:l,propertyType:s,...c}=e,{image:y,caption:S}=r||{},h=(0,g().ET)(),v=n.useRef(null),x=n.useCallback((e=>(0,j.jsx)("div",{style:{width:"100%"},...e,children:(0,j.jsx)(f().A,{icon:t,name:o,disabled:i,...c,ref:v})})),[i,t,o,c]);let C;return!y&&S?C=(0,j.jsx)(u().A,{textWrap:!0,placement:m().W.Left,render:x,renderTooltip:()=>(0,j.jsx)(d().sA,{...S})}):y&&S&&(C=(0,j.jsx)(u().A,{placement:m().W.Left,render:x,renderTooltip:()=>(0,j.jsx)(p().A,{caption:(0,j.jsx)(d().sA,{...S}),imageURL:y,imageWidth:140,imageHeight:100,imageContainerStyle:{backgroundColor:"white"}})})),(0,j.jsxs)(j.Fragment,{children:[C||(0,j.jsx)(x,{}),l&&l.open&&(0,j.jsx)(A,{originRef:v,propertyType:(0,a().v2)(s),collectionContextStore:h,collectionSettingsStore:h.settingsStore,...l})]})}function M(e){let{actionHandler:t,renderIcon:o,tooltip:d,disabled:u,propertySettingsPopupProps:p}=e;const[g,m]=n.useState(null),{layoutStore:f}=(0,c().LH)(),y=(0,i().K8)((()=>f.getLayoutType()),[f]);return(0,n.useCallback)((e=>({key:e,keywords:[s().dC[e]],render:t=>{let{ref:n,...i}=t;const c=null==p?void 0:p(e);let f=s().dC[e];const S=(0,a().v2)(e);return"form"===y&&(0,r().XO)(S)&&"select"!==S&&(f=l().mY[S]),(0,j.jsx)(_,{icon:o(e),name:f,disabled:null==u?void 0:u(e),propertyType:e,propertySettingsPopup:c?{...c,open:g===e,onDismiss:()=>{m(null)}}:void 0,tooltip:null==d?void 0:d(e),ref:n,...i})},action:()=>{null!=p&&p(e)?m(e):t(e)}})),[t,u,y,g,p,o,d])}},971404:(e,t,o)=>{"use strict";o.d(t,{V:()=>r,X:()=>a});var n=()=>o(597777);const i={"de-DE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"YYYY[]MMM"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"}},r=["de-DE","fr-FR"];function a(e){return i[e]}},992032:(e,t,o)=>{"use strict";o.d(t,{VJ:()=>M,oI:()=>R,Ac:()=>B});o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(428045),s=()=>o(261164),c=()=>o(366295),d=()=>o(47966),u=()=>o(571731),p=()=>o(598985),g=()=>o(959013),m=()=>o(496603),f=()=>o(197190),y=()=>o(493823),S=()=>o(554509),h=()=>o(989423),v=()=>o(913454),x=()=>o(575154),C=()=>o(349379),b=()=>o(896326),w=()=>o(458097),j=o(474848);function A(e){let{template:t,onSelect:i,index:r}=e;const[l,s]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>s(!0)),[]),d=(0,n.useCallback)((()=>s(!1)),[]),u=(0,n.useCallback)((()=>i(t)),[i,t]),p=(0,a().IS)((e=>{const n=(0,o(3486).d)(t.value.targetCollection.icon,e);return{button:{borderRadius:M,border:`1px solid ${n.stroke.secondary}`,overflow:"hidden"},buttonInner:{borderRadius:M,background:`${n.fill.tertiary}`},buttonHovered:{background:`${n.fill.secondary}`},textContainer:{padding:"20px 20px 10px",color:n.text.primary},description:{marginTop:2,color:n.text.primary,opacity:.6,textWrap:"balance"},outerImageContainer:{overflow:"visible",position:"relative",height:108,width:"calc(100% - 22px)",marginLeft:22,marginTop:-4},imageContainer:{position:"absolute",top:l?0:4,transition:"top 0.2s ease",width:"100%",height:"100%",marginTop:4,lineHeight:0,borderRadius:"6px 0",overflow:"hidden",background:e.modalBackground,boxShadow:"dark"===e.mode?`0 0 0 1px ${e.stroke.secondary}`:`0px 0px 0px 1px ${e.stroke.secondary}, 0px 2px 4px -1px rgba(0, 0, 0, 0.06), 0px 12px 32px -6px rgba(0, 0, 0, 0.12)`}}}),[l,t.value.targetCollection.icon]);return(0,j.jsx)(o(704152).A,{style:p.button,hoveredStyle:p.buttonHovered,wrapperDivStyle:p.buttonInner,ariaLabel:t.value.targetCollection.name,onClick:u,onMouseEnter:c,onMouseLeave:d,children:(0,j.jsxs)(o(84817).Y1,{gap:"auto",height:"fill",children:[(0,j.jsxs)("div",{style:p.textContainer,children:[(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Medium",children:t.value.targetCollection.name}),(0,j.jsx)(S().D,{styleName:"UISmall-12px/Regular",customStyles:p.description,children:t.description})]}),(0,j.jsx)("div",{style:p.outerImageContainer,children:(0,j.jsx)("div",{style:p.imageContainer,children:(0,j.jsx)(o(67064).i,{template:t,index:r})})})]})})}const _=n.memo(A),M=12,k={};function I(e){let{iconFn:t,iconColorName:o,label:n,onClick:i}=e;const r=(0,a().IS)((e=>({button:{padding:"16px 18px",borderRadius:M,borderWidth:1,borderStyle:"solid",borderColor:"dark"===e.mode?e.stroke.secondary:e.stroke.primary},hovered:{background:e.buttonHoveredBackground,borderColor:e.accentColors.translucentGray[100]},icon:{height:19,width:"auto",color:o?e.icon[o]:void 0,marginBottom:8}})),[o]);return(0,j.jsxs)(f().A,{style:r.button,hoveredStyle:r.hovered,onClick:i,children:[(0,j.jsx)("div",{children:t(r.icon)}),(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Medium",children:n})]})}function T(e){let{iconFn:t,iconColorName:o,label:n,onClick:i}=e;const r=(0,a().IS)((e=>({button:{padding:"5px 12px",display:"flex",gap:8,justifyContent:"center",alignItems:"center",borderRadius:20,color:e.text.secondary},icon:{height:19,width:"auto",color:o?e.icon[o]:void 0,marginBottom:0}})),[o]);return(0,j.jsxs)(f().A,{style:r.button,onClick:i,children:[(0,j.jsx)("div",{children:t(r.icon)}),(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Regular",children:n})]})}const P=16,B=(0,j.jsx)(g().sA,{id:"workflowTemplatesOnboardingModal.button.marketplace",defaultMessage:"More in Marketplace"});function R(e){let{parentStore:t,onAddEmptyPage:o,onAddEmptyDatabase:f,onSelectTemplate:A,onMarketplaceClick:M,showEmptyPageButton:R}=e;const V=(0,i().v3)(),F=(0,r().K8)((()=>w().A.getShouldShowExpandedTemplateList()),[]),K=(0,x().q)({parentStore:t,returnAllTemplates:F}),D=(0,n.useMemo)((()=>F?K:function(e){let{arr:t,min:o}=e;if(t.length<=o)return[...t];return t.slice(0,2*Math.floor(t.length/2))}({arr:K,min:1})),[K,F]),L=(0,r().K8)((()=>w().A.state.open&&"new_user_onboarding"===w().A.state.origin),[]),O=(0,r().K8)((()=>(0,v().getIsSetupGeneratorEnabled)()&&!L),[L]),E=!F,z=(0,n.useCallback)((()=>{w().A.setShouldShowExpandedTemplateList(!0),w().A.state.open&&(0,h().u4)({environment:V,event:{eventName:"template_picker_show_more_templates_clicked",eventProperties:(0,b().gM)(w().A.state)}})}),[V]),N=(0,a().IS)((e=>({container:{width:"100%",maxWidth:560+P,alignSelf:"center",alignItems:"center"},basicButtonGrid:{display:"grid",gridTemplateColumns:`repeat(auto-fit, minmax(calc((100% - ${2*P}px) / 3), 1fr))`,maxWidth:"100%",gap:P,marginTop:P,marginBottom:2*P},newUserOnboardingButtons:{display:"flex",gap:4,margin:`${P}px auto 40px auto`,justifyContent:"center"},templateButtonGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:P,marginTop:18},showMoreButton:{marginTop:P,height:32,paddingLeft:12,paddingRight:12},marketplaceButton:{padding:"6px 8px 6px 6px",height:32,marginTop:P},marketplaceIcon:{height:19,width:"auto",color:e.icon.secondary,marginRight:10},arrowRightIcon:{height:10,width:"auto",color:e.icon.secondary,marginLeft:6}})),[]);(0,n.useEffect)((()=>{const{state:e}=w().A;e.open&&void 0!==e.flowId&&!k[e.flowId]&&((0,C().DF)({environment:V,eventProperties:{collection_template_ids_shown:D.map((e=>e.templateId)),...(0,b().gM)(e)}}),k[e.flowId]=!0)}),[D,V]);const U=(0,n.useCallback)((()=>{A(v().globalWorkflowTemplates.fromIdOfType({templateId:l().MH,type:"collection"}),{type:"ai_generated_template"})}),[A]),H=(0,n.useCallback)((e=>{A(e,{type:"suggested_template",allOrderedTemplateIds:D.map((e=>e.templateId))})}),[A,D]),W=L?T:I,G=(0,m().oE)([R?(0,j.jsx)(W,{iconFn:d().Y,iconColorName:"secondary",label:(0,j.jsx)(g().sA,{id:"workflowTemplatesOnboardingModal.button.emptyPage",defaultMessage:"Empty page"}),onClick:o},"emptyPage"):void 0,(0,j.jsx)(W,{iconFn:u().J,iconColorName:"secondary",label:(0,j.jsx)(g().sA,{id:"workflowTemplatesOnboardingModal.button.emptyDatabase",defaultMessage:"Empty database"}),onClick:f},"emptyDatabase"),O?(0,j.jsx)(W,{iconFn:c().L,label:(0,j.jsx)(g().sA,{id:"workflowTemplatesOnboardingModal.button.buildWithAi",defaultMessage:"Build with AI"}),onClick:U},"buildWithAi"):void 0]);return(0,j.jsxs)("div",{style:N.container,children:[(0,j.jsx)("div",{style:L?N.newUserOnboardingButtons:N.basicButtonGrid,children:G}),(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:(0,j.jsx)(g().sA,{defaultMessage:"Suggested",id:"workflowTemplatesOnboardingModal.templateSelection.heading"})}),(0,j.jsx)("div",{style:N.templateButtonGrid,children:D.map(((e,t)=>(0,j.jsx)(_,{template:e,onSelect:H,index:t},e.templateId)))}),E?(0,j.jsx)(y().p,{style:N.showMoreButton,onClick:z,children:(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:(0,j.jsx)(g().sA,{id:"workflowTemplatesOnboardingModalSelectionLanding.seeMore",defaultMessage:"More templates"})})}):(0,j.jsxs)(y().p,{style:N.marketplaceButton,onClick:M,children:[(0,p().J)(N.marketplaceIcon),(0,j.jsx)(S().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:B}),(0,s().o)(N.arrowRightIcon)]})]})}}}]);