"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5834],{375078:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>y,transformBlocks:()=>C,transformIntoColumnList:()=>R});n(581454);var o=()=>n(908006),r=()=>n(700500),a=()=>n(179034),c=()=>n(496603),i=()=>n(722101),s=()=>n(44729),l=()=>n(863168),d=()=>n(246826),m=()=>n(797265),p=()=>n(778417),S=()=>n(725614),v=()=>n(317909),f=()=>n(62287),u=()=>n(87017),I=()=>n(594794),g=()=>n(299545),b=()=>n(508496),k=()=>n(630116),h=()=>n(65269);function C(e){const{environment:t,blocks:n,blockType:h,transaction:C}=e;if(h!==r().xd.transclusionContainer)if(h===r().xd.callout&&b().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:o}=e,c=n[0];if(!c)return;const i=c.getRecordStoreUIParent();if(!i||!(0,g().iU)(i))return;const m=i.getRecordStoreUIParent();if(!(m&&m instanceof k().Bv))return;const v=(0,I().Z1)({environment:t,table:a().ev,spaceId:m.getSpaceId()}),f=d().Wv({environment:t,id:v,type:r().xd.callout,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:m.getSpaceId(),format:{callout_version:2}});s().NI({parentStore:i,childStore:f,after:c.id,transaction:o});T({newParentStore:f.getContentStore(),blocks:n,transaction:o}),l().s4({store:f,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:C});else if(h!==r().xd.columnList)if(h!==r().xd.slide)if((0,r().ZK)(h)){const e=parseInt(h.replace("column","").replace("block","")),r=c().oE(c().Hn(e-1,(()=>u().insertTextBelow({environment:t,blocks:n,transaction:C})))),a=[...n,...r],i=R({environment:t,blocks:a,transaction:C});o().default.afterNextFlush((()=>{S().setSelectionAtStart({store:i[0].getBlockTitleStore()})}))}else for(const r of n)if(r.isCalloutV2()){const e=r.getParentBlockStore();if(e){const a=r.getContentStores();v().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:a.map((e=>e.id)),after:r.id}},transaction:C}),s().zz({parentStore:e.getContentStore(),childStore:r,transaction:C});for(const e of a)f().pd({environment:t,block:e,blockType:h,transaction:C,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{m().dL(t,a.map((e=>e.id)))}))}}else f().pd({environment:t,block:r,blockType:h,transaction:C,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:o}=e,c=n[0];if(!c)return;const i=c.getRecordStoreUIParent();if(!i||!(0,g().iU)(i))return;const l=i.getRecordStoreUIParent();if(!(l&&l instanceof k().Bv))return;const m=(0,I().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.slide,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});s().NI({parentStore:i,childStore:v,after:c.id,transaction:o});T({newParentStore:v.getContentStore(),blocks:n,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:C});else R({environment:t,blocks:n,transaction:C});else!function(e){const{environment:t,blocks:n,transaction:o}=e,c=n[0];if(!c)return;const s=c.getRecordStoreUIParent();if(!s||!(0,g().iU)(s))return;const l=s.getRecordStoreUIParent();if(!l||!(0,g()._p)(l))return;if(!l.isDefined())return;const m=(0,I().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.transclusionContainer,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});i().WH({parentStore:s,insertStore:v,afterStore:c,transaction:o});T({newParentStore:v.getContentStore(),blocks:n,transaction:o}),S().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:C})}function y(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&C({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}function R(e){const{environment:t,blocks:n,transaction:o}=e,c=n[0];if(!c)return[];const s=c.recordStoreUIParentStore;if(null==s||!s.valueIs(h()._))return[];const l=(0,I().Z1)({environment:t,table:a().ev,spaceId:c.getSpaceId()}),m=d().Wv({environment:t,id:l,type:r().xd.columnList,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:c.getSpaceId()}),{childStore:p}=i().nc({parentStore:s,insertStore:m,beforeStore:c,transaction:o});return n.map((e=>{const n=(0,I().Z1)({environment:t,table:a().ev,spaceId:c.getSpaceId()}),l=d().Wv({environment:t,id:n,type:r().xd.column,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:c.getSpaceId()}),{childStore:m}=i().TF({parentStore:s,childToRemoveStore:e,transaction:o}),{childStore:S}=i().WH({parentStore:p.getContentStore(),insertStore:l,transaction:o}),{childStore:v}=i().WH({parentStore:S.getContentStore(),insertStore:m,transaction:o});return v}))}function T(e){const{newParentStore:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(h()._)&&(i().TF({parentStore:e,childToRemoveStore:r,transaction:o}),i().BC({parentStore:t,appendStore:r,transaction:o}))}}}}]);