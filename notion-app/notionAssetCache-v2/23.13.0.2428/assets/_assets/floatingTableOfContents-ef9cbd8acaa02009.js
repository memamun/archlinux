"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[52614],{666892:(e,t,o)=>{o.r(t),o.d(t,{COLLAPSE_THRESHOLD_IN_PIXELS:()=>Y,FloatingTableOfContents:()=>W,FloatingTableOfContentsFullSizeContents:()=>G,FloatingTableOfContentsMiniContents:()=>U});o(898992),o(672577),o(581454);var n=o(296540),i=()=>o(624919),r=()=>o(484714),a=()=>o(56366),l=()=>o(401497),s=()=>o(799954),d=()=>o(125958),c=()=>o(175947),u=()=>o(835066),p=()=>o(116008),g=()=>o(155004),v=()=>o(145214),f=()=>o(296798),h=()=>o(16006),x=()=>o(789550),S=()=>o(38337),m=()=>o(747100),y=()=>o(569912),b=()=>o(891078),C=()=>o(141333),w=()=>o(551619),R=()=>o(817942),M=()=>o(778781),k=()=>o(129522),T=()=>o(148832);var j=()=>o(455994),A=()=>o(695625),I=()=>o(644914),H=()=>o(962730),B=()=>o(397248),F=()=>o(874753),L=()=>o(372154),P=()=>o(712505),O=()=>o(666710),K=()=>o(502438),E=()=>o(960701),_=()=>o(134103);class z extends(()=>o(757695))().default{getInitialState(){return{displayState:"collapsed_narrow"}}}var D=o(474848);const Y=310,N=!1;function W(e){const{store:t}=e,o=(0,r().v3)(),n=(0,a().K8)((()=>o.device.isMobile),[o]),{navigableAncestorStore:i}=(0,E().d)({parentStore:t}),l=(0,a().K8)((()=>(0,m().cq)(t)),[t]),s=(0,a().K8)((()=>{const e=null==i?void 0:i.getModel();return e&&"off"!==e.getFloatingTableOfContentsState()}),[i]),{isSidePeekOpen:d,isCenterPeekOpen:c}=(0,a().K8)((()=>({isSidePeekOpen:P().default.isSidePeekOpen(),isCenterPeekOpen:P().default.isCenterPeekOpen()})),[]),g=(0,a().K8)((()=>(0,I().Nk)(o)),[o]),v=(0,a().K8)((()=>j().A.getPanelState("peek").isOpen),[]),f=(0,a().K8)((()=>F().P.state.open&&"chat"===F().P.state.currentView),[]),h=(x=t,(0,a().K8)((()=>{var e,t;const o=null===(e=x.getAssociatedCollectionStore())||void 0===e?void 0:e.getLayoutStore();if(!o)return!1;const n=o.firstModuleOfType("viewsMain");if(!n||!(0,M().y6)(n))return!1;const i=T().B.createChildStore(o,n.collection_view_block_pointer);if(!i)return!1;const r=k().K.findCollectionViewBlockFromId(i.id),a=null==r||null===(t=r.collectionContextStore)||void 0===t?void 0:t.collectionViewStore();return a&&"page"!==a.getType()}),[x]));var x;const S=(0,a().K8)((()=>(0,u().dC)(o,t)&&(L().A.state.open||p().A.state.open)),[o,t]);return!s||n||h||!l&&(d||g||f||S)||l&&(d||c&&v)?null:(0,D.jsx)(Z,{store:e.store})}function Z(e){const{store:t}=e,o=(0,n.useRef)(null),s=(0,a().uB)(void 0,z),{verticalScroller:d}=(0,n.useContext)(x().R)??{},{navigableAncestorStore:u,headerStores:p}=(0,E().d)({parentStore:t}),v=(0,r().v3)(),{closestSelectable:f,targetHorizontalRule:h}=(0,a().K8)((()=>{var e;if(!d)return{};const t=(null==d?void 0:d.getStore()).state.clientRect??d.getClientRect(),{selectableRectMap:o}=O().default.state,n=t&&t.top+t.height/4,i=A().T.findScrollToSelectablesFromIds(p.map((e=>e.id))),r=new Map(i.map((e=>[e.props.store.id,e]))),{stores:a,phase:l}=K().default.state,s=l===K().SelectionPhase.Selected?a.find((e=>r.has(e.id))):void 0,c=s&&r.get(s.id),u=c&&o.get(c);if(u&&t&&B().HY(u,t))return{closestSelectable:c,targetHorizontalRule:n};let g;if(void 0!==n)for(const d of i){const e=o.get(d);if(!e)continue;const t=e.top+e.height/2,i=Math.abs(n-t);(!g||i<g.distance)&&(g={distance:i,selectable:d})}return{targetHorizontalRule:n,closestSelectable:null===(e=g)||void 0===e?void 0:e.selectable}}),[p,d]),m=(0,a().K8)((()=>{var e;return null==u||null===(e=u.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState()}),[u]),y=(0,w().no)(t),b=(0,a().K8)((()=>s.state.displayState),[s]);(0,n.useEffect)((()=>{N&&h&&(0,i().Iz)({top:h-3,bottom:h+3,left:0,width:9e3},"active header target")}));const C=(0,l().IS)((()=>({outerContainer:{position:"absolute",top:0,width:"100%",height:`calc(100vh - ${c().ek(v.device.isElectronMac)}px)`,display:"flex",flexDirection:"column",pointerEvents:"none"},viewportHeightContainer:{display:"flex"}})),[v.device.isElectronMac]),[M,k]=function(e){const t=(0,n.useRef)(null),o=(0,a().K8)((()=>{var o;const n=O().default.state.selectableRectMap,i=null===(o=t.current)||void 0===o?void 0:o.getBoundingClientRect();if(!i)return!1;for(const[t,r]of n)if(t.getContextSelectableContainer()===K().default.getCurrentDefaultContainer()&&"collection_view"!==t.props.store.getType()&&!t.props.ignoreForTocSelectionIntersection&&B().HY(r,i)){const o=t.props.store.getRecordStoreUIRoot();return e===o}return!1}),[e]);return[t,o]}(e.store),T={store:t,navigableAncestorStore:u,scrollTargetY:h,activeBlockId:null==f?void 0:f.props.store.id,headerStores:p,floatingTocStore:s};return p.length<2&&"minimal"===m?null:(0,D.jsxs)(R().kZ,{style:{width:"100%",gridRow:"1 / -1",paddingLeft:y,position:"sticky",top:0,right:0,zIndex:80,transition:"opacity 0.2s ease",opacity:k?0:1,visibility:k?"hidden":"visible",pointerEvents:k?"none":"auto"},children:[(0,D.jsx)("div",{style:{width:"100%",height:0},ref:o}),(0,D.jsx)("div",{className:`hide-scrollbar ${S().Vac} ${S().xAE}`,style:C.outerContainer,children:(0,D.jsx)("div",{style:C.viewportHeightContainer,children:(0,D.jsx)(g().s,{allowSelectionWithin:!0,style:{width:"100%"},children:"expanded"===b?(0,D.jsx)($,{ref:M,...T}):(0,D.jsx)(V,{...T,ref:M})})})})]})}const V=n.forwardRef((function(e,t){const i=(0,r().v3)(),{floatingTocStore:s}=e,d=(0,n.useRef)(null),c=(0,o(493720).RJ)(),u=(0,n.useRef)(),p=(0,a().K8)((()=>e=>{var t;(o(610640).A.setState({isHovered:e}),s.setState({...s.state,displayState:e?"collapsed_full":"collapsed_narrow"}),e)&&(u.current=null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect(),(0,o(989423).u4)({environment:i,event:{eventName:"open_page_table_of_contents",eventProperties:{}}}))}),[i,s]),g=(0,a().K8)((()=>"collapsed_narrow"===s.state.displayState),[s]),f=(0,l().IS)((()=>({miniSizeContainer:{width:56,display:"flex",flexDirection:"column",justifyContent:"center",paddingBottom:12,paddingRight:8}})),[]),{verticalOffsetInPx:h,maxHeightForFullSizeToc:x,maxHeightForCollapsedToc:S}=ne(e.store,s),m=(0,n.useCallback)((e=>({opacity:e?1:0})),[]);return(0,D.jsxs)("div",{style:{maxHeight:x,marginBottom:60,pointerEvents:"auto"},onMouseLeave:()=>p(!1),children:[(0,D.jsx)(v().A,{animate:m(g),style:{maxHeight:S,display:"flex",flexDirection:"row",position:"absolute",top:h,right:0,overflowY:"hidden"},onMouseMove:y().Z,children:(0,D.jsx)("div",{ref:c(d,t),style:f.miniSizeContainer,onMouseOver:()=>{p(!0)},children:(0,D.jsx)(U,{...e})})}),(0,D.jsx)(v().A,{tag:X,visible:!g,animate:{translateX:0,opacity:1},initial:{translateX:10,opacity:0},exit:{translateX:10,opacity:0},originRect:u.current,onMouseLeave:()=>p(!1),contentProps:e,maxHeightForFullSizeToc:x})]})})),X=n.forwardRef((function(e,t){let{originRect:n,contentProps:i,maxHeightForFullSizeToc:r,onMouseLeave:a,style:s}=e;const d=(0,l().IS)((e=>({fullSizeContainer:{width:242,display:"flex",flexDirection:"row",alignItems:"center",padding:"12px 12px 0 12px",marginRight:10,backgroundColor:e.contentBackground,boxShadow:e.shadowMD,borderRadius:14,position:"relative",overflowY:"auto"}})),[]);return(0,D.jsx)(o(14235).Ay,{preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,disableMouseCapture:!0,popupType:o(377586).n.Popup,originGap:-56,alignmentToOrigin:H().C.Start,open:!0,placementToOrigin:H().W.Left,originRect:n,style:{background:void 0,boxShadow:void 0,overflow:void 0,marginTop:-10},render:()=>(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",width:258,paddingLeft:16,cursor:"default",...s},onMouseMove:e=>{(0,y().Z)(e),e.stopPropagation()},onMouseLeave:a,ref:t,children:(0,D.jsx)("div",{style:d.fullSizeContainer,children:(0,D.jsx)(G,{...i,fillBackground:!0,maxHeight:r})})}),trapFocus:!1})})),$=n.forwardRef((function(e,t){const{store:o,floatingTocStore:n}=e,{verticalOffsetInPx:i,maxHeightForFullSizeToc:r}=ne(o,n);return(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"end",pointerEvents:"auto"},children:(0,D.jsx)("div",{ref:t,onMouseMove:y().Z,style:{position:"absolute",top:i,marginRight:60,width:250,overflowY:"auto",maxHeight:r},className:"hide-scrollbar",children:(0,D.jsx)(G,{...e,maxHeight:r})})})}));function q(e){const t=(0,a().K8)((()=>d().A({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,b().pW)(e.store),i=(0,l().IS)((n=>({container:{...o,cursor:"pointer",width:"100%",paddingBottom:e.isLast?12:void 0,color:e.isActive?n.text.uiBluePrimary:n.text.secondary,transition:"color 0.15s ease"},linkBoxHovered:{background:n.tint.regular,borderRadius:4,color:e.isActive?n.text.uiBluePrimary:n.text.primary},nameContainer:{display:"flex",alignItems:"center",marginLeft:12*t},name:{paddingRight:s().nE.paddingRight,paddingLeft:s().nE.paddingLeft,fontSize:13,lineHeight:1.3,display:"flex",alignItems:"center",padding:4}})),[o,t,e.isActive,e.isLast]),r=(0,_().t)({pageStore:e.navigableAncestorStore,scrollToBlockId:e.headerStore.id,isFloatingToc:!0}),[c,u]=(0,n.useState)(!1);return e.navigableAncestorStore?(0,D.jsx)(f().A,{...r,style:{...i.container,...e.style},external:!1,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),hovered:!1,pressedStyle:{background:"none"},ignoreLocalHoverState:!0,children:(0,D.jsx)("div",{style:{...i.nameContainer,...c?i.linkBoxHovered:{}},children:(0,D.jsx)("div",{style:i.name,children:(0,D.jsx)(h().A,{store:e.headerStore,shouldWrap:!0,underline:!1,maxLines:2})})})}):null}function G(e){const{headerStores:t,navigableAncestorStore:o,maxHeight:n}=e,i=(0,l().IS)((e=>({container:{maxWidth:500,maxHeight:n,width:"100%",cursor:"default"},fillContainer:{padding:6,maxWidth:500,maxHeight:n,width:"100%",cursor:"default"}})),[n]);return(0,D.jsx)("div",{onMouseMove:y().Z,style:e.fillBackground?i.fillContainer:i.container,children:t.map(((n,i)=>(0,D.jsx)(q,{headerStore:n,index:i,isLast:i===t.length-1,headerStores:t,store:e.store,navigableAncestorStore:o,isActive:n.id===e.activeBlockId,scrollTargetY:e.scrollTargetY},n.id)))})}function J(e){const t=(0,a().K8)((()=>d().A({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,l().IS)((o=>{const n=o.accentColors.gray[800],i="dark"===o.mode&&e.isActive;return{lineContainer:{backgroundColor:e.isActive?n:o.fill.grayPrimary,height:2,width:16-4*t,transition:"background 0.2s ease, box-shadow 0.2s ease",boxShadow:i?`0px 0px 3px ${n}`:"none",borderRadius:2,marginLeft:4*t}}}),[t,e.isActive]);return e.navigableAncestorStore?(0,D.jsx)("div",{children:(0,D.jsx)("div",{style:o.lineContainer})}):null}function U(e){const{headerStores:t,navigableAncestorStore:o}=e,n=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:12,paddingLeft:20,paddingBottom:12,height:"100%"}})),[]);return(0,D.jsx)("div",{style:n.container,onMouseMove:y().Z,children:t.map(((n,i)=>(0,D.jsx)(J,{headerStore:n,index:i,headerStores:t,store:e.store,navigableAncestorStore:o,isActive:n.id===e.activeBlockId},n.id)))})}const Q=113,ee=600,te=18,oe=130;function ne(e,t){const{verticalScroller:o}=(0,n.useContext)(x().R)??{},i=null==o?void 0:o.getStore(),r=(0,a().K8)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),l=(0,C().yE)(r),s=(0,C().o7)(r),d=(0,a().K8)((()=>{const t=A().T.findNodeFromBlockId(e.id),o=null==i?void 0:i.state;if(O().default.state.selectableElementRectMap,o&&t)return Math.max(t.offsetTop-l+te,oe)}),[e,i,l]),c=(0,a().K8)((()=>t.state.displayState),[t]),u=s&&d?s-d-("expanded"!==c?80:0):ee;return{maxHeightForFullSizeToc:u,maxHeightForCollapsedToc:Math.min(400,u),verticalOffsetInPx:d||Q}}}}]);